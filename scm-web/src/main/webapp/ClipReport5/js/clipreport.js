var fileUUid="8b75a280-2bff-4e45-877f-4f58cb5a2f1c";var report_version="5.0.288";var exe_print_version="1.0.0.1";var mCR_reportVersion="5.0.288";var mCR_exe_print_version="1.0.0.1";var agt=navigator.userAgent.toLowerCase();var view_domain=document.domain;var is_major=parseInt(navigator.appVersion);var is_minor=parseFloat(navigator.appVersion);var is_moz=((agt.indexOf("mozilla")!=-1)&&(agt.indexOf("spoofer")==-1)&&(agt.indexOf("compatible")==-1)&&(agt.indexOf("opera")==-1)&&(agt.indexOf("webtv")==-1)&&(agt.indexOf("hotjava")==-1));var is_moz2=(is_moz&&(is_major==2));var is_moz3=(is_moz&&(is_major==3));var is_moz4=(is_moz&&(is_major==4));var is_gecko=(agt.indexOf("gecko")!=-1);var is_firefox=(agt.indexOf("firefox")!=-1);var is_nav2=is_moz2;var is_nav3=is_moz3;var is_nav4=is_moz4;var is_nav4up=(is_nav4||((is_major>=4)&&(agt.indexOf("netscape")!=-1)));var is_nav=(is_nav2||is_nav3||is_nav4);var is_mozilla=(is_moz&&is_gecko);var is_mozilla1=(is_moz&&is_gecko&&(agt.indexOf("rv:1")!=-1));var is_ie=((agt.indexOf("msie")!=-1)&&(agt.indexOf("opera")==-1));var is_ieVersion=0;var is_ie6=(is_ie&&(is_major==4)&&(agt.indexOf("msie 6.")!=-1));if(is_ie6){is_ieVersion=6;}var is_ie7=(is_ie&&(is_major==4)&&(agt.indexOf("msie 7.")!=-1));if(is_ie7){is_ie6=false;is_ieVersion=7;}var is_ie8=(is_ie&&(is_major==4)&&(agt.indexOf("msie 8.")!=-1));if(is_ie8){is_ie6=false;is_ie7=false;is_ieVersion=8;}var is_ie9=(is_ie&&(is_major==5)&&(agt.indexOf("msie 9.")!=-1));if(is_ie9){is_ie6=false;is_ie7=false;is_ie8=false;is_ieVersion=9;}var is_ie10=(is_ie&&(is_major==5)&&(agt.indexOf("msie 10.")!=-1));if(is_ie10){is_ie6=false;is_ie7=false;is_ie8=false;is_ie9=false;is_ieVersion=10;}var is_ie11=(is_gecko&&!is_firefox&&(is_major==5)&&(agt.indexOf("rv:11.")!=-1));if(is_ie11){is_ie6=false;is_ie7=false;is_ie8=false;is_ie9=false;is_ie10=false;is_ie=true;is_ieVersion=11;}var is_window=(agt.indexOf("windows")!=-1);var is_chrome=!is_ie&&(agt.indexOf("chrome")!=-1)?true:false;var is_chrome58=false;var is_chrome128=false;if(is_chrome){var tempVer=agt.match(/chrome\/([0-9]+)\./g);if(null!=tempVer){if(Number(tempVer[0].substring(7))>57){is_chrome58=true;}if(Number(tempVer[0].substring(7))>127){is_chrome128=true;}}}var is_chromium_edge=(agt.indexOf("edge")!=-1)||(agt.indexOf("edg")!=-1);var is_edge=is_chromium_edge;var is_whale=is_chrome&&(agt.indexOf("whale")!=-1);var is_edge_version=0;if(is_edge){var tempVer=agt.match(/chrome\/(([0-9]|\.)+)/g);if(null!=tempVer){var lastDot=tempVer[0].indexOf(".");tempVer=Number(tempVer[0].substring(7,lastDot));if(typeof tempVer==="number"){is_edge_version=tempVer;}}}if(is_edge_version>94){is_edge=false;}var is_opera=is_chrome&&(agt.indexOf("opr/")!=-1);var is_safari=(agt.indexOf("safari")!=-1&&!is_chrome);var is_safari14=false;if(is_safari){var tempVer=agt.match(/version\/([0-9]+)\./g);if(null!=tempVer){if(Number(tempVer[0].substring(8))>13){is_safari14=true;}}}var is_window_safari=(is_safari&&agt.indexOf("windows")!=-1);var is_crOs=is_chrome&&(agt.indexOf("csos")!=-1);var is_chromeFrame=!is_ie&&is_chrome;var is_webkit=is_safari||is_chrome;var is_mozBrowser=is_firefox||is_opera;var is_ipad=((is_safari||is_moz||(agt.indexOf("applewebkit")!=-1))&&(agt.indexOf("ipad")!=-1));var is_iphone=((is_safari||is_moz||(agt.indexOf("applewebkit")!=-1))&&(agt.indexOf("iphone")!=-1));var is_apple=(is_ipad||is_iphone);var is_android=(agt.indexOf("android")!=-1);var is_opera_mini=(agt.indexOf("opera mini")!=-1);var is_android_mobile=(is_android&&agt.indexOf("mobile")!=-1);var is_android_tablet=(is_android&&!is_android_mobile);var is_android_mobile44=(is_android_mobile&&agt.indexOf("android 4.")!=-1);var is_samsung_browser=(is_android&&(agt.indexOf("samsungbrowser")!=-1));var is_ipad=(is_ipad||(navigator.platform==="MacIntel"&&navigator.maxTouchPoints>1))&&!is_window&&!is_android&&!is_iphone;var is_mobile=(is_iphone||is_android_mobile);var is_tablet=(is_ipad||is_android_tablet);var mCR_isSmartphone=false;var is_smartphone=false;var is_smartphone=(is_iphone||is_opera_mini||is_ipad||is_android);mCR_isSmartphone=is_smartphone;var mCR_isAddRequestHeader=false;var is_daumApp=(is_smartphone&&(agt.indexOf("daum")!=-1));var is_naverApp=(is_smartphone&&(agt.indexOf("naver")!=-1));var is_iosChrome=(is_apple&&(agt.indexOf("crios")!=-1));var is_KakaoApp=(is_smartphone&&(agt.indexOf("kakao")!=-1));var is_svg=true;if(typeof window.SVGAElement=="undefined"){is_svg=false;if(!is_ie6&&!is_ie7&&!is_ie8){is_ie7=true;}is_ie=true;is_ie9=false;is_ie10=false;is_ie11=false;is_ieVersion=7;}else{if(is_ie7||is_ie8){is_svg=false;}}var is_appControl=false;var is_exeControl=false;var is_exeMirroring=false;var is_exeMirroringMain=false;var is_exeMirroringSub=false;var is_ReExternal=false;var ReExternal=new Object();try{if(typeof window.external!="undefined"){is_ReExternal=true;ReExternal=window.external;}}catch(e){if(typeof window.console!="undefined"){window.console.log(e.stack);}}if(is_svg){is_appControl=(typeof ClipHybrid!="undefined")&&(typeof ClipHybrid.callNativeControl!="undefined");is_exeMirroringSub=(is_ReExternal)&&("ClipSubWebBrowserCtrl_Invoke" in ReExternal);is_exeControl=is_exeMirroringSub;is_exeMirroringMain=(is_ReExternal)&&("ClipMainWebBrowserCtrl_Invoke" in ReExternal);is_exeMirroring=is_exeMirroringMain||is_exeMirroringSub;}window.is_clipSignPlugin=false;var Re_zoom={isPop:false,rate:1};var mRe_pallet=null;var is_PosiFix=true;var mCR_isEdge=is_edge;var mCR_isIE=is_ie;var mCR_isFirefox=is_firefox;var getAcrobatInfo=function(){var f=function(g){try{return new ActiveXObject(g);}catch(h){window.mRe_ccancels=h.stack;}};var b=function(g){for(key in navigator.plugins){var h=navigator.plugins[key];if(h.name==g){return h;}}};var c=function(){return window.plugin=window.plugin||function(){if(is_ie||is_ie11){return f("AcroPDF.PDF")||f("PDF.PdfCtrl");}else{return b("Chromium PDF Viewer")||b("Chrome PDF Viewer")||b("Microsoft Edge PDF Viewer")||b("Adobe Acrobat")||b("WebKit built-in PDF");}}();};var d=function(){return !!c();};var a=function(){try{var i=c();if(is_ie||is_ie11){var g=i.GetVersions().split(",");var h=g[0].split("=");return parseFloat(h[1]);}if(i.version){return parseInt(i.version);}return i.name;}catch(j){return null;}};return{acrobat:d()?true:false,acrobatVersion:a()};};var m_report_printOption=getAcrobatInfo();var is_win78_reader9=(((agt.indexOf("windows nt 6.1")!=-1)||(agt.indexOf("windows nt 6.2")!=-1)||(agt.indexOf("windows nt 10.")!=-1))&&(null!=m_report_printOption.acrobatVersion)&&(m_report_printOption.acrobatVersion<10));var is_reader8=(null!=m_report_printOption.acrobatVersion)&&(m_report_printOption.acrobatVersion<9);var is_winxp_reader10=((is_ie6||is_ie7||is_ie8)&&(null!=m_report_printOption.acrobatVersion)&&(m_report_printOption.acrobatVersion<11&&m_report_printOption.acrobatVersion>9));var is_indexedDB=window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB;var is_IDBTransaction=window.IDBTransaction||window.webkitIDBTransaction||window.msIDBTransaction;var is_IDBKeyRange=window.IDBKeyRange||window.webkitIDBKeyRange||window.msIDBKeyRange;function HttpClient(){try{var b=new XMLHttpRequest();if(null!=b){this.m_objHttpRequest=b;}}catch(a){try{var b=new ActiveXObject("Msxml2.XMLHTTP");if(null!=b){this.m_objHttpRequest=b;}}catch(a){try{var b=new ActiveXObject("Microsoft.XMLHTTP");if(null!=b){this.m_objHttpRequest=b;}}catch(a){mRe_ReportWebLog("HttpRequest not supported");}}}}HttpClient.prototype.send=function(f,b,c,d){if(c){this.m_objHttpRequest.onreadystatechange=d;}else{this.m_objHttpRequest.onreadystatechange=null;}var a="";if(-1!=f.indexOf("?")){a=f+"&"+b;this.m_objHttpRequest.open("GET",a,c);this.m_objHttpRequest.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=utf-8");this.m_objHttpRequest.send();}else{this.m_objHttpRequest.open("POST",f,c);this.m_objHttpRequest.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=utf-8");this.m_objHttpRequest.send(b);}if(!c){if(4==this.m_objHttpRequest.readyState){if(200==this.m_objHttpRequest.status){return this.m_objHttpRequest.responseText;}else{mRe_ReportWebLog(this.m_objHttpRequest.status);}}return this._handleSyncHttpResponse();}};if(!Object.create){Object.create=function(c,a){if(typeof c!=="object"&&typeof c!=="function"){throw new TypeError("Object prototype may only be an Object: "+c);}else{if(c===null){throw new Error("This browser's implementation of Object.create is a shim and doesn't support 'null' as the first argument.");}}if(typeof a!="undefined"){throw new Error("This browser's implementation of Object.create is a shim and doesn't support a second argument.");}function b(){}b.prototype=c;return new b();};}if(window.addEventListener){addEventListener("message",receiveMessage,false);}else{attachEvent("onmessage",receiveMessage);}var m_reportHashMap=function(){};function createReport(b,c,d){if(null==d){mRe_ReportEventHandler(20);}var a=new Report(b,null,null,c,d);return a;}function createJSPReport(c,d,b,f){if(null==f){mRe_ReportEventHandler(20);}var a=new Report(c,d,b,null,f);return a;}function createImportJSPReport(b,d,c){if(null==c){mRe_ReportEventHandler(20);}var a=new Report(b,null,null,null,c);a.m_reportKey=d;return a;}Report.prototype.createUserProgress=function(a){if(this.m_isHybridProgress&&typeof ClipHybrid!="undefined"){ClipHybrid.showProgressbar();}else{this.removeUserProgress();if(typeof a=="undefined"){a="user_progress";}var b=document.createElement("div");b.className=a;b.style.cssText="position:absolute;left:0px;right:0px;top:0px;bottom:0px;overflow:hidden;background-repeat:no-repeat;z-index:500;";this.m_bodyDiv.appendChild(b);this.m_userProg=b;}};Report.prototype.removeUserProgress=function(){if(this.m_isHybridProgress&&typeof ClipHybrid!="undefined"){ClipHybrid.hideProgressbar();}else{if(null!=this.m_userProg){try{var a=this.m_userProg.parentElement;a.removeChild(this.m_userProg);this.m_userProg=null;}catch(b){this.debugMeg("프로그래스 DOM이 객체로만 존재합니다.");}}}};Report.prototype.removeHybridProgress=function(){if(this.m_isHybridProgress&&typeof ClipHybrid!="undefined"){ClipHybrid.hideProgressbar();}};Report.prototype.createProgress=function(){this.createEditableProgress(this.m_waitTime>1);};Report.prototype.removeEditableProgress=function(){this.removeUserProgress();};Report.prototype.createEditableProgress=function(d){if(typeof d=="undefined"){d=false;}if(this.m_isHybridProgress&&typeof ClipHybrid!="undefined"){ClipHybrid.showProgressbar();}else{this.removeUserProgress();var f=this.is_eForm?"eform_progress":"report_progress";var b=document.createElement("div");var c="";if(this.paintDiv.scrollLeft>0||this.paintDiv.scrollTop>0){c="position:absolute;left:"+this.paintDiv.scrollLeft+"px;width:"+(this.paintDiv.offsetWidth-20)+"px;top:"+this.paintDiv.scrollTop+"px;height:"+this.paintDiv.offsetHeight+"px;overflow:hidden;";}else{c="position:absolute;left:0px;right:0px;top:0px;bottom:0px;overflow:hidden;";}if(this.m_progress.URL==""){b.setAttribute("class",f);b.style.cssText=c;}else{c+="background-position:"+this.m_progress.x+" "+this.m_progress.y+";";c+="background-repeat:no-repeat;background-image:url("+this.m_progress.URL+");";b.style.cssText=c;}this.m_userProg=b;this.paintDiv.appendChild(b);if(d){var a=document.createElement("div");a.setAttribute("class",f+"_msg");a.innerText=this.m_languageMap.waitMsg;this.paintDiv.appendChild(a);}}this.debugMeg("report log :: 리포트 프로그래스 동작....");};Report.prototype.createPageSyncProgress=function(){var a=this.paintDiv.lastChild;if(null!=a){var b=a.getAttribute("class");if(b=="report_progress"){return;}}this.createEditableProgress();};Report.prototype.createPrintProgress=function(){this.disabledMenu(true);this.createEditableProgress();};Report.prototype.removePrintProgress=function(){if(!this.m_isPopupPrintView){this.disabledMenu(false);}try{this.removeEditableProgress();window.clearInterval(this.fileDownloadCheckTimer);clearListCookies(this.clientPath);this.isEnabledAdobeRead=true;this.debugMeg("report log :: 리포트 프로그래스 종료");if(null!=this.m_endPrintProgressEvent){this.m_endPrintProgressEvent();}}catch(a){ReportWebLog(a.stack);}};Report.prototype.createHWPProgress=function(){this.disabledMenu(true);this.createEditableProgress();};Report.prototype.removeHWPProgress=function(){this.disabledMenu(false);this.removeEditableProgress();window.clearInterval(this.fileDownloadCheckTimer);clearListCookies(this.clientPath);if(this.m_buttonEvent.endHWPButton!=null){this.m_buttonEvent.endHWPButton();}this.debugMeg("report log :: 리포트 프로그래스 종료");};Report.prototype.createEXCELProgress=function(){this.disabledMenu(true);this.createEditableProgress();};Report.prototype.removeEXCELProgress=function(){this.disabledMenu(false);this.removeEditableProgress();window.clearTimeout(this.fileDownloadCheckTimer);clearListCookies(this.clientPath);if(this.m_buttonEvent.endExcelButton!=null){this.m_buttonEvent.endExcelButton();}this.debugMeg("report log :: 리포트 프로그래스 종료");};Report.prototype.createSAVEProgress=function(){this.disabledMenu(true);var a=document.getElementById("re_iframe"+this.m_uid);a.src="about:blank";this.createEditableProgress();};Report.prototype.removeSAVEProgress=function(){this.disabledMenu(false);this.removeEditableProgress();window.clearInterval(this.fileDownloadCheckTimer);clearListCookies(this.clientPath);if(this.m_buttonEvent.endSaveButton!=null){this.m_buttonEvent.endSaveButton();}this.debugMeg("report log :: 리포트 프로그래스 종료");};Report.prototype.removePDFProgress=function(){this.disabledMenu(false);this.removeEditableProgress();window.clearInterval(this.fileDownloadCheckTimer);clearListCookies(this.clientPath);if(this.m_buttonEvent.endPDFButton!=null){this.m_buttonEvent.endPDFButton();}this.debugMeg("report log :: 리포트 프로그래스 종료");};Report.prototype.createEndReportProgress=function(){this.disabledMenu(true);this.createEditableProgress();};Report.prototype.removeEndReportProgress=function(){this.disabledMenu(false);this.removeUserProgress();this.debugMeg("report log :: 리포트 프로그래스 종료");};Report.prototype.directPDFPrint=function(){this.m_directPrint=true;if(this.is_eForm){if(this.multiView.isSocket){this.multiView.socket.connect();return;}}this.default_view();};Report.prototype.directHTMLPrint=function(){this.m_directPrint=true;this.m_directPrintHTML=true;if(this.is_eForm){if(this.multiView.isSocket){this.multiView.socket.connect();return;}}this.default_view();};Report.prototype.view=function(){if(this.is_eForm){if(this.multiView.isSocket){if(!this.multiView.socket.isMain){if(this.m_exeOption.isMirroringInternalEvent){if(this.m_exeOption.isMobile){}else{if((is_exeMirroring&&is_exeMirroringSub)&&("SubWebBrowserCtrl_EFormInitCompleted" in window.external)){window.external.SubWebBrowserCtrl_EFormInitCompleted();ReportWebLog("exeMirroring 시작합니다. 서브 이폼 초기화 ");}}}}}}if(this.is_eForm){if(this.multiView.isSocket){if(!this.multiView.socket.isSocketConn){this.multiView.socket.connect();return;}}}this.default_view();};Report.prototype.default_view=function(){try{this.m_isEndReportEvent=true;this.debugMeg("<<<<<<<<<<<< 리포트 디버깅 로그를 시작합니다 >>>>>>>>>>>>>>>");this.debugMeg("userAgent Check :: "+agt);this.debugMeg("PDF check :: "+m_report_printOption.acrobatVersion);if(!is_svg){if(this.is_eForm){this.debugMeg("report log :: IE8 버전 이하로 체크되었습니다. 웹이폼에서는 지원하지 않는 버전입니다.");return;}if(!this.m_isPaintImage){this.debugMeg("report log :: IE8 버전 이하로 체크되었습니다. 접근성 뷰어 일 경우 화면 비율를 100%로 고정합니다.");this.m_ratio="100%";this.m_disControl.zoomIn=true;}}if(this.m_reportKey!=null){this.checkReportCreate();}else{if(this.userJsp==null){this.newReportCreate(this.servletPath,this.oof);}else{this.newReportCreate(this.userJsp,null);}}}catch(f){ReportWebLog(f.stack);}try{var g=this.m_uid;var a=this.m_reportKey;var d=this.m_versionInfo.build;var b="1.0.0.0";if(typeof report_version!=="undefined"){b=report_version;}var c="None";if(typeof fileUUid!=="undefined"){c=fileUUid;}data={methodName:"onInit",data:{uid:g,result:a,viewVersion:b,serverVersion:d,fileUUid:c}};if(typeof getEFormInitRulesCommand!="undefined"){getEFormInitRulesCommand(data);}if(is_exeMirroringMain){window.external.ClipMainWebBrowserCtrl_Invoke(JSON.stringify(data));}}catch(f){ReportWebLog(f.stack);}if(this.is_eForm&&this.isMain){if(window.m_clipGlobalEForm==null){document.addEventListener("keydown",function(h){if(null!=window.m_clipTabPlugin){window.m_clipTabPlugin.tabList[window.m_clipTabPlugin.nSelectedIndex].report.accesskeyEvent(h);}else{window.m_clipGlobalEForm.accesskeyEvent(h);}});}window.m_clipGlobalEForm=this;}};Report.prototype.accesskeyEvent=function(b){if(this.isViewDisabled()){return;}if(b.altKey){var d="50000";if(is_ie){switch(b.keyCode){case 88:d="x";break;case 120:d="x";break;case 81:d="q";break;case 113:d="q";break;case 188:d="q";break;case 189:d="q";break;case 87:d="w";break;case 119:d="w";break;case 187:d="w";break;case 190:d="w";break;case 82:d="r";break;case 114:d="r";break;case 84:d="t";break;case 116:d="t";break;case 79:d="o";break;case 111:d="o";break;case 65:d="a";break;case 97:d="a";break;case 83:d="s";break;case 115:d="s";break;case 219:d="[";break;case 221:d="]";break;case 39:d="'";break;}}else{d=b.key.toLowerCase();switch(d){case"<":case",":case"-":case"_":d="q";break;case".":case">":case"=":case"+":d="w";break;}}if(!this.eFormDoodleOption.is_Ds&&!this.m_isMemoEnabled){if(d=="q"){if(this.prev_button.style.display!="none"){this.previousPage("keyboard");}}else{if(d=="w"){if(this.next_button.style.display!="none"){this.nextPage("keyboard");}}else{if(d=="a"){if(this.first_button.style.display!="none"){this.firstPage("keyboard");}}else{if(d=="s"){if(this.last_button.style.display!="none"){this.lastPage("keyboard");}}else{if(d=="r"){if(this.doodle_button.style.display!="none"){this.EFormDoodle();}}else{if(d=="t"){if(this.memo_button.style.display!="none"){this.EFormMemo(true);}}else{if(d=="o"){if(this.save_button.style.display!="none"){this.EFormSave();}}else{if(d=="["){this.changeRatioCombo("PageWidth");}else{if(d=="]"){this.changeRatioCombo("WholePage");}else{if(d=="'"){this.changeRatioCombo("100%");}}}}}}}}}}}else{if(this.eFormDoodleOption.is_Ds){if(d=="q"){var g=document.getElementById("re_doodleprev"+this.m_uid);if(null!=g&&g.style.display!="none"){this.previousDoodlePage("keyboard");}}else{if(d=="w"){var f=document.getElementById("re_doodlenext"+this.m_uid);if(null!=f&&f.style.display!="none"){this.nextDoodlePage("keyboard");}}}}}if(d=="x"){if(this.eFormDoodleOption.is_Ds){var c=document.getElementById("re_doodleclose"+this.m_uid);if(null!=c&&c.style.display!="none"){this.closeDoodle();}}else{if(this.m_isMemoEnabled){var a=document.getElementById("re_memoclose"+this.m_uid);if(null!=a&&a.style.display!="none"){this.closeMemo(false);}}}}}};Report.prototype.debugMeg=function(b,a){try{if(this.m_debug.isDebug){if(is_exeMirroring){if(is_exeMirroringMain){window.external.MainWebBrowserCtrl_DebugLog(b);}else{if(is_exeMirroringSub){window.external.SubWebBrowserCtrl_DebugLog(b);}}}else{if(this.m_debug.isConsole){window.console.log(b);}else{this.m_debug.message.push(b);}}if(null!=a){this.m_debug.isLock=a;}}}catch(c){window.console.log("삭제된 뷰어 보입니다. 뷰어 코드 : "+this.m_uid);window.console.log(c.stack);}};Report.prototype.endDebugMeg=function(a){if(this.m_debug.isDebug){if(!this.m_debug.isConsole){if(!a||(this.m_debug.isLock==a)){alert(this.m_debug.message.join("\n"));this.m_debug.message=new Array();this.m_debug.isLock=false;}}}};Report.prototype.setSlidePage=function(a){this.m_isSlidePage=a;};Report.prototype.mRe_DirectPrintCall=function(){if(this.m_directPrintOp.endReport){this.m_directPrintOp.endReport=false;window.clearInterval(this.m_directPrintOp.key);this.m_directPrintOp.key=null;if(this.m_directPrintHTML){this.printHTMLView();}else{this.printView();}}};Report.prototype.createView=function(y,u){y.innerHTML="";var n=new Array();var w="";var c,o;this.debugMeg("report log :: 리포트 뷰어를 생성합니다...");this.isMakePDFFrame=false;if(this.m_directPrint){var v=this;this.m_directPrintOp.key=window.setInterval(function(){v.mRe_DirectPrintCall();},300);y.style.cssText+="position:absolute !important;width:1px !important;height:1px !important;visibility:hidden !important;opacity:0 !important;filter:alpha(opacity=0) !important;";}if(this.m_isFadeView){c=y.style.width;o=y.style.height;$(y).css({width:"0px",height:"0px",opacity:"0"});}var f=document.createElement("div");f.style.cssText="position:absolute;left:0px;right:0px;top:0px;bottom:0px;border:0px solid;overflow:hidden;";y.appendChild(f);if(this.is_eForm){if(this.eForm_isNecessary.is_start){this.eForm_isNecessary.check=true;}this.eformCreateTag(f,u);}else{var z=null;if(is_mobile){this.debugMeg("report log :: 모바일 환경으로 체크됨");z=this.mobileCreateTag(f,u,false);}else{if(is_tablet){this.debugMeg("report log :: 테블릿 pc 환경으로 체크됨");z=this.mobileCreateTag(f,u,true);}else{this.debugMeg("report log :: 데스트탑 pc 환경으로 체크됨");z=this.pcCreateTag(f,u);}}if(null!=z){for(var s=0;s<this.m_menuCustomButton.length;s++){var a=this.m_menuCustomButton[s];var q=a.elm;q.className=(is_smartphone?"mobile_menu_button ":"report_menu_button ")+a.css;q.style.cssText=a.style;q.innerText=a.text;q.onclick=a.func;z.appendChild(q);}}}var h=mRe_makeFormTag("re_form"+u);f.appendChild(h);h.appendChild(mRe_makeInputTag("re_form_clipid"+u,"ClipID"));h.appendChild(mRe_makeInputTag("re_form_uid"+u,"uid"));h.appendChild(mRe_makeInputTag("re_form_clipUID"+u,"clipUID"));h.appendChild(mRe_makeInputTag("re_form_print"+u,"print"));h.appendChild(mRe_makeInputTag("re_form_printImage"+u,"isPDFPrintImage"));h.appendChild(mRe_makeInputTag("re_form_printBarcodeAWT"+u,"isPDFPrintBarcodeAWT"));h.appendChild(mRe_makeInputTag("re_form_path"+u,"path"));h.appendChild(mRe_makeInputTag("re_form_option"+u,"optionValue"));h.appendChild(mRe_makeInputTag("re_form_ChromeFitToPage"+u,"isChromePrintFitToPage"));h.appendChild(mRe_makeInputTag("re_form_s_time"+u,"s_time"));if(this.m_postParam!=null){var x=this.m_postParam.paramList;for(var k=0;k<x.length;k++){h.appendChild(mRe_makeInputTag(null,x[k][0],x[k][1]));}}h=mRe_makeFormTag("re_saveform"+u);f.appendChild(h);h.appendChild(mRe_makeInputTag("re_saveform_clipid"+u,"ClipID"));h.appendChild(mRe_makeInputTag("re_saveform_uid"+u,"uid"));h.appendChild(mRe_makeInputTag("re_saveform_clipUID"+u,"clipUID"));h.appendChild(mRe_makeInputTag("re_saveform_path"+u,"path"));h.appendChild(mRe_makeInputTag("re_saveform_option"+u,"optionValue"));h.appendChild(mRe_makeInputTag("re_saveform_is_ie"+u,"is_ie",((!is_firefox)&&(!is_safari)&&(!is_apple))));h.appendChild(mRe_makeInputTag("re_saveform_fileName"+u,"exportN"));h.appendChild(mRe_makeInputTag("re_saveform_fileType"+u,"exportType"));h.appendChild(mRe_makeInputTag("re_saveform_mobile"+u,"isSmartPhone","false"));if(this.m_postParam!=null){var x=this.m_postParam.paramList;for(var k=0;k<x.length;k++){h.appendChild(mRe_makeInputTag(null,x[k][0],x[k][1]));}}var b=document.createElement("iframe");b.id="re_iframe"+u;b.name="re_target"+u;b.title="파일 저장용 프레임";b.style.cssText="position:absolute;left:0px;top:0px;height:1px;width:1px;visibility:hidden";f.appendChild(b);b=document.createElement("iframe");b.id="re_iframe2"+u;b.name="re_target2"+u;b.title="PDF 인쇄용 프레임";b.style.cssText="position:absolute;left:0px;top:0px;height:1px;width:1px;visibility:hidden";f.appendChild(b);var l=document.createElement("img");l.id="re_deleteImg"+u;l.alt="삭제용 프로그래스";l.style.cssText="display:none";f.appendChild(l);b=document.createElement("iframe");b.id="re_iframe3"+u;b.title="html 인쇄용 프레임";b.style.cssText="position:absolute;left:0px;top:0px;height:1px;width:1px;visibility:hidden";f.appendChild(b);var r=mRe_getFontCSSNameList();for(var k=0;k<r.length;k++){var m=document.createElement("div");m.style.cssText="position:absolute;left:0px;top:0px;height:1px;width:1px;visibility:hidden;font-family:"+r[k];m.innerHTML="a";f.appendChild(m);}this.debugMeg("report log :: 리포트 뷰어 완성....");this.m_bodyDiv=f;this.paintDiv=document.getElementById("re_paintDiv"+u);this.menuDiv=document.getElementById("re_menu"+u);if(this.is_eForm){this.doodleDiv=document.getElementById("re_doodleDiv"+u);this.doodle_button=document.getElementById("re_doodle"+u);this.menuDiv.addEventListener("touchstart",function(A){if(A.touches.length>1){A.preventDefault();}},false);this.memoDiv=document.getElementById("re_memoDiv"+u);this.memo_button=document.getElementById("re_memo"+u);this.searchWord_button=document.getElementById("re_searchWord"+u);}this.input=document.getElementById("re_input"+u);this.totalCountSpan=document.getElementById("re_totalCount"+u);this.totalCountText=document.getElementById("re_totalCountNumber"+u);this.progressImg=document.getElementById("re_progressImg"+u);this.zoomCombo=document.getElementById("re_zoomSelect"+u);this.next_button=document.getElementById("re_next"+u);this.prev_button=document.getElementById("re_prev"+u);this.first_button=document.getElementById("re_first"+u);this.last_button=document.getElementById("re_last"+u);this.save_button=document.getElementById("re_save"+u);this.print_button=document.getElementById("re_print"+u);this.pdf_button=document.getElementById("re_pdf"+u);this.hwp_button=document.getElementById("re_hwp"+u);this.doc_button=document.getElementById("re_doc"+u);this.excel_button=document.getElementById("re_excel"+u);this.reportInfo_button=document.getElementById("re_reportInfo"+u);this.close_button=document.getElementById("re_close"+u);this.formTag=document.getElementById("re_form"+u);this.formTag_clipid=document.getElementById("re_form_clipid"+u);this.formTag_uid=document.getElementById("re_form_uid"+u);this.formTag_clipUID=document.getElementById("re_form_clipUID"+u);this.formTag_print=document.getElementById("re_form_print"+u);this.formTag_printImage=document.getElementById("re_form_printImage"+u);this.formTag_printBarcodeAWT=document.getElementById("re_form_printBarcodeAWT"+u);this.formTag_path=document.getElementById("re_form_path"+u);this.formTag_option=document.getElementById("re_form_option"+u);this.formTag_ChromeFitToPage=document.getElementById("re_form_ChromeFitToPage"+u);this.formTag_s_time=document.getElementById("re_form_s_time"+u);this.saveFormTag.form=document.getElementById("re_saveform"+u);this.saveFormTag.clipid=document.getElementById("re_saveform_clipid"+u);this.saveFormTag.uid=document.getElementById("re_saveform_uid"+u);this.saveFormTag.clipUID=document.getElementById("re_saveform_clipUID"+u);this.saveFormTag.path=document.getElementById("re_saveform_path"+u);this.saveFormTag.option=document.getElementById("re_saveform_option"+u);this.saveFormTag.filename=document.getElementById("re_saveform_fileName"+u);this.saveFormTag.filetype=document.getElementById("re_saveform_fileType"+u);this.saveFormTag.isMobile=document.getElementById("re_saveform_mobile"+u);this.deleteImgTag=document.getElementById("re_deleteImg"+u);var t=document.getElementById("re_iframe"+u);var d=document.getElementById("re_iframe2"+u);var g=document.getElementById("re_iframe3"+u);d.src="about:blank";g.src="about:blank";if(!is_ie){if(this.m_isCrossDomainPDF){if(-1!=this.servletPath.indexOf("?")){var j="uid="+u+"&clipUID="+u+"&ClipID=R15&localSave="+this.m_is_serverSaveFile;if(this.m_postParam!=null){j+=this.m_postParam.getParam();}var i=this.servletPath+"&"+j;d.src=i;}else{var h=mRe_makeFormTag(null,this.servletPath,"re_target"+this.m_uid);h.appendChild(mRe_makeInputTag(null,"uid",this.m_uid));h.appendChild(mRe_makeInputTag(null,"clipUID",this.m_uid));h.appendChild(mRe_makeInputTag(null,"ClipID","R15"));h.appendChild(mRe_makeInputTag(null,"localSave",this.m_is_serverSaveFile));if(this.m_postParam!=null){var x=this.m_postParam.paramList;for(var k=0;k<x.length;k++){h.appendChild(mRe_makeInputTag(null,x[k][0],x[k][1]));}}this.targetDiv.appendChild(h);h.submit();this.targetDiv.removeChild(h);}this.isMakePDFFrame=true;}}if(!this.is_eForm&&!is_smartphone){var p={isArea:true,x1:0,x2:0,y1:0,y2:0};if(this.paintDiv.addEventListener){this.paintDiv.addEventListener("mousedown",function(A){if(this.offsetWidth-20<A.clientX||this.offsetHeight-20<A.clientY){p.isNotArea=false;}else{p.isNotArea=true;p.x1=A.clientX;p.y1=A.clientY;}},false);this.paintDiv.addEventListener("mouseup",function(A){if(p.isNotArea){p.x2=A.clientX;p.y2=A.clientY;this.scrollLeft+=(p.x1-p.x2);this.scrollTop+=(p.y1-p.y2);}},false);}}if(this.m_isFadeView){$(y).attr("uid",this.m_uid).animate({width:c,height:o,opacity:1},400,function(){$(this).removeAttr("uid");});}if(this.is_eForm){this.createEFormView();}if(0!=this.paintDiv.clientWidth&&0!=this.paintDiv.clientHeight){window.m_G_DivWidth=this.paintDiv.clientWidth;window.m_G_DivHeight=this.paintDiv.clientHeight;}};Report.prototype.pcCreateTag=function(o,p){var b=is_svg?"_svg":"_png";var j="";var q=this;var y=mRe_makeDivTag("re_menu"+p,"report_menu_div",((this.m_isMenu)?"":"height:0px;display:none;")+(null!=this.menuDiv?this.menuDiv:""));o.appendChild(y);var u=mRe_makeTableNobrTag(y,null,null,"report_menu_table","report_menu_table_td","report_menu_table_td_div");j=this.m_disControl.save?"_dis":"";var d=mRe_makeButtonTag("re_save"+p,this.m_languageMap.save,"report_menu_button report_menu_save_button "+("report_menu_save_button"+b+j),(null!=this.save_button?this.save_button:""),this.m_disControl.save,function(){q.exportView();return false;});u.appendChild(d);j=this.m_disControl.pdf?"_dis":"";var h=mRe_makeButtonTag("re_pdf"+p,this.m_languageMap.pdf_save,"report_menu_button report_menu_pdf_button "+("report_menu_pdf_button"+b+j),(null!=this.pdf_button?this.pdf_button:""),this.m_disControl.pdf,function(){q.pdfDownLoad();return false;});u.appendChild(h);j=this.m_disControl.excel?"_dis":"";var m=mRe_makeButtonTag("re_excel"+p,this.m_languageMap.excel_save,"report_menu_button report_menu_excel_button "+("report_menu_excel_button"+b+j),(null!=this.excel_button?this.excel_button:""),this.m_disControl.excel,function(){q.excelDownLoad();return false;});u.appendChild(m);j=this.m_disControl.hwp?"_dis":"";var f=mRe_makeButtonTag("re_hwp"+p,this.m_languageMap.hwp_save,"report_menu_button report_menu_hwp_button "+("report_menu_hwp_button"+b+j),(null!=this.hwp_button?this.hwp_button:""),this.m_disControl.hwp,function(){q.hwpDownLoad();return false;});u.appendChild(f);j=this.m_disControl.doc?"_dis":"";var n=mRe_makeButtonTag("re_doc"+p,this.m_languageMap.doc_save,"report_menu_button report_menu_doc_button "+("report_menu_doc_button"+b+j),(null!=this.doc_button?this.doc_button:""),this.m_disControl.doc,function(){q.docDownLoad();return false;});u.appendChild(n);j=this.m_disControl.print?"_dis":"";var n=mRe_makeButtonTag("re_print"+p,this.m_languageMap.print,"report_menu_button report_menu_print_button "+("report_menu_print_button"+b+j),(null!=this.print_button?this.print_button:""),this.m_disControl.print,function(){q.printWindowView();return false;});u.appendChild(n);j=this.m_disControl.first?"_dis":"";var t=mRe_makeButtonTag("re_first"+p,this.m_languageMap.first_page,"report_menu_button report_menu_leftEnd_button "+("report_menu_leftEnd_button"+b+j),(null!=this.first_button?this.first_button:""),this.m_disControl.first,function(){q.firstPage("menu_button");return false;});u.appendChild(t);j=this.m_disControl.prev?"_dis":"";var x=mRe_makeButtonTag("re_prev"+p,this.m_languageMap.prv_page,"report_menu_button report_menu_left_button "+("report_menu_left_button"+b+j),(null!=this.prev_button?this.prev_button:""),this.m_disControl.prev,function(){q.previousPage("menu_button");return false;});u.appendChild(x);var r=mRe_makeMenuInputTag("re_input"+p,"","1","report_menu_pageCount_input",this.m_languageMap.page,(null!=this.input?(typeof this.input==="string"?this.input:this.input.style.cssText):""));r.disabled=this.m_disControl.input;r.onkeypress=function(z){enterEvent(z,q,this);};r.onblur=function(z){q.selectPage(Number(this.value)-1,"menu_input");};u.appendChild(r);var a=mRe_makeMenuInputTag("re_totalCountNumber"+p,"",this.m_TPC.before+"0"+this.m_TPC.after,"report_menu_pageCount_span",this.m_languageMap.total_page,(null!=this.totalCountSpan?this.totalCountSpan:""));a.disabled=this.m_disControl.caption;a.readOnly=true;u.appendChild(a);var v=document.createElement("span");v.id="re_totalCount"+p;v.className="report_menu_pageCount_span";v.style.cssText="border:0px;"+(null!=this.totalCountSpan?this.totalCountSpan:"");v.onclick=function(z){q.mRe_pageCountLabelClick();return false;};u.appendChild(v);var w=document.createElement("img");w.alt="프로그래스";w.id="re_progressImg"+p;w.className="report_menu_progress";w.src=progressImg();v.appendChild(w);j=this.m_disControl.next?"_dis":"";var k=mRe_makeButtonTag("re_next"+p,this.m_languageMap.next_page,"report_menu_button report_menu_right_button "+("report_menu_right_button"+b+j),(null!=this.next_button?this.next_button:""),this.m_disControl.next,function(){q.nextPage("menu_button");return false;});u.appendChild(k);j=this.m_disControl.last?"_dis":"";var i=mRe_makeButtonTag("re_next"+p,this.m_languageMap.next_page,"report_menu_button report_menu_rightEnd_button "+("report_menu_rightEnd_button"+b+j),(null!=this.last_button?this.last_button:""),this.m_disControl.last,function(){q.lastPage("menu_button");return false;});u.appendChild(i);var g=document.createElement("select");g.id="re_zoomSelect"+p;g.name="zoomSelect";g.title=this.m_languageMap.zoomIn;g.className="report_menu_zoom_combo";g.style.cssText=((is_ie6||is_ie7)?"top:5px;":"")+(null!=this.zoomCombo?this.zoomCombo:"");g.disabled=this.m_disControl.zoomIn;g.onchange=function(){q.zoomIn(this);};this.comboOptionCreateTag(g);u.appendChild(g);j=this.m_disControl.reportInfo?"_dis":"";var l=mRe_makeButtonTag("re_reportInfo"+p,this.m_languageMap.report_info,"report_menu_button report_menu_reportInfo_button "+("report_menu_reportInfo_button"+b+j),(null!=this.reportInfo_button?this.reportInfo_button:""),this.m_disControl.reportInfo,function(){q.reportInfo();return false;});u.appendChild(l);j=this.m_disControl.close?"_dis":"";var c=mRe_makeButtonTag("re_close"+p,this.m_languageMap.close,"report_menu_button report_menu_close_button "+("report_menu_close_button"+b+j),(null!=this.close_button?this.close_button:""),this.m_disControl.close,function(){q.closeReport();return false;});u.appendChild(c);var s=mRe_makeDivTag("re_paintDiv"+p,"report_paint_div",((this.m_isMenu)?"":"top:0px;")+(null!=this.paintDiv?(typeof this.paintDiv==="string"?this.paintDiv:this.paintDiv.style.cssText):""));s.name="CLIP_REPORT_DIV";s.onscroll=function(z){q.pageScrollEvent(z);};if(is_firefox){s.onwheel=function(z){if(q.zoomCombo.value=="WholePage"){if(q.mRe_wheelTimeout==null){q.pageMousewheelEvent(z);}clearTimeout(q.mRe_wheelTimeout);q.mRe_wheelTimeout=setTimeout(function(){q.mRe_wheelTimeout=null;},300);}else{q.pageMousewheelEvent(z);}};}else{s.onmousewheel=function(z){if(q.zoomCombo.value=="WholePage"){if(q.mRe_wheelTimeout==null){q.pageMousewheelEvent(z);}clearTimeout(q.mRe_wheelTimeout);q.mRe_wheelTimeout=setTimeout(function(){q.mRe_wheelTimeout=null;},300);}else{q.pageMousewheelEvent(z);}};}o.appendChild(s);return u;};Report.prototype.mobileCreateTag=function(j,k,m){var l=this;var v=mRe_makeDivTag("re_menu"+k,"mobile_menu_div",((this.m_isMenu)?"":"height:0px;display:none;")+(null!=this.menuDiv?this.menuDiv:""));j.appendChild(v);var q=mRe_makeTableNobrTag(v,null,null,"report_menu_table","report_menu_table_td","mobile_menu_table_td_div");var r=this.m_disControl.save||this.m_disControl.pdf;this.m_disControl.save=r;this.m_disControl.pdf=r;var b=mRe_makeButtonTag("re_print"+k,this.m_languageMap.pdf_save,"mobile_menu_button "+(r?"mobile_menu_dis_print_button":"mobile_menu_print_button"),(null!=this.print_button?this.print_button:""),r,function(){l.printMobileView();return false;});if(is_KakaoApp){b.style.display="none";}q.appendChild(b);var p=mRe_makeButtonTag("re_first"+k,this.m_languageMap.first_page,"mobile_menu_button "+(this.m_disControl.first?"mobile_menu_dis_leftEnd_button":"mobile_menu_leftEnd_button"),(null!=this.first_button?this.first_button:""),this.m_disControl.first,function(){l.firstPage("menu_button");return false;});q.appendChild(p);var u=mRe_makeButtonTag("re_prev"+k,this.m_languageMap.prv_page,"mobile_menu_button "+(this.m_disControl.prev?"mobile_menu_dis_left_button":"mobile_menu_left_button"),(m?"":"display:none;")+(null!=this.prev_button?this.prev_button:""),this.m_disControl.prev,function(){l.previousPage("menu_button");return false;});q.appendChild(u);var i=mRe_makeTableTag(q,null,(m?"left:200px;":null),"mobile_input_table","mobile_input_table_td_input");var n=mRe_makeMenuInputTag("re_input"+k,"","1","mobile_menu_pageCount_input",this.m_languageMap.page,"border:0px none !important;"+(null!=this.input?(typeof this.input==="string"?this.input:this.input.style.cssText):""));n.disabled=this.m_disControl.input;n.onkeypress=function(w){enterEvent(w,l,this);};n.onblur=function(w){l.selectPage(Number(this.value)-1,"menu_input");};i.appendChild(n);var s=document.createElement("td");s.className="mobile_input_table_td";s.onclick=function(){l.mRe_pageCountLabelClick();return false;};i.parentElement.appendChild(s);var h=mRe_makeMenuInputTag("re_totalCountNumber"+k,"",this.m_TPC.before+"0"+this.m_TPC.after,"mobile_menu_pageCount_span",this.m_languageMap.total_page,(null!=this.totalCountSpan?this.totalCountSpan:""));h.readOnly=true;s.appendChild(h);var t=document.createElement("span");t.id="re_totalCount"+k;t.className="mobile_menu_pageCount_span";t.style.cssText="border:0px none !important;"+(null!=this.totalCountSpan?(typeof this.totalCountSpan==="string"?this.totalCountSpan:this.totalCountSpan.style.cssText):"");t.disabled=this.m_disControl.caption;s.appendChild(t);var d=document.createElement("img");d.id="re_progressImg"+k;d.alt="리포트 생성중 표시";d.className="report_menu_progress";d.src=progressImg();t.appendChild(d);var g=mRe_makeButtonTag("re_next"+k,this.m_languageMap.next_page,"mobile_menu_button "+(this.m_disControl.next?"mobile_menu_dis_right_button":"mobile_menu_right_button"),(m?"":"display:none;")+(null!=this.next_button?this.next_button:""),this.m_disControl.next,function(){l.nextPage("menu_button");return false;});q.appendChild(g);var f=mRe_makeButtonTag("re_last"+k,this.m_languageMap.last_page,"mobile_menu_button "+(this.m_disControl.last?"mobile_menu_dis_rightEnd_button":"mobile_menu_rightEnd_button"),(m?"":"left:295px;")+(null!=this.last_button?this.last_button:""),this.m_disControl.last,function(){l.lastPage("menu_button");return false;});q.appendChild(f);var c=document.createElement("select");c.id="re_zoomSelect"+k;c.name="zoomSelect";c.title=this.m_languageMap.zoomIn;c.className="mobile_menu_zoom_combo";c.style.cssText=(m?"":"display:none;")+(null!=this.zoomCombo?this.zoomCombo:"");c.disabled=this.m_disControl.zoomIn;c.onchange=function(){l.zoomIn(this);};this.comboOptionCreateTag(c);q.appendChild(c);var a=mRe_makeButtonTag("re_close"+k,this.m_languageMap.close,"mobile_menu_button "+(this.m_disControl.close?"mobile_menu_dis_close_button":"mobile_menu_close_button"),(null!=this.close_button?this.close_button:""),this.m_disControl.close,function(){l.closeReport();return false;});q.appendChild(a);var o=mRe_makeDivTag("re_paintDiv"+k,"mobile_paint_div",((this.m_isMenu)?"":"top:0px;")+(null!=this.paintDiv?(typeof this.paintDiv==="string"?this.paintDiv:this.paintDiv.style.cssText):""));o.name="CLIP_REPORT_DIV";o.onscroll=function(w){l.pageScrollEvent(w);};if(is_firefox){o.onwheel=function(w){if(l.zoomCombo.value=="WholePage"){if(l.mRe_wheelTimeout==null){l.pageMousewheelEvent(w);}clearTimeout(l.mRe_wheelTimeout);l.mRe_wheelTimeout=setTimeout(function(){l.mRe_wheelTimeout=null;},300);}else{l.pageMousewheelEvent(w);}};}else{o.onmousewheel=function(w){if(l.zoomCombo.value=="WholePage"){if(l.mRe_wheelTimeout==null){l.pageMousewheelEvent(w);}clearTimeout(l.mRe_wheelTimeout);l.mRe_wheelTimeout=setTimeout(function(){l.mRe_wheelTimeout=null;},300);}else{l.pageMousewheelEvent(w);}};}j.appendChild(o);return q;};Report.prototype.comboOptionCreateTag=function(l){if(this.m_comboNames.num50.visible){var f=mRe_makeOptionTag(l,"p50","0.5",this.m_comboNames.num50.name);if("50%"==this.m_ratio){f.selected=true;}}if(this.m_comboNames.num75.visible){var h=mRe_makeOptionTag(l,"p75","0.75",this.m_comboNames.num75.name);if("75%"==this.m_ratio){h.selected=true;}}if(this.m_comboNames.num100.visible){var c=mRe_makeOptionTag(l,"p100","1",this.m_comboNames.num100.name);if("100%"==this.m_ratio){c.selected=true;}}if(this.m_comboNames.num125.visible){var d=mRe_makeOptionTag(l,"p125","1.25",this.m_comboNames.num125.name);if("125%"==this.m_ratio){d.selected=true;}}if(this.m_comboNames.num150.visible){var j=mRe_makeOptionTag(l,"p150","1.5",this.m_comboNames.num150.name);if("150%"==this.m_ratio){j.selected=true;}}if(this.m_comboNames.num200.visible){var i=mRe_makeOptionTag(l,"p200","2",this.m_comboNames.num200.name);if("200%"==this.m_ratio){i.selected=true;}}if(this.m_comboNames.num300.visible){if(!(is_smartphone&&this.m_isObjJSONViewType=="canvas")){var k=mRe_makeOptionTag(l,"p300","3",this.m_comboNames.num300.name);if("300%"==this.m_ratio){k.selected=true;}}else{this.m_comboNames.num300.visible=false;}}if(this.m_comboNames.num400.visible){if(!(is_smartphone&&this.m_isObjJSONViewType=="canvas")){var b=mRe_makeOptionTag(l,"p400","4",this.m_comboNames.num400.name);if("400%"==this.m_ratio){b.selected=true;}}else{this.m_comboNames.num400.visible=false;}}if(this.m_comboNames.pagewidth.visible){var a=mRe_makeOptionTag(l,"pWidth","PageWidth",this.m_comboNames.pagewidth.name);if("PageWidth"==this.m_ratio){a.selected=true;}}if(this.m_comboNames.wholepage.visible){var g=mRe_makeOptionTag(l,"pWholePage","WholePage",this.m_comboNames.wholepage.name);if("WholePage"==this.m_ratio){g.selected=true;}}};Report.prototype.setPaintDivEvent=function(c,a){if(is_smartphone&&!this.is_eForm){var b=this;if(null!=this.m_PageMove&&!this.m_PageMove.ButtonDisabled&&!this.m_PageMove.isStatic){c.ontouchstart=function(d){if(d.touches.length==1){b.createPageMoveButton("report");}};}else{if(!this.m_isSwipe){c.ontouchstart=function(f){if(f.touches.length==1){var h=f.touches[0];var d,g;if(is_PosiFix){d=h.clientX;g=h.clientY;}else{d=h.pageX;g=h.pageY;}b.swipeOption.is_start=true;b.swipeOption.s_x=d;b.swipeOption.s_y=g;b.swipeOption.e_x=0;b.swipeOption.e_y=0;}};c.ontouchmove=function(f){if(f.touches.length==1){if(b.swipeOption.is_start){var d,g;if(is_PosiFix){d=f.touches[0].clientX;g=f.touches[0].clientY;}else{d=f.touches[0].pageX;g=f.touches[0].pageY;}if(b.swipeOption.is_start){b.swipeOption.e_x=d;b.swipeOption.e_y=g;}}}};c.ontouchend=function(f){if(b.swipeOption.is_start){b.swipeOption.is_start=false;var h=f.changedTouches[0];var d,g;if(is_PosiFix){d=h.clientX;g=h.clientY;}else{d=h.pageX;g=h.pageY;}if(b.swipeOption.s_x-b.swipeOption.e_x>140&&b.swipeOption.e_x!=0){b.swipeEForm(0);}if(b.swipeOption.s_x-b.swipeOption.e_x<-140&&b.swipeOption.e_x!=0){b.swipeEForm(1);}b.swipeOption.s_x=0;b.swipeOption.s_y=0;b.swipeOption.e_x=0;b.swipeOption.e_y=0;}b.swipeOption.is_start=false;};}}}};Report.prototype.newReportCreate=function(f,a){var j=null;this.debugMeg("report log :: 리포트를 생성하기 위하여 통신 준비중....");if(a!=null){this.debugMeg("report log :: 사용할 OOF 문서 >>> "+a);if(this.m_isEncode){a=mCR_Base64.encode(a);}j="isEncoding="+this.m_isEncode+"&isBigData="+this.m_isBigData+"&isMemoryDump="+this.m_isMemoryDump+"&ClipID=R01&oof="+encodeURIComponent(a);if(this.m_postParam!=null){j+=this.m_postParam.getParam();}}else{if(this.postData!=null){j=this.postData;}}j=mRe_onBeforeSend(j);this.debugMeg("report log :: 서버 통신 주소  >>> "+f);try{if(this.m_isCrossDomain){var g=this;if(window.XDomainRequest){var d=new XDomainRequest();var b=f+"?"+j;if(d){d.onload=function(){g.resultNewReport(mRe_onAfterSend(d.responseText));};d.onerror=function(){g.debugMeg("report log :: IE8 크로스도메인 오류 발생 .. ");mRe_ReportEventHandler(40);g.endDebugMeg(false);};d.open("GET",b);d.send();}}else{$.ajax({type:"POST",url:f,crossDomain:true,data:j,success:function(k){g.resultNewReport(mRe_onAfterSend(k));},error:function(k){g.debugMeg("report log :: 서버 통신 오류 발생 >>> "+k);mRe_ReportEventHandler(40);g.endDebugMeg(false);}});}}else{var c=new HttpClient();var i=c.send(f,j,false,null);this.resultNewReport(mRe_onAfterSend(i));}}catch(h){this.debugMeg("report log :: 서버 통신 오류 발생 >>> ajax 통신 상태 "+h.stack);mRe_ReportEventHandler(40);this.endDebugMeg(false);}};Report.prototype.resultNewReport=function(a){this.debugMeg("report log :: 리포트 생성 통신 완료..!");this.m_reportKey=a;var c=objectCall(ClipStrTrim(a));if(typeof c=="string"){c=objectCall(c);}this.m_versionInfo=c.version;this.debugMeg("report log :: 리포트 서버 버전 >>> "+c.version.build);if(typeof window.report_version!="undefined"){this.debugMeg("report log :: 리포트 웹뷰어 버전 >>> "+report_version);}else{this.debugMeg("report log :: 리포트 웹뷰어 버전 >>> 확인불가");}if(c.status){var b=this.m_versionInfo.build.substring(6).replace(/\_([0-9a-zA-Z]+)/g,"");if(118>Number(b)&&!this.m_versionInfo.build.charAt(0)=="5"){this.m_is_serverSaveFile=false;}this.m_uid=c.uid;this.debugMeg("report log :: 리포트 실행 및 키 발행 정상");this.debugMeg("report log :: 리포트 키 >>> "+c.uid);m_reportHashMap[c.uid]=this;if(null!=c.wait){if(c.wait>=2){this.m_waitTime=c.wait;}}this.m_languageMap=mRe_report_language(this.m_language);if(this.m_isViewer){this.createView(this.targetDiv,c.uid);this.createProgress();}this.checkPageCount();if(c.printerList!=null&&c.printerList.length>0){this.printOptionValue.isNetPrint=true;this.printOptionValue.netPrintList=c.printerList;}}else{this.debugMeg("report log :: 리포트 실행 실패");this.debugMeg("report log :: 리포트 키 >>> "+c.uid);this.m_uid=c.uid;m_reportHashMap[c.uid]=this;this.m_languageMap=mRe_report_language(this.m_language);if(this.m_isViewer){this.createView(this.targetDiv,c.uid);this.progressImg.style.display="none";}if(c.event>999){this.debugMeg("report log :: 리포트 라이센스 불일치 >>> LE0"+c.event);if(this.m_isViewer){this.paintDiv.innerHTML=this.m_languageMap.lic_error+".!! (errorCode : LE0"+c.event+")";}mRe_ReportEventHandler(c.event);this.endDebugMeg(false);}else{if(c.event<13){this.debugMeg("report log :: 리포트 서버 인스톨 실패 >>> IE00"+c.event);if(this.m_isViewer){this.paintDiv.innerHTML=this.m_languageMap.install_error+"!! (errorCode : IE00"+c.event+")";}mRe_ReportEventHandler(c.event);this.endDebugMeg(false);}else{this.debugMeg("report log :: 리포트 서버에서 리포트 생성중 오류 발생. 서버 로그 확인 필요!!");if(this.m_isViewer){this.paintDiv.innerHTML=this.m_languageMap.report_error;}mRe_ReportEventHandler(30);this.endDebugMeg(false);}}}};Report.prototype.checkReportCreate=function(){try{var b=this.m_reportKey;var c=objectCall(ClipStrTrim(b));if(typeof c=="string"){c=objectCall(c);}this.m_versionInfo=c.version;this.debugMeg("report log :: 리포트 서버 버전 >>> "+c.version.build);if(typeof window.report_version!="undefined"){this.debugMeg("report log :: 리포트 웹뷰어 버전 >>> "+report_version);}else{this.debugMeg("report log :: 리포트 웹뷰어 버전 >>> 확인불가");}if(c.status){var a=this.m_versionInfo.build.substring(6).replace(/\_([0-9a-zA-Z]+)/g,"");if(118>Number(a)&&!(this.m_versionInfo.build.charAt(0)=="5")){this.m_is_serverSaveFile=false;}this.debugMeg("report log :: 리포트 실행 및 키 발행 정상");this.debugMeg("report log :: 리포트 키 >>> "+c.uid);this.m_uid=c.uid;m_reportHashMap[c.uid]=this;if(null!=c.wait){if(c.wait>=2){this.m_waitTime=c.wait;}}this.m_languageMap=mRe_report_language(this.m_language);if(null!=c.pageNum){this.beforePageIndex=c.pageNum;}if(this.isDocViewData){this.createView(this.targetDiv,c.uid);this.m_isEndReport=true;this.paintEFormJson(this.docViewData,true);this.progressImg.style.display="none";this.totalCountText.value="/ "+this.m_objClipDocument.checkedTotalPageCount;this.m_pageCount=this.m_objClipDocument.checkedTotalPageCount;}else{if(this.m_isViewer){this.createView(this.targetDiv,c.uid);this.createProgress();}this.checkPageCount();if(c.printerList!=null&&c.printerList.length>0){this.printOptionValue.isNetPrint=true;this.printOptionValue.netPrintList=c.printerList;}}}else{this.debugMeg("report log :: 리포트 실행 실패");this.debugMeg("report log :: 리포트 키 >>> "+c.uid);this.m_uid=c.uid;m_reportHashMap[c.uid]=this;this.m_languageMap=mRe_report_language(this.m_language);if(this.m_isViewer){this.createView(this.targetDiv,c.uid);this.progressImg.style.display="none";}if(c.event>999){this.debugMeg("report log :: 리포트 라이센스 불일치 >>> LE0"+c.event);if(this.m_isViewer){this.paintDiv.innerHTML=this.m_languageMap.lic_error+".!! (errorCode : LE0"+c.event+")";}mRe_ReportEventHandler(c.event);this.endDebugMeg(false);}else{if(c.event<13){this.debugMeg("report log :: 리포트 서버 인스톨 실패 >>> IE00"+c.event);if(this.m_isViewer){this.paintDiv.innerHTML=this.m_languageMap.install_error+"!! (errorCode : IE00"+c.event+")";}mRe_ReportEventHandler(c.event);this.endDebugMeg(false);}else{if(c.event==140){this.debugMeg("report log :: 롤에 의해 섹션이 모두  숨긴 상태입니다.!!");if(this.m_isViewer){this.paintDiv.innerHTML="표현할 페이지가 없습니다.";}mRe_ReportEventHandler(140);this.endDebugMeg(false);}else{this.debugMeg("report log :: 리포트 서버에서 리포트 생성중 오류 발생. 서버 로그 확인 필요!!");if(this.m_isViewer){this.paintDiv.innerHTML=this.m_languageMap.report_error;}mRe_ReportEventHandler(30);this.endDebugMeg(false);}}}}}catch(d){this.debugMeg("report log :: 웹뷰어 화면을 구성 중 오류 발생 >> "+d.stack);mRe_ReportEventHandler(30);this.endDebugMeg(false);}};Report.prototype.selectPage=function(b,c){if(typeof c==="undefined"){c="none";}var a=true;if(this.m_beforePageMoveEvent!=null){a=this.m_beforePageMoveEvent(c);}if(typeof a==="undefined"){a=true;}if(!a){this.input.blur();this.input.value=this.beforePageIndex+1;}else{if(this.is_eForm){this.EF_DoodlePageSave();}this.m_default_selectPage(b);if(this.is_eForm){if(this.multiView.isSocket){this.multiView.socket.sendPageMove(b,this.m_uid);}}}this.EF_thumbnail_focus();};Report.prototype.m_default_selectPage=function(a){var b=this;if(isNaN(a)){this.input.value=this.beforePageIndex+1;if(null!=this.m_PageMove&&is_smartphone){if(!this.m_PageMove.ButtonDisabled){this.m_PageMove.eventKey=window.setTimeout(function(){b.removePageMoveButton();},2000);}}return;}else{if(a<0||this.m_pageCount<=a||this.beforePageIndex==a){if(null!=this.m_PageMove&&is_smartphone){if(!this.m_PageMove.ButtonDisabled){if(null!=this.m_PageMove.eventKey){b.removePageMoveButton();}}}return;}}if(this.m_isSlidePage){this.m_tempPaintDiv=this.paintDiv;$(this.m_tempPaintDiv).attr("uid",this.m_uid);this.paintDiv=this.m_tempPaintDiv.cloneNode();if(this.beforePageIndex>a){this.paintDiv.style.left="-100%";$(this.m_tempPaintDiv).attr("next","right");}else{this.paintDiv.style.left="100%";$(this.m_tempPaintDiv).attr("next","left");}this.paintDiv.style.width="100%";this.targetDiv.firstChild.appendChild(this.paintDiv);if(this.is_eForm){this.paintDiv.appendChild(this.m_tempPaintDiv.lastChild.cloneNode());this.m_tempPaintDiv.lastChild.lastChild.style.display="block";this.m_tempPaintDiv.firstChild.innerHTML="";}}this.old_beforePageIndex=this.beforePageIndex;this.beforePageIndex=a;this.sendData(a);this.input.value=(a+1);this.createStaticPageMoveButton();this.mEF_selectedPageRuleCmd();};Report.prototype.checkPageCount=function(){if(null!=this.multiView&&this.multiView.isSocket&&!this.isMain&&!this.m_isServerSyncMirroring){this.multiView.socket.callMainData(this,0);}else{var a=this;this.checkCountLoop=window.setTimeout(function(){a.sendToCount();},(this.m_pageCountTime*this.m_waitTime));}};Report.prototype.mRe_pageCountLabelClick=function(){if(this.m_buttonEvent.startPageCountLabel!=null){this.m_buttonEvent.startPageCountLabel();}};Report.prototype.deleteToReport=function(){this.debugMeg("report log :: deleteToReport 함수 사용");this.debugMeg("report log :: 서버에 만들어진 리포트 파일을 삭제합니다.");window.clearTimeout(this.checkCountLoop);var a="ClipID=R04&uid="+this.m_uid+"&clipUID="+this.m_uid;if(this.m_postParam!=null){a+=this.m_postParam.getParam();}a=mRe_onBeforeSend(a);var c=this.servletPath;var b;if(-1!=c.indexOf("?")){b=c+"&"+a;}else{b=c+"?"+a;}if(null!=this.deleteImgTag){this.deleteImgTag.src=b;}this.debugMeg("report log :: 삭제 URL >>> "+b);this.endDebugMeg(false);};Report.prototype.sendToCount=function(){if(!this.m_reportKey){console.log("eform log :: "+this.m_uid+" 삭제된 뷰어로 보입니다(fn :sendToCount).");return;}this.debugMeg("report log :: 서버에 리포트가 얼만큼 생성중인지 체크....");this.debugMeg("report log :: 서버 통신 주소  >>>>> "+this.servletPath);var f="t"+new Date().getMilliseconds();if(this.is_eForm){if(typeof window.onBrokenSendData!="undefined"){var c={type:"pageCheck",uid:this.m_uid,sTime:f};if(!onBrokenSendData(this,c)){return;}}}var c="ClipID=R03&uid="+this.m_uid+"&clipUID="+this.m_uid+"&s_time="+f;if(this.m_postParam!=null){c+=this.m_postParam.getParam();}c=mRe_onBeforeSend(c);var h=this.servletPath;if(this.m_isCrossDomain){var b=this;if(window.XDomainRequest){var a=new XDomainRequest();var d=h+"?"+c;if(-1!=h.indexOf("?")){d=h+"&"+c;}if(a){a.onload=function(){resultPageCountText(mRe_onAfterSend(a.responseText),b);};a.onerror=function(){b.debugMeg("report log :: IE8 크로스도메인 오류 발생 .. ");mRe_ReportEventHandler(40);b.endDebugMeg(false);};a.open("GET",d);a.send();}}else{$.ajax({type:"POST",url:h,crossDomain:true,data:c,success:function(i){resultPageCountText(mRe_onAfterSend(i),b);},error:function(i){b.debugMeg("report log :: 서버 통신 오류 발생 >>> "+i);mRe_ReportEventHandler(40);b.endDebugMeg(false);}});}}else{var g=new HttpClient();var b=this;g.send(h,c,true,function(){if(4==this.readyState){if(200==this.status){resultPageCountText(mRe_onAfterSend(this.responseText),b);}else{if(b.m_isViewer){b.paintDiv.innerHTML=b.m_languageMap.link_error;}b.debugMeg("report log :: 서버 통신 오류 발생 >>> ajax 통신 상태 "+this.status);mRe_ReportEventHandler(40);b.endDebugMeg(false);b.pageSlideShow();mRe_ReportWebLog(this.status);}}});}};Report.prototype.sendData=function(c,k){this.debugMeg("report log :: 리포트 화면을 호출합니다. 페이지 번호 >>> "+(c+1));this.m_isButtonLock=true;if(this.m_directPrint){return;}if(null!=this.m_syncPageServletPath){this.createPageSyncProgress();}else{if(is_smartphone&&((!this.is_eForm)||(this.is_eForm&&!this.m_isSlidePage))){this.createEditableProgress();}}if(this.m_pageMoveEvent.start!=null){this.m_pageMoveEvent.start();}if(this.is_eForm){this.sendEFormData(c);return;}var l="true";if(is_ie6||is_ie7||is_ie8){if(this.m_isPaintImage){this.debugMeg("report log :: 리포트 화면을 이미지 모드로 사용합니다. (IE 7 ~ 8 전용)");l="false";var o="ClipID=R02&pageNumber="+c+"&uid="+this.m_uid+"&clipUID="+this.m_uid+"&html5="+l+"&DPI="+this.m_DPI+"&necessaryCheck="+this.m_necessaryCheck;if(this.m_postParam!=null){o+=this.m_postParam.getParam();}o=mRe_onBeforeSend(o);if("{clip_enc}"==o){return;}var j=document.createElement("img");if(null!=this.paintDiv.lastChild){var i=this.paintDiv.childNodes.length;for(var b=i-1;b>=0;b--){this.paintDiv.removeChild(this.paintDiv.childNodes[b]);}}this.paintDiv.appendChild(j);j.alt=this.m_languageMap.img_alt;var m=this.m_uid;j.onload=function(){m_reportHashMap[m].onloadImage();};var a=this.servletPath+"?"+o;if(-1!=this.servletPath.indexOf("?")){a=this.servletPath+"&"+o;}j.src=a;this.pageSlideShow();if(this.m_isEndReport&&this.m_isEndReportEvent){if(this.m_endreportprogress.is_visible){this.m_endreportprogress.is_visible=false;this.removeEndReportProgress();}mRe_ReportEventHandler(200);try{this.m_exeViewEndFunc();}catch(n){ReportWebLog(n.stack);}if(this.m_isReportEndFunction!=null){this.m_isReportEndFunction();}this.m_isEndReportEvent=false;}else{if(!this.m_isEndReport){if(this.m_endreportprogress.is_visible){this.createEndReportProgress();}}}this.endDebugMeg(false);return;}else{this.m_isAccessibility=true;}}if(!this.m_isAccessibility&&this.m_isObjJSONSVG){if(null==this.m_syncPageServletPath){this.createPageSyncProgress();}this.sendDataToJson(c,k);return;}var o="ClipID=R02&pageNumber="+c+"&uid="+this.m_uid+"&clipUID="+this.m_uid+"&html5="+l+"&DPI="+this.m_DPI+"&Accessibility="+this.m_isAccessibility+"&UseOriginImage="+this.m_isUseOriginImage+"&isChartToImage="+this.m_isChartToImage+"&necessaryCheck="+this.m_necessaryCheck;if(this.m_isAccessibility){o+="&AHname="+encodeURIComponent(mCR_Base64.encode(this.servletPath));}if(this.m_postParam!=null){o+=this.m_postParam.getParam();}o=mRe_onBeforeSend(o);if("{clip_enc}"==o){return;}var h=null!=this.m_syncPageServletPath?this.m_syncPageServletPath:this.servletPath;this.debugMeg("report log :: 리포트 화면을 가져오는 통신을 시도합니다 >>>> "+h);if(this.m_isCrossDomain){var g=this;if(window.XDomainRequest){var f=new XDomainRequest();var a=h+"?"+o;if(-1!=h.indexOf("?")){a=h+"&"+o;}if(f){f.onload=function(){paintReportText(mRe_onAfterSend(f.responseText),g);};f.onerror=function(){g.debugMeg("report log :: IE8 크로스도메인 오류 발생 .. ");mRe_ReportEventHandler(40);g.endDebugMeg(false);};f.open("GET",a);f.send();}}else{$.ajax({type:"POST",url:h,crossDomain:true,data:o,success:function(p){paintReportText(mRe_onAfterSend(p),g);},error:function(p){g.debugMeg("report log :: 서버 통신 오류 발생 >>> "+p);mRe_ReportEventHandler(40);g.endDebugMeg(false);}});}}else{var g=this;var d=new HttpClient();d.send(h,o,true,function(){if(4==this.readyState){if(200==this.status){paintReportText(mRe_onAfterSend(this.responseText),g);}else{g.paintDiv.innerHTML=g.m_languageMap.link_error;g.debugMeg("report log :: 서버 통신 오류 발생 >>> ajax 통신 상태 "+this.status);mRe_ReportEventHandler(40);g.endDebugMeg(false);g.pageSlideShow();mRe_ReportWebLog(this.status);}}});}};Report.prototype.sendDataToJson=function(b,h){if(null!=this.m_saveJsonDoc){this.clientPaintReportJson(b);return;}if(typeof h=="undefined"){h=false;}var i=b;if(h){i="TotalPage";}var j="uid="+this.m_uid+"&";j+="clipUID="+this.m_uid+"&";j+="ClipType=DocumentPageView&ClipData=";var d=this.m_uid;var a={reportkey:d,isMakeDocument:true,pageMethod:i};j+=encodeURIComponent(JSON.stringify(a));if(this.m_postParam!=null){j+=this.m_postParam.getParam();}j=mRe_onBeforeSend(j);if("{clip_enc}"==j){return;}var f=null!=this.m_syncPageServletPath?this.m_syncPageServletPath:this.servletPath;this.debugMeg("report log :: 리포트 화면을 가져오는 통신을 시도합니다 >>>> "+f);var g=this;var c=new HttpClient();c.send(f,j,true,function(){if(4==this.readyState){if(200==this.status){g.paintReportJson(mRe_onAfterSend(this.responseText),h);}else{g.paintDiv.innerHTML=g.m_languageMap.link_error;g.debugMeg("report log :: 서버 통신 오류 발생 >>> ajax 통신 상태 "+this.status);mRe_ReportEventHandler(40);g.endDebugMeg(false);g.pageSlideShow();mRe_ReportWebLog(this.status);}}});};Report.prototype.clientPaintReportJson=function(f){var j=this;var k=new documentReader();var g=k.documentReaderFromJSON(this.m_saveJsonDoc,this.servletPath,this.m_uid);this.filePageCountList=g.getFilePageCountList();var b=k.readDocumentPage(this.m_saveJsonDocPageList[f]);g.addPage(b);this.updataDrilingSubSection(g,b,f);var i=ClipStrTrim(g.title);if(""!=i){this.m_strFileName=i;}var d=document.createElement("div");var h=document.createElement("div");var j=this;this.m_objClipDocument=g;var a=null;var m=null;this.removeEditableProgress();this.paintDiv.innerHTML="";this.paintDiv.appendChild(d);this.paintDiv.appendChild(h);if(this.m_isObjJSONViewType=="canvas"){this.m_objCavasRate=this.getZoomRate(this.zoomCombo);var c=this.m_objCavasRate<1?1:this.m_objCavasRate;a=new mCR_exportCanvas(g,is_smartphone?(c*2):c,function(){j.makeWeblinkTag(h,a.callGetWebLinkList());});a.setPostParam((null!=this.m_postParam)?this.m_postParam.getParam():null);a.setAccessibility(this.m_isObjJSONViewAccessibility);d.setAttribute("aria-hidden","true");m=a.exportPage(f,d);if(is_smartphone){m.style.zoom=this.m_objCavasRate<1?(this.m_objCavasRate*0.5):"0.5";}else{m.style.zoom=this.m_objCavasRate<1?this.m_objCavasRate:"1";}}else{a=new mCR_exportSVG(g,false);a.setPostParam((null!=this.m_postParam)?this.m_postParam.getParam():null);a.setAccessibility(this.m_isObjJSONViewAccessibility);d.setAttribute("aria-hidden","true");m=a.exportPage(f,null,d);this.makeWeblinkTag(h,a.callGetWebLinkList());}this.pageWidth=a.objPageStyle.width*0.378;this.pageHeight=a.objPageStyle.height*0.378;this.m_printPage.pageWidth=a.objPageStyle.width;this.m_printPage.pageHeight=a.objPageStyle.height;d.style.cssText="position:absolute;left:0px;top:0px;width:100%;overflow:visible";h.style.cssText="position: relative; background-color: transparent; display: inline-block; width: "+this.pageWidth+"px; height:"+this.pageHeight+"px;";this.zoomIn(this.zoomCombo);this.setPaintDivEvent(this.paintDiv,this.m_uid);if(null==this.m_drilingTop){if((is_smartphone&&this.m_mobile.scrollTop)||(!is_smartphone&&this.m_pcView.scrollTop)){this.paintDiv.scrollTop=1;}else{if(this.m_scrollEv.isScrollPaging&&this.isWheelPrev){this.isWheelPrev=false;var l=this.paintDiv.scrollHeight-this.paintDiv.clientHeight-50;this.paintDiv.scrollTop=l;}else{this.paintDiv.scrollTop=1;}}}else{this.paintDiv.scrollTop=this.m_drilingTop;this.m_drilingTop=null;}this.endDebugMeg(true);if(this.m_pageMoveEvent.end!=null){this.m_pageMoveEvent.end();}this.pageSlideShow();};Report.prototype.paintReportJson=function(p,r){var o=this;if(null!=p){var j=jQuery.parseJSON(p);j=j.resValue;if(j.status){if(j.event==18){this.debugMeg("report log :: 리포트 서버의 사용자가 많아서 화면 호출을 다시 시도 합니다.");window.setTimeout(function(){o.sendDataToJson(o.beforePageIndex,r);},300);return;}else{if(j.event==404){this.debugMeg("report log :: 리포트 서버 세션에서 리포트를 찾을 수 없습니다.");this.debugMeg("report log :: 리포트가 삭제되었거나 이중화 서버일 가능성이 있습니다.");}else{if(j.event==200){var s=mCR_Base64.decode(j.viewData);if(null!=s){s=s.replace(/\+/gi," ");var a=new documentReader();var c=JSON.parse(s);if(r){this.m_saveJsonDoc=c.document;this.m_saveJsonDocPageList=c.pageList;}var g=a.documentReaderFromJSON(c.document,this.servletPath,this.m_uid);this.filePageCountList=g.getFilePageCountList();var f=a.readDocumentPage(c.pageList[0]);g.addPage(f);this.updataDrilingSubSection(g,f,null);var i=ClipStrTrim(g.title);if(""!=i){this.m_strFileName=i;}var b=document.createElement("div");var l=document.createElement("div");var o=this;this.m_objClipDocument=g;var m=null;var k=null;this.removeEditableProgress();this.paintDiv.innerHTML="";this.paintDiv.appendChild(b);this.paintDiv.appendChild(l);if(this.m_isObjJSONViewType=="canvas"){this.m_objCavasRate=this.getZoomRate(this.zoomCombo);var n=this.m_objCavasRate<1?1:this.m_objCavasRate;m=new mCR_exportCanvas(g,is_smartphone?(n*2):n,function(){o.makeWeblinkTag(l,m.callGetWebLinkList());});m.setPostParam((null!=this.m_postParam)?this.m_postParam.getParam():null);m.setAccessibility(this.m_isObjJSONViewAccessibility);b.setAttribute("aria-hidden","true");k=m.exportPage(o.beforePageIndex,b);if(is_smartphone){k.style.zoom=this.m_objCavasRate<1?(this.m_objCavasRate*0.5):"0.5";}else{k.style.zoom=this.m_objCavasRate<1?this.m_objCavasRate:"1";}}else{m=new mCR_exportSVG(g,false);m.setPostParam((null!=this.m_postParam)?this.m_postParam.getParam():null);m.setAccessibility(this.m_isObjJSONViewAccessibility);b.setAttribute("aria-hidden","true");k=m.exportPage(o.beforePageIndex,null,b);this.makeWeblinkTag(l,m.callGetWebLinkList());}this.pageWidth=m.objPageStyle.width*0.378;this.pageHeight=m.objPageStyle.height*0.378;this.m_printPage.pageWidth=m.objPageStyle.width;this.m_printPage.pageHeight=m.objPageStyle.height;b.style.cssText="position:absolute;left:0px;top:0px;width:100%;overflow:visible";l.style.cssText="position: relative; background-color: transparent; display: inline-block; width: "+this.pageWidth+"px; height:"+this.pageHeight+"px;";this.zoomIn(this.zoomCombo);this.setPaintDivEvent(this.paintDiv,this.m_uid);}if(this.m_isEndReport&&this.m_isEndReportEvent){if(this.m_endreportprogress.is_visible){this.m_endreportprogress.is_visible=false;this.removeEndReportProgress();}mRe_ReportEventHandler(200);try{this.m_exeViewEndFunc();}catch(q){ReportWebLog(q.stack);}if(this.m_isReportEndFunction!=null){this.m_isReportEndFunction();}this.m_isEndReportEvent=false;this.debugMeg("report log :: 리포트 뷰어 종료!");this.endDebugMeg(false);}else{if(!this.m_isEndReport){if(this.m_endreportprogress.is_visible){this.createEndReportProgress();}}}if(null==this.m_drilingTop){if((is_smartphone&&this.m_mobile.scrollTop)||(!is_smartphone&&this.m_pcView.scrollTop)){this.paintDiv.scrollTop=1;}else{if(this.m_scrollEv.isScrollPaging&&this.isWheelPrev){this.isWheelPrev=false;var d=this.paintDiv.scrollHeight-this.paintDiv.clientHeight-50;this.paintDiv.scrollTop=d;}else{this.paintDiv.scrollTop=1;}}}else{this.paintDiv.scrollTop=this.m_drilingTop;this.m_drilingTop=null;}this.endDebugMeg(true);}}}}else{this.debugMeg("report log :: 페이지 호출 후 받은 데이터 >>> 에러코드:"+j.event);var h=this.m_languageMap.report_error;mRe_ReportEventHandler(j.event);this.paintDiv.innerHTML=h;}}else{this.debugMeg("report log :: 페이지 호출 후 받은 데이터가 없습니다.>>> 데이터:"+p);this.paintDiv.innerHTML=this.m_languageMap.report_error;mRe_ReportEventHandler(30);}if(this.m_pageMoveEvent.end!=null){this.m_pageMoveEvent.end();}this.pageSlideShow();};Report.prototype.reDrawCanvasPage=function(d,f){var a=null;if(this.is_eForm){var c=this;var a=new mCR_exportCanvasForZoom(this.m_objClipDocument,is_smartphone?(d*2):d,function(){c.zoomChangeEForm();});a.setEasyInput(this.isEasyInput);a.setRuleCtrlVisible(this.m_RuleCtrlVisible);}else{var a=new mCR_exportCanvas(this.m_objClipDocument,is_smartphone?(d*2):d,function(){});}a.setPostParam((null!=this.m_postParam)?this.m_postParam.getParam():null);f.setAttribute("aria-hidden","true");var b=a.exportPage(this.beforePageIndex,f);if(is_smartphone){b.style.zoom="0.5";}else{b.style.zoom="1";}return b;};Report.prototype.makeWeblinkTag=function(c,j){if(null!=j){var d=new Array();var g=null;for(var k=0;k<j.length;k++){var a=j[k];if(a.info.type==0){d.push('<a tabindex="-1" ');d.push("onclick=\"m_reportHashMap['"+this.m_uid+"'].webLinkControl(");if(a.info.webLinkType=="self"||a.info.webLinkType=="blank"){d.push("'"+decodeURIComponent(a.info.linkUrl)+"',");d.push("'"+a.info.webLinkType+"');\" ");}else{if(a.info.webLinkType=="window"){d.push("'"+decodeURIComponent(a.info.linkUrl)+"',");d.push("'"+a.info.webLinkType+"',");d.push(a.info.windowWidth);d.push(",");d.push(a.info.windowHeight);d.push(');" ');}else{d.push("'"+decodeURIComponent(a.info.linkUrl)+"',");d.push("'"+a.info.webLinkType+"',");d.push("'"+a.info.frameName+"');\" ");}}d.push('style="position:absolute;border:0.75pt solid !important; padding: 0px 0px 0px 0px !important;filter:alpha(opacity=0); opacity:0;background-color:white;cursor:pointer;');d.push("left:"+(a.rect.left*0.378)+"px;");d.push("top:"+(a.rect.top*0.378)+"px;");d.push("width:"+(a.rect.getWidth()*0.378)+"px;");d.push("height:"+(a.rect.getHeight()*0.378)+"px;");d.push('"></a>');}else{if(a.info.type==1&&!this.is_eForm){d.push("<textarea ");d.push('class="mRe_focus" ');d.push('type="text" ');d.push('controlIndex="');d.push(a.info.editableIndex);d.push('" ');d.push('onchange="');d.push("m_reportHashMap['");d.push(this.m_uid);d.push("'].editableControl(this);");d.push('" ');d.push('onkeydown="');d.push("m_reportHashMap['");d.push(this.m_uid);d.push("'].editableKeyEvent(this, event);");d.push('" ');d.push('style="position:absolute;border:0.75pt solid !important; padding: 0px 0px 0px 0px !important;');d.push("margin-top: 0 !important;margin-bottom: 0 !important;filter:alpha(opacity=0); opacity:0;resize: none;");d.push(a.info.fontStyle);d.push("left:"+(a.rect.left*0.378)+"px;");d.push("top:"+(a.rect.top*0.378)+"px;");d.push("width:"+(a.rect.getWidth()*0.378)+"px;");d.push("height:"+(a.rect.getHeight()*0.378)+"px;");d.push('">');d.push(a.info.editText);d.push("</textarea>");}else{if(a.info.type==4&&!this.is_eForm){d.push("<input ");if(a.info.isChecked){d.push("checked ");}d.push("type='checkbox' ");d.push('controlIndex="');d.push(a.info.editableIndex);d.push('" ');d.push('onclick="');d.push("m_reportHashMap['");d.push(this.m_uid);d.push("'].editableControl(this);");d.push('" ');d.push('style="position:absolute;border:0.75pt solid !important; padding: 0px 0px 0px 0px !important;');d.push("margin-top: 0 !important;margin-bottom: 0 !important;filter:alpha(opacity=0); opacity:0;resize: none;");d.push("left:"+(a.rect.left*0.378)+"px;");d.push("top:"+(a.rect.top*0.378)+"px;");d.push("width:"+(a.rect.getWidth()*0.378)+"px;");d.push("height:"+(a.rect.getHeight()*0.378)+"px;");d.push('"/>');}else{if(a.info.type==2&&!this.is_eForm){d.push('<a tabindex="-1" ');d.push("onclick=\"m_reportHashMap['"+this.m_uid+"'].drillingJsonControl(");d.push("'"+a.info.linkUrl+"');\" ");d.push('style="position:absolute;border:0.75pt solid !important; padding: 0px 0px 0px 0px !important;filter:alpha(opacity=0); opacity:0;background-color:white;cursor:pointer;');d.push("left:"+(a.rect.left*0.378)+"px;");d.push("top:"+(a.rect.top*0.378)+"px;");d.push("width:"+(a.rect.getWidth()*0.378)+"px;");d.push("height:"+(a.rect.getHeight()*0.378)+"px;");d.push('"></a>');}else{if(a.info.type==10&&!this.is_eForm){var m=a.info.ctrlName;d.push('<div tabindex="-1" ');d.push('style="position:absolute;border:0.75pt solid gray !important; padding: 0px 0px 0px 0px !important;color:gray;font-size:9pt;text-align:left;');d.push("left:"+(a.rect.left*0.378)+"px;");d.push("top:"+(a.rect.top*0.378)+"px;");d.push("width:"+(a.rect.getWidth()*0.378)+"px;");d.push("height:"+(a.rect.getHeight()*0.378)+"px;");d.push('">');d.push(m);d.push("</div>");}else{if(a.info.type==20){if(this.m_nObjJSONViewAccLevel==1){if(g==null){g=new Array();}if(null!=a.info.msg){var l=a.info.msg.replace(/\'/g,"작은따옴표");l=l.replace(/\"/g,"큰따옴표");l=l.replace(/\<\/?(b|B|i|I|u|U|s|S|c|C|o|O|r|R|p|P|d|D|br|BR|Font|size|SIZE|FONT)\>/g,"");g.push(l);}}else{d.push('<span tabindex="0" ');if(null!=a.info.msg){var l=a.info.msg.replace(/\'/g,"작은따옴표");l=l.replace(/\"/g,"큰따옴표");l=l.replace(/\<\/?(b|B|i|I|u|U|s|S|c|C|o|O|r|R|p|P|d|D|br|BR|Font|size|SIZE|FONT)\>/g,"");d.push('role="text" aria-label="'+l+'" ');}d.push('style="position:absolute;border:0 !important; padding: 0px 0px 0px 0px !important;color:gray;font-size:9pt;text-align:left;');d.push("left:"+(a.rect.left*0.378)+"px;");d.push("top:"+(a.rect.top*0.378)+"px;");d.push("width:"+(a.rect.getWidth()*0.378)+"px;");d.push("height:"+(a.rect.getHeight()*0.378)+"px;");d.push('">');d.push("</span>");}}}}}}}}var f=document.createElement("div");f.innerHTML=d.join("");var b=f.childNodes.length;for(var h=0;h<b;h++){c.appendChild(f.childNodes[h].cloneNode(true));}if(null!=g){c.setAttribute("aria-label",g.join(" "));g=null;}}};Report.prototype.drillingJsonControl=function(g){if(this.m_drillingPageInfo==null){this.m_drillingPageInfo=new Array();}var d=this.m_drillingPageInfo[this.beforePageIndex];if(d==null){d=new Array();this.m_drillingPageInfo[this.beforePageIndex]=d;d.push(g);}else{var a="";var c=true;var f=d.length;for(var b=(f-1);b>=0;b--){a=d[b];if(-1!=a.indexOf(g)){d.splice(b,1);c=false;}}if(c){d.push(g);}}this.sendData(this.beforePageIndex,this.m_isJsonAllPage);};Report.prototype.updataDrilingSubSection=function(m,b,d){if(null==d){d=this.beforePageIndex;}if(this.m_drillingPageInfo!=null){var o=this.m_drillingPageInfo[d];if(o!=null){var p=m.getPageStyle(b.pageStyleKey);var c=o.length;for(var h=0;h<c;h++){var a=o[h];var n=b.subSectionList.length;var l=0;for(var g=0;g<n;g++){var q=b.subSectionList[g];if(q.isDrilling){if(q.drillingName==a){q.area.offsetRect(0,l);l+=q.area.getHeight();q.isDrillingView=true;for(var f=0;f<g;f++){var r=b.subSectionList[f];if(q.area.top<r.area.top){r.area.offsetRect(0,q.area.getHeight());}}}else{q.area.offsetRect(0,l);}}else{q.area.offsetRect(0,l);}}p.height=p.height+l;}}}};Report.prototype.sendDataEnc=function(n){var c=this.beforePageIndex;this.debugMeg("report log :: 리포트 화면을 호출합니다. 페이지 번호 >>> "+(c+1));this.m_isButtonLock=true;if(this.m_directPrint){return;}if(this.is_eForm){this.sendEFormData(c);return;}var k="true";if(is_ie6||is_ie7||is_ie8){if(this.m_isPaintImage){this.debugMeg("report log :: 리포트 화면을 이미지 모드로 사용합니다. (IE 7 ~ 8 전용)");k="false";var j=document.createElement("img");if(null!=this.paintDiv.lastChild){var i=this.paintDiv.childNodes.length;for(var b=i-1;b>=0;b--){this.paintDiv.removeChild(this.paintDiv.childNodes[b]);}}this.paintDiv.appendChild(j);j.alt=this.m_languageMap.img_alt;var l=this.m_uid;j.onload=function(){m_reportHashMap[l].onloadImage();};var a=this.servletPath+"?"+n;if(-1!=this.servletPath.indexOf("?")){a=this.servletPath+"&"+n;}j.src=a;this.pageSlideShow();if(this.m_isEndReport&&this.m_isEndReportEvent){if(this.m_endreportprogress.is_visible){this.m_endreportprogress.is_visible=false;this.removeEndReportProgress();}mRe_ReportEventHandler(200);try{this.m_exeViewEndFunc();}catch(m){mRe_ReportWebLog(m.stack);}if(this.m_isReportEndFunction!=null){this.m_isReportEndFunction();}this.m_isEndReportEvent=false;}else{if(!this.m_isEndReport){if(this.m_endreportprogress.is_visible){this.createEndReportProgress();}}}this.endDebugMeg(false);if(this.m_pageMoveEvent.end!=null){this.m_pageMoveEvent.end();}return;}else{this.m_isAccessibility=true;}}var h=this.servletPath;this.debugMeg("report log :: 리포트 화면을 가져오는 통신을 시도합니다 >>>> "+h);if(this.m_isCrossDomain){var g=this;if(window.XDomainRequest){var f=new XDomainRequest();var a=h+"?"+n;if(-1!=h.indexOf("?")){a=h+"&"+n;}if(f){f.onload=function(){paintReportText(mRe_onAfterSend(f.responseText),g);};f.onerror=function(){g.debugMeg("report log :: IE8 크로스도메인 오류 발생 .. ");mRe_ReportEventHandler(40);g.endDebugMeg(false);if(g.m_pageMoveEvent.end!=null){g.m_pageMoveEvent.end();}};f.open("GET",a);f.send();}}else{$.ajax({type:"POST",url:h,crossDomain:true,data:n,success:function(o){paintReportText(mRe_onAfterSend(o),g);},error:function(o){g.debugMeg("report log :: 서버 통신 오류 발생 >>> "+o);mRe_ReportEventHandler(40);g.endDebugMeg(false);if(g.m_pageMoveEvent.end!=null){g.m_pageMoveEvent.end();}}});}}else{var g=this;var d=new HttpClient();d.send(h,n,true,function(){if(4==this.readyState){if(200==this.status){paintReportText(mRe_onAfterSend(this.responseText),g);}else{g.paintDiv.innerHTML=g.m_languageMap.link_error;g.debugMeg("report log :: 서버 통신 오류 발생 >>> ajax 통신 상태 "+this.status);mRe_ReportEventHandler(40);g.endDebugMeg(false);g.pageSlideShow();if(g.m_pageMoveEvent.end!=null){g.m_pageMoveEvent.end();}mRe_ReportWebLog(this.status);}}});}};Report.prototype.editableControl=function(m){if(this.m_isButtonLock==false){var j=m.getAttribute("type");var k=m.value;var c=m.getAttribute("controlindex");if("text"!=j){k=m.checked+"";if(m.tagName=="SPAN"){var l=m.getAttribute("checkValue");if(l=="true"){k="false";}else{k="true";}}}k=mCR_Base64.encode(k);var i=this.m_necessaryCheck;var o={necessaryPage:i,data:new Array()};o.data[Number(c)]=new Object();o.data[Number(c)].type=j;o.data[Number(c)].controlIndex=c;o.data[Number(c)].value=k;var h=false;if(!this.m_isAccessibility&&this.m_isObjJSONSVG){h=true;}var b="t"+new Date().getMilliseconds();var n="ClipID=R11&pageNumber="+this.beforePageIndex+"&uid="+this.m_uid+"&clipUID="+this.m_uid+"&Accessibility="+this.m_isAccessibility+"&data="+encodeURIComponent(mCR_Base64.encode(JSON.stringify(o)))+"&s_time="+b+"&isJsonView="+h;if(this.m_isAccessibility){n+="&AHname="+encodeURIComponent(mCR_Base64.encode(this.servletPath));}if(this.m_postParam!=null){n+=this.m_postParam.getParam();}n=mRe_onBeforeSend(n);if(this.m_isCrossDomain){var g=this;if(window.XDomainRequest){var f=new XDomainRequest();var a=servletPath+"?"+n;if(f){f.onload=function(){if(h){g.paintReportJson(mRe_onAfterSend(f.responseText),false);}else{paintReportText(mRe_onAfterSend(f.responseText),g);}};f.onerror=function(){ReportWebLog("IE8 crossDomain error");mRe_ReportEventHandler(40);};f.open("GET",a);f.send();}}else{$.ajax({type:"POST",url:servletPath,crossDomain:true,data:n,success:function(p){if(h){g.paintReportJson(mRe_onAfterSend(p),false);}else{paintReportText(mRe_onAfterSend(p),g);}},error:function(p){ReportWebLog(p);mRe_ReportEventHandler(40);}});}}else{var g=this;var d=new HttpClient();d.send(this.servletPath,n,true,function(){if(4==this.readyState){if(200==this.status){if(h){g.paintReportJson(mRe_onAfterSend(this.responseText),false);}else{paintReportText(mRe_onAfterSend(this.responseText),g);}}else{g.paintDiv.innerHTML=g.m_languageMap.link_error;mRe_ReportEventHandler(40);g.pageSlideShow();mRe_ReportWebLog(this.status);}}});}this.createEditableProgress();m.style.zIndex="0";}};Report.prototype.webLinkControl=function(){if(arguments.length>1){var f=arguments[0];var b=arguments[1];var a=document.createElement("form");document.body.appendChild(a);var d=null;var h=f.split("?");switch(h.length){case 2:d=h[1];var l=d.split("&");for(var g=0;g<l.length;g++){var k=l[g].split("=");a.appendChild(mRe_makeInputTag(null,k[0],k[1]));}f=h[0];a.method="post";a.action=f;break;case 1:f=h[0];a.method="post";a.action=f;break;default:break;}if("self"==b){a.target="_self";}else{if("blank"==b){a.target="_blank";}else{if("window"==b){if(is_ie11||is_edge){a.target="_blank";}else{var c="t"+new Date().getMilliseconds();var j="report_SubWindow"+c;window.open("",j,"height="+arguments[3]+",width="+arguments[2]);a.target=j;window.setTimeout(function(){a.submit();document.body.removeChild(a);},1000);return;}}else{a.target=arguments[2];}}}a.submit();document.body.removeChild(a);}};Report.prototype.drilingControl=function(j){if(this.m_isButtonLock==false){var g=this.m_necessaryCheck;var h={necessaryPage:g,data:new Array()};h.data[0]=new Object();h.data[0].driling=true;h.data[0].value=j;this.m_drilingTop=this.paintDiv.scrollTop;var b="t"+new Date().getMilliseconds();var i="ClipID=R11&pageNumber="+this.beforePageIndex+"&uid="+this.m_uid+"&clipUID="+this.m_uid+"&Accessibility="+this.m_isAccessibility+"&data="+encodeURIComponent(mCR_Base64.encode(JSON.stringify(h)))+"&s_time="+b;i=mRe_onBeforeSend(i);if(this.m_isCrossDomain){var f=this;if(window.XDomainRequest){var d=new XDomainRequest();var a=servletPath+"?"+i;if(d){d.onload=function(){f.resultNewReport(mRe_onAfterSend(d.responseText));};d.onerror=function(){ReportWebLog("IE8 crossDomain error");mRe_ReportEventHandler(40);};d.open("GET",a);d.send();}}else{$.ajax({type:"POST",url:servletPath,crossDomain:true,data:i,success:function(k){paintReportText(mRe_onAfterSend(k),f);},error:function(k){ReportWebLog(k);mRe_ReportEventHandler(40);}});}}else{var f=this;var c=new HttpClient();c.send(this.servletPath,i,true,function(){if(4==this.readyState){if(200==this.status){paintReportText(mRe_onAfterSend(this.responseText),f);}else{f.paintDiv.innerHTML=f.m_languageMap.link_error;mRe_ReportEventHandler(40);f.pageSlideShow();mRe_ReportWebLog(this.status);}}});}this.createEditableProgress();}};Report.prototype.editableKeyEvent=function(a,c){if(c.keyCode==13){if(c.ctrlKey){var d=a.value;if(typeof a.selectionStart=="number"&&typeof a.selectionEnd=="number"){var f=a.selectionStart;a.value=d.slice(0,f)+"\n"+d.slice(a.selectionEnd);a.selectionStart=a.selectionEnd=f+1;}else{if(document.selection&&document.selection.createRange){a.focus();var b=document.selection.createRange();b.text="\r\n";b.collapse(false);b.select();}}return;}a.blur();if(c.preventDefault){c.preventDefault();}c.returnValue=false;}};Report.prototype.onloadImage=function(){this.zoomIn(this.zoomCombo);};Report.prototype.paintReport=function(){if(4==this.readyState){var a=this;if(200==this.status){paintReportText(this.responseText,a);}else{this.paintDiv.innerHTML=this.m_languageMap.link_error;mRe_ReportEventHandler(40);this.pageSlideShow();mRe_ReportWebLog(this.status);}}};Report.prototype.resultDeleteReport=function(){if(4==this.readyState){if(200==this.status){var a=this.responseText;var b=objectCall(ClipStrTrim(a));if(typeof b=="string"){b=objectCall(b);}try{if(!b.status){mRe_ReportEventHandler(50);}}catch(c){mRe_ReportEventHandler(50);mRe_ReportWebLog(this.status);}}}};Report.prototype.selectPrintOption=function(a){mRe_setLocalStorage("mRe_print_report",a.value);this.printOptionValue.localStorage=a.value;this.mRe_selectPrintOption(a.value);};Report.prototype.getZoomRate=function(b){var c=b.value;var h;if("PageWidth"==c){if(!is_smartphone){this.paintDiv.scrollLeft=0;this.paintDiv.style.overflowX="hidden";if(is_ie){this.paintDiv.style.overflowY="auto";}else{this.paintDiv.style.overflowY="auto";}}var i=this.paintDiv.clientWidth;if(i==0){i=window.m_G_DivWidth;if(i==0&&null!=window.m_clipTabPlugin){var g=this.paintDiv.parentElement;i=g.clientWidth;while(0==i&&g.tagName!="BODY"){g=g.parentElement;i=g.clientWidth;}}}if(is_ie){i-=14;this.paintDiv.style.overflowY="auto";h=i/Number(this.pageWidth);h=h.toFixed(1);}else{h=i/Number(this.pageWidth);}if(is_android_mobile44&&h<0.5){h=0.55;}}else{if("WholePage"==c){if(!is_smartphone){this.paintDiv.scrollTop=0;if(!is_ie){this.paintDiv.style.overflowX="hidden";this.paintDiv.style.overflowY="hidden";}else{this.paintDiv.style.overflowX="visible";this.paintDiv.style.overflowY="visible";}}var i=this.paintDiv.clientWidth;var a=this.paintDiv.clientHeight;if(i==0||a==0){i=window.m_G_DivWidth;a=window.m_G_DivHeight;}var f=i/Number(this.pageWidth);var d=a/Number(this.pageHeight);h=f>d?d:f;}else{h=c;this.scrollCorrection(Number(h));}}return Number(h);};Report.prototype.scrollCorrection=function(c){if(is_ie){this.paintDiv.style.overflowX="hidden";this.paintDiv.style.overflowY="hidden";var d=this.paintDiv.clientWidth;if(d==0){d=window.m_G_DivWidth;if(d==0&&null!=window.m_clipTabPlugin){var b=this.paintDiv.parentElement;d=b.clientWidth;while(0==d&&b.tagName!="BODY"){b=b.parentElement;d=b.clientWidth;}}}if(this.pageWidth*c>d){this.paintDiv.style.overflowX="auto";if(c<1){this.paintDiv.scrollLeft=this.paintDiv.scrollLeft*c;}}else{this.paintDiv.scrollLeft=0;}var a=this.paintDiv.clientHeight;if(a==0){a=window.m_G_DivHeight;if(a==0&&null!=window.m_clipTabPlugin){var b=this.paintDiv.parentElement;a=b.clientHeight;while(0==a&&b.tagName!="BODY"){b=b.parentElement;a=b.clientHeight;}}}if(this.pageHeight*c>a){this.paintDiv.style.overflowY="auto";if(c<1){this.paintDiv.scrollTop=this.paintDiv.scrollTop*c;}}else{this.paintDiv.scrollTop=0;}}else{this.paintDiv.style.overflowX="auto";this.paintDiv.style.overflowY="auto";}};Report.prototype.zoomIn=function(f){var q=this.getZoomRate(f);if(this.m_buttonEvent.startZoomInSelect!=null){var w=this.m_buttonEvent.startZoomInSelect();if(w!=true){return;}}if(!is_svg&&this.m_isPaintImage&&null==this.pageWidth){var n=this.paintDiv.firstChild;if(null!=n&&"IMG"==n.tagName){if(40>n.offsetWidth||40>n.offsetHeight){var s=this;window.setTimeout(function(){s.zoomIn(f);},200);return;}this.pageWidth=n.offsetWidth;this.pageHeight=n.offsetHeight;}}if(is_ie){this.paintDiv.firstChild.style.visibility="hidden";}this.eFormDoodleOption.zoomIn=Re_zoom.rate=q;if(!is_svg&&this.m_isPaintImage){var n=this.paintDiv.firstChild;var k=f.value;if(null!=n&&"IMG"==n.tagName){if("PageWidth"==k){n.setAttribute("width","100%");n.removeAttribute("height");}else{if("WholePage"==k){n.removeAttribute("width");n.setAttribute("height","100%");}else{if(q==1){n.removeAttribute("width");n.removeAttribute("height");}else{n.setAttribute("width",Number(this.pageWidth)*q);n.setAttribute("height",Number(this.pageHeight)*q);}}}}}else{if(this.m_isAccessibility&&!this.is_eForm){var d=this.paintDiv.firstChild;if(null!=d){d.style.zoom=q;if(is_firefox){var t=this.paintDiv.clientWidth;d.style.MozTransform="scale("+q+")";d.style.MozTransformOrigin="0 0 0";d.style.position="absolute";var p=d.clientWidth*q;var o=0;if(t-p>0){o=(t-p)/2;}d.style.left=o+"px";}else{if(is_ie9){d.style.position="absolute";}}}}else{var m=this.paintDiv.firstChild.firstChild;var l=null;if(null!=m&&"svg"==m.tagName){this.m_objCavasRate=q;m.setAttribute("width",Number(this.pageWidth)*q);m.setAttribute("height",Number(this.pageHeight)*q);if(null!=m.lastChild){m.lastChild.setAttribute("transform","scale("+q+") translate(0,0)");}if(is_edge){var x=this.targetDiv;if("hidden"!=x.style.visibility){window.setTimeout(function(){x.style.visibility="";window.setTimeout(function(){x.style.visibility="visible";},200);},200);}}}else{if(null!=m&&"CANVAS"==m.tagName){if(this.m_objCavasRate!=q){var j=m.parentElement;j.removeChild(m);this.m_objCavasRate=q;if(q<1&&!is_firefox){l=this.reDrawCanvasPage(1,j);if(is_smartphone){l.style.zoom=(q*0.5);}else{l.style.zoom=q;}}else{l=this.reDrawCanvasPage(q,j);}}else{if(is_smartphone){m.style.zoom=q<1?(q*0.5):"0.5";}else{if(q<1&&is_firefox){var j=m.parentElement;j.removeChild(m);l=this.reDrawCanvasPage(q,j);}else{var i=m.getAttribute("nzoom");if(null!=i){var g=parseFloat(i);if(g==q){m.style.zoom="1";}else{m.style.zoom=(q/g);}}else{m.style.zoom=q;}}}}}}var r=this.paintDiv.firstChild.nextSibling;if(null!=r){if(is_firefox){r.style.transform="scale("+q+")";r.style.transformOrigin="0 0 0";r.style.position="absolute";window.m_firefox_Rescale=q;var s=this;if(null==this.m_firefox_Reevent){this.m_firefox_Reevent=true;window.addEventListener("resize",function(){if(s&&s.paintDiv){var z=s.paintDiv.clientWidth;var B=r.clientWidth*Number(m_firefox_Rescale);var A=0;if(z-B>0){A=(z-B)/2;}r.style.left=A+"px";}},false);}var t=this.paintDiv.clientWidth;var p=r.clientWidth*Number(q);var o=0;if(t-p>0){o=(t-p)/2;}r.style.left=o+"px";}else{r.style.zoom=q;if(is_smartphone){r.style.display="block";r.style.position="absolute";var a=r.offsetWidth;if(0==a){a=this.pageWidth;}var v=this.paintDiv.offsetWidth;if(0==v){var h=this.paintDiv.parentElement;while(h.offsetWidth==0&&h.tagName!="BODY"){h=h.parentElement;}v=h.offsetWidth;}var y=a*q;if((y)>v){r.style.left="0px";}else{var u=((v-y)/2)/q;r.style.left=u+"px";}}}if(this.m_isCustomViewPort){var s=this;if(window.addEventListener){window.addEventListener("resize",function(){if(is_smartphone){window.setTimeout(function(){if(s&&s.paintDiv){var A=s.paintDiv.firstChild.nextSibling;A.style.display="block";A.style.position="absolute";var z=A.offsetWidth;if(0==z){z=s.pageWidth;}var C=s.paintDiv.offsetWidth;if(0==C){var E=this.paintDiv.parentElement;while(E.offsetWidth==0&&E.tagName!="BODY"){E=E.parentElement;}C=E.offsetWidth;}var B=z*s.m_objCavasRate;if((B)>C){A.style.left="0px";}else{var D=((C-B)/2)/s.m_objCavasRate;A.style.left=D+"px";}}},100);}},false);}}}}}if(is_ie){this.paintDiv.firstChild.style.visibility="visible";}if(this.is_eForm){if(this.paintDiv){var c=this.targetDiv.offsetWidth;var b=this.targetDiv.offsetHeight;if(0!=c&&0!=b){this.targetDiv.setAttribute("wo",c);this.targetDiv.setAttribute("ho",b);}}this.zoomChangeEForm();}};Report.prototype.pageScrollEvent=function(a){if(this.is_eForm){this.pageScrollEFormEvent(a);}};Report.prototype.pageMousewheelEvent=function(a){if(this.is_eForm){var b=a.srcElement;if(!(b.tagName=="TEXTAREA"||b.tagName=="INPUT")){if(this.m_isInputFocus){if(null!=this.m_focusInputDOM){try{this.m_focusInputDOM.blur();}catch(i){this.debugMeg(i.stack);}}}}}if(this.m_scrollEv.isScrollPaging){var d=this.paintDiv;if(null!=d){var j=d.clientHeight;var g=d.scrollHeight;var c=d.scrollTop;var f=d.style.overflowY;if(d.scrollTop==0){var h=0;if(is_firefox){h=a.deltaY;if(h>0){h=-1;}else{if(h<0){h=1;}}}else{h=a.wheelDelta||-a.deltaY;}if(h>0){if(this.m_isMemoEnabled){this.isWheelPrev=true;this.previousMemoPage("mouse_wheel");}else{this.isWheelPrev=true;this.previousPage("mouse_wheel");}if(a.preventDefault){a.preventDefault();}a.returnValue=false;return;}}if(null!=j&&null!=g&&((f=="hidden"||(f=="visible"&&is_ie))||((j+10)>g))){var h=0;if(is_firefox){h=a.deltaY;if(h>0){h=-1;}else{if(h<0){h=1;}}}else{h=a.wheelDelta;}if(h>0){if(this.m_isMemoEnabled){this.isWheelPrev=true;this.previousMemoPage("mouse_wheel");}else{this.isWheelPrev=true;this.previousPage("mouse_wheel");}}else{if(h<0){if(this.m_isMemoEnabled){this.isWheelPrev=false;this.nextMemoPage("mouse_wheel");}else{this.isWheelPrev=false;this.nextPage("mouse_wheel");}}}if(a.preventDefault){a.preventDefault();}a.returnValue=false;return;}else{if(null!=j&&null!=g&&(f=="auto"&&((c+j+5)>g))){var h=0;if(is_firefox){h=a.deltaY;if(h>0){h=-1;}else{if(h<0){h=1;}}}else{h=a.wheelDelta;}if(h<0){if(this.m_scrollEv.isBottomEvent==null){this.m_scrollEv.isBottomEvent=true;}else{if(this.m_scrollEv.isBottomEvent){this.m_scrollEv.isBottomEvent=null;if(this.m_isMemoEnabled){this.isWheelPrev=false;this.nextMemoPage("mouse_wheel");}else{this.isWheelPrev=false;this.nextPage("mouse_wheel");}}}if(a.preventDefault){a.preventDefault();}a.returnValue=false;return;}}}}}};Report.prototype.pageSlideShow=function(){if(this.m_isSlidePage&&null!=this.m_tempPaintDiv){this.m_tempPaintDiv.style.overflow="hidden";var b=$(this.m_tempPaintDiv).attr("next");var a=this;if("right"==b){$(this.m_tempPaintDiv).animate({left:"100%",width:"100%"},700,function(){try{a.targetDiv.firstChild.removeChild(this);a.m_tempPaintDiv=null;}catch(c){mRe_ReportWebLog(c.stack);}});}else{$(this.m_tempPaintDiv).animate({left:"-100%",width:"100%"},700,function(){try{a.targetDiv.firstChild.removeChild(this);a.m_tempPaintDiv=null;}catch(c){mRe_ReportWebLog(c.stack);}});}$(this.paintDiv).animate({left:"0%",width:"100%",opacity:1},700,function(){a.m_isButtonLock=false;});}else{this.m_isButtonLock=false;}};Report.prototype.disabledMenu=function(a){this.m_disabledMenu=a;if(!this.m_disControl.save&&null!=this.save_button){this.save_button.disabled=a;}if(!this.m_disControl.print&&null!=this.print_button){this.print_button.disabled=a;}if(!this.m_disControl.input&&null!=this.input){this.input.disabled=a;}if(!this.m_disControl.caption&&null!=this.totalCountText){this.totalCountText.disabled=a;}if(!this.m_disControl.zoomIn&&null!=this.zoomCombo){this.zoomCombo.disabled=a;}if(!this.m_disControl.first&&null!=this.first_button){this.first_button.disabled=a;}if(!this.m_disControl.prev&&null!=this.prev_button){this.prev_button.disabled=a;}if(!this.m_disControl.next&&null!=this.next_button){this.next_button.disabled=a;}if(!this.m_disControl.last&&null!=this.last_button){this.last_button.disabled=a;}if(!this.m_disControl.pdf&&null!=this.pdf_button){this.pdf_button.disabled=a;}if(!this.m_disControl.excel&&null!=this.excel_button){this.excel_button.disabled=a;}if(!this.m_disControl.hwp&&null!=this.hwp_button){this.hwp_button.disabled=a;}if(!this.m_disControl.doc&&null!=this.doc_button){this.doc_button.disabled=a;}if(!this.m_disControl.reportInfo&&null!=this.reportInfo_button){this.reportInfo_button.disabled=a;}if(!this.m_disControl.doodle&&null!=this.doodle_button){this.doodle_button.disabled=a;}if(!this.m_disControl.setting&&null!=this.setting_button){this.setting_button.disabled=a;}if(!this.m_disControl.memo&&null!=this.memo_button){this.memo_button.disabled=a;}};Report.prototype.reportInfo=function(){this.disabledMenu(true);this.m_popupViewDiv=document.createElement("div");this.m_popupViewDiv.className="report_popup_view";this.m_bodyDiv.appendChild(this.m_popupViewDiv);var g=document.createElement("div");g.className="report_view_box report_info_view_position";var a=new Array();var b=0;if(this.m_nObjJSONViewAccLevel==1){b=-1;}a.push("<span id='mRe_reportinfoTagID'  tabIndex='"+b+"' role='text' title='"+this.m_languageMap.report_info+"' class='report_view_box' style='position:absolute;left:20px;top:13px;border:0;z-index:600;'>"+this.m_languageMap.report_info+"</span>");a.push("<div style='position:absolute;left:15px;right:15px;top:20px;bottom:40px;border:1px solid darkgray'>");a.push("<div tabIndex='"+b+"' ");if(this.is_eForm){a.push("class='report_view_cliplogo_eform' role='text' aria-label='클립 이폼 이미지' ");}else{a.push("class='report_view_cliplogo' role='text' aria-label='클립 이폼 이미지' ");}a.push("style='position:absolute;left:8px;top:12px;height:30%;width:45%;background-color: white;border-style:double;'></div>");a.push("<div tabIndex='"+b+"' role='text' id='mRe_reportinfoTagID1' style='position:absolute;right:8px;top:18px;height:25%;width:45%;'>");var d=new Array();if(this.is_eForm){var f="4.0";if((typeof window.report_version=="undefined")||((-1!=window.report_version.indexOf("5."))&&!this.multiView.isSocket)){f="5.0";}a.push(this.m_languageMap.version+" : "+this.m_languageMap.clipEform+f+"("+this.m_versionInfo.build+")<br>");d.push(this.m_languageMap.version+" : "+this.m_languageMap.clipEform+f+"("+this.m_versionInfo.build+") ");}else{a.push(this.m_languageMap.version+" : "+this.m_languageMap.clipReport+" 4.0("+this.m_versionInfo.build+")<br>");d.push(this.m_languageMap.version+" : "+this.m_languageMap.clipReport+" 4.0("+this.m_versionInfo.build+") ");}if(typeof window.report_version!="undefined"){a.push(this.m_languageMap.webversion+" : "+report_version+" <br>");d.push(this.m_languageMap.webversion+" : "+report_version);}else{a.push(this.m_languageMap.webversion+" : unknown <br>");d.push(this.m_languageMap.webversion+" : unknown");}a.push(this.m_languageMap.build+" : "+this.m_versionInfo.day);a.push("</div>");a.push("<div tabIndex='"+b+"'  role='text' id='mRe_reportinfoTagID2' style='position:absolute;left:8px; right:8px;top:43%;height:50%;'>");a.push("Copyright (C) 2011 CLIPSOFT Co., Ltd. All Rights Reserved.<br>");a.push("http://www.clipsoft.co.kr<br><br>");a.push(this.m_languageMap.report_info_text);a.push("</div></div>");a.push("<button id='mRe_reportinfoTagButton' tabIndex='0'  title='"+this.m_languageMap.ok+"' onclick=\"mRe_closeReportInfo('"+this.m_uid+"');return false;\" class='report_view_button' style='bottom:5px;right:15px;height:30px;width:75px;'>"+this.m_languageMap.ok+"</button>");g.innerHTML=a.join("");a=null;this.m_reportInfo_view=g;if(null!=this.m_popupViewDiv){this.m_popupViewDiv.appendChild(g);}var j=document.getElementById("mRe_reportinfoTagID1");var i=document.getElementById("mRe_reportinfoTagID2");j.setAttribute("aria-label",d.join(""));i.setAttribute("aria-label","Copyright (C) 2011 CLIPSOFT Co., Ltd. All Rights Reserved.\nhttp://www.clipsoft.co.kr\n\n"+this.m_languageMap.report_info_text);if(this.m_nObjJSONViewAccLevel==1){var c=document.getElementById("mRe_reportinfoTagButton");if(null!=c){c.addEventListener("focus",function(){c.style.outline="red 2px solid";});c.addEventListener("blur",function(){c.style.outline="";});c.focus();}}else{var h=document.getElementById("mRe_reportinfoTagID");if(null!=h){h.focus();}}};Report.prototype.checkPrintCount=function(){var a=this.printOptionValue.domList;if(null!=a){return(this.printOptionValue.endNum-this.printOptionValue.startNum)+1;}return this.m_pageCount;};Report.prototype.checkPrintHTMLView=function(){if(null==this.m_limitedPrint){this.m_limitedPrint=100;}if(this.m_directPrintHTML&&this.m_pageCount>this.m_limitedPrint){var a=window.confirm("요청하신 인쇄의 페이지 범위가 너무 많습니다("+this.m_limitedPrint+" 이상)\n페이지가 많을 경우 속도 저하의 문제가 발생 할 수 있습니다. \n계속 진행 하시겠습니까?");if(!a){var b=window.confirm("인쇄 페이지 범위가 많을 경우 PDF 저장 인쇄를 권장하고 있습니다. \nPDF 다운로드 하시겠습니까?");if(b){this.mRe_printFilePDF();}return;}}else{if(this.m_pageCount>this.m_limitedPrint){this.printLimitedExportView("html");return;}}this.mRe_printHTMLView();};Report.prototype.mRe_printHTMLFormSubmit=function(){var d={reportkey:this.m_uid};var b=mRe_makeFormTag(null);b.appendChild(mRe_makeInputTag(null,"ClipID","R09S3"));b.appendChild(mRe_makeInputTag(null,"ClipType","HTMLPrintDownload"));b.appendChild(mRe_makeInputTag(null,"ClipData",JSON.stringify(d)));b.appendChild(mRe_makeInputTag(null,"uid",this.m_uid));b.appendChild(mRe_makeInputTag(null,"clipUID",this.m_uid));if(this.m_postParam!=null){var c=this.m_postParam.paramList;for(var a=0;a<c.length;a++){b.appendChild(mRe_makeInputTag(null,c[a][0],c[a][1]));}}this.targetDiv.appendChild(b);b.action=this.servletPath;if(this.m_isPopupSaveDownload||is_safari14){b.target="_blank";}else{b.target="re_target"+this.m_uid;}b.submit();this.targetDiv.removeChild(b);};Report.prototype.mRe_printHTMLResult=function(a){var b=jQuery.parseJSON(a);if(null!=b){switch(b.id){case 6:if(b.resValue.status){this.fileCheckSend("htmlprint");}else{ReportWebLog("html print server error code>>"+b.resValue.event);this.removePrintProgress();mRe_ReportEventHandler(102);}break;}}else{ReportWebLog("html print error >>"+a);this.removePrintProgress();mRe_ReportEventHandler(102);}};Report.prototype.mRe_makePrintHTMLView=function(){if(null!=this.m_saveJsonDoc&&!this.is_eForm){var i=this;window.setTimeout(function(){i.mRe_clientMakePrintHTMLView();},100);return;}var j=1;var b=this.m_pageCount;if(this.printOptionValue.domList!=null){j=this.printOptionValue.startNum;b=this.printOptionValue.endNum;}var c="PartOfPage;"+j+"-"+b+"";var k="uid="+this.m_uid+"&";k+="clipUID="+this.m_uid+"&";k+="ClipType=DocumentPageView&ClipData=";var h=true;var f=this.m_uid;var a={reportkey:f,isMakeDocument:h,pageMethod:c};k+=encodeURIComponent(JSON.stringify(a));if(this.m_postParam!=null){k+=this.m_postParam.getParam();}k=mRe_onBeforeSend(k);var g=null!=this.m_syncPageServletPath?this.m_syncPageServletPath:this.servletPath;this.debugMeg("report log :: 리포트 인쇄용 데이터를 가져오는 통신을 시도합니다 >>>> "+g);var i=this;var d=new HttpClient();d.send(g,k,true,function(){if(4==this.readyState){if(200==this.status){i.mRe_makePrintHTMLViewResponse(mRe_onAfterSend(this.responseText));}else{i.paintDiv.innerHTML=i.m_languageMap.link_error;i.debugMeg("report log :: 서버 통신 오류 발생 >>> ajax 통신 상태 "+this.status);mRe_ReportEventHandler(40);i.endDebugMeg(false);mRe_ReportWebLog(this.status);}}});};Report.prototype.mRe_clientMakePrintHTMLView=function(){var o=1;var b=this.m_pageCount;if(this.printOptionValue.domList!=null){o=this.printOptionValue.startNum;b=this.printOptionValue.endNum;}o-=1;var r=document.getElementById("re_iframe3"+this.m_uid).contentWindow;var j=0;var n=0;var k=new documentReader();var g=null;g=k.documentReaderFromJSON(this.m_saveJsonDoc,this.servletPath,this.m_uid);if(this.is_eForm){g.documentStorage=this.eFormData;}for(var h=o;h<b;h++){g.addPage(k.readDocumentPage(this.m_saveJsonDocPageList[h]));}var m=g.getPageListLength();for(var l=0;l<m;l++){var f=document.createElement("div");f.className="page-break";if(null==r.document.body){var a=document.createElement("body");r.document.documentElement.appendChild(a);}r.document.body.appendChild(f);j++;var q=new mCR_exportSVG(g,true);q.setPostParam((null!=this.m_postParam)?this.m_postParam.getParam():null);var d=null;if("post"==window.objClipClientPaintConnection){if(l==(m-1)){d=q.exportPage(l,function(){if(!(is_ie||is_edge||is_safari)){r.callPrint();}},f);}else{d=q.exportPage(l,null,f);}}else{d=q.exportPage(l,function(){n++;if(j<=n){if(!(is_ie||is_edge||is_safari)){r.callPrint();}}},f);}var p=q.objPageStyle.width*0.378;var i=q.objPageStyle.height*0.378;if(this.pageWidth==null||this.pageHeight==null){this.pageWidth=p;this.pageHeight=i;if(p>i){this.pageWidth=i;this.pageHeight=p;}var c=getPrintFrameHeader(this.pageWidth,this.pageHeight);if(null!=r.document.head&&!is_ie){r.document.head.innerHTML+=c;}}if(!this.m_isOldHTMLPrint){if(p>i){d.setAttribute("width",i);d.setAttribute("height",p);d.lastChild.setAttribute("transform","scale(1) rotate(270,0,0) translate("+p*-1+",0)");}}}if(is_ie||is_edge||is_safari){r.callPrint();}this.removePrintProgress();this.disabledMenu(false);};Report.prototype.mRe_makePrintHTMLViewResponse=function(q){var p=this;if(null!=q){var o=jQuery.parseJSON(q);o=o.resValue;if(o.status){if(o.event==18){this.debugMeg("report log :: 리포트 서버의 사용자가 많아서 인쇄 호출을 다시 시도 합니다.");window.setTimeout(function(){p.mRe_makePrintHTMLView();},300);return;}else{if(o.event==404){this.debugMeg("report log :: 리포트 서버 세션에서 리포트를 찾을 수 없습니다.");this.debugMeg("report log :: 리포트가 삭제되었거나 이중화 서버일 가능성이 있습니다.");}else{if(o.event==200){var t=mCR_Base64.decode(o.viewData);if(null!=t){t=t.replace(/\+/gi," ");var c=document.getElementById("re_iframe3"+this.m_uid).contentWindow;var g=0;var n=0;var a=new documentReader();var f=JSON.parse(t);var j=null;j=a.documentReaderFromJSON(f.document,this.servletPath,this.m_uid);for(var h=0;h<f.pageList.length;h++){j.addPage(a.readDocumentPage(f.pageList[h]));}var i=j.getPageListLength();for(var h=0;h<i;h++){var d=document.createElement("div");d.className="page-break";if(null==c.document.body){var l=document.createElement("body");c.document.documentElement.appendChild(l);}c.document.body.appendChild(d);g++;var m=new mCR_exportSVG(j,true);m.setPostParam((null!=this.m_postParam)?this.m_postParam.getParam():null);var r=null;if("post"==window.objClipClientPaintConnection){if(h==(i-1)){r=m.exportPage(h,function(){if(!(is_ie||is_edge||is_safari)){c.callPrint();}},d);}else{r=m.exportPage(h,null,d);}}else{r=m.exportPage(h,function(){n++;if(g<=n){if(!(is_ie||is_edge||is_safari)){c.callPrint();}}},d);}var s=m.objPageStyle.width*0.378;var k=m.objPageStyle.height*0.378;if(this.pageWidth==null||this.pageHeight==null){this.pageWidth=s;this.pageHeight=k;if(!this.m_isOldHTMLPrint){if(s>k){this.pageWidth=k;this.pageHeight=s;}}if(s>k){this.pageWidth=k;this.pageHeight=s;}var b=getPrintFrameHeader(this.pageWidth,this.pageHeight);if(null!=c.document.head&&!is_ie){c.document.head.innerHTML+=b;}}if(!this.m_isOldHTMLPrint){if(s>k){r.setAttribute("width",k);r.setAttribute("height",s);r.lastChild.setAttribute("transform","scale(1) rotate(270,0,0) translate("+s*-1+",0)");}}}if(is_ie||is_edge||is_safari){setTimeout(function(){c.callPrint();},100);}}}}}}else{this.debugMeg("report log :: 페이지 호출 후 받은 데이터 >>> 에러코드:"+o.event);}}else{this.debugMeg("report log :: 페이지 호출 후 받은 데이터가 없습니다.>>> 데이터:"+q);}this.removePrintProgress();this.disabledMenu(false);};Report.prototype.mRe_printHTMLView=function(){this.createPrintProgress();try{if(!is_firefox&&!this.m_isAccessibility&&this.m_isObjJSONSVG){this.disabledMenu(true);var q=document.getElementById("re_iframe3"+this.m_uid);if(this.m_isMakePrintHTMLFrame){q.contentWindow.document.body.innerHTML="";}else{var c=793.8;var p=1122.66;if(this.pageWidth!=null&&this.pageHeight!=null){if(!this.m_isOldHTMLPrint){c=this.pageWidth<this.pageHeight?this.pageWidth:this.pageHeight;p=this.pageWidth>this.pageHeight?this.pageWidth:this.pageHeight;}else{c=this.pageWidth;p=this.pageHeight;}}q.contentWindow.document.write(getPrintFrame(c,p));this.m_isMakePrintHTMLFrame=true;}this.mRe_makePrintHTMLView();}else{try{var m=document.getElementById("re_iframe"+this.m_uid);m.style.cssText="display:block;position:absolute;left:0px;top:0px;width:1px;height:1px;visibility:hidden";if(-1!=this.servletPath.indexOf("?")){var b="uid="+this.m_uid+"&clipUID="+this.m_uid+"&ClipID=R15&htmlBlank=true&localSave="+this.m_is_serverSaveFile;if(this.m_postParam!=null){b+=this.m_postParam.getParam();}var a=this.servletPath+"?"+b;m.src=a;}else{var f=mRe_makeFormTag(null,this.servletPath,"re_target"+this.m_uid);f.appendChild(mRe_makeInputTag(null,"uid",this.m_uid));f.appendChild(mRe_makeInputTag(null,"clipUID",this.m_uid));f.appendChild(mRe_makeInputTag(null,"ClipID","R15"));f.appendChild(mRe_makeInputTag(null,"htmlBlank","true"));f.appendChild(mRe_makeInputTag(null,"localSave",this.m_is_serverSaveFile));if(this.m_postParam!=null){var l=this.m_postParam.paramList;for(var j=0;j<l.length;j++){f.appendChild(mRe_makeInputTag(null,l[j][0],l[j][1]));}}this.targetDiv.appendChild(f);f.submit();this.targetDiv.removeChild(f);}}catch(k){mRe_ReportWebLog(k.stack);}var o=1;var d=this.m_pageCount;if(this.printOptionValue.domList!=null){o=this.printOptionValue.startNum;d=this.printOptionValue.endNum;}var g="ClipID=R09S1&ClipType=HTMLPrint&uid="+this.m_uid+"&clipUID="+this.m_uid+"&ClipData=";var n={reportkey:this.m_uid,startNum:o,endNum:d,pageWidth:this.m_printPage.pageWidth,pageHeight:this.m_printPage.pageHeight,isIE:is_ie,isFirefox:is_firefox,isSafari:is_safari,isOldType:this.m_isOldHTMLPrint};var i=this;var h=this.servletPath;g=mRe_onBeforeSend(g+encodeURIComponent(JSON.stringify(n)));if(this.m_postParam!=null){g+=this.m_postParam.getParam();}$.ajax({type:"POST",url:h,data:g,success:function(r){i.mRe_printHTMLResult(mRe_onAfterSend(r));},error:function(r){i.removePrintProgress();mRe_ReportEventHandler(102);}});}}catch(k){this.disabledMenu(false);this.removePrintProgress();mRe_ReportEventHandler(102);}};Report.prototype.mRe_printHTMLViewEnd=function(a){this.removePrintProgress();if(!a){mRe_ReportEventHandler(102);}};Report.prototype.mRe_printHWPView=function(){this.createPrintProgress();try{if(is_ie){if(null==this.hwp_object){var c=document.createElement("div");c.innerHTML=mRe_HWPFrame_Object();this.hwp_object=c.firstChild;this.targetDiv.appendChild(this.hwp_object);c=null;}var b="";if(-1!=this.servletPath.indexOf("?")){b=servletPath+"&";}else{b=this.servletPath+"?";}var a="ClipID=R07&uid="+this.m_uid+"&clipUID="+this.m_uid+"&fileName=report.hwp&print=print&path="+escape(this.clientPath)+"&optionValue="+this.checkPrintJsonOption();if(this.m_postParam!=null){a+=this.m_postParam.getParam();}this.hwp_object.Open(b+a);this.hwp_object.printDocument();this.removePrintProgress();}else{this.formTag_clipid.value="R07";this.formTag_uid.value=this.m_uid;this.formTag_clipUID.value=this.m_uid;this.formTag_print.value="print";this.formTag_path.value=this.clientPath;this.formTag_option.value=this.checkPrintJsonOption();this.formTag.action=this.servletPath;this.formTag.target="_blank";this.formTag.submit();}}catch(d){this.removePrintProgress();mRe_ReportEventHandler(101);}};Report.prototype.mRe_printEXEView=function(){this.debugMeg("report log ::  EXE Print 인쇄를 시작합니다. >>>>>>>>>>>>>>>");if(this.m_isViewer){this.createPrintProgress();}try{var c=this.servletPath;if(!this.m_exePrintStatus.isSet){this.m_exePrintOption.startNumber=this.printOptionValue.startNum;this.m_exePrintOption.endNumber=this.printOptionValue.endNum;}if(is_chrome58||"http:"==location.protocol.toLocaleLowerCase()){this.m_exePrintStatus.url="http://127.0.0.1:";this.m_exePrintStatus.port=this.m_exePrintStatus.httpPort;}else{this.m_exePrintStatus.url="https://127.0.0.1:";this.m_exePrintStatus.port=this.m_exePrintStatus.httpsPort;}var g="";var d="";if(-1!=this.servletPath.indexOf("?")){g=this.servletPath+"&";g+="ClipID=S01";}else{g=this.servletPath;d="ClipID=S01";}this.debugMeg("report log :: EXE Print 인쇄하기 위하여 통신 준비중....");this.debugMeg("report log :: 서버 통신 주소  >>> "+g);var k=new HttpClient();var o="";var a=true;if(typeof getExePrintUseCookie!="undefined"){a=getExePrintUseCookie();}var q="";if(a){if(this.m_postParam!=null){q=this.m_postParam.getParam();if(d!=null){d+=q;}else{g+=q;}}g=mRe_onBeforeSend(g);o=k.send(g,d,false,null);o=ClipStrTrim(mRe_onAfterSend(o));}this.debugMeg("report log :: 리포트 생성 통신 완료..!");this.debugMeg("report log :: 쿠키정보 체크 >>> "+o);var n=this;if(typeof window.exe_print_version!="undefined"){this.debugMeg("report log :: exe Print version >>> "+exe_print_version);}else{this.debugMeg("report log :: exe Print version >>> 확인불가");exe_print_version="1.0.0.1";}var l=this.beforePageIndex+1;q=mCR_Base64.encode(q);var j={cookie:encodeURIComponent(o),serverPath:encodeURIComponent(c),ClipID:"P01",uid:n.m_uid,version:exe_print_version,currentPage:l,totalPageCount:n.m_pageCount,printSet:n.m_exePrintOption,postParam:q};var i="option="+JSON.stringify(j);this.debugMeg("report log :: 프린트 설정 정보 >>> "+i);this.endDebugMeg(true);this.m_exePrintStatus.disConnectCount=0;this.m_exePrintStatus.intervalKey=window.setInterval(function(){if(3==n.m_exePrintStatus.disConnectCount){window.clearInterval(n.m_exePrintStatus.intervalKey);if(n.m_isViewer){n.removePrintProgress();}n.notFoundEXEService(false);mRe_ReportEventHandler(103);}},1500);if(window.XDomainRequest){var u=new XDomainRequest();if(u){try{u.onload=function(){n.startEXEPrintResponse(u.responseText);};u.onerror=function(){n.m_exePrintStatus.disConnectCount++;};u.open("GET",this.m_exePrintStatus.url+this.m_exePrintStatus.port[0]+"?"+i);u.send();}catch(h){mRe_ReportWebLog(h.stack);}}var t=new XDomainRequest();if(t){try{t.onload=function(){n.startEXEPrintResponse(t.responseText);};t.onerror=function(){n.m_exePrintStatus.disConnectCount++;};t.open("GET",this.m_exePrintStatus.url+this.m_exePrintStatus.port[1]+"?"+i);t.send();}catch(h){mRe_ReportWebLog(h.stack);}}var s=new XDomainRequest();if(s){try{s.onload=function(){n.startEXEPrintResponse(s.responseText);};s.onerror=function(){n.m_exePrintStatus.disConnectCount++;};s.open("GET",this.m_exePrintStatus.url+this.m_exePrintStatus.port[2]+"?"+i);s.send();}catch(h){mRe_ReportWebLog(h.stack);}}}else{var m="POST";if(typeof getExePrintAjaxType!="undefined"){m=getExePrintAjaxType();}for(var f=0;f<this.m_exePrintStatus.port.length;f++){var b=this.m_exePrintStatus.port[f];var r=this.m_exePrintStatus.url+b;$.ajax({type:m,url:r,crossDomain:true,data:i,success:function(v){n.startEXEPrintResponse(v);},error:function(v){n.m_exePrintStatus.disConnectCount++;}});}}}catch(p){if(this.m_isViewer){this.removePrintProgress();}mRe_ReportEventHandler(104);}};Report.prototype.mRe_adobeCheck=function(){if(m_report_printOption.acrobat){if(is_ie||is_ie11){if(is_win78_reader9&&this.adobe9Permission){return true;}else{if(is_win78_reader9||is_reader8){return false;}}}return true;}else{return false;}};Report.prototype.mRe_printView=function(c){if(typeof c=="undefined"){c=false;}if(this.m_PDFPopupPrintInfoDisplay){if(!c&&(is_firefox||is_safari14)){this.printFirefoxExportView();return;}}this.createPrintProgress();if(!this.mRe_adobeCheck()){this.mRe_printView_demon();return;}var b="R08";if(this.m_is_serverSaveFile){b="R09S1";}var a="t"+new Date().getMilliseconds();var f="ClipID="+b+"&uid="+this.m_uid+"&clipUID="+this.m_uid+"&isPDFPrintImage="+this.isPDFPrintImage+"&isPDFPrintBarcodeAWT="+this.isPDFPrintBarcodeAWT+"&print=print&path="+escape(this.clientPath)+"&isChromePrintFitToPage="+this.isChromePrintFitToPage+"&optionValue="+encodeURIComponent(this.checkPrintJsonOption())+"&s_time="+a;if(this.m_postParam!=null){f+=this.m_postParam.getParam();}if(this.m_is_serverSaveFile){if(this.mRe_serverSaveFileOption(f)){this.mRe_print_progress_check();}else{this.debugMeg("report log :: 서버에 프린트 파일(pdf) 저장에 문제가 발생하였습니다. 서버 로그를 확인하세요.");this.removePrintProgress();mRe_ReportEventHandler(41);}}else{var d=true;if(window.onSaveBeforeSend!=null){d=onSaveBeforeSend(this,f,"pdf");}if(d){this.mRe_printView_demon();}}};function onSaveBeforeSend(a,c,b){return true;}Report.prototype.mRe_printView_demon=function(){if(m_report_printOption.acrobat){if(is_firefox||is_window_safari||is_safari14){this.mRe_printPopFilePDF_down();}else{if(is_chrome||is_opera){if("Chrome PDF Viewer"==m_report_printOption.acrobatVersion||"Chromium PDF Viewer"==m_report_printOption.acrobatVersion||"Microsoft Edge PDF Viewer"==m_report_printOption.acrobatVersion){var a="({'url':'"+this.servletPath+"','uid':'"+this.m_uid+"','isPDFPrintImage':'"+this.isPDFPrintImage+"','isPDFPrintBarcodeAWT':'"+this.isPDFPrintBarcodeAWT+"','isChromePrintFitToPage':'"+this.isChromePrintFitToPage+"','clientPath':'"+this.clientPath+"','optionValue':";a+=this.checkPrintJsonOption();if(null!=this.m_postParam){a+=",'postParam':'"+this.m_postParam.getParam()+"'})";}else{a+="})";}var c=document.getElementById("re_iframe2"+this.m_uid);var b=c.contentWindow;if(!this.isMakePDFFrame){b.document.write(getPDFPrintFrame(this.m_is_serverSaveFile));this.isMakePDFFrame=true;}b.postMessage(a,"*");}else{this.mRe_printPopFilePDF_down();}}else{if(is_ie||is_ie11){if(is_win78_reader9&&this.adobe9Permission){this.printIEWindow();}else{if(is_win78_reader9||is_reader8){this.removePrintProgress();if(!this.m_directPrint){this.printIEExportView();}mRe_ReportEventHandler(150);}else{this.printIEWindow();}}}else{if(is_edge||is_safari){if(this.isMakePDFFrame){var a="({'url':'"+this.servletPath+"','uid':'"+this.m_uid+"','isPDFPrintImage':'"+this.isPDFPrintImage+"','isPDFPrintBarcodeAWT':'"+this.isPDFPrintBarcodeAWT+"','isChromePrintFitToPage':'"+this.isChromePrintFitToPage+"','clientPath':'"+this.clientPath+"','optionValue':";a+=this.checkPrintJsonOption()+"})";var c=document.getElementById("re_iframe2"+this.m_uid);var b=c.contentWindow;if(!this.isMakePDFFrame){b.document.write(getPDFPrintFrame(this.m_is_serverSaveFile));this.isMakePDFFrame=true;}b.postMessage(a,"*");}else{this.printSafariWindow();}}}}}}else{if(this.m_isPrintPop&&this.m_ignorePDFObject){this.debugMeg("report log :: IE브라우져에서 추가기능에 adobe reader 사용을 확인 하셔야 합니다.");this.debugMeg("report log :: pdf 다운로드 팝업으로 변경되었습니다.");this.printIEWindow();}else{if(is_mozBrowser||is_safari){this.mRe_printPopFilePDF_down();}else{this.removePrintProgress();if(!this.m_directPrint){this.printNotExportView();}mRe_ReportEventHandler(100);}}}};Report.prototype.printSafariWindow=function(){var c="R08";if(this.m_is_serverSaveFile){c="R09S3";}this.formTag_clipid.value=c;this.formTag_uid.value=this.m_uid;this.formTag_clipUID.value=this.m_uid;this.formTag_print.value="print";this.formTag_printImage.value=this.isPDFPrintImage;this.formTag_printBarcodeAWT.value=this.isPDFPrintBarcodeAWT;this.formTag_path.value=this.clientPath;this.formTag_option.value=this.checkPrintJsonOption();this.formTag_ChromeFitToPage.value=this.isChromePrintFitToPage;this.formTag_s_time.value="t"+new Date().getMilliseconds();if(null==this.formTag){this.mRe_makePrintNewForm();}this.formTag.action=this.servletPath;this.formTag.target="re_target2"+this.m_uid;var b=document.getElementById("re_iframe2"+this.m_uid);b.onload=function(){b.focus();b.contentWindow.print();};this.formTag.submit();var a=this;if(!this.m_is_serverSaveFile){this.fileDownloadCheckTimer=window.setTimeout(function(){a.fileCheckSend("print");},1000);}};Report.prototype.printChromeWindow=function(){var c="R09S3";this.formTag_clipid.value=c;this.formTag_uid.value=this.m_uid;this.formTag_clipUID.value=this.m_uid;this.formTag_print.value="print";this.formTag_printImage.value=this.isPDFPrintImage;this.formTag_printBarcodeAWT.value=this.isPDFPrintBarcodeAWT;this.formTag_path.value=this.clientPath;this.formTag_option.value=this.checkPrintJsonOption();this.formTag_ChromeFitToPage.value=this.isChromePrintFitToPage;this.formTag_s_time.value="t"+new Date().getMilliseconds();if(null==this.formTag){this.mRe_makePrintNewForm();}this.formTag.action=this.servletPath;this.formTag.target="re_target2"+this.m_uid;var b=document.getElementById("re_iframe2"+this.m_uid);b.src="about:blank";this.formTag.submit();var a=this;if(!this.m_is_serverSaveFile){this.fileDownloadCheckTimer=window.setTimeout(function(){a.fileCheckSend("print");},1000);}};Report.prototype.printIEWindow=function(){var b="R08";if(this.m_is_serverSaveFile){b="R09S3";}if(this.m_isPrintPop){this.formTag_clipid.value=b;this.formTag_uid.value=this.m_uid;this.formTag_clipUID.value=this.m_uid;this.formTag_print.value="print";this.formTag_printImage.value=this.isPDFPrintImage;this.formTag_printBarcodeAWT.value=this.isPDFPrintBarcodeAWT;this.formTag_path.value=this.clientPath;this.formTag_option.value=this.checkPrintJsonOption();this.formTag_ChromeFitToPage.value=this.isChromePrintFitToPage;this.formTag_s_time.value="t"+new Date().getMilliseconds();if(null==this.formTag){this.mRe_makePrintNewForm();}this.formTag.action=this.servletPath;if(-1!=this.servletPath.indexOf("?")){this.formTag.method="get";}if(this.m_isPopupSaveDownload){this.formTag.target="_blank";}else{if(is_edge||is_safari){this.formTag.target="re_target2"+this.m_uid;var j=document.getElementById("re_iframe2"+report_key);j.onload=function(){j.focus();j.contentWindow.print();};}else{this.formTag.target="re_target"+this.m_uid;}}this.formTag.submit();var f=this;if(!this.m_is_serverSaveFile){this.fileDownloadCheckTimer=window.setTimeout(function(){f.fileCheckSend("print");},1000);}}else{var g=document.getElementById("re_object"+this.m_uid);if(null==g){var d=document.createElement("div");d.style.cssText="postion:absolute;left:0px;top:0px;width:1px;height:1px;border:0px solid transparent";var i="<object id='re_object"+this.m_uid+"' classid='CLSID:CA8A9780-280D-11CF-A24D-444553540000' type='application/pdf' style='position:absolute;left:0px;top:0px;width:1px;height:1px;display:none;'></object>";d.innerHTML=i;if(this.m_directPrint){document.body.appendChild(d);}else{this.targetDiv.appendChild(d);}g=d.firstChild;}var a=this.servletPath+"?";if(-1!=this.servletPath.indexOf("?")){a=this.servletPath+"&";}var c="t"+new Date().getMilliseconds();var h=a+"ClipID="+b+"&uid="+this.m_uid+"&clipUID="+this.m_uid+"&isPDFPrintImage="+this.isPDFPrintImage+"&isPDFPrintBarcodeAWT="+this.isPDFPrintBarcodeAWT+"&print=print&path="+escape(this.clientPath)+"&isChromePrintFitToPage="+this.isChromePrintFitToPage+"&optionValue="+encodeURIComponent(this.checkPrintJsonOption())+"&s_time="+c;if(this.m_postParam!=null){h+=this.m_postParam.getParam();}g.src=h;g.style.display="block";CReportPrintPDf(this.m_uid);}};Report.prototype.next_printPdfDownLoad=function(){if(this.fileDownLoding){this.debugMeg("report log :: 다른 파일 저장중입니다..파일 저장을 종료합니다.");this.endDebugMeg(true);return;}var a="R09";var f="R09";if(this.m_is_serverSaveFile){a="R09S1";f="R09S3";}this.fileDownLoding=true;var c=this;var d=this.m_uid;this.debugMeg("report log :: PDF 파일 저장 시작..");if(this.m_isEndReport){this.createSAVEProgress();this.saveFormTag.clipid.value=f;this.saveFormTag.uid.value=d;this.saveFormTag.clipUID.value=d;this.saveFormTag.path.value=this.clientPath;var i=mCR_Base64.encode(encodeURIComponent(this.m_strFileName+this.m_strAppendFileName));var h={exportType:2,name:i,pageType:1,startNum:this.printOptionValue.startNum,endNum:this.printOptionValue.endNum,option:{isSplite:false,spliteValue:1,fileNames:[],userpw:"",textToImage:false,importOriginImage:false,removeHyperlink:false}};var g=null;if(this.m_saveDirectPDFOp!=null){g=this.m_saveDirectPDFOp;}else{if((typeof window.getDirectSavePDFOption!="undefined")){g=getDirectSavePDFOption();}}h.option.memoExport=this.isMemoExport;h.option.memoTransparency=this.nMemoTransparency;if(g!=null){if("cmVwb3J0"==i){h.name=mCR_Base64.encode(g.fileName);}h.option.isSplite=g.isSplite;h.option.spliteValue=g.spliteValue;h.option.userpw=g.userpw;h.option.textToImage=g.textToImage;h.option.importOriginImage=g.importOriginImage;h.option.removeHyperlink=g.removeHyperlink;}this.saveFormTag.option.value=JSON.stringify(h);this.saveFormTag.filename.value=h.name;this.saveFormTag.filetype.value=h.exportType;this.debugMeg("report log :: PDF 파일 저장 옵션 check >> "+m_getSaveFormTag(this.saveFormTag));var j="ClipID="+a+"&uid="+this.m_uid+"&clipUID="+this.m_uid+"&path="+escape(this.clientPath)+"&optionValue="+encodeURIComponent(JSON.stringify(h))+"&exportN="+h.name+"&exportType="+h.exportType+"&is_ie="+((!is_firefox)&&(!is_safari)&&(!is_apple));if(this.m_postParam!=null){j+=this.m_postParam.getParam();}if(this.m_is_serverSaveFile){if(this.mRe_serverSaveFileOption(j)){this.mRe_saveFile_progress_check();}else{this.debugMeg("report log :: 서버에 파일 저장에 문제가 발생하였습니다. 서버 로그를 확인하세요.");this.removeSAVEProgress();mRe_ReportEventHandler(41);}}else{var b=true;if(window.onSaveBeforeSend!=null){b=onSaveBeforeSend(this,j,"save");}if(b){this.mRe_saveFile_demon();this.mRe_saveFile_progress_check();}}}else{mRe_ReportEventHandler(10);}window.setTimeout(function(){c.fileDownLoding=false;},2000);};Report.prototype.next_pdfDownLoad=function(i){if(this.fileDownLoding){this.debugMeg("report log :: 다른 파일 저장중입니다..파일 저장을 종료합니다.");this.endDebugMeg(true);return;}var b="R09";var g="R09";if(this.m_is_serverSaveFile){b="R09S1";g="R09S3";}this.fileDownLoding=true;var d=this;var f=this.m_uid;this.debugMeg("report log :: PDF 파일 저장 시작..");if(this.m_isEndReport&&is_smartphone){this.createSAVEProgress();this.saveFormTag.clipid.value=g;this.saveFormTag.uid.value=f;this.saveFormTag.clipUID.value=f;this.saveFormTag.path.value=this.clientPath;var k=mCR_Base64.encode(encodeURIComponent(this.m_strFileName+this.m_strAppendFileName));var j={exportType:2,name:k,pageType:1,startNum:1,endNum:this.m_pageCount,option:{isSplite:false,spliteValue:1,fileNames:[],userpw:""}};j.option.memoExport=this.isMemoExport;j.option.memoTransparency=this.nMemoTransparency;var h=null;if(this.m_saveDirectPDFOp!=null){h=this.m_saveDirectPDFOp;}else{if((typeof window.getDirectSavePDFOption!="undefined")){h=getDirectSavePDFOption();}}if(h!=null){if("cmVwb3J0"==k){j.name=mCR_Base64.encode(h.fileName);}j.option.isSplite=h.isSplite;j.option.spliteValue=h.spliteValue;j.option.userpw=h.userpw;j.option.textToImage=h.textToImage;j.option.importOriginImage=h.importOriginImage;j.option.removeHyperlink=h.removeHyperlink;}var a=JSON.stringify(j);this.saveFormTag.option.value=a;this.saveFormTag.filename.value=j.name;this.saveFormTag.filetype.value=j.exportType;this.saveFormTag.isMobile.value=is_smartphone;this.debugMeg("report log :: PDF 파일 저장 옵션 check >> "+m_getSaveFormTag(this.saveFormTag));var l="ClipID="+b+"&uid="+this.m_uid+"&clipUID="+this.m_uid+"&path="+escape(this.clientPath)+"&optionValue="+encodeURIComponent(JSON.stringify(j))+"&exportN="+j.name+"&exportType="+j.exportType+"&isSmartPhone="+is_smartphone+"&is_ie="+((!is_firefox)&&(!is_safari)&&(!is_apple));if(this.m_postParam!=null){l+=this.m_postParam.getParam();}if(this.m_is_serverSaveFile){if(this.mRe_serverSaveFileOption(l)){this.mRe_saveFile_progress_check(i);}else{this.debugMeg("report log :: 서버에 파일 저장에 문제가 발생하였습니다. 서버 로그를 확인하세요.");if(i==0){this.removeSAVEProgress();}else{this.removePDFProgress();}mRe_ReportEventHandler(41);}}else{var c=true;if(window.onSaveBeforeSend!=null){c=onSaveBeforeSend(this,l,"mobile_pdf");}if(c){this.mRe_mobilePDF_demon();this.mRe_saveFile_progress_check(i);}}}else{if(this.m_isEndReport){this.createSAVEProgress();this.saveFormTag.clipid.value=g;this.saveFormTag.uid.value=f;this.saveFormTag.clipUID.value=f;this.saveFormTag.path.value=this.clientPath;var k=mCR_Base64.encode(encodeURIComponent(this.m_strFileName+this.m_strAppendFileName));var j={exportType:2,name:k,pageType:1,startNum:1,endNum:this.m_pageCount,option:{isSplite:false,spliteValue:1,fileNames:[],userpw:"",textToImage:false,importOriginImage:false,removeHyperlink:false}};j.option.memoExport=this.isMemoExport;j.option.memoTransparency=this.nMemoTransparency;var h=null;if(this.m_saveDirectPDFOp!=null){h=this.m_saveDirectPDFOp;}else{if((typeof window.getDirectSavePDFOption!="undefined")){h=getDirectSavePDFOption();}}if(h!=null){if("cmVwb3J0"==k){j.name=mCR_Base64.encode(h.fileName);}j.option.isSplite=h.isSplite;j.option.spliteValue=h.spliteValue;j.option.userpw=h.userpw;j.option.textToImage=h.textToImage;j.option.importOriginImage=h.importOriginImage;j.option.removeHyperlink=h.removeHyperlink;}this.saveFormTag.option.value=JSON.stringify(j);this.saveFormTag.filename.value=j.name;this.saveFormTag.filetype.value=j.exportType;this.debugMeg("report log :: PDF 파일 저장 옵션 check >> "+m_getSaveFormTag(this.saveFormTag));var l="ClipID="+b+"&uid="+this.m_uid+"&clipUID="+this.m_uid+"&path="+escape(this.clientPath)+"&optionValue="+encodeURIComponent(JSON.stringify(j))+"&exportN="+j.name+"&exportType="+j.exportType+"&is_ie="+((!is_firefox)&&(!is_safari)&&(!is_apple));if(this.m_postParam!=null){l+=this.m_postParam.getParam();}if(this.m_is_serverSaveFile){if(this.mRe_serverSaveFileOption(l)){this.mRe_saveFile_progress_check(i);}else{this.debugMeg("report log :: 서버에 파일 저장에 문제가 발생하였습니다. 서버 로그를 확인하세요.");if(i==0){this.removeSAVEProgress();}else{this.removePDFProgress();}mRe_ReportEventHandler(41);}}else{var c=true;if(window.onSaveBeforeSend!=null){c=onSaveBeforeSend(this,l,"save");}if(c){this.mRe_saveFile_demon();this.mRe_saveFile_progress_check(i);}}}else{mRe_ReportEventHandler(10);}}window.setTimeout(function(){d.fileDownLoding=false;},2000);};Report.prototype.mRe_mobilePDF_demon=function(){if(-1!=this.servletPath.indexOf("?")){window.open(whiteListCheck(this.servletPath)+"&"+m_getSaveFormTag(this.saveFormTag));}else{this.saveFormTag.form.action=this.servletPath;this.saveFormTag.form.target="blank";this.saveFormTag.form.submit();}optionValue=null;var a=this;if(this.m_fileDownLoadServerCheck){this.fileDownloadCheckTimer=window.setTimeout(function(){a.fileCheckSend("pdf");},1000);}};Report.prototype.next_hwpDownLoad=function(){if(this.fileDownLoding){return;}var a="R09";var f="R09";if(this.m_is_serverSaveFile){a="R09S1";f="R09S3";}var c=this;this.debugMeg("report log :: HWP 파일 저장 시작..");this.fileDownLoding=true;if(this.m_isEndReport){this.createSAVEProgress();this.saveFormTag.clipid.value=f;this.saveFormTag.uid.value=this.m_uid;this.saveFormTag.clipUID.value=this.m_uid;this.saveFormTag.path.value=this.clientPath;var i=mCR_Base64.encode(encodeURIComponent(this.m_strFileName+this.m_strAppendFileName));var d=this.m_pageCount>this.m_splitPage?this.m_splitPage:0;var h={exportType:3,name:i,pageType:1,startNum:1,endNum:this.m_pageCount,option:{fixSize:true,allowOverlay:true,setPageBottomMarginToZero:true,outputLikeWord:false,tableSplitMethod:2,defaultCharGap:-8,charRatio:100,putCheckboxIntoCell:false,splitTextByLine:true,mergeTable:false,lineSpaceRate:100,positionRelTo:1,hwpExportMethod:1,splitPageOnListTableOnly:true,pageBottomMarginApplicationRate:100,insertPageNumber:false,mergeAllTablesOnListTableOnly:false,insertLabelWithTextOnListTableOnly:false,isTransparentMode:false,isSectionClear:false}};var g=null;if(this.m_saveDirectHWPOp!=null){g=this.m_saveDirectHWPOp;}else{if((typeof window.getDirectSaveHWPOption!="undefined")){g=getDirectSaveHWPOption();}}if(g!=null){if("cmVwb3J0"==i){h.name=mCR_Base64.encode(g.fileName);}h.option.splitPage=d;h.option.fixSize=g.fixSize;h.option.allowOverlay=g.allowOverlay;h.option.setPageBottomMarginToZero=g.setPageBottomMarginToZero;h.option.pageBottomMarginApplicationRate=g.pageBottomMarginApplicationRate;h.option.insertPageNumber=g.insertPageNumber;h.option.outputLikeWord=g.outputLikeWord;h.option.tableSplitMethod=g.tableSplitMethod;h.option.defaultCharGap=g.defaultCharGap;h.option.charRatio=g.charRatio;h.option.putCheckboxIntoCell=g.putCheckboxIntoCell;h.option.splitTextByLine=g.splitTextByLine;h.option.mergeTable=g.mergeTable;h.option.lineSpaceRate=g.lineSpaceRate;h.option.positionRelTo=g.positionRelTo;h.option.hwpExportMethod=g.hwpExportMethod;h.option.splitPageOnListTableOnly=g.splitPageOnListTableOnly;h.option.mergeAllTablesOnListTableOnly=g.mergeAllTablesOnListTableOnly;h.option.insertLabelWithTextOnListTableOnly=g.insertLabelWithTextOnListTableOnly;h.option.isTransparentMode=g.isTransparentMode;h.option.isSectionClear=g.isSectionClear;}this.saveFormTag.option.value=JSON.stringify(h);this.saveFormTag.filename.value=h.name;this.saveFormTag.filetype.value=h.exportType;this.debugMeg("report log :: HWP 파일 저장 옵션 check >> "+m_getSaveFormTag(this.saveFormTag));var j="ClipID="+a+"&uid="+this.m_uid+"&clipUID="+this.m_uid+"&path="+escape(this.clientPath)+"&optionValue="+encodeURIComponent(JSON.stringify(h))+"&exportN="+h.name+"&exportType="+h.exportType+"&is_ie="+((!is_firefox)&&(!is_safari)&&(!is_apple));if(this.m_postParam!=null){j+=this.m_postParam.getParam();}if(this.m_is_serverSaveFile){if(this.mRe_serverSaveFileOption(j)){this.mRe_saveFile_progress_check();}else{this.debugMeg("report log :: 서버에 파일 저장에 문제가 발생하였습니다. 서버 로그를 확인하세요.");this.removeSAVEProgress();mRe_ReportEventHandler(41);}}else{var b=true;if(window.onSaveBeforeSend!=null){b=onSaveBeforeSend(this,j,"save");}if(b){this.mRe_saveFile_demon();this.mRe_saveFile_progress_check();}}}else{mRe_ReportEventHandler(10);}window.setTimeout(function(){c.fileDownLoding=false;},2000);};Report.prototype.next_docDownLoad=function(){if(this.fileDownLoding){return;}var a="R09";var f="R09";if(this.m_is_serverSaveFile){a="R09S1";f="R09S3";}var c=this;this.debugMeg("report log :: DOC 파일 저장 시작..");this.fileDownLoding=true;if(this.m_isEndReport){this.createSAVEProgress();this.saveFormTag.clipid.value=f;this.saveFormTag.uid.value=this.m_uid;this.saveFormTag.clipUID.value=this.m_uid;this.saveFormTag.path.value=this.clientPath;var i=mCR_Base64.encode(encodeURIComponent(this.m_strFileName+this.m_strAppendFileName));var d=this.m_pageCount>this.m_splitPage?this.m_splitPage:0;var h={exportType:9,name:i,pageType:1,startNum:1,endNum:this.m_pageCount,option:{type:"doc",splitTextLine:true,processAsUnicode:true,processEqualAlign:4,defaultCharSpace:-0.5,tableWrapperBottomGap:0,insertTableWrapper:true,mergeTable:false}};var g=null;if(this.m_saveDirectDOCOp!=null){g=this.m_saveDirectDOCOp;}else{if((typeof window.getDirectSaveDOCOption!="undefined")){g=getDirectSaveDOCOption();}}if(g!=null){if("cmVwb3J0"==i){h.name=mCR_Base64.encode(g.fileName);}h.option.splitPage=d;h.option.type=g.type;h.option.splitTextLine=g.splitTextLine;h.option.processAsUnicode=g.processAsUnicode;h.option.processEqualAlign=g.processEqualAlign;h.option.defaultCharSpace=g.defaultCharSpace;h.option.tableWrapperBottomGap=g.tableWrapperBottomGap;h.option.insertTableWrapper=g.insertTableWrapper;h.option.mergeTable=g.mergeTable;}this.saveFormTag.option.value=JSON.stringify(h);this.saveFormTag.filename.value=h.name;this.saveFormTag.filetype.value=h.exportType;this.debugMeg("report log :: DOC 파일 저장 옵션 check >> "+m_getSaveFormTag(this.saveFormTag));var j="ClipID="+a+"&uid="+this.m_uid+"&clipUID="+this.m_uid+"&path="+escape(this.clientPath)+"&optionValue="+encodeURIComponent(JSON.stringify(h))+"&exportN="+h.name+"&exportType="+h.exportType+"&is_ie="+((!is_firefox)&&(!is_safari)&&(!is_apple));if(this.m_postParam!=null){j+=this.m_postParam.getParam();}if(this.m_is_serverSaveFile){if(this.mRe_serverSaveFileOption(j)){this.mRe_saveFile_progress_check();}else{this.debugMeg("report log :: 서버에 파일 저장에 문제가 발생하였습니다. 서버 로그를 확인하세요.");this.removeSAVEProgress();mRe_ReportEventHandler(41);}}else{var b=true;if(window.onSaveBeforeSend!=null){b=onSaveBeforeSend(this,j,"save");}if(b){this.mRe_saveFile_demon();this.mRe_saveFile_progress_check();}}}else{mRe_ReportEventHandler(10);}window.setTimeout(function(){c.fileDownLoding=false;},2000);};Report.prototype.next_excelDownLoad=function(){if(this.fileDownLoding){return;}var a="R09";var f="R09";if(this.m_is_serverSaveFile){a="R09S1";f="R09S3";}var c=this;this.fileDownLoding=true;if(this.m_isEndReport){this.printOptionValue.domList=null;this.debugMeg("report log :: EXCEL 파일 저장 시작..");this.createSAVEProgress();this.saveFormTag.clipid.value=f;this.saveFormTag.uid.value=this.m_uid;this.saveFormTag.clipUID.value=this.m_uid;this.saveFormTag.path.value=this.clientPath;var i=mCR_Base64.encode(encodeURIComponent(this.m_strFileName+this.m_strAppendFileName));var d=this.m_pageCount>this.m_splitPage?this.m_splitPage:0;var h={exportType:1,name:i,pageType:1,startNum:1,endNum:this.m_pageCount,option:{exportMethod:"1",mergeCell:true,mergeEmptyCell:false,splitCellAtPageSize:true,rightToLeft:false,widthRate:100,heightRate:100,coordinateErrorLimit:10,processGerenalFormat:1,printingMagnification:100,fitToPageWhenPrinting:false,removeHyperlink:false,repeatPageSectionWhenAllSectionInOneSheet:false,useSubreportNameAsSheetName:false,defaultPageSheetName:"",type:"xls",clearEmptySubSection:false,clearCrosstabHeader:false}};var g=null;if(this.m_saveDirectExcelOp!=null){g=this.m_saveDirectExcelOp;}else{if((typeof window.getDirectSaveEXCELOption!="undefined")){g=getDirectSaveEXCELOption();}}if(g!=null){if("cmVwb3J0"==i){h.name=mCR_Base64.encode(g.fileName);}h.option.splitPage=d;h.option.exportMethod=g.exportMethod;h.option.mergeCell=g.mergeCell;h.option.mergeEmptyCell=g.mergeEmptyCell;h.option.splitCellAtPageSize=g.splitCellAtPageSize;h.option.rightToLeft=g.rightToLeft;h.option.widthRate=g.widthRate;h.option.heightRate=g.heightRate;h.option.coordinateErrorLimit=g.coordinateErrorLimit;h.option.processGerenalFormat=g.processGerenalFormat;h.option.printingMagnification=g.printingMagnification;h.option.fitToPageWhenPrinting=g.fitToPageWhenPrinting;h.option.removeHyperlink=g.removeHyperlink;h.option.repeatPageSectionWhenAllSectionInOneSheet=g.repeatPageSectionWhenAllSectionInOneSheet;h.option.useSubreportNameAsSheetName=g.useSubreportNameAsSheetName;h.option.defaultPageSheetName=g.defaultPageSheetName;h.option.clearEmptySubSection=g.clearEmptySubSection;h.option.clearCrosstabHeader=g.clearCrosstabHeader;}this.saveFormTag.option.value=JSON.stringify(h);this.saveFormTag.filename.value=h.name;this.saveFormTag.filetype.value=h.exportType;this.debugMeg("report log :: EXCEL 파일 저장 옵션 check >> "+m_getSaveFormTag(this.saveFormTag));var j="ClipID="+a+"&uid="+this.m_uid+"&clipUID="+this.m_uid+"&path="+escape(this.clientPath)+"&optionValue="+encodeURIComponent(JSON.stringify(h))+"&exportN="+h.name+"&exportType="+h.exportType+"&is_ie="+((!is_firefox)&&(!is_safari)&&(!is_apple));if(this.m_postParam!=null){j+=this.m_postParam.getParam();}if(this.m_is_serverSaveFile){if(this.mRe_serverSaveFileOption(j)){this.mRe_saveFile_progress_check();}else{this.debugMeg("report log :: 서버에 파일 저장에 문제가 발생하였습니다. 서버 로그를 확인하세요.");this.removeSAVEProgress();mRe_ReportEventHandler(41);}}else{var b=true;if(window.onSaveBeforeSend!=null){b=onSaveBeforeSend(this,j,"save");}if(b){this.mRe_saveFile_demon();this.mRe_saveFile_progress_check();}}}else{mRe_ReportEventHandler(10);}window.setTimeout(function(){c.fileDownLoding=false;},2000);};Report.prototype.fileCheckSendText=function(a,c){var b=this;var d=objectCall(ClipStrTrim(a));if(typeof d=="string"){d=objectCall(d);}if(d.status){if("xls"==c){this.removeEXCELProgress();}else{if("hwp"==c){this.removeHWPProgress();}else{if("save"==c){if(this.m_is_serverSaveFile){this.mRe_saveFile_demon();}window.setTimeout(function(){b.removeSAVEProgress();},1500);}else{if("error_save"==c){if(this.m_is_serverSaveFile){this.mRe_saveFile_demon();}window.setTimeout(function(){b.removePDFProgress();},1500);}else{if("pdf"==c){this.removePDFProgress();}else{if("print"==c){if(this.m_is_serverSaveFile){this.mRe_printView_demon();}window.setTimeout(function(){b.removePrintProgress();},1500);}else{if("htmlprint"==c){this.mRe_printHTMLFormSubmit();window.setTimeout(function(){b.removePrintProgress();},1500);}}}}}}}this.endDebugMeg(false);}else{this.fileDownloadCheckTimer=window.setTimeout(function(){b.fileCheckSend(c);},1000);}};Report.prototype.fileCheckSendErrorText=function(a){if("xls"==a){this.removeEXCELProgress();}else{if("hwp"==a){this.removeHWPProgress();}else{if("save"==a){this.removeSAVEProgress();}else{if("pdf"==a){this.removePDFProgress();}else{if("print"==a){this.removePrintProgress();}}}}}};Report.prototype.fileCheckSend=function(i){var b="R16";if(this.m_is_serverSaveFile||"htmlprint"==i){b="R09S2";}try{var c="t"+new Date().getMilliseconds();var k="ClipID="+b+"&uid="+this.m_uid+"&clipUID="+this.m_uid+"&s_time="+c;if(this.m_postParam!=null){k+=this.m_postParam.getParam();}k=mRe_onBeforeSend(k);var g=this.servletPath;if(this.m_isCrossDomain){var h=this;if(window.XDomainRequest){var f=new XDomainRequest();var a=g+"?"+k;if(-1!=g.indexOf("?")){a=g+"&"+k;}if(f){f.onload=function(){h.fileCheckSendText(mRe_onAfterSend(f.responseText),i);};f.onerror=function(){ReportWebLog("IE8 crossDomain error");mRe_ReportEventHandler(40);};f.open("GET",a);f.send();}}else{$.ajax({type:"POST",url:g,crossDomain:true,data:k,success:function(l){h.fileCheckSendText(mRe_onAfterSend(l),i);},error:function(l){ReportWebLog(l);mRe_ReportEventHandler(40);}});}}else{var h=this;var d=new HttpClient();d.send(g,k,true,function(){if(4==this.readyState){if(200==this.status){h.fileCheckSendText(mRe_onAfterSend(this.responseText),i);}else{h.fileCheckSendErrorText(i);}}});}}catch(j){mRe_ReportWebLog(j.stack);}};Report.prototype.reportCheckSendText=function(a,b){var d=objectCall(ClipStrTrim(a));if(typeof d=="string"){d=objectCall(d);}if(d.status){this.debugMeg("report log :: 서버연결 상태 정상...!");if(0==b){this.saveExportView();}else{if(1==b){this.next_pdfDownLoad(0);}else{if(10==b){this.next_pdfDownLoad(1);}else{if(2==b){this.next_excelDownLoad();}else{if(3==b){this.next_hwpDownLoad();}else{if(4==b){this.selectPrintView();}else{if(5==b){this.next_docDownLoad();}else{if(6==b){this.mRe_printView();}else{if(7==b){this.printHTMLView(true);}else{if(8==b){this.printEXEView(true);}else{if(9==b){this.printHWPView(true);}}}}}}}}}}}}else{this.debugMeg("report log :: 서버에서 생성된 리포트 파일을 찾을 수 없습니다.");this.debugMeg("report log :: 이중화 서버로 인한 파일을 찾지 못하거나 세션이 종료되어 리포트파일이 삭제된 것 같습니다.");this.endDebugMeg(false);var c=this.m_languageMap.sesstion_error;this.paintDiv.innerHTML=c;mRe_ReportEventHandler(60);}};Report.prototype.reportCheckSend=function(i){try{this.debugMeg("report log :: 서버와의 연결상태를 확인합니다....");var b="t"+new Date().getMilliseconds();var j="ClipID=R16&aliveReport=true&uid="+this.m_uid+"&clipUID="+this.m_uid+"&s_time="+b;if(this.m_postParam!=null){j+=this.m_postParam.getParam();}j=mRe_onBeforeSend(j);var f=this.servletPath;if(this.m_isCrossDomain){var g=this;if(window.XDomainRequest){var d=new XDomainRequest();var a=f+"?"+j;if(-1!=f.indexOf("?")){a=f+"&"+j;}if(d){d.onload=function(){g.reportCheckSendText(mRe_onAfterSend(d.responseText),i);};d.onerror=function(){g.debugMeg("report log :: 서버와의 연결상태를 확인합니다....");g.debugMeg("report log :: 시도한 연결 정보 >>> "+a);g.endDebugMeg(true);mRe_ReportEventHandler(40);};d.open("GET",a);d.send();}}else{$.ajax({type:"POST",url:f,crossDomain:true,data:j,success:function(k){g.reportCheckSendText(mRe_onAfterSend(k),i);},error:function(k){ReportWebLog(k);g.debugMeg("report log :: 서버와의 연결상태를 확인합니다....");g.debugMeg("report log :: 시도한 연결 정보 >>> "+a);g.endDebugMeg(true);mRe_ReportEventHandler(40);}});}}else{var g=this;var c=new HttpClient();c.send(f,j,true,function(){if(4==this.readyState){if(200==this.status){g.reportCheckSendText(mRe_onAfterSend(this.responseText),i);}}});}}catch(h){this.debugMeg("report log :: 스크립트 오류 발생....");this.debugMeg(h.stack);this.endDebugMeg(true);}};Report.prototype.hiddenStaticPageMoveButton=function(){if(this.m_PageMove.eformPCButton&&!this.isEasyInput&&!is_smartphone){if(null!=this.m_PageMove.leftDOM){this.m_PageMove.leftDOM.style.display="none";this.m_PageMove.rightDOM.style.display="none";}}};Report.prototype.createStaticPageMoveButton=function(){if(this.m_PageMove.eformPCButton&&!this.isEasyInput&&(!is_smartphone||this.m_PageMove.isStatic)){if(null==this.m_PageMove.leftDOM){var b=this;var a=this.paintDiv.offsetHeight;var f=((a/2)-25)+this.menuDiv.offsetHeight;var c=document.createElement("button");var d=document.createElement("button");this.m_bodyDiv.appendChild(c);this.m_bodyDiv.appendChild(d);c.className="eform_pageMoveLeft";d.className="eform_pageMoveRight";c.style.border="none";d.style.border="none";if(c.offsetHeight!=null&&c.offsetHeight>0){f=((a/2)-(c.offsetHeight/2))+this.menuDiv.offsetHeight;}c.style.top=f+"px";c.onclick=function(){if(b.m_isButtonLock==false){b.previousPage("menu_button");}};d.style.top=f+"px";d.onclick=function(){if(b.m_isButtonLock==false){b.nextPage("menu_button");}};this.m_PageMove.leftDOM=c;this.m_PageMove.rightDOM=d;}if(null!=this.m_PageMove.leftDOM&&null!=this.m_PageMove.rightDOM){this.m_PageMove.leftDOM.style.display="";this.m_PageMove.rightDOM.style.display="";if(this.m_pageCount==1){this.m_PageMove.leftDOM.style.display="none";this.m_PageMove.rightDOM.style.display="none";}else{if(this.beforePageIndex==0){this.m_PageMove.leftDOM.style.display="none";}else{if(this.beforePageIndex+1>=this.m_pageCount){this.m_PageMove.rightDOM.style.display="none";}}}}}};Report.prototype.createPageMoveButton=function(g){var b=this;if(this.m_PageMove.eventKey==null){var a=this.paintDiv.offsetHeight;var f=((a/2)-25)+this.menuDiv.offsetHeight;var c=document.createElement("div");var d=document.createElement("div");this.m_bodyDiv.appendChild(c);this.m_bodyDiv.appendChild(d);c.className=g+"_pageMoveLeft";d.className=g+"_pageMoveRight";if(c.offsetHeight!=null&&c.offsetHeight>0){f=((a/2)-(c.offsetHeight/2))+this.menuDiv.offsetHeight;}c.style.top=f+"px";c.onclick=function(){b.removePageMoveButton();b.previousPage();};d.style.top=f+"px";d.onclick=function(){b.removePageMoveButton();b.nextPage();};this.m_PageMove.leftDOM=c;this.m_PageMove.rightDOM=d;this.m_PageMove.eventKey=window.setTimeout(function(){b.removePageMoveButton();},2000);}else{window.clearTimeout(this.m_PageMove.eventKey);this.m_PageMove.eventKey=window.setTimeout(function(){b.removePageMoveButton();},2000);}if(this.beforePageIndex==0){if(null!=this.m_PageMove.leftDOM){this.m_PageMove.leftDOM.style.display="none";}}else{if(null!=this.m_PageMove.leftDOM){this.m_PageMove.leftDOM.style.display="";}}if(this.beforePageIndex+1>=this.m_pageCount){if(null!=this.m_PageMove.rightDOM){this.m_PageMove.rightDOM.style.display="none";}}else{if(null!=this.m_PageMove.rightDOM){this.m_PageMove.rightDOM.style.display="";}}};Report.prototype.removePageMoveButton=function(){try{this.m_bodyDiv.removeChild(this.m_PageMove.leftDOM);this.m_bodyDiv.removeChild(this.m_PageMove.rightDOM);}catch(a){mRe_ReportWebLog(a.stack);}if(null!=this.m_PageMove.eventKey){window.clearTimeout(this.m_PageMove.eventKey);this.m_PageMove.eventKey=null;}this.m_PageMove.leftDOM=null;this.m_PageMove.rightDOM=null;};function enterEvent(c,a,b){if(c.keyCode==13){a.selectPage(parseInt(b.value)-1,"memu_input");if(c.preventDefault){c.preventDefault();}c.returnValue=false;}}function CReportPrintPDf(b){var c=document.getElementById("re_object"+b);if(typeof c.print==="undefined"){setTimeout(function(){CReportPrintPDf(b);},1000);}else{var a=m_reportHashMap[b];if(a.isEnabledAdobeRead){a.isEnabledAdobeRead=false;if(!a.m_isMarkAny){c.printWithDialog();}if(!a.m_is_serverSaveFile){a.fileDownloadCheckTimer=window.setTimeout(function(){a.fileCheckSend("print");},1000);}}}}function progressImg(){return"data:image/gif;base64,R0lGODlhFAAUAPf/AOXm5t7e39fY2dDS08rKzMDBxMDAw7y9v6eprP7+/vn5+f39/fr6+vf39/z8/M/Q0fv7+8PExvT19Y2Pk9XV19XW1/Hx8peZnKKkp5aYm4KFiYCDh/j4+O/v8Onp6uzs7d/f4O/w8Ofn6Pb29vT09O/v7/Pz9Ovs7PLy8tzc3ff4+NbX2OLj5K+ws5udobO1t+rq67q7vcXGyKSmqfDw8b/AwqOlqOLi46GjptfX2a2usa6vst7f4Ly+wISHiomLj8nJy3x/g7Gzta2vsoeJjfP09PX19pSWmenq6+3u7pGTl8vNzri6vLi5vPDx8aKjpomMj+Pj5d/g4cfJy9XX2KiqrKanqtvc3ZGUl8zNz3t+gubn6LCytJWXmsnJzOXl5tDQ0oqMj8bGyOTk5dPT1LS2uefo6d3e34+RlKqsr66vsenq6pmcntXV1v39/sjJyqOlqaWnqtfZ2tjY2sHCxdbW2OTl5oiLj4SHi5manpudoJ+go5KVmOzt7YCChvX19ejo6eHh4t3d3vn5+vT09fHx8eDg4ePj5Pn6+ubm5+Li5PHy8u7u7/j4+fDw8L6/we3t7fv7/MnKzOvr7Le4u/f3+MfJyuHh48HCxN7e4O3t7sjJy/r6+4iLjsfIyvj5+fz8/ebn58bHyd7d3+Pk5fPz8/r7+9DR09PU1c7P0OHi4ouNkdPT1d3d35WYm9vb3dvb3IqMkJaYmv39/MbHyt/f4dbX2cPDxejn6cTGyOjp6crLzcTFxpOVmOzs7NTV19rb27y9wNzd3dna2+bm6P7//rO1uP38/fz9/YGDiLW3uZOWmZaXmpmbnu7v74CCh4CDhuPj4+Tk5urr67a3uba3utHS1JqcoPr5+r+/woSGioWHi9DR0rK0t7O0trO0t42Qk9zc3tzd3s7Q0erq6tnZ29LT1eHg4vb29+Lh4/b39+np6cDCw7W2ue7v8Ojp6rm6vZibnp+gpN3f38vMzo6QlIOFiXx+gqqsrra4uuDh4drb3J6go+rr7P///////yH/C05FVFNDQVBFMi4wAwEAAAAh/wtYTVAgRGF0YVhNUDw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6OURCMjcyODkyMjkwMTFFNEI1ODFFNjRBODJEMDY0MzciIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6OURCMjcyODgyMjkwMTFFNEI1ODFFNjRBODJEMDY0MzciIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoV2luZG93cykiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmRpZDpENTI4MTc0MDkwMjJFNDExQUNGQTg4Q0I2MjI3RDI4OSIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpENTI4MTc0MDkwMjJFNDExQUNGQTg4Q0I2MjI3RDI4OSIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PgH//v38+/r5+Pf29fTz8vHw7+7t7Ovq6ejn5uXk4+Lh4N/e3dzb2tnY19bV1NPS0dDPzs3My8rJyMfGxcTDwsHAv769vLu6ubi3trW0s7KxsK+urayrqqmop6alpKOioaCfnp2cm5qZmJeWlZSTkpGQj46NjIuKiYiHhoWEg4KBgH9+fXx7enl4d3Z1dHNycXBvbm1sa2ppaGdmZWRjYmFgX15dXFtaWVhXVlVUU1JRUE9OTUxLSklIR0ZFRENCQUA/Pj08Ozo5ODc2NTQzMjEwLy4tLCsqKSgnJiUkIyIhIB8eHRwbGhkYFxYVFBMSERAPDg0MCwoJCAcGBQQDAgEAACH5BAUAAP8ALAAAAAAUABQAAAjlAP8JHDjQAQSCCAk6KJFAoD9/A+VISChQwShNDiH+CxVkDUWBjF4t+PeQZL0yCSH8cRhI0T8FDP7tguJAIIkGAqPAm1fTASSCLH4mSOGDicAE+h4VIPRRhZ4fdEYOZLAi1McPTSx83JqQwhAhCDJxPZGGy44HQHDEaVaBqx0XcJ5E4EpX4II2Wz6iIKOAoD8pFyaY+ViEz4QVGudoeGHkHwMPBGmMeDllQw+BEkQM3GPlH5Io/95gafgPhpOEPPzEZDPhX4IwMrZy0CBGoBoMAm9oKfGxQQ3SNi44jNCh7r8Hcz8GBAAh+QQFAAD/ACwBAAAADwALAAAIZgD/CRwosNAHggQhjBk4JtBABQ4GNmjHQiCgLwIj+RtEUJUygYpA/EvgL6ICCwMNEPhXSNM/B/4W/KNAZAmEfwpIEeTgT6CbLGgylEA4cIQLgQ1iXCEq8ATTpwOriIQ6ME8dqv8CAgAh+QQFAAD/ACwEAAAADwALAAAIYgD/CRQIoNXAg/8YVBhoqcDAEAwGStiASuADSQI5CCJ0EIy2BP8wxfjnr1YihP+O4PvnQdG/DqMGQnAg0IStgyjQCUTkT8G/ECgFJpjlL4G/oAMZJACJtKnTaQhaOBU4ZmBAACH5BAUAAP8ALAYAAAAOAA4AAAhmAP8JrCBJoMGD/gRiyGAQgIqDVAS2mCHwz7cQB/EI7BJG4KMBBwXq+Hfm1z8WTRwIVABBYI6DJ1AILAQiUciDC9KBEKHypsARiUb4HEpUICJ/SBcQZYDUn9KiUP89qBT1yKpTSgMCACH5BAUAAP8ALAoAAAAKABIAAAhiAL38G0iwIEE5EgwOTBLEQ0EoA5UYM0jh34NOBNUpIHio30BAlFgZhBAhxgqFi6wVUcjS4B8PHkR0MGjh0Jgxk1oqhGBqAUt/QBElKGjinwMG/hgUVEIQUaSCsXLpvOesYEAAIfkEBQAA/wAsCgACAAoAEQAACF8A/wkUuGagwX9lDg68M5BEg4Es+ghM4YPJQQ4uftSAcPBDvhAKQx608MBaqksHT/Da5GmYSIUcHDkIqeCcoQ7+BnJK8A/CCRC4/gX6lyCnwD8cDPoDJbIoA5GDOA4MCAAh+QQFAAD/ACwGAAYADgAOAAAIagD/CRwoUIWef3QWEFz4r4kFhhAjLpyUhsuOBxJJXbPxJILEjwONjIEAskG2HsQGviPYwME/BuGoVfgnD8e/QY3+wTA0kMaff88a/PPn79+CFB8WshNIVKAjQUIHuhxa9F8CciogLlAYMSAAIfkEBQAA/wAsBAAJAA8ACwAACGYA/wkcSPDfiYIIB9pxASehQ4GJHC4io2DgF4elek1Y8W/EP38VB5Jg8E+BpQ09BBZz8I8Ein/7Hg2E4eTfAn8L/t0AIZBSCoIO/IESCOjiP13dTAx0oCCBwDGBBPorR8Kho0kOAwIAIfkEBQAA/wAsAQAJABAACwAACGIA/wnkIbCgQYMzZJk7yLChQ4P+EnxyiKLgAn/+jjkswuffJ38MIPxzQMhgiBECpywYVDDaoX8dPvwThaVhKVgCbx0Q2EnGQQYBZP5L5UlgJi0lDEJYV3ATpoIROjxUBYxhQAAh+QQFAAD/ACwAAAYADgAOAAAIZQD/QRAF7sK/gwgTHvzjTZjChxATRvJHEUJEgRT9YbvIEWICSCYuJmAUyFCDiyVAfFEgMERCGgcZEEIoY9c/D4f+vXmI5AWyf/Em/EsQJqGCaoIO6sBw8IbRHP4O2jDY8UEEhAEBACH5BAUAAP8ALAAAAgALABEAAAhpAP8J/Eco2cCDA8dtQ7iA08BlCAf5a7TgXweECRr524hw4AJTDTqKHEgDECARhTp+GPPly8WRMAUuuJFEpIgCwRZ1/EKJW6V/Cjwc5OBuID8r/5BEQcgDGoN/bBBy0CBGoBqEDWokOBgQACH5BAUAAP8ALAAAAQALABAAAAhhAP8J/LdAwcCDAhn4S4DwIAR//v4xE+hAhcAEEP+J+/WPkSFfDv75a4Dwg6pLHBoKhOChhMqX/6SlOkXPQ0NBtCTJ+AKzp0BUW1QKcjXBTEMB9l4Y+ccAoQQRA/f09HMwIAA7";}function receiveMessage(b){var a=m_reportHashMap[b.data];if(null!=a){a.removePrintProgress();}}function mRe_closeReportInfo(c){var b=m_reportHashMap[c];b.m_bodyDiv.removeChild(b.m_popupViewDiv);b.m_reportInfo_view=null;b.m_popupViewDiv=null;b.disabledMenu(false);var d="";if(b.is_eForm){d="re_eformInfo";}else{d="re_reportInfo";}var a=document.getElementById(d+c);if(null!=a){a.focus();}}function mRe_ReportEventHandler(a){if(typeof window.ReportEventHandler!="undefined"){ReportEventHandler(a);}else{if(typeof window.console!="undefined"){window.console.log("Report Code : "+a);}}}function mRe_getLocalStorage(a){if(is_svg){if(typeof(Storage)!=="undefined"){var b=null;try{if(null!=localStorage){b=localStorage.getItem(a);}}catch(c){ReportWebLog("Web Storage unavailable!!");}if(b==null){return"0";}return b;}else{return"0";}}return"0";}function mRe_setLocalStorage(a,b){if(is_svg){if(typeof(Storage)!=="undefined"){try{if(null!=localStorage){localStorage.setItem(a,b);}}catch(c){ReportWebLog("Web Storage unavailable!!");}}}}function mRe_HWPFrame_Object(){var a="<object id='re_hwp_object' classid='CLSID:BD9C32DE-3155-4691-8972-097D53B10052' style='position:absolute;left:0px;top:0px;width:0px;height:0px;display:none;'><PARAM NAME='_Version' VALUE='65536'><PARAM NAME='_ExtentX' VALUE='21167'><PARAM NAME='_ExtentY' VALUE='15875'><PARAM NAME='_StockProps' VALUE='0'><PARAM NAME='FILENAME' VALUE=''></object>";return a;}function clearListCookies(a){}function paintReportText(m,b){var d=b;try{if("{clip_enc}"==m){return;}if(0==m.indexOf('"')){m=m.substring(1,m.length-1);}var f=m.split("{clipreport_separator}");var k=objectCall(ClipStrTrim(f[0]));if(typeof f=="string"){f=objectCall(f);}d=m_reportHashMap[k.uid];d.debugMeg("report log :: 리포트 페이지 서버 수신 완료...");if(k.status){d.debugMeg("report log :: 리포트 페이지 서버 수신 완료 메시지 >>> "+f[0]);if(null!=k.event){if(18==k.event){d.debugMeg("report log :: 리포트 서버의 사용자가 많아서 화면 호출을 다시 시도 합니다.");window.setTimeout(function(){d.sendData(d.beforePageIndex);},300);return;}if(29==k.event){d.debugMeg("report log :: 리포트 페이지를 서버에서 로드하지 못했습니다. temp폴더에 리포트가 생성되었는지 확인이 필요합니다.");return;}}if(null!=k.pageWidth){d.m_printPage.pageWidth=k.pageWidth;d.m_printPage.pageHeight=k.pageHeight;}if(null!=k.reportName){var c=ClipStrTrim(k.reportName);if(""!=c){d.m_strFileName=c;}}if(!d.m_isAccessibility){d.debugMeg("report log :: 리포트 화면를 SVG로 표현!");d.removeEditableProgress();d.paintDiv.innerHTML=unescape(f[1]);d.paintDiv.firstChild.firstChild.style.overflow="hidden";if(null!=k.pageWidth){d.pageWidth=Number(k.pageWidth)*0.378;d.pageHeight=Number(k.pageHeight)*0.378;}else{d.pageWidth=d.paintDiv.firstChild.firstChild.getAttribute("width");d.pageHeight=d.paintDiv.firstChild.firstChild.getAttribute("height");}d.zoomIn(d.zoomCombo);d.setPaintDivEvent(d.paintDiv,k.uid);d.pageSlideShow();}else{d.debugMeg("report log :: 리포트 화면를 접근성 뷰어로 표현!");var o=f[1];var j=document.getElementsByTagName("head")[0];var a=j.lastChild;if(a.tagName!="STYLE"||a.getAttribute("id")!="report_css"){var l=document.createElement("style");l.setAttribute("type","text/css");l.setAttribute("id","report_css");j.appendChild(l);a=l;}if(a.styleSheet){a.styleSheet.cssText=o;}else{a.innerHTML="";var i=document.createTextNode(o);a.appendChild(i);}d.removeEditableProgress();d.paintDiv.innerHTML=unescape(f[2]);d.pageWidth=d.paintDiv.firstChild.clientWidth;d.pageHeight=d.paintDiv.firstChild.clientHeight;d.zoomIn(d.zoomCombo);d.setPaintDivEvent(d.paintDiv,k.uid);d.pageSlideShow();mRe_accessibilityCellSort();}if(d.m_isEndReport&&d.m_isEndReportEvent){if(d.m_endreportprogress.is_visible){d.m_endreportprogress.is_visible=false;d.removeEndReportProgress();}mRe_ReportEventHandler(200);try{d.m_exeViewEndFunc();}catch(h){ReportWebLog(h.stack);}if(d.m_isReportEndFunction!=null){d.m_isReportEndFunction();}d.m_isEndReportEvent=false;d.debugMeg("report log :: 리포트 뷰어 종료!");d.endDebugMeg(false);}else{if(!d.m_isEndReport){if(d.m_endreportprogress.is_visible){d.createEndReportProgress();}}}if(null==d.m_drilingTop){if((is_smartphone&&d.m_mobile.scrollTop)||(!is_smartphone&&d.m_pcView.scrollTop)){d.paintDiv.scrollTop=1;}else{if(d.m_scrollEv.isScrollPaging&&d.isWheelPrev){d.isWheelPrev=false;var g=d.paintDiv.scrollHeight-d.paintDiv.clientHeight-50;d.paintDiv.scrollTop=g;}else{d.paintDiv.scrollTop=1;}}}else{d.paintDiv.scrollTop=d.m_drilingTop;d.m_drilingTop=null;}d.endDebugMeg(true);}else{d.debugMeg("report log :: 리포트 생성중 오류 발생(export) >>> 서버로그 확인 필요!");d.debugMeg("report log :: 리포트 페이지 서버 수신 메시지 >>> "+f[0]);var n=d.m_languageMap.report_error;if(k.event==11){d.debugMeg("report log :: EFORM 사용 권한이 없습니다 (라이센스)");if(d.m_isViewer){n=d.m_languageMap.lic_error+".!! (errorCode : LE0"+k.event+")";mRe_ReportEventHandler(11);}}else{mRe_ReportEventHandler(30);if(k.event==60){n=d.m_languageMap.sesstion_error;mRe_ReportEventHandler(60);d.debugMeg("report log :: 리포트서버와의 세션 종료!");}}n=n.replace(/\<|\>|\"|\'|\%|\;|\(|\)|\&|\+|\-/g,"");d.paintDiv.innerHTML=n;d.pageSlideShow();}}catch(h){d.debugMeg("report log :: 서버에서 내려온 결과 메시지 >>> "+m);d.debugMeg("report log :: 서버에서 내려온 메시지 오류 >>> "+h.stack);d.paintDiv.innerHTML=d.m_languageMap.report_error;mRe_ReportEventHandler(30);d.pageSlideShow();}if(d.m_pageMoveEvent.end!=null){d.m_pageMoveEvent.end();}}function resultPageCountText(a,c){var b=c;try{var h=objectCall(ClipStrTrim(a));if(typeof h=="string"){h=objectCall(h);}b=m_reportHashMap[h.uid];b.debugMeg("report log :: 서버 수신 완료...");if(h.status){if(b.m_objReportCheck.isCheck&&!h.endReport&&h.count==0){if(b.m_objReportCheck.checkCount>=b.m_objReportCheck.maxCount){if(b.m_objReportCheck.callbackFunc!=null){var f=b.m_objReportCheck.callbackFunc();b.m_objReportCheck.checkCount=0;if(!f){b.paintDiv.innerHTML="";return;}}}else{b.m_objReportCheck.checkCount++;}}else{b.m_objReportCheck.checkCount=0;}if(h.count>0){b.m_waitTime=1;}if(b.m_isViewer){var d=b.m_pageCount;if(b.m_pageCount<=h.count){d=h.count;}if(b.is_eForm&&b.isEasyInput){b.totalCountText.value=b.m_TPC.before+"1"+b.m_TPC.after;}else{b.totalCountText.value=b.m_TPC.before+d+b.m_TPC.after;}}if(h.endReport){b.debugMeg("report log :: 서버에서 리포트 생성은 완료..! ");b.debugMeg("report log :: 서버에서 내려온 결과 메시지 >>> "+a);if(h.count>0){b.m_isEndReport=true;if(!b.m_isViewer){b.m_pageCount=h.count;b.m_disControl.print=false;b.printEXEView();return;}else{if(b.m_directPrint){b.m_pageCount=h.count;b.m_directPrintOp.endReport=true;return;}}if(b.m_isViewer){if(b.is_eForm){if(b.beforePageIndex<h.count){b.input.value=b.beforePageIndex+1;}else{b.beforePageIndex=0;}}b.sendData(b.beforePageIndex,b.m_isJsonAllPage);b.progressImg.style.display="none";}}else{b.debugMeg("report log :: 보고서 양식이 잘못되었습니다.(페이지가 없습니다.)");if(b.m_isViewer){b.progressImg.style.display="none";b.paintDiv.innerHTML=b.m_languageMap.report_error2;}mRe_ReportEventHandler(32);b.endDebugMeg(false);}b.m_pageCount=h.count;if(b.is_eForm&&b.isEasyInput){b.m_pageCount=1;}}else{if(null!=h.is_s){if(h.is_s){b.debugMeg("report log :: 리포트 생성중 (양호)");}else{b.debugMeg("report log :: 리포트 생성중 (경고) 서버에서 생성중인 리포트를 세션에서 찾지 못했습니다. 파일 탐색으로 변경되었습니다.");b.debugMeg("report log :: 계속해서 똑같은 결과가 내려온다면 이중화된 서버 가능성이 있습니다.");b.debugMeg("report log :: 리포트를 생성한 서버와 확인작업을 위해 통신으로 접속한 서버가 다를 수 있습니다.");b.debugMeg("report log :: 서버관리자에게 문의 하여 하나의 세션이 생성됐을 때 그 서버만 바라보도록 하거나 리포트 설정 폴더를 물리적으로 같은 폴더로 사용하도록 변경이 필요합니다.");}}else{b.debugMeg("report log :: 리포트 생성중 (양호)");}b.debugMeg("report log :: 서버에서 내려온 결과 메시지 >>> "+a);if(b.m_isViewer){if(b.m_pageCount==0&&h.count!=0&&!b.is_eForm){b.sendData(0);}}if(b.m_pageCount<=h.count){b.m_pageCount=h.count;}b.checkPageCount();}}else{var g=b.m_languageMap.report_error;mRe_ReportEventHandler(30);b.debugMeg("report log :: 리포트 생성중 오류 발생(engine) >>> 서버로그 확인 필요!");if(h.event==60){g=b.m_languageMap.sesstion_error;mRe_ReportEventHandler(60);b.debugMeg("report log :: 리포트서버와의 세션 종료!");}b.endDebugMeg(false);if(b.m_isViewer){b.progressImg.style.display="none";b.paintDiv.innerHTML=g;}}}catch(i){b.debugMeg("report log :: 서버에서 내려온 결과 메시지 >>> "+a);b.debugMeg("report log :: 서버에서 내려온 메시지 오류 >>> "+i.stack);if(b.m_isViewer){b.progressImg.style.display="none";b.paintDiv.innerHTML=b.m_languageMap.report_error;}mRe_ReportEventHandler(30);b.endDebugMeg(false);}}function m_getSaveFormTag(a){var b=a.clipid.name+"="+a.clipid.value+"&";b+=a.uid.name+"="+a.uid.value+"&";b+=a.clipUID.name+"="+a.clipUID.value+"&";b+=a.path.name+"="+escape(a.path.value)+"&";b+=a.option.name+"="+encodeURIComponent(a.option.value)+"&";b+="is_ie="+((!is_firefox)&&(!is_safari)&&(!is_apple))+"&";b+="exportN="+a.filename.value+"&";b+="isSmartPhone="+a.isMobile.value+"&";b+="exportType="+a.filetype.value+"&";return b;}function ClipStrTrim(a){return a.replace(/^\s+|\s+$/gm,"");}function mRe_onBeforeSend(a){if(typeof window.onBeforeSend!="undefined"){return onBeforeSend(a);}return a;}function mRe_onAfterSend(a){if(typeof window.onAfterSend!="undefined"){return onAfterSend(a);}return a;}function objectCall(d){if(d.charAt(0)=="("||d.charAt(d.length-1)==")"){var b=new Array();for(var a=0;a<d.length;a++){if(a==0&&d.charAt(a)=="("){continue;}else{if((a==d.length-1)&&d.charAt(a)==")"){continue;}}b.push(d.charAt(a));}d=b.join("");d=d.replace(/\'/g,'"');}var c=base64DecodeJson(mCR_Base64.encode(d));return c;}function base64DecodeJson(a){return jQuery.parseJSON(mCR_Base64.decode(a));}function reportJsonDelete(c){if(null!=c){var a=m_reportHashMap[c];if(null!=a){for(var b in a){a[b]=null;delete a[b];}a=null;m_reportHashMap[c]=null;}}else{ReportWebLog("reportJsonDelete in strReportKey null!!");}}function mRe_ReportWebLog(a){if(typeof window.console!="undefined"){window.console.log(a);}}function mRe_accessibilityCellSort(){var f=function(){};var j=new Array();if(is_ie7||is_ie8||is_ie9){if(null!=document.body.all){var h=document.body.all.tags("span");for(var d=0;d<h.length;d++){if(h[d].name=="m_r_e_cell_type"){j.push(h[d]);}}}else{j=null;}}else{j=document.getElementsByName("m_r_e_cell_type");}if(null!=j){for(var d=0;d<j.length;d++){var k=j[d];var a=k.getAttribute("cellpo");var c=f[a];if(null==c){f[a]=k;}else{var b=k.getAttribute("aria-hidden");if(null==b||"false"==b||""==b){var g=c.getAttribute("aria-label");g=(null==g)?"":g;var l=k.getAttribute("aria-label");c.removeAttribute("aria-hidden");c.setAttribute("aria-label",(g+l));c.setAttribute("role","text");c.tabIndex=0;k.setAttribute("aria-label","");k.setAttribute("aria-hidden","true");k.tabIndex=-1;}}}}j=null;f=null;}function mRe_makeFormTag(d,b,c){var a=document.createElement("form");if(null!=d){a.id=d;}a.style.cssText="display:none";a.enctype="application/x-www-form-urlencoded";a.method="post";if(typeof b!="undefined"){a.action=b;}if(typeof c!="undefined"){a.target=c;}return a;}function mRe_makeInputTag(d,a,c){var b=document.createElement("input");if(null!=d){b.id=d;}b.name=a;b.title=a;b.style.cssText="visibility:hidden";if(typeof c!="undefined"){b.value=c;}return b;}function mRe_makeMenuInputTag(h,a,f,d,g,c){var b=mRe_makeInputTag(h,a,f);b.type="text";b.className=d;b.title=g;b.style.cssText=c;return b;}function mRe_makeDivTag(d,c,b){var a=document.createElement("div");if(null!=d){a.id=d;}a.className=c;a.style.cssText=b;return a;}function mRe_makeTableTag(i,h,c,g,a){var f=document.createElement("table");if(h!=null){f.id=h;}if(c!=null){f.style.cssText=c;}f.className=g;i.appendChild(f);var b=document.createElement("tr");f.appendChild(b);var d=document.createElement("td");d.className=a;b.appendChild(d);return d;}function mRe_makeTableNobrTag(j,a,b,c,f,d){var i=mRe_makeTableTag(j,a,b,c,f);var h=document.createElement("div");h.className=d;i.appendChild(h);var g=document.createElement("nobr");h.appendChild(g);return g;}function mRe_makeButtonTag(h,g,d,c,b,f){var a=document.createElement("button");if(null!=h){a.id=h;}if(null!=g){a.title=g;}a.className=d;a.style.cssText=c;a.disabled=b;a.onclick=f;return a;}function mRe_makeOptionTag(f,a,c,d){var b=document.createElement("option");b.name=a;b.value=c;b.className="report_menu_zoom_combo_option";b.innerText=d;f.appendChild(b);return b;}Report.prototype.mRe_makePrintNewForm=function(){var a=mRe_makeFormTag(null);this.targetDiv.appendChild(a);a.appendChild(this.formTag_clipid);a.appendChild(this.formTag_uid);a.appendChild(this.formTag_clipUID);a.appendChild(this.formTag_print);a.appendChild(this.formTag_printImage);a.appendChild(this.formTag_path);a.appendChild(this.formTag_option);a.appendChild(this.formTag_ChromeFitToPage);a.appendChild(this.formTag_s_time);this.formTag=a;};function whiteListCheck(a){return a;}var mRe_blankImg="iVBORw0KGgoAAAANSUhEUgAAAKoAAACqCAYAAAA9dtSCAAADLElEQVR4Xu3SAQ0AAAjDMO7fNDqWFAXP6M4pECiwwEYTFThQIUgUADXxJiNBZSBRANTEm4wElYFEAVATbzISVAYSBUBNvMlIUBlIFAA18SYjQWUgUQDUxJuMBJWBRAFQE28yElQGEgVATbzJSFAZSBQANfEmI0FlIFEA1MSbjASVgUQBUBNvMhJUBhIFQE28yUhQGUgUADXxJiNBZSBRANTEm4wElYFEAVATbzISVAYSBUBNvMlIUBlIFAA18SYjQWUgUQDUxJuMBJWBRAFQE28yElQGEgVATbzJSFAZSBQANfEmI0FlIFEA1MSbjASVgUQBUBNvMhJUBhIFQE28yUhQGUgUADXxJiNBZSBRANTEm4wElYFEAVATbzISVAYSBUBNvMlIUBlIFAA18SYjQWUgUQDUxJuMBJWBRAFQE28yElQGEgVATbzJSFAZSBQANfEmI0FlIFEA1MSbjASVgUQBUBNvMhJUBhIFQE28yUhQGUgUADXxJiNBZSBRANTEm4wElYFEAVATbzISVAYSBUBNvMlIUBlIFAA18SYjQWUgUQDUxJuMBJWBRAFQE28yElQGEgVATbzJSFAZSBQANfEmI0FlIFEA1MSbjASVgUQBUBNvMhJUBhIFQE28yUhQGUgUADXxJiNBZSBRANTEm4wElYFEAVATbzISVAYSBUBNvMlIUBlIFAA18SYjQWUgUQDUxJuMBJWBRAFQE28yElQGEgVATbzJSFAZSBQANfEmI0FlIFEA1MSbjASVgUQBUBNvMhJUBhIFQE28yUhQGUgUADXxJiNBZSBRANTEm4wElYFEAVATbzISVAYSBUBNvMlIUBlIFAA18SYjQWUgUQDUxJuMBJWBRAFQE28yElQGEgVATbzJSFAZSBQANfEmI0FlIFEA1MSbjASVgUQBUBNvMhJUBhIFQE28yUhQGUgUADXxJiNBZSBRANTEm4wElYFEAVATbzISVAYSBUBNvMlIUBlIFAA18SYjQWUgUQDUxJuMBJWBRAFQE28yElQGEgVATbzJSFAZSBQANfEmI0FlIFEA1MSbjASVgUQBUBNvMhJUBhIFQE28ycgH1oEAq7aSdTsAAAAASUVORK5CYII=";var mRe_whiteImg="/9j/4AAQSkZJRgABAQEAYABgAAD/2wBDAAIBAQIBAQICAgICAgICAwUDAwMDAwYEBAMFBwYHBwcGBwcICQsJCAgKCAcHCg0KCgsMDAwMBwkODw0MDgsMDAz/2wBDAQICAgMDAwYDAwYMCAcIDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAz/wAARCAABAAEDASIAAhEBAxEB/8QAHwAAAQUBAQEBAQEAAAAAAAAAAAECAwQFBgcICQoL/8QAtRAAAgEDAwIEAwUFBAQAAAF9AQIDAAQRBRIhMUEGE1FhByJxFDKBkaEII0KxwRVS0fAkM2JyggkKFhcYGRolJicoKSo0NTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uHi4+Tl5ufo6erx8vP09fb3+Pn6/8QAHwEAAwEBAQEBAQEBAQAAAAAAAAECAwQFBgcICQoL/8QAtREAAgECBAQDBAcFBAQAAQJ3AAECAxEEBSExBhJBUQdhcRMiMoEIFEKRobHBCSMzUvAVYnLRChYkNOEl8RcYGRomJygpKjU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6goOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4uPk5ebn6Onq8vP09fb3+Pn6/9oADAMBAAIRAxEAPwD9/KKKKAP/2Q==";Report.prototype.setBeforePageMoveEvent=function(a){this.m_beforePageMoveEvent=a;};Report.prototype.setUseOfficePassword=function(a){this.useOfficePassword=a;};Report.prototype.setSearchWord=function(a){this.isSearchWord=a;this.m_isJsonAllPage=true;};Report.prototype.setHTMLPrintMarginAlertVisible=function(a){this.m_marginAlert=a;};Report.prototype.saveNativeMainDoodlePalletOption=function(a){if(is_appControl){}else{if(is_exeMirroring){if((window)&&(window.external)&&("MainWebBrowserCtrl_SaveEFormDoodlePalletOption" in window.external)){window.external.MainWebBrowserCtrl_SaveEFormDoodlePalletOption(JSON.stringify(a));}}}};Report.prototype.saveNativeSubDoodlePalletOption=function(a){if(is_appControl){}else{if(is_exeMirroring){if((window)&&(window.external)&&("SubWebBrowserCtrl_SaveEFormDoodlePalletOption" in window.external)){window.external.SubWebBrowserCtrl_SaveEFormDoodlePalletOption(JSON.stringify(a));}}}};Report.prototype.setCustomViewPort=function(a){this.m_isCustomViewPort=a;};Report.prototype.setOldHTMLPrintType=function(a){this.m_isOldHTMLPrint=a;};Report.prototype.setPDFPopupPrintInfoDisplay=function(a){this.m_PDFPopupPrintInfoDisplay=a;};Report.prototype.setClientPaintView=function(a){this.m_isObjJSONSVG=a;};Report.prototype.setClientPaintViewType=function(a){if(null!=a){a=a.toLowerCase();}this.m_isObjJSONViewType=a;};Report.prototype.setClientPaintViewAccessibility=function(a){this.m_isObjJSONViewAccessibility=a;if(a){this.m_isObjJSONViewType="svg";}};Report.prototype.setClientPaintViewAccessibilityLevel=function(a){this.m_nObjJSONViewAccLevel=a;};Report.prototype.setClientJsonAllPageData=function(a){this.m_isJsonAllPage=a;};Report.prototype.setIsPopUpSaveDownload=function(a){if(is_ie){this.m_isPopupSaveDownload=a;}};Report.prototype.setChangeTxtExtension=function(a){this.m_txtExtension=a;};Report.prototype.setSyncPageServerPath=function(a){this.m_syncPageServletPath=a;};Report.prototype.setIsRedBC=function(a){this.m_isRedBC=a;};Report.prototype.setSelectSavePageType=function(a,c,b){switch(a){case 1:this.m_selectPageType.save=1;break;case 2:this.m_selectPageType.save=2;break;case 3:this.m_selectPageType.save=3;if(c&&b){this.m_selectPageType.saveCustom=true;this.m_selectPageType.saveStart=Number(c);this.m_selectPageType.saveEnd=Number(b);}break;default:break;}};Report.prototype.setSelectPrintPageType=function(a,c,b){switch(a){case 1:this.m_selectPageType.print=1;break;case 2:this.m_selectPageType.print=2;break;case 3:this.m_selectPageType.print=3;if(c&&b){this.m_selectPageType.printCustom=true;this.m_selectPageType.printStart=Number(c);this.m_selectPageType.printEnd=Number(b);}break;default:break;}};Report.prototype.setPDFPrintAlertCloseButtonEvent=function(a){this.m_buttonEvent.PDFPrintAlertCloseButton=a;};Report.prototype.setPDFPrintAlertOkButtonEvent=function(a){this.m_buttonEvent.PDFPrintAlertOkButton=a;};Report.prototype.setSavingFileOption=function(a){this.m_is_serverSaveFile=a;};Report.prototype.setSplitPage=function(a){this.m_splitPage=a;};Report.prototype.setIgnorePDFObject=function(a){this.m_ignorePDFObject=a;};Report.prototype.setHtmlPrintInfo=function(a){this.m_html_info=a;};Report.prototype.setCrossChromePDFPrint=function(a){this.m_isCrossDomainPDF=a;};Report.prototype.setPrintOkButtonEvent=function(a){this.m_buttonEvent.printOkButton=a;};Report.prototype.setPrintCancelButtonEvent=function(a){this.m_buttonEvent.printCancelButton=a;};Report.prototype.setEFormSignPositionFix=function(a){is_PosiFix=a;};Report.prototype.visiblePageMoveButton=function(a){this.removePageMoveButton();if(a){if(this.is_eForm){this.createPageMoveButton("eform");}else{this.createPageMoveButton("report");}}};Report.prototype.setPageCountLabelEvent=function(a){this.m_buttonEvent.startPageCountLabel=a;};Report.prototype.setReportMobilePageMoveButtonDisabled=function(a){this.m_PageMove.ButtonDisabled=a;};Report.prototype.setEndDrawPageEvent=function(a){this.m_pageMoveEvent.end=a;};Report.prototype.setStartDrawPageEvent=function(a){this.m_pageMoveEvent.start=a;};Report.prototype.setStartZoomInSelectEvent=function(a){this.m_buttonEvent.startZoomInSelect=a;};Report.prototype.setStartLastPageButtonEvent=function(a){this.m_buttonEvent.startLastButton=a;};Report.prototype.setStartNextPageButtonEvent=function(a){this.m_buttonEvent.startNextButton=a;};Report.prototype.setStartPreviousPageButtonEvent=function(a){this.m_buttonEvent.startPrevButton=a;};Report.prototype.setStartFirstPageButtonEvent=function(a){this.m_buttonEvent.startFirstButton=a;};Report.prototype.setSwipeDisiabled=function(a){this.m_isSwipe=a;};Report.prototype.setEndPrintProgressEvent=function(a){this.m_endPrintProgressEvent=a;};Report.prototype.getPageCountList=function(){return this.filePageCountList;};Report.prototype.getReportNameList=function(){return this.m_saveReportInfoList;};Report.prototype.getTotalPageCount=function(){return this.m_pageCount;};Report.prototype.getSelectPageNumber=function(){return this.beforePageIndex+1;};Report.prototype.setEFormDoodlePenColor=function(c,a,b){this.eFormDoodleOption.pens.width=c;this.eFormDoodleOption.pens.color=a;this.eFormDoodleOption.pens.op=b;this.eFormDoodleOption.tempPens.width=c;this.eFormDoodleOption.tempPens.color=a;this.eFormDoodleOption.tempPens.op=b;};Report.prototype.getEFormDoodlePenColor=function(){var a={penWidth:16,penColor:"rgb(155,0,0)",penOpacity:0.5};a.penWidth=this.eFormDoodleOption.pens.width;a.penColor=this.eFormDoodleOption.pens.color;a.penOpacity=this.eFormDoodleOption.pens.op;return a;};Report.prototype.setDoodleCancelButtonEvent=function(a){this.eFormDoodleOption.cancelButtonEvent=a;};Report.prototype.setDoodleOkButtonEvent=function(a){this.eFormDoodleOption.okButtonEvent=a;};Report.prototype.transFormREPORT=function(){alert("지원하지 않습니다.");};Report.prototype.transFormEFORM=function(){alert("지원하지 않습니다.");};Report.prototype.exePrintVersionInfo=function(a){exe_print_version=a;};Report.prototype.setExePrintFinishEvent=function(a){this.m_exePrintEvent.ok=a;};Report.prototype.setExePrintCancelEvent=function(a){this.m_exePrintEvent.cancel=a;};Report.prototype.setEXEPrintDownloadLink=function(a){this.m_exeLink=a;};Report.prototype.exePrint=function(d,f,c,g,a,h,b){this.m_exePrintStatus.isSet=true;this.m_exePrintOption.isPrintPopup=d;this.m_exePrintOption.printName=f;this.m_exePrintOption.tray=c;this.m_exePrintOption.startNumber=g;this.m_exePrintOption.endNumber=a;this.m_exePrintOption.copies=h;this.m_exePrintOption.option=b;this.printEXEView();};Report.prototype.exeDirectPrint=function(){var d,f,c,g,a,h,b;if(arguments.length==7){d=arguments[0];f=arguments[1];c=arguments[2];g=arguments[3];a=arguments[4];h=arguments[5];b=arguments[6];}else{d=false;f=arguments[0];c=arguments[1];g=arguments[2];a=arguments[3];h=arguments[4];b=arguments[5];}this.m_exePrintStatus.isSet=true;this.m_exePrintOption.isPrintPopup=d;this.m_exePrintOption.printName=f;this.m_exePrintOption.tray=c;this.m_exePrintOption.startNumber=g;this.m_exePrintOption.endNumber=a;this.m_exePrintOption.copies=h;this.m_exePrintOption.option=b;this.printEXEDirect();};Report.prototype.setPrintSelectNames=function(b,a){b=b.toLowerCase();if("pdf"==b){this.printNames.pdf=a;}else{if("html"==b){this.printNames.html=a;}else{if("hwp"==b){this.printNames.hwp=a;}else{if("exe"==b){this.printNames.exe=a;}}}}};Report.prototype.setAdobeInfoMessage=function(a){if(null!=a&&""!=a){this.adobeMessage.is_message=true;this.adobeMessage.message=a;}};Report.prototype.setAdobeInfoBottomMessage=function(a){if(null!=a&&""!=a){this.adobeMessage.bottomMessage=a;}};Report.prototype.setAdobeInfoCustomButton=function(b,c,a){if(b==0){this.adobeInfoButton.isSave=true;this.adobeInfoButton.saveMsg=c;this.adobeInfoButton.saveStyle=a;}else{if(b==1){this.adobeInfoButton.isCancel=true;this.adobeInfoButton.cancelMsg=c;this.adobeInfoButton.cancelStyle=a;}else{this.adobeInfoButton.isOk=true;this.adobeInfoButton.okMsg=c;this.adobeInfoButton.okStyle=a;}}};Report.prototype.setEdgeAdobeInfoMessage=function(a){if(null!=a&&""!=a){this.adobeMessage.edgeMessage=a;}};Report.prototype.setFirefoxAdobeInfoMessage=function(a){if(null!=a&&""!=a){this.adobeMessage.firefoxMessage=a;}};Report.prototype.setPermissionAdobe9=function(a){this.adobe9Permission=a;};Report.prototype.buttonDisabled=function(a,c){switch(a){case"prev_button":if(this.m_disControl.prev!=c&&null!=this.prev_button){this.m_disControl.prev=c;this.prev_button.disabled=c;if(c){var b=this.prev_button.className;var d=/\_svg/g;b=b.replace(d,"_svg_dis");d=/\_png/g;b=b.replace(d,"_png_dis");this.prev_button.className=b;}else{var b=this.prev_button.className;var d=/\_dis/g;b=b.replace(d,"");this.prev_button.className=b;}}break;case"next_button":if(this.m_disControl.next!=c&&null!=this.next_button){this.m_disControl.next=c;this.next_button.disabled=c;if(c){var b=this.next_button.className;var d=/\_svg/g;b=b.replace(d,"_svg_dis");d=/\_png/g;b=b.replace(d,"_png_dis");this.next_button.className=b;}else{var b=this.next_button.className;var d=/\_dis/g;b=b.replace(d,"");this.next_button.className=b;}}break;case"firstPage_button":if(this.m_disControl.first!=c&&null!=this.first_button){this.m_disControl.first=c;this.first_button.disabled=c;if(c){var b=this.first_button.className;var d=/\_svg/g;b=b.replace(d,"_svg_dis");d=/\_png/g;b=b.replace(d,"_png_dis");this.first_button.className=b;}else{var b=this.first_button.className;var d=/\_dis/g;b=b.replace(d,"");this.first_button.className=b;}}break;case"lastPage_button":if(this.m_disControl.last!=c&&null!=this.last_button){this.m_disControl.last=c;this.last_button.disabled=c;if(c){var b=this.last_button.className;var d=/\_svg/g;b=b.replace(d,"_svg_dis");d=/\_png/g;b=b.replace(d,"_png_dis");this.last_button.className=b;}else{var b=this.last_button.className;var d=/\_dis/g;b=b.replace(d,"");this.last_button.className=b;}}break;case"save_button":if(this.m_disControl.save!=c&&null!=this.save_button){this.m_disControl.save=c;this.save_button.disabled=c;if(c){var b=this.save_button.className;var d=/\_svg/g;b=b.replace(d,"_svg_dis");d=/\_png/g;b=b.replace(d,"_png_dis");this.save_button.className=b;}else{var b=this.save_button.className;var d=/\_dis/g;b=b.replace(d,"");this.save_button.className=b;}}break;case"print_button":if(this.m_disControl.print!=c&&null!=this.print_button){this.m_disControl.print=c;this.print_button.disabled=c;if(c){var b=this.print_button.className;var d=/\_svg/g;b=b.replace(d,"_svg_dis");d=/\_png/g;b=b.replace(d,"_png_dis");this.print_button.className=b;}else{var b=this.print_button.className;var d=/\_dis/g;b=b.replace(d,"");this.print_button.className=b;}}break;case"close_button":if(this.m_disControl.close!=c&&null!=this.close_button){this.m_disControl.close=c;this.close_button.disabled=c;if(c){var b=this.close_button.className;var d=/\_svg/g;b=b.replace(d,"_svg_dis");d=/\_png/g;b=b.replace(d,"_png_dis");this.close_button.className=b;}else{var b=this.close_button.className;var d=/\_dis/g;b=b.replace(d,"");this.close_button.className=b;}}break;case"pdf_button":if(this.m_disControl.pdf!=c&&null!=this.pdf_button){this.m_disControl.pdf=c;this.pdf_button.disabled=c;if(c){var b=this.pdf_button.className;var d=/\_svg/g;b=b.replace(d,"_svg_dis");d=/\_png/g;b=b.replace(d,"_png_dis");this.pdf_button.className=b;}else{var b=this.pdf_button.className;var d=/\_dis/g;b=b.replace(d,"");this.pdf_button.className=b;}}break;case"hwp_button":if(this.m_disControl.hwp!=c&&null!=this.hwp_button){this.m_disControl.hwp=c;this.hwp_button.disabled=c;if(c){var b=this.hwp_button.className;var d=/\_svg/g;b=b.replace(d,"_svg_dis");d=/\_png/g;b=b.replace(d,"_png_dis");this.hwp_button.className=b;}else{var b=this.hwp_button.className;var d=/\_dis/g;b=b.replace(d,"");this.hwp_button.className=b;}}break;case"doc_button":if(this.m_disControl.doc!=c&&null!=this.doc_button){this.m_disControl.doc=c;this.doc_button.disabled=c;if(c){var b=this.doc_button.className;var d=/\_svg/g;b=b.replace(d,"_svg_dis");d=/\_png/g;b=b.replace(d,"_png_dis");this.doc_button.className=b;}else{var b=this.doc_button.className;var d=/\_dis/g;b=b.replace(d,"");this.doc_button.className=b;}}break;case"excel_button":if(this.m_disControl.excel!=c&&null!=this.excel_button){this.m_disControl.excel=c;this.excel_button.disabled=c;if(c){var b=this.excel_button.className;var d=/\_svg/g;b=b.replace(d,"_svg_dis");d=/\_png/g;b=b.replace(d,"_png_dis");this.excel_button.className=b;}else{var b=this.excel_button.className;var d=/\_dis/g;b=b.replace(d,"");this.excel_button.className=b;}}break;case"reportInfo_button":if(this.m_disControl.reportInfo!=c&&null!=this.reportInfo_button){this.m_disControl.reportInfo=c;this.reportInfo_button.disabled=c;if(c){var b=this.reportInfo_button.className;var d=/\_svg/g;b=b.replace(d,"_svg_dis");d=/\_png/g;b=b.replace(d,"_png_dis");this.reportInfo_button.className=b;}else{var b=this.reportInfo_button.className;var d=/\_dis/g;b=b.replace(d,"");this.reportInfo_button.className=b;}}break;case"zoomIn":if(this.m_disControl.zoomIn!=c&&null!=this.zoomCombo){this.m_disControl.zoomIn=c;this.zoomCombo.disabled=c;if(c){var b=this.zoomCombo.className;var d=/\_svg/g;b=b.replace(d,"_svg_dis");d=/\_png/g;b=b.replace(d,"_png_dis");this.zoomCombo.className=b;}else{var b=this.zoomCombo.className;var d=/\_dis/g;b=b.replace(d,"");this.zoomCombo.className=b;}}break;case"input_box":if(this.m_disControl.input!=c&&null!=this.totalCountText){this.m_disControl.input=c;this.totalCountText.disabled=c;if(c){var b=this.totalCountText.className;var d=/\_svg/g;b=b.replace(d,"_svg_dis");d=/\_png/g;b=b.replace(d,"_png_dis");this.totalCountText.className=b;}else{var b=this.totalCountText.className;var d=/\_dis/g;b=b.replace(d,"");this.totalCountText.className=b;}}break;case"totalCount_box":if(this.m_disControl.caption!=c&&null!=this.totalCountSpan){this.m_disControl.caption=c;this.totalCountSpan.disabled=c;if(c){var b=this.totalCountSpan.className;var d=/\_svg/g;b=b.replace(d,"_svg_dis");d=/\_png/g;b=b.replace(d,"_png_dis");this.totalCountSpan.className=b;}else{var b=this.totalCountSpan.className;var d=/\_dis/g;b=b.replace(d,"");this.totalCountSpan.className=b;}}break;default:break;}};Report.prototype.setDebug=function(a){if(a){this.m_debug.isDebug=a;if(typeof window.console!="undefined"){this.m_debug.isConsole=true;}else{this.m_debug.message=new Array();}}};Report.prototype.reportNecessaryCheck=function(){var b="t"+new Date().getMilliseconds();var a="ClipID=R11&uid="+this.m_uid+"&clipUID="+this.m_uid+"&isNecessaryCheck=true&s_time="+b;a=mRe_onBeforeSend(a);var d=new HttpClient();var c=null;try{c=d.send(this.servletPath,a,false,null);var f=objectCall(ClipStrTrim(mRe_onAfterSend(c)));if(typeof f=="string"){f=objectCall(f);}if(f.status){if(f.event==102){ReportWebLog("Please check your server logs!");}return true;}else{this.m_NecessaryPopup(f.list);}}catch(g){ReportWebLog("report edit Necessary Check server connection error!");return false;}return false;};Report.prototype.setSignStaticPosition=function(b,a){this.m_signOption.staticPos=true;this.m_signOption.staticLeft=b;this.m_signOption.staticTop=a;};Report.prototype.setSignOffset=function(b,a){this.m_signOption.offsetLeft=b;this.m_signOption.offsetTop=a;};Report.prototype.setRatioComboNameVisible=function(b,a){switch(b.toLowerCase()){case"50%":this.m_comboNames.num50.visible=a;break;case"75%":this.m_comboNames.num75.visible=a;break;case"100%":this.m_comboNames.num100.visible=a;break;case"125%":this.m_comboNames.num125.visible=a;break;case"150%":this.m_comboNames.num150.visible=a;break;case"200%":this.m_comboNames.num200.visible=a;break;case"300%":this.m_comboNames.num300.visible=a;break;case"400%":this.m_comboNames.num400.visible=a;break;case"pagewidth":this.m_comboNames.pagewidth.visible=a;break;case"wholepage":this.m_comboNames.wholepage.visible=a;break;default:break;}};Report.prototype.setRatioComboNameChange=function(b,a){switch(b.toLowerCase()){case"50%":this.m_comboNames.num50.name=a;break;case"75%":this.m_comboNames.num75.name=a;break;case"100%":this.m_comboNames.num100.name=a;break;case"125%":this.m_comboNames.num125.name=a;break;case"150%":this.m_comboNames.num150.name=a;break;case"200%":this.m_comboNames.num200.name=a;break;case"300%":this.m_comboNames.num300.name=a;break;case"400%":this.m_comboNames.num400.name=a;break;case"pagewidth":this.m_comboNames.pagewidth.name=a;break;case"wholepage":this.m_comboNames.wholepage.name=a;break;default:break;}};Report.prototype.setRatioComboName=function(a,b){if(null!=a){this.m_comboNames.pagewidth.name=a;}if(null!=b){this.m_comboNames.wholepage.name=b;}};Report.prototype.saveFileDownLoad=function(){if(this.m_isEndReport){var g=arguments[0];var a=arguments[1];var f=arguments[2];var d=new Object();d.name=mCR_Base64.encode(encodeURIComponent(g));if(f==1){d.pageType=1;d.startNum=1;d.endNum=this.m_pageCount;}else{if(f==2){d.pageType=2;d.startNum=this.beforePageIndex+1;d.endNum=this.beforePageIndex+1;}else{d.pageType=3;var c=1;var b=this.m_pageCount;if(arguments.length==5){if(arguments[4]<arguments[3]){if(arguments[4]>0){c=arguments[4];}if(arguments[3]<=b){b=arguments[3];}}else{if(arguments[3]>0){c=arguments[3];}if(arguments[4]<=b){b=arguments[4];}}}d.startNum=c;d.endNum=b;}}switch(a){case 1:d.exportType=1;d.option=this.m_defaultSaveExcelOp!=null?this.m_defaultSaveExcelOp:mRe_getDefaultSaveExcelOption("xls");break;case 2:d.exportType=10;d.option=this.m_defaultSaveExcelxOp!=null?this.m_defaultSaveExcelxOp:mRe_getDefaultSaveExcelOption("xlsx");break;case 3:d.exportType=2;d.option=this.m_defaultSavePDFOp!=null?this.m_defaultSavePDFOp:mRe_getDefaultSavePDFOption();mRe_setPDFFileList(d,this.splitPDFFileNames);d.option.memoExport=this.isMemoExport;d.option.memoTransparency=this.nMemoTransparency;break;case 4:d.exportType=3;d.option=this.m_defaultSaveHWPOp!=null?this.m_defaultSaveHWPOp:mRe_getDefaultSaveHWPOption();break;case 5:d.exportType=4;d.option=this.m_defaultSaveRTFOp!=null?this.m_defaultSaveRTFOp:mRe_getDefaultSaveRTFOption("rtf");break;case 6:d.exportType=5;d.option=this.m_defaultSavePPTOp!=null?this.m_defaultSavePPTOp:mRe_getDefaultSavePPTOption();break;case 7:d.exportType=7;d.option=this.m_defaultSaveHanCellOp!=null?this.m_defaultSaveHanCellOp:mRe_getDefaultSaveExcelOption("cell");break;case 8:d.exportType=8;d.option=this.m_defaultSaveHTML5Op!=null?this.m_defaultSaveHTML5Op:mRe_getDefaultSaveHTML5Option();break;case 9:d.exportType=9;d.option=this.m_defaultSaveDOCOp!=null?this.m_defaultSaveDOCOp:mRe_getDefaultSaveRTFOption("doc");break;case 10:d.exportType=11;d.option=this.m_defaultSaveJPGOp!=null?this.m_defaultSaveJPGOp:mRe_getDefaultSaveJPGOption();break;case 11:d.exportType=13;d.option=this.m_defaultSaveTIFOp!=null?this.m_defaultSaveTIFOp:mRe_getDefaultSaveTIFOption();break;case 12:d.exportType=14;d.option=this.m_defaultSaveMultiTIFOp!=null?this.m_defaultSaveMultiTIFOp:mRe_getDefaultSaveMultiTIFOption();break;case 13:d.exportType=15;d.option=this.m_defaultSaveExcelDataOp!=null?this.m_defaultSaveExcelDataOp:mRe_getDefaultSaveExcelDataOption();break;case 14:d.exportType=12;d.option={splitPage:0};break;case 15:d.exportType=16;d.option=this.m_defaultSaveDOCXOp!=null?this.m_defaultSaveDOCXOp:mRe_getDefaultSaveRTFOption("docx");break;case 16:d.exportType=17;d.option=this.m_defaultSavePPTXOp!=null?this.m_defaultSavePPTXOp:mRe_getDefaultSavePPTXOption();break;case 17:d.exportType=18;d.option={splitPage:0};break;case 18:d.exportType=19;d.option=this.m_defaultSavePPTXOp!=null?this.m_defaultSavePPTXOp:mRe_getDefaultSavePPTXOption();break;default:break;}this.m_saveInfo_view=new Object();this.m_saveInfo_view.json_data=d;d=null;this.submitSaveOption();this.m_saveInfo_view=null;this.mRe_closeReportSaveInfo();this.disabledMenu(true);}else{mRe_ReportEventHandler(10);}};Report.prototype.setScrollPaging=function(a){this.m_scrollEv.isScrollPaging=a;};Report.prototype.setMobilePageScrollTop=function(a){this.m_mobile.scrollTop=a;};Report.prototype.setPageScrollTop=function(a){this.m_pcView.scrollTop=a;};Report.prototype.setFirefoxPopUpPrintWindow=function(b,c,a){this.m_firefoxPrint.isPopup=b;this.m_firefoxPrint.width=c;this.m_firefoxPrint.height=a;};Report.prototype.setPrintExceptionSaveButtonVisible=function(a){this.pESaveButtonVisible=a;};Report.prototype.setChartToImage=function(a){this.m_isChartToImage=a;};Report.prototype.setIsMarkAny=function(a){this.m_isMarkAny=a;};Report.prototype.setPDFFitToPage=function(a){this.isChromePrintFitToPage=a;};Report.prototype.setEndReportProgress=function(b,d,a,c){};Report.prototype.changeRatioCombo=function(c,b){if(typeof b==="undefined"){b=false;}var a="";switch(c.toString().toLowerCase()){case"0.5":case"50%":a="0.5";break;case"0.75":case"75%":a="0.75";break;case"1":case"100%":a="1";break;case"1.25":case"125%":a="1.25";break;case"1.5":case"150%":a="1.5";break;case"2":case"200%":a="2";break;case"3":case"300%":a="3";break;case"4":case"400%":a="4";break;case"pagewidth":a="PageWidth";break;case"wholepage":a="WholePage";break;default:break;}if(a==""||(!b&&a==this.zoomCombo.value)){return;}this.zoomCombo.value=a;this.zoomIn(this.zoomCombo);};Report.prototype.getReportKey=function(){return this.m_uid;};Report.prototype.setPrintImage=function(a){this.isPDFPrintImage=a;};Report.prototype.setPrintBarcodeAWT=function(a){this.isPDFPrintBarcodeAWT=a;};Report.prototype.setPDFDownloadLink=function(a){this.m_pdfLink=a;};Report.prototype.setDisplayPrintOption=function(b,a){switch(b.toLocaleLowerCase()){case"pdf":this.m_printDisplay.pdf=a;break;case"html":this.m_printDisplay.html=a;break;case"hwp":this.m_printDisplay.hwp=a;break;case"exe":this.m_printDisplay.exe=a;break;default:break;}};Report.prototype.setUseHTMLPrint=function(a){this.setDisplayPrintOption("html",a);};Report.prototype.setUseOriginImage=function(a){this.m_isUseOriginImage=a;};Report.prototype.setEnabledCrossDomain=function(a){this.m_isCrossDomain=a;this.m_fileDownLoadServerCheck=a;};Report.prototype.setOOFEncoding=function(a){this.m_isEncode=a;};Report.prototype.setImageViewer=function(a){this.m_isPaintImage=a;};Report.prototype.setSaveFileName=function(a){this.m_strFileName=a;};Report.prototype.setAppendSaveFileName=function(a){this.m_strAppendFileName=a;};Report.prototype.setAccessibility=function(a){this.m_isAccessibility=a;};Report.prototype.setDisabled=function(a,b){switch(a){case"prev_button":this.m_disControl.prev=b;break;case"next_button":this.m_disControl.next=b;break;case"firstPage_button":this.m_disControl.first=b;break;case"lastPage_button":this.m_disControl.last=b;break;case"save_button":this.m_disControl.save=b;break;case"print_button":this.m_disControl.print=b;break;case"close_button":this.m_disControl.close=b;break;case"pdf_button":this.m_disControl.pdf=b;break;case"hwp_button":this.m_disControl.hwp=b;break;case"doc_button":this.m_disControl.doc=b;break;case"excel_button":this.m_disControl.excel=b;break;case"reportInfo_button":this.m_disControl.reportInfo=b;break;case"zoomIn":this.m_disControl.zoomIn=b;break;case"input_box":this.m_disControl.input=b;break;case"totalCount_box":this.m_disControl.caption=b;break;default:break;}};Report.prototype.setStartSaveButtonEvent=function(a){this.m_buttonEvent.startSaveButton=a;};Report.prototype.setStartPDFButtonEvent=function(a){this.m_buttonEvent.startPDFButton=a;};Report.prototype.setStartExcelButtonEvent=function(a){this.m_buttonEvent.startExcelButton=a;};Report.prototype.setStartHWPButtonEvent=function(a){this.m_buttonEvent.startHWPButton=a;};Report.prototype.setStartDOCButtonEvent=function(a){this.m_buttonEvent.startDOCButton=a;};Report.prototype.setStartPrintButtonEvent=function(a){this.m_buttonEvent.startPrintButton=a;};Report.prototype.setStartCloseButtonEvent=function(a){this.m_buttonEvent.startCloseButton=a;};Report.prototype.setEndSaveButtonEvent=function(a){this.m_buttonEvent.endSaveButton=a;};Report.prototype.setEndPDFButtonEvent=function(a){this.m_buttonEvent.endPDFButton=a;};Report.prototype.setEndExcelButtonEvent=function(a){this.m_buttonEvent.endExcelButton=a;};Report.prototype.setEndHWPButtonEvent=function(a){this.m_buttonEvent.endHWPButton=a;};Report.prototype.setEndDOCButtonEvent=function(a){this.m_buttonEvent.endDOCButton=a;};Report.prototype.setEndReportEvent=function(a){this.m_isReportEndFunction=a;};Report.prototype.setCloseReportEvent=function(a){this.m_isCloseFunction=a;};Report.prototype.setFileDownLoadCheck=function(a){this.m_fileDownLoadServerCheck=a;};Report.prototype.setLanguage=function(a){switch(a){case"en":this.m_language=1;break;case"jp":this.m_language=2;break;case"cn":this.m_language=3;break;default:break;}};Report.prototype.setSplitPDFFileNames=function(a){this.splitPDFFileNames=a;};Report.prototype.setDefaultSelectSaveOption=function(a){this.defaultSaveOption=a;};Report.prototype.setDefaultSaveExcelOption=function(l,q,b,g,o,f,c,p,j,r,n,k,i,h,d,m,a){if(null==this.m_defaultSaveExcelOp){this.m_defaultSaveExcelOp=mRe_getDefaultSaveExcelOption("xls");}this.m_defaultSaveExcelOp.exportMethod=""+l;if(l){this.m_defaultSaveExcelOp.mergeCell=q;}this.m_defaultSaveExcelOp.mergeEmptyCell=b;this.m_defaultSaveExcelOp.splitCellAtPageSize=g;this.m_defaultSaveExcelOp.rightToLeft=o;this.m_defaultSaveExcelOp.widthRate=f;this.m_defaultSaveExcelOp.heightRate=c;this.m_defaultSaveExcelOp.coordinateErrorLimit=p;this.m_defaultSaveExcelOp.processGerenalFormat=j;this.m_defaultSaveExcelOp.printingMagnification=r;n=null==n?false:n;this.m_defaultSaveExcelOp.fitToPageWhenPrinting=n;k=null==k?false:k;this.m_defaultSaveExcelOp.removeHyperlink=k;i=null==i?false:i;this.m_defaultSaveExcelOp.repeatPageSectionWhenAllSectionInOneSheet=i;h=null==h?false:h;this.m_defaultSaveExcelOp.useSubreportNameAsSheetName=h;d=null==d?"":d;this.m_defaultSaveExcelOp.defaultPageSheetName=d;m=null==m?false:m;this.m_defaultSaveExcelOp.clearEmptySubSection=m;a=null==a?false:a;this.m_defaultSaveExcelOp.clearCrosstabHeader=a;};Report.prototype.setDefaultSaveExcelxOption=function(b,g,k,o,i,s,t,c,j,r,a,l,m,h,f,n,p,d,q){if(null==this.m_defaultSaveExcelxOp){this.m_defaultSaveExcelxOp=mRe_getDefaultSaveExcelOption("xlsx");}this.m_defaultSaveExcelxOp.exportMethod=""+b;if(b){this.m_defaultSaveExcelxOp.mergeCell=g;}this.m_defaultSaveExcelxOp.mergeEmptyCell=k;this.m_defaultSaveExcelxOp.splitCellAtPageSize=o;this.m_defaultSaveExcelxOp.rightToLeft=i;this.m_defaultSaveExcelxOp.widthRate=s;this.m_defaultSaveExcelxOp.heightRate=t;this.m_defaultSaveExcelxOp.coordinateErrorLimit=c;this.m_defaultSaveExcelxOp.processGerenalFormat=j;this.m_defaultSaveExcelxOp.printingMagnification=r;a=null==a?false:a;this.m_defaultSaveExcelxOp.fitToPageWhenPrinting=a;l=null==l?false:l;this.m_defaultSaveExcelxOp.removeHyperlink=l;m=(null==m)?false:m;this.m_defaultSaveExcelxOp.repeatPageSectionWhenAllSectionInOneSheet=m;n=(null==n)?false:n;this.m_defaultSaveExcelxOp.useSubreportNameAsSheetName=n;h=(null==h)?"":h;this.m_defaultSaveExcelxOp.userPassword=h;f=(null==f)?false:f;this.m_defaultSaveExcelxOp.is2Dot5VersionConverted=f;p=null==p?"":p;this.m_defaultSaveExcelxOp.defaultPageSheetName=p;d=null==d?false:d;this.m_defaultSaveExcelxOp.clearEmptySubSection=d;q=null==q?false:q;this.m_defaultSaveExcelxOp.clearCrosstabHeader=q;};Report.prototype.setDefaultSaveHanCellOption=function(b,f,j,n,h,r,s,c,i,q,a,k,l,g,m,o,d,p){if(null==this.m_defaultSaveHanCellOp){this.m_defaultSaveHanCellOp=mRe_getDefaultSaveExcelOption("cell");}this.m_defaultSaveHanCellOp.exportMethod=""+b;if(b){this.m_defaultSaveHanCellOp.mergeCell=f;}this.m_defaultSaveHanCellOp.mergeEmptyCell=j;this.m_defaultSaveHanCellOp.splitCellAtPageSize=n;this.m_defaultSaveHanCellOp.rightToLeft=h;this.m_defaultSaveHanCellOp.widthRate=r;this.m_defaultSaveHanCellOp.heightRate=s;this.m_defaultSaveHanCellOp.coordinateErrorLimit=c;this.m_defaultSaveHanCellOp.processGerenalFormat=i;this.m_defaultSaveHanCellOp.printingMagnification=q;a=null==a?false:a;this.m_defaultSaveHanCellOp.fitToPageWhenPrinting=a;k=null==k?false:k;this.m_defaultSaveHanCellOp.removeHyperlink=k;l=null==l?false:l;this.m_defaultSaveHanCellOp.repeatPageSectionWhenAllSectionInOneSheet=l;g=(null==g)?"":g;this.m_defaultSaveHanCellOp.userPassword=g;m=null==m?false:m;this.m_defaultSaveHanCellOp.useSubreportNameAsSheetName=m;o=null==o?"":o;this.m_defaultSaveHanCellOp.defaultPageSheetName=o;d=null==d?false:d;this.m_defaultSaveHanCellOp.clearEmptySubSection=d;p=null==p?false:p;this.m_defaultSaveHanCellOp.clearCrosstabHeader=p;};Report.prototype.setDefaultSavePDFOption=function(d,c,g,a,b,f){if(null==this.m_defaultSavePDFOp){this.m_defaultSavePDFOp=mRe_getDefaultSavePDFOption();}this.m_defaultSavePDFOp.isSplite=d;this.m_defaultSavePDFOp.spliteValue=c;this.m_defaultSavePDFOp.userpw=g;this.m_defaultSavePDFOp.textToImage=a;this.m_defaultSavePDFOp.importOriginImage=b;this.m_defaultSavePDFOp.removeHyperlink=f;};Report.prototype.setDefaultSaveHWPOption=function(b,h,m,n,r,d,s,c,u,k,i,a,g,f,l,p,q,o,t,j){if(null==this.m_defaultSaveHWPOp){this.m_defaultSaveHWPOp=mRe_getDefaultSaveHWPOption();}this.m_defaultSaveHWPOp.fixSize=b;this.m_defaultSaveHWPOp.allowOverlay=h;this.m_defaultSaveHWPOp.setPageBottomMarginToZero=m;this.m_defaultSaveHWPOp.outputLikeWord=n;if(null!=n){this.m_defaultSaveHWPOp.tableSplitMethod=r;}this.m_defaultSaveHWPOp.defaultCharGap=d;this.m_defaultSaveHWPOp.charRatio=s;if(null!=c){this.m_defaultSaveHWPOp.putCheckboxIntoCell=c;}if(null!=u){this.m_defaultSaveHWPOp.splitTextByLine=u;}if(null!=k){this.m_defaultSaveHWPOp.mergeTable=k;}else{this.m_defaultSaveHWPOp.mergeTable=false;}if(null!=i){this.m_defaultSaveHWPOp.lineSpaceRate=i;}if(null!=a){this.m_defaultSaveHWPOp.positionRelTo=a;}if(null!=g){this.m_defaultSaveHWPOp.hwpExportMethod=g;}else{this.m_defaultSaveHWPOp.hwpExportMethod=1;}if(null!=f){this.m_defaultSaveHWPOp.splitPageOnListTableOnly=f;}else{this.m_defaultSaveHWPOp.splitPageOnListTableOnly=true;}if(null!=l){this.m_defaultSaveHWPOp.pageBottomMarginApplicationRate=l;}else{this.m_defaultSaveHWPOp.pageBottomMarginApplicationRate=100;}if(null!=p){this.m_defaultSaveHWPOp.insertPageNumber=p;}else{this.m_defaultSaveHWPOp.insertPageNumber=false;}if(null!=q){this.m_defaultSaveHWPOp.mergeAllTablesOnListTableOnly=q;}else{this.m_defaultSaveHWPOp.mergeAllTablesOnListTableOnly=false;}if(null!=o){this.m_defaultSaveHWPOp.insertLabelWithTextOnListTableOnly=o;}else{this.m_defaultSaveHWPOp.insertLabelWithTextOnListTableOnly=false;}if(null!=t){this.m_defaultSaveHWPOp.isTransparentMode=t;}else{this.m_defaultSaveHWPOp.isTransparentMode=false;}if(null!=j){this.m_defaultSaveHWPOp.isSectionClear=j;}else{this.m_defaultSaveHWPOp.isSectionClear=false;}};Report.prototype.setDefaultSaveRTFOption=function(h,c,d,b,i,j,f,g,a){if(null==this.m_defaultSaveRTFOp){this.m_defaultSaveRTFOp=mRe_getDefaultSaveRTFOption("rtf");}this.m_defaultSaveRTFOp.splitTextLine=h;this.m_defaultSaveRTFOp.processAsUnicode=c;this.m_defaultSaveRTFOp.processEqualAlign=d;this.m_defaultSaveRTFOp.defaultCharSpace=b;this.m_defaultSaveRTFOp.tableWrapperBottomGap=i;j=(null==j)?true:j;f=(null==f)?false:f;this.m_defaultSaveRTFOp.insertTableWrapper=j;this.m_defaultSaveRTFOp.mergeTable=f;g=(null==g)?false:g;a=(null==a)?1:a;this.m_defaultSaveRTFOp.fitShapeToText=g;this.m_defaultSaveRTFOp.TableRowHeightSort=a;};Report.prototype.setDefaultSaveDOCOption=function(h,c,d,b,i,j,f,g,a){if(null==this.m_defaultSaveDOCOp){this.m_defaultSaveDOCOp=mRe_getDefaultSaveRTFOption("doc");}this.m_defaultSaveDOCOp.splitTextLine=h;this.m_defaultSaveDOCOp.processAsUnicode=c;this.m_defaultSaveDOCOp.processEqualAlign=d;this.m_defaultSaveDOCOp.defaultCharSpace=b;this.m_defaultSaveDOCOp.tableWrapperBottomGap=i;j=(null==j)?true:j;f=(null==f)?false:f;this.m_defaultSaveDOCOp.insertTableWrapper=j;this.m_defaultSaveDOCOp.mergeTable=f;g=(null==g)?false:g;a=(null==a)?1:a;this.m_defaultSaveDOCOp.fitShapeToText=g;this.m_defaultSaveDOCOp.TableRowHeightSort=a;};Report.prototype.setDefaultSaveDOCXOption=function(i,g,h,a,d,c,f,b){if(null==this.m_defaultSaveDOCXOp){this.m_defaultSaveDOCXOp=mRe_getDefaultSaveRTFOption("docx");}this.m_defaultSaveDOCXOp.splitTextLine=i;this.m_defaultSaveDOCXOp.defaultCharSpace=g;this.m_defaultSaveDOCXOp.tableWrapperBottomGap=h;this.m_defaultSaveDOCXOp.insertTableWrapper=a;this.m_defaultSaveDOCXOp.mergeTable=d;this.m_defaultSaveDOCXOp.lineSpaceRate=c;if(null!=f){this.m_defaultSaveDOCXOp.easyEditable=f;}if(null!=b){this.m_defaultSaveDOCXOp.userPassword=b;}else{this.m_defaultSaveDOCXOp.userPassword="";}};Report.prototype.setDefaultSaveJPGOption=function(b,a,d,c){if(null==this.m_defaultSaveJPGOp){this.m_defaultSaveJPGOp=mRe_getDefaultSaveJPGOption();}this.m_defaultSaveJPGOp.rotate90=b;this.m_defaultSaveJPGOp.dpiX=a;this.m_defaultSaveJPGOp.dpiY=d;this.m_defaultSaveJPGOp.quality=c;};Report.prototype.setDefaultSaveTIFOption=function(c,b,f,d,a){if(null==this.m_defaultSaveTIFOp){this.m_defaultSaveTIFOp=mRe_getDefaultSaveTIFOption();}this.m_defaultSaveTIFOp.rotate90=c;this.m_defaultSaveTIFOp.dpiX=b;this.m_defaultSaveTIFOp.dpiY=f;this.m_defaultSaveTIFOp.blackWhite=d;this.m_defaultSaveTIFOp.gray=a;};Report.prototype.setDefaultSaveMultiTIFOption=function(c,b,f,d,a){if(null==this.m_defaultSaveMultiTIFOp){this.m_defaultSaveMultiTIFOp=mRe_getDefaultSaveMultiTIFOption();}this.m_defaultSaveMultiTIFOp.rotate90=c;this.m_defaultSaveMultiTIFOp.dpiX=b;this.m_defaultSaveMultiTIFOp.dpiY=f;this.m_defaultSaveMultiTIFOp.blackWhite=d;this.m_defaultSaveMultiTIFOp.gray=a;};Report.prototype.setDefaultSaveExcelDataOption=function(a){if(null==this.m_defaultSaveExcelDataOp){this.m_defaultSaveExcelDataOp=mRe_getDefaultSaveExcelDataOption();}this.m_defaultSaveExcelDataOp.outputPageSectionMethod=a;};Report.prototype.setDefaultSavePPTOption=function(b,a,c){if(null==this.m_defaultSavePPTOp){this.m_defaultSavePPTOp=mRe_getDefaultSavePPTOption();}this.m_defaultSavePPTOp.mergeTable=b;this.m_defaultSavePPTOp.ignoreLineSpace=a;this.m_defaultSavePPTOp.removeHyperlink=c;};Report.prototype.setDefaultSavePPTXOption=function(c,d,g,a,b,f){if(null==this.m_defaultSavePPTXOp){this.m_defaultSavePPTXOp=mRe_getDefaultSavePPTXOption();}this.m_defaultSavePPTXOp.mergeTable=c;this.m_defaultSavePPTXOp.splitTextByLine=d;this.m_defaultSavePPTXOp.removeHyperlink=g;this.m_defaultSavePPTXOp.defaultCharGap=a;this.m_defaultSavePPTXOp.lineSpaceRate=b;this.m_defaultSavePPTXOp.putCheckboxIntoCell=f;};Report.prototype.setDefaultSaveHTMLOption=function(k,i,a,g,d,c,f,j,h,b){if(null==this.m_defaultSaveHTMLOp){this.m_defaultSaveHTMLOp=mRe_getDefaultSaveHTMLOption();}this.m_defaultSaveHTMLOp.processCellLikeShape=k;this.m_defaultSaveHTMLOp.displayPageLine=i;this.m_defaultSaveHTMLOp.keepPageHeight=a;this.m_defaultSaveHTMLOp.applyWordBreak=g;this.m_defaultSaveHTMLOp.setTextProperiesToEmptyCell=d;this.m_defaultSaveHTMLOp.putTagIntoEmptyCell=c;this.m_defaultSaveHTMLOp.textOverflowHidden=f;this.m_defaultSaveHTMLOp.coordinateRateForX=j;this.m_defaultSaveHTMLOp.coordinateRateForY=h;this.m_defaultSaveHTMLOp.encodingType=b;};Report.prototype.setDefaultSaveHTML5Option=function(b,a){if(null==this.m_defaultSaveHTML5Op){this.m_defaultSaveHTML5Op=mRe_getDefaultSaveHTML5Option();}this.m_defaultSaveHTML5Op.isSplite=b;this.m_defaultSaveHTML5Op.dpiValue=a;};Report.prototype.setSaveDirectExcelOption=function(s,b,f,i,m,g,q,r,c,h,p,a,j,k,l,n,d,o){this.m_saveDirectExcelOp={mergeCell:true};this.m_saveDirectExcelOp.fileName=s;this.m_saveDirectExcelOp.exportMethod=""+b;if(null!=b){this.m_saveDirectExcelOp.mergeCell=f;}this.m_saveDirectExcelOp.mergeEmptyCell=i;this.m_saveDirectExcelOp.splitCellAtPageSize=m;this.m_saveDirectExcelOp.rightToLeft=g;this.m_saveDirectExcelOp.widthRate=q;this.m_saveDirectExcelOp.heightRate=r;this.m_saveDirectExcelOp.coordinateErrorLimit=c;this.m_saveDirectExcelOp.processGerenalFormat=h;this.m_saveDirectExcelOp.printingMagnification=p;a=null==a?false:a;this.m_saveDirectExcelOp.fitToPageWhenPrinting=a;j=null==j?false:j;this.m_saveDirectExcelOp.removeHyperlink=j;k=null==k?false:k;this.m_saveDirectExcelOp.repeatPageSectionWhenAllSectionInOneSheet=k;l=null==l?false:l;this.m_saveDirectExcelOp.useSubreportNameAsSheetName=l;n=null==n?"":n;this.m_saveDirectExcelOp.defaultPageSheetName=n;d=null==d?false:d;this.m_saveDirectExcelOp.clearEmptySubSection=d;o=null==o?false:o;this.m_saveDirectExcelOp.clearEmptySubSection=o;};Report.prototype.setSaveDirectPDFOption=function(h,d,c,g,a,b,f){this.m_saveDirectPDFOp=new Object();this.m_saveDirectPDFOp.fileName=h;this.m_saveDirectPDFOp.isSplite=d;this.m_saveDirectPDFOp.spliteValue=c;this.m_saveDirectPDFOp.userpw=g;this.m_saveDirectPDFOp.textToImage=a;this.m_saveDirectPDFOp.importOriginImage=b;this.m_saveDirectPDFOp.removeHyperlink=f;};Report.prototype.setSaveDirectHWPOption=function(u,b,h,m,n,r,d,s,c,v,k,i,a,g,f,l,p,q,o,t,j){this.m_saveDirectHWPOp={tableSplitMethod:2,positionRelTo:1,hwpExportMethod:1,splitPageOnListTableOnly:true,pageBottomMarginApplicationRate:100,insertPageNumber:false};this.m_saveDirectHWPOp.fileName=u;this.m_saveDirectHWPOp.fixSize=b;this.m_saveDirectHWPOp.allowOverlay=h;this.m_saveDirectHWPOp.setPageBottomMarginToZero=m;this.m_saveDirectHWPOp.outputLikeWord=n;if(null!=n){this.m_saveDirectHWPOp.tableSplitMethod=r;}this.m_saveDirectHWPOp.defaultCharGap=d;this.m_saveDirectHWPOp.charRatio=s;this.m_saveDirectHWPOp.putCheckboxIntoCell=c;this.m_saveDirectHWPOp.splitTextByLine=v;if(null!=k){this.m_saveDirectHWPOp.mergeTable=k;}else{this.m_saveDirectHWPOp.mergeTable=false;}if(null!=i){this.m_saveDirectHWPOp.lineSpaceRate=i;}if(null!=a){this.m_saveDirectHWPOp.positionRelTo=a;}if(null!=g){this.m_saveDirectHWPOp.hwpExportMethod=g;}if(null!=f){this.m_saveDirectHWPOp.splitPageOnListTableOnly=f;}if(null!=l){this.m_saveDirectHWPOp.pageBottomMarginApplicationRate=l;}if(null!=p){this.m_saveDirectHWPOp.insertPageNumber=p;}if(null!=q){this.m_saveDirectHWPOp.mergeAllTablesOnListTableOnly=q;}else{this.m_saveDirectHWPOp.mergeAllTablesOnListTableOnly=false;}if(null!=o){this.m_saveDirectHWPOp.insertLabelWithTextOnListTableOnly=o;}else{this.m_saveDirectHWPOp.insertLabelWithTextOnListTableOnly=false;}if(null!=t){this.m_saveDirectHWPOp.isTransparentMode=t;}else{this.m_saveDirectHWPOp.isTransparentMode=false;}if(null!=j){this.m_saveDirectHWPOp.isSectionClear=j;}else{this.m_saveDirectHWPOp.isSectionClear=false;}};Report.prototype.setSaveDirectDOCOption=function(f,i,c,d,b,j,k,g,h,a){this.m_saveDirectDOCOp={type:"doc"};this.m_saveDirectDOCOp.fileName=f;this.m_saveDirectDOCOp.splitTextLine=i;this.m_saveDirectDOCOp.processAsUnicode=c;this.m_saveDirectDOCOp.processEqualAlign=d;this.m_saveDirectDOCOp.defaultCharSpace=b;this.m_saveDirectDOCOp.tableWrapperBottomGap=j;this.m_saveDirectDOCOp.insertTableWrapper=k;this.m_saveDirectDOCOp.mergeTable=g;h=(null==h)?false:h;a=(null==a)?1:a;this.m_saveDirectDOCOp.fitShapeToText=h;this.m_saveDirectDOCOp.TableRowHeightSort=a;};Report.prototype.setSaveOptionVisible=function(b,a){b=b.toLowerCase();if("excel"==b){this.saveOptionVisible.excel=a;}else{if("pdf"==b){this.saveOptionVisible.pdf=a;}else{if("hwp"==b){this.saveOptionVisible.hwp=a;}else{if("rtf"==b){this.saveOptionVisible.rtf=a;}else{if("doc"==b){this.saveOptionVisible.doc=a;}else{if("docx"==b){this.saveOptionVisible.docx=a;}else{if("ppt"==b){this.saveOptionVisible.ppt=a;}else{if("html"==b){this.saveOptionVisible.html=a;}else{if("html5"==b){this.saveOptionVisible.html5=a;}else{if("hancell"==b){this.saveOptionVisible.hancell=a;}else{if("excelx"==b){this.saveOptionVisible.excelx=a;}else{if("jpg"==b){this.saveOptionVisible.jpg=a;}else{if("txt"==b){this.saveOptionVisible.txt=a;}else{if("tif"==b){this.saveOptionVisible.tif=a;}else{if("multitif"==b){this.saveOptionVisible.multiTif=a;}else{if("exceldata"==b){this.saveOptionVisible.excelData=a;}else{if("pptx"==b){this.saveOptionVisible.pptx=a;}else{if("brl"==b){this.saveOptionVisible.brl=a;}else{if("hanshow"==b){this.saveOptionVisible.hanshow=a;}}}}}}}}}}}}}}}}}}}if(!a){this.changeDefaultSaveOption();}};Report.prototype.changeDefaultSaveOption=function(){if(this.saveOptionVisible.excel){this.defaultSaveOption="excel";}if(this.saveOptionVisible.excelx){this.defaultSaveOption="excelx";}else{if(this.saveOptionVisible.pdf){this.defaultSaveOption="pdf";}else{if(this.saveOptionVisible.hwp){this.defaultSaveOption="hwp";}else{if(this.saveOptionVisible.rtf){this.defaultSaveOption="rtf";}else{if(this.saveOptionVisible.doc){this.defaultSaveOption="doc";}else{if(this.saveOptionVisible.docx){this.defaultSaveOption="docx";}else{if(this.saveOptionVisible.ppt){this.defaultSaveOption="ppt";}else{if(this.saveOptionVisible.html){this.defaultSaveOption="html";}else{if(this.saveOptionVisible.html5){this.defaultSaveOption="html5";}else{if(this.saveOptionVisible.hancell){this.defaultSaveOption="hancell";}else{if(this.saveOptionVisible.jpg){this.defaultSaveOption="jpg";}else{if(this.saveOptionVisible.txt){this.defaultSaveOption="txt";}else{if(this.saveOptionVisible.tif){this.defaultSaveOption="tif";}else{if(this.saveOptionVisible.multiTif){this.defaultSaveOption="multiTif";}else{if(this.saveOptionVisible.excelData){this.defaultSaveOption="excelData";}else{if(this.saveOptionVisible.pptx){this.defaultSaveOption="pptx";}else{if(this.saveOptionVisible.brl){this.defaultSaveOption="brl";}else{if(this.saveOptionVisible.hanshow){this.defaultSaveOption="hanshow";}}}}}}}}}}}}}}}}}}};Report.prototype.setLimitedPrint=function(a){this.m_limitedPrint=a;};Report.prototype.setDirectPrint=function(a){this.m_directPrint=a;};Report.prototype.setPageCountTime=function(a){this.m_pageCountTime=a;};Report.prototype.setDPI=function(a){this.m_DPI=a;};Report.prototype.setProgress=function(c,a,b){this.m_progress.URL=c;this.m_progress.x=a;this.m_progress.y=b;};Report.prototype.setPrintProgress=function(c,a,b){};Report.prototype.setHWPProgress=function(c,a,b){};Report.prototype.setEXCELProgress=function(c,a,b){};Report.prototype.setSAVEProgress=function(c,a,b){};Report.prototype.nextPage=function(c){if(typeof c==="undefined"){c="API";}this.debugMeg("report log :: 다음 페이지로 이동 합니다.",true);if(this.m_isButtonLock==false){if(this.m_buttonEvent.startNextButton!=null){var b=this.m_buttonEvent.startNextButton();if(b!=true){return;}}if(this.is_eForm){if(this.m_isSplitView){if(!this.m_splitView.isQuick){var a=this.m_splitView.pageInfo[this.beforePageIndex];if(typeof a=="undefined"){if(null!=this.m_splitView.event){this.m_splitView.event();}return;}}}}this.selectPage((this.beforePageIndex+1),c);}};Report.prototype.previousPage=function(b){if(typeof b==="undefined"){b="API";}this.debugMeg("report log :: 이전 페이지로 이동 합니다.",true);if(this.m_isButtonLock==false){if(this.m_buttonEvent.startPrevButton!=null){var a=this.m_buttonEvent.startPrevButton();if(a!=true){return;}}this.selectPage((this.beforePageIndex-1),b);}};Report.prototype.firstPage=function(b){if(typeof b==="undefined"){b="API";}this.debugMeg("report log :: 첫 페이지로 이동 합니다.",true);if(this.m_isButtonLock==false){if(this.m_buttonEvent.startFirstButton!=null){var a=this.m_buttonEvent.startFirstButton();if(a!=true){return;}}this.selectPage(0,b);}};Report.prototype.lastPage=function(b){if(typeof b==="undefined"){b="API";}this.debugMeg("report log :: 마지막 페이지로 이동 합니다.",true);if(this.m_isButtonLock==false){if(this.m_buttonEvent.startLastButton!=null){var a=this.m_buttonEvent.startLastButton();if(a!=true){return;}}this.selectPage(this.m_pageCount-1,b);}};Report.prototype.exportView=function(){if(this.m_isButtonLock){return;}this.m_isButtonLock=true;if(this.m_isEndReport){if(this.m_buttonEvent.startSaveButton!=null){var a=this.m_buttonEvent.startSaveButton();if(a!=true){this.m_isButtonLock=false;return;}}this.reportCheckSend(0);}else{this.m_isButtonLock=false;mRe_ReportEventHandler(10);}};Report.prototype.printMobileView=function(){if(this.m_isEndReport){if(null!=this.m_limitedPrint&&this.m_pageCount>this.m_limitedPrint){this.printLimitedExportView("pdf");return;}this.pdfDownLoad();}else{mRe_ReportEventHandler(10);}};Report.prototype.printWindowView=function(){if(this.m_isButtonLock){return;}this.m_isButtonLock=true;if(this.m_isEndReport&&!this.m_disControl.print){this.reportCheckSend(4);}else{this.m_isButtonLock=false;mRe_ReportEventHandler(10);}};Report.prototype.printView=function(a){if(typeof a=="undefined"){a=false;}if(a){if(this.m_isEndReport&&!this.m_disControl.print){if(null!=this.m_limitedPrint&&this.checkPrintCount()>this.m_limitedPrint){this.printLimitedExportView("pdf");return;}this.mRe_printView();}else{mRe_ReportEventHandler(10);}}else{this.reportCheckSend(6);}};Report.prototype.printHWPView=function(a){if(typeof a=="undefined"){a=false;}if(a){if(this.m_isEndReport&&!this.m_disControl.print){if(null!=this.m_limitedPrint&&this.checkPrintCount()>this.m_limitedPrint){this.printLimitedExportView("hwp");return;}this.mRe_printHWPView();}else{mRe_ReportEventHandler(10);}}else{this.reportCheckSend(9);}};Report.prototype.printEXEView=function(a){if(typeof a=="undefined"){a=false;}if(a){if(this.m_isEndReport&&is_window&&!this.m_disControl.print){if(null!=this.m_limitedPrint&&this.checkPrintCount()>this.m_limitedPrint){this.printLimitedExportView("exe");return;}this.mRe_printEXEView();}else{mRe_ReportEventHandler(10);}}else{this.reportCheckSend(8);}};Report.prototype.printHTMLView=function(a){if(typeof a=="undefined"){a=false;}if(a){if(this.m_isEndReport&&!this.m_disControl.print){if(!is_chrome&&!this.m_directPrintHTML&&this.m_marginAlert){var b=mRe_getLocalStorage("mRe_htmlPopupCheck");if(b=="0"){this.printHtmlPopupCheckExportView();return;}}this.checkPrintHTMLView();}else{mRe_ReportEventHandler(10);}}else{this.reportCheckSend(7);}};Report.prototype.pdfDownLoad=function(){if(this.m_isEndReport){if(this.m_buttonEvent.startPDFButton!=null){var a=this.m_buttonEvent.startPDFButton();if(a!=true){return;}}this.printOpReset();this.reportCheckSend(1);}else{mRe_ReportEventHandler(10);}};Report.prototype.htmlDownLoad=function(){if(this.fileDownLoding){return;}var a=this;this.fileDownLoding=true;if(this.m_isEndReport){this.formTag_clipid.value="R06";this.formTag_uid.value=this.m_uid;this.formTag_clipUID.value=this.m_uid;this.formTag_print.value="html";this.formTag_path.value=this.clientPath;this.formTag.action=this.servletPath;this.formTag.target="re_target"+this.m_uid;this.formTag.submit();}else{mRe_ReportEventHandler(10);}window.setTimeout(function(){a.fileDownLoding=false;},2000);};Report.prototype.hwpDownLoad=function(){if(this.m_isEndReport){if(this.m_buttonEvent.startHWPButton!=null){var a=this.m_buttonEvent.startHWPButton();if(a!=true){return;}}this.printOpReset();this.reportCheckSend(3);}else{mRe_ReportEventHandler(10);}};Report.prototype.excelDownLoad=function(){if(this.m_isEndReport){if(this.m_buttonEvent.startExcelButton!=null){var a=this.m_buttonEvent.startExcelButton();if(a!=true){return;}}this.printOpReset();this.reportCheckSend(2);}else{mRe_ReportEventHandler(10);}};Report.prototype.docDownLoad=function(){if(this.m_isEndReport){if(this.m_buttonEvent.startDOCButton!=null){var a=this.m_buttonEvent.startDOCButton();if(a!=true){return;}}this.printOpReset();this.reportCheckSend(5);}else{mRe_ReportEventHandler(10);}};Report.prototype.closeReport=function(){if(this.m_buttonEvent.startCloseButton!=null){var a=this.m_buttonEvent.startCloseButton();if(a!=true){return;}}if(!this.is_eForm){this.deleteToReport();}window.clearInterval(this.checkCountLoop);if(this.m_isFadeView){$(this.targetDiv).fadeOut(400,function(){this.innerHTML="";$(this).show();});}else{this.targetDiv.innerHTML="";}if(this.m_isCloseFunction!=null){this.m_isCloseFunction();}m_reportHashMap[this.m_uid]=null;};Report.prototype.setStyle=function(b,a){switch(b){case"menu":if(null!=this.menuDiv&&(typeof this.menuDiv!=="string")){this.menuDiv.style.cssText=a;}else{this.menuDiv=a;}break;case"main":if(null!=this.paintDiv&&(typeof this.paintDiv!=="string")){this.paintDiv.style.cssText=a;}else{this.paintDiv=a;}break;case"doodle_button":if(null!=this.doodle_button&&(typeof this.doodle_button!=="string")){this.doodle_button.style.cssText=a;}else{this.doodle_button=a;}break;case"memo_button":if(null!=this.memo_button&&(typeof this.memo_button!=="string")){this.memo_button.style.cssText=a;}else{this.memo_button=a;}break;case"searchWord_button":if(null!=this.searchWord_button&&(typeof this.searchWord_button!=="string")){this.searchWord_button.style.cssText=a;}else{this.searchWord_button=a;}break;case"doodle_close_button":if(null!=this.doodle_close_button&&(typeof this.doodle_close_button!=="string")){this.doodle_close_button.style.cssText=a;}else{this.doodle_close_button=a;}break;case"memo_close_button":if(null!=this.memo_close_button&&(typeof this.memo_close_button!=="string")){this.memo_close_button.style.cssText=a;}else{this.memo_close_button=a;}break;case"prev_button":if(null!=this.prev_button&&(typeof this.prev_button!=="string")){this.prev_button.style.cssText=a;}else{this.prev_button=a;}break;case"next_button":if(null!=this.next_button&&(typeof this.next_button!=="string")){this.next_button.style.cssText=a;}else{this.next_button=a;}break;case"setting_button":if(null!=this.setting_button&&(typeof this.setting_button!=="string")){this.setting_button.style.cssText=a;}else{this.setting_button=a;}break;case"firstPage_button":if(null!=this.first_button&&(typeof this.first_button!=="string")){this.first_button.style.cssText=a;}else{this.first_button=a;}break;case"lastPage_button":if(null!=this.last_button&&(typeof this.last_button!=="string")){this.last_button.style.cssText=a;}else{this.last_button=a;}break;case"save_button":if(null!=this.save_button&&(typeof this.save_button!=="string")){this.save_button.style.cssText=a;}else{this.save_button=a;}break;case"print_button":if(null!=this.print_button&&(typeof this.print_button!=="string")){this.print_button.style.cssText=a;}else{this.print_button=a;}break;case"close_button":if(null!=this.close_button&&(typeof this.close_button!=="string")){this.close_button.style.cssText=a;}else{this.close_button=a;}break;case"pdf_button":if(null!=this.pdf_button&&(typeof this.pdf_button!=="string")){this.pdf_button.style.cssText=a;}else{this.pdf_button=a;}break;case"hwp_button":if(null!=this.hwp_button&&(typeof this.hwp_button!=="string")){this.hwp_button.style.cssText=a;}else{this.hwp_button=a;}break;case"doc_button":if(null!=this.doc_button&&(typeof this.doc_button!=="string")){this.doc_button.style.cssText=a;}else{this.doc_button=a;}break;case"excel_button":if(null!=this.excel_button&&(typeof this.excel_button!=="string")){this.excel_button.style.cssText=a;}else{this.excel_button=a;}break;case"reportInfo_button":if(null!=this.reportInfo_button&&(typeof this.reportInfo_button!=="string")){this.reportInfo_button.style.cssText=a;}else{this.reportInfo_button=a;}break;case"zoomIn":if(null!=this.zoomCombo&&(typeof this.zoomCombo!=="string")){this.zoomCombo.style.cssText=a;}else{this.zoomCombo=a;}break;case"input_box":if(null!=this.input&&(typeof this.input!=="string")){this.input.style.cssText=a;}else{this.input=a;}break;case"totalCount_box":if(null!=this.totalCountSpan&&(typeof this.totalCountSpan!=="string")){this.totalCountSpan.style.cssText=a;if(null!=this.totalCountText){this.totalCountText.style.cssText=a;}}else{this.totalCountSpan=a;}break;default:break;}};Report.prototype.setVisibleMenu=function(a){this.m_isMenu=a;};Report.prototype.setFadeView=function(a){this.m_isFadeView=a;};Report.prototype.setIsBigData=function(a){this.m_isBigData=a;};Report.prototype.setIsMemoryDump=function(a){this.m_isMemoryDump=a;};Report.prototype.reSize=function(){if(this.zoomCombo!=null){this.zoomIn(this.zoomCombo);}};Report.prototype.setDefaultRatio=function(a){switch(a.toString().toLowerCase()){case"50%":case"75%":case"100%":case"125%":case"150%":case"200%":case"300%":case"400%":case"pagewidth":case"wholepage":this.m_ratio=a;break;default:this.m_ratio="100%";}};Report.prototype.setHWPPrint=function(a){this.m_isHWPPrint=a;};Report.prototype.setDisplayTotalPageCount=function(a,b){this.m_TPC.before=a;this.m_TPC.after=b;};Report.prototype.setReportCheckEvent=function(b,a){this.m_objReportCheck.isCheck=true;this.m_objReportCheck.maxCount=b;this.m_objReportCheck.callbackFunc=a;};Report.prototype.setAppendCustomMenuButton=function(f,c,a,d){var b={};b.elm=document.createElement("button");b.text=f;b.style=c;b.css=a;b.func=d;this.m_menuCustomButton.push(b);return b.elm;};Report.prototype.setPostParam=function(b){var a=false;var f=[];var i=b.split("&");for(var d=0;d<i.length;d++){var c=i[d];var g=c.split("=");if(g.length==2){a=true;var h=[g[0],g[1]];f.push(h);}}if(a){this.m_postParam={};this.m_postParam.paramList=f;this.m_postParam.getParam=function(){var k="";for(var j=0;j<f.length;j++){k+="&"+f[j][0]+"="+encodeURIComponent(f[j][1]);}return k;};}else{this.m_postParam=null;}};function Report(f,h,b,g,i,d){this.servletPath=f;this.beforePageIndex=this.old_beforePageIndex=0;this.checkCountLoop=null;this.oof=g;this.userJsp=h;this.postData=b;this.m_reportKey=null;this.docViewData=null;this.isDocViewData=false;if(typeof d!="undefined"){this.docViewData=d;this.isDocViewData=true;}this.targetDiv=i;this.input=null;this.paintDiv=null;this.signPaintDiv=null;this.m_tempPaintDiv=null;this.menuDiv=null;this.totalCountSpan=null;this.totalCountText=null;this.progressImg=null;this.zoomCombo=null;this.next_button=null;this.prev_button=null;this.first_button=null;this.last_button=null;this.save_button=null;this.print_button=null;this.pdf_button=null;this.hwp_button=null;this.doc_button=null;this.excel_button=null;this.reportInfo_button=null;this.close_button=null;this.setting_button=null;this.hwp_object=null;this.doodleDiv=null;this.memoDiv=null;this.doodle_button=null;this.memo_button=null;this.m_uid=null;this.m_pageCount=0;this.m_isEndReport=false;this.m_isEndReportEvent=true;this.pageWidth=null;this.pageHeight=null;this.m_language=0;this.m_languageMap=null;this.fileDownLoding=false;this.formTag=null;this.formTag_clipid=null;this.formTag_uid=null;this.formTag_print=null;this.formTag_path=null;this.formTag_option=null;this.formTag_ChromeFitToPage=null;this.formTag_s_time=null;this.fileDownloadCheckTimer=null;this.saveFormTag={form:null,clipid:null,uid:null,option:null};this.deleteImgTag=null;this.m_isMenu=true;this.m_isBigData=false;this.m_isMemoryDump=false;this.m_isEncode=false;this.m_isCrossDomain=false;this.m_isFadeView=false;this.m_isSlidePage=false;this.m_isButtonLock=false;this.m_printDisplay={pdf:true,html:true,hwp:true,exe:false};this.m_isHWPPrint=false;this.m_DPI=96;this.m_ratio="100%";this.m_directPrint=false;this.m_directPrintHTML=false;this.m_directPrintOp={endReport:false,key:null};this.m_pageCountTime=700;this.m_waitTime=1;this.m_isCloseFunction=null;this.m_isReportEndFunction=null;this.m_progress={URL:"",x:0,y:0};this.m_printprogress={URL:"",x:0,y:0,domDiv:null};this.m_hwpprogress={URL:"",x:0,y:0,domDiv:null};this.m_excelprogress={URL:"",x:0,y:0,domDiv:null};this.m_saveprogress={URL:"",x:0,y:0,domDiv:null};this.m_endreportprogress={is_visible:false,URL:"",x:0,y:0,domDiv:null};this.m_endPrintProgressEvent=null;this.saveOptionVisible={excel:true,excelx:true,pdf:true,hwp:true,rtf:true,ppt:true,pptx:true,html:false,hancell:true,html5:true,doc:true,docx:true,jpg:false,txt:false,tif:false,multiTif:false,excelData:false,brl:false,hanshow:true};this.adobe9Permission=false;this.adobeMessage={is_message:false,message:"",bottomMessage:"",firefoxMessage:"",edgeMessage:""};this.adobeInfoButton={isSave:false,isCancel:false,isOk:false,saveMsg:"",cancelMsg:"",okMsg:"",saveStyle:"",cancelStyle:"",okStyle:""};this.defaultSaveOption=typeof window.getDefaultSaveOption!="undefined"?getDefaultSaveOption():"excel";this.m_defaultSaveExcelOp=null;this.m_defaultSaveExcelxOp=null;this.m_defaultSavePDFOp=null;this.m_defaultSaveHWPOp=null;this.m_defaultSaveRTFOp=null;this.m_defaultSavePPTOp=null;this.m_defaultSavePPTXOp=null;this.m_defaultSaveHTMLOp=null;this.m_defaultSaveHanCellOp=null;this.m_defaultSaveHTML5Op=null;this.m_defaultSaveDOCOp=null;this.m_defaultSaveDOCXOp=null;this.m_defaultSaveJPGOp=null;this.m_defaultSaveTIFOp=null;this.m_defaultSaveMultiTIFOp=null;this.m_defaultSaveExcelDataOp=null;this.m_saveDirectPDFOp=null;this.m_saveDirectHWPOp=null;this.m_saveDirectDOCOp=null;this.m_saveDirectExcelOp=null;this.printOptionValue={isNetPrint:false,localStorage:mRe_getLocalStorage("mRe_print_report"),pageCount:1,startNum:0,endNum:0,netPrintList:[]};this.splitPDFFileNames=[];var c=location.pathname.lastIndexOf("/");var a="/";if(0!=c){a=location.pathname.substring(0,c);}this.clientPath=a;this.m_versionInfo=null;this.m_webViewVersionInfo=null;this.m_reportInfo_view=null;this.m_saveInfo_view=null;this.m_printInfo_view=null;this.m_popupViewDiv=null;this.m_limitedPrint=null;this.m_isAccessibility=false;this.m_fileDownLoadServerCheck=true;this.m_buttonEvent={startSaveButton:null,startPDFButton:null,startExcelButton:null,startHWPButton:null,startDOCButton:null,startPrintButton:null,startCloseButton:null,startFirstButton:null,startPrevButton:null,startNextButton:null,startLastButton:null,startZoomInSelect:null,startPageCountLabel:null,endSaveButton:null,endPDFButton:null,endExcelButton:null,endHWPButton:null,endDOCButton:null,printOkButton:null,printCancelButton:null,closeDoodleButton:null,PDFPrintAlertCloseButton:null,PDFPrintAlertOkButton:null};this.m_pageMoveEvent={start:null,end:null};this.m_exePrintEvent={ok:null,cancel:null};this.m_disControl={save:false,prev:false,next:false,first:false,last:false,print:false,close:false,pdf:false,hwp:false,excel:false,reportInfo:false,zoomIn:false,input:false,caption:false,doodle:false,setting:false,memo:false};this.m_strFileName="report";this.m_strAppendFileName="";this.m_isPaintImage=false;this.m_isUseOriginImage=false;this.m_pdfLink=null;this.m_exeLink=null;this.isPDFPrintImage=false;this.isPDFPrintBarcodeAWT=false;this.m_printPage={pageWidth:2100,pageHeight:2970};this.isChromePrintFitToPage=false;this.isEnabledAdobeRead=true;this.m_isMarkAny=false;this.m_isRedBC=false;this.m_isChartToImage=false;this.pESaveButtonVisible=true;this.m_isPrintPop=false;this.m_firefoxPrint={isPopup:true,width:750,height:600};this.m_mobile={scrollTop:false};this.m_pcView={scrollTop:false};this.m_scrollEv={isScrollPaging:false,isBottomEvent:null};this.m_drilingTop=null;this.m_comboNames={num50:{name:"50%",visible:true},num75:{name:"75%",visible:true},num100:{name:"100%",visible:true},num125:{name:"125%",visible:true},num150:{name:"150%",visible:true},num200:{name:"200%",visible:true},num300:{name:"300%",visible:false},num400:{name:"400%",visible:false},pagewidth:{name:"PageWidth",visible:true},wholepage:{name:"WholePage",visible:true}};this.m_signOption={offsetLeft:0,offsetTop:0,staticPos:false,staticLeft:null,staticTop:null};this.m_necessaryCheck=false;this.m_debug={isDebug:false,isConsole:false,isLock:false,message:null};this.m_editOp=true;this.is_eForm=false;this.is_eFormData=false;this.eForm_isNecessary={pageList:null,check:false,is_start:false};this.eFormData=null;this.eFormCheckImage=null;this.eFormRadioImage=null;this.eFormControlList=null;this.eFormControlGroupList=null;this.eFormDoodleOption={is_Ds:false,is_eraser:false,is_eraser_down:false,is_down:false,is_move:false,zoomIn:1,tos:null,path:null,pathArray:null,gesture:{isStart:false,pos:null,zoom:1,line:0,zoomUp:1},pens:{width:16,color:"rgb(237, 68, 61)",op:0.5},tempPens:{width:16,color:"rgb(237, 68, 61)",op:0.5,penList:[],opList:[],colorList:[]},pagePathSave:[],pageImgSave:[],okButtonEvent:null,cancelButtonEvent:null};this.printNames={pdf:"PDF",hwp:"HWP",html:"HTML",exe:"EXE"};this.m_selectPageType={print:1,save:1,printCustom:false,printStart:1,printEnd:1,saveCustom:false,saveStart:1,saveEnd:1};this.m_exePrintStatus={url:"http://127.0.0.1:",port:[22000,33000,11000],httpPort:[22000,33000,11000],httpsPort:[22443,33443,11443],intervalKey:null,disConnectCount:0,isSet:false,portNumber:null};this.m_exePrintOption={isPrintPopup:true,printName:"",tray:"",startNumber:1,endNumber:-1,copies:1,option:""};this.m_isViewer=true;this.m_TPC={before:"/ ",after:""};this.m_isTOCVisible=false;this.m_isSwipe=false;this.m_PageMove={eformPCButton:false,ButtonDisabled:true,isStatic:false,leftDOM:null,rightDOM:null,eventKey:null,doubleEventKey:null};this.m_firefox_Reevent=null;this.m_bodyWidth=document.body.offsetWidth;this.m_is_eform_nextPage=false;this.m_isCrossDomainPDF=false;this.m_html_info=null;this.m_ignorePDFObject=false;this.m_splitPage=0;this.m_is_serverSaveFile=true;this.m_syncPageServletPath=null;this.m_isHybridProgress=false;this.m_txtExtension="txt";this.m_isPopupSaveDownload=false;this.m_isObjJSONSVG=false;if(typeof window.report_version!="undefined"){if(-1!=window.report_version.indexOf("5.")){this.m_isObjJSONSVG=true;}}this.m_isMakePrintHTMLFrame=false;this.m_isObjJSONViewType=(is_ie9||is_ie10)?"svg":"canvas";this.m_isObjJSONViewAccessibility=false;this.m_nObjJSONViewAccLevel=0;this.m_isJsonAllPage=false;this.m_saveJsonDoc=null;this.m_saveJsonDocPageList=null;this.m_isPopupPrintView=false;this.isMain=true;this.m_PDFPopupPrintInfoDisplay=true;this.m_isOldHTMLPrint=false;this.m_properties=function(){};this.m_isCustomViewPort=false;this.m_objReportCheck={isCheck:false,maxCount:50,checkCount:0,callbackFunc:null};this.m_exeOption={isMirroringInternalEvent:true,isMobile:false,isTab:false,isVirtualKeyboardKeyPressedSetInputText:false,isSelectBoxAct:false,isCalendarAct:false};this.m_marginAlert=true;this.isSearchWord=false;this.m_isMemoEnabled=false;this.m_menuCustomButton=new Array();this.useOfficePassword=false;this.filePageCountList=[];this.isMemoExport=false;this.nMemoTransparency=1;this.m_disabledMenu=false;this.m_postParam=null;this.isWheelPrev=false;this.swipeOption={isDisabled:true,is_start:false,s_x:0,s_y:0,e_x:0,e_y:0};this.m_beforePageMoveEvent=null;this.mRe_wheelTimeout=null;}function mRe_getFontCSSNameList(){var l=new Array();try{if(null!=document.styleSheets){for(var f=0;f<document.styleSheets.length;f++){var h=document.styleSheets[f];if(null!=h.href){if(-1!=h.href.indexOf("font")){if(null!=h.cssRules){for(var c=0;c<h.cssRules.length;c++){var a="";if(is_firefox){var k=/font\-family\:.+\;/g;var d=k.exec(h.cssRules[c].style.cssText);if(null!=d){var b=d[0];k=/font\-family(\s|)\:(\s|)\"/g;a=b.replace(k,"").replace(/\"\;/g,"");}}else{a=h.cssRules[c].style.fontFamily;}if(""!=a){l.push(a);}}}}}}}}catch(g){ReportWebLog(g.stack);}return l;}Report.prototype.saveExportView=function(){this.disabledMenu(true);this.m_popupViewDiv=document.createElement("div");this.m_popupViewDiv.className="report_popup_view";this.m_bodyDiv.appendChild(this.m_popupViewDiv);var d=document.createElement("div");d.className="report_save_view_position report_view_box";var a=new Array();a.push("<div style='position:absolute;left:15px;right:15px;top:5%;height:15%;border:1px solid darkgray'>");a.push("<select title='"+this.m_languageMap.fileType+"' onChange=\"m_reportHashMap['"+this.m_uid+"'].mRe_selectExportType(this)\" style='position:absolute;left:10px;top:15px;width:70%;height:50%;font-size:9pt;'>");var b=["excel","excelx","pdf","hwp","rtf","ppt","pptx","html","html5","hancell","doc","jpg","txt","tif","multiTif","excelData","docx","brl","hanshow"];if((typeof window.ReportSaveMenuOrder!="undefined")){b=ReportSaveMenuOrder();}for(var c=0;c<b.length;c++){if(this.saveOptionVisible.excel&&b[c]=="excel"){a.push("<option value='1' ");a.push((this.defaultSaveOption=="excel"?"selected":""));a.push(">"+this.m_languageMap.excel_save+"(*.xls)</option>");}if(this.saveOptionVisible.excelx&&b[c]=="excelx"){a.push("<option value='10' ");a.push((this.defaultSaveOption=="excelx"?"selected":""));a.push(">"+this.m_languageMap.excel_save+"(*.xlsx)</option>");}if(this.saveOptionVisible.pdf&&b[c]=="pdf"){a.push("<option value='2' ");a.push((this.defaultSaveOption=="pdf"?"selected":""));a.push(">"+this.m_languageMap.pdf_save+"(*.pdf)</option>");}if(this.saveOptionVisible.hwp&&b[c]=="hwp"){a.push("<option value='3' ");a.push((this.defaultSaveOption=="hwp"?"selected":""));a.push(">"+this.m_languageMap.hwp_save+"(*.hwp)</option>");}if(this.saveOptionVisible.rtf&&b[c]=="rtf"){a.push("<option value='4' ");a.push((this.defaultSaveOption=="rtf"?"selected":""));a.push(">"+this.m_languageMap.rtf_save+"(*.rtf)</option>");}if(this.saveOptionVisible.ppt&&b[c]=="ppt"){a.push("<option value='5' ");a.push((this.defaultSaveOption=="ppt"?"selected":""));a.push(">"+this.m_languageMap.ppt_save+"(*.ppt)</option>");}if(this.saveOptionVisible.pptx&&b[c]=="pptx"){a.push("<option value='17' ");a.push((this.defaultSaveOption=="pptx"?"selected":""));a.push(">"+this.m_languageMap.pptx_save+"(*.pptx)</option>");}if(this.saveOptionVisible.html&&b[c]=="html"){a.push("<option value='6' ");a.push((this.defaultSaveOption=="html"?"selected":""));a.push(">"+this.m_languageMap.html_save+"(*.html)</option>");}if(this.saveOptionVisible.hancell&&b[c]=="hancell"){a.push("<option value='7' ");a.push((this.defaultSaveOption=="hancell"?"selected":""));a.push(">"+this.m_languageMap.hancell_save+"(*.cell)</option>");}if(this.saveOptionVisible.html5&&b[c]=="html5"){a.push("<option value='8' ");a.push((this.defaultSaveOption=="html5"?"selected":""));a.push(">"+this.m_languageMap.html5_save+"(*.html)</option>");}if(this.saveOptionVisible.doc&&b[c]=="doc"){a.push("<option value='9' ");a.push((this.defaultSaveOption=="doc"?"selected":""));a.push(">"+this.m_languageMap.doc_save+"(*.doc)</option>");}if(this.saveOptionVisible.jpg&&b[c]=="jpg"){a.push("<option value='11' ");a.push((this.defaultSaveOption=="jpg"?"selected":""));a.push(">"+this.m_languageMap.jpg_save+"(*.jpg)</option>");}if(this.saveOptionVisible.txt&&b[c]=="txt"){a.push("<option value='12' ");a.push((this.defaultSaveOption=="txt"?"selected":""));a.push(">"+this.m_languageMap.txt_save+"(*.txt)</option>");}if(this.saveOptionVisible.tif&&b[c]=="tif"){a.push("<option value='13' ");a.push((this.defaultSaveOption=="tif"?"selected":""));a.push(">"+this.m_languageMap.tif_save+"(*.tif)</option>");}if(this.saveOptionVisible.multiTif&&b[c]=="multiTif"){a.push("<option value='14' ");a.push((this.defaultSaveOption=="multiTif"?"selected":""));a.push(">Multi "+this.m_languageMap.tif_save+"(*.tif)</option>");}if(this.saveOptionVisible.excelData&&b[c]=="excelData"){a.push("<option value='15' ");a.push((this.defaultSaveOption=="excelData"?"selected":""));a.push("> "+this.m_languageMap.excelData_save+"(*.xls)</option>");}if(this.saveOptionVisible.docx&&b[c]=="docx"){a.push("<option value='16' ");a.push((this.defaultSaveOption=="docx"?"selected":""));a.push(">"+this.m_languageMap.docx_save+"(*.docx)</option>");}if(this.saveOptionVisible.brl&&b[c]=="brl"){a.push("<option value='18' ");a.push((this.defaultSaveOption=="brl"?"selected":""));a.push(">"+this.m_languageMap.brl_save+"(*.brl)</option>");}if(this.saveOptionVisible.hanshow&&b[c]=="hanshow"){a.push("<option value='19' ");a.push((this.defaultSaveOption=="hanshow"?"selected":""));a.push(">"+this.m_languageMap.hanshow_save+"(*.show)</option>");}}a.push("</select>");a.push("<button title='"+this.m_languageMap.propertys+"' onclick=\"m_reportHashMap['"+this.m_uid+"'].mRe_editOptionInfo();return false;\" class='report_view_button' style='position:absolute;right:10px;top:15px;width:20%;height:50%;font-size:8pt'><nobr>"+this.m_languageMap.propertys+"</nobr></button>");a.push("</div>");a.push("<div style='position:absolute;left:15px;right:15px;top:27%;height:15%;border:1px solid darkgray'>");a.push("<input title='"+this.m_languageMap.fileName+"' type='text' style='position:absolute;left:10px;top:12px;width:90%;height:45%;padding-left:5px' value=''/>");a.push("</div>");a.push("<div style='position:absolute;left:15px;right:15px;top:50%;height:34%;border:1px solid darkgray'>");a.push("<table style='position:absolute;top:15px'>");a.push("<tr><td aria-label='"+this.m_languageMap.total_page+"' title='"+this.m_languageMap.total_page+"' style='cursor:default' onclick=\"m_reportHashMap['"+this.m_uid+"'].mRe_selectSaveRange(1);\" onkeypress=mKey_selectSaveRange(event,'"+this.m_uid+"',1); tabindex='0'>");a.push("<input title='"+this.m_languageMap.total_page+"' name='m_ReSelectRange' type='radio' value='1' tabindex='-1' "+(this.m_selectPageType.save==1?"checked":"")+"/>"+this.m_languageMap.total_page);if(this.m_pageCount>this.m_splitPage&&0!=this.m_splitPage){a.push("<font style='color:red'> ("+this.m_splitPage+" ");a.push(this.m_languageMap.splitPage);a.push(")</font>");}a.push("</td></tr>");a.push("<tr><td aria-label='"+this.m_languageMap.currentPage+"' title='"+this.m_languageMap.currentPage+"' style='cursor:default' onclick=\"m_reportHashMap['"+this.m_uid+"'].mRe_selectSaveRange(2);\" onkeypress=mKey_selectSaveRange(event,'"+this.m_uid+"',2); tabindex='0'>");a.push("<input title='"+this.m_languageMap.currentPage+"' name='m_ReSelectRange' type='radio' tabindex='-1' value='2' "+(this.m_selectPageType.save==2?"checked":"")+"/>"+this.m_languageMap.currentPage+"</td></tr>");a.push("<tr><td aria-label='"+this.m_languageMap.page_designation+"' title='"+this.m_languageMap.page_designation+"' style='cursor:default' onclick=\"m_reportHashMap['"+this.m_uid+"'].mRe_selectSaveRange(3);\" onkeypress=mKey_selectSaveRange(event,'"+this.m_uid+"',3); tabindex='0'>");a.push("<input title='"+this.m_languageMap.page_designation+"' name='m_ReSelectRange' type='radio' tabindex='-1' value='3' "+(this.m_selectPageType.save==3?"checked":"")+"/>"+this.m_languageMap.page_designation+"</td></tr>");a.push("<tr><td style='padding-left:25px;padding-top:5px'>");var g=1;var f=this.m_pageCount;if(this.m_selectPageType.saveCustom){g=this.m_selectPageType.saveStart;f=this.m_selectPageType.saveEnd;}a.push("<input title='"+this.m_languageMap.from+"' type='text' style='width:40px' value='"+g+"' "+(this.m_selectPageType.save!=3?"disabled":"")+"/>"+this.m_languageMap.from+" &nbsp;&nbsp;&nbsp;");a.push("<input title='"+this.m_languageMap.to+"' type='text' style='width:40px' value='"+f+"' "+(this.m_selectPageType.save!=3?"disabled":"")+"/>"+this.m_languageMap.to+"");a.push("</td></tr>");a.push("</table>");a.push("</div>");a.push("<span class='report_view_box' style='position:absolute;left:20px;top:3%;border:0;'>"+this.m_languageMap.fileType+"</span>");a.push("<span class='report_view_box' style='position:absolute;left:20px;top:25%;border:0;'>"+this.m_languageMap.fileName+"</span>");a.push("<span class='report_view_box' style='position:absolute;left:20px;top:48%;border:0;'>"+this.m_languageMap.save_range+"</span>");a.push("<button onclick=\"m_reportHashMap['"+this.m_uid+"'].saveExportFileInfo();return false;\" title='"+this.m_languageMap.save+"' class='report_view_button' style='position:absolute;bottom:5px;right:95px; height:30px;width:75px;'>"+this.m_languageMap.save+"</button>");a.push("<button onclick=\"m_reportHashMap['"+this.m_uid+"'].mRe_closeReportSaveInfo();return false;\" title='"+this.m_languageMap.cancel+"' class='report_view_button' style='position:absolute;bottom:5px;right:15px; height:30px;width:75px;'>"+this.m_languageMap.cancel+"</button>");a.push("<span style='position:absolute;left:16px;top:82%;font-size:8pt;color:red'></span>");d.innerHTML=a.join("");a=null;this.m_popupViewDiv.appendChild(d);this.mRe_setViewDomInfo(d);if(this.saveOptionVisible.excel&&this.defaultSaveOption=="excel"){this.m_saveInfo_view.child_option.json_data=this.m_defaultSaveExcelOp!=null?this.m_defaultSaveExcelOp:mRe_getDefaultSaveExcelOption("xls");this.makeExcelSaveOptionWindow();}if(this.saveOptionVisible.excelx&&this.defaultSaveOption=="excelx"){this.m_saveInfo_view.child_option.json_data=this.m_defaultSaveExcelxOp!=null?this.m_defaultSaveExcelxOp:mRe_getDefaultSaveExcelOption("xlsx");this.makeExcelSaveOptionWindow();}else{if(this.saveOptionVisible.pdf&&this.defaultSaveOption=="pdf"){this.m_saveInfo_view.child_option.json_data=this.m_defaultSavePDFOp!=null?this.m_defaultSavePDFOp:mRe_getDefaultSavePDFOption();mRe_setPDFFileList(this.m_saveInfo_view.child_option.json_data,this.splitPDFFileNames);this.makePDFSaveOptionWindow();this.m_saveInfo_view.child_option.json_data.memoExport=this.isMemoExport;this.m_saveInfo_view.child_option.json_data.memoTransparency=this.nMemoTransparency;}else{if(this.saveOptionVisible.hwp&&this.defaultSaveOption=="hwp"){this.m_saveInfo_view.child_option.json_data=this.m_defaultSaveHWPOp!=null?this.m_defaultSaveHWPOp:mRe_getDefaultSaveHWPOption();this.makeHWPSaveOptionWindow();}else{if(this.saveOptionVisible.rtf&&this.defaultSaveOption=="rtf"){this.m_saveInfo_view.child_option.json_data=this.m_defaultSaveRTFOp!=null?this.m_defaultSaveRTFOp:mRe_getDefaultSaveRTFOption("rtf");this.makeRTFSaveOptionWindow(false);}else{if(this.saveOptionVisible.ppt&&this.defaultSaveOption=="ppt"){this.m_saveInfo_view.child_option.json_data=this.m_defaultSavePPTOp!=null?this.m_defaultSavePPTOp:mRe_getDefaultSavePPTOption();this.makePPTSaveOptionWindow();}else{if(this.saveOptionVisible.pptx&&this.defaultSaveOption=="pptx"){this.m_saveInfo_view.child_option.json_data=this.m_defaultSavePPTXOp!=null?this.m_defaultSavePPTXOp:mRe_getDefaultSavePPTXOption();this.makePPTXSaveOptionWindow();}else{if(this.saveOptionVisible.html&&this.defaultSaveOption=="html"){this.m_saveInfo_view.child_option.json_data=this.m_defaultSaveHTMLOp!=null?this.m_defaultSaveHTMLOp:mRe_getDefaultSaveHTMLOption();}else{if(this.saveOptionVisible.hancell&&this.defaultSaveOption=="hancell"){this.m_saveInfo_view.child_option.json_data=this.m_defaultSaveHanCellOp!=null?this.m_defaultSaveHanCellOp:mRe_getDefaultSaveExcelOption("cell");this.makeExcelSaveOptionWindow();}else{if(this.saveOptionVisible.html5&&this.defaultSaveOption=="html5"){this.m_saveInfo_view.child_option.json_data=this.m_defaultSaveHTML5Op!=null?this.m_defaultSaveHTML5Op:mRe_getDefaultSaveHTML5Option();this.makeHTML5SaveOptionWindow();}else{if(this.saveOptionVisible.doc&&this.defaultSaveOption=="doc"){this.m_saveInfo_view.child_option.json_data=this.m_defaultSaveDOCOp!=null?this.m_defaultSaveDOCOp:mRe_getDefaultSaveRTFOption("doc");this.makeRTFSaveOptionWindow(false);}else{if(this.saveOptionVisible.jpg&&this.defaultSaveOption=="jpg"){this.m_saveInfo_view.child_option.json_data=this.m_defaultSaveJPGOp!=null?this.m_defaultSaveJPGOp:mRe_getDefaultSaveJPGOption();this.makeJPGSaveOptionWindow();}else{if(this.saveOptionVisible.txt&&this.defaultSaveOption=="txt"){this.m_saveInfo_view.child_option.json_data={};}else{if(this.saveOptionVisible.tif&&this.defaultSaveOption=="tif"){this.m_saveInfo_view.child_option.json_data=this.m_defaultSaveTIFOp!=null?this.m_defaultSaveTIFOp:mRe_getDefaultSaveTIFOption();this.makeTIFSaveOptionWindow();}else{if(this.saveOptionVisible.multiTif&&this.defaultSaveOption=="multiTif"){this.m_saveInfo_view.child_option.json_data=this.m_defaultSaveMultiTIFOp!=null?this.m_defaultSaveMultiTIFOp:mRe_getDefaultSaveMultiTIFOption();this.makeMultiTIFSaveOptionWindow();}else{if(this.saveOptionVisible.excelData&&this.defaultSaveOption=="excelData"){this.m_saveInfo_view.child_option.json_data=this.m_defaultSaveExcelDataOp!=null?this.m_defaultSaveExcelDataOp:mRe_getDefaultSaveExcelDataOption();this.makeExcelDataSaveOptionWindow();}else{if(this.saveOptionVisible.docx&&this.defaultSaveOption=="docx"){this.m_saveInfo_view.child_option.json_data=this.m_defaultSaveDOCXOp!=null?this.m_defaultSaveDOCXOp:mRe_getDefaultSaveRTFOption("docx");this.makeRTFSaveOptionWindow(true);}else{if(this.saveOptionVisible.brl&&this.defaultSaveOption=="brl"){this.m_saveInfo_view.child_option.json_data={};}else{if(this.saveOptionVisible.hanshow&&this.defaultSaveOption=="hanshow"){this.m_saveInfo_view.child_option.json_data=this.m_defaultSavePPTXOp!=null?this.m_defaultSavePPTXOp:mRe_getDefaultSavePPTXOption();this.makePPTXSaveOptionWindow();}}}}}}}}}}}}}}}}}}};Report.prototype.saveExportFileInfo=function(){this.m_isButtonLock=false;if(null!=this.m_saveInfo_view){if(this.saveViewValidationCheck()){this.makeExportSaveOption();this.submitSaveOption();this.mRe_closeReportSaveInfo();this.disabledMenu(true);}}};Report.prototype.makeExportSaveOption=function(){var b=this.m_saveInfo_view;var a=new Object();a.exportType=Number(b.fileTypeDom.value);a.name=mCR_Base64.encode(encodeURIComponent(b.fileNameDom.value+this.m_strAppendFileName));if(b.check1Dom.checked){a.pageType=1;a.startNum=1;a.endNum=this.m_pageCount;}else{if(b.check2Dom.checked){a.pageType=2;a.startNum=this.beforePageIndex+1;a.endNum=this.beforePageIndex+1;}else{a.pageType=3;a.startNum=Number(b.startInDom.value);a.endNum=Number(b.endInDom.value);}}a.option=b.child_option.json_data;if(null==a.option){a.option={};}this.m_saveInfo_view.json_data=a;b=null;a=null;};Report.prototype.submitSaveOption=function(){this.debugMeg("report log :: 파일 저장 시작..");this.createSAVEProgress();if(null!=this.m_saveInfo_view.json_data){var a=this.m_pageCount>this.m_splitPage?this.m_splitPage:0;if(null!=this.m_saveInfo_view.json_data.option){this.m_saveInfo_view.json_data.option.splitPage=a;}if(this.m_saveInfo_view.json_data.exportType==12){this.m_saveInfo_view.json_data.option.extension=this.m_txtExtension;}}var c="R09";var f="R09";if(this.m_is_serverSaveFile){c="R09S1";f="R09S3";}var d="ClipID="+c+"&clipUID="+this.m_uid+"&uid="+this.m_uid+"&path="+escape(this.clientPath)+"&optionValue="+encodeURIComponent(JSON.stringify(this.m_saveInfo_view.json_data))+"&exportN="+encodeURIComponent(this.m_saveInfo_view.json_data.name)+"&exportType="+this.m_saveInfo_view.json_data.exportType+"&is_ie="+((!is_firefox)&&(!is_safari)&&(!is_apple));if(this.m_postParam!=null){d+=this.m_postParam.getParam();}this.saveFormTag.acceptCharset="UTF-8";this.saveFormTag.clipid.value=f;this.saveFormTag.uid.value=this.m_uid;this.saveFormTag.clipUID.value=this.m_uid;this.saveFormTag.path.value=this.clientPath;if(null!=this.m_saveInfo_view.json_data){this.saveFormTag.option.value=JSON.stringify(this.m_saveInfo_view.json_data);}else{this.saveFormTag.option.value="";}this.saveFormTag.filename.value=encodeURIComponent(this.m_saveInfo_view.json_data.name);this.saveFormTag.filetype.value=this.m_saveInfo_view.json_data.exportType;this.debugMeg("report log :: 파일 저장 옵션 check >> "+m_getSaveFormTag(this.saveFormTag));if(this.m_is_serverSaveFile){if(this.mRe_serverSaveFileOption(d)){this.mRe_saveFile_progress_check();}else{this.debugMeg("report log :: 서버에 파일 저장에 문제가 발생하였습니다. 서버 로그를 확인하세요.");}}else{var b=true;if(window.onSaveBeforeSend!=null){b=onSaveBeforeSend(this,d,"save");}if(b){this.mRe_saveFile_demon();this.mRe_saveFile_progress_check();}}};Report.prototype.mRe_serverSaveFileOption=function(h){try{var a=mRe_onBeforeSend(h);var f=this.servletPath;var c=new HttpClient();var b=c.send(f,a,false,null);b=mRe_onAfterSend(b);var d=objectCall(ClipStrTrim(b));if(typeof d=="string"){d=objectCall(d);}return d.status;}catch(g){mRe_ReportWebLog(g.stack);}return false;};Report.prototype.mRe_saveFile_progress_check=function(c){if(typeof c=="undefined"){c=0;}var a=this;var b=this.m_uid;var d=c==1?"error_save":"save";if(a.m_fileDownLoadServerCheck){this.fileDownloadCheckTimer=window.setTimeout(function(){a.fileCheckSend(d);},1000);}};Report.prototype.mRe_saveFile_demon=function(){if(-1!=this.servletPath.indexOf("?")){if(is_smartphone){window.open(whiteListCheck(this.servletPath)+"&"+m_getSaveFormTag(this.saveFormTag));}else{var a=document.getElementById("re_iframe"+this.m_uid);if(null!=a){a.src=whiteListCheck(this.servletPath)+"&"+m_getSaveFormTag(this.saveFormTag);}}}else{this.saveFormTag.form.action=this.servletPath;if(is_smartphone||this.m_isPopupSaveDownload){this.saveFormTag.form.target="_blank";}else{this.saveFormTag.form.target="re_target"+this.m_uid;}this.saveFormTag.form.submit();}};Report.prototype.saveViewValidationCheck=function(){var c=this.m_saveInfo_view;var d=c.fileNameDom.value;d=d.replace(/(^\s*)|(\s*$)/gi,"");if(""==d){c.validationDom.innerHTML=this.m_languageMap.printName_validation;c=null;return false;}else{if(c.check3Dom.checked){var b=Number(c.startInDom.value);var a=Number(c.endInDom.value);if(isNaN(b)||isNaN(a)){c.validationDom.innerHTML=this.m_languageMap.printNum_validation;c=null;return false;}else{if(b<=0.9||a<=0.9||b>a||b>this.m_pageCount||a>this.m_pageCount){c.validationDom.innerHTML=this.m_languageMap.printNum_validation;c=null;return false;}}}}c=null;return true;};Report.prototype.mRe_setViewDomInfo=function(b){this.m_saveInfo_view=new Object();this.m_saveInfo_view.child_option=new Object();var c=this.m_saveInfo_view;c.viewDom=b;var a=b.firstChild;c.validationDom=b.lastChild;c.cancelButtonDom=c.validationDom.previousSibling;c.saveButtonDom=c.cancelButtonDom.previousSibling;c.fileTypeDom=a.firstChild;c.detailButtonDom=a.lastChild;a=a.nextSibling;c.fileNameDom=a.firstChild;c.fileNameDom.value=this.m_strFileName;a=a.nextSibling.firstChild.lastChild.firstChild;c.check1Dom=a.firstChild.firstChild;c.check1TdDom=a.firstChild;a=a.nextSibling;c.check2Dom=a.firstChild.firstChild;c.check2TdDom=a.firstChild;a=a.nextSibling;c.check3Dom=a.firstChild.firstChild;c.check3TdDom=a.firstChild;a=a.nextSibling.firstChild.firstChild;c.startInDom=a;a=a.nextSibling.nextSibling;c.endInDom=a;c.fileTypeDom.focus();a=null;c=null;};Report.prototype.mRe_disabledViewDomInfo=function(b){var a=this.m_saveInfo_view;a.cancelButtonDom.disabled=b;a.saveButtonDom.disabled=b;a.fileTypeDom.disabled=b;a.fileNameDom.disabled=b;a.check1Dom.disabled=b;a.check2Dom.disabled=b;a.check3Dom.disabled=b;if(b){a.check1TdDom.tabIndex=-1;a.check2TdDom.tabIndex=-1;a.check3TdDom.tabIndex=-1;a.startInDom.disabled=b;a.endInDom.disabled=b;}else{a.check1TdDom.tabIndex=0;a.check2TdDom.tabIndex=0;a.check3TdDom.tabIndex=0;if(a.check3Dom.checked){a.startInDom.disabled=b;a.endInDom.disabled=b;}a.fileTypeDom.focus();}};Report.prototype.mRe_editOptionInfo=function(){this.mRe_disabledViewDomInfo(true);this.editOptionInfo(this.m_saveInfo_view.fileTypeDom.value);};Report.prototype.editOptionInfo=function(a){this.m_editOp=true;var b=Number(a);switch(b){case 1:this.mRe_disabledExcelViewDomInfo(false);break;case 2:this.mRe_disabledPDFViewDomInfo(false);break;case 3:this.mRe_disabledHWPViewDomInfo(false);break;case 4:this.mRe_disabledRTFViewDomInfo(false);break;case 5:this.mRe_disabledPPTViewDomInfo(false);break;case 6:this.mRe_disabledHTMLViewDomInfo(false);break;case 7:this.mRe_disabledExcelViewDomInfo(false);break;case 8:this.mRe_disabledHTML5ViewDomInfo(false);break;case 9:this.mRe_disabledRTFViewDomInfo(false);break;case 10:this.mRe_disabledExcelViewDomInfo(false);break;case 11:this.mRe_disabledJPGViewDomInfo(false);break;case 13:this.mRe_disabledTIFViewDomInfo(false);break;case 14:this.mRe_disabledMultiTIFViewDomInfo(false);break;case 15:this.mRe_disabledExcelDataViewDomInfo(false);break;case 16:this.mRe_disabledRTFViewDomInfo(false);break;case 17:case 19:this.mRe_disabledPPTXViewDomInfo(false);break;default:break;}};Report.prototype.mRe_selectSaveRange=function(a){if(this.m_saveInfo_view.check1Dom.disabled){return;}if(1==a){this.m_saveInfo_view.check1Dom.checked=true;this.m_saveInfo_view.startInDom.disabled=true;this.m_saveInfo_view.endInDom.disabled=true;}else{if(2==a){this.m_saveInfo_view.check2Dom.checked=true;this.m_saveInfo_view.startInDom.disabled=true;this.m_saveInfo_view.endInDom.disabled=true;}else{this.m_saveInfo_view.check3Dom.checked=true;this.m_saveInfo_view.startInDom.disabled=false;this.m_saveInfo_view.endInDom.disabled=false;}}};Report.prototype.mRe_selectExportType=function(a){var d=Number(a.value);var c=this.m_saveInfo_view.child_option;var b=this.m_saveInfo_view.detailButtonDom;if(null!=c.viewDom){this.m_popupViewDiv.removeChild(c.viewDom);}this.m_saveInfo_view.child_option=new Object();c=this.m_saveInfo_view.child_option;b.disabled=false;switch(d){case 1:c.json_data=this.m_defaultSaveExcelOp!=null?this.m_defaultSaveExcelOp:mRe_getDefaultSaveExcelOption("xls");this.makeExcelSaveOptionWindow();break;case 2:c.json_data=this.m_defaultSavePDFOp!=null?this.m_defaultSavePDFOp:mRe_getDefaultSavePDFOption();mRe_setPDFFileList(c.json_data,this.splitPDFFileNames);this.makePDFSaveOptionWindow();c.json_data.memoExport=this.isMemoExport;c.json_data.memoTransparency=this.nMemoTransparency;break;case 3:c.json_data=this.m_defaultSaveHWPOp!=null?this.m_defaultSaveHWPOp:mRe_getDefaultSaveHWPOption();this.makeHWPSaveOptionWindow();break;case 4:c.json_data=this.m_defaultSaveRTFOp!=null?this.m_defaultSaveRTFOp:mRe_getDefaultSaveRTFOption("rtf");this.makeRTFSaveOptionWindow(false);break;case 5:c.json_data=this.m_defaultSavePPTOp!=null?this.m_defaultSavePPTOp:mRe_getDefaultSavePPTOption();this.makePPTSaveOptionWindow();break;case 17:c.json_data=this.m_defaultSavePPTXOp!=null?this.m_defaultSavePPTXOp:mRe_getDefaultSavePPTXOption();this.makePPTXSaveOptionWindow();break;case 6:c.json_data=this.m_defaultSaveHTMLOp!=null?this.m_defaultSaveHTMLOp:mRe_getDefaultSaveHTMLOption();break;case 7:c.json_data=this.m_defaultSaveHanCellOp!=null?this.m_defaultSaveHanCellOp:mRe_getDefaultSaveExcelOption("cell");this.makeExcelSaveOptionWindow();break;case 8:c.json_data=this.m_defaultSaveHTML5Op!=null?this.m_defaultSaveHTML5Op:mRe_getDefaultSaveHTML5Option();this.makeHTML5SaveOptionWindow();break;case 9:c.json_data=this.m_defaultSaveDOCOp!=null?this.m_defaultSaveDOCOp:mRe_getDefaultSaveRTFOption("doc");this.makeRTFSaveOptionWindow(false);break;case 10:c.json_data=this.m_defaultSaveExcelxOp!=null?this.m_defaultSaveExcelxOp:mRe_getDefaultSaveExcelOption("xlsx");this.makeExcelSaveOptionWindow();break;case 11:c.json_data=this.m_defaultSaveJPGOp!=null?this.m_defaultSaveJPGOp:mRe_getDefaultSaveJPGOption();this.makeJPGSaveOptionWindow();break;case 12:c.json_data=null;b.disabled=true;break;case 13:c.json_data=this.m_defaultSaveTIFOp!=null?this.m_defaultSaveTIFOp:mRe_getDefaultSaveTIFOption();this.makeTIFSaveOptionWindow();break;case 14:c.json_data=this.m_defaultSaveMultiTIFOp!=null?this.m_defaultSaveMultiTIFOp:mRe_getDefaultSaveMultiTIFOption();this.makeMultiTIFSaveOptionWindow();break;case 15:c.json_data=this.m_defaultSaveExcelDataOp!=null?this.m_defaultSaveExcelDataOp:mRe_getDefaultSaveExcelDataOption();this.makeExcelDataSaveOptionWindow();break;case 16:c.json_data=this.m_defaultSaveDOCXOp!=null?this.m_defaultSaveDOCXOp:mRe_getDefaultSaveRTFOption("docx");this.makeRTFSaveOptionWindow(true);break;case 18:c.json_data=null;b.disabled=true;break;case 19:c.json_data=this.m_defaultSavePPTXOp!=null?this.m_defaultSavePPTXOp:mRe_getDefaultSavePPTXOption();this.makePPTXSaveOptionWindow();break;default:break;}};Report.prototype.mRe_closeReportSaveInfo=function(){this.m_isButtonLock=false;if(null!=this.m_popupViewDiv){this.m_bodyDiv.removeChild(this.m_popupViewDiv);this.m_popupViewDiv=null;}this.m_saveInfo_view=null;this.disabledMenu(false);if(null!=this.save_button){this.save_button.focus();}};Report.prototype.makeExcelSaveOptionWindow=function(){this.m_editOp=false;var f=this.m_saveInfo_view.child_option.json_data;var c=document.createElement("div");c.className="report_saveExcel_view_position report_view_box";var b=new Array();b.push("<div style='position:absolute;left:13px;right:15px;top:5%;height:30%;'>");b.push("<select onChange=\"m_reportHashMap['"+this.m_uid+"'].mRe_selectExcelExportMethod(this)\" title='"+this.m_languageMap.sheet_type+"' style='position:absolute;right:0px;width:75%;height:25px;font-size:9pt;' disabled>");b.push("<option value='1' "+(f.exportMethod==1?"selected":"")+">"+this.m_languageMap.sheet_type1+"</option>");b.push("<option value='2' "+(f.exportMethod==2?"selected":"")+">"+this.m_languageMap.sheet_type2+"</option>");b.push("<option value='3' "+(f.exportMethod==3?"selected":"")+">"+this.m_languageMap.sheet_type3+"</option>");b.push("<option value='5' "+(f.exportMethod==5?"selected":"")+">"+this.m_languageMap.sheet_type5+"</option>");b.push("<option value='4' "+(f.exportMethod==4?"selected":"")+">"+this.m_languageMap.sheet_type4+"</option>");b.push("</select>");b.push("<table style='position:absolute;top:30px;cursor:default' cellpadding='0' cellspacing='0' border='0'>");b.push("<tr><td valign='middle' onclick=\"m_reportHashMap['"+this.m_uid+"'].mRe_selectExcelOpCheck();\"><input title='"+this.m_languageMap.merge_cell+"' type='checkbox' "+(f.mergeCell?"checked":"")+" disabled/>"+this.m_languageMap.merge_cell+"</td></tr>");b.push("<tr><td style='padding-left:15px' valign='middle'><input title='"+this.m_languageMap.merge_EmptyCell+"' type='checkbox' "+(f.mergeEmptyCell?"checked":"")+" disabled/>"+this.m_languageMap.merge_EmptyCell+"</td></tr>");b.push("<tr><td valign='middle'><input title='"+this.m_languageMap.cell_Separated+"' type='checkbox' "+(f.splitCellAtPageSize?"checked":"")+" disabled/>"+this.m_languageMap.cell_Separated+"</td></tr>");b.push("<tr><td valign='middle'><input title='"+this.m_languageMap.rightToLeft+"' type='checkbox' "+(f.rightToLeft?"checked":"")+" disabled/>"+this.m_languageMap.rightToLeft+"</td></tr>");b.push("<tr><td valign='middle'><input title='"+this.m_languageMap.fitToPageWhenPrinting+"' type='checkbox' "+(f.fitToPageWhenPrinting?"checked":"")+" disabled/>"+this.m_languageMap.fitToPageWhenPrinting+"</td></tr>");b.push("<tr><td valign='middle'><input title='"+this.m_languageMap.removeHyperlink+"' type='checkbox' "+(f.removeHyperlink?"checked":"")+" disabled/>"+this.m_languageMap.removeHyperlink+"</td></tr>");b.push("<tr style='display:none;'><td valign='middle'><input title='"+this.m_languageMap.repeatPageSectionWhenAllSectionInOneSheet+"' type='checkbox' "+(f.repeatPageSectionWhenAllSectionInOneSheet?"checked":"")+" disabled/>"+this.m_languageMap.repeatPageSectionWhenAllSectionInOneSheet+"</td></tr>");b.push("<tr><td valign='middle'><input title='"+this.m_languageMap.useSubreportNameAsSheetName+"' type='checkbox' "+(f.useSubreportNameAsSheetName?"checked":"")+" disabled/>"+this.m_languageMap.useSubreportNameAsSheetName+"</td></tr>");b.push("<tr><td valign='middle'><input title='"+this.m_languageMap.clearEmptySubSection+"' type='checkbox' "+(f.clearEmptySubSection?"checked":"")+" disabled/>"+this.m_languageMap.clearEmptySubSection+"</td></tr>");b.push("<tr><td valign='middle'><input title='"+this.m_languageMap.clearCrosstabHeader+"' type='checkbox' "+(f.clearCrosstabHeader?"checked":"")+" disabled/>"+this.m_languageMap.clearCrosstabHeader+"</td></tr>");b.push("</table>");b.push("<span style='position:absolute;top:5px;'>"+this.m_languageMap.sheet_type+" :</span>");b.push("</div>");b.push("<div style='position:absolute;left:15px;right:15px;top:40%;height:20%;border:1px solid darkgray'>");b.push("<table style='position:absolute;top:10px;left:5px'>");b.push("<tr><td style='cursor:default'>"+this.m_languageMap.cellWidth+" : <input id='re_excelwidthRate_"+this.m_uid+"' title='"+this.m_languageMap.cellWidth+"' type='text' value='"+f.widthRate+"' maxlength='3' style='width:150px;' disabled/> %</td></tr>");b.push("<tr><td style='cursor:default'>"+this.m_languageMap.cellHeight+" : <input id='re_excelheightRate_"+this.m_uid+"' title='"+this.m_languageMap.cellHeight+"' type='text' value='"+f.heightRate+"' maxlength='3' style='width:150px;' disabled/> %</td></tr>");b.push("</table>");b.push("</div>");b.push("<div style='position:absolute;left:13px;right:15px;top:65%;height:20%;'>");b.push("<input title='"+this.m_languageMap.rangeError+"' type='text' value='"+f.coordinateErrorLimit+"' style='position:absolute;right:0px;height:18px;width:170px' disabled/>");b.push("<select title='"+this.m_languageMap.displayFormat+"' style='position:absolute;right:0px;height:23px;width:150px;top:28px;font-size:9pt;' disabled>");b.push("<option value='1' "+(f.processGerenalFormat==1?"selected":"")+">"+this.m_languageMap.text+"</option>");b.push("<option value='2' "+(f.processGerenalFormat==2?"selected":"")+">"+this.m_languageMap.normal+"</option>");b.push("</select>");b.push("<input title='"+this.m_languageMap.printRate+"' type='text' value='"+f.printingMagnification+"' style='position:absolute;top:54px;right:0px;height:18px;width:145px' maxlength='3' disabled/>");var a=this.m_language==0?5:0;b.push("<span style='position:absolute;top:"+a+"px;left:0px;width:100px'>"+this.m_languageMap.rangeError+" : </span>");b.push("<span style='position:absolute;top:33px;left:0px;width:150px'>"+this.m_languageMap.displayFormat+" : </span>");b.push("<span style='position:absolute;top:58px;left:0px;width:150px'>"+this.m_languageMap.printRate+" : </span>");var d="black";if(f.type=="xls"||!this.useOfficePassword){d="none";}b.push("<table style='position:absolute;cursor:default;bottom:1px;top: 80px;' cellpadding='0' cellspacing='0' border='0'>");b.push("<tr><td valign='middle' style='padding-top:5px;'>"+this.m_languageMap.defaultPageSheetName+" : <input id='re_exceldefaultPageSheetName_"+this.m_uid+"' title='"+this.m_languageMap.defaultPageSheetName+"' type='text' value='"+f.defaultPageSheetName+"' style='width:120px;' disabled/> </td></tr>");b.push("<tr style='display:"+d+";'><td valign='middle' style='padding-top:5px;'>"+this.m_languageMap.password+" : <input id='re_excelx1"+this.m_uid+"' value='"+f.userPassword+"' title='"+this.m_languageMap.password+"' type='password' style='width:120px;' disabled/></td></tr>");b.push("</table>");b.push("</div>");b.push("<span class='report_view_box' style='position:absolute;left:20px;top:38.5%;border:0;'>"+this.m_languageMap.cellSizeRatio+"</span>");b.push("<button title='"+this.m_languageMap.ok+"' onclick=\"m_reportHashMap['"+this.m_uid+"'].mRe_saveExcelOptionInfo();return false;\" class='report_view_button' style='position:absolute;bottom:5px;right:95px; height:30px;width:75px;visibility:hidden;'>"+this.m_languageMap.ok+"</button>");b.push("<button title='"+this.m_languageMap.cancel+"' onclick=\"m_reportHashMap['"+this.m_uid+"'].mRe_cancelExcelOptionInfo();return false;\" class='report_view_button' style='position:absolute;bottom:5px;right:15px; height:30px;width:75px;visibility:hidden;'>"+this.m_languageMap.cancel+"</button>");b.push("<span style='position:absolute;left:16px;bottom: 40px;font-size:8pt;color:red'></span>");c.innerHTML=b.join("");b=null;if(null!=this.m_popupViewDiv){this.m_popupViewDiv.appendChild(c);}this.mRe_setExcelViewDomInfo(c);};Report.prototype.mRe_setExcelViewDomInfo=function(a){var d=this.m_saveInfo_view.child_option;d.viewDom=a;var c=a.firstChild;d.validationDom=a.lastChild;d.cancelButtonDom=d.validationDom.previousSibling;d.saveButtonDom=d.cancelButtonDom.previousSibling;d.exportMethodDom=c.firstChild;var b=d.exportMethodDom.nextSibling.firstChild.firstChild;d.mergeCellDom=b.firstChild.firstChild;b=b.nextSibling;d.mergeEmptyCellDom=b.firstChild.firstChild;b=b.nextSibling;d.splitCellAtPageSizeDom=b.firstChild.firstChild;b=b.nextSibling;d.rightToLeftDom=b.firstChild.firstChild;b=b.nextSibling;d.fitToPageWhenPrintingDom=b.firstChild.firstChild;b=b.nextSibling;d.removeHyperlinkDom=b.firstChild.firstChild;b=b.nextSibling;d.repeatPageSectionWhenAllSectionInOneSheetDom=b.firstChild.firstChild;b=b.nextSibling;d.useSubreportNameAsSheetNameDom=b.firstChild.firstChild;b=b.nextSibling;d.clearEmptySubSectionDom=b.firstChild.firstChild;b=b.nextSibling;d.clearCrosstabHeaderDom=b.firstChild.firstChild;d.defaultPageSheetNameDom=document.getElementById("re_exceldefaultPageSheetName_"+this.m_uid);d.widthRateDom=document.getElementById("re_excelwidthRate_"+this.m_uid);d.heightRateDom=document.getElementById("re_excelheightRate_"+this.m_uid);c=c.nextSibling.nextSibling;d.coordinateErrorLimitDom=c.firstChild;d.processGerenalFormatDom=d.coordinateErrorLimitDom.nextSibling;d.printingMagnification=d.processGerenalFormatDom.nextSibling;d.userPasswordDom=document.getElementById("re_excelx1"+this.m_uid);b=null;c=null;d=null;};Report.prototype.mRe_disabledExcelViewDomInfo=function(b){var a=this.m_saveInfo_view.child_option;if(b){a.cancelButtonDom.style.visibility="hidden";a.saveButtonDom.style.visibility="hidden";}else{a.cancelButtonDom.style.visibility="visible";a.saveButtonDom.style.visibility="visible";}a.exportMethodDom.disabled=b;a.mergeCellDom.disabled=b;if(a.mergeCellDom.checked){a.mergeEmptyCellDom.disabled=b;}a.splitCellAtPageSizeDom.disabled=b;a.rightToLeftDom.disabled=b;a.fitToPageWhenPrintingDom.disabled=b;a.widthRateDom.disabled=b;a.heightRateDom.disabled=b;a.coordinateErrorLimitDom.disabled=b;a.processGerenalFormatDom.disabled=b;a.printingMagnification.disabled=b;a.removeHyperlinkDom.disabled=b;if(a.exportMethodDom.value=="3"||a.exportMethodDom.value=="4"){a.repeatPageSectionWhenAllSectionInOneSheetDom.disabled=b;a.clearEmptySubSectionDom.disabled=b;}a.clearCrosstabHeaderDom.disabled=b;a.useSubreportNameAsSheetNameDom.disabled=b;a.defaultPageSheetNameDom.disabled=b;a.userPasswordDom.disabled=b;};Report.prototype.mRe_selectExcelExportMethod=function(a){var b=this.m_saveInfo_view.child_option;if(a.value=="3"||a.value=="4"){b.repeatPageSectionWhenAllSectionInOneSheetDom.disabled=false;b.clearEmptySubSectionDom.disabled=false;}else{b.repeatPageSectionWhenAllSectionInOneSheetDom.disabled=true;b.clearEmptySubSectionDom.disabled=true;}};Report.prototype.mRe_cancelExcelOptionInfo=function(){this.m_popupViewDiv.removeChild(this.m_saveInfo_view.child_option.viewDom);this.makeExcelSaveOptionWindow();this.mRe_disabledViewDomInfo(false);};Report.prototype.mRe_saveExcelOptionInfo=function(){if(this.saveExcelOptionViewValidationCheck()){this.setExcelOptionValue();this.mRe_cancelExcelOptionInfo();}};Report.prototype.saveExcelOptionViewValidationCheck=function(){var b=this.m_saveInfo_view.child_option;var a=Number(b.widthRateDom.value);if(isNaN(a)){b.validationDom.innerHTML=this.m_languageMap.widthError;b=null;return false;}else{if(a<50||a>200){b.validationDom.innerHTML=this.m_languageMap.widthErrorValue;b=null;return false;}}a=Number(b.heightRateDom.value);if(isNaN(a)){b.validationDom.innerHTML=this.m_languageMap.heightError;b=null;return false;}else{if(a<50||a>200){b.validationDom.innerHTML=this.m_languageMap.heightErrorValue;b=null;return false;}}a=Number(b.coordinateErrorLimitDom.value);if(isNaN(a)||a<=0){b.validationDom.innerHTML=this.m_languageMap.coordinateError;b=null;return false;}a=Number(b.printingMagnification.value);if(isNaN(a)){b.validationDom.innerHTML=this.m_languageMap.printError;b=null;return false;}else{if(a<10||a>400){b.validationDom.innerHTML=this.m_languageMap.printErrorValue;b=null;return false;}}b=null;return true;};Report.prototype.mRe_selectExcelOpCheck=function(){var a=this.m_saveInfo_view.child_option;if(a.mergeCellDom.checked&&this.m_editOp){a.mergeEmptyCellDom.disabled=false;}else{a.mergeEmptyCellDom.checked=false;a.mergeEmptyCellDom.disabled=true;}a=null;};Report.prototype.setExcelOptionValue=function(){var b=this.m_saveInfo_view.child_option;var a=b.json_data;a.exportMethod=b.exportMethodDom.value;a.mergeCell=b.mergeCellDom.checked;a.mergeEmptyCell=b.mergeEmptyCellDom.checked;a.splitCellAtPageSize=b.splitCellAtPageSizeDom.checked;a.rightToLeft=b.rightToLeftDom.checked;a.widthRate=Number(b.widthRateDom.value);a.heightRate=Number(b.heightRateDom.value);a.coordinateErrorLimit=Number(b.coordinateErrorLimitDom.value);a.processGerenalFormat=Number(b.processGerenalFormatDom.value);a.printingMagnification=Number(b.printingMagnification.value);a.fitToPageWhenPrinting=b.fitToPageWhenPrintingDom.checked;a.removeHyperlink=b.removeHyperlinkDom.checked;a.repeatPageSectionWhenAllSectionInOneSheet=b.repeatPageSectionWhenAllSectionInOneSheetDom.checked;a.clearEmptySubSection=b.clearEmptySubSectionDom.checked;a.clearCrosstabHeader=b.clearCrosstabHeaderDom.checked;a.userPassword=b.userPasswordDom.value;a.useSubreportNameAsSheetName=b.useSubreportNameAsSheetNameDom.checked;a.defaultPageSheetName=b.defaultPageSheetNameDom.value;b=null;a=null;};function mRe_getDefaultSaveExcelOption(a){var b=null;if(("xls"==a)&&(typeof window.getDefaultSaveExcelOption!="undefined")){b=getDefaultSaveExcelOption();b.type=a;}else{if(("xlsx"==a)&&(typeof window.getDefaultSaveExcelOption!="undefined")){b=getDefaultSaveExcelxOption();b.type=a;}else{if((typeof window.getDefaultSaveHanCellOption!="undefined")){b=getDefaultSaveHanCellOption();b.type=a;}else{b={type:a,exportMethod:"1",mergeCell:true,mergeEmptyCell:false,splitCellAtPageSize:true,rightToLeft:false,widthRate:100,heightRate:100,coordinateErrorLimit:10,processGerenalFormat:1,printingMagnification:100,fitToPageWhenPrinting:false,removeHyperlink:false,repeatPageSectionWhenAllSectionInOneSheet:false,userPassword:"",useSubreportNameAsSheetName:false,defaultPageSheetName:""};}}}return b;}Report.prototype.makeHWPSaveOptionWindow=function(){this.m_editOp=false;var c=this.m_saveInfo_view.child_option.json_data;var b=document.createElement("div");b.className="report_saveHWP_view_position report_view_box";var a=new Array();a.push("<div style='position:absolute;left:13px;right:15px;top:10px;height:150px;'>");a.push("<table style='position:absolute;cursor:default' cellpadding='0' cellspacing='0' border='0'>");a.push("<tr><td valign='middle'>");a.push("<span style='position:relative;left:10px;width:130px'>"+this.m_languageMap.hwpExportMethod+" : </span>");a.push("<select id='re_hwp13"+this.m_uid+"' title='"+this.m_languageMap.hwpExportMethod+"' onChange=\"m_reportHashMap['"+this.m_uid+"'].mRe_selectHwpExportMethod(this)\" style='position:relative;left:23px;height:23px;width:105px;font-size:9pt;' disabled>");a.push("<option value='1' "+(c.hwpExportMethod==1?"selected":"")+">"+this.m_languageMap.normal+"</option>");a.push("<option value='2' "+(c.hwpExportMethod==2?"selected":"")+">"+this.m_languageMap.listTableOnly+"</option>");a.push("</select>");a.push("</td></tr>");a.push("<tr><td valign='middle' style='padding-left:15px'><input id='re_hwp14"+this.m_uid+"' title='"+this.m_languageMap.splitPageOnListTableOnly+"' type='checkbox' "+(c.splitPageOnListTableOnly?"checked":"")+" disabled/>"+this.m_languageMap.splitPageOnListTableOnly+"</td></tr>");a.push("<tr><td valign='middle' style='padding-left:15px'><input id='re_hwp1"+this.m_uid+"' title='"+this.m_languageMap.fixSize+"' type='checkbox' "+(c.fixSize?"checked":"")+" disabled/>"+this.m_languageMap.fixSize+"</td></tr>");a.push("<tr><td valign='middle' style='padding-left:15px'>");a.push("<span style='position:relative;left:10px;width:130px'>"+this.m_languageMap.positionRelTo+" : </span>");a.push("<select id='re_hwp12"+this.m_uid+"' title='"+this.m_languageMap.positionRelTo+"' onChange=\"m_reportHashMap['"+this.m_uid+"'].mRe_selectPositionRelTo(this)\" style='position:relative;left:23px;height:23px;width:105px;font-size:9pt;' disabled>");a.push("<option value='1' "+(c.positionRelTo==1?"selected":"")+">"+this.m_languageMap.paper+"</option>");a.push("<option value='2' "+(c.positionRelTo==2?"selected":"")+">"+this.m_languageMap.paragraph+"</option>");a.push("</select>");a.push("</td></tr>");a.push("<tr><td valign='middle' style='padding-left:15px'><input id='re_hwp2"+this.m_uid+"' title='"+this.m_languageMap.allowOverlay+"' type='checkbox' "+(c.allowOverlay?"checked":"")+" disabled/>"+this.m_languageMap.allowOverlay+"</td></tr>");a.push("<tr><td valign='middle' style='padding-left:15px'><input id='re_hwp10"+this.m_uid+"' title='"+this.m_languageMap.mergeTable+"' type='checkbox' "+(c.mergeTable?"checked":"")+" disabled/>"+this.m_languageMap.mergeTable+"</td></tr>");a.push("<tr><td valign='middle' style='padding-left:15px'><input id='re_hwp3"+this.m_uid+"' title='"+this.m_languageMap.setPageBottomMarginToZero+"' type='checkbox' "+(c.setPageBottomMarginToZero?"checked":"")+" disabled/>"+this.m_languageMap.setPageBottomMarginToZero+"</td></tr>");a.push("<tr><td valign='middle' style='padding-left:25px'>"+this.m_languageMap.pageBottomMarginApplicationRate+" : <input id='re_hwp15"+this.m_uid+"' title='"+this.m_languageMap.pageBottomMarginApplicationRate+"' value='"+c.pageBottomMarginApplicationRate+"' type='text' style='width:35px' maxlength='3' disabled/> %</td></tr>");a.push("<tr><td valign='middle' onclick=\"m_reportHashMap['"+this.m_uid+"'].mRe_selectHWPOpCheck()\" style='padding-left:15px'><input id='re_hwp4"+this.m_uid+"' title='"+this.m_languageMap.outputLikeWord+"' type='checkbox' "+(c.outputLikeWord?"checked":"")+" disabled/>"+this.m_languageMap.outputLikeWord+"</td></tr>");a.push("<tr><td valign='middle' style='padding-left:15px'><input id='re_hwp16"+this.m_uid+"' title='"+this.m_languageMap.insertPageNumber+"' type='checkbox' "+(c.insertPageNumber?"checked":"")+" disabled/>"+this.m_languageMap.insertPageNumber+"</td></tr>");a.push("<tr><td valign='middle' style='padding-left:15px'><input id='re_hwp17"+this.m_uid+"' title='"+this.m_languageMap.mergeAllTablesOnListTableOnly+"' type='checkbox' "+(c.mergeAllTablesOnListTableOnly?"checked":"")+" disabled/>"+this.m_languageMap.mergeAllTablesOnListTableOnly+"</td></tr>");a.push("<tr><td valign='middle' style='padding-left:15px'><input id='re_hwp18"+this.m_uid+"' title='"+this.m_languageMap.insertLabelWithTextOnListTableOnly+"' type='checkbox' "+(c.insertLabelWithTextOnListTableOnly?"checked":"")+" disabled/>"+this.m_languageMap.insertLabelWithTextOnListTableOnly+"</td></tr>");a.push("</table></div>");a.push("<div style='position:absolute;left:15px;right:15px;top:255px;height:40px;'>");a.push("<span style='position:absolute;top:3px;left:15px;width:130px'>"+this.m_languageMap.tableSplit+" : </span>");a.push("<select id='re_hwp5"+this.m_uid+"' title='"+this.m_languageMap.tableSplit+"' style='position:absolute;right:0px;height:23px;width:105px;font-size:9pt;' disabled>");a.push("<option value='1' "+(c.tableSplitMethod==1?"selected":"")+">"+this.m_languageMap.Split+"</option>");a.push("<option value='2' "+(c.tableSplitMethod==2?"selected":"")+">"+this.m_languageMap.cellSplit+"</option>");a.push("<option value='3' "+(c.tableSplitMethod==3?"selected":"")+">"+this.m_languageMap.noneSplit+"</option>");a.push("</select></div>");a.push("<div style='position:absolute;left:13px;right:15px;top:275px;height:90px;'>");a.push("<table style='position:absolute;cursor:default' cellpadding='0' cellspacing='0' border='0'>");a.push("<tr><td valign='middle'>"+this.m_languageMap.defaultCharGap+" : <input id='re_hwp6"+this.m_uid+"' title='"+this.m_languageMap.defaultCharGap+"' value='"+c.defaultCharGap+"' type='text' style='width:70px' disabled/> %</td></tr>");a.push("<tr><td valign='middle'>"+this.m_languageMap.charRatio+" : <input id='re_hwp7"+this.m_uid+"' title='"+this.m_languageMap.charRatio+"' value='"+c.charRatio+"' type='text' style='width:70px' disabled/> %</td></tr>");a.push("<tr><td valign='middle'>"+this.m_languageMap.lineSpaceRate+" : <input id='re_hwp11"+this.m_uid+"' title='"+this.m_languageMap.lineSpaceRate+"' value='"+c.lineSpaceRate+"' type='text' style='width:70px' disabled/> %</td></tr>");a.push("<tr><td valign='middle'><input id='re_hwp8"+this.m_uid+"' title='"+this.m_languageMap.putCheckboxIntoCell+"' type='checkbox' "+(c.putCheckboxIntoCell?"checked":"")+" disabled/>"+this.m_languageMap.putCheckboxIntoCell+"</td></tr>");a.push("<tr><td valign='middle'><input id='re_hwp9"+this.m_uid+"' title='"+this.m_languageMap.splitTextByLine+"' type='checkbox' "+(c.splitTextByLine?"checked":"")+" disabled/>"+this.m_languageMap.splitTextByLine+"</td></tr>");a.push("<tr><td valign='middle'><input id='re_hwp19"+this.m_uid+"' title='"+this.m_languageMap.isTransparentMode+"' type='checkbox' "+(c.isTransparentMode?"checked":"")+" disabled/>"+this.m_languageMap.isTransparentMode+"</td></tr>");a.push("</table></div>");a.push("<span style='position:absolute;left:10px;right:10px;bottom:65px;font-size:9pt;border:1px solid black;'>본 제품은 한글과컴퓨터의 한/글 문서 파일(.hwp) 공개 문서를 참고하여 개발하였습니다.</span>");a.push("<button title='"+this.m_languageMap.ok+"' onclick=\"m_reportHashMap['"+this.m_uid+"'].mRe_saveHWPOptionInfo();return false;\" class='report_view_button' style='position:absolute;bottom:5px;right:95px; height:30px;width:75px;visibility:hidden;'>"+this.m_languageMap.ok+"</button>");a.push("<button title='"+this.m_languageMap.cancel+"' onclick=\"m_reportHashMap['"+this.m_uid+"'].mRe_cancelHWPOptionInfo();return false;\" class='report_view_button' style='position:absolute;bottom:5px;right:15px; height:30px;width:75px;visibility:hidden;'>"+this.m_languageMap.cancel+"</button>");a.push("<span style='position:absolute;left:16px;bottom:45px;font-size:8pt;color:red'></span>");b.innerHTML=a.join("");a=null;if(null!=this.m_popupViewDiv){this.m_popupViewDiv.appendChild(b);}this.mRe_setHWPViewDomInfo(b);};Report.prototype.mRe_setHWPViewDomInfo=function(b){var a=this;var c=this.m_saveInfo_view.child_option;c.viewDom=b;c.validationDom=b.lastChild;c.cancelButtonDom=c.validationDom.previousSibling;c.saveButtonDom=c.cancelButtonDom.previousSibling;c.fixSizeDom=document.getElementById("re_hwp1"+this.m_uid);c.allowOverlayDom=document.getElementById("re_hwp2"+this.m_uid);c.setPageBottomMarginToZeroDom=document.getElementById("re_hwp3"+this.m_uid);c.setPageBottomMarginToZeroDom.onchange=function(){a.mRe_selectPageBottomMarginToZero();};c.outputLikeWordDom=document.getElementById("re_hwp4"+this.m_uid);c.tableSplitMethodDom=document.getElementById("re_hwp5"+this.m_uid);c.defaultCharGapDom=document.getElementById("re_hwp6"+this.m_uid);c.charRatioDom=document.getElementById("re_hwp7"+this.m_uid);c.putCheckboxIntoCellDom=document.getElementById("re_hwp8"+this.m_uid);c.splitTextByLineDom=document.getElementById("re_hwp9"+this.m_uid);c.mergeTableDom=document.getElementById("re_hwp10"+this.m_uid);c.lineSpaceRateDom=document.getElementById("re_hwp11"+this.m_uid);c.positionRelToDom=document.getElementById("re_hwp12"+this.m_uid);c.hwpExportMethodDom=document.getElementById("re_hwp13"+this.m_uid);c.splitPageOnListTableOnlyDom=document.getElementById("re_hwp14"+this.m_uid);c.pageBottomMarginApplicationRateDom=document.getElementById("re_hwp15"+this.m_uid);c.insertPageNumberDom=document.getElementById("re_hwp16"+this.m_uid);c.mergeAllTablesOnListTableOnlyDom=document.getElementById("re_hwp17"+this.m_uid);c.insertLabelWithTextOnListTableOnlyDom=document.getElementById("re_hwp18"+this.m_uid);c.isTransparentModeDom=document.getElementById("re_hwp19"+this.m_uid);c=null;};Report.prototype.mRe_selectHWPOpCheck=function(){var a=this.m_saveInfo_view.child_option;if(a.outputLikeWordDom.checked&&this.m_editOp){a.tableSplitMethodDom.disabled=false;}else{a.tableSplitMethodDom.disabled=true;}a=null;};Report.prototype.mRe_selectPageBottomMarginToZero=function(){var a=this.m_saveInfo_view.child_option;if(!a.setPageBottomMarginToZeroDom.checked&&this.m_editOp){a.pageBottomMarginApplicationRateDom.disabled=false;}else{a.pageBottomMarginApplicationRateDom.disabled=true;}a=null;};Report.prototype.mRe_selectHwpExportMethod=function(a){var b=this.m_saveInfo_view.child_option;var c=false;if(a.value=="2"){c=true;b.fixSizeDom.disabled=c;b.allowOverlayDom.disabled=c;b.positionRelToDom.disabled=c;b.setPageBottomMarginToZeroDom.disabled=c;b.outputLikeWordDom.disabled=c;b.tableSplitMethodDom.disabled=c;b.mergeTableDom.disabled=c;b.splitPageOnListTableOnlyDom.disabled=false;b.pageBottomMarginApplicationRateDom.disabled=false;b.mergeAllTablesOnListTableOnlyDom.disabled=false;b.insertLabelWithTextOnListTableOnlyDom.disabled=false;}else{b.fixSizeDom.disabled=c;if(b.positionRelToDom.value=="2"){b.allowOverlayDom.disabled=c;}b.positionRelToDom.disabled=c;b.setPageBottomMarginToZeroDom.disabled=c;if(!b.setPageBottomMarginToZeroDom.checked){b.pageBottomMarginApplicationRateDom.disabled=c;}else{b.pageBottomMarginApplicationRateDom.disabled=true;}b.outputLikeWordDom.disabled=c;if(b.outputLikeWordDom.checked){b.tableSplitMethodDom.disabled=c;}b.mergeTableDom.disabled=c;b.splitPageOnListTableOnlyDom.disabled=true;b.insertLabelWithTextOnListTableOnlyDom.disabled=true;b.isTransparentModeDom.disabled=true;}};Report.prototype.mRe_selectPositionRelTo=function(a){var b=this.m_saveInfo_view.child_option;if(a.value=="2"){b.allowOverlayDom.disabled=false;}else{b.allowOverlayDom.disabled=true;}};Report.prototype.mRe_disabledHWPViewDomInfo=function(b){var a=this.m_saveInfo_view.child_option;if(b){a.cancelButtonDom.style.visibility="hidden";a.saveButtonDom.style.visibility="hidden";}else{a.cancelButtonDom.style.visibility="visible";a.saveButtonDom.style.visibility="visible";}a.hwpExportMethodDom.disabled=b;if(a.hwpExportMethodDom.value=="1"){a.fixSizeDom.disabled=b;if(a.positionRelToDom.value=="2"){a.allowOverlayDom.disabled=b;}a.positionRelToDom.disabled=b;a.setPageBottomMarginToZeroDom.disabled=b;if(!a.setPageBottomMarginToZeroDom.checked){a.pageBottomMarginApplicationRateDom.disabled=b;}else{a.pageBottomMarginApplicationRateDom.disabled=true;}a.outputLikeWordDom.disabled=b;if(a.outputLikeWordDom.checked){a.tableSplitMethodDom.disabled=b;}a.mergeTableDom.disabled=b;}else{a.splitPageOnListTableOnlyDom.disabled=b;a.mergeAllTablesOnListTableOnlyDom.disabled=b;a.insertLabelWithTextOnListTableOnlyDom.disabled=b;a.pageBottomMarginApplicationRateDom.disabled=false;}a.defaultCharGapDom.disabled=b;a.charRatioDom.disabled=b;a.putCheckboxIntoCellDom.disabled=b;a.splitTextByLineDom.disabled=b;a.lineSpaceRateDom.disabled=b;a.insertPageNumberDom.disabled=b;a.isTransparentModeDom.disabled=b;};Report.prototype.mRe_cancelHWPOptionInfo=function(){this.m_popupViewDiv.removeChild(this.m_saveInfo_view.child_option.viewDom);this.makeHWPSaveOptionWindow();this.mRe_disabledViewDomInfo(false);};Report.prototype.mRe_saveHWPOptionInfo=function(){if(this.saveHWPOptionViewValidationCheck()){this.setHWPOptionValue();this.mRe_cancelHWPOptionInfo();}};Report.prototype.saveHWPOptionViewValidationCheck=function(){var b=this.m_saveInfo_view.child_option;var a=Number(b.defaultCharGapDom.value);if(isNaN(a)){b.validationDom.innerHTML=this.m_languageMap.defaultCharGapError;b=null;return false;}else{if(a<-50||a>50){b.validationDom.innerHTML=this.m_languageMap.defaultCharGapValueError;b=null;return false;}}a=Number(b.charRatioDom.value);if(isNaN(a)){b.validationDom.innerHTML=this.m_languageMap.charRatioError;b=null;return false;}else{if(a<50||a>200){b.validationDom.innerHTML=this.m_languageMap.charRatioValueError;b=null;return false;}}a=Number(b.pageBottomMarginApplicationRateDom.value);if(isNaN(a)){b.validationDom.innerHTML=this.m_languageMap.bottomMarginError;b=null;return false;}else{if(a<1||a>100){b.validationDom.innerHTML=this.m_languageMap.bottomMarginValueError;b=null;return false;}}b=null;return true;};Report.prototype.setHWPOptionValue=function(){var b=this.m_saveInfo_view.child_option;var a=b.json_data;a.fixSize=b.fixSizeDom.checked;a.allowOverlay=b.allowOverlayDom.checked;a.setPageBottomMarginToZero=b.setPageBottomMarginToZeroDom.checked;a.outputLikeWord=b.outputLikeWordDom.checked;a.tableSplitMethod=Number(b.tableSplitMethodDom.value);a.defaultCharGap=Number(b.defaultCharGapDom.value);a.charRatio=Number(b.charRatioDom.value);a.putCheckboxIntoCell=b.putCheckboxIntoCellDom.checked;a.splitTextByLine=b.splitTextByLineDom.checked;a.mergeTable=b.mergeTableDom.checked;a.lineSpaceRate=Number(b.lineSpaceRateDom.value);a.positionRelTo=Number(b.positionRelToDom.value);a.hwpExportMethod=Number(b.hwpExportMethodDom.value);a.splitPageOnListTableOnly=b.splitPageOnListTableOnlyDom.checked;a.pageBottomMarginApplicationRate=Number(b.pageBottomMarginApplicationRateDom.value);a.insertPageNumber=b.insertPageNumberDom.checked;a.mergeAllTablesOnListTableOnly=b.mergeAllTablesOnListTableOnlyDom.checked;a.insertLabelWithTextOnListTableOnly=b.insertLabelWithTextOnListTableOnlyDom.checked;a.isTransparentMode=b.isTransparentModeDom.checked;b=null;a=null;};function mRe_getDefaultSaveHWPOption(){var a=null;if(typeof window.getDefaultSaveHWPOption!="undefined"){a=getDefaultSaveHWPOption();}else{a={fixSize:true,allowOverlay:true,setPageBottomMarginToZero:true,outputLikeWord:false,tableSplitMethod:2,defaultCharGap:-8,charRatio:100,putCheckboxIntoCell:true,splitTextByLine:true,mergeTable:false,lineSpaceRate:100,positionRelTo:1,hwpExportMethod:1,splitPageOnListTableOnly:true,pageBottomMarginApplicationRate:100,insertPageNumber:false,mergeAllTablesOnListTableOnly:false,insertLabelWithTextOnListTableOnly:false,isTransparentMode:false,isSectionClear:false};}return a;}Report.prototype.makeRTFSaveOptionWindow=function(d){this.m_editOp=false;var c=this.m_saveInfo_view.child_option.json_data;this.m_saveInfo_view.child_option.isDocx=d;var b=document.createElement("div");b.className="report_saveRTF_view_position report_view_box";var a=new Array();a.push("<div style='position:absolute;left:13px;right:15px;top:10px;height:50px;'>");a.push("<table style='position:absolute;cursor:default' cellpadding='0' cellspacing='0' border='0'>");a.push("<tr><td valign='middle'><input id='re_rtf1"+this.m_uid+"' title='"+this.m_languageMap.splitTextLine+"' type='checkbox' "+(c.splitTextLine?"checked":"")+" disabled/>"+this.m_languageMap.splitTextLine+" </td></tr>");a.push("<tr style='display:none;'><td valign='middle'><input id='re_rtf2"+this.m_uid+"' title='"+this.m_languageMap.processAsUnicode+"' type='checkbox' "+(c.processAsUnicode?"checked":"")+" disabled/>"+this.m_languageMap.processAsUnicode+"</td></tr>");a.push("</table></div>");a.push("<div style='position:absolute;left:15px;right:15px;top:65px;height:30px;display:none;'>");a.push("<span style='position:absolute;top:3px;left:0px;width:130px'>"+this.m_languageMap.processEqualAlign+" : </span>");a.push("<select id='re_rtf3"+this.m_uid+"' title='"+this.m_languageMap.processEqualAlign+"' style='position:absolute;right:0px;height:23px;width:105px;font-size:9pt;' disabled>");a.push("<option value='1' "+(c.processEqualAlign==1?"selected":"")+">"+this.m_languageMap.soLeft+"</option>");a.push("<option value='2' "+(c.processEqualAlign==2?"selected":"")+">"+this.m_languageMap.soCenter+"</option>");a.push("<option value='3' "+(c.processEqualAlign==3?"selected":"")+">"+this.m_languageMap.soRight+"</option>");a.push("<option value='4' "+(c.processEqualAlign==4?"selected":"")+">"+this.m_languageMap.soBoth+"</option>");a.push("</select></div>");a.push("<div style='position:absolute;left:13px;right:15px;top:35px;height:140px;'>");a.push("<table style='position:absolute;cursor:default' cellpadding='0' cellspacing='0' border='0'>");a.push("<tr style='height:20px'><td valign='middle'>"+this.m_languageMap.defaultCharGap+" : <input id='re_rtf4"+this.m_uid+"' title='"+this.m_languageMap.defaultCharGap+"' type='text' value='"+c.defaultCharSpace+"' style='width:70px' disabled/> pt</td></tr>");a.push("<tr style='height:20px'><td valign='middle'><input id='re_rtf7"+this.m_uid+"' title='"+this.m_languageMap.mergeTable+"' type='checkbox' "+(c.mergeTable?"checked":"")+" disabled/>"+this.m_languageMap.mergeTable+"</td></tr>");a.push("<tr style='height:20px;"+(d?"display:none;":"")+"'><td valign='middle'><input id='re_rtf8"+this.m_uid+"' title='"+this.m_languageMap.fitShapeToText+"' type='checkbox' "+(c.fitShapeToText?"checked":"")+" disabled/>"+this.m_languageMap.fitShapeToText+"</td></tr>");a.push("<tr style='height:20px'><td valign='middle' onclick=\"m_reportHashMap['"+this.m_uid+"'].mRe_selectRTFOpCheck();\"><input id='re_rtf6"+this.m_uid+"' title='"+this.m_languageMap.insertTableWrapper+"' type='checkbox' "+(c.insertTableWrapper?"checked":"")+" disabled/>"+this.m_languageMap.insertTableWrapper+"</td></tr>");a.push("<tr style='height:20px'><td valign='middle'><span style='width:100px'>"+this.m_languageMap.tableWrapperBottomGap+" : </span>");a.push("<input id='re_rtf5"+this.m_uid+"' title='"+this.m_languageMap.tableWrapperBottomGap+"' type='text' value='"+c.tableWrapperBottomGap+"' style='width:70px;' disabled/></td></tr>");a.push("<tr style='height:20px; "+(d?"display:none;":"")+"'><td valign='middle'><span>"+this.m_languageMap.TableRowHeightSort+" : </span>");a.push("<select id='re_rtf9"+this.m_uid+"' title='"+this.m_languageMap.TableRowHeightSort+"' style='width:105px;font-size:9pt;' disabled>");a.push("<option value='1' "+(c.TableRowHeightSort==1?"selected":"")+">Fix</option>");a.push("<option value='2' "+(c.TableRowHeightSort==2?"selected":"")+">Minimum</option>");a.push("</select></td></tr>");a.push("<tr style='height:20px;"+(d?";":"display:none")+"'><td valign='middle'>"+this.m_languageMap.lineSpaceRate+" : <input id='re_rtf10"+this.m_uid+"' title='"+this.m_languageMap.lineSpaceRate+"' type='text' value='"+c.lineSpaceRate+"' style='width:70px' disabled/> %</td></tr>");a.push("<tr style='height:20px;"+(d?";":"display:none")+"'><td valign='middle'><input id='re_rtf11"+this.m_uid+"' title='"+this.m_languageMap.easyEditable+"' type='checkbox' "+(c.easyEditable?"checked":"")+" disabled/>"+this.m_languageMap.easyEditable+"</td></tr>");a.push("<tr  style='height:20px;"+((d&&this.useOfficePassword)?";":"display:none")+"'><td valign='middle' style='padding-top:5px;'>"+this.m_languageMap.password+" : <input id='re_rtf12"+this.m_uid+"' value='"+c.userPassword+"' title='"+this.m_languageMap.password+"' type='password' style='width:120px;' disabled/></td></tr>");a.push("</table></div>");a.push("<button title='"+this.m_languageMap.ok+"' onclick=\"m_reportHashMap['"+this.m_uid+"'].mRe_saveRTFOptionInfo();return false;\" class='report_view_button' style='position:absolute;bottom:5px;right:95px; height:30px;width:75px;visibility:hidden;'>"+this.m_languageMap.ok+"</button>");a.push("<button title='"+this.m_languageMap.cancel+"' onclick=\"m_reportHashMap['"+this.m_uid+"'].mRe_cancelRTFOptionInfo();return false;\" class='report_view_button' style='position:absolute;bottom:5px;right:15px; height:30px;width:75px;visibility:hidden;'>"+this.m_languageMap.cancel+"</button>");a.push("<span style='position:absolute;left:16px;top:74%;font-size:8pt;color:red'></span>");b.innerHTML=a.join("");a=null;if(null!=this.m_popupViewDiv){this.m_popupViewDiv.appendChild(b);}this.mRe_setRTFViewDomInfo(b);};Report.prototype.mRe_setRTFViewDomInfo=function(b){var a=this;var f=this.m_saveInfo_view.child_option;f.viewDom=b;f.validationDom=b.lastChild;f.cancelButtonDom=f.validationDom.previousSibling;f.saveButtonDom=f.cancelButtonDom.previousSibling;f.splitTextLineDom=document.getElementById("re_rtf1"+this.m_uid);f.processAsUnicodeDom=document.getElementById("re_rtf2"+this.m_uid);f.processEqualAlignDom=document.getElementById("re_rtf3"+this.m_uid);f.defaultCharSpaceDom=document.getElementById("re_rtf4"+this.m_uid);f.tableWrapperBottomGapDom=document.getElementById("re_rtf5"+this.m_uid);var d=f.insertTableWrapperDom=document.getElementById("re_rtf6"+this.m_uid);f.mergeTableDom=document.getElementById("re_rtf7"+this.m_uid);f.fitShapeToTextDom=document.getElementById("re_rtf8"+this.m_uid);f.TableRowHeightSortDom=document.getElementById("re_rtf9"+this.m_uid);f.lineSpaceRateDom=document.getElementById("re_rtf10"+this.m_uid);var c=f.easyEditableDom=document.getElementById("re_rtf11"+this.m_uid);f.easyEditableDom.onclick=function(){if(c.checked){d.checked=false;a.mRe_selectRTFOpCheck();}};f.userPasswordDom=document.getElementById("re_rtf12"+this.m_uid);f=null;};Report.prototype.mRe_disabledRTFViewDomInfo=function(b){var a=this.m_saveInfo_view.child_option;if(b){a.cancelButtonDom.style.visibility="hidden";a.saveButtonDom.style.visibility="hidden";}else{a.cancelButtonDom.style.visibility="visible";a.saveButtonDom.style.visibility="visible";}a.splitTextLineDom.disabled=b;a.processAsUnicodeDom.disabled=b;a.processEqualAlignDom.disabled=b;a.defaultCharSpaceDom.disabled=b;a.insertTableWrapperDom.disabled=b;if(a.insertTableWrapperDom.checked){a.tableWrapperBottomGapDom.disabled=b;}a.mergeTableDom.disabled=b;a.fitShapeToTextDom.disabled=b;a.TableRowHeightSortDom.disabled=b;a.lineSpaceRateDom.disabled=b;a.easyEditableDom.disabled=b;a.userPasswordDom.disabled=b;};Report.prototype.mRe_cancelRTFOptionInfo=function(){this.m_popupViewDiv.removeChild(this.m_saveInfo_view.child_option.viewDom);this.makeRTFSaveOptionWindow(this.m_saveInfo_view.child_option.isDocx);this.mRe_disabledViewDomInfo(false);};Report.prototype.mRe_saveRTFOptionInfo=function(){if(this.saveRTFOptionViewValidationCheck()){this.setRTFOptionValue();this.mRe_cancelRTFOptionInfo();}};Report.prototype.saveRTFOptionViewValidationCheck=function(){var b=this.m_saveInfo_view.child_option;var a=Number(b.defaultCharSpaceDom.value);if(isNaN(a)){b.validationDom.innerHTML=this.m_languageMap.defaultCharGapError;b=null;return false;}else{if(a<-3||a>3){b.validationDom.innerHTML=this.m_languageMap.defaultCharGapValue2Error;b=null;return false;}}a=Number(b.tableWrapperBottomGapDom.value);if(isNaN(a)){b.validationDom.innerHTML=this.m_languageMap.tableWrapperBottomGapError;b=null;return false;}else{if(a<0||a>500){b.validationDom.innerHTML=this.m_languageMap.tableWrapperBottomGapValueError;b=null;return false;}}b=null;return true;};Report.prototype.setRTFOptionValue=function(){var b=this.m_saveInfo_view.child_option;var a=b.json_data;a.splitTextLine=b.splitTextLineDom.checked;a.processAsUnicode=b.processAsUnicodeDom.checked;a.processEqualAlign=Number(b.processEqualAlignDom.value);a.defaultCharSpace=Number(b.defaultCharSpaceDom.value);a.tableWrapperBottomGap=Number(b.tableWrapperBottomGapDom.value);a.insertTableWrapper=b.insertTableWrapperDom.checked;a.mergeTable=b.mergeTableDom.checked;a.fitShapeToText=b.fitShapeToTextDom.checked;a.TableRowHeightSort=Number(b.TableRowHeightSortDom.value);a.lineSpaceRate=Number(b.lineSpaceRateDom.value);a.easyEditable=b.easyEditableDom.checked;a.userPassword=b.userPasswordDom.value;b=null;a=null;};Report.prototype.mRe_selectRTFOpCheck=function(){var a=this.m_saveInfo_view.child_option;if(a.insertTableWrapperDom.checked&&this.m_editOp){a.tableWrapperBottomGapDom.disabled=false;a.easyEditableDom.checked=false;}else{a.tableWrapperBottomGapDom.disabled=true;}a=null;};function mRe_getDefaultSaveRTFOption(a){var b=null;if(("rtf"==a)&&(typeof window.getDefaultSaveRTFOption!="undefined")){b=getDefaultSaveRTFOption();b.type=a;}else{if(("doc"==a)&&(typeof window.getDefaultSaveDOCOption!="undefined")){b=getDefaultSaveDOCOption();b.type=a;}else{if(("docx"==a)&&(typeof window.getDefaultSaveDOCXOption!="undefined")){b=getDefaultSaveDOCXOption();b.processAsUnicode=true;b.processEqualAlign=4;b.fitShapeToText=false;b.TableRowHeightSort=1;b.easyEditable=false;b.type=a;}else{b={type:a,splitTextLine:true,processAsUnicode:true,processEqualAlign:4,defaultCharSpace:-0.5,tableWrapperBottomGap:0,insertTableWrapper:true,mergeTable:false,fitShapeToText:false,TableRowHeightSort:1,lineSpaceRate:100,userPassword:""};}}}return b;}Report.prototype.makeHTMLSaveOptionWindow=function(){this.m_editOp=false;var c=this.m_saveInfo_view.child_option.json_data;var b=document.createElement("div");b.className="report_saveHtml_view_position report_view_box";var a=new Array();a.push("<div style='position:absolute;left:13px;right:15px;top:5%;height:30%;'>");a.push("<table style='position:absolute;top:0px;cursor:default' cellpadding='0' cellspacing='0' border='0'>");a.push("<tr><td valign='middle'><input id='re_html1"+this.m_uid+"' "+(c.processCellLikeShape?"checked":"")+" title='테이블 셀을 라벨처럼 저장' type='checkbox' disabled/>테이블 셀을 라벨처럼 저장 </td></tr>");a.push("<tr><td valign='middle'><input id='re_html2"+this.m_uid+"' "+(c.displayPageLine?"checked":"")+" title='페이지 분리선 표시' type='checkbox' disabled/>페이지 분리선 표시</td></tr>");a.push("<tr><td valign='middle'><input id='re_html3"+this.m_uid+"' "+(c.keepPageHeight?"checked":"")+" title='페이지 높이 유지' type='checkbox' disabled/>페이지 높이 유지</td></tr>");a.push("<tr><td valign='middle'><input id='re_html4"+this.m_uid+"' "+(c.applyWordBreak?"checked":"")+" title='글자 감싸기 적용' type='checkbox' disabled/>글자 감싸기 적용</td></tr>");a.push("<tr><td valign='middle'><input id='re_html5"+this.m_uid+"' "+(c.setTextProperiesToEmptyCell?"checked":"")+" title='빈 셀에 텍스트 속성 설정' type='checkbox' disabled/>빈 셀에 텍스트 속성 설정</td></tr>");a.push("<tr><td valign='middle'><input id='re_html6"+this.m_uid+"' "+(c.putTagIntoEmptyCell?"checked":"")+" title='열빈 셀에 &nbsp; 삽입' type='checkbox' disabled/>빈 셀에 & nbsp; 삽입</td></tr>");a.push("<tr><td valign='middle'><input id='re_html7"+this.m_uid+"' "+(c.textOverflowHidden?"checked":"")+" title='Overflow=flase 스타일 적용' type='checkbox' disabled/>Overflow=flase 스타일 적용</td></tr>");a.push("</table></div>");a.push("<div style='position:absolute;left:15px;right:15px;top:47%;height:20%;border:1px solid darkgray'>");a.push("<table style='position:absolute;top:10px;left:5px'>");a.push("<tr><td style='cursor:default'>X축 비율 : <input id='re_html8"+this.m_uid+"' value='"+c.coordinateRateForX+"' title='X축 비율' type='text' value='100' maxlength='3' disabled/></td></tr>");a.push("<tr><td style='cursor:default'>Y축 비율 : <input id='re_html9"+this.m_uid+"' value='"+c.coordinateRateForY+"' title='Y축 비율' type='text' value='100' maxlength='3' disabled/></td></tr>");a.push("</table></div>");a.push("<div style='position:absolute;left:13px;right:15px;top:70%;height:20%;'>");a.push("<select id='re_html10"+this.m_uid+"' title='인코딩' style='position:absolute;right:0px;height:23px;width:200px;top:8px;font-size:9pt;' disabled>");a.push("<option value='1' "+(c.encodingType==1?"selected":"")+">UTF-8</option>");a.push("<option value='2' "+(c.encodingType==2?"selected":"")+">Unicode</option>");a.push("<option value='3' "+(c.encodingType==3?"selected":"")+">EUC-KR</option>");a.push("</select>");a.push("<span style='position:absolute;top:13px;left:0px;width:150px'>인코딩 : </span></div>");a.push("<span class='report_view_box'  style='position:absolute;left:20px;top:45%;border:0;'>좌표 비율</span>");a.push("<button title='확인' onclick=\"m_reportHashMap['"+this.m_uid+"'].mRe_saveHTMLOptionInfo();return false;\" class='report_view_button' style='position:absolute;bottom:5px;right:95px; height:30px;width:75px;visibility:hidden;'>확인</button>");a.push("<button title='취소' onclick=\"m_reportHashMap['"+this.m_uid+"'].mRe_cancelHTMLOptionInfo();return false;\" class='report_view_button' style='position:absolute;bottom:5px;right:15px; height:30px;width:75px;visibility:hidden;'>취소</button>");a.push("<span style='position:absolute;left:16px;top:82%;font-size:8pt;color:red'></span>");b.innerHTML=a.join("");a=null;if(null!=this.m_popupViewDiv){this.m_popupViewDiv.appendChild(b);}this.mRe_setHTMLViewDomInfo(b);};Report.prototype.mRe_setHTMLViewDomInfo=function(a){var b=this.m_saveInfo_view.child_option;b.viewDom=a;b.validationDom=a.lastChild;b.cancelButtonDom=b.validationDom.previousSibling;b.saveButtonDom=b.cancelButtonDom.previousSibling;b.processCellLikeShapeDom=document.getElementById("re_html1"+this.m_uid);b.displayPageLineDom=document.getElementById("re_html2"+this.m_uid);b.keepPageHeightDom=document.getElementById("re_html3"+this.m_uid);b.applyWordBreakDom=document.getElementById("re_html4"+this.m_uid);b.setTextProperiesToEmptyCellDom=document.getElementById("re_html5"+this.m_uid);b.putTagIntoEmptyCellDom=document.getElementById("re_html6"+this.m_uid);b.textOverflowHiddenDom=document.getElementById("re_html7"+this.m_uid);b.coordinateRateForXDom=document.getElementById("re_html8"+this.m_uid);b.coordinateRateForYDom=document.getElementById("re_html9"+this.m_uid);b.encodingTypeDom=document.getElementById("re_html10"+this.m_uid);b=null;};Report.prototype.mRe_disabledHTMLViewDomInfo=function(b){var a=this.m_saveInfo_view.child_option;if(b){a.cancelButtonDom.style.visibility="hidden";a.saveButtonDom.style.visibility="hidden";}else{a.cancelButtonDom.style.visibility="visible";a.saveButtonDom.style.visibility="visible";}a.processCellLikeShapeDom.disabled=b;a.displayPageLineDom.disabled=b;a.keepPageHeightDom.disabled=b;a.applyWordBreakDom.disabled=b;a.setTextProperiesToEmptyCellDom.disabled=b;a.textOverflowHiddenDom.disabled=b;a.putTagIntoEmptyCellDom.disabled=b;a.coordinateRateForXDom.disabled=b;a.coordinateRateForYDom.disabled=b;a.encodingTypeDom.disabled=b;};Report.prototype.mRe_cancelHTMLOptionInfo=function(){this.m_popupViewDiv.removeChild(this.m_saveInfo_view.child_option.viewDom);this.makeHTMLSaveOptionWindow();this.mRe_disabledViewDomInfo(false);};Report.prototype.mRe_saveHTMLOptionInfo=function(){if(this.saveHTMLOptionViewValidationCheck()){this.setHTMLOptionValue();this.mRe_cancelHTMLOptionInfo();}};Report.prototype.saveHTMLOptionViewValidationCheck=function(){var b=this.m_saveInfo_view.child_option;var a=Number(b.coordinateRateForXDom.value);if(isNaN(a)){b.validationDom.innerHTML="X축 비율의 설정값이 올바르지 않습니다.";b=null;return false;}else{if(a<1||a>5){b.validationDom.innerHTML="X축 비율의 설정값은 (1.0 ~ 5.0) 가능합니다.";b=null;return false;}}a=Number(b.coordinateRateForYDom.value);if(isNaN(a)){b.validationDom.innerHTML="Y축 비율의 설정값이 올바르지 않습니다.";b=null;return false;}else{if(a<1||a>5){b.validationDom.innerHTML="Y축 비율의 설정값은 (1.0 ~ 5.0) 가능합니다.";b=null;return false;}}b=null;return true;};Report.prototype.setHTMLOptionValue=function(){var b=this.m_saveInfo_view.child_option;var a=b.json_data;a.processCellLikeShape=b.processCellLikeShapeDom.checked;a.displayPageLine=b.displayPageLineDom.checked;a.keepPageHeight=b.keepPageHeightDom.checked;a.applyWordBreak=b.applyWordBreakDom.checked;a.setTextProperiesToEmptyCell=b.setTextProperiesToEmptyCellDom.checked;a.putTagIntoEmptyCell=b.putTagIntoEmptyCellDom.checked;a.textOverflowHidden=b.textOverflowHiddenDom.checked;a.coordinateRateForX=Number(b.coordinateRateForXDom.value);a.coordinateRateForY=Number(b.coordinateRateForYDom.value);a.encodingType=Number(b.encodingTypeDom.value);b=null;a=null;};function mRe_getDefaultSaveHTMLOption(){var a=null;if(typeof window.getDefaultSaveHTMLOption!="undefined"){a=getDefaultSaveHTMLOption();}else{a={processCellLikeShape:false,displayPageLine:true,keepPageHeight:true,applyWordBreak:false,setTextProperiesToEmptyCell:false,putTagIntoEmptyCell:false,textOverflowHidden:false,coordinateRateForX:2.6,coordinateRateForY:2.6,encodingType:1};}return a;}Report.prototype.makePDFSaveOptionWindow=function(){this.m_editOp=false;var c=this.m_saveInfo_view.child_option.json_data;var b=document.createElement("div");b.className="report_savePDF_view_position report_view_box";var a=new Array();a.push("<div style='position:absolute;left:13px;right:15px;top:5%;height:70%;'>");a.push("<table style='position:absolute;cursor:default' cellpadding='0' cellspacing='0' border='0'>");a.push("<tr><td valign='middle' onclick=\"m_reportHashMap['"+this.m_uid+"'].mRe_selectPDFOpCheck();\"><input id='re_pdf1"+this.m_uid+"' "+(c.isSplite?"checked":"")+" title='"+this.m_languageMap.pageSplite+"' type='checkbox' disabled/>"+this.m_languageMap.pageSplite+"</td></tr>");a.push("<tr><td valign='middle' style='padding-left:25px;padding-top:5px;'>"+this.m_languageMap.pageSpliteCount+" : <input id='re_pdf2"+this.m_uid+"' value='"+c.spliteValue+"' title='"+this.m_languageMap.pageSpliteCount+"' type='text' style='width:40px;' disabled/></td></tr>");a.push("<tr><td valign='middle' style='padding-top:5px;'>"+this.m_languageMap.password+" : <input id='re_pdf3"+this.m_uid+"' value='"+c.userpw+"' title='"+this.m_languageMap.password+"' type='password' style='width:120px;' disabled/></td></tr>");a.push("<tr><td valign='middle'><input id='re_pdf4"+this.m_uid+"' "+(c.textToImage?"checked":"")+" title='"+this.m_languageMap.textToImage+"' type='checkbox' disabled/>"+this.m_languageMap.textToImage+"</td></tr>");a.push("<tr><td valign='middle'><input id='re_pdf6"+this.m_uid+"' "+(c.removeHyperlink?"checked":"")+" title='"+this.m_languageMap.removeHyperlink+"' type='checkbox' disabled/>"+this.m_languageMap.removeHyperlink+"</td></tr>");a.push("<tr><td valign='middle' style='visibility:hidden;'><input id='re_pdf5"+this.m_uid+"' "+(c.importOriginImage?"checked":"")+" title='"+this.m_languageMap.importOriginImage+"' type='checkbox' disabled/>"+this.m_languageMap.importOriginImage+"</td></tr>");a.push("</table>");a.push("</div>");a.push("<button title='"+this.m_languageMap.ok+"' onclick=\"m_reportHashMap['"+this.m_uid+"'].mRe_savePDFOptionInfo();return false;\" class='report_view_button' style='position:absolute;bottom:5px;right:95px; height:30px;width:75px;visibility:hidden;'>"+this.m_languageMap.ok+"</button>");a.push("<button title='"+this.m_languageMap.cancel+"' onclick=\"m_reportHashMap['"+this.m_uid+"'].mRe_cancelPDFOptionInfo();return false;\" class='report_view_button' style='position:absolute;bottom:5px;right:15px; height:30px;width:75px;visibility:hidden;'>"+this.m_languageMap.cancel+"</button>");a.push("<span style='position:absolute;left:16px;bottom:40px;font-size:8pt;color:red'></span>");b.innerHTML=a.join("");a=null;if(null!=this.m_popupViewDiv){this.m_popupViewDiv.appendChild(b);}this.mRe_setPDFViewDomInfo(b);};Report.prototype.mRe_setPDFViewDomInfo=function(a){var b=this.m_saveInfo_view.child_option;b.viewDom=a;b.validationDom=a.lastChild;b.cancelButtonDom=b.validationDom.previousSibling;b.saveButtonDom=b.cancelButtonDom.previousSibling;b.isSpliteDom=document.getElementById("re_pdf1"+this.m_uid);b.spliteValueDom=document.getElementById("re_pdf2"+this.m_uid);b.userpwDom=document.getElementById("re_pdf3"+this.m_uid);b.textToImageDom=document.getElementById("re_pdf4"+this.m_uid);b.importOriginImageDom=document.getElementById("re_pdf5"+this.m_uid);b.removeHyperlinkDom=document.getElementById("re_pdf6"+this.m_uid);b=null;};Report.prototype.mRe_disabledPDFViewDomInfo=function(b){var a=this.m_saveInfo_view.child_option;if(b){a.cancelButtonDom.style.visibility="hidden";a.saveButtonDom.style.visibility="hidden";}else{a.cancelButtonDom.style.visibility="visible";a.saveButtonDom.style.visibility="visible";}a.isSpliteDom.disabled=b;if(a.isSpliteDom.checked){a.spliteValueDom.disabled=b;}a.userpwDom.disabled=b;a.textToImageDom.disabled=b;a.importOriginImageDom.disabled=b;a.removeHyperlinkDom.disabled=b;};Report.prototype.mRe_cancelPDFOptionInfo=function(){this.m_popupViewDiv.removeChild(this.m_saveInfo_view.child_option.viewDom);this.makePDFSaveOptionWindow();this.mRe_disabledViewDomInfo(false);};Report.prototype.mRe_savePDFOptionInfo=function(){if(this.savePDFOptionViewValidationCheck()){this.setPDFOptionValue();this.mRe_cancelPDFOptionInfo();}};Report.prototype.savePDFOptionViewValidationCheck=function(){var b=this.m_saveInfo_view.child_option;var a=Number(b.spliteValueDom.value);if(isNaN(a)){b.validationDom.innerHTML=this.m_languageMap.pageSpliteCountError;b=null;return false;}b=null;return true;};Report.prototype.setPDFOptionValue=function(){var b=this.m_saveInfo_view.child_option;var a=b.json_data;a.isSplite=b.isSpliteDom.checked;a.spliteValue=Number(b.spliteValueDom.value);a.userpw=b.userpwDom.value;a.textToImage=b.textToImageDom.checked;a.importOriginImage=b.importOriginImageDom.checked;a.removeHyperlink=b.removeHyperlinkDom.checked;a.memoExport=this.isMemoExport;a.memoTransparency=this.nMemoTransparency;b=null;a=null;};Report.prototype.mRe_selectPDFOpCheck=function(){var a=this.m_saveInfo_view.child_option;if(a.isSpliteDom.checked&&this.m_editOp){a.spliteValueDom.disabled=false;}else{a.spliteValueDom.disabled=true;}a=null;};function mRe_getDefaultSavePDFOption(){var a=null;if(typeof window.getDefaultSavePDFOption!="undefined"){a=getDefaultSavePDFOption();a.fileNames=[];}else{a={isSplite:false,spliteValue:1,fileNames:[],userpw:"",textToImage:false,importOriginImage:false,removeHyperlink:false};}return a;}function mRe_setPDFFileList(d,b){if(null!=b){d.fileNames=new Array();var a=b.length;for(var c=0;c<a;c++){d.fileNames.push(Base64.encode(b[c]));}}}Report.prototype.makeHTML5SaveOptionWindow=function(){this.m_editOp=false;var c=this.m_saveInfo_view.child_option.json_data;var b=document.createElement("div");b.className="report_savePDF_view_position report_view_box";var a=new Array();a.push("<div style='position:absolute;left:13px;right:15px;top:5%;height:70%;'>");a.push("<table style='position:absolute;cursor:default' cellpadding='0' cellspacing='0' border='0'>");a.push("<tr><td valign='middle' ><input id='re_html51"+this.m_uid+"' "+(c.isSplite?"checked":"")+" title='"+this.m_languageMap.html5page+"' type='checkbox' disabled/>"+this.m_languageMap.html5page+"</td></tr>");a.push("<tr><td valign='middle' style='padding-left:10px;padding-top:5px;'>DPI : <input id='re_html52"+this.m_uid+"' value='"+c.dpiValue+"' title='DPI' type='text' style='width:40px;' value='96' disabled/></td></tr>");a.push("</table>");a.push("</div>");a.push("<button title='"+this.m_languageMap.ok+"' onclick=\"m_reportHashMap['"+this.m_uid+"'].mRe_saveHTML5OptionInfo();return false;\" class='report_view_button' style='position:absolute;bottom:5px;right:95px; height:30px;width:75px;visibility:hidden;'>"+this.m_languageMap.ok+"</button>");a.push("<button title='"+this.m_languageMap.cancel+"' onclick=\"m_reportHashMap['"+this.m_uid+"'].mRe_cancelHTML5OptionInfo();return false;\" class='report_view_button' style='position:absolute;bottom:5px;right:15px; height:30px;width:75px;visibility:hidden;'>"+this.m_languageMap.cancel+"</button>");a.push("<span style='position:absolute;left:16px;top:50%;font-size:8pt;color:red'></span>");b.innerHTML=a.join("");a=null;if(null!=this.m_popupViewDiv){this.m_popupViewDiv.appendChild(b);}this.mRe_setHTML5ViewDomInfo(b);};Report.prototype.mRe_setHTML5ViewDomInfo=function(a){var b=this.m_saveInfo_view.child_option;b.viewDom=a;b.validationDom=a.lastChild;b.cancelButtonDom=b.validationDom.previousSibling;b.saveButtonDom=b.cancelButtonDom.previousSibling;b.isSpliteDom=document.getElementById("re_html51"+this.m_uid);b.DPIDom=document.getElementById("re_html52"+this.m_uid);b=null;};Report.prototype.mRe_disabledHTML5ViewDomInfo=function(b){var a=this.m_saveInfo_view.child_option;if(b){a.cancelButtonDom.style.visibility="hidden";a.saveButtonDom.style.visibility="hidden";}else{a.cancelButtonDom.style.visibility="visible";a.saveButtonDom.style.visibility="visible";}a.isSpliteDom.disabled=b;a.DPIDom.disabled=b;};Report.prototype.mRe_cancelHTML5OptionInfo=function(){this.m_popupViewDiv.removeChild(this.m_saveInfo_view.child_option.viewDom);this.makeHTML5SaveOptionWindow();this.mRe_disabledViewDomInfo(false);};Report.prototype.mRe_saveHTML5OptionInfo=function(){if(this.saveHTML5OptionViewValidationCheck()){this.setHTML5OptionValue();this.mRe_cancelHTML5OptionInfo();}};Report.prototype.saveHTML5OptionViewValidationCheck=function(){var b=this.m_saveInfo_view.child_option;var a=Number(b.DPIDom.value);if(isNaN(a)){b.validationDom.innerHTML=this.m_languageMap.dpiError;b=null;return false;}b=null;return true;};Report.prototype.setHTML5OptionValue=function(){var b=this.m_saveInfo_view.child_option;var a=b.json_data;a.isSplite=b.isSpliteDom.checked;a.dpiValue=Number(b.DPIDom.value);b=null;a=null;};function mRe_getDefaultSaveHTML5Option(){var a=null;if(typeof window.getDefaultSaveHTML5Option!="undefined"){a=getDefaultSaveHTML5Option();}else{a={isSplite:true,DPI:96};}return a;}Report.prototype.makeJPGSaveOptionWindow=function(){this.m_editOp=false;var c=this.m_saveInfo_view.child_option.json_data;var b=document.createElement("div");b.className="report_saveJPG_view_position report_view_box";var a=new Array();a.push("<div style='position:absolute;left:13px;right:15px;top:5%;height:70%;'>");a.push("<table style='position:absolute;cursor:default' cellpadding='0' cellspacing='0' border='0'>");a.push("<tr><td valign='middle' style='padding-top:5px;'><input id='re_jpg1"+this.m_uid+"' "+(c.rotate90?"checked":"")+" title='rotate 90' type='checkbox' disabled/>rotate 90</td></tr>");a.push("<tr><td valign='middle' style='padding-top:5px;'>DPI X : <input id='re_jpg2"+this.m_uid+"' value='"+c.dpiX+"' title='DPI X' type='text' style='width:40px;' disabled/></td></tr>");a.push("<tr><td valign='middle' style='padding-top:5px;'>DPI Y : <input id='re_jpg3"+this.m_uid+"' value='"+c.dpiY+"' title='DPI Y' type='text' style='width:40px;' disabled/></td></tr>");a.push("<tr><td valign='middle' style='padding-top:5px;'>quality : <input id='re_jpg4"+this.m_uid+"' value='"+c.quality+"' title='quality' type='text' style='width:40px;' disabled/></td></tr>");a.push("</table>");a.push("</div>");a.push("<button title='"+this.m_languageMap.ok+"' onclick=\"m_reportHashMap['"+this.m_uid+"'].mRe_saveJPGOptionInfo();return false;\" class='report_view_button' style='position:absolute;bottom:5px;right:95px; height:30px;width:75px;visibility:hidden;'>"+this.m_languageMap.ok+"</button>");a.push("<button title='"+this.m_languageMap.cancel+"' onclick=\"m_reportHashMap['"+this.m_uid+"'].mRe_cancelJPGOptionInfo();return false;\" class='report_view_button' style='position:absolute;bottom:5px;right:15px; height:30px;width:75px;visibility:hidden;'>"+this.m_languageMap.cancel+"</button>");a.push("<span style='position:absolute;left:16px;bottom:40px;font-size:8pt;color:red'></span>");b.innerHTML=a.join("");a=null;if(null!=this.m_popupViewDiv){this.m_popupViewDiv.appendChild(b);}this.mRe_setJPGViewDomInfo(b);};Report.prototype.mRe_setJPGViewDomInfo=function(a){var b=this.m_saveInfo_view.child_option;b.viewDom=a;b.validationDom=a.lastChild;b.cancelButtonDom=b.validationDom.previousSibling;b.saveButtonDom=b.cancelButtonDom.previousSibling;b.rotate90Dom=document.getElementById("re_jpg1"+this.m_uid);b.dpiXDom=document.getElementById("re_jpg2"+this.m_uid);b.dpiYDom=document.getElementById("re_jpg3"+this.m_uid);b.qualityDom=document.getElementById("re_jpg4"+this.m_uid);b=null;};Report.prototype.mRe_disabledJPGViewDomInfo=function(b){var a=this.m_saveInfo_view.child_option;if(b){a.cancelButtonDom.style.visibility="hidden";a.saveButtonDom.style.visibility="hidden";}else{a.cancelButtonDom.style.visibility="visible";a.saveButtonDom.style.visibility="visible";}a.rotate90Dom.disabled=b;a.dpiXDom.disabled=b;a.dpiYDom.disabled=b;a.qualityDom.disabled=b;};Report.prototype.mRe_cancelJPGOptionInfo=function(){this.m_popupViewDiv.removeChild(this.m_saveInfo_view.child_option.viewDom);this.makeJPGSaveOptionWindow();this.mRe_disabledViewDomInfo(false);};Report.prototype.mRe_saveJPGOptionInfo=function(){if(this.saveJPGOptionViewValidationCheck()){this.setJPGOptionValue();this.mRe_cancelJPGOptionInfo();}};Report.prototype.saveJPGOptionViewValidationCheck=function(){var b=this.m_saveInfo_view.child_option;var a=Number(b.qualityDom.value);if(isNaN(a)){b.validationDom.innerHTML="quality (1 ~ 100)";b=null;return false;}b=null;return true;};Report.prototype.setJPGOptionValue=function(){var b=this.m_saveInfo_view.child_option;var a=b.json_data;a.rotate90=b.rotate90Dom.checked;a.dpiX=Number(b.dpiXDom.value);a.dpiY=Number(b.dpiYDom.value);a.quality=Number(b.qualityDom.value);b=null;a=null;};function mRe_getDefaultSaveJPGOption(){var a=null;if(typeof window.getDefaultSaveJPGOption!="undefined"){a=getDefaultSaveJPGOption();}else{a={rotate90:false,dpiX:96,dpiY:96,quality:100};}return a;}Report.prototype.makeTIFSaveOptionWindow=function(){this.m_editOp=false;var c=this.m_saveInfo_view.child_option.json_data;var b=document.createElement("div");b.className="report_saveTIF_view_position report_view_box";var a=new Array();a.push("<div style='position:absolute;left:13px;right:15px;top:5%;height:70%;'>");a.push("<table style='position:absolute;cursor:default' cellpadding='0' cellspacing='0' border='0'>");a.push("<tr><td valign='middle' style='padding-top:5px;'><input id='re_tif1"+this.m_uid+"' "+(c.rotate90?"checked":"")+" title='rotate 90' type='checkbox' disabled/>rotate 90</td></tr>");a.push("<tr><td valign='middle' style='padding-top:5px;'><input id='re_tif2"+this.m_uid+"' "+(c.blackWhite?"checked":"")+" title='blackWhite' type='checkbox' disabled/>blackWhite</td></tr>");a.push("<tr><td valign='middle' style='padding-top:5px;'><input id='re_tif5"+this.m_uid+"' "+(c.gray?"checked":"")+" title='gray' type='checkbox' disabled/>gray</td></tr>");a.push("<tr><td valign='middle' style='padding-top:5px;'>DPI X : <input id='re_tif3"+this.m_uid+"' value='"+c.dpiX+"' title='DPI X' type='text' style='width:40px;' disabled/></td></tr>");a.push("<tr><td valign='middle' style='padding-top:5px;'>DPI Y : <input id='re_tif4"+this.m_uid+"' value='"+c.dpiY+"' title='DPI Y' type='text' style='width:40px;' disabled/></td></tr>");a.push("</table>");a.push("</div>");a.push("<button title='"+this.m_languageMap.ok+"' onclick=\"m_reportHashMap['"+this.m_uid+"'].mRe_saveTIFOptionInfo();return false;\" class='report_view_button' style='position:absolute;bottom:5px;right:95px; height:30px;width:75px;visibility:hidden;'>"+this.m_languageMap.ok+"</button>");a.push("<button title='"+this.m_languageMap.cancel+"' onclick=\"m_reportHashMap['"+this.m_uid+"'].mRe_cancelTIFOptionInfo();return false;\" class='report_view_button' style='position:absolute;bottom:5px;right:15px; height:30px;width:75px;visibility:hidden;'>"+this.m_languageMap.cancel+"</button>");a.push("<span style='position:absolute;left:16px;bottom:40px;font-size:8pt;color:red'></span>");b.innerHTML=a.join("");a=null;if(null!=this.m_popupViewDiv){this.m_popupViewDiv.appendChild(b);}this.mRe_setTIFViewDomInfo(b);};Report.prototype.mRe_setTIFViewDomInfo=function(a){var b=this.m_saveInfo_view.child_option;b.viewDom=a;b.validationDom=a.lastChild;b.cancelButtonDom=b.validationDom.previousSibling;b.saveButtonDom=b.cancelButtonDom.previousSibling;b.rotate90Dom=document.getElementById("re_tif1"+this.m_uid);b.blackWhiteDom=document.getElementById("re_tif2"+this.m_uid);b.dpiXDom=document.getElementById("re_tif3"+this.m_uid);b.dpiYDom=document.getElementById("re_tif4"+this.m_uid);b.grayDom=document.getElementById("re_tif5"+this.m_uid);b=null;};Report.prototype.mRe_disabledTIFViewDomInfo=function(b){var a=this.m_saveInfo_view.child_option;if(b){a.cancelButtonDom.style.visibility="hidden";a.saveButtonDom.style.visibility="hidden";}else{a.cancelButtonDom.style.visibility="visible";a.saveButtonDom.style.visibility="visible";}a.rotate90Dom.disabled=b;a.dpiXDom.disabled=b;a.dpiYDom.disabled=b;a.blackWhiteDom.disabled=b;a.grayDom.disabled=b;};Report.prototype.mRe_cancelTIFOptionInfo=function(){this.m_popupViewDiv.removeChild(this.m_saveInfo_view.child_option.viewDom);this.makeTIFSaveOptionWindow();this.mRe_disabledViewDomInfo(false);};Report.prototype.mRe_saveTIFOptionInfo=function(){if(this.saveTIFOptionViewValidationCheck()){this.setTIFOptionValue();this.mRe_cancelTIFOptionInfo();}};Report.prototype.saveTIFOptionViewValidationCheck=function(){return true;};Report.prototype.setTIFOptionValue=function(){var b=this.m_saveInfo_view.child_option;var a=b.json_data;a.rotate90=b.rotate90Dom.checked;a.blackWhite=b.blackWhiteDom.checked;a.gray=b.grayDom.checked;a.dpiX=Number(b.dpiXDom.value);a.dpiY=Number(b.dpiYDom.value);b=null;a=null;};function mRe_getDefaultSaveTIFOption(){var a=null;if(typeof window.getDefaultSaveTIFOption!="undefined"){a=getDefaultSaveTIFOption();}else{a={rotate90:false,blackWhite:true,gray:false,dpiX:96,dpiY:96};}return a;}Report.prototype.makeMultiTIFSaveOptionWindow=function(){this.m_editOp=false;var c=this.m_saveInfo_view.child_option.json_data;var b=document.createElement("div");b.className="report_saveTIF_view_position report_view_box";var a=new Array();a.push("<div style='position:absolute;left:13px;right:15px;top:5%;height:70%;'>");a.push("<table style='position:absolute;cursor:default' cellpadding='0' cellspacing='0' border='0'>");a.push("<tr><td valign='middle' style='padding-top:5px;'><input id='re_tif1"+this.m_uid+"' "+(c.rotate90?"checked":"")+" title='rotate 90' type='checkbox' disabled/>rotate 90</td></tr>");a.push("<tr><td valign='middle' style='padding-top:5px;'><input id='re_tif2"+this.m_uid+"' "+(c.blackWhite?"checked":"")+" title='blackWhite' type='checkbox' disabled/>blackWhite</td></tr>");a.push("<tr><td valign='middle' style='padding-top:5px;'><input id='re_tif5"+this.m_uid+"' "+(c.gray?"checked":"")+" title='gray' type='checkbox' disabled/>gray</td></tr>");a.push("<tr><td valign='middle' style='padding-top:5px;'>DPI X : <input id='re_tif3"+this.m_uid+"' value='"+c.dpiX+"' title='DPI X' type='text' style='width:40px;' disabled/></td></tr>");a.push("<tr><td valign='middle' style='padding-top:5px;'>DPI Y : <input id='re_tif4"+this.m_uid+"' value='"+c.dpiY+"' title='DPI Y' type='text' style='width:40px;' disabled/></td></tr>");a.push("</table>");a.push("</div>");a.push("<button title='"+this.m_languageMap.ok+"' onclick=\"m_reportHashMap['"+this.m_uid+"'].mRe_saveMultiTIFOptionInfo();return false;\" class='report_view_button' style='position:absolute;bottom:5px;right:95px; height:30px;width:75px;visibility:hidden;'>"+this.m_languageMap.ok+"</button>");a.push("<button title='"+this.m_languageMap.cancel+"' onclick=\"m_reportHashMap['"+this.m_uid+"'].mRe_cancelMultiTIFOptionInfo();return false;\" class='report_view_button' style='position:absolute;bottom:5px;right:15px; height:30px;width:75px;visibility:hidden;'>"+this.m_languageMap.cancel+"</button>");a.push("<span style='position:absolute;left:16px;bottom:40px;font-size:8pt;color:red'></span>");b.innerHTML=a.join("");a=null;if(null!=this.m_popupViewDiv){this.m_popupViewDiv.appendChild(b);}this.mRe_setMultiTIFViewDomInfo(b);};Report.prototype.mRe_setMultiTIFViewDomInfo=function(a){var b=this.m_saveInfo_view.child_option;b.viewDom=a;b.validationDom=a.lastChild;b.cancelButtonDom=b.validationDom.previousSibling;b.saveButtonDom=b.cancelButtonDom.previousSibling;b.rotate90Dom=document.getElementById("re_tif1"+this.m_uid);b.blackWhiteDom=document.getElementById("re_tif2"+this.m_uid);b.grayDom=document.getElementById("re_tif5"+this.m_uid);b.dpiXDom=document.getElementById("re_tif3"+this.m_uid);b.dpiYDom=document.getElementById("re_tif4"+this.m_uid);b=null;};Report.prototype.mRe_disabledMultiTIFViewDomInfo=function(b){var a=this.m_saveInfo_view.child_option;if(b){a.cancelButtonDom.style.visibility="hidden";a.saveButtonDom.style.visibility="hidden";}else{a.cancelButtonDom.style.visibility="visible";a.saveButtonDom.style.visibility="visible";}a.rotate90Dom.disabled=b;a.dpiXDom.disabled=b;a.dpiYDom.disabled=b;a.blackWhiteDom.disabled=b;a.grayDom.disabled=b;};Report.prototype.mRe_cancelMultiTIFOptionInfo=function(){this.m_popupViewDiv.removeChild(this.m_saveInfo_view.child_option.viewDom);this.makeMultiTIFSaveOptionWindow();this.mRe_disabledViewDomInfo(false);};Report.prototype.mRe_saveMultiTIFOptionInfo=function(){if(this.saveMultiTIFOptionViewValidationCheck()){this.setMultiTIFOptionValue();this.mRe_cancelMultiTIFOptionInfo();}};Report.prototype.saveMultiTIFOptionViewValidationCheck=function(){return true;};Report.prototype.setMultiTIFOptionValue=function(){var b=this.m_saveInfo_view.child_option;var a=b.json_data;a.rotate90=b.rotate90Dom.checked;a.blackWhite=b.blackWhiteDom.checked;a.gray=b.grayDom.checked;a.dpiX=Number(b.dpiXDom.value);a.dpiY=Number(b.dpiYDom.value);b=null;a=null;};function mRe_getDefaultSaveMultiTIFOption(){var a=null;if(typeof window.getDefaultSaveMultiTIFOption!="undefined"){a=getDefaultSaveMultiTIFOption();}else{a={rotate90:false,blackWhite:true,gray:false,dpiX:96,dpiY:96};}return a;}Report.prototype.makePPTSaveOptionWindow=function(){this.m_editOp=false;var c=this.m_saveInfo_view.child_option.json_data;var b=document.createElement("div");b.className="report_savePPT_view_position report_view_box";var a=new Array();a.push("<div style='position:absolute;left:13px;right:15px;top:5%;height:70%;'>");a.push("<table style='position:absolute;cursor:default' cellpadding='0' cellspacing='0' border='0'>");a.push("<tr><td valign='middle' style='padding-top:5px;'><input id='re_ppt1"+this.m_uid+"' "+(c.mergeTable?"checked":"")+" title='"+this.m_languageMap.mergeTable+"' type='checkbox' disabled/>"+this.m_languageMap.mergeTable+"</td></tr>");a.push("<tr><td valign='middle' style='padding-top:5px;'><input id='re_ppt2"+this.m_uid+"' "+(c.ignoreLineSpace?"checked":"")+" title='"+this.m_languageMap.ignoreLineSpace+"' type='checkbox' disabled/>"+this.m_languageMap.ignoreLineSpace+"</td></tr>");a.push("<tr><td valign='middle' style='padding-top:5px;'><input id='re_ppt3"+this.m_uid+"' "+(c.removeHyperlink?"checked":"")+" title='"+this.m_languageMap.removeHyperlink+"' type='checkbox' disabled/>"+this.m_languageMap.removeHyperlink+"</td></tr>");a.push("</table>");a.push("</div>");a.push("<button title='"+this.m_languageMap.ok+"' onclick=\"m_reportHashMap['"+this.m_uid+"'].mRe_savePPTOptionInfo();return false;\" class='report_view_button' style='position:absolute;bottom:5px;right:95px; height:30px;width:75px;visibility:hidden;'>"+this.m_languageMap.ok+"</button>");a.push("<button title='"+this.m_languageMap.cancel+"' onclick=\"m_reportHashMap['"+this.m_uid+"'].mRe_cancelPPTOptionInfo();return false;\" class='report_view_button' style='position:absolute;bottom:5px;right:15px; height:30px;width:75px;visibility:hidden;'>"+this.m_languageMap.cancel+"</button>");a.push("<span style='position:absolute;left:16px;bottom:40px;font-size:8pt;color:red'></span>");b.innerHTML=a.join("");a=null;if(null!=this.m_popupViewDiv){this.m_popupViewDiv.appendChild(b);}this.mRe_setPPTViewDomInfo(b);};Report.prototype.mRe_setPPTViewDomInfo=function(a){var b=this.m_saveInfo_view.child_option;b.viewDom=a;b.validationDom=a.lastChild;b.cancelButtonDom=b.validationDom.previousSibling;b.saveButtonDom=b.cancelButtonDom.previousSibling;b.mergeTableDom=document.getElementById("re_ppt1"+this.m_uid);b.ignoreLineSpaceDom=document.getElementById("re_ppt2"+this.m_uid);b.removeHyperlinkDom=document.getElementById("re_ppt3"+this.m_uid);b=null;};Report.prototype.mRe_disabledPPTViewDomInfo=function(b){var a=this.m_saveInfo_view.child_option;if(b){a.cancelButtonDom.style.visibility="hidden";a.saveButtonDom.style.visibility="hidden";}else{a.cancelButtonDom.style.visibility="visible";a.saveButtonDom.style.visibility="visible";}a.mergeTableDom.disabled=b;a.ignoreLineSpaceDom.disabled=b;a.removeHyperlinkDom.disabled=b;};Report.prototype.mRe_cancelPPTOptionInfo=function(){this.m_popupViewDiv.removeChild(this.m_saveInfo_view.child_option.viewDom);this.makePPTSaveOptionWindow();this.mRe_disabledViewDomInfo(false);};Report.prototype.mRe_savePPTOptionInfo=function(){this.setPPTOptionValue();this.mRe_cancelPPTOptionInfo();};Report.prototype.setPPTOptionValue=function(){var b=this.m_saveInfo_view.child_option;var a=b.json_data;a.mergeTable=b.mergeTableDom.checked;a.ignoreLineSpace=b.ignoreLineSpaceDom.checked;a.removeHyperlink=b.removeHyperlinkDom.checked;b=null;a=null;};function mRe_getDefaultSavePPTOption(){var a=null;if(typeof window.getDefaultSavePPTOption!="undefined"){a=getDefaultSavePPTOption();}else{a={mergeTable:false,ignoreLineSpace:true,removeHyperlink:false};}return a;}Report.prototype.makePPTXSaveOptionWindow=function(){this.m_editOp=false;var c=this.m_saveInfo_view.child_option.json_data;var b=document.createElement("div");b.className="report_savePPTX_view_position report_view_box";var a=new Array();a.push("<div style='position:absolute;left:13px;right:15px;top:5%;height:70%;'>");a.push("<table style='position:absolute;cursor:default' cellpadding='0' cellspacing='0' border='0'>");a.push("<tr><td valign='middle' style='padding-top:5px;'><input id='re_pptx1"+this.m_uid+"' "+(c.mergeTable?"checked":"")+" title='"+this.m_languageMap.mergeTable+"' type='checkbox' disabled/>"+this.m_languageMap.mergeTable+"</td></tr>");a.push("<tr><td valign='middle' style='padding-top:5px;'><input id='re_pptx2"+this.m_uid+"' "+(c.splitTextByLine?"checked":"")+" title='"+this.m_languageMap.splitTextByLine+"' type='checkbox' disabled/>"+this.m_languageMap.splitTextByLine+"</td></tr>");a.push("<tr><td valign='middle' style='padding-top:5px;'><input id='re_pptx3"+this.m_uid+"' "+(c.removeHyperlink?"checked":"")+" title='"+this.m_languageMap.removeHyperlink+"' type='checkbox' disabled/>"+this.m_languageMap.removeHyperlink+"</td></tr>");a.push("<tr><td valign='middle'>"+this.m_languageMap.defaultCharGap+" : <input id='re_pptx4"+this.m_uid+"' title='"+this.m_languageMap.defaultCharGap+"' value='"+c.defaultCharGap+"' type='text' style='width:70px' disabled/> %</td></tr>");a.push("<tr><td valign='middle'>"+this.m_languageMap.lineSpaceRate+" : <input id='re_pptx5"+this.m_uid+"' title='"+this.m_languageMap.lineSpaceRate+"' value='"+c.lineSpaceRate+"' type='text' style='width:70px' disabled/> %</td></tr>");a.push("<tr><td valign='middle' style='padding-top:5px;'><input id='re_pptx6"+this.m_uid+"' "+(c.putCheckboxIntoCell?"checked":"")+" title='"+this.m_languageMap.putCheckboxIntoCell+"' type='checkbox' disabled/>"+this.m_languageMap.putCheckboxIntoCell+"</td></tr>");a.push("</table>");a.push("</div>");a.push("<button title='"+this.m_languageMap.ok+"' onclick=\"m_reportHashMap['"+this.m_uid+"'].mRe_savePPTXOptionInfo();return false;\" class='report_view_button' style='position:absolute;bottom:5px;right:95px; height:30px;width:75px;visibility:hidden;'>"+this.m_languageMap.ok+"</button>");a.push("<button title='"+this.m_languageMap.cancel+"' onclick=\"m_reportHashMap['"+this.m_uid+"'].mRe_cancelPPTXOptionInfo();return false;\" class='report_view_button' style='position:absolute;bottom:5px;right:15px; height:30px;width:75px;visibility:hidden;'>"+this.m_languageMap.cancel+"</button>");a.push("<span style='position:absolute;left:16px;bottom:40px;font-size:8pt;color:red'></span>");b.innerHTML=a.join("");a=null;if(null!=this.m_popupViewDiv){this.m_popupViewDiv.appendChild(b);}this.mRe_setPPTXViewDomInfo(b);};Report.prototype.mRe_setPPTXViewDomInfo=function(a){var b=this.m_saveInfo_view.child_option;b.viewDom=a;b.validationDom=a.lastChild;b.cancelButtonDom=b.validationDom.previousSibling;b.saveButtonDom=b.cancelButtonDom.previousSibling;b.mergeTableDom=document.getElementById("re_pptx1"+this.m_uid);b.splitTextByLineDom=document.getElementById("re_pptx2"+this.m_uid);b.removeHyperlinkDom=document.getElementById("re_pptx3"+this.m_uid);b.defaultCharGapDom=document.getElementById("re_pptx4"+this.m_uid);b.lineSpaceRateDom=document.getElementById("re_pptx5"+this.m_uid);b.putCheckboxIntoCellDom=document.getElementById("re_pptx6"+this.m_uid);b=null;};Report.prototype.mRe_disabledPPTXViewDomInfo=function(b){var a=this.m_saveInfo_view.child_option;if(b){a.cancelButtonDom.style.visibility="hidden";a.saveButtonDom.style.visibility="hidden";}else{a.cancelButtonDom.style.visibility="visible";a.saveButtonDom.style.visibility="visible";}a.mergeTableDom.disabled=b;a.splitTextByLineDom.disabled=b;a.removeHyperlinkDom.disabled=b;a.defaultCharGapDom.disabled=b;a.lineSpaceRateDom.disabled=b;a.putCheckboxIntoCellDom.disabled=b;};Report.prototype.mRe_cancelPPTXOptionInfo=function(){this.m_popupViewDiv.removeChild(this.m_saveInfo_view.child_option.viewDom);this.makePPTXSaveOptionWindow();this.mRe_disabledViewDomInfo(false);};Report.prototype.mRe_savePPTXOptionInfo=function(){this.setPPTXOptionValue();this.mRe_cancelPPTXOptionInfo();};Report.prototype.setPPTXOptionValue=function(){var b=this.m_saveInfo_view.child_option;var a=b.json_data;a.mergeTable=b.mergeTableDom.checked;a.splitTextByLine=b.splitTextByLineDom.checked;a.removeHyperlink=b.removeHyperlinkDom.checked;a.defaultCharGap=Number(b.defaultCharGapDom.value);a.lineSpaceRate=Number(b.lineSpaceRateDom.value);a.putCheckboxIntoCell=b.putCheckboxIntoCellDom.checked;b=null;a=null;};function mRe_getDefaultSavePPTXOption(){var a=null;if(typeof window.getDefaultSavePPTXOption!="undefined"){a=getDefaultSavePPTXOption();}else{a={mergeTable:false,splitTextByLine:false,removeHyperlink:false,defaultCharGap:0,lineSpaceRate:0,putCheckboxIntoCell:false};}return a;}Report.prototype.makeExcelDataSaveOptionWindow=function(){this.m_editOp=false;var c=this.m_saveInfo_view.child_option.json_data;var b=document.createElement("div");b.className="report_saveEXCELDATA_view_position report_view_box";var a=new Array();a.push("<div style='position:absolute;left:13px;right:15px;top:5%;height:70%;'>");a.push("<table style='position:absolute;cursor:default' cellpadding='0' cellspacing='0' border='0'>");a.push("<tr><td valign='middle' style='padding-top:5px;'>"+this.m_languageMap.repeatPageSectionWhenAllSectionInOneSheet+" :</td>");a.push("<td valign='middle' style='padding-top:5px;padding-left:5px'>");a.push("<select id='re_excelData1"+this.m_uid+"' title='"+this.m_languageMap.repeatPageSectionWhenAllSectionInOneSheet+"' style='right:0px;height:23px;width:105px;font-size:9pt;' disabled>");a.push("<option value='0' "+(c.outputPageSectionMethod==0?"selected":"")+">"+this.m_languageMap.excelDataNone+"</option>");a.push("<option value='1' "+(c.outputPageSectionMethod==1?"selected":"")+">"+this.m_languageMap.excelDataAtOnce+"</option>");a.push("<option value='2' "+(c.outputPageSectionMethod==2?"selected":"")+">"+this.m_languageMap.excelDataRepeatAtEachPage+"</option>");("</tr>");a.push("</table>");a.push("</div>");a.push("<button title='"+this.m_languageMap.ok+"' onclick=\"m_reportHashMap['"+this.m_uid+"'].mRe_saveExcelDataOptionInfo();return false;\" class='report_view_button' style='position:absolute;bottom:5px;right:95px; height:30px;width:75px;visibility:hidden;'>"+this.m_languageMap.ok+"</button>");a.push("<button title='"+this.m_languageMap.cancel+"' onclick=\"m_reportHashMap['"+this.m_uid+"'].mRe_cancelExcelDataOptionInfo();return false;\" class='report_view_button' style='position:absolute;bottom:5px;right:15px; height:30px;width:75px;visibility:hidden;'>"+this.m_languageMap.cancel+"</button>");a.push("<span style='position:absolute;left:16px;bottom:40px;font-size:8pt;color:red'></span>");b.innerHTML=a.join("");a=null;if(null!=this.m_popupViewDiv){this.m_popupViewDiv.appendChild(b);}this.mRe_setExcelDataViewDomInfo(b);};Report.prototype.mRe_setExcelDataViewDomInfo=function(a){var b=this.m_saveInfo_view.child_option;b.viewDom=a;b.validationDom=a.lastChild;b.cancelButtonDom=b.validationDom.previousSibling;b.saveButtonDom=b.cancelButtonDom.previousSibling;b.repeatPageSectionDom=document.getElementById("re_excelData1"+this.m_uid);b=null;};Report.prototype.mRe_disabledExcelDataViewDomInfo=function(b){var a=this.m_saveInfo_view.child_option;if(b){a.cancelButtonDom.style.visibility="hidden";a.saveButtonDom.style.visibility="hidden";}else{a.cancelButtonDom.style.visibility="visible";a.saveButtonDom.style.visibility="visible";}a.repeatPageSectionDom.disabled=b;};Report.prototype.mRe_cancelExcelDataOptionInfo=function(){this.m_popupViewDiv.removeChild(this.m_saveInfo_view.child_option.viewDom);this.makeExcelDataSaveOptionWindow();this.mRe_disabledViewDomInfo(false);};Report.prototype.mRe_saveExcelDataOptionInfo=function(){this.setExcelDataOptionValue();this.mRe_cancelExcelDataOptionInfo();};Report.prototype.setExcelDataOptionValue=function(){var b=this.m_saveInfo_view.child_option;var a=b.json_data;a.outputPageSectionMethod=Number(b.repeatPageSectionDom.value);b=null;a=null;};function mRe_getDefaultSaveExcelDataOption(){var a=null;if(typeof window.getDefaultSaveExcelDataOption!="undefined"){a=getDefaultSaveExcelDataOption();}else{a={outputPageSectionMethod:0};}return a;}function mRe_exprotFileName(b){var a="";a+=b.name;switch(b.exportType){case 1:a+=".xls";break;case 7:a+=".cell";break;case 2:a+=".pdf";break;case 3:a+=".hwp";break;case 4:a+=".rtf";break;case 5:a+=".ppt";break;case 6:a+=".html";break;case 8:a+=".html";break;case 9:a+=".doc";break;case 10:a+=".xlsx";break;case 11:a+=".jpg";break;case 12:a+=".txt";break;case 13:a+=".tif";break;case 14:a+=".tif";break;case 15:a+=".xls";break;case 17:a+=".pptx";break;case 18:a+=".brl";break;case 19:a+=".show";break;default:break;}return a;}function mKey_selectSaveRange(c,d,b){if(32==c.keyCode||13==c.keyCode){var a=m_reportHashMap[d];if(null!=a){a.mRe_selectSaveRange(b);}}}Report.prototype.selectPrintView=function(){if(this.m_buttonEvent.startPrintButton!=null){var g=this.m_buttonEvent.startPrintButton();if(g!=true){this.m_isButtonLock=false;return;}}this.printOptionValue.isNetPrint=false;this.printOpReset();this.disabledMenu(true);this.m_popupViewDiv=document.createElement("div");this.m_popupViewDiv.className="report_popup_view";this.m_popupViewDiv.style.zIndex="400";this.m_bodyDiv.appendChild(this.m_popupViewDiv);var f=document.createElement("div");f.className="report_print_view_position report_view_box";var a=new Array();a.push("<div style='position:absolute;left:15px;right:15px;top:20px;height:48px;border:1px solid darkgray'>");a.push("<select title='"+this.m_languageMap.printType+"' id='re_printType1"+this.m_uid+"' style='position:absolute;left:10px;top:15px;width:90%;height:50%;font-size:9pt;' onChange=\"m_reportHashMap['"+this.m_uid+"'].selectPrintOption(this)\" tabindex='1'>");a.push(this.printOptionValue.isNetPrint?"<optgroup label='Local'>":"");var b=["pdf","html","hwp","exe"];if((typeof window.ReportPrintMenuOrder!="undefined")){b=ReportPrintMenuOrder();}for(var c=0;c<b.length;c++){if(this.m_printDisplay.pdf&&b[c]=="pdf"){a.push("<option value='pdf' ");a.push(this.printOptionValue.isNetPrint?"":"style='padding-left: 30px;'");a.push(this.printOptionValue.localStorage=="pdf"?" selected":"");a.push(">"+this.printNames.pdf+"</option>");}if(this.m_printDisplay.html&&is_svg&&!is_window_safari&&b[c]=="html"){a.push("<option value='html' ");a.push(this.printOptionValue.isNetPrint?"":"style='padding-left: 30px;'");a.push(this.printOptionValue.localStorage=="html"?" selected":"");a.push(">"+this.printNames.html+"</option>");}if(this.m_printDisplay.hwp&&this.m_isHWPPrint&&is_ie&&b[c]=="hwp"){a.push("<option value='hwp' ");a.push(this.printOptionValue.isNetPrint?"":"style='padding-left: 30px;'");a.push(this.printOptionValue.localStorage=="hwp"?" selected":"");a.push(">"+this.printNames.hwp+"</option>");}if(this.m_printDisplay.exe&&is_window&&b[c]=="exe"){a.push("<option value='exe' ");a.push(this.printOptionValue.isNetPrint?"":"style='padding-left: 30px;'");a.push(this.printOptionValue.localStorage=="exe"?" selected":"");a.push(">"+this.printNames.exe+"</option>");}}a.push(this.printOptionValue.isNetPrint?"</optgroup>":"");if(this.printOptionValue.isNetPrint){a.push(" <optgroup label='Network'>");for(var c=0;c<this.printOptionValue.netPrintList.length;c++){var d=this.printOptionValue.netPrintList[c];a.push("    <option value='"+d.name+"' style='padding-left: 30px;'>"+d.name+"</option>");}a.push("</optgroup>");}a.push("</select>");a.push("</div>");a.push("<div id='re_printType2"+this.m_uid+"' style='position:absolute;left:15px;right:15px;top:83px;height:40px;border:1px solid darkgray;display:none'>");a.push("<table style='position:absolute;top:5px'>");a.push("<tbody><tr><td style='padding-left:5px;padding-top:5px'>"+this.m_languageMap.NofC+" : </td>");a.push("<td style='padding-left:5px;padding-top:5px'><input id='re_printType3"+this.m_uid+"' type='text' value='1' style='width:40px'></td>");a.push("</tr></tbody></table>");a.push("</div>");a.push("<div id='re_printType11"+this.m_uid+"' style='position:absolute;left:15px;right:15px;bottom:50px;height:130px;border:1px solid darkgray;background-color: inherit;'>");a.push("<table style='position:absolute;top:5px'>");a.push("<tbody>");a.push("	<tr><td aria-label='"+this.m_languageMap.total_page+"' title='"+this.m_languageMap.total_page+"' tabindex='2' onclick=\"m_reportHashMap['"+this.m_uid+"'].mRe_selectPrintRange(1);\" onkeypress=mKey_selectPrintRange(event,'"+this.m_uid+"',1);  style='cursor:default'>");a.push("		<input id='re_printType4"+this.m_uid+"' type='radio' value='1' name='m_ReSelectRange' tabindex='-1' "+(this.m_selectPageType.print==1?"checked":"")+"/>"+this.m_languageMap.total_page);a.push("	</td></tr>");a.push("	<tr><td aria-label='"+this.m_languageMap.currentPage+"' title='"+this.m_languageMap.currentPage+"' tabindex='3' onclick=\"m_reportHashMap['"+this.m_uid+"'].mRe_selectPrintRange(2);\" onkeypress=mKey_selectPrintRange(event,'"+this.m_uid+"',2); style='cursor:default'>");a.push("		<input id='re_printType5"+this.m_uid+"' type='radio' value='2' name='m_ReSelectRange' tabindex='-1' "+(this.m_selectPageType.print==2?"checked":"")+"/>"+this.m_languageMap.currentPage);a.push("	</td></tr>");a.push("	<tr><td aria-label='"+this.m_languageMap.page_designation+"' title='"+this.m_languageMap.page_designation+"' tabindex='4' onclick=\"m_reportHashMap['"+this.m_uid+"'].mRe_selectPrintRange(3);\" onkeypress=mKey_selectPrintRange(event,'"+this.m_uid+"',3); style='cursor:default'>");a.push("		<input id='re_printType6"+this.m_uid+"' type='radio' value='3' name='m_ReSelectRange' tabindex='-1' "+(this.m_selectPageType.print==3?"checked":"")+"/>"+this.m_languageMap.page_designation);a.push("	</td></tr>");a.push("	<tr><td style='padding-left:25px;padding-top:5px'>");var j=1;var h=this.m_pageCount;if(this.m_selectPageType.printCustom){j=this.m_selectPageType.printStart;h=this.m_selectPageType.printEnd;}a.push("		<input title='"+this.m_languageMap.from+"' tabindex='5' type='text' id='re_printType7"+this.m_uid+"' value='"+j+"' style='width:40px' "+(this.m_selectPageType.print!=3?"disabled":"")+"/>"+this.m_languageMap.from+" &nbsp;&nbsp;&nbsp;");a.push("		<input title='"+this.m_languageMap.to+"' tabindex='6' type='text' id='re_printType8"+this.m_uid+"' value='"+h+"' style='width:40px'"+(this.m_selectPageType.print!=3?"disabled":"")+"/>"+this.m_languageMap.to+"");a.push("	</td></tr>");a.push("</tbody></table>");a.push("</div>");a.push("<span class='report_view_box' style='position:absolute;left:20px;top:14px;border:0;'>"+this.m_languageMap.printType+"</span>");a.push("<span class='report_view_box' style='position:absolute;left:20px;top:75px;border:0;display:none' id='re_printType9"+this.m_uid+"'>"+this.m_languageMap.print_info+"</span>");a.push("<span class='report_view_box' style='position:absolute;left:20px;bottom:174px;border:0;' id='re_printType10"+this.m_uid+"'>"+this.m_languageMap.print_range+"</span>");a.push("<button tabindex='7'  title='"+this.m_languageMap.print+"' onclick=\"m_reportHashMap['"+this.m_uid+"'].mRe_printExportInfo();return false;\" class='report_view_button' style='position:absolute;bottom:5px;right:95px; height:30px;width:75px;'>"+this.m_languageMap.print+"</button>");a.push("<button tabindex='8'  title='"+this.m_languageMap.cancel+"' onclick=\"m_reportHashMap['"+this.m_uid+"'].mRe_closeReportPrintInfo();return false;\" class='report_view_button' style='position:absolute;bottom:5px;right:15px; height:30px;width:75px;'>"+this.m_languageMap.cancel+"</button>");a.push("<span style='position:absolute;left:16px;bottom:37px;font-size:8pt;color:red' id='re_printType10"+this.m_uid+"'></span>");f.innerHTML=a.join("");a=null;if(null!=this.m_popupViewDiv){this.m_popupViewDiv.appendChild(f);}this.mRe_setPrintViewDomInfo(f);if(this.printOptionValue.localStorage!="0"){this.mRe_selectPrintOption(this.printOptionValue.localStorage);}};Report.prototype.mRe_setPrintViewDomInfo=function(b){this.printOptionValue.domList=new Object();var c=new Object();var a=this.m_uid;c.viewDom=b;c.printTypeDom=document.getElementById("re_printType1"+a);c.validationDom=document.getElementById("re_printType10"+a);c.netSpan1Dom=document.getElementById("re_printType2"+a);c.netSpan2Dom=document.getElementById("re_printType9"+a);c.netPageCountDom=document.getElementById("re_printType3"+a);c.check1Dom=document.getElementById("re_printType4"+a);c.check2Dom=document.getElementById("re_printType5"+a);c.check3Dom=document.getElementById("re_printType6"+a);c.startInDom=document.getElementById("re_printType7"+a);c.endInDom=document.getElementById("re_printType8"+a);c.netSpan3Dom=document.getElementById("re_printType10"+a);c.printRangeDom=document.getElementById("re_printType11"+a);this.printOptionValue.domList=c;c.printTypeDom.focus();};Report.prototype.selectPrintLoader=function(){var a=this.printOptionValue.domList.printTypeDom.value;if(a=="pdf"){this.printView(true);}else{if(a=="html"){this.printHTMLView(true);}else{if(a=="hwp"){this.printHWPView(true);}else{if(a=="exe"){this.printEXEView(true);}}}}};Report.prototype.mRe_selectPrintOption=function(a){if(a=="pdf"||a=="html"||a=="hwp"){this.printOptionValue.domList.viewDom.style.height="";this.printOptionValue.domList.netSpan1Dom.style.display="none";this.printOptionValue.domList.netSpan2Dom.style.display="none";this.printOptionValue.domList.netSpan3Dom.style.display="block";this.printOptionValue.domList.printRangeDom.style.display="block";}else{if(a=="exe"){this.printOptionValue.domList.viewDom.style.height="130px";this.printOptionValue.domList.netSpan1Dom.style.display="none";this.printOptionValue.domList.netSpan2Dom.style.display="none";this.printOptionValue.domList.netSpan3Dom.style.display="none";this.printOptionValue.domList.printRangeDom.style.display="none";}else{this.printOptionValue.domList.viewDom.style.height="300px";this.printOptionValue.domList.netSpan1Dom.style.display="block";this.printOptionValue.domList.netSpan2Dom.style.display="block";this.printOptionValue.domList.netSpan3Dom.style.display="block";this.printOptionValue.domList.printRangeDom.style.display="block";}}};Report.prototype.mRe_selectPrintRange=function(b){var a=this.printOptionValue.domList;if(a.check1Dom.disabled){return;}if(1==b){a.check1Dom.checked=true;a.startInDom.disabled=true;a.endInDom.disabled=true;}else{if(2==b){a.check2Dom.checked=true;a.startInDom.disabled=true;a.endInDom.disabled=true;}else{a.check3Dom.checked=true;a.startInDom.disabled=false;a.endInDom.disabled=false;}}};Report.prototype.printViewValidationCheck=function(){var c=this.printOptionValue.domList;if(c.check3Dom.checked){var b=Number(c.startInDom.value);var a=Number(c.endInDom.value);if(isNaN(b)||isNaN(a)){c.validationDom.innerHTML=this.m_languageMap.printNum_validation;c=null;return false;}else{if(b<=0.9||a<=0.9||b>a||b>this.m_pageCount||a>this.m_pageCount){c.validationDom.innerHTML=this.m_languageMap.printNum_validation;c=null;return false;}}}c=null;return true;};Report.prototype.makePrintOption=function(){var a=this.printOptionValue.domList;if(a.check1Dom.checked){this.printOptionValue.startNum=1;this.printOptionValue.endNum=this.m_pageCount;}else{if(a.check2Dom.checked){this.printOptionValue.startNum=this.beforePageIndex+1;this.printOptionValue.endNum=this.beforePageIndex+1;}else{this.printOptionValue.startNum=Number(a.startInDom.value);this.printOptionValue.endNum=Number(a.endInDom.value);}}};Report.prototype.mRe_printExportInfo=function(){this.m_isButtonLock=false;if(this.printViewValidationCheck()){this.makePrintOption();this.m_bodyDiv.removeChild(this.m_popupViewDiv);this.m_popupViewDiv=null;this.selectPrintLoader();if(this.m_buttonEvent.printOkButton!=null){this.m_buttonEvent.printOkButton();}}};Report.prototype.mRe_closeReportPrintInfo=function(){this.m_isButtonLock=false;this.m_bodyDiv.removeChild(this.m_popupViewDiv);this.m_popupViewDiv=null;this.disabledMenu(false);this.print_button.focus();if(this.m_buttonEvent.printCancelButton!=null){this.m_buttonEvent.printCancelButton();}};Report.prototype.checkPrintJsonOption=function(){var c=this.printOptionValue.domList;var a=false;if(is_ie){var b=this.m_versionInfo.build.substring(6).replace(/\_([0-9a-zA-Z]+)/g,"");if((106<Number(b)||this.m_versionInfo.build.charAt(0)=="5")&&!this.m_isRedBC){a=true;this.m_isPrintPop=true;}}if(null!=c){return'{"memoExport":'+this.isMemoExport+',"memoTransparency":'+this.nMemoTransparency+',"isPopupPrint":'+a+',"pageCount":'+this.printOptionValue.pageCount+',"startNum":'+this.printOptionValue.startNum+',"endNum":'+this.printOptionValue.endNum+"}";}else{if(this.m_selectPageType.print==2){return'{"memoExport":'+this.isMemoExport+',"memoTransparency":'+this.nMemoTransparency+',"isPopupPrint":'+a+',"startNum":'+(this.beforePageIndex+1)+',"endNum":'+(this.beforePageIndex+1)+"}";}return'{"memoExport":'+this.isMemoExport+',"memoTransparency":'+this.nMemoTransparency+',"isPopupPrint":'+a+',"startNum":1,"endNum":'+this.m_pageCount+"}";}};Report.prototype.printOpReset=function(){this.printOptionValue.domList=null;};Report.prototype.printIEExportView=function(){this.disabledMenu(true);this.m_popupViewDiv=document.createElement("div");this.m_popupViewDiv.className="report_popup_view";this.m_bodyDiv.appendChild(this.m_popupViewDiv);var k=document.createElement("div");k.className="report_view_box report_Ex_reader9";var b=new Array();b.push("<div aria-label='"+this.m_languageMap.adobe9Info+"' tabindex='1'  style='position:absolute;left:13px;right:15px;top:5%;bottom:50px;border:1px solid darkgray'>");b.push("<div style='position:absolute;left:3px;right:3px;top:8%;'><span>");if(this.adobeMessage.is_message){b.push(this.adobeMessage.message);}else{b.push(this.m_languageMap.adobe9Info);b.push("<br>"+this.m_languageMap.adobe9Info2);b.push(this.m_languageMap.adobe9Info3);}b.push("</span><br>");var i=null!=this.m_pdfLink?this.m_pdfLink:("https://get.adobe.com/reader/?loc="+this.m_languageMap.languageInfo);b.push("<a style='position:ralative' href='"+i+"' target='blank'>"+i+"</a><br>");if(this.adobeMessage.bottomMessage!=""){b.push("<br><span>"+this.adobeMessage.bottomMessage+"</span>");}else{if(this.pESaveButtonVisible){b.push("<br><span>"+this.m_languageMap.adobe9Info4+"</span>");}}b.push("</div></div>");b.push("<span class='report_view_box'  style='position:absolute;left:20px;top:2%;border:0;'>"+this.m_languageMap.print_info2+"</span>");k.innerHTML=b.join("");var d=this;if(this.pESaveButtonVisible){var l=this.m_languageMap.save;var a=this.m_languageMap.cancel;var j="";var m="";if(this.adobeInfoButton.isSave){l=this.adobeInfoButton.saveMsg;j=this.adobeInfoButton.saveStyle;}if(this.adobeInfoButton.isCancel){a=this.adobeInfoButton.cancelMsg;m=this.adobeInfoButton.cancelStyle;}var g=document.createElement("button");g.tabIndex=2;g.title=l;g.className="report_view_button";g.style.cssText="position:absolute;bottom:10px;right:95px; height:30px;width:75px;"+j;g.innerText=l;g.onclick=function(){d.mRe_printFilePDFandEvent();};var c=document.createElement("button");c.tabIndex=3;c.title=a;c.className="report_view_button";c.style.cssText="position:absolute;bottom:10px;right:15px; height:30px;width:75px;"+m;c.innerText=a;c.onclick=function(){d.mRe_closePrintFilePDF();};k.appendChild(g);k.appendChild(c);}else{var h=this.m_languageMap.ok;var f="";if(this.adobeInfoButton.isOk){h=this.adobeInfoButton.okMsg;f=this.adobeInfoButton.okStyle;}var c=document.createElement("button");c.tabIndex=2;c.title=h;c.className="report_view_button";c.style.cssText="position:absolute;bottom:10px;right:15px; height:30px;width:75px;"+f;c.innerText=h;c.onclick=function(){d.mRe_closePrintFilePDF();};k.appendChild(c);}if(null!=this.m_popupViewDiv){this.m_popupViewDiv.appendChild(k);}this.m_printInfo_view=k;b=null;};Report.prototype.mRe_printFilePDFandEvent=function(){this.closePrintInfoWindow();this.disabledMenu(false);this.printOpReset();if(null!=this.m_buttonEvent.PDFPrintAlertOkButton){var a=this.m_buttonEvent.PDFPrintAlertOkButton();if(a){this.reportCheckSend(10);}}else{this.reportCheckSend(10);}};Report.prototype.mRe_printFilePDF=function(){this.closePrintInfoWindow();this.disabledMenu(false);this.printOpReset();this.reportCheckSend(1);};Report.prototype.mRe_closePrintFilePDF=function(){this.m_isPopupPrintView=false;this.closePrintInfoWindow();this.disabledMenu(false);this.mRe_resetPrintPDF();if(this.m_buttonEvent.PDFPrintAlertCloseButton!=null){this.m_buttonEvent.PDFPrintAlertCloseButton();}};Report.prototype.mRe_printIEWindow=function(){this.m_isPopupPrintView=false;this.closePrintInfoWindow();this.disabledMenu(false);this.printIEWindow();};Report.prototype.closePrintInfoWindow=function(){if(null!=this.m_printInfo_view){this.m_bodyDiv.removeChild(this.m_popupViewDiv);this.m_popupViewDiv=null;this.m_printInfo_view=null;}};Report.prototype.mRe_resetPrintPDF=function(){var b="R16";try{var c="t"+new Date().getMilliseconds();var j="ClipID="+b+"&uid="+this.m_uid+"&clipUID="+this.m_uid+"&sRe_set=1";j=mRe_onBeforeSend(j);var g=this.servletPath;if(this.m_isCrossDomain){var h=this;if(window.XDomainRequest){var f=new XDomainRequest();var a=g+"?"+j;if(-1!=g.indexOf("?")){a=g+"&"+j;}if(f){f.onload=function(){};f.onerror=function(){ReportWebLog("IE8 crossDomain error");mRe_ReportEventHandler(40);};f.open("GET",a);f.send();}}else{$.ajax({type:"POST",url:g,crossDomain:true,data:j,success:function(k){},error:function(k){ReportWebLog(k);mRe_ReportEventHandler(40);}});}}else{var h=this;var d=new HttpClient();d.send(g,j,true,function(){if(4==this.readyState){if(200==this.status){}else{h.fileCheckSendErrorText(exportType);}}});}}catch(i){mRe_ReportWebLog(i.stack);}};Report.prototype.printNotExportView=function(){this.disabledMenu(true);this.m_popupViewDiv=document.createElement("div");this.m_popupViewDiv.className="report_popup_view";this.m_bodyDiv.appendChild(this.m_popupViewDiv);var k=document.createElement("div");k.className="report_view_box report_Ex_NOTReader";var b=new Array();b.push("<div aria-label='"+this.m_languageMap.adobe9Info5+"' tabindex='1'  style='position:absolute;left:13px;right:15px;top:5%;bottom:50px;border:1px solid darkgray'>");b.push("<div style='position:absolute;left:3px;right:3px;top:8%;'><span>");if(this.adobeMessage.is_message){b.push(this.adobeMessage.message);}else{if(is_chrome){b.push(this.m_languageMap.chromePDFInfo1);b.push("<br>"+this.m_languageMap.chromePDFInfo2);}else{b.push(this.m_languageMap.adobe9Info5);b.push("<br>"+this.m_languageMap.adobe9Info2);b.push(this.m_languageMap.adobe9Info3);}b.push("</span><br>");if(is_ie){var i=null!=this.m_pdfLink?this.m_pdfLink:("https://get.adobe.com/reader/?loc="+this.m_languageMap.languageInfo);b.push("<a style='position:ralative' href='"+i+"' target='blank'>"+i+"</a><br>");}else{var n="chrome";if(is_chromium_edge){n="edge";}else{if(is_whale){n="whale";}}b.push("<br><span><font color='blue' style='user-select: all;'>"+n+"://settings/content/pdfDocuments</font></span><br>");}if(this.adobeMessage.bottomMessage!=""){b.push("<br><span>"+this.adobeMessage.bottomMessage+"</span>");}else{if(this.pESaveButtonVisible){b.push("<br><span>"+this.m_languageMap.adobe9Info4+"</span>");}}}b.push("</div></div>");b.push("<span class='report_view_box'  style='position:absolute;left:20px;top:2%;border:0;'>"+this.m_languageMap.print_info2+"</span>");k.innerHTML=b.join("");var d=this;if(this.pESaveButtonVisible){var l=this.m_languageMap.save;var a=this.m_languageMap.cancel;var j="";var m="";if(this.adobeInfoButton.isSave){l=this.adobeInfoButton.saveMsg;j=this.adobeInfoButton.saveStyle;}if(this.adobeInfoButton.isCancel){a=this.adobeInfoButton.cancelMsg;m=this.adobeInfoButton.cancelStyle;}var g=document.createElement("button");g.tabIndex=2;g.title=l;g.className="report_view_button";g.style.cssText="position:absolute;bottom:10px;right:95px; height:30px;width:75px;"+j;g.innerText=l;g.onclick=function(){d.mRe_printFilePDFandEvent();};var c=document.createElement("button");c.tabIndex=3;c.title=a;c.className="report_view_button";c.style.cssText="position:absolute;bottom:10px;right:15px; height:30px;width:75px;"+m;c.innerText=a;c.onclick=function(){d.mRe_closePrintFilePDF();};k.appendChild(g);k.appendChild(c);}else{var h=this.m_languageMap.ok;var f="";if(this.adobeInfoButton.isOk){h=this.adobeInfoButton.okMsg;f=this.adobeInfoButton.okStyle;}var c=document.createElement("button");c.tabIndex=2;c.title=h;c.className="report_view_button";c.style.cssText="position:absolute;bottom:10px;right:15px; height:30px;width:75px;"+f;c.innerText=h;c.onclick=function(){d.mRe_closePrintFilePDF();};k.appendChild(c);}if(null!=this.m_popupViewDiv){this.m_popupViewDiv.appendChild(k);}this.m_printInfo_view=k;b=null;};Report.prototype.printFirefoxExportView=function(){if(this.m_directPrint){if((!this.m_directPrint||!is_safari)&&this.m_firefoxPrint.isPopup&&-1==this.servletPath.indexOf("?")){window.open("","report_SubWindow","height="+this.m_firefoxPrint.height+",width="+this.m_firefoxPrint.width);}this.mRe_printView(true);return;}this.m_isPopupPrintView=true;this.disabledMenu(true);this.m_popupViewDiv=document.createElement("div");this.m_popupViewDiv.className="report_popup_view";this.m_bodyDiv.appendChild(this.m_popupViewDiv);var b=document.createElement("div");b.className="report_view_box report_Ex_popPrint";var a=new Array();a.push("<div aria-label='"+this.m_languageMap.printLimit1+" "+this.m_languageMap.printLimit2+"' tabindex='1' style='position:absolute;left:13px;right:15px;top:7%;bottom:50px;border:1px solid darkgray'>");a.push("<div style='position:absolute;left:3px;right:3px;top:8%;'>");if(""!=this.adobeMessage.firefoxMessage){a.push(this.adobeMessage.firefoxMessage);}else{a.push("<span>"+this.m_languageMap.pdfPrintLimit1+"</span>");a.push("<br>"+this.m_languageMap.pdfPrintLimit2);}a.push("</div></div>");a.push("<span class='report_view_box'  style='position:absolute;left:20px;top:2%;border:0;'>"+this.m_languageMap.print_info2+"</span>");a.push("<button tabindex='2' title='"+this.m_languageMap.ok+"' onclick=\"m_reportHashMap['"+this.m_uid+"'].mRe_printPopFilePDF();return false;\" class='report_view_button' style='position:absolute;bottom:10px;right:95px; height:30px;width:75px;'>"+this.m_languageMap.ok+"</button>");a.push("<button tabindex='3' title='"+this.m_languageMap.ignore+"' onclick=\"m_reportHashMap['"+this.m_uid+"'].mRe_printIEWindow();return false;\" class='report_view_button' style='position:absolute;bottom:10px;right:175px; height:30px;width:75px;visibility:hidden'>"+this.m_languageMap.ignore+"</button>");a.push("<button tabindex='4' title='"+this.m_languageMap.cancel+"' onclick=\"m_reportHashMap['"+this.m_uid+"'].mRe_closePrintFilePDF();return false;\" class='report_view_button' style='position:absolute;bottom:10px;right:15px; height:30px;width:75px;'>"+this.m_languageMap.cancel+"</button>");b.innerHTML=a.join("");if(null!=this.m_popupViewDiv){this.m_popupViewDiv.appendChild(b);}this.m_printInfo_view=b;a=null;};Report.prototype.mRe_printPopFilePDF=function(){this.closePrintInfoWindow();if((!this.m_directPrint||!is_safari)&&this.m_firefoxPrint.isPopup&&-1==this.servletPath.indexOf("?")){window.open("","report_SubWindow","height="+this.m_firefoxPrint.height+",width="+this.m_firefoxPrint.width);}this.mRe_printView(true);};Report.prototype.mRe_printPopFilePDF_down=function(){this.m_isPopupPrintView=false;var b="R08";if(this.m_is_serverSaveFile){b="R09S3";}this.disabledMenu(false);if(this.m_directPrint&&is_safari){this.formTag_clipid.value=b;this.formTag_uid.value=this.m_uid;this.formTag_clipUID.value=this.m_uid;this.formTag_print.value="print";this.formTag_printImage.value=this.isPDFPrintImage;this.formTag_printBarcodeAWT.value=this.isPDFPrintBarcodeAWT;this.formTag_path.value=this.clientPath;this.formTag_option.value=this.checkPrintJsonOption();this.formTag_ChromeFitToPage.value=this.isChromePrintFitToPage;this.formTag_s_time.value="t"+new Date().getMilliseconds();if(null==this.formTag){this.mRe_makePrintNewForm();}this.formTag.action=this.servletPath;this.formTag.target="report_SubWindow";this.formTag.submit();return;}if(-1!=this.servletPath.indexOf("?")){var a="t"+new Date().getMilliseconds();var c=this.servletPath+"&";c+="ClipID="+b;c+="&fileName=report.pdf";c+="&isPDFPrintImage="+this.isPDFPrintImage;c+="&isPDFPrintBarcodeAWT="+this.isPDFPrintBarcodeAWT;c+="&optionValue="+this.checkPrintJsonOption();c+="&path="+this.clientPath;c+="&print=print";c+="&isChromePrintFitToPage="+this.isChromePrintFitToPage;c+="&uid="+this.m_uid;c+="&clipUID="+this.m_uid+"&s_time="+a;if(this.m_postParam!=null){c+=this.m_postParam.getParam();}if(this.m_firefoxPrint.isPopup){window.open(c,"","height="+this.m_firefoxPrint.height+",width="+this.m_firefoxPrint.width);}else{window.open(c,"_blank");}}else{this.formTag_clipid.value=b;this.formTag_uid.value=this.m_uid;this.formTag_clipUID.value=this.m_uid;this.formTag_print.value="print";this.formTag_printImage.value=this.isPDFPrintImage;this.formTag_printBarcodeAWT.value=this.isPDFPrintBarcodeAWT;this.formTag_path.value=this.clientPath;this.formTag_option.value=this.checkPrintJsonOption();this.formTag_ChromeFitToPage.value=this.isChromePrintFitToPage;this.formTag_s_time.value="t"+new Date().getMilliseconds();if(null==this.formTag){this.mRe_makePrintNewForm();}this.formTag.action=this.servletPath;if(this.m_firefoxPrint.isPopup){this.formTag.target="report_SubWindow";}else{this.formTag.target="_blank";}this.formTag.submit();}};Report.prototype.printEdgeExportView=function(){if(this.m_directPrint){if((!this.m_directPrint||!is_safari)&&this.m_firefoxPrint.isPopup&&-1==this.servletPath.indexOf("?")){window.open("","report_SubWindow","height="+this.m_firefoxPrint.height+",width="+this.m_firefoxPrint.width);}this.mRe_printView(true);return;}this.m_isPopupPrintView=true;this.disabledMenu(true);this.m_popupViewDiv=document.createElement("div");this.m_popupViewDiv.className="report_popup_view";this.m_bodyDiv.appendChild(this.m_popupViewDiv);var b=document.createElement("div");b.className="report_view_box report_Ex_popPrint";var a=new Array();a.push("<div aria-label='"+this.m_languageMap.pdfPrintLimit3+" "+this.m_languageMap.pdfPrintLimit4+" "+this.m_languageMap.print_info2+"' tabindex='1'  style='position:absolute;left:13px;right:15px;top:7%;bottom:50px;border:1px solid darkgray'>");a.push("<div style='position:absolute;left:3px;right:3px;top:8%;'>");if(""!=this.adobeMessage.edgeMessage){a.push(this.adobeMessage.edgeMessage);}else{a.push("<span>"+this.m_languageMap.pdfPrintLimit3+"</span>");a.push("<br>"+this.m_languageMap.pdfPrintLimit4);}a.push("</div></div>");a.push("<span class='report_view_box'  style='position:absolute;left:20px;top:2%;border:0;'>"+this.m_languageMap.print_info2+"</span>");a.push("<button tabindex='2' title='"+this.m_languageMap.ok+"' onclick=\"m_reportHashMap['"+this.m_uid+"'].mRe_printPopFilePDF();return false;\" class='report_view_button' style='position:absolute;bottom:10px;right:95px; height:30px;width:75px;'>"+this.m_languageMap.ok+"</button>");a.push("<button tabindex='3' title='"+this.m_languageMap.ignore+"' onclick=\"m_reportHashMap['"+this.m_uid+"'].mRe_printIEWindow();return false;\" class='report_view_button' style='position:absolute;bottom:10px;right:175px; height:30px;width:75px;visibility:hidden'>"+this.m_languageMap.ignore+"</button>");a.push("<button tabindex='4' title='"+this.m_languageMap.cancel+"' onclick=\"m_reportHashMap['"+this.m_uid+"'].mRe_closePrintFilePDF();return false;\" class='report_view_button' style='position:absolute;bottom:10px;right:15px; height:30px;width:75px;'>"+this.m_languageMap.cancel+"</button>");b.innerHTML=a.join("");this.m_popupViewDiv.appendChild(b);this.m_printInfo_view=b;a=null;};Report.prototype.mRe_printEdgePopFilePDF=function(){this.closePrintInfoWindow();this.disabledMenu(false);var b=new Array();var h=this.servletPath;if(-1!=this.servletPath.indexOf("?")){var d=this.servletPath.split("?");if(h.length>1){var g=d[1];h=d[0];var k=g.split("&");for(var f=0;f<k.length;f++){var a=k[f].split("=");if(a.length>1){var j=document.createElement("input");j.type="hidden";j.name=a[0];j.value=a[1];this.formTag.appendChild(j);b.push(j);}}}}var c="R08";if(this.m_is_serverSaveFile){c="R09S3";}this.formTag_clipid.value=c;this.formTag_uid.value=this.m_uid;this.formTag_clipUID.value=this.m_uid;this.formTag_print.value="print";this.formTag_printImage.value=this.isPDFPrintImage;this.formTag_printBarcodeAWT.value=this.isPDFPrintBarcodeAWT;this.formTag_path.value=this.clientPath;this.formTag_option.value=this.checkPrintJsonOption();this.formTag_ChromeFitToPage.value=this.isChromePrintFitToPage;this.formTag_s_time.value="t"+new Date().getMilliseconds();this.formTag.action=h;this.formTag.target="re_target"+this.m_uid;this.formTag.submit();if(b.length>0){for(var f=0;f<b.length;f++){var j=b[f];this.formTag.removeChild(j);}}b=null;};Report.prototype.printLimitedExportView=function(c){this.disabledMenu(true);this.m_popupViewDiv=document.createElement("div");this.m_popupViewDiv.className="report_popup_view";this.m_bodyDiv.appendChild(this.m_popupViewDiv);var b=document.createElement("div");b.className="report_view_box report_Ex_limitPrint";var a=new Array();a.push("<div aria-label='"+this.m_languageMap.printLimit1+" "+this.m_languageMap.printLimit2+"' tabindex='1' style='position:absolute;left:13px;right:15px;top:5%;height:50%;border:1px solid darkgray'>");a.push("<div style='position:absolute;left:3px;right:3px;top:26%;'><span>");a.push(this.m_languageMap.printLimit1);a.push("<br>"+this.m_languageMap.printLimit2+"</span>");a.push("</div></div>");a.push("<span class='report_view_box' style='position:absolute;left:20px;top:2%;border:0;'>"+this.m_languageMap.print_info2+"</span>");if(this.pESaveButtonVisible){a.push("<button  tabindex='2' title='"+this.m_languageMap.save+"' onclick=\"m_reportHashMap['"+this.m_uid+"'].mRe_printFilePDF();return false;\" class='report_view_button' style='position:absolute;bottom:10px;right:175px; height:30px;width:75px;'>"+this.m_languageMap.save+"</button>");}if("pdf"==c){a.push("<button  tabindex='3' title='"+this.m_languageMap.ignore+"' onclick=\"m_reportHashMap['"+this.m_uid+"'].mRe_IgnorePrinting();return false;\" class='report_view_button' style='position:absolute;bottom:10px;right:95px; height:30px;width:75px;'>"+this.m_languageMap.ignore+"</button>");}else{if("hwp"==c){a.push("<button  tabindex='3' title='"+this.m_languageMap.ignore+"' onclick=\"m_reportHashMap['"+this.m_uid+"'].mRe_IgnoreHWPPrinting();return false;\" class='report_view_button' style='position:absolute;bottom:10px;right:95px; height:30px;width:75px;'>"+this.m_languageMap.ignore+"</button>");}else{if("exe"==c){a.push("<button  tabindex='3' title='"+this.m_languageMap.ignore+"' onclick=\"m_reportHashMap['"+this.m_uid+"'].mRe_IgnoreEXEPrinting();return false;\" class='report_view_button' style='position:absolute;bottom:10px;right:95px; height:30px;width:75px;'>"+this.m_languageMap.ignore+"</button>");}else{a.push("<button  tabindex='3' title='"+this.m_languageMap.ignore+"' onclick=\"m_reportHashMap['"+this.m_uid+"'].mRe_IgnoreHTMLPrinting();return false;\" class='report_view_button' style='position:absolute;bottom:10px;right:95px; height:30px;width:75px;'>"+this.m_languageMap.ignore+"</button>");}}}a.push("<button  tabindex='4' title='"+this.m_languageMap.cancel+"' onclick=\"m_reportHashMap['"+this.m_uid+"'].mRe_closePrinting();return false;\" class='report_view_button' style='position:absolute;bottom:10px;right:15px; height:30px;width:75px;'>"+this.m_languageMap.cancel+"</button>");b.innerHTML=a.join("");if(null!=this.m_popupViewDiv){this.m_popupViewDiv.appendChild(b);}this.m_printInfo_view=b;a=null;};Report.prototype.mRe_closePrinting=function(){this.closePrintInfoWindow();this.disabledMenu(false);};Report.prototype.mRe_IgnorePrinting=function(){this.closePrintInfoWindow();this.mRe_printView();this.disabledMenu(false);};Report.prototype.mRe_IgnoreHTMLPrinting=function(){this.closePrintInfoWindow();this.mRe_printHTMLView();this.disabledMenu(false);};Report.prototype.mRe_IgnoreHWPPrinting=function(){this.closePrintInfoWindow();this.mRe_printHWPView();this.disabledMenu(false);};Report.prototype.mRe_IgnoreEXEPrinting=function(){this.closePrintInfoWindow();this.mRe_printEXEView();this.disabledMenu(false);};Report.prototype.printHtmlPopupCheckExportView=function(){this.disabledMenu(true);this.m_popupViewDiv=document.createElement("div");this.m_popupViewDiv.className="report_popup_view";this.m_bodyDiv.appendChild(this.m_popupViewDiv);if(null!=this.m_html_info){this.m_languageMap.printSet2=this.m_html_info;this.m_languageMap.printSet1="";}var b=document.createElement("div");b.className="report_view_box report_Ex_popHTMLPrint";var a=new Array();a.push("<div aria-label='"+this.m_languageMap.printSet1+" "+this.m_languageMap.printSet2+"' tabindex='1' style='position:absolute;left:13px;right:15px;top:5%;height:50%;border:1px solid darkgray'>");a.push("<div style='position:absolute;left:3px;right:3px;top:26%;'><span>");a.push(this.m_languageMap.printSet1);if(this.m_language==0){a.push("<br>");}a.push(this.m_languageMap.printSet2+"</span>");a.push("</div></div>");a.push("<span class='report_view_box' style='position:absolute;left:20px;top:2%;border:0;'>"+this.m_languageMap.print_info2+"</span>");a.push("<input tabindex='2' title='"+this.m_languageMap.printSet3+"' type='checkbox' value='true' id='htmlPopupCheck"+this.m_uid+"' style='position:absolute;bottom:40px;right:15px; height:20px;left:10px;'/>");a.push("<span style='position:absolute;bottom:40px;right:15px; height:20px;left:30px;'>"+this.m_languageMap.printSet3+"</span>");a.push("<button tabindex='3' title='"+this.m_languageMap.ok+"' onclick=\"m_reportHashMap['"+this.m_uid+"'].mRe_htmlPopupCheck();return false;\" class='report_view_button' style='position:absolute;bottom:10px;right:15px; height:30px;width:75px;'>"+this.m_languageMap.ok+"</button>");b.innerHTML=a.join("");if(null!=this.m_popupViewDiv){this.m_popupViewDiv.appendChild(b);}this.m_printInfo_view=b;a=null;};Report.prototype.mRe_htmlPopupCheck=function(){var a=document.getElementById("htmlPopupCheck"+this.m_uid);if(null!=a){if(a.checked){mRe_setLocalStorage("mRe_htmlPopupCheck","1");}}this.mRe_closePrinting();this.checkPrintHTMLView();};Report.prototype.mRe_print_progress_check=function(){var a=this;var b=this.m_uid;if(a.m_fileDownLoadServerCheck){this.fileDownloadCheckTimer=window.setTimeout(function(){a.fileCheckSend("print");},1000);}};function mKey_selectPrintRange(c,d,b){if(32==c.keyCode||13==c.keyCode){var a=m_reportHashMap[d];if(null!=a){a.mRe_selectPrintRange(b);}}}function getPrintFrame(a,g){var h=document.styleSheets;var j="";if(typeof h!="undefined"){var f=h.length;for(var b=0;b<f;b++){var c=h[b];if(null!=c){if(null!=c.href&&-1!=c.href.indexOf("font.css")){j=c.href;}}}}var d=new Array();d.push('<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">');d.push("<html>");d.push("<head>");d.push('<meta http-equiv="Content-Type" content="text/html; charset=utf-8">');d.push("<title>report</title>");if(""!=j){d.push("<link rel='stylesheet' type='text/css' href='"+j+"'>");}d.push("<style media='print' type='text/css'>");d.push(" #header, #leftside, #rightside, #footer {");d.push("	display:none;");d.push("}");d.push("    @page {");if(!is_ie){d.push("size:");d.push(a+"px ");d.push(g+"px;");}d.push("       margin: 0mm 0mm 0mm 0mm;");d.push("    }");d.push("  body, #content, .container .row {");d.push(" margin : 0;");d.push(" width:100%;");d.push(" }");d.push("</style>");d.push("<style type='text/css'>");d.push(".page-break{");if(is_ie){d.push("border:1px solid transparent;");d.push("overflow:visible;");}else{if(is_safari&&!is_window_safari){d.push("border:0px solid red;");d.push("overflow:hidden;");d.push("zoom:0.87;");d.push("width:"+a+"px;");d.push("height:"+g+"px;");}else{d.push("border:0px solid red;");d.push("overflow:hidden;");d.push("width:"+Math.floor(a)+"px;");d.push("height:"+Math.floor(g)+"px;");}}d.push(" }");d.push("</style>");d.push(" <script type='text/javascript'>");d.push(" function callPrint(){");if(is_firefox){d.push("	   window.print();");}else{d.push("	   document.execCommand('print', false, null);");}d.push(" }");d.push("<\/script>");d.push("</head>");d.push("<body id='body1'>");d.push("</body>");d.push("</html>");return d.join("");}function getPrintFrameHeader(a,c){var b=new Array();b.push("<style media='print' type='text/css'>");b.push(" #header, #leftside, #rightside, #footer {");b.push("	display:none;");b.push("}");b.push("    @page {");if(!is_ie){b.push("size:");b.push(a+"px ");b.push(c+"px;");}b.push("       margin: 0mm 0mm 0mm 0mm;");b.push("    }");b.push("  body, #content, .container .row {");b.push(" margin : 0;");b.push(" width:100%;");b.push(" }");b.push("</style>");b.push("<style type='text/css'>");b.push(".page-break{");if(is_ie){b.push("border:1px solid transparent;");b.push("overflow:visible;");}else{if(is_safari&&!is_window_safari){b.push("border:0px solid red;");b.push("overflow:hidden;");b.push("zoom:0.87;");b.push("width:"+a+"px;");b.push("height:"+c+"px;");}else{b.push("border:0px solid red;");b.push("overflow:hidden;");b.push("width:"+Math.floor(a)+"px;");b.push("height:"+Math.floor(c)+"px;");}}b.push(" }");b.push("</style>");return b.join("");}function getPDFPrintFrame(a){var c=a?"R09S3":"R08";var b=new Array();b.push('<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">');b.push("<html>");b.push("<head>");b.push('<meta http-equiv="Content-Type" content="text/html; charset=utf-8">');b.push("<title>print</title>");b.push('<script type="text/javascript">');b.push("var postParam = null;");b.push("var postParamInputList = null;");b.push("function receiveMessage(event){");b.push("var data = null;");b.push("try{");b.push("	data = window.eval(event.data);");b.push("}catch(e){");b.push("	data = null;");b.push("}");b.push("if(null == data || typeof data.uid == 'undefined'){");b.push("	return;");b.push("}");b.push('var iframe = document.getElementById("target1");');b.push("document.body.removeChild(iframe);");b.push("iframe = document.createElement('iframe');");b.push("iframe.id = 'target1';");b.push("iframe.name = 're_target_print';");b.push("document.body.appendChild(iframe);");b.push("document.getElementById('re_form_uid').value = data.uid;");b.push("document.getElementById('re_form_clipUID').value = data.uid;");b.push("document.getElementById('re_form_path').value = data.clientPath;");b.push("document.getElementById('re_form_printImage').value = data.isPDFPrintImage;");b.push("if(data.isPDFPrintBarcodeAWT != null){document.getElementById('re_form_printBarcodeAWT').value = data.isPDFPrintBarcodeAWT;}");b.push("document.getElementById('re_form_ChromeFitToPage').value = data.isChromePrintFitToPage;");b.push("document.getElementById('re_form_s_time').value = 't' + new Date().getMilliseconds();");b.push('var jsonData = "{\\"drawDashedLineDirectly\\":true,\\"startNum\\":"+data.optionValue.startNum+",\\"endNum\\":"+data.optionValue.endNum+"}";');b.push("document.getElementById('re_form_option').value = jsonData;");b.push("var form1 = document.getElementById('re_form1');");b.push("if(null != data.postParam){");b.push("	if(null != postParam){");b.push("		for(var index1=0; index1<postParamInputList.length; index1++){");b.push("			form1.removeChild(postParamInputList[index1]);");b.push("		}");b.push("	}");b.push("	postParam = data.postParam;");b.push("	postParamInputList = [];");b.push("	var splitParam = postParam.split('&');");b.push("	for(var index=0; index<splitParam.length; index++){");b.push("		var paramData = splitParam[index];");b.push("		var splitParamData = paramData.split('=');");b.push("		if(splitParamData.length == 2){");b.push("			var postInput = document.createElement('input');");b.push("			postInput.name = splitParamData[0];");b.push("			postInput.value = splitParamData[1];");b.push("			form1.appendChild(postInput);");b.push("			postParamInputList.push(postInput);");b.push("		}");b.push("	}");b.push("}");b.push("form1.action = data.url;");b.push("if(-1 != data.url.indexOf('?')){");b.push("	var s_time = 't' + new Date().getMilliseconds();");b.push("	jsonData = encodeURIComponent(jsonData);");b.push("	var strUrl = data.url + '&ClipID="+c+"&isPDFPrintImage=' + data.isPDFPrintImage + '&' + ");b.push("				'isChromePrintFitToPage=' + data.isChromePrintFitToPage + '&'+");b.push("				'isPDFPrintBarcodeAWT=' + data.isPDFPrintBarcodeAWT + '&'+");b.push("				'optionValue=' + jsonData + '&print=print&uid=' + data.uid + '&path='+ escape(data.clientPath)+'&' + ");b.push("				's_time=' + s_time;");b.push("				if(null != data.postParam){");b.push("					strUrl += data.postParam;");b.push("				}");b.push("	iframe.src = strUrl;");b.push("}else{");b.push("	form1.submit();");b.push("}");b.push("	iframe.onload = function() {");b.push("		var win = iframe.contentWindow;");b.push('		window.parent.postMessage(data.uid,"*");');b.push("		if (win) {");b.push("			win.focus();");b.push("			win.print();");b.push("		}");b.push("	};");b.push("}");b.push("if (window.addEventListener){");b.push('	  addEventListener("message", receiveMessage, false);');b.push("} else {");b.push('	  attachEvent("onmessage", receiveMessage);');b.push("}");b.push("<\/script>");b.push("</head>");b.push("<body>");b.push('	<iframe id="target1" name="re_target_print"></iframe>');b.push("<form id='re_form1' style='display:none;' encoding='application/x-www-form-urlencoded' method='post' target='re_target_print'>");b.push("<input type='text' id='re_form_clipid' name='ClipID' value='"+c+"' />");b.push("<input type='text' id='re_form_uid' name='uid' />");b.push("<input type='text' id='re_form_clipUID' name='clipUID' />");b.push("<input type='text' id='re_form_print' name='print' value='print'/>");b.push("<input type='text' id='re_form_printImage' name='isPDFPrintImage' value='false'/>");b.push("<input type='text' id='re_form_printBarcodeAWT' name='isPDFPrintBarcodeAWT' value='false'/>");b.push("<input type='text' id='re_form_path' name='path' />");b.push("<input type='text' id='re_form_option' name='optionValue' />");b.push("<input type='text' id='re_form_ChromeFitToPage' name='isChromePrintFitToPage' />");b.push("<input type='text' id='re_form_s_time' name='s_time' />");b.push("</body>");b.push("</html>");return b.join("");}Report.prototype.editableSignControl=function(o,a,p,h,j){if(this.m_isButtonLock==false){if(null!=this.signPaintDiv){return;}Re_zoom.isPop=true;var g=this;this.disabledMenu(true);a+=100;p+=100;var l=o.getAttribute("type");var d=o.getAttribute("controlindex");var r=document.createElement("div");if(this.m_signOption.staticPos){r.style.cssText="position:absolute;left:"+this.m_signOption.staticLeft+";top:"+this.m_signOption.staticTop+";width:"+(a+50)+"px;height:"+(p+110)+"px;";}else{r.style.cssText="position:absolute;left:"+(this.paintDiv.scrollLeft+10+this.m_signOption.offsetLeft)+"px;top:"+(this.paintDiv.scrollTop+10+this.m_signOption.offsetTop)+"px;width:"+(a+50)+"px;height:"+(p+110)+"px;";}r.className="report_sign_div";var b=document.createElement("div");b.className="report_sign_menu";var m=document.createElement("button");m.className="report_sign_button report_sign_save";m.innerHTML=this.m_languageMap.save;var n=document.createElement("button");n.className="report_sign_button report_sign_reset";n.innerHTML=this.m_languageMap.reset;var c=document.createElement("button");c.className="report_sign_button report_sign_cancel";c.innerHTML=this.m_languageMap.cancel;var q=document.createElement("span");q.innerHTML="&nbsp;&nbsp;";b.appendChild(m);b.appendChild(q.cloneNode(true));b.appendChild(n);b.appendChild(q.cloneNode(true));b.appendChild(c);var k=document.createElement("div");k.className="report_sign_paint";r.appendChild(b);r.appendChild(k);this.paintDiv.appendChild(r);this.signPaintDiv=r;var f=$(k);f.jSignature({"background-color":"transparent","decor-color":"transparent",lineWidth:h,color:j,width:(a),height:(p)});n.onclick=function(){f.jSignature("reset");};c.onclick=function(){g.paintDiv.removeChild(r);g.disabledMenu(false);g.signPaintDiv=null;};var i=this.m_necessaryCheck;m.onclick=function(){g.disabledMenu(false);g.signPaintDiv=null;var y=f.jSignature("getData").split("base64,");var w={necessaryPage:i,data:new Array()};w.data[Number(d)]=new Object();w.data[Number(d)].type=l;w.data[Number(d)].controlIndex=d;w.data[Number(d)].value=y[1];var v="t"+new Date().getMilliseconds();var t="ClipID=R11&pageNumber="+g.beforePageIndex+"&clipUID="+g.m_uid+"&uid="+g.m_uid+"&Accessibility="+g.m_isAccessibility+"&data="+encodeURIComponent(mCR_Base64.encode(JSON.stringify(w)))+"&s_time="+v;t=mRe_onBeforeSend(t);if(g.m_isCrossDomain){if(window.XDomainRequest){var s=new XDomainRequest();var u=servletPath+"?"+t;if(s){s.onload=function(){g.resultNewReport(mRe_onAfterSend(s.responseText));};s.onerror=function(){ReportWebLog("IE8 crossDomain error");mRe_ReportEventHandler(40);};s.open("GET",u);s.send();}}else{$.ajax({type:"POST",url:servletPath,crossDomain:true,data:t,success:function(z){paintReportText(mRe_onAfterSend(z),g);},error:function(z){ReportWebLog(z);mRe_ReportEventHandler(40);}});}}else{var x=new HttpClient();x.send(g.servletPath,t,true,function(){if(4==this.readyState){if(200==this.status){paintReportText(mRe_onAfterSend(this.responseText),g);}else{g.paintDiv.innerHTML=g.m_languageMap.link_error;mRe_ReportEventHandler(40);g.pageSlideShow();mRe_ReportWebLog(this.status);}}});}g.paintDiv.removeChild(r);g.createEditableProgress();o.style.zIndex="0";};}};Report.prototype.m_NecessaryPopup=function(f){this.m_necessaryCheck=true;this.disabledMenu(true);this.m_popupViewDiv=document.createElement("div");this.m_popupViewDiv.className="report_popup_view";this.m_bodyDiv.appendChild(this.m_popupViewDiv);var d=0;var c=document.createElement("div");c.className="report_view_box";var g=100;if(this.m_signOption.staticPos){c.style.cssText="position:absolute;left:"+this.m_signOption.staticLeft+";top:"+this.m_signOption.staticTop+";width:350px;";}else{c.style.cssText="position:absolute;left:"+(10+this.m_signOption.offsetLeft)+"px;top:"+(80+this.m_signOption.offsetTop)+"px;width:350px;";}var a=new Array();a.push("<div style='position:absolute;left:13px;right:15px;top:5%;height:20%;border:1px solid darkgray'>");a.push("<div style='position:absolute;left:3px;right:3px;top:26%;font-weight:bold;'><span>");a.push("필수 입력사항이 누락되었습니다.</span>");a.push("</div></div>");a.push("<div style='position:absolute;left:20px;right:5px;top:30%;'>");for(var b=0;b<f.length;b++){if(b==0){d=f[b].pageNum;}a.push((b+1)+". ");a.push(f[b].value+"<br>");g+=20;}c.style.height=g+"px";a.push("</div>");a.push("<button title='"+this.m_languageMap.ok+"' onclick=\"m_reportHashMap['"+this.m_uid+"'].NecessaryPage("+d+");return false;\" class='report_view_button' style='position:absolute;bottom:10px;right:15px; height:30px;width:75px;'>"+this.m_languageMap.ok+"</button>");c.innerHTML=a.join("");if(null!=this.m_popupViewDiv){this.m_popupViewDiv.appendChild(c);}a=null;};Report.prototype.NecessaryPage=function(a){if(this.m_popupViewDiv!=null){if(null!=this.signPaintDiv){this.paintDiv.removeChild(this.signPaintDiv);this.signPaintDiv=null;}this.m_bodyDiv.removeChild(this.m_popupViewDiv);}this.disabledMenu(false);if(this.beforePageIndex==a){this.sendData(a);}else{this.selectPage(a,"required");}};
/*!
 * Signature Pad v2.3.2
 * https://github.com/szimek/signature_pad
 *
 * Copyright 2017 Szymon Nowak
 * Released under the MIT license
 *
 * The main idea and some parts of the code (e.g. drawing variable width Bézier curve) are taken from:
 * http://corner.squareup.com/2012/07/smoother-signatures.html
 *
 * Implementation of interpolation using cubic Bézier curves is taken from:
 * http://benknowscode.wordpress.com/2012/09/14/path-interpolation-using-cubic-bezier-and-control-point-estimation-in-javascript
 *
 * Algorithm for approximated length of a Bézier curve is taken from:
 * http://www.lemoda.net/maths/bezier-length/index.html
 *
 */
(function(b,a){typeof exports==="object"&&typeof module!=="undefined"?module.exports=a():typeof define==="function"&&define.amd?define(a):(b.SignaturePad=a());}(this,(function(){function d(h){var m=0;var l=0;if(null!=window.is_ie){if(is_ie||is_firefox||is_edge){var k=$(h).offset();m=k.left;l=k.top;return{top:l,left:m};}}var m=0;var l=0;var p=0;var o=0;var n=1;while(h&&!isNaN(h.offsetLeft)&&!isNaN(h.offsetTop)){var i=h.offsetLeft-h.scrollLeft;var g=h.offsetTop-h.scrollTop;m+=i;l+=g;p+=i/n;o+=g/n;var j=h.style.zoom;if(null!=j&&""!=j){n=Number(j);}h=h.offsetParent;}return{top:l,left:m,zoomX:p,zoomY:o};}function b(g,j,i,h){this.x=g;this.y=j;this.time=i||0;this.w=h||0;}b.prototype.velocityFrom=function(g){return this.time!==g.time?this.distanceTo(g)/(this.time-g.time):1;};b.prototype.distanceTo=function(g){return Math.sqrt(Math.pow(this.x-g.x,2)+Math.pow(this.y-g.y,2));};b.prototype.equals=function(g){return this.x===g.x&&this.y===g.y&&this.time===g.time;};function a(j,h,g,i){this.startPoint=j;this.control1=h;this.control2=g;this.endPoint=i;}a.prototype.length=function(){var n=10;var g=0;var p=void 0;var o=void 0;for(var m=0;m<=n;m+=1){var q=m/n;var k=this._point(q,this.startPoint.x,this.control1.x,this.control2.x,this.endPoint.x);var j=this._point(q,this.startPoint.y,this.control1.y,this.control2.y,this.endPoint.y);if(m>0){var l=k-p;var h=j-o;g+=Math.sqrt(l*l+h*h);}p=k;o=j;}return g;};a.prototype._point=function(i,k,j,h,g){return k*(1-i)*(1-i)*(1-i)+3*j*(1-i)*(1-i)*i+3*h*(1-i)*i*i+g*i*i*i;};function c(h,j,n){var g,l,o;var m=null;var k=0;if(!n){n={};}var i=function i(){k=n.leading===false?0:Date.now();m=null;o=h.apply(g,l);if(!m){g=l=null;}};return function(){var p=Date.now();if(!k&&n.leading===false){k=p;}var q=j-(p-k);g=this;l=arguments;if(q<=0||q>j){if(m){clearTimeout(m);m=null;}k=p;o=h.apply(g,l);if(!m){g=l=null;}}else{if(!m&&n.trailing!==false){m=setTimeout(i,q);}}return o;};}function f(k,j,l,i,h){var g=this;var m=j||{};this.velocityFilterWeight=m.velocityFilterWeight||0.7;this.minWidth=m.minWidth||0.5;this.maxWidth=m.maxWidth||2.5;this.throttle="throttle" in m?m.throttle:16;this.minDistance="minDistance" in m?m.minDistance:5;if(this.throttle){this._strokeMoveUpdate=c(f.prototype._strokeUpdate,this.throttle);}else{this._strokeMoveUpdate=f.prototype._strokeUpdate;}this.dotSize=m.dotSize||function(){return(this.minWidth+this.maxWidth)/2;};this.penColor=m.penColor||"black";this.backgroundColor=m.backgroundColor||"rgba(0,0,0,0)";this.onBegin=m.onBegin;this.onEnd=m.onEnd;this._canvas=k;this._offsetWidth=k.offsetWidth;this._offsetHeight=k.offsetHeight;this._offset=d(k);this._guideInfo=null;if(typeof i!="undefined"){this._guideInfo=i;}this._isOnlyPen=false;if(typeof h!="undefined"){this._isOnlyPen=h;}this._ctx=k.getContext("2d");this.clear();this.eformControl=null;this._startTime=new Date().getTime();if(typeof l!="undefined"){this.eformControl=l;}this.stampControl=null;this.nSendSplitCount=0;this.isSetPathPaint=false;this._handlePointerDown=function(n){if((!g._isOnlyPen)||n.pointerType==="pen"||n.pointerType===n.MSPOINTER_TYPE_PEN){if(n.which===1){g._mouseButtonDown=true;if(null!=g._guideInfo){g._canvas.addEventListener("pointermove",g._handlePointerMove);}g._strokeBegin(n);}}};this._handlePointerMove=function(p){if((!g._isOnlyPen)||p.pointerType==="pen"||p.pointerType===p.MSPOINTER_TYPE_PEN){p.preventDefault();if(g._mouseButtonDown){if(null!=g._guideInfo){const o=k.getBoundingClientRect();const n=p.clientX-o.left;const q=p.clientY-o.top;if(n<0||n>k.width||q<0||q>k.height){g._strokeEnd(p);g._mouseButtonDown=false;g._canvas.removeEventListener("pointermove",g._handlePointerMove);return;}}g._strokeMoveUpdate(p);}}};this._handlePointerUp=function(n){if((!g._isOnlyPen)||n.pointerType==="pen"||n.pointerType===n.MSPOINTER_TYPE_PEN){g._mouseButtonDown=false;var o=n.target===g._canvas;if(o){n.preventDefault();g._strokeEnd(n);if(null!=g._guideInfo){g._canvas.removeEventListener("pointermove",g._handlePointerMove);}}}};this._handleMouseDown=function(n){if(n.which===1){g._mouseButtonDown=true;g._strokeBegin(n);}};this._handleMouseMove=function(n){if(g._mouseButtonDown){g._strokeMoveUpdate(n);}};this._handleMouseUp=function(n){if(n.which===1&&g._mouseButtonDown){g._mouseButtonDown=false;g._strokeEnd(n);}};this.on();}f.prototype.resize=function(){this._offsetWidth=this._canvas.offsetWidth;this._offsetHeight=this._canvas.offsetHeight;this._canvas.width=this._offsetWidth;this._canvas.height=this._offsetHeight;this._offset=d(this._canvas);this._ctx=this._canvas.getContext("2d");this._clear();};f.prototype.setStampControl=function(g){this.stampControl=g;};f.prototype.clear=function(){this._undoData=[];this._undoData2=[];this._clear();};f.prototype._clear=function(){var h=this._ctx;var i=this._canvas;h.fillStyle=this.backgroundColor;h.clearRect(0,0,i.width,i.height);h.fillRect(0,0,i.width,i.height);this._data=[];this._reset();this._isEmpty=true;this.nSendSplitCount=0;if(null!=this._guideInfo){var j="";if(this._guideInfo.bold){j+="bold ";}j+=this._guideInfo.size+"px "+this._guideInfo.fontName;this._ctx.font=j;this._ctx.fillStyle=this._guideInfo.color;var k=((i.height-this._guideInfo.defaultY)*2);if(k>10){}this._ctx.textBaseline="top";var g=(i.height-this._guideInfo.size)/2;this._ctx.fillText(this._guideInfo.text,0,g);}};f.prototype.fromDataURL=function(k){var i=this;var o=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var h=new Image();var j=o.ratio||window.devicePixelRatio||1;var g=o.width||this._canvas.width/j;var n=o.height||this._canvas.height/j;var m=null!=o.left?o.left:0;var l=null!=o.top?o.top:0;this._reset();h.src=k;h.onload=function(){var p=h.width;var s=h.height;if(null!=p&&null!=s){if(g<p||n<s){var r=p/g;var q=s/n;if(r<q){s=n;p=p/q;}else{p=g;s=s/r;}}m=((g-p)/2);l=((n-s)/2);g=p;n=s;}i._ctx.drawImage(h,m,l,g,n);if(i.stampControl!=null){i.stampControl.controlData.image=i.toDataURL().split("base64,")[1];i.stampControl.setSendValue(i.stampControl.controlData.image);i.stampControl.subSectionSyncValue();}};this._isEmpty=false;};f.prototype.toDataURL=function(j){var k;switch(j){case"image/svg+xml":return this._toSVG();default:for(var g=arguments.length,h=Array(g>1?g-1:0),i=1;i<g;i++){h[i-1]=arguments[i];}return(k=this._canvas).toDataURL.apply(k,[j].concat(h));}};f.prototype.on=function(){this._handlePointerEvents();};f.prototype.off=function(){if(window.PointerEvent){this._canvas.removeEventListener("pointerdown",this._handlePointerDown);this._canvas.removeEventListener("pointermove",this._handlePointerMove);document.removeEventListener("pointerup",this._handlePointerUp);}else{this._canvas.removeEventListener("mousedown",this._handleMouseDown);this._canvas.removeEventListener("mousemove",this._handleMouseMove);document.removeEventListener("mouseup",this._handleMouseUp);}};f.prototype.isEmpty=function(){return this._isEmpty;};f.prototype._strokeBegin=function(g){this._data.push([]);this._reset();this._canvasWidth=Number(this._canvas.width);this._canvasHeight=Number(this._canvas.height);this._offset=d(this._canvas);this._strokeUpdate(g);if(typeof this.onBegin==="function"){this.onBegin(g);}};f.prototype._strokeUpdate=function(q){var k=q.clientX;var i=q.clientY;var p=null;var m=window.Re_zoom;if(null!=m&&!m.isPop){var A=m.rate;if(!(is_ie||is_edge||is_firefox||is_chrome128)){var r=q.pageX-k;var w=q.pageY-i;k=k/A;i=i/A;k=k+((k-this._offset.zoomX)*((this._canvasWidth/this._offsetWidth)-1));i=i+((i-this._offset.zoomY)*((this._canvasHeight/this._offsetHeight)-1));r=(r*((this._canvasWidth/this._offsetWidth)-1));w=(w*((this._canvasHeight/this._offsetHeight)-1));k+=(r/A);i+=(w/A);}else{if(is_chrome128||is_firefox){var u=this._canvasWidth/this._offsetWidth;var t=this._canvasHeight/this._offsetHeight;var g=this._canvas.getBoundingClientRect();var z=k-g.left;var v=i-g.top;z=z/A;v=v/A;p=new b(z*u,v*t,(new Date().getTime()%this._startTime));}else{k=k+((k-this._offset.left)*((this._canvasWidth/this._offsetWidth/A)-1));i=i+((i-this._offset.top)*((this._canvasHeight/this._offsetHeight/A)-1));}}}else{k=k+((k-this._offset.left)*((this._canvasWidth/this._offsetWidth)-1));i=i+((i-this._offset.top)*((this._canvasHeight/this._offsetHeight)-1));}if(null==p){p=this._createPoint(k,i);}var o=this._data[this._data.length-1];var h=o&&o[o.length-1];var l=h&&p.distanceTo(h)<this.minDistance;if(!(h&&l)){var s=this._addPoint(p),n=s.curve,j=s.widths;if(n&&j){this._drawCurve(n,j.start,j.end);}this._data[this._data.length-1].push({x:p.x,y:p.y,time:p.time,color:this.penColor,w:0});}};f.prototype._strokeEnd=function(h){var p=this.points.length>2;var s=this.points[0];if(!p&&s){this._drawDot(s);}if(s){var k=this._data[this._data.length-1];var q=k[k.length-1];if(!s.equals(q)){k.push({x:s.x,y:s.y,time:s.time,color:this.penColor,w:0});}}if(typeof this.onEnd==="function"){this.onEnd(h);}this._undoData=[];this._undoData2=[];if(this.eformControl!=null){if(this.eformControl.eform.multiView.isSocket&&this.eformControl.eform.m_signMirroringVisible){var r=this.toData();var g=mRe_copyObj(r);var o=g.splice(this.nSendSplitCount,r.length);if(null!=this._guideInfo){for(var m=0;m<o.length;m++){var n=o[m];for(var l=0;l<n.length;l++){var s=n[l];if(s.y){s.y+=this._guideInfo.y;}}}}this.eformControl.eform.multiView.socket.sendScreenSingleSignPath(o,this.eformControl.eform.m_uid,this.eformControl.ctrlID);this.nSendSplitCount=r.length;}if(null!=this._guideInfo){this.eformControl._setUndoDataSignObj(this);}}};f.prototype._handlePointerEvents=function(){this._mouseButtonDown=false;if(is_ie){this._handleMouseEvents();}else{this._canvas.style.msTouchAction="none";this._canvas.style.touchAction="none";this._canvas.addEventListener("pointerdown",this._handlePointerDown);if(null==self._guideInfo){this._canvas.addEventListener("pointermove",this._handlePointerMove);}document.addEventListener("pointerup",this._handlePointerUp);}};f.prototype._handleMouseEvents=function(){this._mouseButtonDown=false;this._canvas.addEventListener("mousedown",this._handleMouseDown);this._canvas.addEventListener("mousemove",this._handleMouseMove);document.addEventListener("mouseup",this._handleMouseUp);};f.prototype._reset=function(){this.points=[];this._lastVelocity=0;this._lastWidth=(this.minWidth+this.maxWidth)/2;this._ctx.fillStyle=this.penColor;};f.prototype._createPoint=function(g,j,i){var h=this._canvas.getBoundingClientRect();return new b(g-h.left,j-h.top,i||(new Date().getTime()%this._startTime));};f.prototype._addPoint=function(g){var k=this.points;var j=void 0;k.push(g);if(k.length>2){if(k.length===3){k.unshift(k[0]);}j=this._calculateCurveControlPoints(k[0],k[1],k[2]);var i=j.c2;j=this._calculateCurveControlPoints(k[1],k[2],k[3]);var h=j.c1;var m=new a(k[1],i,h,k[2]);var l=this._calculateCurveWidths(m);k.shift();return{curve:m,widths:l};}return{};};f.prototype._calculateCurveControlPoints=function(u,s,p){var t=u.x-s.x;var o=u.y-s.y;var r=s.x-p.x;var n=s.y-p.y;var x={x:(u.x+s.x)/2,y:(u.y+s.y)/2};var w={x:(s.x+p.x)/2,y:(s.y+p.y)/2};var i=Math.sqrt(t*t+o*o);var h=Math.sqrt(r*r+n*n);var g=x.x-w.x;var v=x.y-w.y;var j=h/(i+h);var q={x:w.x+g*j,y:w.y+v*j};var m=s.x-q.x;var l=s.y-q.y;return{c1:new b(x.x+m,x.y+l,(new Date().getTime()%this._startTime)),c2:new b(w.x+m,w.y+l,(new Date().getTime()%this._startTime))};};f.prototype._calculateCurveWidths=function(l){var k=l.startPoint;var g=l.endPoint;var j={start:null,end:null};var i=this.velocityFilterWeight*g.velocityFrom(k)+(1-this.velocityFilterWeight)*this._lastVelocity;var h=this._strokeWidth(i);j.start=this._lastWidth;j.end=h;this._lastVelocity=i;this._lastWidth=h;return j;};f.prototype._strokeWidth=function(g){return Math.max(this.maxWidth/(g+1),this.minWidth);};f.prototype._drawPoint=function(g,j,i){var h=this._ctx;h.moveTo(g,j);h.arc(g,j,i,0,2*Math.PI,false);this._isEmpty=false;};f.prototype._drawCurve=function(k,m,g){var A=this._ctx;var w=g-m;var n=Math.round(k.length());if(this.isSetPathPaint){if(n==0){n=1;}}A.beginPath();for(var l=0;l<n;l+=1){var z=l/n;var o=z*z;var s=o*z;var v=1-z;var j=v*v;var p=j*v;var r=p*k.startPoint.x;r+=3*j*z*k.control1.x;r+=3*v*o*k.control2.x;r+=s*k.endPoint.x;var q=p*k.startPoint.y;q+=3*j*z*k.control1.y;q+=3*v*o*k.control2.y;q+=s*k.endPoint.y;var h=m+s*(w+k.endPoint.w);this._drawPoint(r,q,h);}A.closePath();A.fill();};f.prototype._drawDot=function(g){var h=this._ctx;var i=typeof this.dotSize==="function"?this.dotSize():this.dotSize;h.beginPath();this._drawPoint(g.x,g.y,i+g.w);h.closePath();h.fill();};f.prototype._fromDataToExe=function(g,o,p,k){var r=this._ctx;r.strokeStyle=k;for(var n=0;n<g.length;n+=1){var q=g[n];r.lineWidth=this.minWidth;if(q.length>3){r.lineCap="round";r.beginPath();for(var l=0;l<q.length;l+=1){var h=q[l];if(l==0){r.moveTo(h.x,h.y);}else{if(l-1==q.length){r.lineWidth=this.minWidth+(h.w/o);r.lineTo(h.x,h.y);r.stroke();r.closePath();}else{r.lineWidth=this.minWidth+(h.w/o);r.lineTo(h.x,h.y);r.stroke();r.closePath();r.lineWidth=1;r.beginPath();r.moveTo(h.x,h.y);}}}}else{this._reset();var m=q[0];p(m);}}};f.prototype._fromData=function(h,g,s){for(var r=0;r<h.length;r+=1){var u=h[r];if(u.length>3){for(var p=0;p<u.length;p+=1){var o=u[p];var t=new b(o.x,o.y,o.time,o.w);var n=o.color;if(p===0){this.penColor=n;this._reset();this._addPoint(t);}else{if(p!==u.length-1){var l=this._addPoint(t),k=l.curve,m=l.widths;if(k&&m){g(k,m,n);}}else{}}}}else{this._reset();var q=u[0];s(q);}}};f.prototype._toSVG=function(){var v=this;var k=this._data;var l=this._canvas;var w=Math.max(window.devicePixelRatio||1,1);var o=0;var m=0;var j=l.width/w;var g=l.height/w;var s=document.createElementNS("http://www.w3.org/2000/svg","svg");s.setAttributeNS(null,"width",l.width);s.setAttributeNS(null,"height",l.height);this._fromData(k,function(B,z,y){var A=document.createElement("path");if(!isNaN(B.control1.x)&&!isNaN(B.control1.y)&&!isNaN(B.control2.x)&&!isNaN(B.control2.y)){var i="M "+B.startPoint.x.toFixed(3)+","+B.startPoint.y.toFixed(3)+" "+("C "+B.control1.x.toFixed(3)+","+B.control1.y.toFixed(3)+" ")+(B.control2.x.toFixed(3)+","+B.control2.y.toFixed(3)+" ")+(B.endPoint.x.toFixed(3)+","+B.endPoint.y.toFixed(3));A.setAttribute("d",i);A.setAttribute("stroke-width",(z.end*2.25).toFixed(3));A.setAttribute("stroke",y);A.setAttribute("fill","none");A.setAttribute("stroke-linecap","round");s.appendChild(A);}},function(i){var z=document.createElement("circle");var y=typeof v.dotSize==="function"?v.dotSize():v.dotSize;z.setAttribute("r",y);z.setAttribute("cx",i.x);z.setAttribute("cy",i.y);z.setAttribute("fill",i.color);s.appendChild(z);});var u="data:image/svg+xml;base64,";var r='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"'+(' viewBox="'+o+" "+m+" "+j+" "+g+'"')+(' width="'+j+'"')+(' height="'+g+'"')+">";var t=s.innerHTML;if(t===undefined){var n=document.createElement("dummy");var h=s.childNodes;n.innerHTML="";for(var q=0;q<h.length;q+=1){n.appendChild(h[q].cloneNode(true));}t=n.innerHTML;}var x="</svg>";var p=r+t+x;return u+btoa(p);};f.prototype.fromDataToExe=function(h,j,g){var i=this;this._clear();this._fromDataToExe(h,j,function(k){return i._drawDot(k);},g);this._data=h;};f.prototype.fromData=function(g){var h=this;this._clear();if(null!=g){this.nSendSplitCount=g.length;}this._fromData(g,function(j,i){return h._drawCurve(j,i.start,i.end);},function(i){return h._drawDot(i);});this._data=g;};f.prototype.toData=function(){return this._data;};f.prototype.undo=function(){if(this._data.length>0){var i=mRe_copyObj(this._data);var h=i.pop();this._undoData.push(h);this.fromData(i);if(this.orginTempPath!=null&&this.orginTempPath.length>0){var g=this.orginTempPath.pop();this._undoData2.push(g);}}};f.prototype.redo=function(){if(this._undoData.length>0){var h=this._undoData.pop();var i=mRe_copyObj(this._data);i.push(h);this.fromData(i);if(this.orginTempPath!=null&&this._undoData2.length>0){var g=this._undoData2.pop();this.orginTempPath.push(g);}}};f.prototype.undoRedoClear=function(){this._undoData=[];this._undoData2=[];};return f;})));window.m_report_language_map={lic_error:["리포트 서버 라이센스에 문제가 있습니다.","Report a problem with the server license.","レポートサーバーのライセンスに問題があります。","报告服务器许可证出现问题。"],report_error:["잘못된 결과입니다.","Invalid results","結果が正しくありません。","结果错误。"],report_error2:["보고서 양식이 잘못되었습니다.(페이지가 없습니다.)","Report form is incorrect. (There is no page.)","レポートフォームが間違っています。（ページがありません。）","报告的形式不正确。 （没有页。）"],install_error:["리포트 서버 설치에 문제가 있습니다.","There is a problem with the report server installation.","レポートサーバーのインストールに問題があります。","报告服务器的安装出现问题。"],sesstion_error:["리포트파일이 삭제되어 찾을 수 없습니다.","This session has been terminated.","セッションが終了しました。","会话结束。"],link_error:["리포트 서버와의 연결에 실패하였습니다.","It failed to connect to the report server.","これは、レポートサーバーへの接続に失敗しました。","它无法连接到报表服务器。"],img_alt:["리포트 본문 입니다.","The body of the report.","レポートの本文です。","报告正文。"],save:["저장","Save","保存","保存"],ignore:["무시","Ignore","無視","忽略"],cancel:["취소","Cancel","キャンセル","取消"],reset:["초기화","Reset","リセット","重置"],del:["삭제","Delete","リセット","重置"],load:["가져오기","Load","Load","Load"],pdf_save:["PDF 저장","PDF file","PDF形式で保存","保存成PDF文件"],excel_save:["엑셀 저장","Excel file","エクセル形式で保存","保存成表格文件"],hwp_save:["한글 저장","HWP file","ハングル形式で保存","保存成hwp文件"],rtf_save:["RTF 저장","RTF file","RTF形式で保存","保存成RTF文件"],ppt_save:["PPT 저장","PPT file","PPT形式で保存","保存成PPT文件"],pptx_save:["PPTX 저장","PPTX file","PPTX形式で保存","保存成PPTX文件"],html_save:["HTML 저장","HTML file","HTML形式で保存","保存成HTML文件"],hancell_save:["한셀 저장","Hancell file","ハンセル形式で保存","保存成Hancell文件"],hanshow_save:["한쇼 저장","Hanshow file","Hanshow file","保存成Hanshow文件"],html5_save:["HTML5 저장","HTML5 file","HTML5形式で保存","保存成HTML 5文件"],doc_save:["DOC 저장","DOC file","DOC形式で保存","保存成DOC文件"],docx_save:["DOCX 저장","DOCX file","DOCX形式で保存","保存成DOCX文件"],brl_save:["BRL 저장","BRL file","BRL形式で保存","保存成BRL文件"],jpg_save:["JPG 저장","JPG file","JPG形式で保存","保存成JPG文件"],tif_save:["TIF 저장","TIF file","TIF形式で保存","保存成TIF文件"],excelData_save:["엑셀(data only) 저장","excel data only file","excel data only形式で保存","保存成excel data only文件"],txt_save:["TXT 저장","TXT file","TXT形式で保存","保存成TXT文件"],print:["인쇄","Print","印刷","打印"],doodle:["형광펜","highlighter","蛍光ペン","荧光笔"],doodleSetting:["형광펜설정","highlighter settings","highlighter settings","highlighter settings"],doodleEraser:["지우개","eraser","eraser","eraser"],doodleClear:["모두지우기","clear all","clear all","clear all"],doodleRequired:["필수항목표시","show required items","show required items","show required items"],doodleSave:["형광펜저장","save highlighter","save highlighter","save highlighter"],memo:["메모","memo","memo","memo"],first_page:["첫 페이지로 이동","First Page","先頭ページ","首页"],prv_page:["이전 페이지로 이동","Previous Page","前のページ","上一页"],page:["현재 페이지","Page","ページ","页数"],total_page:["전체 페이지","All Page","全てのページ","全部页"],next_page:["다음 페이지로 이동","Next Page","次のページ","下一页"],last_page:["마지막 페이지로 이동","Last Page","最後のページ","末页"],splitPage:["페이지 분할 저장","Page Split Save","Page 分割保存","Page 斯普利特保存"],zoomIn:["화면 비율 선택","Zoom","画面の比率を選択","选择画面分配率"],report_info:["등록 정보","Information","登録情報","注册信息"],close:["닫기","Close","閉じる","关闭"],clipReport:["클립리포트","Clipreport","Clipreport","Clipreport"],clipEform:["클립이폼","Clipeform","Clipeform","Clipeform"],version:["버전","Version","バージョン","版本"],webversion:["뷰어","Viewer","Viewer","Viewer"],build:["빌드","Build","ビルド","新建"],report_info_text:["경고:이 컴퓨터 프로그램은 저작권법과 국제 협약의 보호를 받습니다.\n이 프로그램의 전부 혹은 일부를 무단으로 복제, 배포하는 행위는 민사\n및 형사법에 의해 엄격히 규제되어 있으며 기소의 사유가 됩니다.","This program is ClipReport4.0 viewer that\nwas develop and deploy by the Clipsoft","警告:このコンピュータープログラムは、著作権法と国際条約による保護を受けています。\nこのプログラムの全部若しくは一部を無断で複製、配布する行為は、民事\n及び刑事法により厳しく規制されており起訴事由となります。","警告：本计算机程序受著作权法和国际协议的保护。\n任意复制、发放本程序的全部或部分的行为严格受到民事\n和刑事法的管制，构成起诉的事由。"],ok:["확인","Ok","確認","确定"],fileType:["파일형식","File Type","ファイル形式","文件形式"],printType:["인쇄방식","Type","印刷方法","打印方式"],propertys:["옵션수정","Settings","オプションの修正","修改选项"],fileName:["파일명","Location","ファイル名","文件名"],save_range:["저장범위","Range","保存範囲","保存范围"],from:["부터"," from"," から","从"],to:["까지"," to"," まで","至"],currentPage:["현재 페이지","Current Page","現在のページ","当前页"],page_designation:["페이지 지정","Page","ページ指定","保存页"],NofC:["매수","Number of Copies","部数","张"],print_info:["인쇄정보","Information","印刷情報","打印信息"],print_info2:["인쇄 안내","Information","印刷案内","打印说明"],print_range:["인쇄범위","Range","印刷範囲","打印范围"],printName_validation:["파일이름이 올바르지 않습니다.","File name is incorrect.","ファイル名が正しくありません。","文件名不正确。"],printNum_validation:["저장범위의 지정 값이 올바르지 않습니다.","The specified value of the storage range is incorrect.","保存範囲に指定した値が正しくありません。","保存范围的指定值不正确。"],exeViewer_info:["EXE뷰어 안내","Information","印刷情報","打印信息"],sheet_type:["시트구분","Sheet Type","シートの区分け","表格区分"],sheet_type1:["페이지 마다","Pages","ページ毎に","每页"],sheet_type2:["하나의 시트","One Sheet","一つのシート","一个表格"],sheet_type3:["하나의 시트(페이지 영역 무시)","One Sheet(igore a page layout)","一つのシート(ページ領域を無視)","一个表格(忽略页面布局)"],sheet_type4:["리포트 마다(페이지 영역 무시)","One Sheet for each report(ignore a page layout)","レポート毎に","每份报告"],sheet_type5:["리포트 마다","One Sheet for each report","各レポートの一枚","一张纸上为每个报表"],merge_cell:["셀 합치기","Merge Cells","セルの結合","合并单元格"],merge_EmptyCell:["공백 셀일 경우 합치기","Merge blank cells","空白セルの場合結合","合并空白单元格"],cell_Separated:["페이지 크기로 셀 분리","Split row at the end of each page","ページのサイズに合わせてセルを分離","按照页面大小拆分单元格"],rightToLeft:["열이 오른쪽에서 왼쪽으로 진행","Display a sheet in a RTL(Right-to-left) layout","列番号を右から左へ表示","纵列自由向左进行"],fitToPageWhenPrinting:["출력시 페이지 맞춤","Fit page at the time of output","出力時のページ合わせる","在输出时适合页面"],cellSizeRatio:["셀 크기 비율","The ratio of a cell's size","セルサイズの比率","单元格大小比例"],cellWidth:["가로 비율","Column","横比","横向比例"],cellHeight:["세로 비율","Row","縦比","纵向比例"],rangeError:["좌표 오차 범위","Error Range","座標誤差の範囲","坐标误差范围"],displayFormat:["일반 표시형식 처리","Format Cells","一般表示形式で処理","常规显示形式处理"],text:["텍스트","Text","テキスト","文本"],normal:["일반","General","一般","一般"],removeHyperlink:["하이퍼링크 제거","removeHyperlink","ハイパーリンクの削除","刪除超鏈接"],repeatPageSectionWhenAllSectionInOneSheet:["페이지 머리글/바닥글 반복","repeatPageSectionWhenAllSectionInOneSheet","repeatPageSectionWhenAllSectionInOneSheet","repeatPageSectionWhenAllSectionInOneSheet"],useSubreportNameAsSheetName:["리포트명을 시트명으로 사용","useSubreportNameAsSheetName","useSubreportNameAsSheetName","useSubreportNameAsSheetName"],clearEmptySubSection:["비어있는 영역 무시","Ignore empty areas","Ignore empty areas.","Ignore empty areas."],clearCrosstabHeader:["반복되는 크로스탭 헤더 무시","repeated cross-tap header disregard","repeated cross-tap header disregard","repeated cross-tap header disregard"],defaultPageSheetName:["기본 페이지 시트명","defaultPageSheetName","defaultPageSheetName","defaultPageSheetName"],printRate:["인쇄 확대/축소 비율","Zoom Rate","印刷拡大/縮小比率","打印放大/缩小比例"],widthError:["가로 비율의 설정값이 올바르지 않습니다.","Setting value of the Column is not correct.","横比の設定値が正しくありません。","横向比例的设定值不正确。"],heightError:["세로 비율의 설정값이 올바르지 않습니다.","Setting value of the Row is not correct.","縦比の設定値が正しくありません。","纵向比例的设定值不正确。"],widthErrorValue:["가로 비율의 설정값은 (50 ~ 200) 가능합니다.","Setting value of the Column, ( 50-200 ) is possible.","設定可能な横比の値は(50 ~ 200)です。","横向比例的设定值可在(50~200)范围内。"],heightErrorValue:["세로 비율의 설정값은 (50 ~ 200) 가능합니다.","Setting value of the Row, ( 50-200 ) is possible.","設定可能な縦比の値は(50 ~ 200)です。","纵向比例的设定值可在(50~200)范围内。"],coordinateError:["좌표 오차 범위의 설정값이 올바르지 않습니다.","Setting value of the error range of coordinates is incorrect.","座標誤差範囲の設定値が正しくありません。","坐标误差范围的设定值不正确。"],printError:["인쇄 확대/축소 비율의 설정값이 올바르지 않습니다.","Setting of print enlargement / reduction ratio is not correct.","印刷拡大/縮小比率の設定値が正しくありません。","打印放大/缩小比例的设定值不正确。"],printErrorValue:["인쇄 확대/축소 비율의 설정값은 (10 ~ 400) 가능합니다.","Setting of print enlargement / reduction ratio , ( 10-400 ) is possible.","設定可能な印刷拡大/縮小比率の値は(10 ~ 400)です。","打印放大/缩小比例可在(10~400)范围内。"],hwpExportMethod:["저장 방식","Storage method","保存方式","保存方法"],splitPageOnListTableOnly:["페이지 나눔","Page split","ページ分割","页面师"],listTableOnly:["표만 나열하기","ListTableOnly","切符だけリストする","要只列出票"],fixSize:["크기 고정","Locks controls","サイズを固定","固定尺寸"],allowOverlay:["겹침 허용","Overlay","重ね合わせを許可","允许重叠"],setPageBottomMarginToZero:["페이지 바닥 여백을 0으로 설정","Set the bottom margin of the page to 0","ページ下部の余白を「０」に設定","页脚空白设为0"],pageBottomMarginApplicationRate:["페이지 바닥 여백 적용비율","Application rate of margin","余白の適用率","保证金的应用率"],insertPageNumber:["페이지 넘버 삽입","insert Page Number","insert Page Number","insert Page Number"],outputLikeWord:["글자처럼 출력","In Line with Text","文字のように出力","打印文字"],tableSplit:["쪽 영역에서 표 나눔","Split Table","改ページ領域でテーブルを分割","页域内拆分表"],Split:["나눔","Split Table","分割","拆分"],cellSplit:["셀 단위로 나눔","Split Table by row","セル単位に分割","以单元格单位拆分"],noneSplit:["나누지 않음","Do not split","分割しない","不拆分"],defaultCharGap:["기본 자간","Default a character spacing","基本カーニング","基本字间距"],charRatio:["장평","Character Ratio","字送り","字符比率"],lineSpaceRate:["줄간격 비율","Ratio of line spacing","行間隔の比率","行距的比率"],putCheckboxIntoCell:["셀 안에 체크박스 이미지로 넣기","Place a checkbox in a cell","セル内にチェックボックスを挿入","在单元格中添加复选框"],splitTextByLine:["문자열을 여러줄로 나눠서 표현","Split a multi-line text into lines.","テキストをライン別に分けて表示","分行显示文本"],defaultCharGapError:["기본 자간의 설정값이 올바르지 않습니다.","Setting value of the Default a character spacing is not correct.","設定した基本カーニング値が正しくありません。","基本字间距的设定值不正确。"],defaultCharGapValueError:["기본 자간의 설정값은 (-50 ~ 50) 가능합니다.","Setting value of the Default a character spacing, ( -50 ~ 50 ) is possible.","設定可能な基本カーニング値は(-50 ~ 50)です。","基本字间距的设定值可在(-50 ~ 50)范围内。"],defaultCharGapValue2Error:["기본 자간의 설정값은 (-3.0 ~ 3.0) 가능합니다.","Setting value of the Default a character spacing, ( -3.0 ~ 3.0 ) is possible.","設定可能な基本カーニング値は(-3.0 ~ 3.0)です。","基本字间距的设定值可在(-3.0 ~ 3.0)范围内。"],charRatioError:["장평의 설정값이 올바르지 않습니다.","Setting value of the Character Ratio is not correct.","設定した字送り値が正しくありません。","字符比率的设定值不正确。"],charRatioValueError:["장평의 설정값은 (50 ~ 200) 가능합니다.","Setting value of the Character ratio , ( 50-200 ) is possible.","設定可能な字送り値は(50 ~ 200)です。","字符比率的设定值可在(50 ~ 200)范围内。"],bottomMarginError:["여백 적용비율의 설정값이 올바르지 않습니다.","The setting value of the margin application rate is incorrect.","余白の適用率の設定値が正しくありません。","保证金的应用率的设定值是不正确的。"],bottomMarginValueError:["여백 적용비율의 설정값은 (1 ~ 100) 가능합니다.","The setting value of the margin application rate can be (1 to 100).","余白の適用率の設定値は、（1〜100）が可能です。","余量的施用率的设定值，就可以（1至100）。"],splitTextLine:["문자열을 여러 줄로 나누어 표현","Split a multi-line text into lines","文字列を複数行に分けて表示","分多行显示字符串"],processAsUnicode:["유니코드로 문자열을 처리","A text is encoded in Unicode format","文字列をユニコードとして処理","用字符编码处理字符串"],processEqualAlign:["균등분할 정렬 처리","Convert an equal alignment into","均等割付の整列指定","均等拆分排列"],soLeft:["왼쪽 정렬","Left","左揃え","靠左排列"],soCenter:["가운데 정렬","Center","中央揃え","居中排列"],soRight:["오른쪽 정렬","Right","右揃え","靠右排列"],soBoth:["양쪽 정렬","Both","両端揃え","两边对齐"],insertTableWrapper:["표를 감싸는 객체 삽입","Whether or not to insert an object that wraps around the table","テーブルを包み込むオブジェクトを挿入するかどうか","是否要插入的对象环绕表"],easyEditable:["간편 편집용","For easy editing","For easy editing","For easy editing"],tableWrapperBottomGap:["표를 감싸는 객체의 아래쪽 여백","The bottom margin of an object(a control) including a table","テーブルを囲っているオブジェクト下部の余白","表格周围个体的底部空白"],tableWrapperBottomGapError:["표의 아래쪽 여백 설정값이 올바르지 않습니다.","Setting value of the margin below is not correct.","テーブル下部の余白の設定値が正しくありません。","表格底部空白的设定值不正确。"],tableWrapperBottomGapValueError:["표의 아래쪽 여백 설정값은 (0 ~ 500) 가능합니다.","Setting value of the margin below , (0 ~ 500) is possible.","テーブル下部の余白の設定値は(0 ~ 500)です。","表格底部空白的设定值可在(0~500)范围内。"],mergeAllTablesOnListTableOnly:["모든 테이블 병합하기","Combine all the tables","Combine all the tables","Combine all the tables"],insertLabelWithTextOnListTableOnly:["글상자를 텍스트로 삽입","Put text in the text box","Put text in the text box","Put text in the text box"],isTransparentMode:["표의 모든 배경 투명으로 표시","All backgrounds of the table are transparent","All backgrounds of the table are transparent","All backgrounds of the table are transparent"],pageSplite:["페이지를 분할하여 저장","Save by dividing the page","ページを区切って保存","保存拆分页"],pageSpliteCount:["분할 수","Count","分割数","拆分数"],password:["문서암호","Password","文書パスワード","文件密码"],textToImage:["문자를 이미지로 표현","Text To Image","文字を画像として表示","图像显示文本"],importOriginImage:["원본 이미지 사용","Use Original Image","原画像を使用","使用原图"],pageSpliteCountError:["분할 수의 설정값이 올바르지 않습니다.","Setting value of the Count is not correct.","分割数の設定値が正しくありません。","拆分数的设定值不正确。"],html5page:["페이지 라인 표시","Show page breaks","ページ枠を表示","显示分页符号"],dpiError:["DPI의 설정값이 올바르지 않습니다.","Setting value of the DPI is not correct.","DPIの設定値が正しくありません。","DPI的设定值不正确。"],mergeTable:["이웃한 표 병합","Whether to merge the adjacent table","隣接したテーブルをマージするかどうか","是否合并相邻表"],ignoreLineSpace:["행간 무시","Line spacing ignored","行間無視","行间距忽略"],positionRelTo:["좌표 기준","Coordinate criteria","座標基準","协调标准"],paper:["종이","paper","紙","纸"],paragraph:["문단","paragraph","段落","段落"],fitShapeToText:["도형을 텍스트 크기에 맟춤","fitShapeToText","図形をテキストのサイズにカスタマイズされた","对文本的大小形状定制"],TableRowHeightSort:["표의 행의 높이 설정","TableRowHeightSort","表の行の高さを設定","设置在表中的行的高度"],excelDataNone:["저장안함","None","None","None"],excelDataAtOnce:["한번만","AtOnce","AtOnce","AtOnce"],excelDataRepeatAtEachPage:["페이지마다","RepeatAtEachPage","RepeatAtEachPage","RepeatAtEachPage"],languageInfo:["kr","en","jp","cn"],adobe9Info:["현재 Adobe Reader 9 버전이 설치되어 있습니다.","Version of Adode Reader 9 is installed currently .","現在、Adobe Reader 9がインストールされています。","当前已安装了Adobe Reader 9版本。"],adobe9Info2:["정상적인 인쇄를 사용하기 위해서는 Adode Reader 10 버전 이상을 설치하여야 합니다.","To use the normal printing , you need to install the version Adode Reader 10 and later.","正常に印刷するためには、Adode Reader 10以上をインストールする必要があります。","正常打印必须安装Adobe Reader 10以上的版本。"],adobe9Info3:["현재 사용 중이신 브라우져의 창을 종료 한 후 아래의 사이트를 통하여 설치 하시기 바랍니다.","After the completion of the browser window now gotten use it , please install via the following site .","現在ご利用中のブラウザを閉じた後、下記のサイトからインストールして下さい。","请关闭正在使用的浏览器窗口，通过下方网站安装。"],adobe9Info4:["설치 없이 인쇄를 원하신다면 저장 버튼을 이용하여 파일을 저장 후 인쇄 하실 수 있습니다.","After you save the file by using the Save button if you want to print without installing , you can print .","インストールせずに印刷したい場合は、[保存]をクリックしファイルを保存してから印刷して下さい。","若想不安装，直接打印，可以使用保存按钮保存文件后再打印。"],adobe9Info5:["현재 브라우져에서 Adobe Reader 찾을 수 없습니다.","We were not able to find Adode Reader in the browser now .","現在のブラウザで、Adobe Readerは見つかりません。","用当前的浏览器找不到Adobe Reader。"],chromePDFInfo1:["현재 브라우저에서 PDF 사용할 수 없습니다.","PDF is not available in the current.","PDF is not available in the current.","PDF is not available in the current."],chromePDFInfo2:["아래의 주소를 주소검색창에 복사하신 후 브라우저에서 PDF 열기를 허용으로 변경하셔야 정상적인 PDF 인쇄를 사용 하실 수 있습니다.","Copy the address below to the address search box and allow PDF to be opened in your browser You can use normal PDF printing only if you change it.","Copy the address below to the address search box and allow PDF to be opened in your browser You can use normal PDF printing only if you change it.","Copy the address below to the address search box and allow PDF to be opened in your browser You can use normal PDF printing only if you change it."],exeInfo1:["인쇄에 필요한 프로그램을 찾을 수 없습니다.","I could not find the program you need to print.","印刷に必要なプログラムを見つけることができませんでした。","我找不到你需要打印的程序。"],exeInfo2:["아래에 링크를 통하여 프로그램을 설치하시기 바랍니다.","Please install the program via the link below.","下にリンクを介してプログラムをインストールしてください。","请通过以下链接安装该程序。"],exeInfo3:["설치가 완료되면 다시 인쇄 하실 수 있습니다.","When the installation is complete, you can re-print.","インストールが完了すると、再印刷することができます。","当安装完成后，可以重新打印。"],exeInfo4:["현재 사용중이신 인쇄 프로그램은 업데이트가 필요합니다.","Print program of your current use, the update is required.","現在ご使用の印刷プログラムは、更新が必要になります。","当前的使用的打印程序，则需要进行更新。"],exeViewerInfo1:["EXE 뷰어 프로그램을 찾을 수 없습니다.","EXE viewer program not found.","",""],exeViewerInfo2:["아래에 링크를 통하여 프로그램을 설치하시기 바랍니다.","Please install the program via the link below.","下にリンクを介してプログラムをインストールしてください。","请通过以下链接安装该程序。"],exeViewerInfo3:["설치가 완료되면 EXE뷰어 프로그램을 통하여 리포트를 확인 하실 수 있습니다.","Once the installation is complete, you can view the report through the Exe Viewer program.","",""],exeViewerInfo4:["현재 사용중이신 EXE뷰어 프로그램은 업데이트가 필요합니다.","The EXE viewer program that is currently in use requires an update.","",""],printLimit1:["현재 리포트에 대한 인쇄 페이지 수가 많습니다.","Print number of pages of the current report is large.","現在のレポートの印刷ページ数が多すぎます。","当前报告打印页数多。"],printLimit2:["페이지가 많을 경우 속도 저하의 문제가 될 수 있으므로 PDF 저장 인쇄를 권장하고 있습니다.","If the page is large , because there is that the speed reduction of the problems , PDF save , I recommends printing .","ページが多い場合、速度が低下することがあるためPDF形式で保存、印刷することをお勧めします。","页数过多可能减低速度，建议保存成为PDF文件后打印。"],printSet1:["처음 인쇄를 시작하셨다면 브라우져의 설정이 필요합니다.","If this is the first time you start printing you will need to set the browser .","初めて印刷する場合は、ブラウザの設定が必要です。","首次打印时需要设定浏览器。"],printSet2:["브라우저의 메뉴에 파일 -> 페이지설정 사용하여 여백을 모두 0, 머리글, 바닥글 사용 안 함으로 설정하시고 저장하시면 됩니다.","File to the browser menu - > 0 the margin of using the settings of the page , the header , it is the footer disabled to save .","ブラウザメニューのファイル -> ページ設定で余白を全て「0」にし, 「ヘッダーとフッターを使用しない」に設定してから保存して下さい。","在浏览器菜单中选择文件->页面设定，将空白全部设为0，不使用页眉和页脚，保存即可。"],printSet3:["다음 인쇄 사용시 이 팝업을 원하지 않을 경우 표시 안함","It does not want to appear in the case you do not want pop-up at the next printing use","次回印刷する際、このポップアップ画面の表示を望まない場合は表示しない。","若下次打印时不希望看到此弹出窗口，将不显示。"],pdfPrintLimit1:["현재 사용 중이신 브라우져는 팝업창의 인쇄화면을 제공하고 있습니다.","Currently gotten your browser offers a print screen of the pop-up.","現在ご使用いただいてブラウザはポップアップの印刷画面を提供しています。","目前得到您的浏览器提供的弹出打印屏幕。"],pdfPrintLimit2:["아래의 확인 버튼을 누르시면 팝업 인쇄창을 확인 하실 수 있습니다.","When you press the [OK] button below, you will be able to confirm the pop-up print window.","下の[OK]ボタンを押すと、ポップアップ印刷ウィンドウを確認することができます。","当您按下下面的[确定]按钮，你将能够确认弹出打印窗口。"],pdfPrintLimit3:["현재 사용 중이신 Edge Browser는 팝업창의 인쇄화면을 제공하고 있습니다. 만약 Adobe Reader가 없다면 PDF 파일로 다운로드 됩니다.","Currently gotten your browser offers a print screen of the pop-up. If there is no Adobe Reader, it will be downloaded as a PDF file.","現在ご使用いただいてブラウザはポップアップの印刷画面を提供しています。もしAdobe Readerがない場合は、PDFファイルとしてダウンロードされます。","目前得到您的浏览器提供的弹出打印屏幕。如果没有Adobe Reader的，它会下载一个PDF文件。"],pdfPrintLimit4:["아래의 확인 버튼을 누르시면 확인 하실 수 있습니다.","You can check by pressing the [OK] button below.","下の[OK]ボタンを押すと確認することができます。","您可以检查按下面的[确定]按钮。"],waitMsg:["지금은 사용자가 많아 잠시 지연되고 있습니다.","There are so many users now that it is delaying for a while.","There are so many users now that it is delaying for a while.","There are so many users now that it is delaying for a while."],moveToSearchPage:["검색페이지로 이동","Move to Search Page","Move to Search Page","Move to Search Page"],searchContent:["검색내용","Search Content","Search Content","Search Content"],search:["검색","Search","Search","Search"],orderOfListAndListBySearched:["목록순서 및 검색된목록","Order of List and List by Searched","Order of List and List by Searched","Order of List and List by Searched"],moveUpOfList:["목록에서 위로 이동","Move Up of List","Move Up of List","Move Up of List"],moveDownOfList:["목록에서 아래로 이동","Move Down of List","Move Down of List","Move Down of List"],toggleListSize:["목록 크기 조절","Toggle List Size","Toggle List Size","Toggle List Size"],memoInfo:["메모","Memo","Memo","Memo"],memoText:["텍스트","Text","Text","Text"],memoPo:["위치 및 크기","Position and size","Position and size","Position and size"],memoPoX:["x좌표","x coordinate","x coordinate","x coordinate"],memoPoY:["y좌표","y coordinate","y coordinate","y coordinate"],memoPoWidth:["넓이","width","width","width"],memoPoHeight:["높이","height","height","height"],memoFont:["서식","Format","Format","Format"],memoFontSize:["글자 크기(pt)","Font Size(pt)","Font Size(pt)","Font Size(pt)"],memoFontColor:["글자 색","Font Color","Font Color","Font Color"],memoFontReSize:["글자 줄이기","Reduce characters","Reduce characters","Reduce characters"],memoFontBGColor:["배경 색","Background Color","Background Color","Background Color"],memoReplacement:["정렬","Replacement","Replacement","Replacement"],memoBlowingDirection:["말풍선방향","Blowing Direction","Blowing Direction","Blowing Direction"],memoCreate:["메모만들기","Creating a Memo","Creating a Memo","Creating a Memo"],memoSetting:["메모설정","Memo settings","Memo settings","Memo settings"],memoViewLook:["서식살펴보기","Look at the format","Look at the format","Look at the format"],necessaryInfoMsg:["필수 항목이 모두 체크되지 않았습니다.","All required items have not been checked.","All required items have not been checked.","All required items have not been checked."]};function mRe_report_language(c){var a=new Object();for(var b in window.m_report_language_map){a[b]=window.m_report_language_map[b][c];}return a;}var JSON;if(!JSON){JSON=new Object();}(function(){function d(f){return f<10?"0"+f:f;}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(f){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+d(this.getUTCMonth()+1)+"-"+d(this.getUTCDate())+"T"+d(this.getUTCHours())+":"+d(this.getUTCMinutes())+":"+d(this.getUTCSeconds())+"Z":null;};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(f){return this.valueOf();};}var c=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,h=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,i,b,k={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},j;function a(f){h.lastIndex=0;return h.test(f)?'"'+f.replace(h,function(l){var m=k[l];return typeof m==="string"?m:"\\u"+("0000"+l.charCodeAt(0).toString(16)).slice(-4);})+'"':'"'+f+'"';}function g(r,o){var m,l,s,f,p=i,n,q=o[r];if(q&&typeof q==="object"&&typeof q.toJSON==="function"){q=q.toJSON(r);}if(typeof j==="function"){q=j.call(o,r,q);}switch(typeof q){case"string":return a(q);case"number":return isFinite(q)?String(q):"null";case"boolean":case"null":return String(q);case"object":if(!q){return"null";}i+=b;n=[];if(Object.prototype.toString.apply(q)==="[object Array]"){f=q.length;for(m=0;m<f;m+=1){n[m]=g(m,q)||"null";}s=n.length===0?"[]":i?"[\n"+i+n.join(",\n"+i)+"\n"+p+"]":"["+n.join(",")+"]";i=p;return s;}if(j&&typeof j==="object"){f=j.length;for(m=0;m<f;m+=1){if(typeof j[m]==="string"){l=j[m];s=g(l,q);if(s){n.push(a(l)+(i?": ":":")+s);}}}}else{for(l in q){if(Object.prototype.hasOwnProperty.call(q,l)){s=g(l,q);if(s){n.push(a(l)+(i?": ":":")+s);}}}}s=n.length===0?"{}":i?"{\n"+i+n.join(",\n"+i)+"\n"+p+"}":"{"+n.join(",")+"}";i=p;return s;break;default:break;}}if(typeof JSON.stringify!=="function"){JSON.stringify=function(n,l,m){var f;i="";b="";if(typeof m==="number"){for(f=0;f<m;f+=1){b+=" ";}}else{if(typeof m==="string"){b=m;}}j=l;if(l&&typeof l!=="function"&&(typeof l!=="object"||typeof l.length!=="number")){mRe_ReportWebLog("JSON.stringify");}return g("",{"":n});};}if(typeof JSON.parse!=="function"){JSON.parse=function(n,f){var m;function l(r,q){var p,o,s=r[q];if(s&&typeof s==="object"){for(p in s){if(Object.prototype.hasOwnProperty.call(s,p)){o=l(s,p);if(o!==undefined){s[p]=o;}else{delete s[p];}}}}return f.call(r,q,s);}n=String(n);c.lastIndex=0;if(c.test(n)){n=n.replace(c,function(o){return"\\u"+("0000"+o.charCodeAt(0).toString(16)).slice(-4);});}if(/^[\],:{}\s]*$/.test(n.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){m=(new Function("return ("+n+")"))();return typeof f==="function"?l({"":m},""):m;}ReportWebLog("JSON.parse");};}}());var mCR_Base64=null;var Base64=mCR_Base64={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(c){var a="";var l,j,g,k,h,f,d;var b=0;c=mCR_Base64._utf8_encode(c);while(b<c.length){l=c.charCodeAt(b++);j=c.charCodeAt(b++);g=c.charCodeAt(b++);k=l>>2;h=((l&3)<<4)|(j>>4);f=((j&15)<<2)|(g>>6);d=g&63;if(isNaN(j)){f=d=64;}else{if(isNaN(g)){d=64;}}a=a+this._keyStr.charAt(k)+this._keyStr.charAt(h)+this._keyStr.charAt(f)+this._keyStr.charAt(d);}return a;},decode:function(d){if(!is_ie){d=new TextDecoder().decode(Uint8Array.from(atob(d),function(i){return i.charCodeAt(0);}));return d;}else{if(window.atob){var c=atob(d);c=mCR_Base64._utf8_decode(c);return c;}else{var a="";var m,k,h;var l,j,g,f;var b=0;d=d.replace(/[^A-Za-z0-9\+\/\=]/g,"");while(b<d.length){l=this._keyStr.indexOf(d.charAt(b++));j=this._keyStr.indexOf(d.charAt(b++));g=this._keyStr.indexOf(d.charAt(b++));f=this._keyStr.indexOf(d.charAt(b++));m=(l<<2)|(j>>4);k=((j&15)<<4)|(g>>2);h=((g&3)<<6)|f;a=a+String.fromCharCode(m);if(g!=64){a=a+String.fromCharCode(k);}if(f!=64){a=a+String.fromCharCode(h);}}a=mCR_Base64._utf8_decode(a);return a;}}},_utf8_encode:function(b){b=b.replace(/\r\n/g,"\n");var a="";for(var f=0;f<b.length;f++){var d=b.charCodeAt(f);if(d<128){a+=String.fromCharCode(d);}else{if((d>127)&&(d<2048)){a+=String.fromCharCode((d>>6)|192);a+=String.fromCharCode((d&63)|128);}else{a+=String.fromCharCode((d>>12)|224);a+=String.fromCharCode(((d>>6)&63)|128);a+=String.fromCharCode((d&63)|128);}}}return a;},_utf8_decode:function(a){var b="";var d=0;var f=c1=c2=0;while(d<a.length){f=a.charCodeAt(d);if(f<128){b+=String.fromCharCode(f);d++;}else{if((f>191)&&(f<224)){c2=a.charCodeAt(d+1);b+=String.fromCharCode(((f&31)<<6)|(c2&63));d+=2;}else{c2=a.charCodeAt(d+1);c3=a.charCodeAt(d+2);b+=String.fromCharCode(((f&15)<<12)|((c2&63)<<6)|(c3&63));d+=3;}}}return b;}};Report.prototype.notFoundEXEService=function(d){if(!this.m_isViewer){this.debugMeg("report log :: 설치된 exe Service 찾을 수 없습니다. pc에 설치가 필요합니다.");this.endDebugMeg(false);return;}this.debugMeg("report log :: 설치 안내창을 실행합니다.");this.endDebugMeg(false);this.disabledMenu(true);this.m_popupViewDiv=document.createElement("div");this.m_popupViewDiv.className="report_popup_view";this.m_bodyDiv.appendChild(this.m_popupViewDiv);var b=document.createElement("div");b.className="report_view_box report_Ex_NOTReader";b.style.height="150px";var a=new Array();a.push("<div style='position:absolute;left:13px;right:15px;top:5%;bottom:50px;border:1px solid darkgray'>");a.push("<div style='position:absolute;left:3px;right:3px;top:8%;'><span>");if(d){a.push(this.m_languageMap.exeInfo4);}else{a.push(this.m_languageMap.exeInfo1);}a.push("<br>"+this.m_languageMap.exeInfo2);a.push("</span><br>");var c=null!=this.m_exeLink?this.m_exeLink:("./install/CLIPreportPrintService_setup.exe");a.push("<a style='position:ralative' href='"+c+"' target='blank'>download</a><br>");a.push("<br><span>"+this.m_languageMap.exeInfo3+"</span>");a.push("</div></div>");a.push("<span class='report_view_box'  style='position:absolute;left:20px;top:2%;border:0;'>"+this.m_languageMap.print_info2+"</span>");a.push("<button title='"+this.m_languageMap.ok+"' onclick=\"m_reportHashMap['"+this.m_uid+"'].mRe_closeExeInstallView();return false;\" class='report_view_button' style='position:absolute;bottom:10px;right:15px; height:30px;width:75px;'>"+this.m_languageMap.ok+"</button>");b.innerHTML=a.join("");if(null!=this.m_popupViewDiv){this.m_popupViewDiv.appendChild(b);}this.m_printInfo_view=b;a=null;};Report.prototype.mRe_closeExeInstallView=function(){this.closePrintInfoWindow();this.disabledMenu(false);this.debugMeg("report log :: 설치 안내창을 종료합니다.");this.endDebugMeg(true);};Report.prototype.startEXEPrintResponse=function(a){try{this.debugMeg("report log :: 서비스 응답 >>>"+a);this.endDebugMeg(true);var c=null;if(typeof a==="string"){c=objectCall(ClipStrTrim(a));}else{c=a;}var b=this;window.clearInterval(this.m_exePrintStatus.intervalKey);if(c.result){window.setTimeout(function(){b.exePrintStatusCheck(c.port);},1500);}else{var f=c.serviceCode;this.debugMeg("report log :: exe print service에 문제가 발생하였습니다. 코드번호  >> "+f);this.endDebugMeg(false);if(this.m_isViewer){this.removePrintProgress();if(400==f){this.notFoundEXEService(false);}}mRe_ReportEventHandler(105);}}catch(d){this.m_exePrintStatus.disConnectCount++;this.debugMeg("report log :: 다른 로컬서버가 존재하는것 같습니다.");this.debugMeg("report log :: startEXEPrintResponse function error >> "+d);this.endDebugMeg(false);mRe_ReportEventHandler(104);}};Report.prototype.exePrintStatusCheck=function(g){this.m_exePrintStatus.portNumber=g;var a=this;var d={ClipID:"P02",uid:a.m_uid};var h="option="+JSON.stringify(d);this.debugMeg("report log :: 인쇄가 종료될 때 까지 서비스에 인쇄상태를 요청합니다. >>>"+h);if(window.XDomainRequest){var b=new XDomainRequest();if(b){b.onload=function(){a.exePrintStatusResult(b.responseText);};b.onerror=function(){mRe_ReportEventHandler(105);if(a.m_isViewer){a.removePrintProgress();}};b.open("GET",this.m_exePrintStatus.url+g+"?"+h);b.send();}}else{var f=this.m_exePrintStatus.url+g;var c="POST";if(typeof getExePrintAjaxType!="undefined"){c=getExePrintAjaxType();}$.ajax({type:c,url:f,crossDomain:true,data:h,success:function(i){a.exePrintStatusResult(i);},error:function(i){mRe_ReportEventHandler(105);if(a.m_isViewer){a.removePrintProgress();}}});}this.endDebugMeg(true);};Report.prototype.exePrintStatusResult=function(a){try{var c=null;if(typeof a==="string"){c=objectCall(ClipStrTrim(a));}else{c=a;}this.debugMeg("report log :: 서비스 응답 >>>"+c);var b=this;if(c.endPrint){if(this.m_isViewer){this.removePrintProgress();}if(c.okButton){this.debugMeg("report log :: 인쇄에 대한 이벤트가 종료 되었습니다. ");if(this.m_exePrintEvent.ok!=null){this.m_exePrintEvent.ok(c.errorCode);}mRe_ReportEventHandler(106);}else{if(c.cancelButton){this.debugMeg("report log :: 인쇄에 대한 이벤트가 취소 되었습니다. ");if(c.errorCode==2){this.notFoundEXEService(true);}if(this.m_exePrintEvent.cancel!=null){this.m_exePrintEvent.cancel(c.errorCode);}mRe_ReportEventHandler(107);}}this.endDebugMeg(false);}else{if(false==c.endPrint){this.debugMeg("report log :: 인쇄가 아직 진행중 입니다....");window.setTimeout(function(){b.exePrintStatusCheck(b.m_exePrintStatus.portNumber);},1500);}}}catch(d){this.debugMeg("report log :: exePrintStatusResult function error >> "+d);this.endDebugMeg(true);mRe_ReportEventHandler(105);if(this.m_isViewer){this.removePrintProgress();}}};Report.prototype.printEXEDirect=function(){this.debugMeg("<<<<<<<<<<<< 리포트 디버깅 로그를 시작합니다 >>>>>>>>>>>>>>>");this.debugMeg("userAgent Check :: "+agt);this.m_isViewer=false;if(this.m_reportKey!=null){this.checkReportCreate();}else{if(this.userJsp==null){this.newReportCreate(this.servletPath,this.oof);}else{this.newReportCreate(this.userJsp,null);}}};window.m_clipEFormSocket=null;window.m_clipIsBufferedSocket=false;window.mRe_socketSplitValue=5000;window.m_Re_heartbeat=30000;function setSocketSplitValue(a){window.mRe_socketSplitValue=a;}function setSocketHeartbeatTime(a){window.m_Re_heartbeat=a;}window.mRe_socketSendBlock=false;function setSocketSendBlock(a){window.mRe_socketSendBlock=a;ReportWebLog(" Socket Send Block Status Setter:"+a);}function EFormSocket(){this.eform=null;this.wsPath=null;this.elm_target=null;this.eform_key=null;this.room_key=null;this.isMain=true;this.is_report_show=false;this.webSocket=null;this.stateWs=0;this.conectionCnt=0;this.heartbeat_msg="--heartbeat--";this.heartbeat_interval=null;this.missed_heartbeats=0;this.userId_map=function(){};this.tabPlugin=null;this.closeReason="";window.m_clipEFormSocket=this;this.m_scrollYLock=false;this.m_scrollYLockTime=null;this.m_arrSendData=null;}EFormSocket.prototype.callStateChange=function(d,b){if(null!=d){this.stateWs=d;}if(null!=this.eform){if(!this.isMain&&b==204){var c={cmd:"call-event",type:"sub-alive"};this.systemSendData(c);}}if(null!=this.eform&&this.eform.m_socketViewEvent!=null){if(!(b==300||b==400)){this.closeMainChildWindow();}var a=this.eform.m_socketViewEvent(b);return a;}return false;};EFormSocket.prototype.main_connect_reset_info=function(a,b,c){this.isMain=true;this.eform=a;this.eform_key=b;this.elm_target=c;this.isSocketConn=true;};EFormSocket.prototype.main_connect_info=function(a,b,d,c,f){this.isMain=true;this.eform=a;this.wsPath=b;this.eform_key=d;this.room_key=c;this.elm_target=f;this.isSocketConn=false;};EFormSocket.prototype.sub_connect_info=function(a,b,c,d){this.isMain=false;this.eform=a;this.wsPath=b;this.room_key=c;this.elm_target=d;this.isSocketConn=false;};EFormSocket.prototype.connect=function(){this.debugMeg("중계 서버 접속 중입니다.");if(!this.callStateChange(1,1)){this.elm_target.innerHTML="서버 접속 중입니다.";}var b=this;if(this.wsPath=="localhost"){this.webSocket={};mWebSocket=this.webSocket;this.room_key="null";this.webSocket.send=function(d){if(b.isMain){if((window)&&(is_ReExternal)&&("MainWebBrowserCtrl_EFormHandleMessage" in ReExternal)){window.external.MainWebBrowserCtrl_EFormHandleMessage(d);}}else{if((window)&&(is_ReExternal)&&("SubWebBrowserCtrl_EFormHandleMessage" in ReExternal)){window.external.SubWebBrowserCtrl_EFormHandleMessage(d);}}};this.webSocket.close=function(){};window.mirroringWinFormMessage=function(f,g){if(g!=undefined){alert("mirroringWinFormMessage"+f);}var d={};d.data=f;mWebSocket.onmessage(d);};}else{var c="id:"+this.room_key+":connect to:"+this.wsPath;b.debugMeg(c);this.closeReason="";this.webSocket=new WebSocket(this.wsPath);}this.webSocket.onmessage=function(d){if(d.data===b.heartbeat_msg){b.missed_heartbeats=0;return;}b.message(d);};this.webSocket.onerror=function(d){b.debugMeg("onerror::"+d);if(b.stateWs!=110){b.reconection(d);}};this.webSocket.onopen=function(d){b.onopen(d);if(b.heartbeat_interval==null){b.missed_heartbeats=0;b.heartbeat_interval=setInterval(function(){try{b.missed_heartbeats++;if(b.missed_heartbeats>=3){throw new Error("Too many missed heartbeats.");}b.systemSendDataText(b.heartbeat_msg);}catch(f){clearInterval(b.heartbeat_interval);b.heartbeat_interval=null;b.debugMeg("Closing connection. Reason: "+f.stack);b.webSocket.close();}},window.m_Re_heartbeat);}};this.webSocket.onclose=function(d){b.debugMeg("onclose::"+d);if(b.heartbeat_interval!=null){clearInterval(b.heartbeat_interval);b.heartbeat_interval=null;}if(b.stateWs!=110){b.reconection(d);}};if(this.wsPath=="localhost"){var a={};a.data=JSON.stringify({cmd:"room-joined",roomkey:"null"});this.webSocket.onmessage(a);}};EFormSocket.prototype.abort=function(){this.stateWs=110;this.webSocket.close();};EFormSocket.prototype.reconection=function(c){if(c!="undefined"&&c.type!="close"){return;}var d=this.getSocketReason(c);var b=this.room_key+":close code:"+c.code+":close reason:"+d;this.debugMeg(b);this.closeReason+="\n"+b;this.callStateChange(100,100);if(typeof window.console!="undefined"){window.console.log("중계서버 error:try:"+this.conectionCnt+">>",c);}var a=this;this.conectionCnt++;if(this.conectionCnt>5){this.onerror(c);}else{var a=this;window.setTimeout(function(){a.connect();},5000);}};EFormSocket.prototype.onerror=function(d){var a=this;this.debugMeg("중계서버 error >>"+d);if(a.heartbeat_interval!=null){clearInterval(a.heartbeat_interval);a.heartbeat_interval=null;}if(!this.callStateChange(100,100)){var c=this.getTargetDiv();var b=document.createElement("span");b.innerHTML="중계서버에 장애가 발생했습니다. 잠시후에 재접속해주시기 바랍니다.";var f=document.createElement("button");f.innerHTML="재접속";f.onclick=function(){a.connect();};c.appendChild(b);c.appendChild(document.createElement("br"));c.appendChild(f);this.webSocket.close();}if(typeof ClipHybrid!="undefined"){ClipHybrid.callMirraring("show","");}};EFormSocket.prototype.onopen=function(f){this.debugMeg("중계서버 open >>"+f);this.callStateChange(200,200);this.conectionCnt=0;if(this.room_key==""){if(this.isMain){this.createRoom();}else{if(this.callStateChange(200,210)){var b=this;var d=this.getTargetDiv();var c=document.createElement("span");c.innerHTML="연결할 채널을 입력하세요.";var g=document.createElement("input");var h=document.createElement("button");h.innerHTML="연결하기";var a=this.isMain;h.onclick=function(){var i=g.value;b.systemSendData({cmd:"join-room",roomkey:i,isMain:a});};d.appendChild(c);d.appendChild(document.createElement("br"));d.appendChild(g);d.appendChild(h);}if(typeof ClipHybrid!="undefined"){ClipHybrid.callMirraring("show","");}}}else{this.createRoom(this.room_key);}};EFormSocket.prototype.createRoom=function(a){if(null!=a){this.systemSendData({cmd:"create-room",id:a,isMain:this.isMain});}else{this.systemSendData({cmd:"create-room",id:"",isMain:this.isMain});}};EFormSocket.prototype.closeMainChildWindow=function(){this.scrollTop="undefined";if(null!=this.tabPlugin){for(var a=0;a<this.tabPlugin.tabList.length;a++){var b=this.tabPlugin.tabList[a];if(null!=b.report){b.report.mRe_closeScroll_guider();b.report.removeAllBlockScreen();}}}else{if(null!=this.eform){this.eform.mRe_closeScroll_guider();this.eform.removeAllBlockScreen();}}};EFormSocket.prototype.message=function(q){try{var h=this.webSocket;var n=this.eform_key;var d=q.data;if(typeof onBeforeSocketReceive!=="undefined"){d=onBeforeSocketReceive(d);}var m=JSON.parse(d);var c=m.cmd;if(c!=null){if(c!="call-event"){this.debugMeg("중계서버 메시지 >> "+q.data);}if(c=="call-event"){this.callEventCommand(m);}else{if(c=="room-created"){var o=this.isMain;var k=m.roomkey;this.debugMeg("연결됨 룸키 >> "+k);this.systemSendData({cmd:"join-room",roomkey:k,isMain:o});}else{if(c=="room-joined"){var k=m.roomkey;this.debugMeg("room에 입장 완료");var g=this.callStateChange(200,201);if(this.isMain){if(this.room_key==""){if(!this.callStateChange(200,211)){var b=this.getTargetDiv();b.innerHTML="모바일 화면에서 "+k+"를 입력해주세요.";}}else{if(!g){var b=this.getTargetDiv();b.innerHTML="레포트 호출 중입니다.";}this.eform.default_view();this.is_report_show=true;}}else{if(typeof ClipHybrid!="undefined"){ClipHybrid.callMirraring("wait","업무처리중입니다. 잠시만 기다려주세요.");}else{if(!this.callStateChange(200,201)){var b=this.getTargetDiv();b.innerHTML="pc 접속 대기중 입니다. <br/>대기화면... ";}}}}else{if(c=="room-notexist"){this.debugMeg("room이 존재하지 않음.");alert("room key가 올바르지 않습니다. 다시입력해주세요.");}else{if(c=="room-enter"){this.callStateChange(200,204);this.debugMeg("sub가 접속. 레포트 호출.");if(this.isMain){this.is_report_show=true;if(is_exeMirroringMain){this.callStateChange(null,500);}}}else{if(c=="room-empty"){var g=this.callStateChange(200,202);if(this.isMain){if(!g){var b=this.getTargetDiv();b.innerHTML="모바일 기기로 접속해주시기 바랍니다.";}}}else{if(c=="show-report"){this.callStateChange(400,400);if(!this.isMain){this.sendAppSubType();var l=m.eformkey;this.eform=resetSubEForm(this.eform);this.eform.m_reportKey=l;if(typeof ClipHybrid!="undefined"){ClipHybrid.callMirraring("show","");}if(this.eform.m_subReportEvent.callReportBefore!=null){this.eform.m_subReportEvent.callReportBefore();}this.eform.default_view();this.is_report_show=true;}}else{if(c=="room-leave"){var g=this.callStateChange(200,203);var k=m.roomkey;var b=null;if(this.isMain){if(null!=this.eform){if(this.eform.m_isEndReport&&this.eform.m_isServerSyncMirroring){if(null==this.tabPlugin){this.eform.eFormTempSubmitSave();}else{this.tabPlugin.mRe_TempSubmitSave(this.eform);}}}if(this.room_key==""){if(!this.callStateChange(200,211)){if(!is_exeMirroring){b=this.getTargetDiv();b.innerHTML="모바일 화면에서 "+k+"를 입력해주세요.";}}return;}else{if(!this.callStateChange(100,120)){if(!is_exeMirroring){b=this.getTargetDiv();b.innerHTML="모바일 기기에 연결이 종료 되었습니다. 재접속해주시기 바랍니다.";}}}}else{if(this.room_key==""){if(!this.callStateChange(200,210)){b=this.getTargetDiv();var a=this;var f=document.createElement("span");f.innerHTML="연결할 채널을 입력하세요.";var j=document.createElement("input");var p=document.createElement("button");p.innerHTML="연결하기";var o=this.isMain;p.onclick=function(){var r=j.value;a.systemSendData({cmd:"join-room",roomkey:r,isMain:o});};b.appendChild(f);b.appendChild(document.createElement("br"));b.appendChild(j);b.appendChild(p);}}else{if(typeof ClipHybrid!="undefined"){ClipHybrid.callMirraring("wait","업무처리중입니다. 잠시만 기다려주세요.");}else{if(!g){b=this.getTargetDiv();b.innerHTML="pc 접속 대기중 입니다. <br/>대기화면... ";}if(null!=this.tabPlugin){this.tabPlugin.resetAllTab();}}}}}else{if(c=="room-full"){var b=this.getTargetDiv();b.innerHTML="이미 접속되어 있습니다.다시 접속해주시기 바랍니다.";this.webSocket.close();}else{if(c=="room-disconnection"){if(!this.callStateChange(110,110)){var b=this.getTargetDiv();b.innerHTML="다른 접속에 의해서 연결이 해제 되었습니다.";}this.webSocket.close();}}}}}}}}}}}}catch(i){ReportWebLog(i.stack);}};EFormSocket.prototype.callEventCommand=function(d){if(d.type=="sub-alive"){this.callStateChange(200,205);}var h=false;if(d.type=="doodle"){this.receiveDoodle(d);}if(d.type=="doodleDrawBase64"){this.receiveDoodleDrawBase64(d);h=true;}else{if(d.type=="pagemove"){this.receivePageMove(d);}else{if(d.type=="focusctrl"){this.receiveFocusControl(d);}else{if(d.type=="signClick"){this.receiveSignClickEvent(d);}else{if(d.type=="inputbox"){this.receiveInputValue(d);}else{if(d.type=="checkbox"){this.receiveInputCheckbox(d);}else{if(d.type=="radiobox"){this.receiveInputRadiobox(d);}else{if(d.type=="button"){this.receiveInputButton(d);}else{if(d.type=="video"){this.receiveInputVideo(d);}else{if(d.type=="image"){this.receiveInputImage(d);h=true;}else{if(d.type=="imageOrigin"){this.receiveInputImageOrigin(d);h=true;}else{if(d.type=="sign"){this.receiveInputSign(d);h=true;}else{if(d.type=="signPath"){this.receiveInputSignPath(d);h=true;}else{if(d.type=="signPathAll"){this.receiveInputSignPathAll(d);h=true;}else{if(d.type=="signApplyPath"){this.receiveInputSignApplyPath(d);h=true;}else{if(d.type=="signApplyPathAll"){this.receiveInputSignApplyPathAll(d);h=true;}else{if(d.type=="signGroupPath"){this.receiveSignPath(d);h=true;}else{if(d.type=="multiSignGroupPath"){this.receiveMultiSignGroupPath(d);h=true;}else{if(d.type=="multiSignPath"){this.receiveMultiSignPath(d);h=true;}else{if(d.type=="multiSignPathBase64"){this.receiveMultiSignPathBase64(d);h=true;}else{if(d.type=="screenSingleSignPath"){this.receiveScreenSingleSignPath(d);h=true;}else{if(d.type=="screenSingleSignPathBase64"){this.receiveScreenSingleSignPathBase64(d);h=true;}else{if(d.type=="screenSingleSignPathClear"){this.receiveScreenSingleSignPathClear(d);}else{if(d.type=="signUndoRedo"){this.receiveSignUndoRedo(d);}else{if(d.type=="signlock"){this.receiveInputSignLock(d);}else{if(d.type=="screenlock"){this.receiveScreenLock(d);}else{if(d.type=="screenlockStampButton"){this.receiveScreenLockStampButton(d);}else{if(d.type=="mainscreenlock"){this.receiveMainScreenLock(d);}else{if(d.type=="mainscreenunlock"){this.receiveMainScreenUnLock(d);}else{if(d.type=="calendar"){this.receiveInputCalendar(d);}else{if(d.type=="selectbox"){this.receiveInputSelectbox(d);}else{if(d.type=="ctrlDisabled"){this.receiveDisabled(d);}else{if(d.type=="ctrlGuideText"){this.receiveGuideText(d);}else{if(d.type=="ctrlSelectedClick"){this.receiveSelectedClick(d);}else{if(d.type=="serverSyncMirroring"){this.receiveServerSyncMirroring(d);}else{if(d.type=="ctrlNecessaryCheck"){this.receiveNecessaryCheck(d);}else{if(d.type=="ctrlVisibled"){this.receiveVisibled(d);}else{if(d.type=="mainData"){this.receiveCallMainData(d);}else{if(d.type=="endSubData"){this.receiveEndSubData(d);}else{if(d.type=="subData"){this.receiveSubDataData(d);h=true;}else{if(d.type=="subDataMulti"){this.receiveSubDataMulti(d);h=true;}else{if(d.type=="bufferedSendDataMulti"){this.receiveBufferedDataMulti(d);h=true;}else{if(d.type=="changeMode"){this.receiveChangeMode(d);}else{if(d.type=="exeSubCallEvent"){this.receiveExeSubCallEvent(d);}else{if(d.type=="exeSubAlive"){this.receiveExeSubAlive(d);}else{if(d.type=="exeSubAliveAnswer"){this.receiveExeSubAliveAnswer(d);}else{if(d.type=="scroll"&&this.isMain){this.receiveScrollPosition(d);}else{if(d.type=="scrollY"){this.receiveScrollYPosition(d);}else{if(d.type=="subviewzoom"){this.receiveSubViewZoom(d);}else{if(d.type=="mainviewpoint"){this.receiveMainViewPoint(d);}else{if(d.type=="moveUp"){this.receiveMoveUp();}else{if(d.type=="moveDown"){this.receiveMoveDown();}else{if(d.type=="scrollTo"){this.receiveScrollTo(d);}else{if(d.type=="syncSign"){this.receiveSyncSignView(d);}else{if(d.type=="syncSignHybrid"){this.receiveSyncSignHybridView(d);}else{if(d.type=="hybridSignEvent"){this.receiveHybridSignViewEvent(d);}else{if(d.type=="hyInputFocusCtrl"){this.receiveHybridInputFocusControl(d);}else{if(d.type=="hyInputCallKeyboard"){this.receiveHybridInputCallKeyboard(d);}else{if(d.type=="hyInputCallCalendar"){this.receiveHybridInputCallCalendar(d);}else{if(d.type=="HybirdClose"){this.receiveHybirdClose(d);}else{if(d.type=="HybirdAppScreenLock"){this.receiveSubAppScreenLock(d);}else{if(d.type=="HybirdAppRemoteReset"){this.receiveAppRemoteReset(d);}else{if(d.type=="mainStampScannerData"){this.receiveMainStampScannerData(d);}else{if(d.type=="mainStampScannerBase64"){this.receiveMainStampScannerBase64(d);}else{if(d.type=="HybirdAppRemoteOK"){this.receiveAppRemoteOK(d);}else{if(d.type=="SingleSignOk"){this.receiveSingleSignOk(d);}else{if(d.type=="SingleSignReset"){this.receiveSingleSignReset(d);}else{if(d.type=="subClose"){var f=this.getTargetDiv();f.innerHTML="";this.eform=resetSubEForm(this.eform);this.is_report_show=false;if(typeof ClipHybrid!="undefined"){ClipHybrid.callMirraring("wait","업무처리중입니다. 잠시만 기다려주세요.");}if(this.eform.m_subReportEvent.closeReportAfter!=null){this.eform.m_subReportEvent.closeReportAfter();}}else{if(d.type=="subType"){if(null!=this.eform){this.eform.isSubAppType=d.is_app;}}else{if(d.type=="userData"){if(this.eform.m_socketReportEvent.userData!=null){if(null!=d.userId){var a=this.userId_map[d.userId];if(null==a){var c={receiveCount:0,dataList:[]};this.userId_map[d.userId]=a=c;}a.dataList[d.index]=d.data;a.receiveCount++;if(a.receiveCount==d.totalCnt){var b=a.dataList.join("");this.eform.m_socketReportEvent.userData(JSON.parse(mCR_Base64.decode(b)));this.userId_map[d.userId]=null;}}}}else{if(d.type=="stampCall"){this.receiveStampCall(d);}else{if(d.type=="exeStampCall"){this.receiveExeStampCall(d);}else{if(d.type=="exeMainStampData"){this.receiveExeMainStampData(d);}else{if(d.type=="CloseStampProgress"){this.receiveCloseStampProgress(d);}else{if(d.type=="stampData"){this.receiveStampData(d);h=true;}else{if(d.type=="stampMainCancel"){this.receiveStampMainCancel(d);}else{if(d.type=="stampSubCancel"){this.receiveStampSubCancel(d);}else{if(d.type=="signUseStamp"){this.receiveInputUseStamp(d);}else{if(d.type=="appPreViewSign"){this.receiveAppPreViewSignBase64(d);}else{if(d.type=="necessaryInfo"){this.receiveNecessaryInfo(d);}else{if(d.type=="rulesControlInfo"){this.receiveRulesControlInfo(d);}else{if(d.type=="rulesSectionVisible"){this.receiveRulesSectionVisible(d);}else{if(d.type=="rulesControlColor"){this.receiveRulesControlColor(d);}else{if(d.type=="popupSubsectionClose"){this.receivePopupSubsectionClose(d);}else{if(d.type=="rulesSectionVisibleMultiData"){this.receiveRulesSectionVisibleMultiData(d);}else{if(d.type=="rulesSectionVisibleMultiDataSplit"){this.receiveRulesSectionVisibleMultiDataSplit(d);}else{if(d.type=="controlColor"){this.receiveControlColor(d);}else{if(d.type=="unselectgroup"){this.receiveUnSelectGroup(d);}else{if(d.type=="tabAppend"){this.receiveTabAppend(d);}else{if(d.type=="findSubTab"){this.receiveFindSubTab(d);}else{if(d.type=="findSubTabClose"){this.receiveFindSubTabClose(d);}else{if(d.type=="tabAppendClose"){this.receiveTabAppendClose(d);}else{if(d.type=="tabSelect"){this.receiveTabSelect(d);}else{if(d.type=="tabRemove"){this.receiveTabRemove(d);}else{if(d.type=="tabListInfo"){this.receiveTabListInfo(d);}else{if(d.type=="tabSubStatus"){this.receiveTabSubStatus(d);}else{if(d.type=="tabDisabledButton"){this.receiveTabDisabledButton(d);}else{if(d.type=="openClipAlert"){this.receiveOpenClipAlert(d);}else{if(d.type=="closeClipAlert"){this.receiveCloseClipAlert(d);}else{if(d.type=="memoData"){this.receiveMemoData(d);}else{if(d.type=="chatData"){this.receiveChatMessage(d);}else{if(d.type=="SignScriptRate"){this.receiveSignScriptRate(d);}else{if(d.type=="EFormDisabled"){this.receiveEFormDisabled(d);}else{if(d.type=="bufferedSendData"){this.receiveBufferedData(d);}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}if(h){var g={cmd:"",type:"",data:{}};if(d.type=="subData"||d.type=="subDataMulti"||d.type=="bufferedSendDataMulti"){g.cmd=d.cmd;g.type=d.type;g.data.reportID=d.data.reportID;g.data.status=d.data.status;g.data.nCount=d.data.nCount;g.data.value="뷰어 데이터...";}else{g.cmd=d.cmd;g.type=d.type;g.data.reportID=d.data.reportID;g.data.ctrlID=d.data.ctrlID;g.data.value="이미지...";}this.debugMeg("중계서버 메시지 >> "+JSON.stringify(g));}else{this.debugMeg("중계서버 메시지 >> "+JSON.stringify(d));}};EFormSocket.prototype.callSubReport=function(b){var a=this.webSocket;var c=this.eform_key;this.callStateChange(300,300);if(null!=this.eform){c=c.replace("'version'","'pageNum':"+this.eform.beforePageIndex+",'version'");}if(null!=this.tabPlugin){this.tabPlugin.sendTabListInfo();if(this.eform.m_uid!=b){ReportWebLog("소켓의  이폼 uid: "+this.eform.m_uid+" 타겟이 되는 이폼 uid : "+b+" 다릅니다.");return;}}else{if(this.wsPath=="localhost"){this.systemSendData({cmd:"show-report",eformkey:c});}else{this.systemSendData({cmd:"call-report",eformkey:c});}}};EFormSocket.prototype.sendAppSubType=function(){var a={cmd:"call-event",type:"subType",is_app:(is_appControl||is_exeControl)};this.systemSendData(a);};EFormSocket.prototype.closeSubReport=function(){if(null!=this.eform){if(this.eform.m_isEndReport&&this.eform.m_isServerSyncMirroring){if(null==this.tabPlugin){this.eform.eFormTempSubmitSave();}else{this.tabPlugin.mRe_TempSubmitSave(this.eform);}}}var a={cmd:"call-event",type:"subClose"};this.systemSendData(a);};window.mReUserDataCount=0;EFormSocket.prototype.sendUserData=function(f){var j=window.mRe_socketSplitValue;var g="userID"+window.mReUserDataCount;var a=mCR_Base64.encode(JSON.stringify(f));var b={cmd:"call-event",type:"userData",userId:g,totalCnt:0,index:0,data:""};var k=a.length;var d=Math.ceil(k/j);b.totalCnt=d;for(var c=0;c<d;c++){var h;if((c+1)==d){h=a.substring(c*j);}else{h=a.substring(c*j,(c+1)*j);}b.index=c;b.data=h;this.systemSendData(b);}window.mReUserDataCount++;};EFormSocket.prototype.debugMeg=function(a){this.eform.debugMeg("eform log ::"+a);};EFormSocket.prototype.getTargetDiv=function(){targetDiv=this.elm_target;targetDiv.innerHTML="";return targetDiv;};EFormSocket.prototype.sendDoodlePathDraw=function(d,b,a){if(typeof a=="undefined"){a=null;}var c={cmd:"call-event",type:"doodle",event:"draw",data:{id:"",stroke_width:"",stroke:"",stroke_opacity:"",d:""}};c.data.reportID=b;c.data.reportIndex=a;c.data.id=d.getAttribute("id");c.data.stroke_width=d.getAttributeNS(null,"stroke-width");c.data.stroke=d.getAttributeNS(null,"stroke");c.data.stroke_opacity=d.getAttributeNS(null,"stroke-opacity");c.data.d=d.getAttributeNS(null,"d");if(this.wsPath=="localhost"){this.totalSendData(c);}else{this.sendDoodlePathDrawBase64(c);}};EFormSocket.prototype.sendDoodlePathDrawBase64=function(g){g.type="doodleDrawBase64";var b=mCR_Base64.encode(g.data.d);var h=window.mRe_socketSplitValue;var a=b.length;var f=Math.ceil(a/h);g.data.totalCnt=f;for(var c=0;c<f;c++){var d;if((c+1)==f){d=b.substring(c*h);}else{d=b.substring(c*h,(c+1)*h);}g.data.index=c;g.data.d=d;this.totalSendData(g);}};EFormSocket.prototype.receiveDoodleDrawBase64=function(c){var b=m_reportHashMap[c.data.reportID];if(null==b){b=this.eform;}if(null==b.s_splitPathDataMap){b.s_splitPathDataMap={receiveCount:0,dataList:[]};}b.s_splitPathDataMap.dataList[c.data.index]=c.data.d;b.s_splitPathDataMap.receiveCount++;if(b.s_splitPathDataMap.receiveCount==c.data.totalCnt){var a=b.s_splitPathDataMap.dataList.join("");c.data.d=mCR_Base64.decode(a);c.type="doodle";this.receiveDoodle(c);b.s_splitPathDataMap=null;}};EFormSocket.prototype.sendDoodlePathRemove=function(c,a){var b={cmd:"call-event",type:"doodle",event:"remove",data:{id:""}};b.data.reportID=a;b.data.id=c.getAttribute("id");this.totalSendData(b);};EFormSocket.prototype.sendDoodlePathRemoveAll=function(a){var b={cmd:"call-event",type:"doodle",event:"removeall",data:{}};b.data.reportID=a;this.totalSendData(b);};EFormSocket.prototype.sendDoodleDeleteAll=function(a){var b={cmd:"call-event",type:"doodle",event:"deleteAll",data:{}};b.data.reportID=a;this.totalSendData(b);};EFormSocket.prototype.receiveDoodle=function(d){var c=m_reportHashMap[d.data.reportID];if(null==c){c=this.eform;}var a=null;var b=document.getElementById(c.m_uid+"doodle");if(null!=b){a=b.firstChild;}if(d.event=="draw"){var f=c;if(d.data.reportIndex!=null){if(f.beforePageIndex!=d.data.reportIndex){if(null==f.eFormDoodleOption.pagePathSave[d.data.reportIndex]){f.eFormDoodleOption.pagePathSave[d.data.reportIndex]=new Array();}var h={};h.id=d.data.id;h.d=d.data.d;h.stroke_width=d.data.stroke_width;h.stroke=d.data.stroke;h.stroke_opacity=d.data.stroke_opacity;f.eFormDoodleOption.pagePathSave[d.data.reportIndex].push(h);return;}}if(null!=a){var j=document.createElementNS("http://www.w3.org/2000/svg","path");j.setAttribute("id",d.data.id);if(-1!=d.data.id.indexOf("rect")){j.setAttribute("class","svg_path");}j.setAttributeNS(null,"style","-webkit-tap-highlight-color: rgba(0, 0, 0, 0);");j.setAttributeNS(null,"stroke-width",d.data.stroke_width);j.setAttributeNS(null,"fill","none");j.setAttributeNS(null,"stroke",d.data.stroke);j.setAttributeNS(null,"stroke-opacity",d.data.stroke_opacity);j.setAttributeNS(null,"d",d.data.d);j.onclick=function(){if(f.eFormDoodleOption.is_eraser){if(f.multiView.isSocket){f.multiView.socket.sendDoodlePathRemove(this);}a.removeChild(this);}};j.onmousemove=j.ontouchmove=function(){if(f.eFormDoodleOption.is_eraser&&f.eFormDoodleOption.is_eraser_down){if(f.multiView.isSocket){f.multiView.socket.sendDoodlePathRemove(this);}a.removeChild(this);}};a.appendChild(j);}}else{if(d.event=="remove"){if(null!=a){var j=document.getElementById(d.data.id);if(null!=j){a.removeChild(j);}}}else{if(d.event=="removeall"){if(null!=a){if(0!=a.childNodes.length){var i=a.firstChild;while(i){var g=i;i=i.nextSibling;if("rect"!=g.tagName){a.removeChild(g);}}}c.eFormDoodleOption.pagePathSave[c.beforePageIndex]=new Array();}}else{if(d.event=="deleteAll"){c.EFormDeleteAllDoodle();}}}}};EFormSocket.prototype.sendPageMove=function(a,b){var c={cmd:"call-event",type:"pagemove",data:{pageIndex:0}};c.data.reportID=b;c.data.pageIndex=a;this.totalSendData(c);};EFormSocket.prototype.receivePageMove=function(c){var b=m_reportHashMap[c.data.reportID];if(null==b){b=this.eform;}var a=c.data.pageIndex;if(b.eFormDoodleOption.is_Ds){b.removePalletDoodle();}b.EF_DoodlePageSave();b.m_default_selectPage(a,false);b.EF_thumbnail_focus();};EFormSocket.prototype.sendInputValue=function(a,b){var c={cmd:"call-event",type:"inputbox",event:"setValue",data:{ctrlID:"",value:"",isEventBubble:true}};c.data.reportID=a.eform.m_uid;c.data.ctrlID=a.ctrlID;c.data.value=a.getValue();c.data.isEventBubble=b;this.totalSendDataByMainEnd(a.eform,c);};EFormSocket.prototype.receiveInputValue=function(c){var b=m_reportHashMap[c.data.reportID];if(null==b){b=this.eform;}if(c.event=="setValue"){if(null!=b.eFormControlList){var a=b.eFormControlList[c.data.ctrlID];if(null!=a){a.m_default_setValue(c.data.value,c.data.isEventBubble,false);}}}};EFormSocket.prototype.sendInputCheckbox=function(b,a,c){if(typeof c=="undefined"){c=true;}var d={cmd:"call-event",type:"checkbox",event:a,data:{ctrlID:"",isEventBubble:true}};d.data.reportID=b.eform.m_uid;d.data.ctrlID=b.ctrlID;d.data.isEventBubble=c;this.totalSendDataByMainEnd(b.eform,d);};EFormSocket.prototype.receiveInputCheckbox=function(c){var b=m_reportHashMap[c.data.reportID];if(null==b){b=this.eform;}if(null!=b.eFormControlList){var a=b.eFormControlList[c.data.ctrlID];if(c.event=="check"){if(null!=a){a.m_default_check(c.data.isEventBubble);}}else{if(c.event=="unCheck"){if(null!=a){a.m_default_unCheck(c.data.isEventBubble);}}}}};EFormSocket.prototype.sendInputRadiobox=function(a,b){var c={cmd:"call-event",type:"radiobox",event:"select",data:{ctrlID:"",isEventBubble:true}};c.data.reportID=a.eform.m_uid;c.data.ctrlID=a.ctrlID;c.data.isEventBubble=b;this.totalSendDataByMainEnd(a.eform,c);};EFormSocket.prototype.receiveInputRadiobox=function(c){var b=m_reportHashMap[c.data.reportID];if(null==b){b=this.eform;}if(null!=b.eFormControlList){var a=b.eFormControlList[c.data.ctrlID];a.m_default_select(c.data.isEventBubble,false);}};EFormSocket.prototype.sendInputButton=function(a,b,c){var d={cmd:"call-event",type:"button",event:b,data:{ctrlID:"",value:"",isEventBubble:true}};d.data.reportID=a.eform.m_uid;d.data.ctrlID=a.ctrlID;if(b=="label"){d.data.value=a.getLabel();}else{if(b=="value"){d.data.value=a.getValue();}else{d.data.isEventBubble=c;}}this.totalSendDataByMainEnd(a.eform,d);};EFormSocket.prototype.receiveInputButton=function(c){var b=m_reportHashMap[c.data.reportID];if(null==b){b=this.eform;}if(null!=b.eFormControlList){var a=b.eFormControlList[c.data.ctrlID];if(null!=a){if(c.event=="click"){a.onClick(c.data.isEventBubble);}else{if(c.event=="label"){a.m_default_setLabel(c.data.value);}else{if(c.event=="value"){a.m_default_setValue(c.data.value);}}}}}};EFormSocket.prototype.sendInputVideo=function(a,b,d){if(d==undefined){d=0;}var c={cmd:"call-event",type:"video",event:b,data:{ctrlID:"",currentTime:d}};c.data.reportID=a.eform.m_uid;c.data.ctrlID=a.ctrlID;this.totalSendDataByMainEnd(a.eform,c);};EFormSocket.prototype.receiveInputVideo=function(c){var b=m_reportHashMap[c.data.reportID];if(null==b){b=this.eform;}if(null!=b.eFormControlList){var a=b.eFormControlList[c.data.ctrlID];if(null!=a){if(c.event=="play"){a.play();}else{if(c.event=="pause"){a.pause();}else{a.setCurrentTime(c.data.currentTime);}}}}};EFormSocket.prototype.sendInputImage=function(h,a,d){var j=window.mRe_socketSplitValue;var b={cmd:"call-event",type:"image",data:{ctrlID:"",value:"",totalCnt:0,index:0,chageEvent:d}};b.data.reportID=h.eform.m_uid;b.data.ctrlID=h.ctrlID;var k=a.length;if(k==0){b.data.totalCnt=1;b.data.index=0;b.data.value="";this.totalSendDataByMainEnd(h.eform,b);}else{var f=Math.ceil(k/j);b.data.totalCnt=f;for(var c=0;c<f;c++){var g;if((c+1)==f){g=a.substring(c*j);}else{g=a.substring(c*j,(c+1)*j);}b.data.index=c;b.data.value=g;this.totalSendDataByMainEnd(h.eform,b);}}};EFormSocket.prototype.receiveInputImage=function(c){var b=m_reportHashMap[c.data.reportID];if(null==b){b=this.eform;}if(null!=b.eFormControlList){var a=b.eFormControlList[c.data.ctrlID];if(null!=a){if(null==a.splitMap){a.splitMap={receiveCount:0,dataList:[]};}a.splitMap.dataList[c.data.index]=c.data.value;a.splitMap.receiveCount++;if(a.splitMap.receiveCount==c.data.totalCnt){a.m_default_setValue(a.splitMap.dataList.join(""),c.data.chageEvent);a.splitMap=null;}}}};EFormSocket.prototype.sendInputImageOrigin=function(h,a,d){var j=window.mRe_socketSplitValue;var b={cmd:"call-event",type:"imageOrigin",data:{ctrlID:"",value:"",totalCnt:0,index:0,chageEvent:d}};b.data.reportID=h.eform.m_uid;b.data.ctrlID=h.ctrlID;var k=a.length;if(k==0){b.data.totalCnt=1;b.data.index=0;b.data.value="";this.totalSendDataByMainEnd(h.eform,b);}else{var f=Math.ceil(k/j);b.data.totalCnt=f;for(var c=0;c<f;c++){var g;if((c+1)==f){g=a.substring(c*j);}else{g=a.substring(c*j,(c+1)*j);}b.data.index=c;b.data.value=g;this.totalSendDataByMainEnd(h.eform,b);}}};EFormSocket.prototype.receiveInputImageOrigin=function(c){var b=m_reportHashMap[c.data.reportID];if(null==b){b=this.eform;}if(null!=b.eFormControlList){var a=b.eFormControlList[c.data.ctrlID];if(null!=a){if(null==a.splitMap){a.splitMap={receiveCount:0,dataList:[]};}a.splitMap.dataList[c.data.index]=c.data.value;a.splitMap.receiveCount++;if(a.splitMap.receiveCount==c.data.totalCnt){a.m_default_setOriginValue(a.splitMap.dataList.join(""),c.data.chageEvent);a.splitMap=null;}}}};EFormSocket.prototype.sendInputSign=function(h,b){var j=window.mRe_socketSplitValue;var a=0;if(null!=h.controlData.po&&""!=b){a=h.controlData.po.move_count;}var c={cmd:"call-event",type:"sign",data:{ctrlID:"",value:"",moveCnt:a,totalCnt:0,index:0}};c.data.reportID=h.eform.m_uid;c.data.ctrlID=h.ctrlID;var k=b.length;if(k==0){c.data.totalCnt=1;c.data.index=0;c.data.value="";this.totalSendDataByMainEnd(h.eform,c);}else{var f=Math.ceil(k/j);c.data.totalCnt=f;for(var d=0;d<f;d++){var g;if((d+1)==f){g=b.substring(d*j);}else{g=b.substring(d*j,(d+1)*j);}c.data.index=d;c.data.value=g;this.totalSendDataByMainEnd(h.eform,c);}}};EFormSocket.prototype.receiveInputSign=function(c){var b=m_reportHashMap[c.data.reportID];if(null==b){b=this.eform;}if(null!=b.eFormControlList){var a=b.eFormControlList[c.data.ctrlID];if(null!=a){if(null==a.splitMap){a.splitMap={receiveCount:0,dataList:[]};}a.splitMap.dataList[c.data.index]=c.data.value;a.splitMap.receiveCount++;if(a.splitMap.receiveCount==c.data.totalCnt){if(null!=a.controlData.po){a.controlData.po.move_count=c.data.moveCnt;}else{a.controlData.po={move_count:c.data.moveCnt};}a.m_default_setValue(a.splitMap.dataList.join(""));a.splitMap=null;a.subSectionSyncValue(false);}}}};EFormSocket.prototype.sendInputSignApplyPathAll=function(a,b){var c={cmd:"call-event",type:"signApplyPathAll",data:{ctrlID:"",value:""}};c.data.reportID=a.eform.m_uid;c.data.ctrlID=a.ctrlID;c.data.value=b;this.totalSendData(c);};EFormSocket.prototype.sendInputSignApplyPath=function(b,c){var j=window.mRe_socketSplitValue;var h={cmd:"call-event",type:"signApplyPath",data:{ctrlID:"",value:"",totalCnt:0,index:0}};h.data.reportID=b.eform.m_uid;h.data.ctrlID=b.ctrlID;var a=c.length;if(a==0){h.data.totalCnt=1;h.data.index=0;h.data.value="";this.totalSendData(h);}else{var g=Math.ceil(a/j);h.data.totalCnt=g;for(var f=0;f<g;f++){var d;if((f+1)==g){d=c.substring(f*j);}else{d=c.substring(f*j,(f+1)*j);}h.data.index=f;h.data.value=d;this.totalSendData(h);}}};EFormSocket.prototype.receiveInputSignApplyPathAll=function(c){var b=m_reportHashMap[c.data.reportID];if(null==b){b=this.eform;}if(null!=b.eFormControlList){var a=b.eFormControlList[c.data.ctrlID];if(null!=a){a.controlData.pathString=c.data.value;a.m_setPath(a.controlData.pathString,true,false);a.subSectionSyncValuePath();}}};EFormSocket.prototype.receiveInputSignApplyPath=function(c){var b=m_reportHashMap[c.data.reportID];if(null==b){b=this.eform;}if(null!=b.eFormControlList){var a=b.eFormControlList[c.data.ctrlID];if(null!=a){if(null==a.splitPathMap){a.splitPathMap={receiveCount:0,dataList:[]};}a.splitPathMap.dataList[c.data.index]=c.data.value;a.splitPathMap.receiveCount++;if(a.splitPathMap.receiveCount==c.data.totalCnt){a.controlData.pathString=a.splitPathMap.dataList.join("");a.m_setPath(a.controlData.pathString,true,false);a.splitPathMap=null;a.subSectionSyncValuePath();}}}};EFormSocket.prototype.sendInputSignPathAll=function(a,b){var c={cmd:"call-event",type:"signPathAll",data:{ctrlID:"",value:""}};c.data.reportID=a.eform.m_uid;c.data.ctrlID=a.ctrlID;c.data.value=b;this.totalSendData(c);};EFormSocket.prototype.sendInputSignPath=function(b,c){var j=window.mRe_socketSplitValue;var h={cmd:"call-event",type:"signPath",data:{ctrlID:"",value:"",totalCnt:0,index:0}};h.data.reportID=b.eform.m_uid;h.data.ctrlID=b.ctrlID;var a=c.length;if(a==0){h.data.totalCnt=1;h.data.index=0;h.data.value="";this.totalSendData(h);}else{var g=Math.ceil(a/j);h.data.totalCnt=g;for(var f=0;f<g;f++){var d;if((f+1)==g){d=c.substring(f*j);}else{d=c.substring(f*j,(f+1)*j);}h.data.index=f;h.data.value=d;this.totalSendData(h);}}};EFormSocket.prototype.receiveInputSignPathAll=function(c){var b=m_reportHashMap[c.data.reportID];if(null==b){b=this.eform;}if(null!=b.eFormControlList){var a=b.eFormControlList[c.data.ctrlID];if(null!=a){a.controlData.pathString=c.data.value;a.subSectionSyncValuePath();}}};EFormSocket.prototype.receiveInputSignPath=function(c){var b=m_reportHashMap[c.data.reportID];if(null==b){b=this.eform;}if(null!=b.eFormControlList){var a=b.eFormControlList[c.data.ctrlID];if(null!=a){if(null==a.splitPathMap){a.splitPathMap={receiveCount:0,dataList:[]};}a.splitPathMap.dataList[c.data.index]=c.data.value;a.splitPathMap.receiveCount++;if(a.splitPathMap.receiveCount==c.data.totalCnt){a.controlData.pathString=a.splitPathMap.dataList.join("");a.splitPathMap=null;a.subSectionSyncValuePath();}}}};EFormSocket.prototype.sendInputUseStamp=function(b,a){var c={cmd:"call-event",type:"signUseStamp",data:{ctrlID:"",value:""}};c.data.reportID=b.eform.m_uid;c.data.ctrlID=b.ctrlID;c.data.isApp=is_appControl;c.data.value=a;this.totalSendData(c);};EFormSocket.prototype.receiveInputUseStamp=function(c){var b=m_reportHashMap[c.data.reportID];if(null==b){b=this.eform;}if(null!=b.eFormControlList){var a=b.eFormControlList[c.data.ctrlID];if(null!=a){a.controlData.isStampImage=c.data.value;if(3!=a.controlData.stampDefaultType){a.controlData.stampDefaultType=a.controlData.isStampImage?0:1;}a.controlData.isApp=c.data.isApp;if(a.controlData.isStampImage){a.stampImage=a.controlData.image;}else{a.stampImage=null;}}}};EFormSocket.prototype.sendScreenSingleSignPathClear=function(b,a){var c={cmd:"call-event",type:"screenSingleSignPathClear",data:{reportID:null}};c.data.reportID=b;c.data.ctrlID=a;this.totalSendData(c);};EFormSocket.prototype.receiveScreenSingleSignPathClear=function(b){var a=m_reportHashMap[b.data.reportID];if(null==a){a=this.eform;}a.clearSignBlockScreenCanvas(b.data.ctrlID);};EFormSocket.prototype.sendSignUndoRedo=function(c,a,b){var d={cmd:"call-event",type:"signUndoRedo",data:{value:null}};d.data.reportID=c;d.data.ctrlID=a;d.data.value=b;this.totalSendData(d);};EFormSocket.prototype.receiveSignUndoRedo=function(b){var a=m_reportHashMap[b.data.reportID];if(null==a){a=this.eform;}a.signUndoRedoSet(b.data.ctrlID,b.data.value);};EFormSocket.prototype.sendScreenSingleSignPath=function(b,c,a){var d={cmd:"call-event",type:"screenSingleSignPath",data:{value:null}};d.data.reportID=c;d.data.ctrlID=a;if(this.wsPath=="localhost"){d.data.value=b;this.totalSendData(d);}else{this.sendScreenSingleSignPathBase64(b,d);}};EFormSocket.prototype.sendScreenSingleSignPathBase64=function(b,g){g.type="screenSingleSignPathBase64";base64Data=mCR_Base64.encode(JSON.stringify(b));var h=window.mRe_socketSplitValue;var a=base64Data.length;var f=Math.ceil(a/h);g.data.totalCnt=f;for(var c=0;c<f;c++){var d;if((c+1)==f){d=base64Data.substring(c*h);}else{d=base64Data.substring(c*h,(c+1)*h);}g.data.index=c;g.data.value=d;this.totalSendData(g);}};EFormSocket.prototype.receiveScreenSingleSignPath=function(b){var a=m_reportHashMap[b.data.reportID];if(null==a){a=this.eform;}a.drawSignBlockScreenCanvas(b.data.value,b.data.ctrlID);};EFormSocket.prototype.receiveScreenSingleSignPathBase64=function(c){var b=m_reportHashMap[c.data.reportID];if(null==b){b=this.eform;}if(null==b.s_splitPathDataMap){b.s_splitPathDataMap={receiveCount:0,dataList:[]};}b.s_splitPathDataMap.dataList[c.data.index]=c.data.value;b.s_splitPathDataMap.receiveCount++;if(b.s_splitPathDataMap.receiveCount==c.data.totalCnt){var a=b.s_splitPathDataMap.dataList.join("");c.data.value=JSON.parse(mCR_Base64.decode(a));b.drawSignBlockScreenCanvas(c.data.value,c.data.ctrlID);b.s_splitPathDataMap=null;}};EFormSocket.prototype.sendAppPreViewSign=function(b,h,c){var d={cmd:"call-event",type:"appPreViewSign",data:{ctrlID:"",value:null}};d.data.reportID=b;d.data.ctrlID=h;var a=c;var k=window.mRe_socketSplitValue;var l=a.length;var g=Math.ceil(l/k);if(g!=0){d.data.totalCnt=g;for(var f=0;f<g;f++){var j;if((f+1)==g){j=a.substring(f*k);}else{j=a.substring(f*k,(f+1)*k);}d.data.index=f;d.data.value=j;this.totalSendData(d);}}else{d.data.totalCnt=1;d.data.index=0;d.data.value="";this.totalSendData(d);}};EFormSocket.prototype.receiveAppPreViewSignBase64=function(d){var c=m_reportHashMap[d.data.reportID];if(null==c){c=this.eform;}if(null!=c.eFormControlList){var a=c.eFormControlList[d.data.ctrlID];if(null!=a){if(null==a.splitPathDataMap){a.splitPathDataMap={receiveCount:0,dataList:[]};}a.splitPathDataMap.dataList[d.data.index]=d.data.value;a.splitPathDataMap.receiveCount++;if(a.splitPathDataMap.receiveCount==d.data.totalCnt){var b=a.splitPathDataMap.dataList.join("");c.receiveAppSignImg(d.data.ctrlID,b);a.splitPathDataMap=null;}}}};EFormSocket.prototype.sendMultiSignPath=function(h,b){var c={cmd:"call-event",type:"multiSignPath",data:{ctrlID:"",value:null}};c.data.reportID=h.eform.m_uid;c.data.ctrlID=h.ctrlID;if(this.wsPath=="localhost"){c.data.value=b;this.totalSendData(c);}else{c.type="multiSignPathBase64";var a="";if(typeof b==="string"){c.data.isStr=true;a=mCR_Base64.encode(b);}else{c.data.isStr=false;a=mCR_Base64.encode(JSON.stringify(b));}var j=window.mRe_socketSplitValue;var k=a.length;var f=Math.ceil(k/j);c.data.totalCnt=f;for(var d=0;d<f;d++){var g;if((d+1)==f){g=a.substring(d*j);}else{g=a.substring(d*j,(d+1)*j);}c.data.index=d;c.data.value=g;this.totalSendData(c);}}};EFormSocket.prototype.receiveMultiSignPathBase64=function(d){var c=m_reportHashMap[d.data.reportID];if(null==c){c=this.eform;}if(null!=c.eFormControlList){var a=c.eFormControlList[d.data.ctrlID];if(null!=a){if(null==a.splitPathDataMap){a.splitPathDataMap={receiveCount:0,dataList:[]};}a.splitPathDataMap.dataList[d.data.index]=d.data.value;a.splitPathDataMap.receiveCount++;if(a.splitPathDataMap.receiveCount==d.data.totalCnt){var b=a.splitPathDataMap.dataList.join("");if(d.data.isStr){d.data.value=mCR_Base64.decode(b);}else{d.data.value=JSON.parse(mCR_Base64.decode(b));}this.receiveMultiSignPath(d);a.splitPathDataMap=null;}}}};EFormSocket.prototype.receiveMultiSignPath=function(g){var f=m_reportHashMap[g.data.reportID];if(null==f){f=this.eform;}if(null!=f.eFormControlList){var c=f.eFormControlList[g.data.ctrlID];if(null!=c){if(typeof g.data.value==="string"){c.controlData.pathString=g.data.value;}else{var b=c.controlData;b.pathString=g.data.value;b.po.move_count=mRe_PathCount(g.data.value);if(b.po.move_count>this.eform.m_signMoveCount){b.is_nc=false;}else{if(b.po.move_count!=0&&b.isNecessaryCheck=="true"){b.is_nc=true;}}var a=c.signElement_guideSpan;if(null!=a){var d=b.isNecessaryCheck=="true"?" eForm_inputNecessary":"";if(b.disable){a.className="eF_Rect eForm_inputDisabled "+c.disabledClass;}else{if(b.is_nc){if(this.eform.eForm_isNecessary.check&&b.isNecessaryCheck=="true"){a.className="eF_Rect eForm_NecessaryCheck";}else{a.className="eF_Rect eForm_inputDefault_bg"+d;}}else{a.className="eF_Rect eForm_inputDefault_bg"+d;}}}}c.subSectionSyncValuePath();}}};EFormSocket.prototype.sendSignPath=function(j,f,b){var c={cmd:"call-event",type:"signGroupPath",data:{ctrlID:"",value:null}};c.data.reportID=j.eform.m_uid;c.data.ctrlID=j.ctrlID;c.data.isDraw=b;if(this.wsPath=="localhost"){c.data.value=f;this.totalSendDataByMainEnd(j.eform,c);}else{c.type="multiSignGroupPath";var a="";if(typeof pathString==="string"){c.data.isStr=true;a=mCR_Base64.encode(f);}else{c.data.isStr=false;a=mCR_Base64.encode(JSON.stringify(f));}var k=window.mRe_socketSplitValue;var l=a.length;var g=Math.ceil(l/k);c.data.totalCnt=g;for(var d=0;d<g;d++){var h;if((d+1)==g){h=a.substring(d*k);}else{h=a.substring(d*k,(d+1)*k);}c.data.index=d;c.data.value=h;this.totalSendDataByMainEnd(j.eform,c);}}};EFormSocket.prototype.receiveMultiSignGroupPath=function(d){var c=m_reportHashMap[d.data.reportID];if(null==c){c=this.eform;}if(null!=c.eFormControlList){var a=c.eFormControlList[d.data.ctrlID];if(null!=a){if(null==a.splitPathDataMap){a.splitPathDataMap={receiveCount:0,dataList:[]};}a.splitPathDataMap.dataList[d.data.index]=d.data.value;a.splitPathDataMap.receiveCount++;if(a.splitPathDataMap.receiveCount==d.data.totalCnt){var b=a.splitPathDataMap.dataList.join("");if(d.data.isStr){d.data.value=mCR_Base64.decode(b);}else{d.data.value=JSON.parse(mCR_Base64.decode(b));}this.receiveSignPath(d);a.splitPathDataMap=null;}}}};EFormSocket.prototype.receiveSignPath=function(c){var b=m_reportHashMap[c.data.reportID];if(null==b){b=this.eform;}if(null!=b.eFormControlList){var a=b.eFormControlList[c.data.ctrlID];if(null!=a){if(c.data.isDraw){a.m_default_setPath(c.data.value,c.data.isDraw,true);}else{a.controlData.pathString=c.data.value;}}}};EFormSocket.prototype.sendInputSignLock=function(a){var b={cmd:"call-event",type:"signlock",event:"lock",data:{ctrlID:""}};b.data.reportID=a.eform.m_uid;b.data.ctrlID=a.ctrlID;this.totalSendData(b);};EFormSocket.prototype.sendInputSignUnLock=function(a){var b={cmd:"call-event",type:"signlock",event:"unlock",data:{ctrlID:""}};b.data.reportID=a.eform.m_uid;b.data.ctrlID=a.ctrlID;this.totalSendData(b);};EFormSocket.prototype.receiveInputSignLock=function(c){var b=m_reportHashMap[c.data.reportID];if(null==b){b=this.eform;}if(null!=b.eFormControlList){var a=b.eFormControlList[c.data.ctrlID];if(null!=a){a.multiViewSignLock(c.event);}}};EFormSocket.prototype.sendScreenLockStampButton=function(a,c,b){var d={cmd:"call-event",type:"screenlockStampButton",info:c,nType:b};d.reportID=a;this.totalSendData(d);};EFormSocket.prototype.sendScreenLock=function(c,b,a){if(typeof a==="undefined"){a=[];}var d={cmd:"call-event",type:"screenlock",event:"lock",controlType:c};d.reportID=b;d.ctrlID=a;this.totalSendData(d);};EFormSocket.prototype.sendScreenUnLock=function(a){var b={cmd:"call-event",type:"screenlock",event:"unlock",controlType:"none"};b.reportID=a;this.totalSendData(b);};EFormSocket.prototype.receiveScreenLockStampButton=function(b){var a=m_reportHashMap[b.reportID];if(null==a){a=this.eform;}a.appendScreenLockStampButton(b.info,b.nType);};EFormSocket.prototype.receiveScreenLock=function(b){var a=m_reportHashMap[b.reportID];if(null==a){a=this.eform;}if(b.event=="lock"){a.createSignBlockScreen(b.controlType,b.ctrlID);}else{a.removeAllBlockScreen();}};EFormSocket.prototype.sendMainScreenLock=function(b,a){var c={cmd:"call-event",type:"mainscreenlock",controlType:b};c.reportID=a;this.totalSendData(c);};EFormSocket.prototype.sendMainScreenUnLock=function(a){var b={cmd:"call-event",type:"mainscreenunlock"};b.reportID=a;this.totalSendData(b);};EFormSocket.prototype.receiveMainScreenLock=function(b){var a=m_reportHashMap[b.reportID];if(null==a){a=this.eform;}a.createMainBlockScreen(b.controlType);};EFormSocket.prototype.receiveMainScreenUnLock=function(b){var a=m_reportHashMap[b.reportID];if(null==a){a=this.eform;}a.removeMainBlockScreen();};EFormSocket.prototype.sendSingleSignOk=function(){var a={cmd:"call-event",type:"SingleSignOk"};this.totalSendData(a);};EFormSocket.prototype.receiveSingleSignOk=function(a){if(null!=window.mRe_multiSign_ok){window.mRe_multiSign_ok.click();mRe_reSetPopupStatus();}};EFormSocket.prototype.sendSingleSignReset=function(a){var b={cmd:"call-event",type:"SingleSignReset",ctrlID:a};this.totalSendData(b);};EFormSocket.prototype.receiveSingleSignReset=function(a){if(null!=window.mRe_multiSign_reset){window.mRe_multiSign_reset[a.ctrlID].click();}};EFormSocket.prototype.sendAppRemoteOK=function(b){var a={cmd:"call-event",type:"HybirdAppRemoteOK",ctrl:b};this.totalSendData(a);};EFormSocket.prototype.receiveAppRemoteOK=function(a){if(is_appControl){switch(a.ctrl){case 0:ClipHybrid.okSignNativeControl();break;case 2:ClipHybrid.okKeyboardNativeControl();break;case 3:ClipHybrid.okCalendarNativeControl();break;case 4:ClipHybrid.okSelectboxNativeControl();break;}}};EFormSocket.prototype.sendAppRemoteReset=function(a,c){var b={cmd:"call-event",type:"HybirdAppRemoteReset",ctrlID:a,ctrl:c};this.totalSendData(b);};EFormSocket.prototype.receiveAppRemoteReset=function(a){if(is_appControl){switch(a.ctrl){case 0:ClipHybrid.resetSignNativeControl(a.ctrlID);break;case 2:ClipHybrid.resetKeyboardNativeControl();break;case 3:ClipHybrid.resetCalendarNativeControl();break;case 4:ClipHybrid.resetSelectboxNativeControl();break;}}};EFormSocket.prototype.sendSubAppScreenLock=function(a,b){var c={cmd:"call-event",type:"HybirdAppScreenLock",reportID:a,ctrlID:b};this.totalSendData(c);};EFormSocket.prototype.receiveSubAppScreenLock=function(b){if(is_appControl){ClipHybrid.useStampByScreenLock();}else{var a=document.getElementById(b.reportID+"webStamp"+b.ctrlID);if(null!=a){a.click();}}};EFormSocket.prototype.sendMainStampScannerData=function(a){var b={cmd:"call-event",type:"mainStampScannerData",data:{}};b.data.reportID=a.uid;b.data.id=a.ctrlID;if(a.status==0){b.data.status=a.status;b.data.base64=a.base64;this.sendMainStampScannerBase64(b);}else{b.data.status=a.status;b.data.base64="";this.totalSendData(b);}};EFormSocket.prototype.receiveMainStampScannerData=function(c){var a={};a.ctrlID=c.data.id;a.status=c.data.status;a.base64=c.data.base64;if(is_appControl){ClipHybrid.setSignStampDataNativeControl(JSON.stringify(a));}else{var b=m_reportHashMap[c.data.reportID];if(null==b){b=this.eform;}b.mRe_setStamp({image:a.base64});}};EFormSocket.prototype.sendMainStampScannerBase64=function(g){g.type="mainStampScannerBase64";var b=mCR_Base64.encode(g.data.base64);var h=window.mRe_socketSplitValue;var a=b.length;var f=Math.ceil(a/h);g.data.totalCnt=f;for(var c=0;c<f;c++){var d;if((c+1)==f){d=b.substring(c*h);}else{d=b.substring(c*h,(c+1)*h);}g.data.index=c;g.data.base64=d;this.totalSendData(g);}};EFormSocket.prototype.receiveMainStampScannerBase64=function(c){var b=m_reportHashMap[c.data.reportID];if(null==b){b=this.eform;}if(null==b.s_splitPathDataMap){b.s_splitPathDataMap={receiveCount:0,dataList:[]};}b.s_splitPathDataMap.dataList[c.data.index]=c.data.base64;b.s_splitPathDataMap.receiveCount++;if(b.s_splitPathDataMap.receiveCount==c.data.totalCnt){var a=b.s_splitPathDataMap.dataList.join("");c.data.base64=mCR_Base64.decode(a);c.type="mainStampScannerData";b.s_splitPathDataMap=null;this.receiveMainStampScannerData(c);}};EFormSocket.prototype.sendHybirdClose=function(a){var b={cmd:"call-event",type:"HybirdClose",controlType:a};this.totalSendData(b);};EFormSocket.prototype.receiveHybirdClose=function(b){if(is_appControl){ClipHybrid.closeNativeControl(0);}else{if(is_exeControl){if(b.controlType==="key"){var a={methodName:"CloseVirtualKeyboard"};window.external.ClipSubWebBrowserCtrl_Invoke(JSON.stringify(a));}else{if(b.controlType==="sign"){var a={methodName:"CloseSignatureBoard"};window.external.ClipSubWebBrowserCtrl_Invoke(JSON.stringify(a));}else{if(b.controlType==="calendar"){var a={methodName:"CloseCalendar"};window.external.ClipSubWebBrowserCtrl_Invoke(JSON.stringify(a));}else{if(b.controlType==="selectbox"){var a={methodName:"CloseSelectBox"};window.external.ClipSubWebBrowserCtrl_Invoke(JSON.stringify(a));}}}}}}if(null!=window.mRe_multiSign_close){window.mRe_multiSign_close.click();mRe_reSetPopupStatus();}if(null!=window.mRe_popupInput_close){window.mRe_popupInput_close.click();mRe_reSetPopupStatus();}};EFormSocket.prototype.sendNecessaryCheck=function(a,b){var c={cmd:"call-event",type:"ctrlNecessaryCheck",data:{ctrlID:"",isDisable:false}};c.data.reportID=a.eform.m_uid;c.data.ctrlID=a.ctrlID;c.data.isNecessaryCheck=b;this.totalSendDataByMainEnd(a.eform,c);};EFormSocket.prototype.receiveNecessaryCheck=function(c){var b=m_reportHashMap[c.data.reportID];if(null==b){b=this.eform;}if(null!=b.eFormControlList){var a=b.eFormControlList[c.data.ctrlID];if(null!=a){a.setNecessaryCheck(c.data.isNecessaryCheck,false);}}};EFormSocket.prototype.sendSelectedClick=function(a){var b={cmd:"call-event",type:"ctrlSelectedClick",data:{ctrlID:""}};b.data.reportID=a.eform.m_uid;b.data.ctrlID=a.ctrlID;this.totalSendDataByMainEnd(a.eform,b);};EFormSocket.prototype.receiveSelectedClick=function(c){var b=m_reportHashMap[c.data.reportID];if(null==b){b=this.eform;}if(null!=b.eFormControlList){var a=b.eFormControlList[c.data.ctrlID];if(null!=a){a.onSelectedClick(true,false);}}};EFormSocket.prototype.sendServerSyncMirroring=function(a){var b={cmd:"call-event",type:"serverSyncMirroring",data:{ctrlID:""}};b.data.reportID=a.m_uid;this.totalSendData(b);};EFormSocket.prototype.receiveServerSyncMirroring=function(b){var a=m_reportHashMap[b.data.reportID];if(null==a){a=this.eform;}if(null!=a){a.m_isEndMainData=true;if(a.getIsMain()&&a.m_isEndReport){this.sendServerSyncMirroring(a);}if(a.m_aSyncMirrData.length>0){this.bufferedSendDataMulti(a.m_aSyncMirrData);a.m_aSyncMirrData=[];}}};EFormSocket.prototype.sendGuideText=function(a,c){var b={cmd:"call-event",type:"ctrlGuideText",data:{ctrlID:"",data:c}};b.data.reportID=a.eform.m_uid;b.data.ctrlID=a.ctrlID;this.totalSendDataByMainEnd(a.eform,b);};EFormSocket.prototype.receiveGuideText=function(c){var b=m_reportHashMap[c.data.reportID];if(null==b){b=this.eform;}if(null!=b.eFormControlList){var a=b.eFormControlList[c.data.ctrlID];if(null!=a){a.setGuideText(c.data.data,false);}}};EFormSocket.prototype.sendDisabled=function(b,a){var c={cmd:"call-event",type:"ctrlDisabled",data:{ctrlID:"",isDisable:false}};c.data.reportID=b.eform.m_uid;c.data.ctrlID=b.ctrlID;c.data.isDisable=a;this.totalSendDataByMainEnd(b.eform,c);};EFormSocket.prototype.receiveDisabled=function(c){var b=m_reportHashMap[c.data.reportID];if(null==b){b=this.eform;}if(null!=b.eFormControlList){var a=b.eFormControlList[c.data.ctrlID];if(null!=a){a.setDisabled(c.data.isDisable,false);}}};EFormSocket.prototype.sendVisibled=function(a,c){var b={cmd:"call-event",type:"ctrlVisibled",data:{ctrlID:"",isVisible:true}};b.data.reportID=a.eform.m_uid;b.data.ctrlID=a.ctrlID;b.data.isVisible=c;this.totalSendDataByMainEnd(a.eform,b);};EFormSocket.prototype.receiveVisibled=function(c){var b=m_reportHashMap[c.data.reportID];if(null==b){b=this.eform;}if(null!=b.eFormControlList){var a=b.eFormControlList[c.data.ctrlID];if(null!=a){a.setVisible(c.data.isVisible,false);}}};EFormSocket.prototype.sendInputCalendar=function(a,f,b,d){var c={cmd:"call-event",type:"calendar",data:{ctrlID:"",yearValue:"",monthValue:"",dayValue:""}};c.data.reportID=a.eform.m_uid;c.data.ctrlID=a.ctrlID;c.data.yearValue=f;c.data.monthValue=b;c.data.dayValue=d;this.totalSendDataByMainEnd(a.eform,c);};EFormSocket.prototype.receiveInputCalendar=function(c){var b=m_reportHashMap[c.data.reportID];if(null==b){b=this.eform;}if(null!=b.eFormControlList){var a=b.eFormControlList[c.data.ctrlID];if(null!=a){a.m_default_setValue(c.data.yearValue,c.data.monthValue,c.data.dayValue);}}};EFormSocket.prototype.sendInputSelectbox=function(a,b,c){var d={cmd:"call-event",type:"selectbox",event:b,data:{ctrlID:"",value:""}};d.data.reportID=a.eform.m_uid;d.data.ctrlID=a.ctrlID;d.data.value=c;this.totalSendDataByMainEnd(a.eform,d);};EFormSocket.prototype.receiveInputSelectbox=function(c){var b=m_reportHashMap[c.data.reportID];if(null==b){b=this.eform;}if(null!=b.eFormControlList){var a=b.eFormControlList[c.data.ctrlID];if(null!=a){if(c.event=="change"){a.m_default_onChange();}else{if(c.event=="value"){a.m_default_setValue(c.data.value);}}}}};EFormSocket.prototype.sendUnSelectGroup=function(a,c,b){if(typeof b=="undefined"){b=null;}var d={cmd:"call-event",type:"unselectgroup",data:{groupID:"",eventBubble:true}};d.data.reportID=a.parent.m_uid;d.data.groupID=a.groupID;d.data.rName=b;d.data.eventBubble=c;this.totalSendDataByMainEnd(a.parent,d);};EFormSocket.prototype.receiveUnSelectGroup=function(c){var b=m_reportHashMap[c.data.reportID];if(null==b){b=this.eform;}var a=b.findGroup(c.data.groupID);if(null!=a){a.un_Default_Select(c.data.eventBubble,c.data.rName);}};EFormSocket.prototype.sendMainViewPoint=function(a,d,b){var c={cmd:"call-event",type:"mainviewpoint",data:{x:a,y:d}};c.data.reportID=b;this.totalSendData(c);};EFormSocket.prototype.receiveMainViewPoint=function(b){var a=m_reportHashMap[b.data.reportID];if(null==a){a=this.eform;}a.receiveViewPoint(b.data.x,b.data.y);};EFormSocket.prototype.sendSubViewZoom=function(b,a){var c={cmd:"call-event",type:"subviewzoom",data:{value:b}};c.data.reportID=a;this.totalSendData(c);};EFormSocket.prototype.receiveSubViewZoom=function(b){var a=m_reportHashMap[b.data.reportID];if(null==a){a=this.eform;}a.receiveZoomIn(b.data.value);};EFormSocket.prototype.sendScrollYPosition=function(b,a){var c={cmd:"call-event",type:"scrollY",data:{ctrlID:""}};c.data.reportID=a;c.data.ctrlID=b.srcElement.id;c.data.scrollTop=b.srcElement.scrollTop;if(null!=b.srcElement.clientHeight){c.data.clientHeight=b.srcElement.clientHeight;c.data.contentHeight=b.srcElement.firstChild.clientHeight;this.totalSendData(c);}else{ReportWebLog("ScrollPosition(fn sendScrollPosition)에  대한 해당 서식("+a+")의 영역이 존재하지 않습니다.");}};EFormSocket.prototype.receiveScrollYPosition=function(f){this.m_scrollYLock=true;var b=m_reportHashMap[f.data.reportID];if(null==b){b=this.eform;}var j=b.paintDiv.firstChild.clientHeight;var i=b.paintDiv.offsetTop-b.paintDiv.scrollTop;var c=f.data.contentHeight;var d=f.data.clientHeight;var a=f.data.scrollTop;var g=d/c*j;this.scrollTop=a/c*j;b.paintDiv.scrollTop=this.scrollTop;var h=this;if(this.m_scrollYLockTime!=null){window.clearTimeout(this.m_scrollYLockTime);}this.m_scrollYLockTime=window.setTimeout(function(){h.m_scrollYLock=false;h.m_scrollYLockTime=null;},500);};EFormSocket.prototype.sendScrollPosition=function(b,a){if(this.m_scrollYLock){return;}var c={cmd:"call-event",type:"scroll",data:{ctrlID:""}};c.data.reportID=a;c.data.ctrlID=b.srcElement.id;c.data.scrollTop=b.srcElement.scrollTop;c.data.scrollLeft=b.srcElement.scrollLeft;if(c.data.scrollTop!=0&&c.data.scrollLeft!=0){if(c.data.scrollTop<0){c.data.scrollTop=0;}if(c.data.scrollLeft<0){c.data.scrollLeft=0;}if(c.data.scrollTop==0&&c.data.scrollLeft==0){return;}}if(null!=b.srcElement.clientHeight){c.data.clientHeight=b.srcElement.clientHeight;c.data.contentHeight=b.srcElement.firstChild.clientHeight;c.data.clientWidth=b.srcElement.clientWidth;c.data.contentWidth=b.srcElement.scrollWidth;this.totalSendData(c);}else{ReportWebLog("ScrollPosition(fn sendScrollPosition)에  대한 해당 서식("+a+")의 영역이 존재하지 않습니다.");}};EFormSocket.prototype.receiveScrollPosition=function(k){var j=m_reportHashMap[k.data.reportID];if(null==j){j=this.eform;}this.m_scrollYLock=true;var p=document.getElementById("scroll_guider"+j.m_uid);var n=document.getElementById("scroll_guider_selector"+j.m_uid);if(p!=null){var q=j.paintDiv.firstChild.clientHeight;var l=j.paintDiv.offsetTop-j.paintDiv.scrollTop;var g=k.data.contentHeight;var r=k.data.clientHeight;var s=k.data.scrollTop;var h=r/g*q;this.scrollTop=s/g*q;p.style.height=n.style.height=h+"px";p.style.top=n.style.top=(this.scrollTop+l)+"px";if(h>0){p.style.borderWidth=n.style.borderWidth="2px";}if(j.m_useSubViewCtrl){var o=j.paintDiv.lastChild.clientWidth*j.m_objCavasRate;var d=j.paintDiv.firstChild.clientWidth;var f=j.paintDiv.offsetLeft-j.paintDiv.scrollLeft;if(d-o>0){f=f+((d-o)/2);}var c=k.data.clientWidth;var b=k.data.contentWidth;var m=k.data.scrollLeft;var t=c/b*o;this.scrollLeft=m/b*o;p.style.width=t+"px";p.style.left=n.style.left=(this.scrollLeft+f)+"px";}var i=n.getAttribute("pinStatus");if(null!=i){if(i=="true"){j.paintDiv.scrollTop=this.scrollTop;if(j.m_useSubViewCtrl){j.paintDiv.scrollLeft=this.scrollLeft;}}}j.setProperty("sub_position",k.data);}var a=this;if(this.m_scrollYLockTime!=null){window.clearTimeout(this.m_scrollYLockTime);}this.m_scrollYLockTime=window.setTimeout(function(){a.m_scrollYLock=false;a.m_scrollYLockTime=null;},500);};EFormSocket.prototype.sendScrollTo=function(c){var d={cmd:"call-event",type:"scrollTo",data:{scrollTop:"",scrollHeight:""}};d.data.reportID=c.m_uid;var b=document.getElementById("scroll_guider"+c.m_uid);var a=b.offsetTop+c.paintDiv.scrollTop;this.debugMeg("this.eform.paintDiv.scrollTop:"+c.paintDiv.scrollTop+":this.eform.paintDiv.offsetTop:"+c.paintDiv.offsetTop);d.data.scrollTop=a-c.paintDiv.offsetTop;d.data.scrollHeight=c.paintDiv.scrollHeight;d.data.contentHeight=c.paintDiv.firstChild.clientHeight;this.debugMeg("send",d);this.totalSendData(d);};EFormSocket.prototype.receiveScrollTo=function(d){this.debugMeg("receiveScrollTo",d);var b=m_reportHashMap[d.data.reportID];if(null==b){b=this.eform;}var a=b.paintDiv.firstChild.clientHeight;var c=d.data.scrollTop*(a/d.data.contentHeight);this.debugMeg("receiveScrollTo",c);b.paintDiv.scrollTop=c;};EFormSocket.prototype.sendMoveUp=function(a){this.debugMeg("sendMoveUp");var b={cmd:"call-event",type:"moveUp"};this.totalSendData(b);};EFormSocket.prototype.receiveMoveUp=function(){var a=this.eform.paintDiv.scrollTop-20;this.debugMeg("top",a);this.eform.paintDiv.scrollTop=a;this.debugMeg("top",this.eform.paintDiv.scrollTop);};EFormSocket.prototype.sendMoveDown=function(a){this.debugMeg("sendMoveDown");var b={cmd:"call-event",type:"moveDown"};this.totalSendData(b);};EFormSocket.prototype.receiveMoveDown=function(){var a=this.eform.paintDiv.scrollTop+20;this.debugMeg("top",a);this.eform.paintDiv.scrollTop=a;this.debugMeg("top",this.eform.paintDiv.scrollTop);};function sleep(a){var b=new Date().getTime()+(a);while(new Date().getTime()<=b){}}EFormSocket.prototype.sendSyncSignHybridView=function(a){var b={cmd:"call-event",type:"syncSignHybrid",event:"call",data:{ctrlID:""}};b.data.reportID=a.eform.m_uid;b.data.ctrlID=a.ctrlID;var c=true;if(this.wsPath!="localhost"){if(!(this.stateWs==300||this.stateWs==400)){c=false;}}if(c){this.totalSendData(b);}};EFormSocket.prototype.receiveSyncSignHybridView=function(c){var b=m_reportHashMap[c.data.reportID];if(null==b){b=this.eform;}if(null!=b.eFormControlList){var a=b.eFormControlList[c.data.ctrlID];if(null!=a){a.eFormHybridSignView();}}};EFormSocket.prototype.sendSyncSignResize=function(a){var b={cmd:"call-event",type:"syncSign",event:"resize",data:{ctrlID:""}};b.data.reportID=a.eform.m_uid;b.data.ctrlID=a.ctrlID;this.totalSendData(b);};EFormSocket.prototype.sendSyncSignView=function(a){var b={cmd:"call-event",type:"syncSign",event:"popView",data:{ctrlID:""}};b.data.reportID=a.eform.m_uid;b.data.ctrlID=a.ctrlID;this.totalSendData(b);};EFormSocket.prototype.sendSyncSignCencelButton=function(a){var b={cmd:"call-event",type:"syncSign",event:"cencelButton",data:{ctrlID:""}};b.data.reportID=a.eform.m_uid;b.data.ctrlID=a.ctrlID;this.totalSendData(b);};EFormSocket.prototype.sendSyncSignResetButton=function(a){var b={cmd:"call-event",type:"syncSign",event:"resetButton",data:{ctrlID:""}};b.data.reportID=a.eform.m_uid;b.data.ctrlID=a.ctrlID;this.totalSendData(b);};EFormSocket.prototype.sendSyncSignOkButton=function(a){var b={cmd:"call-event",type:"syncSign",event:"okButton",data:{ctrlID:""}};b.data.reportID=a.eform.m_uid;b.data.ctrlID=a.ctrlID;this.totalSendData(b);};EFormSocket.prototype.sendSyncSignData=function(a,b,d){var c={cmd:"call-event",type:"syncSign",event:"signData",data:{ctrlID:"",moveCount:b,signData:d,width:500,height:500}};if(null!=mRe_sign.jSign){canvas=mRe_sign.jSign.context.firstChild.nextElementSibling.nextElementSibling;c.data.width=canvas.width;c.data.height=canvas.height;}c.data.reportID=a.eform.m_uid;c.data.ctrlID=a.ctrlID;this.totalSendData(c);};EFormSocket.prototype.receiveSyncSignView=function(n){var j=m_reportHashMap[n.data.reportID];if(null==j){j=this.eform;}if(null!=j.eFormControlList){var p=j.eFormControlList[n.data.ctrlID];if(null!=p){if(n.event=="popView"){p.eFormSyncView();}else{if(n.event=="cencelButton"){p.eFormSyncSignCencelButton();}else{if(n.event=="resetButton"){p.eFormSyncSignResetButton();}else{if(n.event=="okButton"){p.eFormSyncSignOkButton();}else{if(n.event=="signData"){p.controlData.po.move_count+=n.data.moveCount;mRe_sign.move_count+=n.data.moveCount;var w=n.data.signData.split(":");var f=null;if(null!=mRe_sign.jSign){f=mRe_sign.jSign.context.firstChild.nextElementSibling.nextElementSibling;var g=f.width/n.data.width;var h=f.height/n.data.height;var m,k;var l=f.getContext("2d");for(var r=0;r<w.length;r++){var q=w[r];if(q=="D"){m=w[++r]*g;k=w[++r]*h;var o=w[++r]*g;canvasBasicDot(l,m,k,o);}else{if(q=="L"){if(r==0){continue;}var b=w[++r]*g;var a=w[++r]*h;canvasBasicLine(l,m,k,b,a);m=b;k=a;}else{if(q=="C"){var b=w[++r]*g;var a=w[++r]*h;var u=w[++r]*g;var t=w[++r]*h;var d=w[++r]*g;var c=w[++r]*h;canvasBasicCurve(l,m,k,b,a,u,t,d,c);m=b;k=a;}}}}}}else{if(n.event=="resize"){var j=mRe_sign.eform;var v=mRe_sign.jSign.jSignature("getData").split("base64,")[1];var s=mRe_sign.move_count;j.eFormSyncSignCencelButton();mRe_sign={image:null,move_count:0};mRe_sign.move_count=s;mRe_sign.image=v;if(j.isSyncSignView){j.eFormSyncSignControl();}else{j.eFormSignControl();}}}}}}}}}};EFormSocket.prototype.sendHybridSignViewEvent=function(a,b){var c={cmd:"call-event",type:"hybridSignEvent",event:b,data:{ctrlID:""}};c.data.reportID=a.eform.m_uid;c.data.ctrlID=a.ctrlID;this.totalSendData(c);};EFormSocket.prototype.receiveHybridSignViewEvent=function(c){var b=m_reportHashMap[c.data.reportID];if(null==b){b=this.eform;}if(null!=b.eFormControlList){var a=b.eFormControlList[c.data.ctrlID];if(null!=a){if(c.event=="ok"){a.onOkButton();}else{a.onCencelButton();}}}};EFormSocket.prototype.sendHybridInputFocusControl=function(a){var b={cmd:"call-event",type:"hyInputFocusCtrl",data:{ctrlID:""}};b.data.reportID=a.eform.m_uid;b.data.ctrlID=a.ctrlID;this.totalSendData(b);};EFormSocket.prototype.receiveHybridInputFocusControl=function(c){var b=m_reportHashMap[c.data.reportID];if(null==b){b=this.eform;}if(null!=b.eFormControlList){var a=b.eFormControlList[c.data.ctrlID];if(null!=a){if(!a.isCallKeyboardConnect&&!a.controlData.subOnlyEdit){a.createSubCallKeyboardButton();}}}};EFormSocket.prototype.sendHybridInputCallKeyboard=function(a){var c={cmd:"call-event",type:"hyInputCallKeyboard",data:{ctrlID:""}};c.data.reportID=a.eform.m_uid;c.data.ctrlID=a.ctrlID;if(a.isDOM){if(a.inputElement){try{a.inputElement.blur();}catch(b){a.eform.debugMeg(b.stack);}}}this.totalSendDataByMainEnd(a.eform,c);};EFormSocket.prototype.receiveHybridInputCallKeyboard=function(c){var b=m_reportHashMap[c.data.reportID];if(null==b){b=this.eform;}if(null!=b.eFormControlList){var a=b.eFormControlList[c.data.ctrlID];if(null!=a){window.setTimeout(function(){a.callHybridInput();},window.mRe_exeCallInterval);}}};EFormSocket.prototype.sendCloseStampProgress=function(a){var b={cmd:"call-event",type:"CloseStampProgress"};b.reportID=a;this.totalSendData(b);};EFormSocket.prototype.receiveCloseStampProgress=function(b){var a=m_reportHashMap[b.reportID];if(null==a){a=this.eform;}a.mRe_setStamp(null);};EFormSocket.prototype.sendExeMainStampData=function(d,g,a){var j=window.mRe_socketSplitValue;var b={cmd:"call-event",type:"exeMainStampData",data:{ctrlID:"",value:"",totalCnt:0,index:0}};b.data.reportID=d;b.data.ctrlID=g;var k=a.length;if(k==0){b.data.totalCnt=1;b.data.index=0;b.data.value="";this.totalSendData(b);}else{var f=Math.ceil(k/j);b.data.totalCnt=f;for(var c=0;c<f;c++){var h;if((c+1)==f){h=a.substring(c*j);}else{h=a.substring(c*j,(c+1)*j);}b.data.index=c;b.data.value=h;this.totalSendData(b);}}};EFormSocket.prototype.receiveExeMainStampData=function(d){var c=m_reportHashMap[d.data.reportID];if(null==c){c=this.eform;}if(null!=c.eFormControlList){var a=c.eFormControlList[d.data.ctrlID];if(null!=a){if(null==a.splitMap){a.splitMap={receiveCount:0,dataList:[]};}a.splitMap.dataList[d.data.index]=d.data.value;a.splitMap.receiveCount++;if(a.splitMap.receiveCount==d.data.totalCnt){var b=a.splitMap.dataList.join("");a.splitMap=null;c.callExeStampSubSetter(d.data.ctrlID,b);}}}};EFormSocket.prototype.sendExeStampCall=function(b,a){var c={cmd:"call-event",type:"exeStampCall"};c.reportID=b;c.ctrlID=a;this.totalSendData(c);};EFormSocket.prototype.receiveExeStampCall=function(b){var a=m_reportHashMap[b.reportID];if(null==a){a=this.eform;}if(null!=a){a.callExeShowStampDlg(b.ctrlID,false);}};EFormSocket.prototype.sendStampCall=function(a){var b={cmd:"call-event",type:"stampCall"};b.reportID=a;this.totalSendData(b);};EFormSocket.prototype.receiveStampCall=function(b){var a=m_reportHashMap[b.reportID];if(null==a){a=this.eform;}if(null!=a.m_socketReportEvent.stampCall){a.m_socketReportEvent.stampCall();}};EFormSocket.prototype.sendStampMainCancel=function(){var a={cmd:"call-event",type:"stampMainCancel"};this.totalSendData(a);};EFormSocket.prototype.receiveStampMainCancel=function(a){if(is_appControl){ClipHybrid.callNativeControl("stampCancel",null);}};EFormSocket.prototype.sendStampSubCancel=function(a){var b={cmd:"call-event",type:"stampSubCancel"};b.reportID=a;this.totalSendData(b);};EFormSocket.prototype.receiveStampSubCancel=function(b){var a=m_reportHashMap[b.reportID];if(null==a){a=this.eform;}if(null!=a.m_socketReportEvent.stampCancel){a.m_socketReportEvent.stampCancel();}};EFormSocket.prototype.sendStampData=function(d){var h=window.mRe_socketSplitValue;var g={cmd:"call-event",type:"stampData",data:{value:"",totalCnt:0,index:0}};var a=d.length;if(a==0){g.data.totalCnt=1;g.data.index=0;g.data.value="";this.totalSendData(g);}else{var f=Math.ceil(a/h);g.data.totalCnt=f;for(var b=0;b<f;b++){var c;if((b+1)==f){c=d.substring(b*h);}else{c=d.substring(b*h,(b+1)*h);}g.data.index=b;g.data.value=c;this.totalSendData(g);}}};EFormSocket.prototype.receiveStampData=function(a){if(null==this.splitMap){this.splitMap={receiveCount:0,dataList:[]};}this.splitMap.dataList[a.data.index]=a.data.value;this.splitMap.receiveCount++;if(this.splitMap.receiveCount==a.data.totalCnt){if(is_appControl){ClipHybrid.callNativeControl("stampData",this.splitMap.dataList.join(""));}this.splitMap=null;}};EFormSocket.prototype.sendHybridInputCallCalendar=function(a){var b={cmd:"call-event",type:"hyInputCallCalendar",data:{ctrlID:""}};b.data.reportID=a.eform.m_uid;b.data.ctrlID=a.ctrlID;this.totalSendData(b);};EFormSocket.prototype.receiveHybridInputCallCalendar=function(c){var b=m_reportHashMap[c.data.reportID];if(null==b){b=this.eform;}if(null!=b.eFormControlList){var a=b.eFormControlList[c.data.ctrlID];if(null!=a){a.callHybridCalendar();}}};EFormSocket.prototype.sendSignClickEvent=function(a){var b={cmd:"call-event",type:"signClick",data:{ctrlID:""}};b.data.reportID=a.eform.m_uid;b.data.ctrlID=a.ctrlID;this.totalSendData(b);};EFormSocket.prototype.receiveSignClickEvent=function(c){var b=m_reportHashMap[c.data.reportID];if(null==b){b=this.eform;}if(null!=b.eFormControlList){var a=b.eFormControlList[c.data.ctrlID];if(null!=a){a.receiveClick();}}};EFormSocket.prototype.sendFocusControl=function(a,b){var c={cmd:"call-event",type:"focusctrl",event:b,data:{ctrlID:""}};c.data.reportID=a.eform.m_uid;c.data.ctrlID=a.ctrlID;this.totalSendData(c);};EFormSocket.prototype.receiveFocusControl=function(c){var b=m_reportHashMap[c.data.reportID];if(null==b){b=this.eform;}if(null!=b.eFormControlList){var a=b.eFormControlList[c.data.ctrlID];if(null!=a){if(c.event=="in"){a.multiViewFocus();}else{a.multiViewBlur();}}}};EFormSocket.prototype.sendNecessaryInfo=function(a,b){var c={cmd:"call-event",type:"necessaryInfo",data:{ctrlID:a}};c.data.reportID=b;this.totalSendData(c);};EFormSocket.prototype.sendRulesSectionVisibleMultiData=function(c,j){var g={cmd:"call-event",type:"rulesSectionVisibleMultiData",id:c,data:{list:null}};if(this.wsPath=="localhost"){g.data.list=j;this.totalSendData(g);}else{g.type="rulesSectionVisibleMultiDataSplit";base64Data=mCR_Base64.encode(JSON.stringify(j));var h=window.mRe_socketSplitValue;var a=base64Data.length;var f=Math.ceil(a/h);g.data.totalCnt=f;for(var b=0;b<f;b++){var d;if((b+1)==f){d=base64Data.substring(b*h);}else{d=base64Data.substring(b*h,(b+1)*h);}g.data.index=b;g.data.value=d;this.totalSendData(g);}}};EFormSocket.prototype.receiveRulesSectionVisibleMultiDataSplit=function(c){var b=m_reportHashMap[c.id];if(null==b){b=this.eform;}if(null==b.s_splitPathDataMap){b.s_splitPathDataMap={receiveCount:0,dataList:[]};}b.s_splitPathDataMap.dataList[c.data.index]=c.data.value;b.s_splitPathDataMap.receiveCount++;if(b.s_splitPathDataMap.receiveCount==c.data.totalCnt){var a=b.s_splitPathDataMap.dataList.join("");c.data.list=JSON.parse(mCR_Base64.decode(a));b.default_eformEasyInputSectionVisibleMultiData(c.data.list);b.s_splitPathDataMap=null;}};EFormSocket.prototype.receiveRulesSectionVisibleMultiData=function(b){var a=m_reportHashMap[b.id];if(null!=a){a.default_eformEasyInputSectionVisibleMultiData(b.data.list);}};EFormSocket.prototype.sendRulesSectionVisible=function(c,b,a,g,f){var d={cmd:"call-event",type:"rulesSectionVisible",id:c,reportID:b,sectionName:a,visible:g,mode:f};this.totalSendData(d);};EFormSocket.prototype.receiveRulesSectionVisible=function(b){var a=m_reportHashMap[b.id];if(null!=a){a.default_eformEasyInputSectionVisible(b.reportID,b.sectionName,b.visible,b.mode);}};EFormSocket.prototype.sendRulesControlColor=function(d,h,c,b,g,a,i){var f={cmd:"call-event",type:"rulesControlColor",id:d,reportID:h,controlID:c,red:b,green:g,blue:a,alpha:i};this.totalSendData(f);};EFormSocket.prototype.receiveRulesControlColor=function(b){var a=m_reportHashMap[b.id];if(null!=a&&null!=a.setEFormRulesCommandColor_inzent){a.setEFormRulesCommandColor_inzent(b.reportID,b.controlID,b.red,b.green,b.blue,b.alpha);}else{if(null!=a&&null!=a.setEFormRulesCommandColor){a.setEFormRulesCommandColor(b.reportID,b.controlID,b.red,b.green,b.blue,b.alpha);}}};EFormSocket.prototype.sendControlColor=function(a,c,b,g,d){var f={cmd:"call-event",type:"controlColor",data:{ctrlID:"",red:c,green:b,blue:g,alpha:d}};f.data.reportID=a.eform.m_uid;f.data.ctrlID=a.ctrlID;this.totalSendDataByMainEnd(a.eform,f);};EFormSocket.prototype.receiveControlColor=function(c){var b=m_reportHashMap[c.data.reportID];if(null==b){b=this.eform;}if(null!=b.eFormControlList){var a=b.eFormControlList[c.data.ctrlID];if(null!=a){a.setGuideBGColor(c.data.red,c.data.green,c.data.blue,c.data.alpha,false);}}};EFormSocket.prototype.sendPopupSubsectionClose=function(a){var b={cmd:"call-event",type:"popupSubsectionClose",id:a};this.totalSendData(b);};EFormSocket.prototype.receivePopupSubsectionClose=function(b){var a=m_reportHashMap[b.id];if(null!=a){a.mRe_popupSubsectionClose(false);}};EFormSocket.prototype.sendRulesControlInfo=function(b,a){var c={cmd:"call-event",type:"rulesControlInfo",data:{ctrlID:b,reportID:a}};this.totalSendData(c);};EFormSocket.prototype.receiveNecessaryInfo=function(c){var a=m_reportHashMap[c.data.reportID];if(null==a){a=this.eform;}var b=c.data.ctrlID;if(null!=b&&null!=a){a.m_isNecessaryInfo=b;}};EFormSocket.prototype.receiveRulesControlInfo=function(c){var b=m_reportHashMap[c.data.reportID];if(null==b){b=this.eform;}var a=c.data.ctrlID;if(null!=a&&null!=b){b.m_isrulesControlInfo=a;}};EFormSocket.prototype.sendTabAppend=function(d,b,a,h,c,i,g){var f={cmd:"call-event",type:"tabAppend",data:{ctrlID:d,key:b,eventString:a,selectClass:h,unSelectClass:c,tabIndex:i,isSB:g}};this.totalSendData(f);};EFormSocket.prototype.sendFindSubTab=function(){var a={cmd:"call-event",type:"findSubTab",data:{ctrlID:""}};this.totalSendData(a);};EFormSocket.prototype.receiveFindSubTab=function(a){if(this.tabPlugin!=null){var a={cmd:"call-event",type:"findSubTabClose",data:{ctrlID:""}};this.totalSendData(a);}};EFormSocket.prototype.receiveFindSubTabClose=function(b){var a=b.data.ctrlID;if(null!=this.tabPlugin){this.tabPlugin.receiveFindSubTabClose();}};EFormSocket.prototype.receiveTabAppend=function(c){var b=c.data.ctrlID;var a=c.data.key;if(null!=b&&null!=this.tabPlugin){ReportWebLog("appendTabByEForm=receiveTabAppend");this.tabPlugin.isScreenBlock=c.data.isSB;this.tabPlugin.appendTabByEForm(b,a,c.data.eventString,c.data.selectClass,c.data.unSelectClass,c.data.tabIndex);}};EFormSocket.prototype.receiveTabAppendClose=function(b){var a=b.data.ctrlID;if(null!=a&&null!=this.tabPlugin){this.tabPlugin.receiveSubAppendClose(a);}};EFormSocket.prototype.sendTabSelect=function(a){var b={cmd:"call-event",type:"tabSelect",data:{ctrlID:a}};this.totalSendData(b);};EFormSocket.prototype.receiveTabSelect=function(b){var a=b.data.ctrlID;if(null!=a&&null!=this.tabPlugin){this.tabPlugin.m_default_selectTab(a);}};EFormSocket.prototype.sendTabRemove=function(a){var b={cmd:"call-event",type:"tabRemove",data:{ctrlID:a}};this.totalSendData(b);};EFormSocket.prototype.receiveTabRemove=function(b){var a=b.data.ctrlID;if(null!=a&&null!=this.tabPlugin){this.tabPlugin.m_default_removeTab(a);}};EFormSocket.prototype.sendTabListInfo=function(b){var a={cmd:"call-event",type:"tabListInfo",data:{ctrlID:b}};this.systemSendData(a);};EFormSocket.prototype.receiveTabListInfo=function(a){var b=a.data.ctrlID;if(null!=b&&null!=this.tabPlugin){this.tabPlugin.receiveTabListInfo(b);}};EFormSocket.prototype.sendTabSubStatus=function(a){this.callStateChange(400,400);if(typeof ClipHybrid!="undefined"){ClipHybrid.callMirraring("show","");}var b={cmd:"call-event",type:"tabSubStatus",data:{ctrlID:a}};this.systemSendData(b);};EFormSocket.prototype.receiveTabSubStatus=function(a){var b=a.data.ctrlID;if(null!=b&&null!=this.tabPlugin){this.tabPlugin.receiveTabSubStatus(b);}};EFormSocket.prototype.sendTabDisabledButton=function(a){var b={cmd:"call-event",type:"tabDisabledButton",data:{disabled:a}};this.totalSendData(b);};EFormSocket.prototype.receiveTabDisabledButton=function(a){if(null!=this.tabPlugin){this.tabPlugin.default_setDisabledButton(a.data.disabled);}};EFormSocket.prototype.sendOpenClipAlert=function(d,b,a){if(typeof a=="undefined"){a=3;}var c={cmd:"call-event",type:"openClipAlert",data:{t:d,m:b,tp:a}};this.totalSendData(c);};EFormSocket.prototype.receiveOpenClipAlert=function(c){var a=c.data.tp;var b=a;if(a==2||a==3){b=1;}if(null!=window.m_clipEFormSocket){if(!window.m_clipEFormSocket.isMain){if(a==3){b=0;}}else{if(a==2){b=0;}}}ClipAlertUI(c.data.t,c.data.m,function(d){try{if(null!=window.m_clipEFormSocket){window.m_clipEFormSocket.sendCloseClipAlert();}}catch(f){mRe_ReportWebLog(f.stack);}},b);};EFormSocket.prototype.sendCloseClipAlert=function(){var a={cmd:"call-event",type:"closeClipAlert"};this.totalSendData(a);};EFormSocket.prototype.receiveCloseClipAlert=function(a){if(null!=window.m_clipAlert){document.body.removeChild(window.m_clipAlert);window.m_clipAlert=null;}};EFormSocket.prototype.sendMemoData=function(a,b){var c={cmd:"call-event",type:"memoData",data:{ctrlID:a}};c.data.reportID=b;this.totalSendData(c);};EFormSocket.prototype.receiveMemoData=function(c){var b=m_reportHashMap[c.data.reportID];if(null==b){b=this.eform;}var a=c.data.ctrlID;if(null!=a){b.receiveMemoData(a);}};EFormSocket.prototype.sendChatMessage=function(b,a){var c={cmd:"call-event",type:"chatData",data:{ctrlID:b}};c.data.reportID=a;this.totalSendData(c);};EFormSocket.prototype.receiveChatMessage=function(c){var b=m_reportHashMap[c.data.reportID];if(null==b){b=this.eform;}var a=c.data.ctrlID;if(null!=a){b.mRe_chatPopup();b.mRe_chatReceiveData(a);}};EFormSocket.prototype.sendSignScriptRate=function(b,a){var c={cmd:"call-event",type:"SignScriptRate",data:{rate:a}};c.data.reportID=b;this.totalSendData(c);};EFormSocket.prototype.receiveSignScriptRate=function(c){var b=m_reportHashMap[c.data.reportID];if(null==b){b=this.eform;}var a=c.data.rate;if(null!=a){b.m_exeSignScriptRate=a;}};EFormSocket.prototype.sendEFormDisabled=function(b,a){var c={cmd:"call-event",type:"EFormDisabled",data:{disabled:a}};c.data.reportID=b.m_uid;this.totalSendDataByMainEnd(b,c);};EFormSocket.prototype.receiveEFormDisabled=function(c){var b=m_reportHashMap[c.data.reportID];if(null==b){b=this.eform;}var a=c.data.disabled;if(null!=a){b.EFormDisabled(a,false);}};EFormSocket.prototype.callMainData=function(b,a){if(null==b.m_saveOrigin){var c={cmd:"call-event",type:"mainData",data:{reportID:b.m_uid,nCount:a,isApp:is_appControl}};this.systemSendData(c);}};EFormSocket.prototype.receiveEndSubData=function(b){var a=m_reportHashMap[b.data.reportID];if(null==a){a=this.eform;}if(null!=a){if(a.endSendViewDataEvent!=null){a.endSendViewDataEvent();}}};EFormSocket.prototype.receiveCallMainData=function(c){var b=m_reportHashMap[c.data.reportID];if(null==b){b=this.eform;}var f={cmd:"call-event",type:"subData",data:{reportID:b.m_uid,status:true,nCount:c.data.nCount,value:null}};b.isSubWebApp=c.data.isApp;if(b.m_isEndMainData){var k=b.m_saveOrigin;b.EF_DoodlePageSave();k.doodleInfo=b.eFormDoodleOption.pagePathSave;k.eformDisabledMirr=b.m_eformDisabledMirr;k.eformDisabled=b.m_eformDisabled;if(b.beforeSendViewDataEvent!=null){b.beforeSendViewDataEvent();}if(this.wsPath=="localhost"){f.data.value=k;}else{f.type="subDataMulti";var j=window.mRe_socketSplitValue;var a=encodeURIComponent(JSON.stringify(k));var l=a.length;var g=Math.ceil(l/j);f.data.totalCnt=g;for(var d=0;d<g;d++){var h;if((d+1)==g){h=a.substring(d*j);}else{h=a.substring(d*j,(d+1)*j);}f.data.index=d;f.data.value=h;this.systemSendData(f);}return;}}else{f.data.status=false;f.data.nCount++;}this.systemSendData(f);};EFormSocket.prototype.sendChangeMode=function(c,b){var a={cmd:"call-event",type:"changeMode",data:{reportID:c,mode:b}};this.totalSendData(a);};EFormSocket.prototype.receiveChangeMode=function(b){var a=m_reportHashMap[b.data.reportID];if(null==a){a=this.eform;}if(b.data.mode=="nomarl"){a.ModeNomarlInput();}else{if(b.data.mode=="easy"){a.ModeEasyInput();}else{if(b.data.mode=="display"){a.ModeDisplayInput();}}}};EFormSocket.prototype.receiveSubDataMulti=function(f){var b=this.userId_map[f.data.reportID];if(null==b){var d={receiveCount:0,dataList:[]};this.userId_map[f.data.reportID]=b=d;}b.dataList[f.data.index]=f.data.value;b.receiveCount++;if(b.receiveCount==f.data.totalCnt){var c=b.dataList.join("");c=decodeURIComponent(c);var a=JSON.parse(c);f.data.value=a;this.userId_map[f.data.reportID]=null;this.receiveSubDataData(f);}};EFormSocket.prototype.receiveSubDataData=function(f){var a=this;var c=m_reportHashMap[f.data.reportID];if(null==c){c=this.eform;}if(f.data.status){c.subPaintEFormJson(f.data.value);this.sendEndSubData(c);}else{var b=f.data.nCount;if(200>b){var d=(b*10);window.setTimeout(function(){a.callMainData(c,b);},300+d);}}};EFormSocket.prototype.sendEndSubData=function(a){var b={cmd:"call-event",type:"endSubData",data:{reportID:a.m_uid}};this.systemSendData(b);};EFormSocket.prototype.sendExeSubAlive=function(b){var a={cmd:"call-event",type:"exeSubAlive",reportID:b};this.systemSendData(a);};EFormSocket.prototype.receiveExeSubAlive=function(b){var a=m_reportHashMap[b.reportID];if(null==a){a=this.eform;}if(null!=a){if(a.m_isEndReport){this.sendExeSubAliveAnswer(a.m_uid);}}};EFormSocket.prototype.sendExeSubAliveAnswer=function(b){var a={cmd:"call-event",type:"exeSubAliveAnswer",reportID:b};this.systemSendData(a);};EFormSocket.prototype.receiveExeSubAliveAnswer=function(b){var a=m_reportHashMap[b.reportID];if(null==a){a=this.eform;}if(null!=a){a.mRe_receiveAliveSub();}};EFormSocket.prototype.sendExeSubCallEvent=function(c,a){var b={cmd:"call-event",type:"exeSubCallEvent",reportID:c,data:a};this.systemSendData(b);};EFormSocket.prototype.receiveExeSubCallEvent=function(c){var b=m_reportHashMap[c.reportID];if(null==b){b=this.eform;}var a=c.data.methodName;if(a=="SaveSignatureCtrlForm"){b.callExeSaveSignatureCtrlFormSub(c.data);}else{if(a=="SaveVirtualKeyboard"){b.callExeSaveVirtualKeyboardCtrlFormSub(c.data);}else{if(a=="InitSignatureCtrlForm"){b.callExeInitSignatureCtrlFormSub(c.data);}else{if(a=="ChangeSignatureCtrlForm"){b.callExeChangeSignatureCtrlFormSub(c.data);}else{if(a=="ClearTextVirtualKeyboard"){b.callExeClearTextVirtualKeyboardCtrlFormSub(c.data);}else{if(a=="ShowStampDlg"){b.callExeShowStampDlgSub(c.data);}}}}}}};var canvasBasicDot=function(b,a,f,d){var c=b.fillStyle;b.fillStyle=b.strokeStyle;b.fillRect(a-d/2,f-d/2,d,d);b.fillStyle=c;},canvasBasicLine=function(b,c,a,f,d){b.beginPath();b.moveTo(c,a);b.lineTo(f,d);b.stroke();},canvasBasicCurve=function(j,b,a,g,f,d,c,i,h){j.beginPath();j.moveTo(b,a);j.bezierCurveTo(d,c,i,h,g,f);j.stroke();};EFormSocket.prototype.systemSendData=function(b){var a=JSON.stringify(b);this.systemSendDataText(a);};EFormSocket.prototype.systemSendDataText=function(a){if(typeof onBeforeSocketSend!=="undefined"){a=onBeforeSocketSend(a);}if(this.wsPath=="localhost"){sleep(10);this.webSocket.send(a);}else{if(null!=this.webSocket&&1==this.webSocket.readyState){sleep(10);this.webSocket.send(a);}else{ReportWebLog("ERROR :: The send message was called while the socket was disconnected.!!");if(null!=this.eform&&null!=this.eform.m_socketViewEvent){this.eform.m_socketViewEvent(3);}}}};EFormSocket.prototype.totalSendDataByMainEnd=function(a,b){if(a.m_isEndMainData){if(a.m_isServerSyncMirroring&&a.getIsMain()&&!a.m_isEndViewData){a.m_aSyncMirrData.push(b);}else{this.totalSendData(b);}}else{a.m_aSyncMirrData.push(b);}};EFormSocket.prototype.totalSendData=function(b){if(this.wsPath=="localhost"){if(window.m_clipIsBufferedSocket){if(this.m_arrSendData==null){this.m_arrSendData=new Array();}this.m_arrSendData.push(b);}else{if(this.m_arrSendData!=null){this.bufferedSendData();}var a=JSON.stringify(b);if(typeof onBeforeSocketSend!=="undefined"){a=onBeforeSocketSend(a);}sleep(10);this.webSocket.send(a);}}else{if(!window.mRe_socketSendBlock&&(this.stateWs==300||this.stateWs==400)){if(null!=this.webSocket&&1==this.webSocket.readyState){var a=JSON.stringify(b);if(typeof onBeforeSocketSend!=="undefined"){a=onBeforeSocketSend(a);}sleep(10);this.webSocket.send(a);}else{ReportWebLog("ERROR :: The send message was called while the socket was disconnected.!!");if(null!=this.eform&&null!=this.eform.m_socketViewEvent){this.eform.m_socketViewEvent(3);}}}}};EFormSocket.prototype.bufferedSendData=function(){window.m_clipIsBufferedSocket=false;if(this.m_arrSendData!=null){var a={cmd:"call-event",type:"bufferedSendData",data:null};a.data=this.m_arrSendData;this.m_arrSendData=null;this.totalSendData(a);}};EFormSocket.prototype.bufferedSendDataMulti=function(j){var c={cmd:"call-event",type:"bufferedSendDataMulti",data:{value:null}};c.data.reportID=mCR_UUID();var h=window.mRe_socketSplitValue;var b=encodeURIComponent(JSON.stringify(j));var a=b.length;var g=Math.ceil(a/h);c.data.totalCnt=g;for(var d=0;d<g;d++){var f;if((d+1)==g){f=b.substring(d*h);}else{f=b.substring(d*h,(d+1)*h);}c.data.index=d;c.data.value=f;this.systemSendData(c);}};EFormSocket.prototype.receiveBufferedDataMulti=function(f){var b=this.userId_map[f.data.reportID];if(null==b){var d={receiveCount:0,dataList:[]};this.userId_map[f.data.reportID]=b=d;}b.dataList[f.data.index]=f.data.value;b.receiveCount++;if(b.receiveCount==f.data.totalCnt){var c=b.dataList.join("");c=decodeURIComponent(c);var a=JSON.parse(c);f.data=a;this.userId_map[f.data.reportID]=null;this.receiveBufferedData(f);}};EFormSocket.prototype.receiveBufferedData=function(b){if(Array.isArray(b.data)){for(var a=0;a<b.data.length;a++){this.callEventCommand(b.data[a]);}}};EFormSocket.prototype.getSocketReason=function(a){var b;if(a.code==1000){b="Normal closure, meaning that the purpose for which the connection was established has been fulfilled.";}else{if(a.code==1001){b='An endpoint is "going away", such as a server going down or a browser having navigated away from a page.';}else{if(a.code==1002){b="An endpoint is terminating the connection due to a protocol error";}else{if(a.code==1003){b="An endpoint is terminating the connection because it has received a type of data it cannot accept (e.g., an endpoint that understands only text data MAY send this if it receives a binary message).";}else{if(a.code==1004){b="Reserved. The specific meaning might be defined in the future.";}else{if(a.code==1005){b="No status code was actually present.";}else{if(a.code==1006){b="The connection was closed abnormally, e.g., without sending or receiving a Close control frame";}else{if(a.code==1007){b="An endpoint is terminating the connection because it has received data within a message that was not consistent with the type of the message (e.g., non-UTF-8 [https://www.rfc-editor.org/rfc/rfc3629] data within a text message).";}else{if(a.code==1008){b='An endpoint is terminating the connection because it has received a message that "violates its policy". This reason is given either if there is no other sutible reason, or if there is a need to hide specific details about the policy.';}else{if(a.code==1009){b="An endpoint is terminating the connection because it has received a message that is too big for it to process.";}else{if(a.code==1010){b="An endpoint (client) is terminating the connection because it has expected the server to negotiate one or more extension, but the server didn't return them in the response message of the WebSocket handshake. <br /> Specifically, the extensions that are needed are: "+a.reason;}else{if(a.code==1011){b="A server is terminating the connection because it encountered an unexpected condition that prevented it from fulfilling the request.";}else{if(a.code==1015){b="The connection was closed due to a failure to perform a TLS handshake (e.g., the server certificate can't be verified).";}else{b="Unknown reason";}}}}}}}}}}}}}return b;};EFormSocket.prototype.getCloseReason=function(){return this.closeReason;};var mCR_DocumentControlType={Label:0,Shape:1,Line:2,Table:3,TableCell:4,TableCellDumy:5,Barcode:6,Checkbox:7,Chart:8,SubReport:9,Crosstab:10,CrosstabMatrixHeader:11,CrosstabMatrixRowLabel:12,CrosstabMatrixColumnLabel:13,CrosstabMatrixSummarized:14,Sign:15,HTML:16,EFormSign:20,EFormCamera:21,EFormInputLabel:22,EFormCheckGroup:23,EFormCheck:24,EFormRadioGroup:25,EFormRadio:26,CopyProtecter:30,Ext2DBarcode:31,ExtBarcode:32,VoiceEye:33,VoiceEye2DBarcode:34,MarkAnyVoiceEye:35,VerifyBarcode:36,VoiceBarcode:37,Input:40,InputCheckbox:41,InputRadiobox:42,InputSign:43,InputImage:44,Calendar:45,InputSelectBox:46,Button:47,Chart2:48,Video:49};var mCR_ImageFotmatType={None:0,BMP:1,JPG:2,PNG:3,GIF:4};var mCR_TextShapeType={Line:0,Rectangle:1,RoundRectangle:2,Ellipse:3};var mCR_LinkType={None:-1,Web:0,Report:1,Drilling:2};var mCR_VerticalAlignmentMethod={Top:0,Center:1,Bottom:2};var mCR_HorizontalAlignmentMethod={Left:0,Middle:1,Right:2,Equal:3,Both:4};var mCR_BackStyleType={Normal:0,Transparent:1};var mCR_LineStyle={None:0,Solid:1,Dash:2,Dot:3,DashDot:4,DashDotDot:5,Strong:7,DoubleLine:8,StrongDouble:9,InnerLine:21};function documentReader(){this.useMultiLanguage=false;}documentReader.prototype.documentReaderFromJSON=function(i,b,g){var c=new docDocument();c.reportServerPath=b;c.reportKey=g;c.version=i.a;c.title=decodeURI(i.b);c.subject=i.c;c.author=i.d;c.keyword=i.e;c.etc=i.f;c.styleManager=this.styleManagerReaderFromJSON(i.g);c.checkedPageCount=i.h;c.checkedTotalPageCount=i.i;c.xPositionList=i.j;for(var f=0;f<i.o.length;f++){var a="report";var d=0;if(null!=i.o[f].d){a=i.o[f].d;d=i.o[f].b;}var j={reportID:a,startPage:d};c.documentReportInfoList.push(j);}c.useMultiLanguage=i.k;this.useMultiLanguage=c.useMultiLanguage;this.pageListRead(c.documentPageList,i.l);c.documentMemo=i.r2;c.documentStorage=i.r;if(null!=i.s1){c.checkImageName=i.s1;}if(null!=i.t1){c.radioImageName=i.t1;}if(i.u){c.objDynamicScript=i.u;}if(i.v){c.arrTocItem=new Array();for(var f=0;f<i.v.length;f++){var h={depth:0,title:"",page:0};h.depth=i.v[f][0];h.title=decodeURI(i.v[f][1]);h.page=i.v[f][2];c.arrTocItem.push(h);}}if(i.x){c.objDoodleInfo=i.x;}if(i.y){c.isThumbnail=i.y;}if(i.z){c.filePageCountList=i.z;}return c;};documentReader.prototype.pageListRead=function(c,b){for(var a=0;a<b.length;a++){c.push(this.readDocumentPage(b[a]));}};documentReader.prototype.styleManagerReaderFromJSON=function(b){var a=new Object();a.pageList=this.stylePageReaderFromJSON(b.a);a.shapeList=this.styleShapeReaderFromJSON(b.b);a.backgroundList=this.styleBackgroundReaderFromJSON(b.c);a.lineList=this.styleLineReaderFromJSON(b.d);a.fontList=this.styleFontReaderFromJSON(b.e);a.textOptionList=this.styleTextOptionReaderFromJSON(b.f);a.textTagList=this.styleTextTagReaderFromJSON(b.g);a.textMarginList=this.styleTextMarginReaderFromJSON(b.h);a.visibleOptionList=this.styleVisibleOptionReaderFromJSON(b.i);a.backgroundImageList=this.styleBackgroundImageReaderFromJSON(b.j);a.fontNameList=this.styleFontNameReaderFromJSON(b.k);return a;};documentReader.prototype.stylePageReaderFromJSON=function(a){var c=new Array();for(var b=0;b<a.length;b++){var d=new docStylePage();d.paperType=a[b][0];d.width=a[b][1];d.height=a[b][2];d.orientation=a[b][3];d.leftMargin=a[b][4];d.topMargin=a[b][5];d.rightMargin=a[b][6];d.bottomMargin=a[b][7];d.pageCount=a[b][8];d.multiColumnDirection=a[b][9];c.push(d);}return c;};documentReader.prototype.styleShapeReaderFromJSON=function(d){var c=new Array();for(var b=0;b<d.length;b++){var a=new docStyleShape();a.shapeType=d[b][0];a.roundRate=d[b][1];c.push(a);}return c;};documentReader.prototype.styleBackgroundReaderFromJSON=function(a){var d=new Array();for(var c=0;c<a.length;c++){var b=new docStyleBackground();b.backStyle=a[c][0];b.backColor=a[c][1];b.fillStyle=a[c][2];b.fillColor=a[c][3];b.gradientStyle=a[c][4];b.gradientStartColor=a[c][5];b.gradientEndColor=a[c][6];d.push(b);}return d;};documentReader.prototype.styleLineReaderFromJSON=function(c){var d=new Array();for(var b=0;b<c.length;b++){var a=new docStyleLine();a.style=c[b][0];a.width=c[b][1];a.color=c[b][2];d.push(a);}return d;};documentReader.prototype.styleFontReaderFromJSON=function(c){var d=new Array();for(var b=0;b<c.length;b++){var a=new docStyleFont();a.nameIndex=c[b][0];a.size=c[b][1];a.bold=c[b][2];a.italic=c[b][3];a.underline=c[b][4];a.strike=c[b][5];a.color=c[b][6];a.underLineStyle=c[b][7];a.underLineColor=c[b][8];a.strikeLineStyle=c[b][9];a.strikeLineColor=c[b][10];a.nameEngIndex=a.nameIndex;if(c[b].length>11){a.nameEngIndex=c[b][11];}if(c[b].length>12){a.underLineWidth=c[b][12];a.autoUnderLineWidth=c[b][13];a.strikeLineWidth=c[b][14];a.autoStrikeLineWidth=c[b][15];}d.push(a);}return d;};documentReader.prototype.styleTextOptionReaderFromJSON=function(d){var a=new Array();for(var c=0;c<d.length;c++){var b=new docStyleTextOption();b.horizontalAlignment=d[c][0];b.verticalAlignment=d[c][1];b.wordWrap=d[c][2];b.wordBreaking=d[c][3];b.wordSpace=d[c][4];b.lineSpace=d[c][5];b.charSet=d[c][6];b.outputFormat=decodeURI(d[c][7]);b.autoFont=d[c][8];a.push(b);}return a;};documentReader.prototype.styleTextTagReaderFromJSON=function(a){var d=new Array();for(var c=0;c<a.length;c++){var b=new docStyleTextTag();b.use=a[c][0];b.bold=a[c][1];b.italic=a[c][2];b.underline=a[c][3];b.strike=a[c][4];b.color=a[c][5];b.round=a[c][6];b.rectangle=a[c][7];b.supScript=a[c][8];b.subScript=a[c][9];b.lineBreak="br";if(a.length>10){b.lineBreak=a[c][10];}b.fontName="font";if(a.length>11){b.fontName=a[c][11];}b.fontSize="";if(a.length>12){b.fontSize=a[c][12];}d.push(b);}return d;};documentReader.prototype.styleTextMarginReaderFromJSON=function(b){var a=new Array();for(var c=0;c<b.length;c++){var d=new docStyleTextMargin();d.left=b[c][0];d.top=b[c][1];d.right=b[c][2];d.bottom=b[c][3];a.push(d);}return a;};documentReader.prototype.styleVisibleOptionReaderFromJSON=function(a){var c=new Array();for(var b=0;b<a.length;b++){var d=new docStyleVisibleOption();d.toView=a[b][0];d.toPrint=a[b][1];d.toXLS=a[b][2];d.toPDF=a[b][3];d.toHWP=a[b][4];d.toHTM=a[b][5];d.toPPT=a[b][6];d.toRTF=a[b][7];d.toBMP=a[b][8];d.toJPG=a[b][9];d.toTIF=a[b][10];d.toTXT=a[b][11];if(a[b].length>=13){d.toEasyMoad=a[b][12];}c.push(d);}return c;};documentReader.prototype.styleBackgroundImageReaderFromJSON=function(b){var a=new Array();for(var c=0;c<b.length;c++){var d=new docStyleBackgroundImage();d.imageDrawMethod=b[c][0];d.imageFrame=b[c][1];d.horizontalAlignment=b[c][2];d.verticalAlignment=b[c][3];d.rate=b[c][4];d.transparency=b[c][5];a.push(d);}return a;};documentReader.prototype.styleFontNameReaderFromJSON=function(c){var b=new Array();for(var a=0;a<c.length;a++){b.push(decodeURI(c[a]));}return b;};documentReader.prototype.readDocumentPage=function(a,b){var c=new documentPage();c.pageStyleKey=a.a;c.pageIndex=a.b;this.readImageList(c,a.c);this.readSubSectionList(c,a.d,b);if(b){c.backGround=null;c.foreGround=null;}else{c.backGround=a.e!=null?this.readSubSection(c,a.e):null;c.foreGround=a.f!=null?this.readSubSection(c,a.f):null;}return c;};documentReader.prototype.readSubSectionList=function(a,g,c){if(c==null){c=false;}var f=g.length;for(var b=0;b<f;b++){var d=this.readSubSection(a,g[b]);if(c){if(d.sectionType!=6&&d.sectionType!=7){a.subSectionList.push(d);}}else{a.subSectionList.push(d);}}};documentReader.prototype.readSubSection=function(b,d){var c=new docSubSection();var a=d.a.split(",");c.type=a[0];c.area.left=Number(a[1]);c.area.top=Number(a[2]);c.area.right=Number(a[3]);c.area.bottom=Number(a[4]);c.backgroundStyleKey=Number(a[5]);c.orderTop=Number(a[6]);this.readDocumentControl(b,c,d.b);c.isDrilling=d.c;if(c.isDrilling){c.isDrillingView=false;}c.drillingName=decodeURIComponent(d.d);if("null"==c.drillingName){c.drillingName="";}if(null!=d.e){c.sectionType=d.e;}if(null!=d.f&&""!=d.f){c.editEasyModeId=d.f;}if(null!=d.g){c.isEditEasyMode=d.g;}if(null!=d.h){c.sectionName=decodeURIComponent(d.h);}if(null!=d.i){c.isEditEasyModeVisible=d.i;}return c;};documentReader.prototype.readDocumentControl=function(a,d,f){var b=f[0].length;for(var c=0;c<b;c++){switch(f[0][c][0]){case mCR_DocumentControlType.Line:this.lineReaderFromJSON(a,d,f[0][c]);break;case mCR_DocumentControlType.Shape:this.shapeReaderFromJSON(a,d,f[0][c]);break;case mCR_DocumentControlType.Label:this.labelReaderFromJSON(a,d,f[0][c]);break;case mCR_DocumentControlType.Table:this.tableReaderFromJSON(a,d,f[0][c]);break;case mCR_DocumentControlType.Crosstab:this.crosstabReaderFromJSON(a,d,f[0][c]);break;case mCR_DocumentControlType.Barcode:this.barcodeReaderFromJSON(a,d,f[0][c]);break;case mCR_DocumentControlType.Chart:this.chartReaderFromJSON(a,d,f[0][c]);break;case mCR_DocumentControlType.SubReport:this.reportControlReaderFromJSON(a,d,f[0][c]);break;case mCR_DocumentControlType.VoiceEye:this.voiceEyeReaderFromJSON(a,d,f[0][c]);break;case mCR_DocumentControlType.MarkAnyVoiceEye:this.markAnyVoiceReaderFromJSON(a,d,f[0][c]);break;case mCR_DocumentControlType.VerifyBarcode:this.verifyBarcodeReaderFromJSON(a,d,f[0][c]);break;case mCR_DocumentControlType.VoiceBarcode:this.voiceBarcodeReaderFromJSON(a,d,f[0][c]);break;case mCR_DocumentControlType.Checkbox:this.checkboxReaderFromJSON(a,d,f[0][c]);break;case mCR_DocumentControlType.InputSign:this.inputSignReaderFromJSON(a,d,f[0][c]);break;case mCR_DocumentControlType.InputCheckbox:this.inputCheckboxReaderFromJSON(a,d,f[0][c]);break;case mCR_DocumentControlType.InputImage:this.inputImageReaderFromJSON(a,d,f[0][c]);break;case mCR_DocumentControlType.Input:this.inputboxReaderFromJSON(a,d,f[0][c]);break;case mCR_DocumentControlType.InputSelectBox:this.inputSelectboxReaderFromJSON(a,d,f[0][c]);break;case mCR_DocumentControlType.Calendar:this.inputCalendarReaderFromJSON(a,d,f[0][c]);break;case mCR_DocumentControlType.Button:this.inputButtonReaderFromJSON(a,d,f[0][c]);break;case mCR_DocumentControlType.Video:this.inputVideoReaderFromJSON(a,d,f[0][c]);break;}}};documentReader.prototype.inputButtonReaderFromJSON=function(b,f,g){var c=new docInputButton();c.subSection=f;var a=g[1].split(",");c.rect.left=parseInt(a[0]);c.rect.top=parseInt(a[1]);c.rect.right=parseInt(a[2]);c.rect.bottom=parseInt(a[3]);c.shapeStyleKey=parseInt(a[4]);c.backgroundStyleKey=parseInt(a[5]);c.outterlineStyleKey=parseInt(a[6]);c.visibleOptionStyleKey=parseInt(a[7]);c.visible=a[8]=="1";c.conditionVisible=a[9]=="1";c.pageCountConditionType=parseInt(a[10]);c.primaryName=decodeURIComponent(a[11]);this.textInfoReaderFromJSON(c.textInfo,g[2]);c.transparencyRate=g[3];var d=decodeURIComponent(g[4]);if(d.indexOf("@clipreport@")==0){d=null;}c.accessibilityString=d;f.controlPageList.push(c);};documentReader.prototype.inputVideoReaderFromJSON=function(b,f,g){var c=new docInputVideo();c.subSection=f;var a=g[1].split(",");c.rect.left=parseInt(a[0]);c.rect.top=parseInt(a[1]);c.rect.right=parseInt(a[2]);c.rect.bottom=parseInt(a[3]);c.shapeStyleKey=parseInt(a[4]);c.backgroundStyleKey=parseInt(a[5]);c.outterlineStyleKey=parseInt(a[6]);c.visibleOptionStyleKey=parseInt(a[7]);c.visible=a[8]=="1";c.conditionVisible=a[9]=="1";c.pageCountConditionType=parseInt(a[10]);c.primaryName=decodeURIComponent(a[11]);c.transparencyRate=g[2];var d=decodeURIComponent(g[3]);if(d.indexOf("@clipreport@")==0){d=null;}c.accessibilityString=d;f.controlPageList.push(c);};documentReader.prototype.inputCalendarReaderFromJSON=function(b,f,g){var c=new docInputCalendar();c.subSection=f;var a=g[1].split(",");c.rect.left=parseInt(a[0]);c.rect.top=parseInt(a[1]);c.rect.right=parseInt(a[2]);c.rect.bottom=parseInt(a[3]);c.shapeStyleKey=parseInt(a[4]);c.backgroundStyleKey=parseInt(a[5]);c.outterlineStyleKey=parseInt(a[6]);c.primaryName=decodeURIComponent(g[2]);var d=decodeURIComponent(g[3]);if(d.indexOf("@clipreport@")==0){d=null;}c.accessibilityString=d;c.transparencyRate=g[4];c.fontStyleKey=g[5];c.textMarginStyleKey=g[6];c.textOptionStyleKey=g[7];c.visibleOptionStyleKey=g[8];this.textInfoReaderFromJSON(c.textInfo,g[9]);f.controlPageList.push(c);};documentReader.prototype.inputSelectboxReaderFromJSON=function(b,f,g){var c=new docInputSelectbox();c.subSection=f;var a=g[1].split(",");c.rect.left=parseInt(a[0]);c.rect.top=parseInt(a[1]);c.rect.right=parseInt(a[2]);c.rect.bottom=parseInt(a[3]);c.shapeStyleKey=parseInt(a[4]);c.backgroundStyleKey=parseInt(a[5]);c.outterlineStyleKey=parseInt(a[6]);c.primaryName=decodeURIComponent(g[2]);var d=decodeURIComponent(g[3]);if(d.indexOf("@clipreport@")==0){d=null;}c.accessibilityString=d;c.transparencyRate=g[4];this.textInfoReaderFromJSON(c.textInfo,g[5]);f.controlPageList.push(c);};documentReader.prototype.inputboxReaderFromJSON=function(b,f,g){var c=new docInputbox();c.subSection=f;var a=g[1].split(",");c.rect.left=parseInt(a[0]);c.rect.top=parseInt(a[1]);c.rect.right=parseInt(a[2]);c.rect.bottom=parseInt(a[3]);c.shapeStyleKey=parseInt(a[4]);c.backgroundStyleKey=parseInt(a[5]);c.outterlineStyleKey=parseInt(a[6]);c.visibleOptionStyleKey=parseInt(a[7]);c.visible=a[8]=="1";c.conditionVisible=a[9]=="1";c.pageCountConditionType=parseInt(a[10]);c.primaryName=decodeURIComponent(a[11]);this.textInfoReaderFromJSON(c.textInfo,g[2]);c.transparencyRate=g[3];var d=decodeURIComponent(g[4]);if(d.indexOf("@clipreport@")==0){d=null;}c.accessibilityString=d;f.controlPageList.push(c);};documentReader.prototype.inputImageReaderFromJSON=function(b,d,g){var f=new docInputImage();f.subSection=d;var a=g[1].split(",");f.rect.left=parseInt(a[0]);f.rect.top=parseInt(a[1]);f.rect.right=parseInt(a[2]);f.rect.bottom=parseInt(a[3]);f.shapeStyleKey=parseInt(a[4]);f.backgroundStyleKey=parseInt(a[5]);f.outterlineStyleKey=parseInt(a[6]);f.visibleOptionStyleKey=parseInt(a[7]);f.visible=a[8]=="1";f.conditionVisible=a[9]=="1";f.pageCountConditionType=parseInt(a[10]);f.primaryName=decodeURIComponent(a[11]);f.transparencyRate=parseInt(a[12]);var c=decodeURIComponent(g[2]);if(c.indexOf("@clipreport@")==0){c=null;}f.accessibilityString=c;d.controlPageList.push(f);};documentReader.prototype.inputCheckboxReaderFromJSON=function(b,d,g){var f=new docInputCheckbox();f.subSection=d;var a=g[1].split(",");f.rect.left=parseInt(a[0]);f.rect.top=parseInt(a[1]);f.rect.right=parseInt(a[2]);f.rect.bottom=parseInt(a[3]);f.outterlineStyleKey=parseInt(a[4]);f.visibleOptionStyleKey=parseInt(a[5]);f.visible=a[6]=="1";f.conditionVisible=a[7]=="1";f.pageCountConditionType=parseInt(a[8]);f.checkSize=parseInt(a[9]);f.selectType=parseInt(a[10]);f.selectArea=parseInt(a[11]);f.primaryName=decodeURIComponent(a[12]);var c=decodeURIComponent(a[13]);if(c.indexOf("@clipreport@")==0){c=null;}f.accessibilityString=c;f.useText=a[14]=="true";f.shapeStyleKey=parseInt(a[15]);f.backgroundStyleKey=parseInt(a[16]);f.guideTransparency=parseInt(a[17]);if(a.length>18){f.checkedBorderLineStyleKey=parseInt(a[18]);}this.textInfoReaderFromJSON(f.textInfo,g[2]);if(g.length>3){f.guideInCheckBox=g[3];}if(g.length>4){f.checkboxLeftAlignment=g[4];}d.controlPageList.push(f);};documentReader.prototype.inputSignReaderFromJSON=function(b,g,h){var c=new docInputSign();c.subSection=g;var a=h[1].split(",");c.rect.left=parseInt(a[0]);c.rect.top=parseInt(a[1]);c.rect.right=parseInt(a[2]);c.rect.bottom=parseInt(a[3]);c.shapeStyleKey=parseInt(a[4]);c.backgroundStyleKey=parseInt(a[5]);c.outterlineStyleKey=parseInt(a[6]);c.visibleOptionStyleKey=parseInt(a[7]);c.penWidth=parseInt(a[8]);c.penColor=parseInt(a[9]);c.primaryName=decodeURIComponent(a[10]);var f=0;if(typeof h[2]!=="boolean"){f++;}c.isNecessaryCheck=h[(2+f)];c.necessaryName=decodeURIComponent(h[(3+f)]);c.guileLineColor=h[(4+f)];c.guileLineWidth=h[(5+f)];c.guileLineStyle=h[(6+f)];c.transparencyRate=h[(7+f)];c.horizontalAlignmentMethod=h[(8+f)];c.verticalAlignmentMethod=h[(9+f)];var d=decodeURIComponent(h[(10+f)]);if(d.indexOf("@clipreport@")==0){d=null;}c.accessibilityString=d;if(h.length>(11+f)){c.guideTextExport=h[(11+f)];}g.controlPageList.push(c);};documentReader.prototype.lineReaderFromJSON=function(b,d,f){var c=new docLine();c.subSection=d;var a=f[1].split(",");c.rect.left=parseInt(a[0]);c.rect.top=parseInt(a[1]);c.rect.right=parseInt(a[2]);c.rect.bottom=parseInt(a[3]);c.lineStyleKey=parseInt(a[4]);c.visibleOptionStyleKey=parseInt(a[5]);if(a[6]=="1"){c.visible=true;}else{c.visible=false;}if(a[7]=="1"){c.conditionVisible=true;}else{c.conditionVisible=false;}c.pageCountConditionType=parseInt(a[8]);d.controlPageList.push(c);};documentReader.prototype.shapeReaderFromJSON=function(b,d,f){var c=new docShape();c.subSection=d;var a=f[1].split(",");c.rect.left=parseInt(a[0]);c.rect.top=parseInt(a[1]);c.rect.right=parseInt(a[2]);c.rect.bottom=parseInt(a[3]);c.shapeStyleKey=parseInt(a[4]);c.backgroundStyleKey=parseInt(a[5]);c.outterlineStyleKey=parseInt(a[6]);c.visibleOptionStyleKey=parseInt(a[7]);if(a[8]=="1"){c.visible=true;}else{c.visible=false;}if(a[9]=="1"){c.conditionVisible=true;}else{c.conditionVisible=false;}c.pageCountConditionType=parseInt(a[10]);d.controlPageList.push(c);};documentReader.prototype.checkboxReaderFromJSON=function(a,b,d){var c=new docCheckbox();c.subSection=b;this.checkboxRead(c,a,d);b.controlPageList.push(c);};documentReader.prototype.checkboxRead=function(f,b,g){var a=g[1].split(",");f.rect.left=parseInt(a[0]);f.rect.top=parseInt(a[1]);f.rect.right=parseInt(a[2]);f.rect.bottom=parseInt(a[3]);f.shapeStyleKey=parseInt(a[4]);f.outterlineStyleKey=parseInt(a[5]);f.visibleOptionStyleKey=parseInt(a[6]);f.checkColor=parseInt(a[7]);f.checkValue=a[8]=="1"?true:false;f.checkType=parseInt(a[9]);if(null!=g[2]){a=g[2].split(",");f.imageRect.left=parseInt(a[0]);f.imageRect.top=parseInt(a[1]);f.imageRect.right=parseInt(a[2]);f.imageRect.bottom=parseInt(a[3]);}var d=decodeURIComponent(g[4]);if(d.indexOf("@clipreport@")==0){d=null;}f.accessibilityString=d;var c=g[3];if(c){f.editable=c;f.editableIndex=b.editableControlList.length;b.editableControlList.push(f);}};documentReader.prototype.barcodeReaderFromJSON=function(c,g,h){var d=new docBarcode();d.subSection=g;var b=h[1].split(",");d.rect.left=parseInt(b[0]);d.rect.top=parseInt(b[1]);d.rect.right=parseInt(b[2]);d.rect.bottom=parseInt(b[3]);d.shapeStyleKey=parseInt(b[4]);d.backgroundStyleKey=parseInt(b[5]);d.outterlineStyleKey=parseInt(b[6]);d.visibleOptionStyleKey=parseInt(b[7]);var a=decodeURI(b[9]);a=a.replace(/\%2C/g,",");d.text=a;d.showText=(b[10]=="1");d.optResolution=(b[11]=="1");d.fontBold=(b[12]=="1");d.wideRatio=Number(b[13]);d.fontSize=parseInt(b[14]);d.fontName=b[15];d.barcodeColor=parseInt(b[16]);d.barcodeAngle=parseInt(b[17]);d.barcodeSymbology=parseInt(b[18]);var f=decodeURIComponent(b[19]);if(f.indexOf("@clipreport@")==0){f=null;}d.accessibilityString=f;g.controlPageList.push(d);};documentReader.prototype.chartReaderFromJSON=function(b,f,g){var d=new docChart();d.subSection=f;var a=g[1].split(",");d.rect.left=parseInt(a[0]);d.rect.top=parseInt(a[1]);d.rect.right=parseInt(a[2]);d.rect.bottom=parseInt(a[3]);d.visibleOptionStyleKey=parseInt(a[4]);if(g[2]!=null){this.webLinkInfoReaderFromJSON(d,g[2]);}d.dataType=g[3];if(d.dataType=="svg"||d.dataType=="png"){d.svgString=decodeURI(g[4]);}else{if(d.dataType=="doc"){d.svgString=g[4];}}if(null!=g[5]){var c=decodeURIComponent(g[5]);if(c.indexOf("@clipreport@")==0){c=null;}d.accessibilityString=c;}f.controlPageList.push(d);};documentReader.prototype.voiceEyeReaderFromJSON=function(b,d,f){var c=new DocVoiceEye();c.subSection=d;var a=f[1].split(",");c.rect.left=parseInt(a[0]);c.rect.top=parseInt(a[1]);c.rect.right=parseInt(a[2]);c.rect.bottom=parseInt(a[3]);if(null!=a[4]){c.visibleOptionStyleKey=parseInt(a[4]);}c.svgString=decodeURI(f[2]);d.controlPageList.push(c);};documentReader.prototype.markAnyVoiceReaderFromJSON=function(b,d,f){var c=new DocMarkAnyVoice();c.subSection=d;var a=f[1].split(",");c.rect.left=parseInt(a[0]);c.rect.top=parseInt(a[1]);c.rect.right=parseInt(a[2]);c.rect.bottom=parseInt(a[3]);if(null!=a[4]){c.visibleOptionStyleKey=parseInt(a[4]);}c.svgString=decodeURI(f[2]);d.controlPageList.push(c);};documentReader.prototype.voiceBarcodeReaderFromJSON=function(c,d,f){var g=new DocVoiceBarcode();g.subSection=d;var b=f[1].split(",");g.rect.left=parseInt(b[0]);g.rect.top=parseInt(b[1]);g.rect.right=parseInt(b[2]);g.rect.bottom=parseInt(b[3]);if(null!=b[4]){g.visibleOptionStyleKey=parseInt(b[4]);}var a=decodeURI(f[2]);a=a.replace(/\%2C/g,",");g.data=a;g.position=f[3];switch(f.length){case 6:a=decodeURI(f[4]);a=a.replace(/\%2C/g,",");g.size=a;a=decodeURI(f[5]);a=a.replace(/\%2C/g,",");g.text=a;break;default:break;}d.controlPageList.push(g);};documentReader.prototype.verifyBarcodeReaderFromJSON=function(b,c,f){var d=new DocVerifyBarcode();d.subSection=c;var a=f[1].split(",");d.rect.left=parseInt(a[0]);d.rect.top=parseInt(a[1]);d.rect.right=parseInt(a[2]);d.rect.bottom=parseInt(a[3]);if(null!=a[4]){d.visibleOptionStyleKey=parseInt(a[4]);}d.text=decodeURI(f[3]);d.text=d.text.replace(/\%2C/g,",");c.controlPageList.push(d);};documentReader.prototype.reportControlReaderFromJSON=function(a,c,d){var b=new docReportControl();b.subSection=c;b.rect.left=d[1];b.rect.top=d[2];b.rect.right=d[3];b.rect.bottom=d[4];b.visibleOptionStyleKey=d[5];this.readReportControlSubSectionList(a,d[6],b);c.controlPageList.push(b);};documentReader.prototype.readReportControlSubSectionList=function(a,g,b){var f=g.length;for(var c=0;c<f;c++){var d=this.readReportControlSubSection(a,g[c],b);b.subSectionList.push(d);}};documentReader.prototype.readReportControlSubSection=function(a,d,b){var c=new docReportControlSubSection();c.type=d[0];c.area.left=d[1];c.area.top=d[2];c.area.right=d[3];c.area.bottom=d[4];c.backgroundStyleKey=d[5];c.docReportControl=b;this.readDocumentControl(a,c,d[6]);return c;};documentReader.prototype.crosstabReaderFromJSON=function(b,c,f){var d=new docCrosstab();d.subSection=c;var a=f[1].split(",");d.rect.left=parseInt(a[0]);d.rect.top=parseInt(a[1]);d.rect.right=parseInt(a[2]);d.rect.bottom=parseInt(a[3]);d.outterlineStyleKey=parseInt(a[4]);d.visibleOptionStyleKey=parseInt(a[5]);this.crosstabMatrixReaderToJSON(f[2],d.matrixHeader);this.crosstabMatrixReaderToJSON(f[3],d.matrixRow);this.crosstabMatrixReaderToJSON(f[4],d.matrixColumn);this.crosstabMatrixReaderToJSON(f[5],d.matrixSummarized);c.controlPageList.push(d);};documentReader.prototype.crosstabMatrixReaderToJSON=function(g,f){this.crosstabRowReaderToJSON(g[1],f);var d=g[2];var c=d[0];var b=d[1];for(var a=0;a<c.length;a++){f.rowHeightList.push(c[a]);}for(var a=0;a<b.length;a++){f.columnWidthList.push(b[a]);}};documentReader.prototype.crosstabRowReaderToJSON=function(f,g){var d=f.length;for(var a=0;a<d;a++){var c=f[a];var b=new docCrosstabRow(g);g.rowList.push(b);this.crosstabCellListReaderToJSON(c,g,b);}};documentReader.prototype.crosstabCellListReaderToJSON=function(d,i,c){var f=d.length;for(var g=0;g<f;g++){var m=d[g];var a=m[0];switch(a){case mCR_DocumentControlType.TableCell:var l=new docCrosstabCellNormal(c);this.crosstabCellReaderToJSON(m,l);c.addCrosstabCell(l);break;case mCR_DocumentControlType.TableCellDumy:var h=m[1];var k=m[2];var j=i.getCrosstabCellNormal(h,k);var b=new docCrosstabCellDumy();b.setBaseCell(j);c.addCrosstabCell(b);break;}}};documentReader.prototype.crosstabCellReaderToJSON=function(f,b){var a=f[1].split(",");var g=f[2];var h=f[3];var d=f[4];var c=decodeURIComponent(f[5]);if(c.indexOf("@clipreport@")==0){c=null;}b.backgroundStyleKey=parseInt(a[0]);b.rowSpan=parseInt(a[1]);b.colSpan=parseInt(a[2]);b.leftLineStyleKey=parseInt(a[3]);b.topLineStyleKey=parseInt(a[4]);b.rightLineStyleKey=parseInt(a[5]);b.bottomLineStyleKey=parseInt(a[6]);b.frontDiagonalLineStyleKey=parseInt(a[7]);b.backDiagonalLineStyleKey=parseInt(a[8]);if(g!=null){this.readImageInfoFromJSON(b.imageInfo,g);b.imageInfo.setParent(b);}if(h!=null){this.textInfoReaderFromJSON(b.detailTextInfo,h);}if(f[6]!=null){this.webLinkInfoReaderFromJSON(b,f[6]);}b.accessibilityString=c;};documentReader.prototype.tableReaderFromJSON=function(b,f,g){var d=new docTable();d.subSection=f;var a=g[1].split(",");d.rect.left=parseInt(a[0]);d.rect.top=parseInt(a[1]);d.rect.right=parseInt(a[2]);d.rect.bottom=parseInt(a[3]);d.outterlineStyleKey=parseInt(a[4]);d.visibleOptionStyleKey=parseInt(a[5]);d.roundLeftTop=parseInt(a[6]);d.roundRightTop=parseInt(a[7]);d.roundLeftBottom=parseInt(a[8]);d.roundRightBottom=parseInt(a[9]);if(a.length>=12){d.nextTableID=a[10];d.prevTableID=a[11];}if(a.length>=14){d.lineFDiagonaStyleKey=a[12];d.lineBDiagonaStyleKey=a[13];}if(a.length>=15){d.pageCountConditionType=a[14];}if(g.length>10){var c=decodeURIComponent(g[10]);if(c.indexOf("@clipreport@")==0){c=null;}d.accessibilityString=c;}this.tableRowReaderFromJSON(b,d,g[2]);this.tableRowolArrangerReaderFromJSON(d.rowColArranger,g[3]);f.controlPageList.push(d);};documentReader.prototype.tableRowolArrangerReaderFromJSON=function(h,g){var d=g[0];var c=g[1];for(var a=0;a<d.length;a++){var f=d[a];h.addRowHeight(f);}for(var a=0;a<c.length;a++){var b=c[a];h.addColumnWidth(b);}};documentReader.prototype.tableRowReaderFromJSON=function(a,s,g){var h=g.length;for(var l=0;l<h;l++){var o=g[l];var b=new docTableRow();s.addTableRow(b);var f=o.length;for(var d=0;d<f;d++){var m=o[d];if((typeof m)=="boolean"){b.setPageSubSection(m);}else{var k=m[0];switch(k){case mCR_DocumentControlType.TableCell:var r=new docTableCellNormal();this.tableCellReaderFromJSON(a,r,m);b.addTableCell(r);break;case mCR_DocumentControlType.TableCellDumy:var n=m[1];var q=m[2];var p=s.getTableCellNormal(Number(n),Number(q));var c=new docTableCellDumy();c.setBaseCell(p);b.addTableCell(c);break;}}}}};documentReader.prototype.tableCellReaderFromJSON=function(b,k,g){var h=g[1].split(",");var m=g[2];var i=g[3];var c=g[4];var d=g[5];var a=g[6];var j=decodeURIComponent(g[7]);if(j.indexOf("@clipreport@")==0){j=null;}k.backgroundStyleKey=parseInt(h[0]);k.rowSpan=parseInt(h[1]);k.colSpan=parseInt(h[2]);k.leftLineStyleKey=parseInt(h[3]);k.topLineStyleKey=parseInt(h[4]);k.rightLineStyleKey=parseInt(h[5]);k.bottomLineStyleKey=parseInt(h[6]);k.frontDiagonalLineStyleKey=parseInt(h[7]);k.backDiagonalLineStyleKey=parseInt(h[8]);if(h.length>=11){k.splitCellID1=h[9];k.splitCellID2=h[10];}if(m!=null){this.readImageInfoFromJSON(k.imageInfo,m);k.imageInfo.setParent(k);}if(i!=null){this.textInfoReaderFromJSON(k.detailTextInfo,i);}k.isCheckbox=(c==1)?true:false;if(k.isCheckbox){var f=new docCheckbox();this.checkboxRead(f,b,d);k.documentCheckbox=f;}k.name=a;k.accessibilityString=j;if(g[8]!=null){this.webLinkInfoReaderFromJSON(k,g[8]);}var l=g[9];if(l){k.editable=l;k.editableIndex=b.editableControlList.length;b.editableControlList.push(k);}};documentReader.prototype.labelReaderFromJSON=function(b,g,h){var f=new docLabel();f.subSection=g;var a=h[1].split(",");f.rect.left=parseInt(a[0]);f.rect.top=parseInt(a[1]);f.rect.right=parseInt(a[2]);f.rect.bottom=parseInt(a[3]);f.shapeStyleKey=parseInt(a[4]);f.backgroundStyleKey=parseInt(a[5]);f.outterlineStyleKey=parseInt(a[6]);f.visibleOptionStyleKey=parseInt(a[7]);if(a.length>8){f.visible=(a[8]==1)?true:false;f.conditionVisible=(a[9]==1)?true:false;f.pageCountConditionType=parseInt(a[10]);}if(h[2]!=null){this.readImageInfoFromJSON(f.imageInfo,h[2]);f.imageInfo.setParent(f);}this.textInfoReaderFromJSON(f.textInfo,h[3]);this.webLinkInfoReaderFromJSON(f,h[4]);var d=decodeURIComponent(h[5]);if(d.indexOf("@clipreport@")==0){d=null;}f.accessibilityString=d;var c=h[6];if(c){f.editable=c;f.editableIndex=b.editableControlList.length;b.editableControlList.push(f);}g.controlPageList.push(f);};documentReader.prototype.webLinkInfoReaderFromJSON=function(d,c){var a=c.a.split(",");var b=a[0];var f=d.webLinkInfo;f.type=b;if(b==mCR_LinkType.Web){f.linkUrl=decodeURI(a[1]);}else{f.linkUrl=a[1];}f.webLinkType=decodeURI(a[2]);f.frameName=decodeURIComponent(a[3]);f.windowWidth=parseInt(a[4]);f.windowHeight=parseInt(a[5]);};documentReader.prototype.textInfoReaderFromJSON=function(d,f){if(f.length==0){return;}else{var c=f[0];var b=d;if(typeof c=="string"){var a=c.split(",");b.isPageCount=(a[0]==1)?true:false;b.isTotalPageCount=(a[1]==1)?true:false;b.useMultiLanguage=(a[2]==1)?true:false;b.pageFormula=(a[3]==1)?true:false;this.textLineReaderFromJSON(b,b.useMultiLanguage,f[1]);if(f[2]!=null){this.originalTextInfoReaderFromJSON(b,f[2]);}if(f[3]!=null){b.scriptString=decodeURIComponent(f[3]);}}else{this.textLineReaderDRMFromJSON(b,f[1]);}}};documentReader.prototype.textLineReaderFromJSON=function(d,c,j){var h=j.length;for(var g=0;g<h;g++){var f=new docTextLine();var b=this.textCharacterBatchReaderFromJSON(f,j[g][0]);if((c||this.useMultiLanguage)&&typeof j[g][4]!="undefined"){b=j[g][4];}var a=j[g][1].split(",");f.yPosition=parseInt(a[0]);f.text=decodeURIComponent(b);f.height=parseInt(a[1]);f.eraseSpaceCount=parseInt(a[2]);this.textShapeReaderFromJSON(f,j[g][2]);f.continuesLine=(parseFloat(j[g][3])==1)?true:false;d.textLineList.push(f);}};documentReader.prototype.textLineReaderDRMFromJSON=function(b,g){var f=g.length;for(var d=0;d<f;d++){var c=new docTextLine();c.xPosition=g[0];c.yPosition=g[1];c.height=g[2];var a=g[3];if(a!=null){c.text=decodeURIComponent(a);}b.textLineList.push(c);}};documentReader.prototype.textCharacterBatchReaderFromJSON=function(b,r){var c=r.length;var h="";for(var l=0;l<c;l++){var s="";var o=r[l][0].split(",");var n=b.characterBatchList.length;var q=null;if(n==0){q=new docTextCharacterBatch();q.fontStyleKey=parseInt(o[0]);q.smallChar=(o[1]==1)?true:false;q.sup=(o[2]==1)?true:false;q.sub=(o[3]==1)?true:false;var g=0;if(o.length>=5){g=parseInt(o[4]);}q.charMode=g;b.characterBatchList.push(q);}else{var m=b.characterBatchList[n-1];var g=0;if(o.length>=5){g=parseInt(o[4]);}if((m.fontStyleKey==o[0])&&(m.smallChar==(o[1]==1)?true:false)&&(m.sup==(o[2]==1)?true:false)&&(m.sub==(o[3]==1)?true:false)&&(m.charMode==g?true:false)){q=m;}else{q=new docTextCharacterBatch();q.fontStyleKey=parseInt(o[0]);q.smallChar=(o[1]==1)?true:false;q.sup=(o[2]==1)?true:false;q.sub=(o[3]==1)?true:false;q.charMode=g;b.characterBatchList.push(q);}}var a=r[l][1][0].length;var d=r[l][1][0];var f=r[l][1][1];for(var k=0;k<a;k++){var p=new docTextCharacter();p.character=decodeURIComponent(d[k]);p.xPosition=parseInt(f[k]);q.characterList.push(p);s+=d[k];}if(s==""){s="%09";}h+=s;}return h;};documentReader.prototype.textShapeReaderFromJSON=function(c,f){var g=f.length;for(var b=0;b<g;b++){var a=f[b].a.split(",");var d=new docTextShape();d.rect.set(parseInt(a[0]),parseInt(a[1]),parseInt(a[2]),parseInt(a[3]));d.shapeType=parseInt(a[4]);d.lineStyleKey=parseInt(a[5]);c.textShapeList.push(d);}};documentReader.prototype.originalTextInfoReaderFromJSON=function(b,h){var f=b.getOriginalTextInfo();var a=h.a.split(",");f.text=decodeURIComponent(a[0]);f.originalText=decodeURIComponent(a[1]);f.fontStyleKey=parseInt(a[2]);f.textOptionStyleKey=parseInt(a[3]);f.textMarginStyleKey=parseInt(a[4]);f.textTagStyleKey=parseInt(a[5]);f.originalFontSize=parseInt(a[6]);f.post=(parseInt(a[7])==1?true:false);if(a.length>8){f.textRotation=parseInt(a[8]);}if(a.length>9){f.charDirection=parseInt(a[9]);}if(a.length>10){f.charMode=parseInt(a[10]);}f.nameList=this.decodeArrayReaderFromJSON(h.b);var c=null;var g=h.c.length;if(g>0){c=new Array();for(var d=0;d<g;d++){c.push(this.decodeArrayReaderFromJSON(h.c[d]));}}f.result=c;};documentReader.prototype.decodeArrayReaderFromJSON=function(b){var a=null;var d=b.length;if(d>0){a=new Array();for(var c=0;c<b;c++){a.push(decodeURI(b[c]));}}return a;};documentReader.prototype.readImageList=function(a,b){var d=b.length;for(var c=0;c<d;c++){var f=new docImageData();f.dpiX=b[c].b;f.dpiY=b[c].c;f.imageWidth=b[c].f;f.imageHeight=b[c].g;f.filePath=b[c].a;f.formatType=b[c].d;f.isFieldData=b[c].h;this.addNewImageKey(a.imageList,f);}};documentReader.prototype.addNewImageKey=function(a,c){var b=a.length;a.push(c);return b;};documentReader.prototype.readImageInfoFromJSON=function(c,d){var b=d.a.split(",");var a=c;a.imageFilePath=decodeURI(b[0]);a.imageFormatType=this.returnImageFormatType(b[1]);a.backgroundImageStyleKey=b[2];a.imageDataKey=b[3];if(b.length>=6){a.startPosition=b[4];a.endPosition=b[5];}if(b.length>=7){a.margine=b[6];}};documentReader.prototype.returnImageFormatType=function(a){if(a==0){return"None";}else{if(a==1){return"BMP";}else{if(a==2){return"JPG";}else{if(a==3){return"PNG";}else{if(a==4){return"GIF";}}}}}};function docDocument(){this.version="";this.title="";this.subject="";this.author="";this.keyword="";this.etc="";this.styleManager=null;this.checkedPageCount=null;this.checkedTotalPageCount=null;this.xPositionList=null;this.useMultiLanguage=null;this.documentPageList=new Array();this.reportServerPath="";this.reportKey="";this.documentMemo={};this.documentReportInfoList=new Array();this.filePageCountList=[];}docDocument.prototype.getPageInStyle=function(a){return this.getPageStyle(a.pageStyleKey);};docDocument.prototype.getUseMultiLanguage=function(){return this.useMultiLanguage;};docDocument.prototype.getBackgroundImageStyle=function(a){var b=this.styleManager.backgroundImageList;if(a<b.length){return b[a];}else{return null;}};docDocument.prototype.getBackgroundStyle=function(b){var a=this.styleManager.backgroundList;if(b<a.length){return a[b];}else{return null;}};docDocument.prototype.getLineStyle=function(b){var a=this.styleManager.lineList;if(b<a.length){return a[b];}else{return null;}};docDocument.prototype.getShapeStyle=function(b){var a=this.styleManager.shapeList;if(b<a.length){return a[b];}else{return null;}};docDocument.prototype.getVisibleOptionStyle=function(a){var b=this.styleManager.visibleOptionList;if(a<b.length){return b[a];}else{return null;}};docDocument.prototype.getFontStyle=function(b){var a=this.styleManager.fontList;if(b<a.length){return a[b];}else{return null;}};docDocument.prototype.getPageStyle=function(a){var b=this.styleManager.pageList;if(a<b.length){return b[a];}else{return null;}};docDocument.prototype.getTextOptionStyle=function(b){var a=this.styleManager.textOptionList;if(b<a.length){return a[b];}else{return null;}};docDocument.prototype.getTextTagStyle=function(a){var b=this.styleManager.textTagList;if(a<b.length){return b[a];}else{return null;}};docDocument.prototype.getTextMarginStyle=function(b){var a=this.styleManager.textMarginList;if(b<a.length){return a[b];}else{return null;}};docDocument.prototype.getFontNameStyle=function(b){var a=this.styleManager.fontNameList;if(b<a.length){return a[b];}else{return null;}};docDocument.prototype.getPageListLength=function(){if(null!=this.documentPageList){return this.documentPageList.length;}return 0;};docDocument.prototype.addPage=function(a){this.documentPageList.push(a);};docDocument.prototype.removeAllPage=function(){this.documentPageList=new Array();};docDocument.prototype.getFilePageCountList=function(){return this.filePageCountList;};function documentPage(){this.pageStyleKey=null;this.pageIndex=null;this.imageList=new Array();this.subSectionList=new Array();this.editableControlList=new Array();this.backGround=null;this.foreGround=null;this.width=0;this.height=0;}documentPage.prototype.getWidth=function(){return this.width;};documentPage.prototype.getHeight=function(){return this.height;};documentPage.prototype.getImageData=function(a){if(a<this.imageList.length){return this.imageList[a];}else{return null;}};function docRect(){this.left=0;this.right=0;this.top=0;this.bottom=0;}docRect.prototype.addRect=function(d,c,b,a){this.left+=d;this.top+=c;this.right+=b;this.bottom+=a;return this;};docRect.prototype.set=function(b,d,c,a){this.left=b;this.top=d;this.right=b+c;this.bottom=d+a;};docRect.prototype.setLeft=function(a){this.left=a;};docRect.prototype.setRight=function(a){this.right=a;};docRect.prototype.setTop=function(a){this.top=a;};docRect.prototype.setBottom=function(a){this.bottom=a;};docRect.prototype.offsetRect=function(a,b){this.left+=a;this.right+=a;this.top+=b;this.bottom+=b;};docRect.prototype.getWidth=function(){return this.right-this.left;};docRect.prototype.setWidth=function(a){this.right=this.left+a;};docRect.prototype.getHeight=function(){return this.bottom-this.top;};docRect.prototype.setHeight=function(a){this.bottom=this.top+a;};docRect.prototype.getLeft=function(){return this.left;};docRect.prototype.getRight=function(){return this.right;};docRect.prototype.getTop=function(){return this.top;};docRect.prototype.getBottom=function(){return this.bottom;};docRect.prototype.copyRect=function(a){this.left=a.left;this.right=a.right;this.top=a.top;this.bottom=a.bottom;};docRect.prototype.newRateRect=function(b){var a=new docRect();a.left=this.left*b;a.right=this.right*b;a.top=this.top*b;a.bottom=this.bottom*b;return a;};docRect.prototype.toString=function(){return this.left+","+this.right+","+this.top+","+this.bottom;};function docImageData(){this.dpiX=0;this.dpiY=0;this.imageWidth=0;this.imageHeight=0;this.filePath="";this.formatType="";this.isFieldData=false;}function docSubSection(){this.type=null;this.area=new docRect();this.backgroundStyleKey=null;this.orderTop=null;this.controlPageList=new Array();this.pageMarginRect=null;this.drillingName="";this.isDrilling=false;this.isDrillingView=true;this.sectionType=-1;this.editEasyModeId="noName1";this.isEditEasyMode=false;this.sectionName="";this.isEditEasyModeVisible=true;}docSubSection.prototype.getLeftInPage=function(){if(null==this.pageMarginRect){this.pageMarginRect=new docRect();this.pageMarginRect.copyRect(this.area);}return this.pageMarginRect.left;};docSubSection.prototype.getTopInPage=function(){if(null==this.pageMarginRect){this.pageMarginRect=new docRect();this.pageMarginRect.copyRect(this.area);}return this.pageMarginRect.top;};docSubSection.prototype.offsetRect=function(b,a){if(null==this.pageMarginRect){this.pageMarginRect=new docRect();this.pageMarginRect.copyRect(this.area);}else{this.pageMarginRect.copyRect(this.area);}this.pageMarginRect.offsetRect(b,a);return this.pageMarginRect;};function docLine(){this.type=mCR_DocumentControlType.Line;this.subSection=null;this.rect=new docRect();this.lineStyleKey=null;this.visibleOptionStyleKey=-1;this.visible=true;this.conditionVisible=true;this.pageCountConditionType=-1;}docLine.prototype.getRectInPage=function(){var a=new docRect();a.copyRect(this.rect);if(this.subSection!=null){a.offsetRect(this.subSection.getLeftInPage(),this.subSection.getTopInPage());}return a;};function docShape(){this.type=mCR_DocumentControlType.Shape;this.subSection=null;this.rect=new docRect();this.shapeStyleKey=null;this.backgroundStyleKey=null;this.outterlineStyleKey=null;this.visibleOptionStyleKey=-1;this.visible=true;this.conditionVisible=true;this.pageCountConditionType=-1;}docShape.prototype.getRectInPage=function(){var a=new docRect();a.copyRect(this.rect);if(this.subSection!=null){a.offsetRect(this.subSection.getLeftInPage(),this.subSection.getTopInPage());}return a;};function docBarcode(){this.type=mCR_DocumentControlType.Barcode;this.subSection=null;this.rect=new docRect();this.shapeStyleKey=null;this.backgroundStyleKey=null;this.outterlineStyleKey=null;this.svgString=null;this.visibleOptionStyleKey=-1;this.visible=true;this.conditionVisible=true;this.pageCountConditionType=-1;this.text="";this.barcodeSymbology=1;this.barcodeColor=0;this.barcodeAngle=0;this.showText=false;this.fontName="나눔고딕";this.fontSize=10;this.fontBold=false;this.optResolution=false;this.wideRatio=3;this.accessibilityString="";}docBarcode.prototype.getRectInPage=function(){var a=new docRect();a.copyRect(this.rect);if(this.subSection!=null){a.offsetRect(this.subSection.getLeftInPage(),this.subSection.getTopInPage());}return a;};function docChart(){this.type=mCR_DocumentControlType.Chart;this.subSection=null;this.rect=new docRect();this.visibleOptionStyleKey=-1;this.svgString=null;this.webLinkInfo=new docWebLinkInfo();this.visible=true;this.conditionVisible=true;this.pageCountConditionType=-1;this.dataType="";}docChart.prototype.getRectInPage=function(){var a=new docRect();a.copyRect(this.rect);if(this.subSection!=null){a.offsetRect(this.subSection.getLeftInPage(),this.subSection.getTopInPage());}return a;};function docCheckbox(){this.type=mCR_DocumentControlType.Checkbox;this.subSection=null;this.rect=new docRect();this.shapeStyleKey=null;this.outterlineStyleKey=null;this.visibleOptionStyleKey=-1;this.checkColor=null;this.checkValue=null;this.checkType=null;this.imageRect=new docRect();this.visible=true;this.conditionVisible=true;this.pageCountConditionType=-1;this.accessibilityString="";}docCheckbox.prototype.getRectInPage=function(){var a=new docRect();a.copyRect(this.rect);if(this.subSection!=null){a.offsetRect(this.subSection.getLeftInPage(),this.subSection.getTopInPage());}return a;};function checkboxRevisePosition(d){var b=new docRect();b.copyRect(d);var c=b.getWidth();var a=b.getHeight();var f=0;if(c>a){b.left=b.left+((c-a)/2);b.right=b.left+a;f=a/5;}else{b.top=b.top+((a-c)/2);b.bottom=b.top+c;f=c/5;}b.left+=f;b.top+=f;b.right-=f;b.bottom-=f;return b;}function docTable(){this.type=mCR_DocumentControlType.Table;this.outterlineStyleKey=null;this.accessibilityString=null;this.accessibilityDirectionType=null;this.roundLeftTop=0;this.roundRightTop=0;this.roundLeftBottom=0;this.roundRightBottom=0;this.table=new Array();this.rowColArranger=new rowColArranger();this.tableAutoMerge=null;this.tableSectionExpand=null;this.tableKeepTogether=null;this.tableAutoMergeSide=null;this.mergedTableForExport=null;this.cellMergeOrder=null;this.prevTableID=null;this.nextTableID=null;this.tableUseSplitLine=null;this.lineSplitStyleKey=null;this.lineFDiagonaStyleKey=null;this.lineBDiagonaStyleKey=null;this.pageCountConditionType=null;this.rect=new docRect();this.visibleOptionStyleKey=-1;}docTable.prototype.getRectInPage=function(){var a=new docRect();a.copyRect(this.rect);if(this.subSection!=null){a.offsetRect(this.subSection.getLeftInPage(),this.subSection.getTopInPage());}return a;};docTable.prototype.getCellRectInPage=function(a,c,b){return this.getCellRect(a,c,b);};docTable.prototype.getCellRect=function(k,h,j){var b=0;var i=0;var a=0;var l=0;var d=k.getColSpan();var f=k.getRowSpan();for(var c=0;c<j;c++){b+=this.rowColArranger.getColumnWidth(c);}for(var c=0;c<h;c++){i+=this.rowColArranger.getRowHeight(c);}for(var c=j;c<(j+d);c++){a+=this.rowColArranger.getColumnWidth(c);}for(var c=h;c<(h+f);c++){l+=this.rowColArranger.getRowHeight(c);}var g=new docRect();g.set(b,i,a,l);return g;};docTable.prototype.addTableRow=function(a){a.setTable(this);this.table.push(a);};docTable.prototype.getRowCount=function(){return this.table.length;};docTable.prototype.getRowIndex=function(a){return this.table.indexOf(a);};docTable.prototype.getColumnCount=function(){if(this.table.length==0){return 0;}if(this.table[0]!=null){return this.table[0].getColumnCount();}else{return 0;}};docTable.prototype.getTableCellNormal=function(d,a){var c=null;if(d>=0&&a>=0&&d<this.getRowCount()&&a<this.getColumnCount()){var b=this.table[d].getTableCell(a);if(b!=null&&b.getType()==mCR_DocumentControlType.TableCell){c=b;}}return c;};function docTableRow(){this.table=null;this.parentSubSection=null;this.cellList=new Array();this.pageSubSection=false;}docTableRow.prototype.getTableCell=function(a){if(this.getColumnCount()>a){return this.cellList[a];}return null;};docTableRow.prototype.getColumnCount=function(){return this.cellList.length;};docTableRow.prototype.setTable=function(a){this.table=a;};docTableRow.prototype.setPageSubSection=function(a){this.pageSubSection=a;};docTableRow.prototype.addTableCell=function(a){if(a.getType()==mCR_DocumentControlType.TableCell){a.setTableRow(this);}this.cellList.push(a);};docTableRow.prototype.getColIndex=function(a){return this.cellList.indexOf(a);};docTableRow.prototype.getRowIndex=function(){return this.table.getRowIndex(this);};docTableRow.prototype.getCellRectInPage=function(a,b){return this.table.getCellRectInPage(a,this.getRowIndex(),b);};function docTableCellNormal(){this.tableRow=null;this.backgroundStyleKey=-1;this.leftLineStyleKey=-1;this.topLineStyleKey=-1;this.rightLineStyleKey=-1;this.bottomLineStyleKey=-1;this.imageInfo=new docImageInfo();this.detailTextInfo=new docTextInfo();this.isCheckbox=false;this.documentCheckbox=null;this.cellMergeInfo=null;this.webLinkInfo=new docWebLinkInfo();this.canGrow=false;this.editableIndex=-1;this.splitCellCopyText=false;this.spliterSetText=true;this.splitCellID1="";this.splitCellID2="";this.name=null;this.rowSpan=null;this.colSpan=null;this.frontDiagonalLineStyleKey=-1;this.backDiagonalLineStyleKey=-1;this.accessibilityString=null;this.tableRow=null;this.editable=null;}docTableCellNormal.prototype.getType=function(){return 4;};docTableCellNormal.prototype.setTableRow=function(a){this.tableRow=a;};docTableCellNormal.prototype.getRectInPage=function(){return this.tableRow.getCellRectInPage(this,this.getColIndex());};docTableCellNormal.prototype.getColIndex=function(){return this.tableRow.getColIndex(this);};docTableCellNormal.prototype.getColSpan=function(){return this.colSpan;};docTableCellNormal.prototype.getRowSpan=function(){return this.rowSpan;};docTableCellNormal.prototype.setTextInfo=function(a){this.detailTextInfo=a;};function docTableCellDumy(){this.baseCell=null;}docTableCellDumy.prototype.setBaseCell=function(a){this.baseCell=a;};docTableCellDumy.prototype.getType=function(){return 5;};function rowColArranger(){this.rowHeightList=new Array();this.columnWidthList=new Array();}rowColArranger.prototype.addRowHeight=function(a){this.rowHeightList.push(a);};rowColArranger.prototype.addColumnWidth=function(a){this.columnWidthList.push(a);};rowColArranger.prototype.getRowHeight=function(a){return this.rowHeightList[a];};rowColArranger.prototype.getColumnWidth=function(a){return this.columnWidthList[a];};function docCellInfo(a){this.dumy=a;this.leftLineStyleKey=-1;this.topLineStyleKey=-1;this.rightLineStyleKey=-1;this.bottomLineStyleKey=-1;this.isLeftLast=false;this.isTopLast=false;this.rowSpan=1;this.colSpan=1;}function docCellMap(){this.cellMap=new Array();this.leftTopCell=null;this.rightTopCell=null;this.leftBottomCell=null;this.rightBottomCell=null;}function docCrosstab(){this.type=mCR_DocumentControlType.Crosstab;this.subSection=null;this.rect=new docRect();this.outterlineStyleKey=null;this.accessibilityString=null;this.visibleOptionStyleKey=-1;this.headerRowHeightList=new Array();this.headerColumnWidthList=new Array();this.rowRowHeightList=new Array();this.columnColumnWidthList=new Array();this.matrixHeader=new docCrosstabMatrix(this,mCR_DocumentControlType.CrosstabMatrixHeader,this.headerRowHeightList,this.headerColumnWidthList);this.matrixRow=new docCrosstabMatrix(this,mCR_DocumentControlType.CrosstabMatrixRowLabel,this.rowRowHeightList,this.headerColumnWidthList);this.matrixColumn=new docCrosstabMatrix(this,mCR_DocumentControlType.CrosstabMatrixColumnLabel,this.headerRowHeightList,this.columnColumnWidthList);this.matrixSummarized=new docCrosstabMatrix(this,mCR_DocumentControlType.CrosstabMatrixSummarized,this.rowRowHeightList,this.columnColumnWidthList);}docCrosstab.prototype.getRectInPage=function(){var a=new docRect();a.copyRect(this.rect);if(this.subSection!=null){a.offsetRect(this.subSection.getLeftInPage(),this.subSection.getTopInPage());}return a;};docCrosstab.prototype.getMatrixX=function(){var a=0;var c=this.matrixRow.getColumnCount();for(var b=0;b<c;b++){a+=this.matrixRow.getColumnWidth(b);}return a;};docCrosstab.prototype.getMatrixY=function(){var c=0;var b=this.matrixColumn.getRowCount();for(var a=0;a<b;a++){c+=this.matrixColumn.getRowHeight(a);}return c;};function docCrosstabMatrix(c,d,b,a){this.crosstab=c;this.type=d;this.rowHeightList=b;this.columnWidthList=a;this.rowList=new Array();}docCrosstabMatrix.prototype.getCrosstabCellNormal=function(d,b){var a=null;if(d>=0&&b>=0&&d<this.getRowCount()&&b<this.getColumnCount()){var c=this.rowList[d].getCrosstabCell(b);if(c.getType()==mCR_DocumentControlType.TableCell){a=c;}else{a=c.getBaseCell();}}return a;};docCrosstabMatrix.prototype.getCrosstabBaseCell=function(b,a){if(b>=0&&a>=0&&b<this.getRowCount()&&a<this.getColumnCount()){return this.rowList[b].getCrosstabCell(a);}return null;};docCrosstabMatrix.prototype.getRowCount=function(){return this.rowList.length;};docCrosstabMatrix.prototype.getColumnCount=function(){if(this.rowList.length==0){return 0;}if(this.rowList[0]!=null){return this.rowList[0].getColumnCount();}else{return 0;}};docCrosstabMatrix.prototype.getColumnWidth=function(a){return this.columnWidthList[a];};docCrosstabMatrix.prototype.getRowIndex=function(a){return this.rowList.indexOf(a);};docCrosstabMatrix.prototype.getCellRectInPage=function(a,f,b){var c=this.getCellRect(a);var d=this.crosstab;if(this.crosstab!=null){c.offsetRect(d.rect.left,d.rect.top);if(d.subSection!=null){c.offsetRect(d.subSection.getLeftInPage(),d.subSection.getTopInPage());}}return c;};docCrosstabMatrix.prototype.getCellRect=function(l){var b=this.getX();var i=this.getY();var a=0;var k=0;var h=l.getRowIndex();var j=l.getColIndex();var f=l.getColSpan();var g=l.getRowSpan();for(var d=0;d<j;d++){b+=this.getColumnWidth(d);}for(var d=0;d<h;d++){i+=this.getRowHeight(d);}for(var d=j;d<(j+f);d++){a+=this.getColumnWidth(d);}for(var d=h;d<(h+g);d++){k+=this.getRowHeight(d);}var c=new docRect();c.left=b;c.top=i;c.right=b+a;c.bottom=i+k;return c;};docCrosstabMatrix.prototype.getRowHeight=function(a){return this.rowHeightList[a];};docCrosstabMatrix.prototype.getX=function(){var a=0;switch(this.type){case mCR_DocumentControlType.CrosstabMatrixHeader:case mCR_DocumentControlType.CrosstabMatrixRowLabel:break;case mCR_DocumentControlType.CrosstabMatrixColumnLabel:case mCR_DocumentControlType.CrosstabMatrixSummarized:a=this.crosstab.getMatrixX();break;}return a;};docCrosstabMatrix.prototype.getY=function(){var a=0;switch(this.type){case mCR_DocumentControlType.CrosstabMatrixHeader:case mCR_DocumentControlType.CrosstabMatrixColumnLabel:break;case mCR_DocumentControlType.CrosstabMatrixRowLabel:case mCR_DocumentControlType.CrosstabMatrixSummarized:a=this.crosstab.getMatrixY();break;}return a;};function docCrosstabRow(a){this.matrix=a;this.cellList=new Array();}docCrosstabRow.prototype.getColumnCount=function(){return this.cellList.length;};docCrosstabRow.prototype.getCrosstabCell=function(a){if(this.getColumnCount()>a){return this.cellList[a];}return null;};docCrosstabRow.prototype.addCrosstabCell=function(a){if(a.getType()==mCR_DocumentControlType.TableCell){a.setTableRow(this);}this.cellList.push(a);};docCrosstabRow.prototype.getCellRectInPage=function(a){var c=this.getRowIndex();var b=this.getColIndex(a);return this.matrix.getCellRectInPage(a,c,b);};docCrosstabRow.prototype.getRowIndex=function(){return this.matrix.getRowIndex(this);};docCrosstabRow.prototype.getColIndex=function(a){return this.cellList.indexOf(a);};docCrosstabRow.prototype.getColumnCount=function(){return this.cellList.length;};function docCrosstabCellDumy(){this.baseCell=null;}docCrosstabCellDumy.prototype.setBaseCell=function(a){this.baseCell=a;};docCrosstabCellDumy.prototype.getType=function(){return mCR_DocumentControlType.TableCellDumy;};function docCrosstabCellNormal(a){this.crosstabRow=a;this.backgroundStyleKey=-1;this.leftLineStyleKey=-1;this.topLineStyleKey=-1;this.rightLineStyleKey=-1;this.bottomLineStyleKey=-1;this.imageInfo=new docImageInfo();this.detailTextInfo=new docTextInfo();this.webLinkInfo=new docWebLinkInfo();this.canGrow=false;this.name=null;this.rowSpan=null;this.colSpan=null;this.frontDiagonalLineStyleKey=null;this.backDiagonalLineStyleKey=null;this.accessibilityString=null;this.cellMergeRowDataDuplication=false;this.cellMergeColumnDataDuplication=false;this.cellMergeRowReferenceText="";this.cellMergeColumnReferenceText="";}docCrosstabCellNormal.prototype.getType=function(){return mCR_DocumentControlType.TableCell;};docCrosstabCellNormal.prototype.setTableRow=function(a){this.crosstabRow=a;};docCrosstabCellNormal.prototype.getRectInPage=function(){return this.crosstabRow.getCellRectInPage(this);};docCrosstabCellNormal.prototype.getRowSpan=function(){return this.rowSpan;};docCrosstabCellNormal.prototype.getColSpan=function(){return this.colSpan;};docCrosstabCellNormal.prototype.getRowIndex=function(){return this.crosstabRow.getRowIndex();};docCrosstabCellNormal.prototype.getColIndex=function(){return this.crosstabRow.getColIndex(this);};docCrosstabCellNormal.prototype.setTextInfo=function(a){this.detailTextInfo=a;};function docReportControl(){this.type=mCR_DocumentControlType.SubReport;this.subSection=null;this.rect=new docRect();this.visibleOptionStyleKey=-1;this.visible=true;this.conditionVisible=true;this.pageCountConditionType=-1;this.subSectionList=new Array();}docReportControl.prototype.getRectInPage=function(){var a=new docRect();a.copyRect(this.rect);if(this.subSection!=null){a.offsetRect(this.subSection.getLeftInPage(),this.subSection.getTopInPage());}return a;};function docReportControlSubSection(){this.type=null;this.area=new docRect();this.backgroundStyleKey=null;this.orderTop=null;this.controlPageList=new Array();this.docReportControl=null;}docReportControlSubSection.prototype.getLeftInPage=function(){return this.docReportControl.getRectInPage().left+this.area.left;};docReportControlSubSection.prototype.getTopInPage=function(){return this.docReportControl.getRectInPage().top+this.area.top;};docReportControlSubSection.prototype.getRectInPage=function(){var a=new docRect();a.copyRect(this.area);if(this.docReportControl!=null){a.offsetRect(this.docReportControl.getRectInPage().left,this.docReportControl.getRectInPage().top);}return a;};function DocMarkAnyVoice(){this.type=mCR_DocumentControlType.MarkAnyVoiceEye;this.subSection=null;this.rect=new docRect();this.visibleOptionStyleKey=-1;this.svgString=null;this.visible=true;this.conditionVisible=true;this.pageCountConditionType=-1;}DocMarkAnyVoice.prototype.getRectInPage=function(){var a=new docRect();a.copyRect(this.rect);if(this.subSection!=null){a.offsetRect(this.subSection.getLeftInPage(),this.subSection.getTopInPage());}return a;};function DocVerifyBarcode(){this.type=mCR_DocumentControlType.VerifyBarcode;this.subSection=null;this.rect=new docRect();this.visibleOptionStyleKey=-1;this.text="";this.visible=true;this.conditionVisible=true;this.pageCountConditionType=-1;}DocVerifyBarcode.prototype.getRectInPage=function(){var a=new docRect();a.copyRect(this.rect);if(this.subSection!=null){a.offsetRect(this.subSection.getLeftInPage(),this.subSection.getTopInPage());}return a;};function DocVoiceEye(){this.type=mCR_DocumentControlType.VoiceEye;this.subSection=null;this.rect=new docRect();this.visibleOptionStyleKey=-1;this.svgString=null;this.visible=true;this.conditionVisible=true;this.pageCountConditionType=-1;}DocVoiceEye.prototype.getRectInPage=function(){var a=new docRect();a.copyRect(this.rect);if(this.subSection!=null){a.offsetRect(this.subSection.getLeftInPage(),this.subSection.getTopInPage());}return a;};function DocVoiceBarcode(){this.type=mCR_DocumentControlType.VoiceBarcode;this.subSection=null;this.rect=new docRect();this.visibleOptionStyleKey=-1;this.data=null;this.position=false;this.visible=true;this.conditionVisible=true;this.pageCountConditionType=-1;this.size="";this.text="";}DocVoiceBarcode.prototype.getRectInPage=function(){var a=new docRect();a.copyRect(this.rect);if(this.subSection!=null){a.offsetRect(this.subSection.getLeftInPage(),this.subSection.getTopInPage());}return a;};DocVoiceBarcode.prototype.getBarcodeSize=function(){var a=180;if(-1!=this.size.indexOf("15x15")){a=150;}else{if(-1!=this.size.indexOf("18x18")){a=180;}else{if(-1!=this.size.indexOf("20x20")){a=200;}else{if(-1!=this.size.indexOf("22x22")){a=220;}}}}return a;};DocVoiceBarcode.prototype.getImagePath=function(){var a=this.getBarcodeSize();var b="codev";if(a==150){b+="15_";}else{if(a==180){b+="18_";}else{if(a==200){b+="20_";}else{if(a==220){b+="22_";}else{b+="18_";}}}}if(this.text==""){b+="1";}else{b+="2";}return b;};function docInputSign(){this.type=mCR_DocumentControlType.InputSign;this.subSection=null;this.rect=new docRect();this.shapeStyleKey=null;this.backgroundStyleKey=null;this.outterlineStyleKey=null;this.visibleOptionStyleKey=-1;this.penWidth=3;this.penColor=0;this.primaryName=null;this.isNecessaryCheck=false;this.necessaryName=null;this.guileLineColor=255;this.guileLineWidth=75;this.guileLineStyle=0;this.transparencyRate=null;this.horizontalAlignmentMethod=1;this.verticalAlignmentMethod=1;this.accessibilityString=null;this.visible=true;this.conditionVisible=true;this.pageCountConditionType=-1;this.guideTextExport=false;}docInputSign.prototype.getRectInPage=function(){var a=new docRect();a.copyRect(this.rect);if(this.subSection!=null){a.offsetRect(this.subSection.getLeftInPage(),this.subSection.getTopInPage());}return a;};function docInputCheckbox(){this.type=mCR_DocumentControlType.InputCheckbox;this.subSection=null;this.rect=new docRect();this.outterlineStyleKey;this.primaryName;this.textInfo=new docTextInfo();this.checkSize;this.selectType=0;this.selectArea=1;this.useText;this.shapeStyleKey=-1;this.backgroundStyleKey;this.accessibilityString="";this.guideTransparency=100;this.visibleOptionStyleKey=-1;this.visible=true;this.conditionVisible=true;this.pageCountConditionType=-1;this.guideInCheckBox=false;this.checkboxLeftAlignment=true;this.checkedBorderLineStyleKey=-1;}docInputCheckbox.prototype.getRectInPage=function(){var a=new docRect();a.copyRect(this.rect);if(this.subSection!=null){a.offsetRect(this.subSection.getLeftInPage(),this.subSection.getTopInPage());}return a;};function docInputImage(){this.type=mCR_DocumentControlType.InputImage;this.subSection=null;this.rect=new docRect();this.shapeStyleKey=null;this.backgroundStyleKey=null;this.outterlineStyleKey=null;this.visibleOptionStyleKey=-1;this.visibleOptionStyleKey=-1;this.visible=true;this.conditionVisible=true;this.pageCountConditionType=-1;this.primaryName=null;this.transparencyRate=null;this.accessibilityString=null;}docInputImage.prototype.getRectInPage=function(){var a=new docRect();a.copyRect(this.rect);if(this.subSection!=null){a.offsetRect(this.subSection.getLeftInPage(),this.subSection.getTopInPage());}return a;};function docInputbox(){this.type=mCR_DocumentControlType.Input;this.subSection=null;this.rect=new docRect();this.shapeStyleKey=-1;this.backgroundStyleKey;this.outterlineStyleKey;this.primaryName;this.textInfo=new docTextInfo();this.accessibilityString;this.transparencyRate=100;this.visibleOptionStyleKey=-1;this.visible=true;this.conditionVisible=true;this.pageCountConditionType=-1;}docInputbox.prototype.getRectInPage=function(){var a=new docRect();a.copyRect(this.rect);if(this.subSection!=null){a.offsetRect(this.subSection.getLeftInPage(),this.subSection.getTopInPage());}return a;};function docInputSelectbox(){this.type=mCR_DocumentControlType.InputSelectBox;this.subSection=null;this.rect=new docRect();this.shapeStyleKey=-1;this.backgroundStyleKey;this.outterlineStyleKey;this.primaryName;this.textInfo=new docTextInfo();this.accessibilityString;this.transparencyRate=100;this.visibleOptionStyleKey=-1;this.visible=true;this.conditionVisible=true;this.pageCountConditionType=-1;}docInputSelectbox.prototype.getRectInPage=function(){var a=new docRect();a.copyRect(this.rect);if(this.subSection!=null){a.offsetRect(this.subSection.getLeftInPage(),this.subSection.getTopInPage());}return a;};function docInputCalendar(){this.type=mCR_DocumentControlType.Calendar;this.subSection=null;this.rect=new docRect();this.shapeStyleKey=-1;this.backgroundStyleKey;this.outterlineStyleKey;this.primaryName;this.accessibilityString;this.transparencyRate=100;this.fontStyleKey;this.textMarginStyleKey;this.textOptionStyleKey;this.textInfo=new docTextInfo();this.visibleOptionStyleKey=-1;this.visible=true;this.conditionVisible=true;this.pageCountConditionType=-1;}docInputCalendar.prototype.getRectInPage=function(){var a=new docRect();a.copyRect(this.rect);if(this.subSection!=null){a.offsetRect(this.subSection.getLeftInPage(),this.subSection.getTopInPage());}return a;};function docInputButton(){this.type=mCR_DocumentControlType.Button;this.subSection=null;this.rect=new docRect();this.shapeStyleKey=-1;this.backgroundStyleKey;this.outterlineStyleKey;this.primaryName;this.textInfo=new docTextInfo();this.accessibilityString;this.transparencyRate=100;this.visibleOptionStyleKey=-1;this.visible=true;this.conditionVisible=true;this.pageCountConditionType=-1;}docInputButton.prototype.getRectInPage=function(){var a=new docRect();a.copyRect(this.rect);if(this.subSection!=null){a.offsetRect(this.subSection.getLeftInPage(),this.subSection.getTopInPage());}return a;};function docInputVideo(){this.type=mCR_DocumentControlType.Video;this.subSection=null;this.rect=new docRect();this.shapeStyleKey=-1;this.backgroundStyleKey;this.outterlineStyleKey;this.primaryName;this.accessibilityString;this.transparencyRate=100;this.visibleOptionStyleKey=-1;this.visible=true;this.conditionVisible=true;this.pageCountConditionType=-1;}docInputVideo.prototype.getRectInPage=function(){var a=new docRect();a.copyRect(this.rect);if(this.subSection!=null){a.offsetRect(this.subSection.getLeftInPage(),this.subSection.getTopInPage());}return a;};function docLabel(){this.type=mCR_DocumentControlType.Label;this.rect=new docRect();this.shapeStyleKey=null;this.backgroundStyleKey=null;this.outterlineStyleKey=null;this.imageInfo=new docImageInfo();this.textInfo=new docTextInfo();this.webLinkInfo=new docWebLinkInfo();this.accessibilityString=null;this.editable=false;this.editableIndex=-1;this.visibleOptionStyleKey=-1;this.visible=true;this.conditionVisible=true;this.pageCountConditionType=-1;}docLabel.prototype.setTextInfo=function(a){this.textInfo=a;};docLabel.prototype.getRectInPage=function(){var a=new docRect();a.copyRect(this.rect);if(this.subSection!=null){a.offsetRect(this.subSection.getLeftInPage(),this.subSection.getTopInPage());}return a;};function docOriginalTextInfo(){this.text=null;this.originalText=null;this.fontStyleKey=null;this.textOptionStyleKey=null;this.textMarginStyleKey=null;this.textTagStyleKey=null;this.originalFontSize=null;this.post=null;this.textRotation=0;this.charDirection=0;this.charMode=0;this.nameList=null;this.result=null;}docOriginalTextInfo.prototype.getFontStyleKey=function(){return this.fontStyleKey;};docOriginalTextInfo.prototype.getTextRotation=function(){return this.textRotation;};docOriginalTextInfo.prototype.getCharDirection=function(){return this.charDirection;};docOriginalTextInfo.prototype.getCharMode=function(){return this.charMode;};docOriginalTextInfo.prototype.getTextOptionStyleKey=function(){return this.textOptionStyleKey;};docOriginalTextInfo.prototype.getTextMarginStyleKey=function(){return this.textMarginStyleKey;};function docTextCharacter(){this.character=null;this.xPosition=null;}docTextCharacter.prototype.getX=function(){return this.xPosition;};docTextCharacter.prototype.getCharacter=function(){return this.character;};function docTextCharacterBatch(){this.fontStyleKey=null;this.smallChar=null;this.sup=null;this.sub=null;this.characterList=new Array();this.charMode=0;}docTextCharacterBatch.prototype.getCharacter=function(a){return this.characterList[a];};docTextCharacterBatch.prototype.getCharacterCount=function(){return this.characterList.length;};docTextCharacterBatch.prototype.getIsSmallChar=function(){return this.smallChar;};docTextCharacterBatch.prototype.getIsSup=function(){return this.sup;};docTextCharacterBatch.prototype.getIsSub=function(){return this.sub;};docTextCharacterBatch.prototype.getCharMode=function(){return this.charMode;};docTextCharacterBatch.prototype.getFontStyleKey=function(){return this.fontStyleKey;};function docTextInfo(){this.isPageCount=null;this.isTotalPageCount=null;this.textLineList=new Array();this.originalTextInfo=new docOriginalTextInfo();this.useMultiLanguage=false;this.pageFormula=null;this.formulaFieldIndex=-1;this.scriptString=null;}docTextInfo.prototype.getUseMultiLanguage=function(){return this.useMultiLanguage;};docTextInfo.prototype.getOriginalTextInfo=function(){return this.originalTextInfo;};docTextInfo.prototype.getTextLineCount=function(){return this.textLineList.length;};docTextInfo.prototype.getTextLine=function(a){return this.textLineList[a];};docTextInfo.prototype.getHeight=function(){if(this.textLineList.length==0){return 0;}else{var a=this.getLastTextLine();return a.getY2();}};docTextInfo.prototype.getLastTextLine=function(){return this.textLineList[this.textLineList.length-1];};function docTextLine(){this.xPosition=null;this.yPosition=null;this.text=null;this.height=null;this.eraseSpaceCount=null;this.continuesLine=null;this.textShapeList=new Array();this.characterBatchList=new Array();}docTextLine.prototype.getCharacterBatchCount=function(){return this.characterBatchList.length;};docTextLine.prototype.getCharacterBatch=function(a){return this.characterBatchList[a];};docTextLine.prototype.getY=function(a){return this.yPosition;};docTextLine.prototype.getY2=function(a){return this.yPosition+this.height;};docTextLine.prototype.getHeight=function(a){return this.height;};docTextLine.prototype.getText=function(){return this.text;};docTextLine.prototype.getTextShapeCount=function(){return this.textShapeList.length;};docTextLine.prototype.getTextShape=function(a){return this.textShapeList[a];};docTextLine.prototype.isPaint=function(a,b){if(this.getY2()<=a+this.getHeight()*0.15||b==0){return true;}return false;};function docTextShape(){this.rect=new docRect();this.shapeType=null;this.lineStyleKey=null;}function docImageInfo(){this.parent=null;this.imageFilePath="";this.imageFormatType=0;this.backgroundImageStyleKey=-1;this.imageDataKey=-1;this.startPosition=0;this.endPosition=100;this.imageData=null;}docImageInfo.prototype.setParent=function(a){this.parent=a;};function docWebLinkInfo(){this.type=null;this.linkUrl=null;this.webLinkType=null;this.frameName=null;this.windowWidth=null;this.windowHeight=null;this.editText=null;this.editableIndex=-1;this.fontStyle="";this.objControl=null;this.isChecked=false;}docWebLinkInfo.prototype.getType=function(){return this.type;};docWebLinkInfo.prototype.getLinkUrl=function(){return this.linkUrl;};function docStyleBackground(){this.backStyle=null;this.backColor=null;this.fillStyle=null;this.fillColor=null;this.gradientStyle=null;this.gradientStartColor=null;this.gradientEndColor=null;}docStyleBackground.prototype.getBackStyle=function(){return this.backStyle;};function docStyleBackgroundImage(){this.imageDrawMethod=null;this.imageFrame=null;this.horizontalAlignment=null;this.verticalAlignment=null;this.rate=null;this.transparency=null;}function docStyleFont(){this.nameIndex=null;this.size=null;this.bold=null;this.italic=null;this.underline=null;this.strike=null;this.color=null;this.underLineStyle=null;this.underLineColor=null;this.strikeLineStyle=null;this.strikeLineColor=null;this.nameEngIndex=null;this.underLineWidth=75;this.autoUnderLineWidth=true;this.strikeLineWidth=75;this.autoStrikeLineWidth=true;}function docStyleLine(){this.style=null;this.width=null;this.color=null;}docStyleLine.prototype.setStyle=function(a,b,c){this.style=a;this.width=b;this.color=c;};function docStylePage(){this.paperType=null;this.width=null;this.height=null;this.orientation=null;this.leftMargin=null;this.topMargin=null;this.rightMargin=null;this.bottomMargin=null;this.pageCount=null;this.multiColumnDirection=null;}function docStyleShape(){this.shapeType=null;this.roundRate=null;}function docStyleTextMargin(){this.left=null;this.top=null;this.right=null;this.bottom=null;}function docStyleTextOption(){this.horizontalAlignment=null;this.verticalAlignment=null;this.wordWrap=null;this.wordBreaking=null;this.wordSpace=null;this.lineSpace=null;this.charSet=null;this.outputFormat=null;this.autoFont=null;}docStyleTextOption.prototype.getHorizontalAlignment=function(){return this.horizontalAlignment;};docStyleTextOption.prototype.getVerticalAlignment=function(){return this.verticalAlignment;};function docStyleTextTag(){this.use=null;this.bold=null;this.italic=null;this.underline=null;this.strike=null;this.color=null;this.round=null;this.rectangle=null;this.supScript=null;this.subScript=null;this.lineBreak=null;this.fontName=null;this.fontSize=null;}function docStyleVisibleOption(){this.toView=null;this.toPrint=null;this.toXLS=null;this.toPDF=null;this.toHWP=null;this.toHTM=null;this.toPPT=null;this.toRTF=null;this.toBMP=null;this.toJPG=null;this.toTIF=null;this.toTXT=null;this.toEasyMoad=true;}function mCR_Symbology(a,d,b,c){this.isCanvas=a;this.g=d;this.barcode=b;this.rect=c;this.errorCode=0;this.errorMsg="";}mCR_Symbology.prototype.drawErrorMsg=function(){};mCR_Symbology.prototype.getBarcodeWidth=function(){var a=0;switch(this.barcode.barcodeAngle){case 0:case 2:a=this.rect.getWidth();break;case 1:case 3:a=this.rect.getHeight();break;}return a;};mCR_Symbology.prototype.drawBarCodeRect=function(f,d,c,a){f=f*0.378;d=d*0.378;c=c*0.378;a=a*0.378;if(this.isCanvas){this.g.beginPath();this.g.rect(f,d,c,a);this.g.fillStyle=mCR_getStrColor(this.barcode.barcodeColor);this.g.fill();}else{var b=document.createElementNS("http://www.w3.org/2000/svg","rect");b.setAttribute("x",f);b.setAttribute("y",d);b.setAttribute("width",c);b.setAttribute("height",a);b.setAttribute("stroke","none");b.setAttribute("fill",mCR_getStrColor(this.barcode.barcodeColor));this.g.appendChild(b);}};mCR_Symbology.prototype.drawBarAngle0=function(c,b,a){if(a!=null){this.drawBarCodeRect(Math.round(c),this.rect.top,Math.round(b),a);}else{this.drawBarCodeRect(c,this.rect.top,b,this.rect.getHeight());}};mCR_Symbology.prototype.drawBarAngle90=function(c,b,a){if(a!=null){this.drawBarCodeRect(this.rect.left,Math.round(c-b),a,Math.round(b));}else{this.drawBarCodeRect(this.rect.left,(c-b),this.rect.getWidth(),b);}};mCR_Symbology.prototype.drawBarAngle180=function(c,b,a,d){if(a!=null){this.drawBarCodeRect(Math.round(c-b),d,Math.round(b),a);}else{this.drawBarCodeRect((c-b),this.rect.top,b,this.rect.getHeight());}};mCR_Symbology.prototype.drawBarAngle270=function(c,b,a,d){if(a!=null){this.drawBarCodeRect(d,Math.round(c),a,Math.round(b));}else{this.drawBarCodeRect(this.rect.left,c,this.rect.getWidth(),b);}};mCR_Symbology.prototype.drawBarCodeFontRect=function(c,b,g,a,f){c=c*0.378;b=b*0.378;if(this.isCanvas){this.g.save();this.g.font=g;this.g.fillStyle=mCR_getStrColor(this.barcode.barcodeColor);switch(a){case 0:this.g.fillText(f,c,b);break;case 1:this.g.translate(c,b);this.g.rotate(270*Math.PI/180);this.g.fillText(f,0,0);break;case 2:this.g.translate(c,b);this.g.rotate(180*Math.PI/180);this.g.fillText(f,0,0);break;case 3:this.g.translate(c,b);this.g.rotate(90*Math.PI/180);this.g.fillText(f,0,0);break;}this.g.restore();}else{var d=document.createElementNS("http://www.w3.org/2000/svg","text");switch(a){case 0:d.setAttribute("x",c);d.setAttribute("y",b);break;case 1:d.setAttribute("transform","rotate(270,"+c+","+b+") translate("+0+",0)");d.setAttribute("x",c);d.setAttribute("y",b);break;case 2:d.setAttribute("transform","rotate(180,"+c+","+b+") translate("+0+",0)");d.setAttribute("x",c);d.setAttribute("y",b);break;case 3:d.setAttribute("transform","rotate(90,"+c+","+b+") translate("+0+",0)");d.setAttribute("x",c);d.setAttribute("y",b);break;}if(this.barcode.fontBold){if(window.is_apple||window.mCR_isApple){d.setAttribute("font-weight","normal");d.setAttribute("stroke-width","0.4");d.setAttribute("paint-order","stroke");d.setAttribute("stroke",mCR_getStrColor(this.barcode.barcodeColor));}else{d.setAttribute("font-weight","bold");}}else{d.setAttribute("stroke","none");}d.setAttribute("fill",mCR_getStrColor(this.barcode.barcodeColor));d.setAttribute("font-family",this.barcode.fontName);d.setAttribute("font-size",this.barcode.fontSize*1.32814+"px");d.textContent=f;this.g.appendChild(d);}};mCR_Symbology.prototype.drawBarCodeFontAngle0=function(b,a,d,c){this.drawBarCodeFontRect(b,a,d,0,c);};mCR_Symbology.prototype.drawBarCodeFontAngle90=function(b,a,d,c){this.drawBarCodeFontRect(b,a,d,1,c);};mCR_Symbology.prototype.drawBarCodeFontAngle180=function(b,a,d,c){this.drawBarCodeFontRect(b,a,d,2,c);};mCR_Symbology.prototype.drawBarCodeFontAngle270=function(b,a,d,c){this.drawBarCodeFontRect(b,a,d,3,c);};function BarcodeEAN_Pattern(b,a){this.pattern=b;this.text=a;this.halfStatus=(a=="");}BarcodeEAN_Pattern.prototype.getPattern=function(){return this.pattern;};BarcodeEAN_Pattern.prototype.getText=function(){return this.text;};BarcodeEAN_Pattern.prototype.getHalfStatus=function(){return this.halfStatus;};function mCR_SymbologyCode39(a,d,b,c){mCR_Symbology.call(this,a,d,b,c);this.START_CHAR=43;this.END_CHAR=43;}mCR_SymbologyCode39.prototype=Object.create(mCR_Symbology.prototype);mCR_SymbologyCode39.prototype.constructor=mCR_SymbologyCode39;mCR_SymbologyCode39.prototype.drawBarcode=function(){var a=this.createPattern(this.barcode.text);if(this.errorCode==0){this.drawPattern(a);}else{this.drawErrorMsg();}};mCR_SymbologyCode39.prototype.drawPattern=function(b){var a=this.getDimension(b);this.drawNWPattern(b,a);};mCR_SymbologyCode39.prototype.drawNWPattern=function(b,a){switch(this.barcode.barcodeAngle){case 0:this.drawNWPatternAngle0(b,a);break;case 1:this.drawNWPatternAngle90(b,a);break;case 2:this.drawNWPatternAngle180(b,a);break;case 3:this.drawNWPatternAngle270(b,a);break;}};mCR_SymbologyCode39.prototype.drawNWPatternAngle0=function(g,f){var a=this.rect.left;var d=g.length;for(var b=0;b<d;b++){var c=this.getBarWidth(g.charAt(b),f);if(b%2==0){this.drawBarAngle0(a,c);}a=a+c;}};mCR_SymbologyCode39.prototype.drawNWPatternAngle90=function(g,f){var a=(this.rect.top+this.rect.getHeight());var d=g.length;for(var b=0;b<d;b++){var c=this.getBarWidth(g.charAt(b),f);if(b%2==0){this.drawBarAngle90(a,c);}a=a-c;}};mCR_SymbologyCode39.prototype.drawNWPatternAngle180=function(g,f){var a=(this.rect.left+this.rect.getWidth());var d=g.length;for(var b=0;b<d;b++){var c=this.getBarWidth(g.charAt(b),f);if(b%2==0){this.drawBarAngle180(a,c);}a=a-c;}};mCR_SymbologyCode39.prototype.drawNWPatternAngle270=function(g,f){var a=(this.rect.top);var d=g.length;for(var b=0;b<d;b++){var c=this.getBarWidth(g.charAt(b),f);if(b%2==0){this.drawBarAngle270(a,c);}a=a+c;}};mCR_SymbologyCode39.prototype.getBarWidth=function(b,d){var a;var c=this.barcode.wideRatio;if(b=="n"){a=d;}else{a=d*c;}return a;};mCR_SymbologyCode39.prototype.getDimension=function(c){var d=this.getBarModuleSize(c);var a=this.getBarcodeWidth();var b=0;if(this.barcode.optResolution){b=Math.floor((a/d));if(b<1){b=1;}}else{b=(a/d);}return b;};mCR_SymbologyCode39.prototype.getBarModuleSize=function(d){var g=d.length;var a=0;for(var b=0;b<g;b++){if(d.charAt(b)=="w"){a++;}}var c=this.barcode.wideRatio;var f=g+(a*(c-1))-1;return f;};mCR_SymbologyCode39.prototype.createPattern=function(h){var g="";var f=h.length;if(f>2){if(h.charAt(0)=="*"&&h.charAt(f-1)=="*"){h=h.substring(1,f-1);f=h.length;}}if(f==0){this.errorCode=1;this.errorMsg="value size error";}else{var a=0;g=this.getStartPattern();for(var b=0;b<f;b++){var c=h.charAt(b);var d=this.getCharacterCode(c);if(d!=-1){g+=this.retrievePattern(d);a+=d;}else{this.errorCode=2;this.errorMsg="Unvalid data";g="";break;}}if(this.errorCode==0){g=g+this.getStopPattern();}}return g;};mCR_SymbologyCode39.prototype.getStartPattern=function(){return this.retrievePattern(this.START_CHAR);};mCR_SymbologyCode39.prototype.getStopPattern=function(){return this.retrievePattern(this.END_CHAR);};mCR_SymbologyCode39.prototype.getCharacterCode=function(b){var a=-1;switch(b){case"0":a=0;break;case"1":a=1;break;case"2":a=2;break;case"3":a=3;break;case"4":a=4;break;case"5":a=5;break;case"6":a=6;break;case"7":a=7;break;case"8":a=8;break;case"9":a=9;break;case"A":a=10;break;case"B":a=11;break;case"C":a=12;break;case"D":a=13;break;case"E":a=14;break;case"F":a=15;break;case"G":a=16;break;case"H":a=17;break;case"I":a=18;break;case"J":a=19;break;case"K":a=20;break;case"L":a=21;break;case"M":a=22;break;case"N":a=23;break;case"O":a=24;break;case"P":a=25;break;case"Q":a=26;break;case"R":a=27;break;case"S":a=28;break;case"T":a=29;break;case"U":a=30;break;case"V":a=31;break;case"W":a=32;break;case"X":a=33;break;case"Y":a=34;break;case"Z":a=35;break;case"-":a=36;break;case".":a=37;break;case" ":a=38;break;case"$":a=39;break;case"/":a=40;break;case"+":a=41;break;case"%":a=42;break;case"*":a=43;break;}return a;};mCR_SymbologyCode39.prototype.retrievePattern=function(a){var b="";switch(a){case 0:b="nnnwwnwnnn";break;case 1:b="wnnwnnnnwn";break;case 2:b="nnwwnnnnwn";break;case 3:b="wnwwnnnnnn";break;case 4:b="nnnwwnnnwn";break;case 5:b="wnnwwnnnnn";break;case 6:b="nnwwwnnnnn";break;case 7:b="nnnwnnwnwn";break;case 8:b="wnnwnnwnnn";break;case 9:b="nnwwnnwnnn";break;case 10:b="wnnnnwnnwn";break;case 11:b="nnwnnwnnwn";break;case 12:b="wnwnnwnnnn";break;case 13:b="nnnnwwnnwn";break;case 14:b="wnnnwwnnnn";break;case 15:b="nnwnwwnnnn";break;case 16:b="nnnnnwwnwn";break;case 17:b="wnnnnwwnnn";break;case 18:b="nnwnnwwnnn";break;case 19:b="nnnnwwwnnn";break;case 20:b="wnnnnnnwwn";break;case 21:b="nnwnnnnwwn";break;case 22:b="wnwnnnnwnn";break;case 23:b="nnnnwnnwwn";break;case 24:b="wnnnwnnwnn";break;case 25:b="nnwnwnnwnn";break;case 26:b="nnnnnnwwwn";break;case 27:b="wnnnnnwwnn";break;case 28:b="nnwnnnwwnn";break;case 29:b="nnnnwnwwnn";break;case 30:b="wwnnnnnnwn";break;case 31:b="nwwnnnnnwn";break;case 32:b="wwwnnnnnnn";break;case 33:b="nwnnwnnnwn";break;case 34:b="wwnnwnnnnn";break;case 35:b="nwwnwnnnnn";break;case 36:b="nwnnnnwnwn";break;case 37:b="wwnnnnwnnn";break;case 38:b="nwwnnnwnnn";break;case 39:b="nwnwnwnnnn";break;case 40:b="nwnwnnnwnn";break;case 41:b="nwnnnwnwnn";break;case 42:b="nnnwnwnwnn";break;case 43:b="nwnnwnwnnn";break;}return b;};function mCR_SymbologyCode39A(a,d,b,c){mCR_SymbologyCode39.call(this,a,d,b,c);}mCR_SymbologyCode39A.prototype=Object.create(mCR_SymbologyCode39.prototype);mCR_SymbologyCode39A.prototype.constructor=mCR_SymbologyCode39A;mCR_SymbologyCode39A.prototype.drawBarcode=function(){var c=this.barcode.text;var d="";for(var a=0;a<c.length;a++){d+=this.encoding(c.charCodeAt(a));}var b=this.createPattern(d);if(this.errorCode==0){this.drawPattern(b);}else{this.drawErrorMsg();}};mCR_SymbologyCode39A.prototype.encoding=function(b){var a="";switch(b){case 0:a="%U";break;case 1:a="$A";break;case 2:a="$B";break;case 3:a="$C";break;case 4:a="$D";break;case 5:a="$E";break;case 6:a="$F";break;case 7:a="$G";break;case 8:a="$H";break;case 9:a="$I";break;case 10:a="$J";break;case 11:a="$K";break;case 12:a="$L";break;case 13:a="$M";break;case 14:a="$N";break;case 15:a="$O";break;case 16:a="$P";break;case 17:a="$Q";break;case 18:a="$R";break;case 19:a="$S";break;case 20:a="$T";break;case 21:a="$U";break;case 22:a="$V";break;case 23:a="$W";break;case 24:a="$X";break;case 25:a="$Y";break;case 26:a="$Z";break;case 27:a="%A";break;case 28:a="%B";break;case 29:a="%C";break;case 30:a="%D";break;case 31:a="%E";break;case 32:a=" ";break;case 33:a="/A";break;case 34:a="/B";break;case 35:a="/C";break;case 36:a="/D";break;case 37:a="/E";break;case 38:a="/F";break;case 39:a="/G";break;case 40:a="/H";break;case 41:a="/I";break;case 42:a="/J";break;case 43:a="/K";break;case 44:a="/L";break;case 45:a="-";break;case 46:a=".";break;case 47:a="/O";break;case 48:a="0";break;case 49:a="1";break;case 50:a="2";break;case 51:a="3";break;case 52:a="4";break;case 53:a="5";break;case 54:a="6";break;case 55:a="7";break;case 56:a="8";break;case 57:a="9";break;case 58:a="/Z";break;case 59:a="%F";break;case 60:a="%G";break;case 61:a="%H";break;case 62:a="%I";break;case 63:a="%J";break;case 64:a="%V";break;case 65:a="A";break;case 66:a="B";break;case 67:a="C";break;case 68:a="D";break;case 69:a="E";break;case 70:a="F";break;case 71:a="G";break;case 72:a="H";break;case 73:a="I";break;case 74:a="J";break;case 75:a="K";break;case 76:a="L";break;case 77:a="M";break;case 78:a="N";break;case 79:a="O";break;case 80:a="P";break;case 81:a="Q";break;case 82:a="R";break;case 83:a="S";break;case 84:a="T";break;case 85:a="U";break;case 86:a="V";break;case 87:a="W";break;case 88:a="X";break;case 89:a="Y";break;case 90:a="Z";break;case 91:a="%K";break;case 92:a="%L";break;case 93:a="%M";break;case 94:a="%N";break;case 95:a="%O";break;case 96:a="%W";break;case 97:a="+A";break;case 98:a="+B";break;case 99:a="+C";break;case 100:a="+D";break;case 101:a="+E";break;case 102:a="+F";break;case 103:a="+G";break;case 104:a="+H";break;case 105:a="+I";break;case 106:a="+J";break;case 107:a="+K";break;case 108:a="+L";break;case 109:a="+M";break;case 110:a="+N";break;case 111:a="+O";break;case 112:a="+P";break;case 113:a="+Q";break;case 114:a="+R";break;case 115:a="+S";break;case 116:a="+T";break;case 117:a="+U";break;case 118:a="+V";break;case 119:a="+W";break;case 120:a="+X";break;case 121:a="+Y";break;case 122:a="+Z";break;case 123:a="%P";break;case 124:a="%Q";break;case 125:a="%R";break;case 126:a="%S";break;case 127:a="%T";break;}return a;};function mCR_SymbologyCode93(a,d,b,c){mCR_Symbology.call(this,a,d,b,c);}mCR_SymbologyCode93.prototype=Object.create(mCR_Symbology.prototype);mCR_SymbologyCode93.prototype.constructor=mCR_SymbologyCode93;mCR_SymbologyCode93.prototype.drawBarcode=function(){var a=this.createPattern(this.barcode.text);if(this.errorCode==0){this.drawPattern(a);}else{this.drawErrorMsg();}};mCR_SymbologyCode93.prototype.drawPattern=function(b){var a=this.getDimension(b);this.drawBSPattern(b,a);};mCR_SymbologyCode93.prototype.drawBSPattern=function(b,a){switch(this.barcode.barcodeAngle){case 0:this.drawBSPatternAngle0(b,a);break;case 1:this.drawBSPatternAngle90(b,a);break;case 2:this.drawBSPatternAngle180(b,a);break;case 3:this.drawBSPatternAngle270(b,a);break;}};mCR_SymbologyCode93.prototype.drawBSPatternAngle0=function(g,f){var a=this.rect.left;var d=g.length;var c=0;for(var b=0;b<d;b++){if(g.charAt(b)=="b"){c+=f;}else{if(c!=0){this.drawBarAngle0(a,c);a=a+c;}c=0;a=a+f;}}if(c!=0){this.drawBarAngle0(a,c);}};mCR_SymbologyCode93.prototype.drawBSPatternAngle90=function(g,f){var a=(this.rect.top+this.rect.getHeight());var d=g.length;var c=0;for(var b=0;b<d;b++){if(g.charAt(b)=="b"){c+=f;}else{if(c!=0){this.drawBarAngle90(a,c);a=a-c;}c=0;a=a-f;}}if(c!=0){this.drawBarAngle90(a,c);}};mCR_SymbologyCode93.prototype.drawBSPatternAngle180=function(g,f){var a=(this.rect.left+this.rect.getWidth());var d=g.length;var c=0;for(var b=0;b<d;b++){if(g.charAt(b)=="b"){c+=f;}else{if(c!=0){this.drawBarAngle180(a,c);a=a-c;}c=0;a=a-f;}}if(c!=0){this.drawBarAngle180(a,c);}};mCR_SymbologyCode93.prototype.drawBSPatternAngle270=function(g,f){var a=(this.rect.top);var d=g.length;var c=0;for(var b=0;b<d;b++){if(g.charAt(b)=="b"){c+=f;}else{if(c!=0){this.drawBarAngle270(a,c);a=a+c;}c=0;a=a+f;}}if(c!=0){this.drawBarAngle270(a,c);}};mCR_SymbologyCode93.prototype.getDimension=function(d){var a=d.length;var b=this.getBarcodeWidth();var c=0;if(this.barcode.optResolution){c=Math.floor((b/a));if(c<1){c=1;}}else{c=(b/a);}return c;};mCR_SymbologyCode93.prototype.createPattern=function(i){var g="";var f=i.length;if(f>0){var a=0;var h=0;g+=this.retrievePattern(47);for(var b=0;b<f;b++){var c=this.getCharacterCode(i.charAt(b));if(c!=-1){g+=this.retrievePattern(c);}else{this.errorCode=2;this.errorMsg="Unvalid data";g="";break;}var d=f-b;d=d%20;if(d==0){d=20;}var j=f-b+1;j=j%15;if(j==0){j=15;}a+=(c*d);h+=(c*j);}if(this.errorCode==0){a%=47;h+=a;h%=47;g+=this.retrievePattern(a);g+=this.retrievePattern(h);g+=this.retrievePattern(47);g+="b";}}return g;};mCR_SymbologyCode93.prototype.getCharacterCode=function(a){var b=-1;switch(a){case"0":b=0;break;case"1":b=1;break;case"2":b=2;break;case"3":b=3;break;case"4":b=4;break;case"5":b=5;break;case"6":b=6;break;case"7":b=7;break;case"8":b=8;break;case"9":b=9;break;case"A":b=10;break;case"B":b=11;break;case"C":b=12;break;case"D":b=13;break;case"E":b=14;break;case"F":b=15;break;case"G":b=16;break;case"H":b=17;break;case"I":b=18;break;case"J":b=19;break;case"K":b=20;break;case"L":b=21;break;case"M":b=22;break;case"N":b=23;break;case"O":b=24;break;case"P":b=25;break;case"Q":b=26;break;case"R":b=27;break;case"S":b=28;break;case"T":b=29;break;case"U":b=30;break;case"V":b=31;break;case"W":b=32;break;case"X":b=33;break;case"Y":b=34;break;case"Z":b=35;break;case"-":b=36;break;case".":b=37;break;case" ":b=38;break;case"$":b=39;break;case"/":b=40;break;case"+":b=41;break;case"%":b=42;break;case"!":b=43;break;case"#":b=44;break;case"&":b=45;break;case"@":b=46;break;case"*":b=47;break;}return b;};mCR_SymbologyCode93.prototype.retrievePattern=function(a){var b="";switch(a){case 0:b="bsssbsbss";break;case 1:b="bsbssbsss";break;case 2:b="bsbsssbss";break;case 3:b="bsbssssbs";break;case 4:b="bssbsbsss";break;case 5:b="bssbssbss";break;case 6:b="bssbsssbs";break;case 7:b="bsbsbssss";break;case 8:b="bsssbssbs";break;case 9:b="bssssbsbs";break;case 10:b="bbsbsbsss";break;case 11:b="bbsbssbss";break;case 12:b="bbsbsssbs";break;case 13:b="bbssbsbss";break;case 14:b="bbssbssbs";break;case 15:b="bbsssbsbs";break;case 16:b="bsbbsbsss";break;case 17:b="bsbbssbss";break;case 18:b="bsbbsssbs";break;case 19:b="bssbbsbss";break;case 20:b="bsssbbsbs";break;case 21:b="bsbsbbsss";break;case 22:b="bsbssbbss";break;case 23:b="bsbsssbbs";break;case 24:b="bssbsbbss";break;case 25:b="bsssbsbbs";break;case 26:b="bbsbbsbss";break;case 27:b="bbsbbssbs";break;case 28:b="bbsbsbbss";break;case 29:b="bbsbssbbs";break;case 30:b="bbssbsbbs";break;case 31:b="bbssbbsbs";break;case 32:b="bsbbsbbss";break;case 33:b="bsbbssbbs";break;case 34:b="bssbbsbbs";break;case 35:b="bssbbbsbs";break;case 36:b="bssbsbbbs";break;case 37:b="bbbsbsbss";break;case 38:b="bbbsbssbs";break;case 39:b="bbbssbsbs";break;case 40:b="bsbbsbbbs";break;case 41:b="bsbbbsbbs";break;case 42:b="bbsbsbbbs";break;case 43:b="bssbssbbs";break;case 44:b="bbbsbbsbs";break;case 45:b="bbbsbsbbs";break;case 46:b="bssbbssbs";break;case 47:b="bsbsbbbbs";break;}return b;};function mCR_SymbologyCode93A(a,d,b,c){mCR_SymbologyCode93.call(this,a,d,b,c);}mCR_SymbologyCode93A.prototype=Object.create(mCR_SymbologyCode93.prototype);mCR_SymbologyCode93A.prototype.constructor=mCR_SymbologyCode93A;mCR_SymbologyCode93A.prototype.drawBarcode=function(){var f="";var b=this.barcode.text.length;var d=this.barcode.text;for(var a=0;a<b;a++){f+=this.encoding(d.charCodeAt(a));}var c=this.createPattern(f);if(this.errorCode==0){this.drawPattern(c);}else{this.drawErrorMsg();}};mCR_SymbologyCode93A.prototype.encoding=function(b){var a="";switch(b){case 0:a="%U";break;case 1:a="$A";break;case 2:a="$B";break;case 3:a="$C";break;case 4:a="$D";break;case 5:a="$E";break;case 6:a="$F";break;case 7:a="$G";break;case 8:a="$H";break;case 9:a="$I";break;case 10:a="$J";break;case 11:a="$K";break;case 12:a="$L";break;case 13:a="$M";break;case 14:a="$N";break;case 15:a="$O";break;case 16:a="$P";break;case 17:a="$Q";break;case 18:a="$R";break;case 19:a="$S";break;case 20:a="$T";break;case 21:a="$U";break;case 22:a="$V";break;case 23:a="$W";break;case 24:a="$X";break;case 25:a="$Y";break;case 26:a="$Z";break;case 27:a="%A";break;case 28:a="%B";break;case 29:a="%C";break;case 30:a="%D";break;case 31:a="%E";break;case 32:a=" ";break;case 33:a="/A";break;case 34:a="/B";break;case 35:a="/C";break;case 36:a="/D";break;case 37:a="/E";break;case 38:a="/F";break;case 39:a="/G";break;case 40:a="/H";break;case 41:a="/I";break;case 42:a="/J";break;case 43:a="/K";break;case 44:a="/L";break;case 45:a="-";break;case 46:a=".";break;case 47:a="/O";break;case 48:a="0";break;case 49:a="1";break;case 50:a="2";break;case 51:a="3";break;case 52:a="4";break;case 53:a="5";break;case 54:a="6";break;case 55:a="7";break;case 56:a="8";break;case 57:a="9";break;case 58:a="/Z";break;case 59:a="%F";break;case 60:a="%G";break;case 61:a="%H";break;case 62:a="%I";break;case 63:a="%J";break;case 64:a="%V";break;case 65:a="A";break;case 66:a="B";break;case 67:a="C";break;case 68:a="D";break;case 69:a="E";break;case 70:a="F";break;case 71:a="G";break;case 72:a="H";break;case 73:a="I";break;case 74:a="J";break;case 75:a="K";break;case 76:a="L";break;case 77:a="M";break;case 78:a="N";break;case 79:a="O";break;case 80:a="P";break;case 81:a="Q";break;case 82:a="R";break;case 83:a="S";break;case 84:a="T";break;case 85:a="U";break;case 86:a="V";break;case 87:a="W";break;case 88:a="X";break;case 89:a="Y";break;case 90:a="Z";break;case 91:a="%K";break;case 92:a="%L";break;case 93:a="%M";break;case 94:a="%N";break;case 95:a="%O";break;case 96:a="%W";break;case 97:a="+A";break;case 98:a="+B";break;case 99:a="+C";break;case 100:a="+D";break;case 101:a="+E";break;case 102:a="+F";break;case 103:a="+G";break;case 104:a="+H";break;case 105:a="+I";break;case 106:a="+J";break;case 107:a="+K";break;case 108:a="+L";break;case 109:a="+M";break;case 110:a="+N";break;case 111:a="+O";break;case 112:a="+P";break;case 113:a="+Q";break;case 114:a="+R";break;case 115:a="+S";break;case 116:a="+T";break;case 117:a="+U";break;case 118:a="+V";break;case 119:a="+W";break;case 120:a="+X";break;case 121:a="+Y";break;case 122:a="+Z";break;case 123:a="%P";break;case 124:a="%Q";break;case 125:a="%R";break;case 126:a="%S";break;case 127:a="%T";break;}return a;};function mCR_SymbologyCodaBar(a,d,b,c){mCR_Symbology.call(this,a,d,b,c);}mCR_SymbologyCodaBar.prototype=Object.create(mCR_Symbology.prototype);mCR_SymbologyCodaBar.prototype.constructor=mCR_SymbologyCodaBar;mCR_SymbologyCodaBar.prototype.drawBarcode=function(){var g=this.createPattern(this.barcode.text);if(this.errorCode==0){if(this.barcode.showText){var j=this.barcode.fontSize;var h=this.barcode.fontName;var c=this.barcode.fontBold;var a=this.barcode.fontSize*1.32814;var b=document.createElement("canvas");var i=b.getContext("2d");var d="";if(c){d="bold "+a+"px "+h;}else{d=a+"px "+h;}i.font=d;var f=parseFloat(i.measureText(this.barcode.text).width.toFixed(2));i=null;b=null;switch(this.barcode.barcodeAngle){case 0:this.drawFontAngle0(f,a,d);break;case 1:this.drawFontAngle90(f,a,d);break;case 2:this.drawFontAngle180(f,a,d);break;case 3:this.drawFontAngle270(f,a,d);break;}}this.drawPattern(g);}else{this.drawErrorMsg();}};mCR_SymbologyCodaBar.prototype.drawPattern=function(b){var a=this.getDimension(b);this.drawNWPattern(b,a);};mCR_SymbologyCodaBar.prototype.drawNWPattern=function(b,a){switch(this.barcode.barcodeAngle){case 0:this.drawNWPatternAngle0(b,a);break;case 1:this.drawNWPatternAngle90(b,a);break;case 2:this.drawNWPatternAngle180(b,a);break;case 3:this.drawNWPatternAngle270(b,a);break;}};mCR_SymbologyCodaBar.prototype.drawFontAngle0=function(f,c,d){this.rect.bottom-=c*2.64;var b=this.rect.left+parseInt(""+((this.rect.getWidth()/2)-(f*2.64/2)));var a=this.rect.top+this.rect.getHeight()+(c*2.64-parseInt(""+(c*2.64/5)));this.drawBarCodeFontAngle0(b,a,d,this.barcode.text);};mCR_SymbologyCodaBar.prototype.drawFontAngle90=function(f,c,d){var b=this.rect.left+(this.rect.getWidth()-parseInt(""+(c*2.64/5)));var a=this.rect.top+parseInt(((this.rect.getHeight()/2)-(f*2.64/2)))+f*2.64;this.rect.right-=c*2.64;this.drawBarCodeFontAngle90(b,a,d,this.barcode.text);};mCR_SymbologyCodaBar.prototype.drawFontAngle180=function(f,c,d){this.rect.top+=c*2.64;var b=this.rect.left+parseInt(""+((this.rect.getWidth()/2)-(f*2.64/2)))+f*2.64;var a=this.rect.top-((c*2.64)-parseInt(""+(c*2.64/5)));this.drawBarCodeFontAngle180(b,a,d,this.barcode.text);};mCR_SymbologyCodaBar.prototype.drawFontAngle270=function(f,c,d){this.rect.left+=c*2.64;var b=this.rect.left-(c*2.64-parseInt(""+(c*2.64/5)));var a=this.rect.top+parseInt(""+((this.rect.getHeight()/2)-(f*2.64/2)));this.drawBarCodeFontAngle270(b,a,d,this.barcode.text);};mCR_SymbologyCodaBar.prototype.drawNWPatternAngle0=function(g,f){var a=this.rect.left;var d=g.length;for(var b=0;b<d;b++){var c=this.getBarWidth(g.charAt(b),f);if(b%2==0){this.drawBarAngle0(a,c);}a=a+c;}};mCR_SymbologyCodaBar.prototype.drawNWPatternAngle90=function(g,f){var a=(this.rect.top+this.rect.getHeight());var d=g.length;for(var b=0;b<d;b++){var c=this.getBarWidth(g.charAt(b),f);if(b%2==0){this.drawBarAngle90(a,c);}a=a-c;}};mCR_SymbologyCodaBar.prototype.drawNWPatternAngle180=function(g,f){var a=(this.rect.left+this.rect.getWidth());var d=g.length;for(var b=0;b<d;b++){var c=this.getBarWidth(g.charAt(b),f);if(b%2==0){this.drawBarAngle180(a,c);}a=a-c;}};mCR_SymbologyCodaBar.prototype.drawNWPatternAngle270=function(g,f){var a=(this.rect.top);var d=g.length;for(var b=0;b<d;b++){var c=this.getBarWidth(g.charAt(b),f);if(b%2==0){this.drawBarAngle270(a,c);}a=a+c;}};mCR_SymbologyCodaBar.prototype.getBarWidth=function(b,d){var a;var c=this.barcode.wideRatio;if(b=="n"){a=d;}else{a=d*c;}return a;};mCR_SymbologyCodaBar.prototype.getDimension=function(c){var d=this.getBarModuleSize(c);var a=this.getBarcodeWidth();var b=0;if(this.barcode.optResolution){b=Math.floor((a/d));if(b<1){b=1;}}else{b=(a/d);}return b;};mCR_SymbologyCodaBar.prototype.getBarModuleSize=function(d){var g=d.length;var a=0;for(var b=0;b<g;b++){if(d.charAt(b)=="w"){a++;}}var c=this.barcode.wideRatio;var f=g+(a*(c-1))-1;return f;};mCR_SymbologyCodaBar.prototype.createPattern=function(d){var c="";var b=d.length;if(b==0){this.errorCode=1;this.errorMsg="value size error";}else{c+=this.retrievePattern("A");for(var a=0;a<b;a++){var f=this.retrievePattern(d.charAt(a));if(f!=""){c+=f;}else{c="";this.errorCode=2;this.errorMsg="Unvalid data";break;}}c+=this.retrievePattern("A");}return c;};mCR_SymbologyCodaBar.prototype.retrievePattern=function(a){var b="";switch(a){case"0":b="nnnnnwwn";break;case"1":b="nnnnwwnn";break;case"2":b="nnnwnnwn";break;case"3":b="wwnnnnnn";break;case"4":b="nnwnnwnn";break;case"5":b="wnnnnwnn";break;case"6":b="nwnnnnwn";break;case"7":b="nwnnwnnn";break;case"8":b="nwwnnnnn";break;case"9":b="wnnwnnnn";break;case"-":b="nnnwwnnn";break;case"$":b="nnwwnnnn";break;case":":b="wnnnwnwn";break;case"/":b="wnwnnnwn";break;case".":b="wnwmwnnn";break;case"+":b="nnwnwnwn";break;case"A":b="nnwwnwnn";break;case"B":b="nwnwnnwn";break;case"C":b="nnnwnwwn";break;case"D":b="nnnwwwnn";break;}return b;};function mCR_SymbologyCode11(a,d,b,c){mCR_Symbology.call(this,a,d,b,c);this._START=11;this._STOP=12;}mCR_SymbologyCode11.prototype=Object.create(mCR_Symbology.prototype);mCR_SymbologyCode11.prototype.constructor=mCR_SymbologyCode11;mCR_SymbologyCode11.prototype.drawBarcode=function(){var a=this.createPattern(this.barcode.text);if(this.errorCode==0){this.drawPattern(a);}else{this.drawErrorMsg();}};mCR_SymbologyCode11.prototype.drawPattern=function(b){var a=this.getDimension(b);this.drawBSPattern(b,a);};mCR_SymbologyCode11.prototype.drawBSPattern=function(b,a){switch(this.barcode.barcodeAngle){case 0:this.drawBSPatternAngle0(b,a);break;case 1:this.drawBSPatternAngle90(b,a);break;case 2:this.drawBSPatternAngle180(b,a);break;case 3:this.drawBSPatternAngle270(b,a);break;}};mCR_SymbologyCode11.prototype.drawBSPatternAngle0=function(g,f){var a=this.rect.left;var d=g.length;var c=0;for(var b=0;b<d;b++){if(g.charAt(b)=="b"){c+=f;}else{if(c!=0){this.drawBarAngle0(a,c);a=a+c;}c=0;a=a+f;}}if(c!=0){this.drawBarAngle0(a,c);}};mCR_SymbologyCode11.prototype.drawBSPatternAngle90=function(g,f){var a=(this.rect.top+this.rect.getHeight());var d=g.length;var c=0;for(var b=0;b<d;b++){if(g.charAt(b)=="b"){c+=f;}else{if(c!=0){this.drawBarAngle90(a,c);a=a-c;}c=0;a=a-f;}}if(c!=0){this.drawBarAngle90(a,c);}};mCR_SymbologyCode11.prototype.drawBSPatternAngle180=function(g,f){var a=(this.rect.left+this.rect.getWidth());var d=g.length;var c=0;for(var b=0;b<d;b++){if(g.charAt(b)=="b"){c+=f;}else{if(c!=0){this.drawBarAngle180(a,c);a=a-c;}c=0;a=a-f;}}if(c!=0){this.drawBarAngle180(a,c);}};mCR_SymbologyCode11.prototype.drawBSPatternAngle270=function(g,f){var a=(this.rect.top);var d=g.length;var c=0;for(var b=0;b<d;b++){if(g.charAt(b)=="b"){c+=f;}else{if(c!=0){this.drawBarAngle270(a,c);a=a+c;}c=0;a=a+f;}}if(c!=0){this.drawBarAngle270(a,c);}};mCR_SymbologyCode11.prototype.getDimension=function(d){var a=d.length;var b=this.getBarcodeWidth();var c=0;if(this.barcode.optResolution){c=Math.floor((b/a));if(c<1){c=1;}}else{c=(b/a);}return c;};mCR_SymbologyCode11.prototype.createPattern=function(k){var f="";var l=0;var g=0;f+=this.retrievePattern(this._START);var j=k.length;for(var i=0;i<j;i++){var h=k.charAt(i);var a=this.getCharacterCode(h);if(a!=-1){f+=this.retrievePattern(a);l+=(a*(j-i));g+=(a*(j-i+1));}else{this.errorCode=2;this.errorMsg="Unvalid data";break;}}var d=l%11;g+=d;var b=g%11;f+=this.retrievePattern(d);f+=this.retrievePattern(b);f+=this.retrievePattern(this._STOP);return f;};mCR_SymbologyCode11.prototype.getCharacterCode=function(b){var a=-1;switch(b){case"0":a=0;break;case"1":a=1;break;case"2":a=2;break;case"3":a=3;break;case"4":a=4;break;case"5":a=5;break;case"6":a=6;break;case"7":a=7;break;case"8":a=8;break;case"9":a=9;break;case"-":a=10;break;}return a;};mCR_SymbologyCode11.prototype.retrievePattern=function(a){var b="";switch(a){case 0:b="bsbsbbs";break;case 1:b="bbsbsbbs";break;case 2:b="bssbsbbs";break;case 3:b="bbssbsbs";break;case 4:b="bsbbsbbs";break;case 5:b="bbsbbsbs";break;case 6:b="bssbbsbs";break;case 7:b="bsbssbbs";break;case 8:b="bbsbssbs";break;case 9:b="bbsbsbs";break;case 10:b="bsbbsbs";break;case this._START:b="bsbbssbs";break;case this._STOP:b="bsbbssb";break;}return b;};function mCR_SymbologyCode128(a,d,b,c){mCR_Symbology.call(this,a,d,b,c);this.codeset=null;this.CODESET_A=0;this.CODESET_B=1;this.CODESET_C=2;this.SHIFT=98;this.CODE_C=99;this.CODE_B=100;this.CODE_A=101;this.FNC1=102;this.START_A=103;this.START_B=104;this.START_C=105;this.STOP=106;}mCR_SymbologyCode128.prototype=Object.create(mCR_Symbology.prototype);mCR_SymbologyCode128.prototype.constructor=mCR_SymbologyCode128;mCR_SymbologyCode128.prototype.drawBarcode=function(){var a=this.createPattern(this.barcode.text);if(this.errorCode==0){this.drawPattern(a);}else{this.drawErrorMsg();}};mCR_SymbologyCode128.prototype.drawPattern=function(b){var a=this.getDimension(b);this.drawBSPattern(b,a);};mCR_SymbologyCode128.prototype.drawBSPattern=function(b,a){switch(this.barcode.barcodeAngle){case 0:this.drawBSPatternAngle0(b,a);break;case 1:this.drawBSPatternAngle90(b,a);break;case 2:this.drawBSPatternAngle180(b,a);break;case 3:this.drawBSPatternAngle270(b,a);break;}};mCR_SymbologyCode128.prototype.drawBSPatternAngle0=function(g,f){var a=this.rect.left;var d=g.length;var c=0;for(var b=0;b<d;b++){if(g.charAt(b)=="b"){c+=f;}else{if(c!=0){this.drawBarAngle0(a,c);a=a+c;}c=0;a=a+f;}}if(c!=0){this.drawBarAngle0(a,c);}};mCR_SymbologyCode39.prototype.drawBSPatternAngle90=function(g,f){var a=(this.rect.top+this.rect.getHeight());var d=g.length;var c=0;for(var b=0;b<d;b++){if(g.charAt(b)=="b"){c+=f;}else{if(c!=0){this.drawBarAngle90(a,c);a=a-c;}c=0;a=a-f;}}if(c!=0){this.drawBarAngle90(a,c);}};mCR_SymbologyCode128.prototype.drawBSPatternAngle180=function(g,f){var a=(this.rect.left+this.rect.getWidth());var d=g.length;var c=0;for(var b=0;b<d;b++){if(g.charAt(b)=="b"){c+=f;}else{if(c!=0){this.drawBarAngle180(a,c);a=a-c;}c=0;a=a-f;}}if(c!=0){this.drawBarAngle180(a,c);}};mCR_SymbologyCode39.prototype.drawBSPatternAngle270=function(g,f){var a=(this.rect.top);var d=g.length;var c=0;for(var b=0;b<d;b++){if(g.charAt(b)=="b"){c+=f;}else{if(c!=0){this.drawBarAngle270(a,c);a=a+c;}c=0;a=a+f;}}if(c!=0){this.drawBarAngle270(a,c);}};mCR_SymbologyCode128.prototype.getDimension=function(d){var a=d.length;var b=this.getBarcodeWidth();var c=0;if(this.barcode.optResolution){c=Math.floor((b/a));if(c<1){c=1;}}else{c=(b/a);}return c;};mCR_SymbologyCode128.prototype.createPattern=function(q){var o="";var k=q.length;if(k==0){this.errorCode=1;this.errorMsg="value size error";}else{this.intiCodeset(q);var p=0;var n=1;o+=this.getStartPattern();p+=this.getStartCode();for(var l=0;l<k;l++){if(this.codeset==this.CODESET_C){if(l<k-1){var d=q.charAt(l);var c=q.charAt(l+1);if(this.isNum(d)&&this.isNum(c)){var m=d-"0";var j=c-"0";var b=(m*10)+j;l++;o+=this.retrievePattern(b);p+=(b*n);n++;}else{var b=this.getCharacterCodeB(d);if(b!=-1){this.codeset=this.CODESET_B;o+=this.retrievePattern(this.CODE_B);p+=(this.CODE_B*n);n++;o+=this.retrievePattern(b);p+=(b*n);n++;}else{b=this.getCharacterCodeA(d);if(b!=-1){this.codeset=this.CODESET_A;o+=this.retrievePattern(this.CODE_A);p+=(this.CODE_A*n);n++;o+=this.retrievePattern(b);p+=(b*n);n++;}else{this.errorCode=2;this.errorMsg="Unvalid data";}}}}else{var d=q.charAt(l);this.codeset=this.CODESET_B;o+=this.retrievePattern(this.CODE_B);p+=(this.CODE_B*n);n++;var b=this.getCharacterCodeB(d);o+=this.retrievePattern(b);p+=(b*n);n++;}}else{if(this.codeset==this.CODESET_A){var f=0;for(var g=l;g<k;g++){var a=q.charAt(g);if(this.isNum(a)==true){f++;}else{break;}}if(f>5&&f%2==0){this.codeset=this.CODESET_C;o+=this.retrievePattern(this.CODE_C);p+=(this.CODE_C*n);n++;var d=q.charAt(l);var c=q.charAt(l+1);var m=d-"0";var j=c-"0";var b=(m*10)+j;l++;o+=this.retrievePattern(b);p+=(b*n);n++;}else{var d=q.charAt(l);var b=this.getCharacterCodeA(d);if(b!=-1){o+=this.retrievePattern(b);p+=(b*n);n++;}else{b=this.getCharacterCodeB(d);if(b!=-1){this.codeset=this.CODESET_B;o+=this.retrievePattern(this.CODE_B);p+=(this.CODE_B*n);n++;o+=this.retrievePattern(b);p+=(b*n);n++;}else{this.errorCode=2;this.errorMsg="Unvalid data";}}}}else{if(this.codeset==this.CODESET_B){var f=0;for(var g=l;g<k;g++){var a=q.charAt(g);if(this.isNum(a)==true){f++;}else{break;}}if(f>5&&f%2==0){this.codeset=this.CODESET_C;o+=this.retrievePattern(this.CODE_C);p+=(this.CODE_C*n);n++;var d=q.charAt(l);var c=q.charAt(l+1);var m=d-"0";var j=c-"0";var b=(m*10)+j;l++;o+=this.retrievePattern(b);p+=(b*n);n++;}else{var d=q.charAt(l);var b=this.getCharacterCodeB(d);if(b!=-1){o+=this.retrievePattern(b);p+=(b*n);n++;}else{b=this.getCharacterCodeA(d);if(b!=-1){this.codeset=this.CODESET_A;o+=this.retrievePattern(this.CODE_A);p+=(this.CODE_A*n);n++;o+=this.retrievePattern(b);p+=(b*n);n++;}else{this.errorCode=2;this.errorMsg="Unvalid data";}}}}}}}var h=p%103;o+=this.retrievePattern(h);o+=this.getStopPattern();}return o;};mCR_SymbologyCode128.prototype.intiCodeset=function(g){this.codeset=this.CODESET_B;var f=g.length;if(f==2){var d=g.charAt(0);var c=g.charAt(1);if(this.isNum(d)&&this.isNum(c)){this.codeset=this.CODESET_C;}}else{if(f>=4){var d=g.charAt(0);var c=g.charAt(1);var b=g.charAt(2);var a=g.charAt(3);if(this.isNum(d)&&this.isNum(c)&&this.isNum(b)&&this.isNum(a)){this.codeset=this.CODESET_C;}}}if(this.codeset==this.CODESET_B){if(this.getCharacterCodeB(g.charAt(0))==-1){this.codeset=this.CODESET_A;}}};mCR_SymbologyCode128.prototype.getStartCode=function(){var a=this.START_B;switch(this.codeset){case this.CODESET_A:a=this.START_A;break;case this.CODESET_B:a=this.START_B;break;case this.CODESET_C:a=this.START_C;break;}return a;};mCR_SymbologyCode128.prototype.isNum=function(a){if(a>="0"&&a<="9"){return true;}else{return false;}};mCR_SymbologyCode128.prototype.getStartPattern=function(){return this.retrievePattern(this.getStartCode());};mCR_SymbologyCode128.prototype.getStopPattern=function(){return this.retrievePattern(this.STOP);};mCR_SymbologyCode128.prototype.getFNCPattern=function(){return this.retrievePattern(this.FNC1);};mCR_SymbologyCode128.prototype.getCharacterCodeA=function(a){var b=-1;switch(a){case" ":b=0;break;case"!":b=1;break;case'"':b=2;break;case"#":b=3;break;case"$":b=4;break;case"%":b=5;break;case"&":b=6;break;case"'":b=7;break;case"(":b=8;break;case")":b=9;break;case"*":b=10;break;case"+":b=11;break;case",":b=12;break;case"-":b=13;break;case".":b=14;break;case"/":b=15;break;case"0":b=16;break;case"1":b=17;break;case"2":b=18;break;case"3":b=19;break;case"4":b=20;break;case"5":b=21;break;case"6":b=22;break;case"7":b=23;break;case"8":b=24;break;case"9":b=25;break;case":":b=26;break;case";":b=27;break;case"<":b=28;break;case"=":b=29;break;case">":b=30;break;case"?":b=31;break;case"@":b=32;break;case"A":b=33;break;case"B":b=34;break;case"C":b=35;break;case"D":b=36;break;case"E":b=37;break;case"F":b=38;break;case"G":b=39;break;case"H":b=40;break;case"I":b=41;break;case"J":b=42;break;case"K":b=43;break;case"L":b=44;break;case"M":b=45;break;case"N":b=46;break;case"O":b=47;break;case"P":b=48;break;case"Q":b=49;break;case"R":b=50;break;case"S":b=51;break;case"T":b=52;break;case"U":b=53;break;case"V":b=54;break;case"W":b=55;break;case"X":b=56;break;case"Y":b=57;break;case"Z":b=58;break;case"[":b=59;break;case"\\":b=60;break;case"]":b=61;break;case"^":b=62;break;case"_":b=63;break;case 0:b=64;break;case 1:b=65;break;case 2:b=66;break;case 3:b=67;break;case 4:b=68;break;case 5:b=69;break;case 6:b=70;break;case 7:b=71;break;case 8:b=72;break;case 9:b=73;break;case 10:b=74;break;case 11:b=75;break;case 12:b=76;break;case 13:b=77;break;case 14:b=78;break;case 15:b=79;break;case 16:b=80;break;case 17:b=81;break;case 18:b=82;break;case 19:b=83;break;case 20:b=84;break;case 21:b=85;break;case 22:b=86;break;case 23:b=87;break;case 24:b=88;break;case 25:b=89;break;case 26:b=90;break;case 27:b=91;break;case 28:b=92;break;case 29:b=93;break;case 30:b=94;break;case 31:b=95;break;}return b;};mCR_SymbologyCode128.prototype.getCharacterCodeB=function(a){var b=-1;switch(a){case" ":b=0;break;case"!":b=1;break;case'"':b=2;break;case"#":b=3;break;case"$":b=4;break;case"%":b=5;break;case"&":b=6;break;case"'":b=7;break;case"(":b=8;break;case")":b=9;break;case"*":b=10;break;case"+":b=11;break;case",":b=12;break;case"-":b=13;break;case".":b=14;break;case"/":b=15;break;case"0":b=16;break;case"1":b=17;break;case"2":b=18;break;case"3":b=19;break;case"4":b=20;break;case"5":b=21;break;case"6":b=22;break;case"7":b=23;break;case"8":b=24;break;case"9":b=25;break;case":":b=26;break;case";":b=27;break;case"<":b=28;break;case"=":b=29;break;case">":b=30;break;case"?":b=31;break;case"@":b=32;break;case"A":b=33;break;case"B":b=34;break;case"C":b=35;break;case"D":b=36;break;case"E":b=37;break;case"F":b=38;break;case"G":b=39;break;case"H":b=40;break;case"I":b=41;break;case"J":b=42;break;case"K":b=43;break;case"L":b=44;break;case"M":b=45;break;case"N":b=46;break;case"O":b=47;break;case"P":b=48;break;case"Q":b=49;break;case"R":b=50;break;case"S":b=51;break;case"T":b=52;break;case"U":b=53;break;case"V":b=54;break;case"W":b=55;break;case"X":b=56;break;case"Y":b=57;break;case"Z":b=58;break;case"[":b=59;break;case"\\":b=60;break;case"]":b=61;break;case"^":b=62;break;case"_":b=63;break;case"`":b=64;break;case"a":b=65;break;case"b":b=66;break;case"c":b=67;break;case"d":b=68;break;case"e":b=69;break;case"f":b=70;break;case"g":b=71;break;case"h":b=72;break;case"i":b=73;break;case"j":b=74;break;case"k":b=75;break;case"l":b=76;break;case"m":b=77;break;case"n":b=78;break;case"o":b=79;break;case"p":b=80;break;case"q":b=81;break;case"r":b=82;break;case"s":b=83;break;case"t":b=84;break;case"u":b=85;break;case"v":b=86;break;case"w":b=87;break;case"x":b=88;break;case"y":b=89;break;case"z":b=90;break;case"{":b=91;break;case"|":b=92;break;case"}":b=93;break;case"~":b=94;break;case 127:b=95;break;}return b;};mCR_SymbologyCode128.prototype.retrievePattern=function(a){var b="";switch(a){case 0:b="bbsbbssbbss";break;case 1:b="bbssbbsbbss";break;case 2:b="bbssbbssbbs";break;case 3:b="bssbssbbsss";break;case 4:b="bssbsssbbss";break;case 5:b="bsssbssbbss";break;case 6:b="bssbbssbsss";break;case 7:b="bssbbsssbss";break;case 8:b="bsssbbssbss";break;case 9:b="bbssbssbsss";break;case 10:b="bbssbsssbss";break;case 11:b="bbsssbssbss";break;case 12:b="bsbbssbbbss";break;case 13:b="bssbbsbbbss";break;case 14:b="bssbbssbbbs";break;case 15:b="bsbbbssbbss";break;case 16:b="bssbbbsbbss";break;case 17:b="bssbbbssbbs";break;case 18:b="bbssbbbssbs";break;case 19:b="bbssbsbbbss";break;case 20:b="bbssbssbbbs";break;case 21:b="bbsbbbssbss";break;case 22:b="bbssbbbsbss";break;case 23:b="bbbsbbsbbbs";break;case 24:b="bbbsbssbbss";break;case 25:b="bbbssbsbbss";break;case 26:b="bbbssbssbbs";break;case 27:b="bbbsbbssbss";break;case 28:b="bbbssbbsbss";break;case 29:b="bbbssbbssbs";break;case 30:b="bbsbbsbbsss";break;case 31:b="bbsbbsssbbs";break;case 32:b="bbsssbbsbbs";break;case 33:b="bsbsssbbsss";break;case 34:b="bsssbsbbsss";break;case 35:b="bsssbsssbbs";break;case 36:b="bsbbsssbsss";break;case 37:b="bsssbbsbsss";break;case 38:b="bsssbbsssbs";break;case 39:b="bbsbsssbsss";break;case 40:b="bbsssbsbsss";break;case 41:b="bbsssbsssbs";break;case 42:b="bsbbsbbbsss";break;case 43:b="bsbbsssbbbs";break;case 44:b="bsssbbsbbbs";break;case 45:b="bsbbbsbbsss";break;case 46:b="bsbbbsssbbs";break;case 47:b="bsssbbbsbbs";break;case 48:b="bbbsbbbsbbs";break;case 49:b="bbsbsssbbbs";break;case 50:b="bbsssbsbbbs";break;case 51:b="bbsbbbsbsss";break;case 52:b="bbsbbbsssbs";break;case 53:b="bbsbbbsbbbs";break;case 54:b="bbbsbsbbsss";break;case 55:b="bbbsbsssbbs";break;case 56:b="bbbsssbsbbs";break;case 57:b="bbbsbbsbsss";break;case 58:b="bbbsbbsssbs";break;case 59:b="bbbsssbbsbs";break;case 60:b="bbbsbbbbsbs";break;case 61:b="bbssbssssbs";break;case 62:b="bbbbsssbsbs";break;case 63:b="bsbssbbssss";break;case 64:b="bsbssssbbss";break;case 65:b="bssbsbbssss";break;case 66:b="bssbssssbbs";break;case 67:b="bssssbsbbss";break;case 68:b="bssssbssbbs";break;case 69:b="bsbbssbssss";break;case 70:b="bsbbssssbss";break;case 71:b="bssbbsbssss";break;case 72:b="bssbbssssbs";break;case 73:b="bssssbbsbss";break;case 74:b="bssssbbssbs";break;case 75:b="bbssssbssbs";break;case 76:b="bbssbsbssss";break;case 77:b="bbbbsbbbsbs";break;case 78:b="bbssssbsbss";break;case 79:b="bsssbbbbsbs";break;case 80:b="bsbssbbbbss";break;case 81:b="bssbsbbbbss";break;case 82:b="bssbssbbbbs";break;case 83:b="bsbbbbssbss";break;case 84:b="bssbbbbsbss";break;case 85:b="bssbbbbssbs";break;case 86:b="bbbbsbssbss";break;case 87:b="bbbbssbsbss";break;case 88:b="bbbbssbssbs";break;case 89:b="bbsbbsbbbbs";break;case 90:b="bbsbbbbsbbs";break;case 91:b="bbbbsbbsbbs";break;case 92:b="bsbsbbbbsss";break;case 93:b="bsbsssbbbbs";break;case 94:b="bsssbsbbbbs";break;case 95:b="bsbbbbsbsss";break;case 96:b="bsbbbbsssbs";break;case 97:b="bbbbsbsbsss";break;case 98:b="bbbbsbsssbs";break;case 99:b="bsbbbsbbbbs";break;case 100:b="bsbbbbsbbbs";break;case 101:b="bbbsbsbbbbs";break;case 102:b="bbbbsbsbbbs";break;case 103:b="bbsbssssbss";break;case 104:b="bbsbssbssss";break;case 105:b="bbsbssbbbss";break;case 106:b="bbsssbbbsbsbb";break;}return b;};function mCR_SymbologyCode128A(a,d,b,c){mCR_SymbologyCode128.call(this,a,d,b,c);}mCR_SymbologyCode128A.prototype=Object.create(mCR_SymbologyCode128.prototype);mCR_SymbologyCode128A.prototype.constructor=mCR_SymbologyCode128A;mCR_SymbologyCode128A.prototype.intiCodeset=function(a){this.codeset=this.CODESET_A;};function mCR_SymbologyCode128B(a,d,b,c){mCR_SymbologyCode128.call(this,a,d,b,c);}mCR_SymbologyCode128B.prototype=Object.create(mCR_SymbologyCode128.prototype);mCR_SymbologyCode128B.prototype.constructor=mCR_SymbologyCode128B;mCR_SymbologyCode128B.prototype.intiCodeset=function(a){this.codeset=this.CODESET_B;};function mCR_SymbologyCode128C(a,d,b,c){mCR_SymbologyCode128.call(this,a,d,b,c);}mCR_SymbologyCode128C.prototype=Object.create(mCR_SymbologyCode128.prototype);mCR_SymbologyCode128C.prototype.constructor=mCR_SymbologyCode128C;mCR_SymbologyCode128C.prototype.intiCodeset=function(a){this.codeset=this.CODESET_C;};function mCR_Symbology2of5(a,d,b,c){mCR_Symbology.call(this,a,d,b,c);}mCR_Symbology2of5.prototype=Object.create(mCR_Symbology.prototype);mCR_Symbology2of5.prototype.constructor=mCR_Symbology2of5;mCR_Symbology2of5.prototype.drawBarcode=function(){};mCR_Symbology2of5.prototype.createPattern=function(a){return"";};mCR_Symbology2of5.prototype.retrievePattern=function(a){var b="";switch(a){case"0":b="NNWWN";break;case"1":b="WNNNW";break;case"2":b="NWNNW";break;case"3":b="WWNNN";break;case"4":b="NNWNW";break;case"5":b="WNWNN";break;case"6":b="NWWNN";break;case"7":b="NNNWW";break;case"8":b="WNNWN";break;case"9":b="NWNWN";break;}return b;};function mCR_Symbology2of5Matrix(a,d,b,c){mCR_Symbology2of5.call(this,a,d,b,c);}mCR_Symbology2of5Matrix.prototype=Object.create(mCR_Symbology2of5.prototype);mCR_Symbology2of5Matrix.prototype.constructor=mCR_Symbology2of5Matrix;mCR_Symbology2of5Matrix.prototype.drawBarcode=function(){var a=this.createPattern(this.barcode.text);if(this.errorCode==0){this.drawPattern(a);}else{this.drawErrorMsg();}};mCR_Symbology2of5Matrix.prototype.drawPattern=function(b){var a=this.getDimension(b);this.drawNWPattern(b,a);};mCR_Symbology2of5Matrix.prototype.drawNWPattern=function(b,a){switch(this.barcode.barcodeAngle){case 0:this.drawNWPatternAngle0(b,a);break;case 1:this.drawNWPatternAngle90(b,a);break;case 2:this.drawNWPatternAngle180(b,a);break;case 3:this.drawNWPatternAngle270(b,a);break;}};mCR_Symbology2of5Matrix.prototype.drawNWPatternAngle0=function(g,f){var a=this.rect.left;var d=g.length;for(var b=0;b<d;b++){var c=this.getBarWidth(g.charAt(b),f);if(b%2==0){this.drawBarAngle0(a,c);}a=a+c;}};mCR_Symbology2of5Matrix.prototype.drawNWPatternAngle90=function(g,f){var a=(this.rect.top+this.rect.getHeight());var d=g.length;for(var b=0;b<d;b++){var c=this.getBarWidth(g.charAt(b),f);if(b%2==0){this.drawBarAngle90(a,c);}a=a-c;}};mCR_Symbology2of5Matrix.prototype.drawNWPatternAngle180=function(g,f){var a=(this.rect.left+this.rect.getWidth());var d=g.length;for(var b=0;b<d;b++){var c=this.getBarWidth(g.charAt(b),f);if(b%2==0){this.drawBarAngle180(a,c);}a=a-c;}};mCR_Symbology2of5Matrix.prototype.drawNWPatternAngle270=function(g,f){var a=(this.rect.top);var d=g.length;for(var b=0;b<d;b++){var c=this.getBarWidth(g.charAt(b),f);if(b%2==0){this.drawBarAngle270(a,c);}a=a+c;}};mCR_Symbology2of5Matrix.prototype.getBarWidth=function(b,d){var a;var c=this.barcode.wideRatio;if(b=="n"||b=="N"){a=d;}else{a=d*c;}return a;};mCR_Symbology2of5Matrix.prototype.getDimension=function(c){var d=this.getBarModuleSize(c);var a=this.getBarcodeWidth();var b=0;if(this.barcode.optResolution){b=Math.floor((a/d));if(b<1){b=1;}}else{b=(a/d);}return b;};mCR_Symbology2of5Matrix.prototype.getBarModuleSize=function(d){var g=d.length;var a=0;for(var b=0;b<g;b++){if(d.charAt(b)=="W"){a++;}}var c=this.barcode.wideRatio;var f=g+(a*(c-1));return f;};mCR_Symbology2of5Matrix.prototype.createPattern=function(f){var d="";d+=this.startCode();var a=f.length;for(var g=0;g<a;g++){var b=f.charAt(g);var c=this.retrievePattern(b);d+=c;d+="n";}d+=this.endCode();return d;};mCR_Symbology2of5Matrix.prototype.startCode=function(){return"WNNNNn";};mCR_Symbology2of5Matrix.prototype.endCode=function(){return"WNNNN";};function mCR_Symbology2of5Industrial(a,d,b,c){mCR_Symbology2of5Matrix.call(this,a,d,b,c);}mCR_Symbology2of5Industrial.prototype=Object.create(mCR_Symbology2of5Matrix.prototype);mCR_Symbology2of5Industrial.prototype.constructor=mCR_Symbology2of5Industrial;mCR_Symbology2of5Industrial.prototype.createPattern=function(j){var g="";g+=this.startCode();var i=j.length;for(var h=0;h<i;h++){var c=j.charAt(h);var d=this.retrievePattern(c);g+=d;}g+=this.endCode();var f="";var b=g.length;for(var a=0;a<b;a++){f+=g.charAt(a);if(a<b-1){f+="n";}}return f;};mCR_Symbology2of5Industrial.prototype.startCode=function(){return"WWN";};mCR_Symbology2of5Industrial.prototype.endCode=function(){return"WNW";};function mCR_Symbology2of5IATA(a,d,b,c){mCR_Symbology2of5Industrial.call(this,a,d,b,c);}mCR_Symbology2of5IATA.prototype=Object.create(mCR_Symbology2of5Industrial.prototype);mCR_Symbology2of5IATA.prototype.constructor=mCR_Symbology2of5IATA;mCR_Symbology2of5IATA.prototype.startCode=function(){return"NN";};mCR_Symbology2of5IATA.prototype.endCode=function(){return"WN";};function mCR_Symbology2of5Interleaved(a,d,b,c){mCR_Symbology2of5Matrix.call(this,a,d,b,c);}mCR_Symbology2of5Interleaved.prototype=Object.create(mCR_Symbology2of5Matrix.prototype);mCR_Symbology2of5Interleaved.prototype.constructor=mCR_Symbology2of5Interleaved;mCR_Symbology2of5Interleaved.prototype.createPattern=function(h){var d="";d+=this.startCode();var g=h.length;if(g%2==1){h="0"+h;g++;}for(var f=0;f<g;f+=2){var c=h.charAt(f);var b=h.charAt(f+1);var j=this.retrievePattern(c);var i=this.retrievePattern(b);for(var a=0;a<5;a++){d+=j.charAt(a);d+=i.charAt(a);}}d+=this.endCode();return d;};mCR_Symbology2of5Interleaved.prototype.startCode=function(){return"NNNN";};mCR_Symbology2of5Interleaved.prototype.endCode=function(){return"WNN";};function mCR_SymbologyEAN13(a,d,b,c){mCR_Symbology.call(this,a,d,b,c);this.parity_LeftOdd=0;this.parity_LeftEven=1;this.parity_Right=2;this.rectHalf=new docRect();this.rectFont=new docRect();this.checkMethod=false;this.fontHeight=null;this.fontSize=null;this.fontFamily=null;this.FontStyle=null;}mCR_SymbologyEAN13.prototype=Object.create(mCR_Symbology.prototype);mCR_SymbologyEAN13.prototype.constructor=mCR_SymbologyEAN13;mCR_SymbologyEAN13.prototype.drawBarcode=function(){var n=this.barcode.text;if(!this.checkValue(n)){this.errorCode=2;this.errorMsg="Unvalid data";}if(n.length==12){this.checkMethod=true;}else{if(n.length==13){this.checkMethod=false;}else{this.errorCode=1;this.errorMsg="value size error";}}if(this.errorCode==0){var l=0;var d=41;if(this.barcode.showText){this.fontSize=this.barcode.fontSize;this.fontFamily=this.barcode.fontName;this.FontStyle=this.barcode.fontBold;d=this.barcode.fontSize*1.32814;this.fontHeight=d;}this.rectHalf.copyRect(this.rect);this.rectFont.copyRect(this.rect);switch(this.barcode.barcodeAngle){case 2:this.rect.top=this.rect.top+d*2.64;this.rectHalf.top=this.rectHalf.top+(d*2.64/2);break;case 0:this.rect.bottom=this.rect.bottom-d*2.64;this.rectHalf.bottom=this.rectHalf.bottom-(d*2.64/2);break;case 3:this.rect.left=this.rect.left+d*2.64;this.rectHalf.left=this.rectHalf.left+(d*2.64/2);break;case 1:this.rect.right=this.rect.right-d*2.64;this.rectHalf.right=this.rectHalf.right-(d*2.64/2);break;}var c=new Array();var o=n.charAt(0);var a="";a+=o;var g=this.getCharacterCode(o);var f=this.getParityType(g);l=g;c.push(new BarcodeEAN_Pattern("sssssss",a));c.push(new BarcodeEAN_Pattern("bsb",""));for(var m=1;m<=6;m++){var j=n.charAt(m);var b=this.getCharacterCode(j);var k=this.retrievePattern(b,f[m-1]);var p="";p+=j;c.push(new BarcodeEAN_Pattern(k,p));var h=((m%2)==1)?3:1;l+=b*h;}c.push(new BarcodeEAN_Pattern("s"," "));c.push(new BarcodeEAN_Pattern("bsbs",""));for(var m=7;m<=11;m++){var j=n.charAt(m);var b=this.getCharacterCode(j);var k=this.retrievePattern(b,this.parity_Right);var p="";p+=j;c.push(new BarcodeEAN_Pattern(k,p));var h=((m%2)==1)?3:1;l+=b*h;}if(this.checkMethod){var i=10-(l%10);if(i==10){i=0;}c.push(new BarcodeEAN_Pattern(this.retrievePattern(i,this.parity_Right),i.toString()));}else{var j=n.charAt(12);var b=this.getCharacterCode(j);var k=this.retrievePattern(b,this.parity_Right);var p="";p+=j;c.push(new BarcodeEAN_Pattern(k,p));}c.push(new BarcodeEAN_Pattern("bsb",""));this.drawPattern(c);}else{this.drawErrorMsg();}};mCR_SymbologyEAN13.prototype.getParityType=function(b){var a=new Array();switch(b){case 0:a.push(this.parity_LeftOdd);a.push(this.parity_LeftOdd);a.push(this.parity_LeftOdd);a.push(this.parity_LeftOdd);a.push(this.parity_LeftOdd);a.push(this.parity_LeftOdd);break;case 1:a.push(this.parity_LeftOdd);a.push(this.parity_LeftOdd);a.push(this.parity_LeftEven);a.push(this.parity_LeftOdd);a.push(this.parity_LeftEven);a.push(this.parity_LeftEven);break;case 2:a.push(this.parity_LeftOdd);a.push(this.parity_LeftOdd);a.push(this.parity_LeftEven);a.push(this.parity_LeftEven);a.push(this.parity_LeftOdd);a.push(this.parity_LeftEven);break;case 3:a.push(this.parity_LeftOdd);a.push(this.parity_LeftOdd);a.push(this.parity_LeftEven);a.push(this.parity_LeftEven);a.push(this.parity_LeftEven);a.push(this.parity_LeftOdd);break;case 4:a.push(this.parity_LeftOdd);a.push(this.parity_LeftEven);a.push(this.parity_LeftOdd);a.push(this.parity_LeftOdd);a.push(this.parity_LeftEven);a.push(this.parity_LeftEven);break;case 5:a.push(this.parity_LeftOdd);a.push(this.parity_LeftEven);a.push(this.parity_LeftEven);a.push(this.parity_LeftOdd);a.push(this.parity_LeftOdd);a.push(this.parity_LeftEven);break;case 6:a.push(this.parity_LeftOdd);a.push(this.parity_LeftEven);a.push(this.parity_LeftEven);a.push(this.parity_LeftEven);a.push(this.parity_LeftOdd);a.push(this.parity_LeftOdd);break;case 7:a.push(this.parity_LeftOdd);a.push(this.parity_LeftEven);a.push(this.parity_LeftOdd);a.push(this.parity_LeftEven);a.push(this.parity_LeftOdd);a.push(this.parity_LeftEven);break;case 8:a.push(this.parity_LeftOdd);a.push(this.parity_LeftEven);a.push(this.parity_LeftOdd);a.push(this.parity_LeftEven);a.push(this.parity_LeftEven);a.push(this.parity_LeftOdd);break;case 9:a.push(this.parity_LeftOdd);a.push(this.parity_LeftEven);a.push(this.parity_LeftEven);a.push(this.parity_LeftOdd);a.push(this.parity_LeftEven);a.push(this.parity_LeftOdd);break;}return a;};mCR_SymbologyEAN13.prototype.drawPattern=function(b){var a=this.getDimension();this.drawBSPattern(b,a);};mCR_SymbologyEAN13.prototype.drawBSPattern=function(b,a){switch(this.barcode.barcodeAngle){case 0:this.drawBSPatternAngle0(b,a);break;case 1:this.drawBSPatternAngle90(b,a);break;case 2:this.drawBSPatternAngle180(b,a);break;case 3:this.drawBSPatternAngle270(b,a);break;}};mCR_SymbologyEAN13.prototype.drawBSPatternAngle0=function(a,k){var h=this.rect.left;var b=0;var i="";var f=a.length;for(var c=0;c<f;c++){var n=a[c];var g=n.getPattern();var m=n.getText();var l=0;if(this.barcode.showText){l=n.getHalfStatus()?this.rectHalf.getHeight():this.rect.getHeight();}else{l=this.rect.getHeight();}if(m!=""&&m!=" "){i+=m;}var j=g.length;for(var d=0;d<j;d++){if(g.charAt(d)=="b"){b+=k;}else{if(b!=0){this.drawBarAngle0(h,b,l);h=h+b;}b=0;h=h+k;}}if(b!=0){this.drawBarAngle0(h,b,l);}}if(this.barcode.showText){this.drawFontAngle0(i);}};mCR_SymbologyEAN13.prototype.drawBSPatternAngle90=function(a,k){var h=this.rect.bottom;var b=0;var i="";var f=a.length;for(var c=0;c<f;c++){var n=a[c];var g=n.getPattern();var m=n.getText();var l=n.getHalfStatus()?this.rectHalf.getWidth():this.rect.getWidth();if(m!=""&&m!=" "){i+=m;}var j=g.length;for(var d=0;d<j;d++){if(g.charAt(d)=="b"){b+=k;}else{if(b!=0){this.drawBarAngle90(h,b,l);h=h-b;}b=0;h=h-k;}}if(b!=0){this.drawBarAngle90(h,b,l);}}if(this.barcode.showText){this.drawFontAngle90(i);}};mCR_SymbologyEAN13.prototype.drawBSPatternAngle180=function(a,k){var h=this.rect.right;var b=0;var i="";var f=a.length;for(var c=0;c<f;c++){var n=a[c];var g=n.getPattern();var m=n.getText();var l=n.getHalfStatus()?this.rectHalf.getHeight():this.rect.getHeight();var o=n.getHalfStatus()?this.rectHalf.top:this.rect.top;if(m!=""&&m!=" "){i+=m;}var j=g.length;for(var d=0;d<j;d++){if(g.charAt(d)=="b"){b+=k;}else{if(b!=0){this.drawBarAngle180(h,b,l,o);h=h-b;}b=0;h=h-k;}}if(b!=0){this.drawBarAngle180(h,b,l,o);}}if(this.barcode.showText){this.drawFontAngle180(i);}};mCR_SymbologyEAN13.prototype.drawBSPatternAngle270=function(b,l){var i=this.rect.top;var c=0;var j="";var g=b.length;for(var d=0;d<g;d++){var o=b[d];var h=o.getPattern();var n=o.getText();var m=o.getHalfStatus()?this.rectHalf.getWidth():this.rect.getWidth();var a=o.getHalfStatus()?this.rectHalf.left:this.rect.left;if(n!=""&&n!=" "){j+=n;}var k=h.length;for(var f=0;f<k;f++){if(h.charAt(f)=="b"){c+=l;}else{if(c!=0){this.drawBarAngle270(i,c,m,a);i=i+c;}c=0;i=i+l;}}if(c!=0){this.drawBarAngle270(i,c,m,a);}}if(this.barcode.showText){this.drawFontAngle270(j);}};mCR_SymbologyEAN13.prototype.drawFontAngle0=function(g){var a=document.createElement("canvas");var l=a.getContext("2d");var b="";if(this.FontStyle){b="bold "+this.fontHeight+"px "+this.fontFamily;}else{b=this.fontHeight+"px "+this.fontFamily;}l.font=b;var d=l.measureText("0").width*2.64;l=null;a=null;var j=this.getDimension(this.rectFont);var f=((j*3.5)-(d/2));var k=this.rectFont.left;var h=this.rectFont.bottom;for(var c=0;c<g.length;c++){this.drawBarCodeFontAngle0(k+f,h,b,g.substring(c,c+1));k+=(j*7);switch(c){case 0:k+=(j*3);break;case 6:k+=(j*5);break;}}};mCR_SymbologyEAN13.prototype.drawFontAngle90=function(g){var a=document.createElement("canvas");var l=a.getContext("2d");var b="";if(this.FontStyle){b="bold "+this.fontHeight+"px "+this.fontFamily;}else{b=this.fontHeight+"px "+this.fontFamily;}l.font=b;var d=l.measureText("0").width*2.64;l=null;a=null;var j=this.getDimension(this.rectFont);var f=((j*3.5)-(d/2));var k=this.rectFont.right;var h=this.rectFont.bottom;for(var c=0;c<g.length;c++){this.drawBarCodeFontAngle90(k,h-f,b,g.substring(c,c+1));h-=(j*7);switch(c){case 0:h-=(j*3);break;case 6:h-=(j*5);break;}}};mCR_SymbologyEAN13.prototype.drawFontAngle180=function(g){var a=document.createElement("canvas");var l=a.getContext("2d");var b="";if(this.FontStyle){b="bold "+this.fontHeight+"px "+this.fontFamily;}else{b=this.fontHeight+"px "+this.fontFamily;}l.font=b;var d=l.measureText("0").width*2.64;l=null;a=null;var j=this.getDimension(this.rectFont);var f=((j*3.5)-(d/2));var k=this.rectFont.right;var h=this.rectFont.top;for(var c=0;c<g.length;c++){this.drawBarCodeFontAngle180(k-f,h,b,g.substring(c,c+1));k-=(j*7);switch(c){case 0:k-=(j*3);break;case 6:k-=(j*5);break;}}};mCR_SymbologyEAN13.prototype.drawFontAngle270=function(g){var a=document.createElement("canvas");var l=a.getContext("2d");var b="";if(this.FontStyle){b="bold "+this.fontHeight+"px "+this.fontFamily;}else{b=this.fontHeight+"px "+this.fontFamily;}l.font=b;var d=l.measureText("0").width*2.64;l=null;a=null;var j=this.getDimension(this.rectFont);var f=((j*3.5)-(d/2));var k=this.rectFont.left;var h=this.rectFont.top;for(var c=0;c<g.length;c++){this.drawBarCodeFontAngle270(k,h+f,b,g.substring(c,c+1));h+=(j*7);switch(c){case 0:h+=(j*3);break;case 6:h+=(j*5);break;}}};mCR_SymbologyEAN13.prototype.getDimension=function(){var a=this.getBarcodeWidth();var b=0;if(this.barcode.optResolution){b=Math.floor((a/((13*7)+11+6)));if(b<1){b=1;}}else{b=(a/((13*7)+11+6));}return b;};mCR_SymbologyEAN13.prototype.createPattern=function(h){var g="";var f=h.length;if(f>2){if(h.charAt(0)=="*"&&h.charAt(f-1)=="*"){h=h.substring(1,f-2);f=h.length;}}if(f==0){this.errorCode=1;this.errorMsg="value size error";}else{var a=0;g=this.getStartPattern();for(var b=0;b<f;b++){var c=h.charAt(b);var d=this.getCharacterCode(c);if(d!=-1){g+=this.retrievePattern(d);a+=d;}else{this.errorCode=2;this.errorMsg="Unvalid data";g="";break;}}if(this.errorCode==0){g=g+this.getStopPattern();}}return g;};mCR_SymbologyEAN13.prototype.checkValue=function(f){var a=true;var c=f.length;for(var b=0;b<c;b++){var d=f.charAt(b);if(d<"0"||d>"9"){a=false;break;}}return a;};mCR_SymbologyEAN13.prototype.getCharacterCode=function(b){var a=-1;if(b>="0"&&b<="9"){a=b-"0";}return a;};mCR_SymbologyEAN13.prototype.retrievePattern=function(a,b){var c="";switch(b){case this.parity_LeftOdd:switch(a){case 0:c="sssbbsb";break;case 1:c="ssbbssb";break;case 2:c="ssbssbb";break;case 3:c="sbbbbsb";break;case 4:c="sbsssbb";break;case 5:c="sbbsssb";break;case 6:c="sbsbbbb";break;case 7:c="sbbbsbb";break;case 8:c="sbbsbbb";break;case 9:c="sssbsbb";break;}break;case this.parity_LeftEven:switch(a){case 0:c="sbssbbb";break;case 1:c="sbbssbb";break;case 2:c="ssbbsbb";break;case 3:c="sbssssb";break;case 4:c="ssbbbsb";break;case 5:c="sbbbssb";break;case 6:c="ssssbsb";break;case 7:c="ssbsssb";break;case 8:c="sssbssb";break;case 9:c="ssbsbbb";break;}break;case this.parity_Right:switch(a){case 0:c="bbbssbs";break;case 1:c="bbssbbs";break;case 2:c="bbsbbss";break;case 3:c="bssssbs";break;case 4:c="bsbbbss";break;case 5:c="bssbbbs";break;case 6:c="bsbssss";break;case 7:c="bsssbss";break;case 8:c="bssbsss";break;case 9:c="bbbsbss";break;}break;}return c;};function mCR_SymbologyEAN8(a,d,b,c){mCR_SymbologyEAN13.call(this,a,d,b,c);}mCR_SymbologyEAN8.prototype=Object.create(mCR_SymbologyEAN13.prototype);mCR_SymbologyEAN8.prototype.constructor=mCR_SymbologyEAN8;mCR_SymbologyEAN8.prototype.drawBarcode=function(){var m=this.barcode.text;if(!this.checkValue(m)){this.errorCode=2;this.errorMsg="Unvalid data";}if(m.length==7){this.checkMethod=true;}else{if(m.length==8){this.checkMethod=false;}else{this.errorCode=1;this.errorMsg="value size error";}}if(this.errorCode==0){var j=0;var d=41;if(this.barcode.showText){this.fontSize=this.barcode.fontSize;this.fontFamily=this.barcode.fontName;this.FontStyle=this.barcode.fontBold;d=this.barcode.fontSize*1.32814;this.fontHeight=d;}this.rectHalf.copyRect(this.rect);this.rectFont.copyRect(this.rect);switch(this.barcode.barcodeAngle){case 2:this.rect.top=this.rect.top+d*2.64;this.rectHalf.top=this.rectHalf.top+(d*2.64/2);break;case 0:this.rect.bottom=this.rect.bottom-d*2.64;this.rectHalf.bottom=this.rectHalf.bottom-(d*2.64/2);break;case 3:this.rect.left=this.rect.left+d*2.64;this.rectHalf.left=this.rectHalf.left+(d*2.64/2);break;case 1:this.rect.right=this.rect.right-d*2.64;this.rectHalf.right=this.rectHalf.right-(d*2.64/2);break;}var b=new Array();b.push(new BarcodeEAN_Pattern("bsb",""));for(var l=0;l<4;l++){var k=m.charAt(l);var a=this.getCharacterCode(k);var i=this.retrievePattern(a,this.parity_LeftOdd);var n="";n+=k;b.push(new BarcodeEAN_Pattern(i,n));var g=((l%2)==1)?1:3;j+=a*g;}b.push(new BarcodeEAN_Pattern("s"," "));b.push(new BarcodeEAN_Pattern("bsbs",""));for(var l=4;l<7;l++){var k=m.charAt(l);var a=this.getCharacterCode(k);var i=this.retrievePattern(a,this.parity_Right);var n="";n+=k;b.push(new BarcodeEAN_Pattern(i,n));var f=((l%2)==1)?1:3;j+=a*f;}if(this.checkMethod){var h=10-(j%10);if(h==10){h=0;}b.push(new BarcodeEAN_Pattern(this.retrievePattern(h,this.parity_Right),h.toString()));}else{var k=m.charAt(7);var a=this.getCharacterCode(k);var i=this.retrievePattern(a,this.parity_Right);var n="";n+=k;b.push(new BarcodeEAN_Pattern(i,n));}b.push(new BarcodeEAN_Pattern("bsb",""));this.drawPattern(b);}else{this.drawErrorMsg();}};mCR_SymbologyEAN8.prototype.drawFontAngle0=function(g){var a=document.createElement("canvas");var l=a.getContext("2d");var b="";if(this.FontStyle){b="bold "+this.fontHeight+"px "+this.fontFamily;}else{b=this.fontHeight+"px "+this.fontFamily;}l.font=b;var d=l.measureText("0").width*2.64;l=null;a=null;var j=this.getDimension(this.rectFont);var f=((j*3.5)-(d/2));var k=this.rectFont.left;var h=this.rectFont.bottom;k+=(j*3);for(var c=0;c<g.length;c++){this.drawBarCodeFontAngle0(k+f,h,b,g.substring(c,c+1));k+=(j*7);switch(c){case 3:k+=(j*5);break;}}};mCR_SymbologyEAN8.prototype.drawFontAngle90=function(g){var a=document.createElement("canvas");var l=a.getContext("2d");var b="";if(this.FontStyle){b="bold "+this.fontHeight+"px "+this.fontFamily;}else{b=this.fontHeight+"px "+this.fontFamily;}l.font=b;var d=l.measureText("0").width*2.64;l=null;a=null;var j=this.getDimension(this.rectFont);var f=((j*3.5)-(d/2));var k=this.rectFont.right;var h=this.rectFont.bottom;h-=(j*3);for(var c=0;c<g.length;c++){this.drawBarCodeFontAngle90(k,h-f,b,g.substring(c,c+1));h-=(j*7);switch(c){case 3:h-=(j*5);break;}}};mCR_SymbologyEAN8.prototype.drawFontAngle180=function(g){var a=document.createElement("canvas");var l=a.getContext("2d");var b="";if(this.FontStyle){b="bold "+this.fontHeight+"px "+this.fontFamily;}else{b=this.fontHeight+"px "+this.fontFamily;}l.font=b;var d=l.measureText("0").width*2.64;l=null;a=null;var j=this.getDimension(this.rectFont);var f=((j*3.5)-(d/2));var k=this.rectFont.right;var h=this.rectFont.top;k-=(j*3);for(var c=0;c<g.length;c++){this.drawBarCodeFontAngle180(k-f,h,b,g.substring(c,c+1));k-=(j*7);switch(c){case 3:k-=(j*5);break;}}};mCR_SymbologyEAN8.prototype.drawFontAngle270=function(g){var a=document.createElement("canvas");var l=a.getContext("2d");var b="";if(this.FontStyle){b="bold "+this.fontHeight+"px "+this.fontFamily;}else{b=this.fontHeight+"px "+this.fontFamily;}l.font=b;var d=l.measureText("0").width;l=null;a=null;var j=this.getDimension(this.rectFont);var f=((j*3.5)-(d/2));var k=this.rectFont.left;var h=this.rectFont.top;h+=(j*3);for(var c=0;c<g.length;c++){this.drawBarCodeFontAngle270(k,h+f,b,g.substring(c,c+1));h+=(j*7);switch(c){case 3:h+=(j*5);break;}}};mCR_SymbologyEAN8.prototype.getDimension=function(){var a=this.getBarcodeWidth();var b=0;if(this.barcode.optResolution){b=Math.floor((a/((8*7)+11)));if(b<1){b=1;}}else{b=(a/((8*7)+11));}return b;};function mCR_SymbologyKoreanPostalCode(a,d,b,c){mCR_Symbology.call(this,a,d,b,c);}mCR_SymbologyKoreanPostalCode.prototype=Object.create(mCR_Symbology.prototype);mCR_SymbologyKoreanPostalCode.prototype.constructor=mCR_SymbologyKoreanPostalCode;mCR_SymbologyKoreanPostalCode.prototype.drawBarcode=function(){var a=this.createPattern(this.barcode.text);if(this.errorCode==0){this.drawPattern(a);}else{this.drawErrorMsg();}};mCR_SymbologyKoreanPostalCode.prototype.drawPattern=function(b){var a=this.getDimension(b);this.drawBSPattern(b,a);};mCR_SymbologyKoreanPostalCode.prototype.drawBSPattern=function(b,a){switch(this.barcode.barcodeAngle){case 0:this.drawBSPatternAngle0(b,a);break;case 1:this.drawBSPatternAngle90(b,a);break;case 2:this.drawBSPatternAngle180(b,a);break;case 3:this.drawBSPatternAngle270(b,a);break;}};mCR_SymbologyKoreanPostalCode.prototype.drawBSPatternAngle0=function(h,g){var b=(g/4);var a=this.rect.left;var d=b;var f=h.length;for(var c=0;c<f;c++){if(h.charAt(c)=="b"){a+=(b*1.5);this.drawBarAngle0(a,d);a+=(b*2.5);}else{a+=g;}}};mCR_SymbologyKoreanPostalCode.prototype.drawBSPatternAngle90=function(h,g){var b=(g/4);var a=this.rect.bottom;var d=b;var f=h.length;for(var c=0;c<f;c++){if(h.charAt(c)=="b"){a-=(b*1.5);this.drawBarAngle90(a,d);a-=(b*2.5);}else{a-=g;}}};mCR_SymbologyKoreanPostalCode.prototype.drawBSPatternAngle180=function(h,g){var b=(g/4);var a=this.rect.right;var d=b;var f=h.length;for(var c=0;c<f;c++){if(h.charAt(c)=="b"){a-=(b*1.5);this.drawBarAngle180(a,d);a-=(b*2.5);}else{a-=g;}}};mCR_SymbologyKoreanPostalCode.prototype.drawBSPatternAngle270=function(h,g){var b=(g/4);var a=this.rect.top;var d=b;var f=h.length;for(var c=0;c<f;c++){if(h.charAt(c)=="b"){a+=(b*1.5);this.drawBarAngle270(a,d);a+=(b*2.5);}else{a+=g;}}};mCR_SymbologyKoreanPostalCode.prototype.getDimension=function(d){var a=d.length;var b=this.getBarcodeWidth();var c=0;c=(b/a);return c;};mCR_SymbologyKoreanPostalCode.prototype.createPattern=function(k){var h="";var f=k.length;if(f==6||f==5){var d=0;for(var a=f-1;a>=0;a--){var i=k.charAt(a);var b=this.getCharacterCode(i);var j=this.retrievePattern(b);if(j!=""){h+=j;d+=b;}else{this.errorCode=2;this.errorMsg="Unvalid data";h="";break;}}if(this.errorCode==0){var g=10-(d%10);h+=this.retrievePattern(g);}}else{this.errorCode=1;this.errorMsg="value size error";}return h;};mCR_SymbologyKoreanPostalCode.prototype.getCharacterCode=function(b){var a=-1;if(b>="0"&&b<="9"){a=b-"0";}return a;};mCR_SymbologyKoreanPostalCode.prototype.retrievePattern=function(a){var b="";switch(a){case 1:b="ssbbbb";break;case 2:b="sbsbbb";break;case 3:b="bssbbb";break;case 4:b="sbbsbb";break;case 5:b="bsbsbb";break;case 6:b="bbssbb";break;case 7:b="sbbbsb";break;case 8:b="bsbbsb";break;case 9:b="bbsbsb";break;case 0:b="bbbssb";break;}return b;};function mCR_SymbologyQRCode(a,d,b,c){mCR_Symbology.call(this,a,d,b,c);}mCR_SymbologyQRCode.prototype=Object.create(mCR_Symbology.prototype);mCR_SymbologyQRCode.prototype.constructor=mCR_SymbologyQRCode;mCR_SymbologyQRCode.prototype.drawBarcode=function(){var a=this.createPattern(this.barcode.text);if(this.errorCode==0){this.drawPattern(a);}else{this.drawErrorMsg();}};mCR_SymbologyQRCode.prototype.createPattern=function(c){var a=null;var b=c.length;if(b==0){this.errorCode=1;this.errorMsg="value size error";}else{try{a=jQuery.parseJSON(c);}catch(d){this.errorCode=2;this.errorMsg="Unvalid data";}}return a;};mCR_SymbologyQRCode.prototype.drawPattern=function(k){var b=new docRect();if(this.rect.getWidth()<this.rect.getHeight()){var g=(this.rect.getHeight()-this.rect.getWidth())/2;b.set(this.rect.left,(this.rect.top+g),this.rect.getWidth(),this.rect.getWidth());}else{var g=(this.rect.getWidth()-this.rect.getHeight())/2;b.set(this.rect.left+g,this.rect.top,this.rect.getHeight(),this.rect.getHeight());}var a=k.length;var l=(b.getWidth()/a);var h=b.left,f=b.top;for(var d=0;d<a;d++){for(var c=0;c<a;c++){if(k[d][c]==1){this.drawBarCodeRect(h,f,l,l);}h+=l;}h=b.left;f+=l;}};function mCR_SymbologyDataMatrix(a,d,b,c){mCR_SymbologyQRCode.call(this,a,d,b,c);}mCR_SymbologyDataMatrix.prototype=Object.create(mCR_SymbologyQRCode.prototype);mCR_SymbologyDataMatrix.prototype.constructor=mCR_SymbologyDataMatrix;function mCR_SymbologyPDF417(a,d,b,c){mCR_SymbologyQRCode.call(this,a,d,b,c);}mCR_SymbologyPDF417.prototype=Object.create(mCR_SymbologyQRCode.prototype);mCR_SymbologyPDF417.prototype.constructor=mCR_SymbologyPDF417;mCR_SymbologyPDF417.prototype.drawPattern=function(m){var b=new docRect();b.set(this.rect.left,this.rect.top,this.rect.getWidth(),this.rect.getHeight());var k=b.getWidth();var c=b.getHeight();var a=k;var f=m[0].length;var h=m.length;var l=a/f;if(c>h*l){b.top=b.top+((c-h*l)/2);}for(var g=0;g<h;g++){for(var d=0;d<f;d++){if(m[g][d]==1){this.drawBarCodeRect(b.left+(d*l),b.top+(g*l),l,l);}}}};function mCR_SymbologyGS1_128(a,d,b,c){mCR_SymbologyCode128.call(this,a,d,b,c);}mCR_SymbologyGS1_128.prototype=Object.create(mCR_SymbologyCode128.prototype);mCR_SymbologyGS1_128.prototype.constructor=mCR_SymbologyGS1_128;mCR_SymbologyGS1_128.prototype.intiCodeset=function(a){this.codeset=this.CODESET_C;};mCR_SymbologyGS1_128.prototype.drawBarcode=function(){var a=this.createPattern(this.barcode.text);if(this.errorCode==0){this.drawPattern(a);}else{this.drawErrorMsg();}};mCR_SymbologyGS1_128.prototype.createPattern=function(s){var q="";var m=s.length;if(m==0){this.errorCode=1;this.errorMsg="value size error";}else{this.intiCodeset(s);var r=0;var p=1;q+=this.getStartPattern();r+=this.getStartCode();var c=false;for(var n=0;n<m;n++){if(s.charAt(n)=="("){if(this.codeset!=this.CODESET_C){this.codeset=this.CODESET_C;q+=this.retrievePattern(CODE_C);r+=(this.CODE_C*p);p++;}if(c==false){q+=this.getFNCPattern();r+=this.FNC1;p++;}var f=s.charAt(n+1);var d=s.charAt(n+2);if(f=="0"){if(d=="0"||d=="1"||d=="2"||d=="3"||d=="4"){c=true;}}else{if(f=="1"){if(d=="1"||d=="2"||d=="3"||d=="4"||d=="5"||d=="6"){c=true;}}}}else{if(this.codeset==this.CODESET_C){if(s.charAt(n)==")"){}else{if(n<m-1){var g=false;var f=s.charAt(n);var d=s.charAt(n+1);if(d==")"){g=true;d=s.charAt(n+2);}if(this.isNum(f)&&this.isNum(d)){var o=f-"0";var l=d-"0";var b=(o*10)+l;n++;if(g==true){n++;g=false;}q+=this.retrievePattern(b);r+=(b*p);p++;}else{var a=s.charAt(n);this.codeset=this.CODESET_B;q+=this.retrievePattern(this.CODE_B);r+=(this.CODE_B*p);p++;var b=this.getCharacterCodeB(f);q+=this.retrievePattern(b);r+=(b*p);p++;}}else{var f=s.charAt(n);this.codeset=this.CODESET_B;q+=this.retrievePattern(this.CODE_B);r+=(this.CODE_B*p);p++;var b=this.getCharacterCodeB(f);q+=this.retrievePattern(b);r+=(b*p);p++;}}}else{if(this.codeset==this.CODESET_B){var h=0;for(var j=n;j<m;j++){var a=s.charAt(j);if(this.isNum(a)==true){h++;}else{break;}}if(h>5&&h%2==0){this.codeset=this.CODESET_C;q+=this.retrievePattern(this.CODE_C);r+=(this.CODE_C*p);p++;var f=s.charAt(n);var d=s.charAt(n+1);var o=f-"0";var l=d-"0";var b=(o*10)+l;n++;q+=this.retrievePattern(b);r+=(b*p);p++;}else{var f=s.charAt(n);var b=this.getCharacterCodeB(f);if(b!=-1){q+=this.retrievePattern(b);r+=(b*p);p++;}else{b=this.getCharacterCodeA(f);if(b!=-1){this.codeset=this.CODESET_A;q+=this.retrievePattern(this.CODE_A);r+=(this.CODE_A*p);p++;q+=this.retrievePattern(b);r+=(b*p);p++;}else{this.errorCode=2;this.errorMsg="Unvalid data";}}}}}}}var k=r%103;q+=this.retrievePattern(k);q+=this.getStopPattern();}return q;};function mCR_SymbologyITF14(a,d,b,c){mCR_Symbology2of5Interleaved.call(this,a,d,b,c);}mCR_SymbologyITF14.prototype=Object.create(mCR_Symbology2of5Interleaved.prototype);mCR_SymbologyITF14.prototype.constructor=mCR_SymbologyITF14;mCR_SymbologyITF14.prototype.createPattern=function(h){var d="";d+=this.startCode();var g=h.length;if(g%2==1){h="0"+h;g++;}for(var f=0;f<g;f+=2){var c=h.charAt(f);var b=h.charAt(f+1);var j=this.retrievePattern(c);var i=this.retrievePattern(b);for(var a=0;a<5;a++){d+=j.charAt(a);d+=i.charAt(a);}}d+=this.endCode();return d;};mCR_SymbologyITF14.prototype.drawBarcode=function(){var b=new docRect();b.copyRect(this.rect);var a=this.rect.getWidth();this.rect.left=this.rect.left+parseInt(a*0.1);this.rect.setWidth(parseInt(a*0.8));var c="";if(this.barcode.text.length==14){c=this.createPattern(this.barcode.text);}else{this.errorCode=1;this.errorMsg="value size error";}if(this.errorCode==0){this.drawPattern(c);this.drawOutLine(b);}else{this.drawErrorMsg();}};mCR_SymbologyITF14.prototype.drawOutLine=function(a){this.drawBarCodeRect(a.left,a.top,a.getWidth(),parseInt(a.getHeight()*0.1));this.drawBarCodeRect(a.left,a.top+a.getHeight()-parseInt(a.getHeight()*0.1),a.getWidth(),parseInt(a.getHeight()*0.1));this.drawBarCodeRect(a.left,a.top,parseInt(a.getHeight()*0.1),a.getHeight());this.drawBarCodeRect(a.left+a.getWidth()-parseInt(a.getHeight()*0.1),a.top,parseInt(a.getHeight()*0.1),a.getHeight());};function mCR_exportSVG(b,a){this.objDocument=b;this.objDocumentPage=null;this.objPageStyle=null;this.elmSVG=null;this.elmBodyGroup=null;this.elmCanvas=null;this.nPixelRate=0.378;this.nPtToPxRate=1.32814;this.elmChangeGroup=null;this.pageIndex=null;this.objLineHashMap=null;this.pageImageList=null;this.pageImageCount=0;this.tempImageDrawCount=0;this.callFunction=null;this.webLinkList=new Array();this.printCount=0;this.isPrint=a;this.isAccessibility=false;this.nAccessibilityLevel=0;this.isEasyInput=false;this.ruleCtrlVisible=false;this.strPostParam=null;}mCR_exportSVG.prototype.setPostParam=function(a){this.strPostParam=a;};mCR_exportSVG.prototype.exportPage=function(c,a,d){this.callFunction=a;if(this.objDocument.documentPageList.length>c){this.objDocumentPage=this.objDocument.documentPageList[c];}else{this.objDocumentPage=this.objDocument.documentPageList[0];}this.pageIndex=c;this.printCount=0;this.startPage();d.appendChild(this.elmSVG);this.exportSubSectionsInPage();this.endPage();if(this.pageImageCount==0){if(this.callFunction!=null){var b=this;window.setTimeout(function(){b.callFunction();},10);}}return this.elmSVG;};mCR_exportSVG.prototype.callGetWebLinkList=function(){return this.webLinkList;};mCR_exportSVG.prototype.setEasyInput=function(a){this.isEasyInput=a;};mCR_exportSVG.prototype.setRuleCtrlVisible=function(a){this.ruleCtrlVisible=a;};mCR_exportSVG.prototype.setAccessibility=function(a){this.isAccessibility=a;};mCR_exportSVG.prototype.setAccessibilityLevel=function(a){this.nAccessibilityLevel=a;};mCR_exportSVG.prototype.startPage=function(){this.objPageStyle=this.objDocument.getPageStyle(this.objDocumentPage.pageStyleKey);if(this.isEasyInput){var a=new docStylePage();a.paperType=this.objPageStyle.orientation;a.width=0;a.height=0;a.orientation=this.objPageStyle.orientation;a.leftMargin=0;a.topMargin=0;a.rightMargin=0;a.bottomMargin=0;a.pageCount=1;a.multiColumnDirection=this.objPageStyle.multiColumnDirection;for(var d=0;d<this.objDocumentPage.subSectionList.length;d++){var g=this.objDocumentPage.subSectionList[d];if(!g.isDrilling){var c=g.area.getHeight();g.area.top=a.height;a.height+=c;g.area.bottom=a.height;var b=g.area.getWidth();g.area.left=0;g.area.right=b;if(a.width<b){a.width=b;}}else{if(a.width==0){var b=g.area.getWidth();a.width=b;}}}this.objPageStyle=a;}this.elmSVG=document.createElementNS("http://www.w3.org/2000/svg","svg");this.elmSVG.setAttribute("fill-opacity","1");this.elmSVG.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink");this.elmSVG.setAttribute("xmlns","http://www.w3.org/2000/svg");this.elmSVG.setAttribute("color-rendering","auto");this.elmSVG.setAttribute("color-interpolation","auto");this.elmSVG.setAttribute("text-interpolation","auto");this.elmSVG.setAttribute("stroke-linecap","square");this.elmSVG.setAttribute("stroke-miterlimit","10");this.elmSVG.setAttribute("stroke-opacity","1");this.elmSVG.setAttribute("shape-rendering","auto");this.elmSVG.setAttribute("stroke-dasharray","none");this.elmSVG.setAttribute("stroke-linejoin","miter");this.elmSVG.setAttribute("stroke-dashoffset","0");this.elmSVG.setAttribute("image-rendering","auto");this.elmSVG.setAttribute("style","overflow:hidden");this.elmSVG.setAttribute("width",(this.objPageStyle.width/100)+"cm");this.elmSVG.setAttribute("height",(this.objPageStyle.height/100)+"cm");this.elmBodyGroup=document.createElementNS("http://www.w3.org/2000/svg","g");this.elmBodyGroup.setAttribute("transform","scale(1) translate(0,0)");this.elmdefs=document.createElementNS("http://www.w3.org/2000/svg","defs");this.elmBodyGroup.appendChild(this.elmdefs);var f=document.createElementNS("http://www.w3.org/2000/svg","g");f.setAttribute("fill","white");f.setAttribute("stroke","white");var h=document.createElementNS("http://www.w3.org/2000/svg","rect");h.setAttribute("x","0");h.setAttribute("y","0");h.setAttribute("width",(this.objPageStyle.width/100)+"cm");h.setAttribute("height",(this.objPageStyle.height/100)+"cm");h.setAttribute("stroke","none");this.objDocumentPage.width=this.objPageStyle.width;this.objDocumentPage.height=this.objPageStyle.height;f.appendChild(h);this.elmBodyGroup.appendChild(f);this.elmSVG.appendChild(this.elmBodyGroup);this.pageImageList=new Array();this.objLineHashMap=function(){};this.objAccHashMap=function(){};};mCR_exportSVG.prototype.exportSubSectionsInPage=function(){if(this.objDocumentPage.backGround&&!this.isEasyInput){this.objDocumentPage.backGround.area.right=this.objPageStyle.width-this.objPageStyle.leftMargin-this.objPageStyle.rightMargin;this.elmChangeGroup=document.createElementNS("http://www.w3.org/2000/svg","g");this.elmChangeGroup.setAttribute("id","bgSubSection");this.exportSubSection(this.objDocumentPage.backGround);this.setDefaultGroupStyle();this.exportControlsInSubSection(this.objDocumentPage.backGround);this.elmBodyGroup.appendChild(this.elmChangeGroup);}this.elmChangeGroup=document.createElementNS("http://www.w3.org/2000/svg","g");this.elmChangeGroup.setAttribute("id","mainSubSectionBG");for(var a=0;a<this.objDocumentPage.subSectionList.length;a++){var c=this.objDocumentPage.subSectionList[a];if(c.isDrillingView){this.exportSubSection(c);}}this.elmBodyGroup.appendChild(this.elmChangeGroup);var b=new Array();for(var a=0;a<this.objDocumentPage.subSectionList.length;a++){var c=this.objDocumentPage.subSectionList[a];if(c.isDrillingView){if(c.sectionType!=7){this.elmChangeGroup=document.createElementNS("http://www.w3.org/2000/svg","g");this.elmChangeGroup.setAttribute("id","mainSubSection"+a);this.setDefaultGroupStyle();this.exportControlsInSubSection(c);if(!c.isDrilling||""!=c.drillingName){this.elmBodyGroup.appendChild(this.elmChangeGroup);}}else{b.push(c);}}}b.sort(function(f,d){if(f.area.top>d.area.top){return 1;}if(f.area.top<d.area.top){return -1;}return 0;});for(var a=0;a<b.length;a++){this.elmChangeGroup=document.createElementNS("http://www.w3.org/2000/svg","g");this.elmChangeGroup.setAttribute("id","mainSubSectionPB"+a);this.setDefaultGroupStyle();this.exportControlsInSubSection(b[a]);this.elmBodyGroup.appendChild(this.elmChangeGroup);}b=null;if(this.objDocumentPage.foreGround&&!this.isEasyInput){this.objDocumentPage.foreGround.area.right=this.objPageStyle.width-this.objPageStyle.leftMargin-this.objPageStyle.rightMargin;this.elmChangeGroup=document.createElementNS("http://www.w3.org/2000/svg","g");this.elmChangeGroup.setAttribute("id","fgSubSection");this.exportSubSection(this.objDocumentPage.foreGround);this.setDefaultGroupStyle();this.exportControlsInSubSection(this.objDocumentPage.foreGround);this.elmBodyGroup.appendChild(this.elmChangeGroup);}};mCR_exportSVG.prototype.exportSubSection=function(g){var f=g.offsetRect(this.objPageStyle.leftMargin,this.objPageStyle.topMargin);var c=this.objDocument.getBackgroundStyle(g.backgroundStyleKey);var b=true;if(this.isEasyInput){if(g.isDrilling){b=false;}}if(null!=c&&c.backStyle==0&&b){var a=document.createElementNS("http://www.w3.org/2000/svg","rect");a.setAttribute("x",(f.left/100)+"cm");a.setAttribute("y",(f.top/100)+"cm");a.setAttribute("width",(f.getWidth()/100)+"cm");a.setAttribute("height",(f.getHeight()/100)+"cm");a.setAttribute("stroke","none");a.setAttribute("fill",mCR_getStrColor(c.backColor));this.elmChangeGroup.appendChild(a);}if(this.ruleCtrlVisible){if(g.sectionType!=6&&g.sectionType!=7){var d=this;window.setTimeout(function(){d.elmChangeGroup=document.createElementNS("http://www.w3.org/2000/svg","g");d.setDefaultGroupStyle();d.elmBodyGroup.appendChild(d.elmChangeGroup);var h=document.createElementNS("http://www.w3.org/2000/svg","rect");h.setAttribute("x",(f.left/100)+"cm");h.setAttribute("y",(f.top/100)+"cm");h.setAttribute("width",(f.getWidth()/100)+"cm");h.setAttribute("height",(f.getHeight()/100)+"cm");h.setAttribute("stroke","blue");h.setAttribute("stroke-width","2px");h.setAttribute("fill","none");d.elmChangeGroup.appendChild(h);var i=document.createElementNS("http://www.w3.org/2000/svg","text");i.setAttribute("stroke","blue");i.setAttribute("font-size","11pt");i.setAttribute("x",(f.left*0.378)+3);i.setAttribute("y",(f.top*0.378)+13);i.textContent=g.sectionName+"("+g.editEasyModeId+")";d.elmChangeGroup.appendChild(i);},300);}}};mCR_exportSVG.prototype.exportReportControlSubSection=function(d){var c=d.getRectInPage();var b=this.objDocument.getBackgroundStyle(d.backgroundStyleKey);if(null!=b&&b.backStyle==0){var a=document.createElementNS("http://www.w3.org/2000/svg","rect");a.setAttribute("x",(c.left/100)+"cm");a.setAttribute("y",(c.top/100)+"cm");a.setAttribute("width",(c.getWidth()/100)+"cm");a.setAttribute("height",(c.getHeight()/100)+"cm");a.setAttribute("stroke","none");a.setAttribute("fill",mCR_getStrColor(b.backColor));this.elmChangeGroup.appendChild(a);}};mCR_exportSVG.prototype.endPage=function(){this.objLineHashMap=null;this.objAccHashMap=null;};mCR_exportSVG.prototype.exportControlsInSubSection=function(f){for(var b=0;b<f.controlPageList.length;b++){var a=f.controlPageList[b];var d=true;if(-1!=a.visibleOptionStyleKey){var c=this.objDocument.getVisibleOptionStyle(a.visibleOptionStyleKey);if(null!=c){if(this.isPrint){d=c.toPrint;}else{d=c.toView;if(this.isEasyInput){d=c.toEasyMoad;}}}}if(d){this.exportControl(a);}}};mCR_exportSVG.prototype.exportControl=function(a){var c=true;if(a.pageCountConditionType==21){var b=this.objDocument.checkedTotalPageCount;var f=this.pageIndex+1==b/2+1;if(a.visible){if(f==true){c=false;}}else{c=f||a.conditionVisible;}}else{if(a.pageCountConditionType==22){var d=(this.pageIndex+1)%2;if(d==0){c=false;}}else{if(a.pageCountConditionType==23){var d=(this.pageIndex+1)%2;if(d==1){c=false;}}}}if(c){switch(a.type){case mCR_DocumentControlType.Line:this.exportLine(a);break;case mCR_DocumentControlType.Shape:this.exportShape(a);break;case mCR_DocumentControlType.Label:this.exportLabel(a);break;case mCR_DocumentControlType.Table:this.exportTable(a);break;case mCR_DocumentControlType.Crosstab:this.exportCrosstab(a);break;case mCR_DocumentControlType.Barcode:this.exportBarcode(a);break;case mCR_DocumentControlType.Chart:this.exportChart(a);break;case mCR_DocumentControlType.SubReport:this.exportReportControl(a);break;case mCR_DocumentControlType.Checkbox:this.exportCheckbox(a,this.elmChangeGroup,false);break;case mCR_DocumentControlType.VoiceEye:this.exportVoiceEye(a);break;case mCR_DocumentControlType.MarkAnyVoiceEye:this.exportMarkAnyVoice(a);break;case mCR_DocumentControlType.VerifyBarcode:this.exportVerifyBarcode(a);break;case mCR_DocumentControlType.VoiceBarcode:this.exportVoiceBarcode(a);break;case mCR_DocumentControlType.Input:this.exportInputbox(a);break;case mCR_DocumentControlType.Button:this.exportInputButton(a);break;case mCR_DocumentControlType.Video:this.exportInputVideo(a);break;case mCR_DocumentControlType.InputSelectBox:this.exportInputSelectBox(a);break;case mCR_DocumentControlType.Calendar:this.exportInputCalendar(a);break;case mCR_DocumentControlType.InputSign:this.exportInputSign(a);break;case mCR_DocumentControlType.InputImage:this.exportInputImage(a);break;case mCR_DocumentControlType.InputCheckbox:this.exportInputCheckbox(a);break;}}};mCR_exportSVG.prototype.exportInputCheckbox=function(f){var l=f.getRectInPage();var h=f.checkSize;var d=this.objDocument.documentStorage[f.primaryName];if(null!=d){if(d.visible){var c=null;if(f.useText){c=new docRect();c.set(0,0,h,h);var k=l.top+((l.getHeight()-h)/2);if(f.checkboxLeftAlignment){c.offsetRect(l.left,k);l.left+=h;}else{c.offsetRect((l.left+l.getWidth()-h),k);l.setWidth(l.getWidth()-h);}var m=this.paintText(l,f.textInfo);if(m!=null){this.elmChangeGroup.appendChild(m);}}else{c=l;}var o=this.objDocument.getLineStyle(f.outterlineStyleKey);var p=this.objDocument.getLineStyle(f.checkedBorderLineStyleKey);var i=this.objDocument.getShapeStyle(f.shapeStyleKey);if(null!=p&&"true"==d.checked){o=p;}if(null!=o&&null!=i){var g=this.paintShapeStyle(c,i);this.paintLineStyle(o,g);this.elmChangeGroup.appendChild(g);}if("true"==d.checked){var j=d.imageType=="check"?this.objDocument.checkImageName:this.objDocument.radioImageName;var n=null;var b=null;if(null==window.objClipClientPaintConnection||window.objClipClientPaintConnection=="get"){n=mCR_makeImageURL(this.objDocument,j);if(this.strPostParam!=null){n+=this.strPostParam;}b=document.createElementNS("http://www.w3.org/2000/svg","image");b.setAttribute("x",(c.left/100)+"cm");b.setAttribute("y",(c.top/100)+"cm");b.setAttribute("width",(c.getWidth()/100)+"cm");b.setAttribute("height",(c.getHeight()/100)+"cm");b.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",n);this.pageImageCount++;var a=this;b.onload=function(){a.tempImageDrawCount++;if(a.pageImageCount<=a.tempImageDrawCount){if(null!=a.callFunction){a.callFunction();}a.callFunction=null;}};b.onerror=function(){window.console.log("InputCheck or radio ID:"+d.id+" image error url >>"+n);a.tempImageDrawCount++;if(a.pageImageCount<=a.tempImageDrawCount){if(null!=a.callFunction){a.callFunction();}a.callFunction=null;}};}else{if(window.objClipClientPaintConnection.toLocaleLowerCase()=="post"){b=document.createElementNS("http://www.w3.org/2000/svg","image");b.setAttribute("x",(c.left/100)+"cm");b.setAttribute("y",(c.top/100)+"cm");b.setAttribute("width",(c.getWidth()/100)+"cm");b.setAttribute("height",(c.getHeight()/100)+"cm");this.pageImageCount++;var a=this;mCR_ServerImageCallSVG(this,f,j,b);}}this.elmChangeGroup.appendChild(b);}}else{if(f.useText){if(f.checkboxLeftAlignment){l.left+=h;}else{l.setWidth(l.getWidth()-h);}var m=this.paintText(l,f.textInfo);if(m!=null){this.elmChangeGroup.appendChild(m);}}}}};mCR_exportSVG.prototype.exportInputImage=function(a){var b=a.getRectInPage();var c=this.objDocument.documentStorage[a.primaryName];if((b.getWidth()!=0&&b.getHeight()!=0)&&null!=c){if(c.visible&&""!=c.image&&c.image!=null){var g=c.image.replace(/\s/gi,"+");var f=document.createElementNS("http://www.w3.org/2000/svg","image");f.setAttribute("x",(b.left/100)+"cm");f.setAttribute("y",(b.top/100)+"cm");f.setAttribute("width",(b.getWidth()/100)+"cm");f.setAttribute("height",(b.getHeight()/100)+"cm");f.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href","data:image/png;base64,"+g);this.pageImageCount++;var d=this;if(window.objClipClientPaintConnection.toLocaleLowerCase()!="post"){f.onload=function(){d.tempImageDrawCount++;if(d.pageImageCount<=d.tempImageDrawCount){if(null!=d.callFunction){d.callFunction();}d.callFunction=null;}};f.onerror=function(){window.console.log("InputImage ID:"+c.id+" image error url >> "+g);d.tempImageDrawCount++;if(d.pageImageCount<=d.tempImageDrawCount){if(null!=d.callFunction){d.callFunction();}d.callFunction=null;}};}else{f.onload=function(){d.tempImageDrawCount++;if(d.callFunction!=null){++d.printCount;if(d.pageImageCount==d.printCount){d.callFunction();}}};f.onerror=function(){window.console.log("InputImage ID:"+c.id+" image error url >> "+g);d.tempImageDrawCount++;if(d.callFunction!=null){++d.printCount;if(d.pageImageCount==d.printCount){d.callFunction();}}};}this.elmChangeGroup.appendChild(f);}else{if(c.visible&&(""==c.image||c.image==null)){this.setInputControlInfo(b,"image");}}}};mCR_exportSVG.prototype.exportInputSign=function(i){var j=i.getRectInPage();var f=this.objDocument.documentStorage[i.primaryName];if((j.getWidth()!=0&&j.getHeight()!=0)&&null!=f){if(f.visible&&((""!=f.image&&f.image!=null)||f.showDisplayTextInDialog)){var k=this.objDocument.getLineStyle(i.outterlineStyleKey);var h=this.objDocument.getShapeStyle(i.shapeStyleKey);if(null!=k&&null!=h){var g=this.paintShapeStyle(j,h);this.paintLineStyle(k,g);this.elmChangeGroup.appendChild(g);}if(f.showDisplayTextInDialog&&!(f.showDisplayTextByValue&&(""!=f.image&&f.image!=null))&&!(!i.guideTextExport&&this.isPrint)){var d=j.newRateRect(this.nPixelRate);this.drawInputSignGuideText(i,f,d);}if((""!=f.image&&f.image!=null)){var b=f.image.replace(/\s/gi,"+");var c=document.createElementNS("http://www.w3.org/2000/svg","image");c.setAttribute("x",(j.left/100)+"cm");c.setAttribute("y",(j.top/100)+"cm");c.setAttribute("width",(j.getWidth()/100)+"cm");c.setAttribute("height",(j.getHeight()/100)+"cm");c.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href","data:image/png;base64,"+b);this.pageImageCount++;var a=this;if(window.objClipClientPaintConnection.toLocaleLowerCase()!="post"){c.onload=function(){a.tempImageDrawCount++;if(a.pageImageCount<=a.tempImageDrawCount){if(null!=a.callFunction){a.callFunction();}a.callFunction=null;}};c.onerror=function(){window.console.log("InputSign ID:"+f.id+" image error url >> "+b);a.tempImageDrawCount++;if(a.pageImageCount<=a.tempImageDrawCount){if(null!=a.callFunction){a.callFunction();}a.callFunction=null;}};}else{c.onload=function(){a.tempImageDrawCount++;if(a.callFunction!=null){++a.printCount;if(a.pageImageCount==a.printCount){a.callFunction();}}};c.onerror=function(){window.console.log("InputSign ID:"+f.id+" image error url >> "+b);a.tempImageDrawCount++;if(a.callFunction!=null){++a.printCount;if(a.pageImageCount==a.printCount){a.callFunction();}}};}this.elmChangeGroup.appendChild(c);}}else{if(f.visible&&(""==f.image||f.image==null)){this.setInputControlInfo(j,"sign");}}}};mCR_exportSVG.prototype.drawInputSignGuideText=function(Q,G,z){var y=0.0264583333;var o=1.32814;var D=1.33333;var h=document.createElement("canvas");var s=h.getContext("2d");var t=decodeURIComponent(G.fontName);var N=Q.horizontalAlignmentMethod;var c=Q.verticalAlignmentMethod;var v=decodeURIComponent(G.guideMessage);var a=G.fontBold;var d=G.fontItalic;var B=decodeURIComponent(G.fontColor);var p=G.fontSize.replace("pt","");var n=1.2*D;var O=0;s.font=G.fontSize+" "+t;var F=[];var m=0;var r=0;var L=[];var A="";var q=new textArray();var u=0;var H=v.length;var j=z.getHeight();var J=z.getWidth();var w=p*D;var P=0;var g=w;var I=0;var l=0;var E=0;var C=0;for(var K=0;K<H;K++){var f=0;var M=false;if(v[K]!="\n"){f=s.measureText(v[K]).width+O;m=m+f;}else{M=true;}if(m>J||M){F=m-f;l=P+w;break;}if(!M){A=A+v[K];q.push(new textInfo(v[K],0+m-f,g+P,I));}if(K==H-1){l=P+w;F=m;}}if(N==1){E=(J-F)/2;}else{if(N==2){E=(J-F);}else{E=0;}}if(c==1){C=(j-l)/2;}else{if(c==2){C=(j-l-w*0.3);}else{C=0;}}var k=document.createElementNS("http://www.w3.org/2000/svg","g");if(a){if(window.is_apple||window.mCR_isApple){k.setAttribute("font-weight","normal");k.setAttribute("stroke-width","0.4");k.setAttribute("paint-order","stroke");k.setAttribute("stroke",B);}else{k.setAttribute("font-weight","bold");}}k.setAttribute("stroke","none");if(d){k.setAttribute("font-style","italic");}k.setAttribute("fill",B);k.setAttribute("font-size",(w/D)+"pt");k.setAttribute("font-family",t);var b=q.array.length;for(var K=0;K<b;K++){var x=document.createElementNS("http://www.w3.org/2000/svg","text");x.textContent=q.array[K].character;x.setAttribute("x",q.array[K].tx+E+z.getLeft());x.setAttribute("y",q.array[K].ty+C+z.getTop());k.appendChild(x);}this.elmChangeGroup.appendChild(k);};mCR_exportSVG.prototype.exportInputCalendar=function(a){var c=a.getRectInPage();var d=this.objDocument.documentStorage[a.primaryName];if(null!=d){if(d.visible){var b=this.paintText(c,a.textInfo);if(b!=null){this.elmChangeGroup.appendChild(b);}}}};mCR_exportSVG.prototype.exportInputSelectBox=function(a){var c=a.getRectInPage();var d=this.objDocument.documentStorage[a.primaryName];if(null!=d){if(d.visible){var b=this.paintText(c,a.textInfo);if(b!=null){this.elmChangeGroup.appendChild(b);}}}};mCR_exportSVG.prototype.exportInputButton=function(a){var c=a.getRectInPage();var d=this.objDocument.documentStorage[a.primaryName];if(null!=d){if(d.visible){var b=this.paintText(c,a.textInfo);if(b!=null){this.elmChangeGroup.appendChild(b);}}}};mCR_exportSVG.prototype.exportInputVideo=function(a){};mCR_exportSVG.prototype.exportInputbox=function(c){var b=c.getRectInPage();var d=this.objDocument.documentStorage[c.primaryName];if(null!=d){if(d.visible){var a=this.paintText(b,c.textInfo);if(a!=null){this.elmChangeGroup.appendChild(a);}}}};mCR_exportSVG.prototype.makeTableGroup=function(b){var a=document.createElementNS("http://www.w3.org/2000/svg","g");if(b){a.setAttribute("stroke","none");a.setAttribute("fill","none");}else{a.setAttribute("stroke-linecap","butt");a.setAttribute("stroke-width","0.75pt");a.setAttribute("stroke","rgb(0,0,0)");a.setAttribute("fill","none");}return a;};mCR_exportSVG.prototype.exportTable=function(a){var g=a;var f=g.getRectInPage();var d=this.makeTableGroup(true);var h=this.makeTableGroup(false);var b=new docCellMap();if(this.isAccessibility&&null!=g.accessibilityString&&""!=g.accessibilityString){var c={type:20,msg:g.accessibilityString};if(this.elmLayoutButton!=null){this.setEFormAccessInfo(this.isEasyInput?g.rect:f,c);}else{this.setWebLinkInfo(f,c);}}this.elmChangeGroup.appendChild(d);this.paintCellsBackgroundText(f,g,d,b);this.paintCellsOutterLine(f,g,h,b);this.elmChangeGroup.appendChild(h);};mCR_exportSVG.prototype.paintCellsBackgroundText=function(c,r,s,i){var j=r.getRowCount();for(var k=0;k<j;k++){var f=new Array();i.cellMap.push(f);var n=r.getColumnCount();for(var o=0;o<n;o++){var b=r.getTableCellNormal(k,o);if(b!=null){var g=new docCellInfo(false);g.colSpan=b.colSpan;g.rowSpan=b.rowSpan;f.push(g);var m=false;var h=false;var u=false;var d=false;if(k==0&&o==0){if(r.roundLeftTop==1){m=true;}}if(k==0&&(o==n-1)){if(r.roundRightTop==1){h=true;}}if((k==j-1)&&o==0){if(r.roundLeftBottom==1){u=true;}}if((k==j-1)&&(o==n-1)){if(r.roundRightBottom==1){d=true;}}this.paintCellBackground(c,b,s,m,h,u,d);if(b.webLinkInfo!=null){if(b.webLinkInfo.type!=-1){var l=b.getRectInPage();l.offsetRect(c.left,c.top);this.setWebLinkInfo(l,b.webLinkInfo);}}if(this.isAccessibility){if(null!=b.accessibilityString){var t=b.accessibilityString;t=t.replace(/\@pc\@|\@pn\@/g,b.detailTextInfo.getOriginalTextInfo().text);var q={type:20,ctrl:1,msg:t};var p=b.getRectInPage();p.offsetRect(c.left,c.top);if(this.elmLayoutButton!=null){var a=b.getRectInPage();a.offsetRect(r.rect.left,r.rect.top);this.setEFormAccessInfo(this.isEasyInput?a:p,q);}else{this.setWebLinkInfo(p,q);}}else{var q={type:400,ctrl:1,msg:""};var p=b.getRectInPage();p.offsetRect(c.left,c.top);this.setWebLinkInfo(p,q);}}}else{var g=new docCellInfo(true);f.push(g);}}}};mCR_exportSVG.prototype.paintCellsOutterLine=function(f,m,h,c){this.checkingLastCell(c);var g=m.getRowCount();var k=null;for(var d=0;d<g;d++){k=m.getColumnCount();for(var l=0;l<k;l++){var j=m.getTableCellNormal(d,l);if(j!=null){this.paintCellOutterLine(f,j,h,m,d,g,l,k,c);}}}var a=this.objDocument.getLineStyle(m.lineFDiagonaStyleKey);if(a.style!=mCR_LineStyle.None){var i=this.paintLineBDiagonal(c.leftBottomCell.getRectInPage().addRect(f.getLeft(),f.getTop(),f.getLeft(),f.getTop()),c.rightTopCell.getRectInPage().addRect(f.getLeft(),f.getTop(),f.getLeft(),f.getTop()),a,m.roundLeftBottom,m.roundRightTop);h.appendChild(i);}var b=this.objDocument.getLineStyle(m.lineBDiagonaStyleKey);if(b.style!=mCR_LineStyle.None){var i=this.paintLineFDiagonal(c.leftTopCell.getRectInPage().addRect(f.getLeft(),f.getTop(),f.getLeft(),f.getTop()),c.rightBottomCell.getRectInPage().addRect(f.getLeft(),f.getTop(),f.getLeft(),f.getTop()),b,m.roundLeftTop,m.roundRightBottom);h.appendChild(i);}};mCR_exportSVG.prototype.checkingLastCell=function(d){var a=d.cellMap.length;for(var f=0;f<a;f++){var g=d.cellMap[f].length;for(var c=0;c<g;c++){var b=d.cellMap[f][c];if(b.rowSpan>1){if(f+b.rowSpan==a){b.isTopLast=true;}}if(b.colSpan>1){if(c+b.colSpan==g){b.isLeftLast=true;}}if(f==a-1&&!b.dumy){b.isTopLast=true;}if(c==g-1&&!b.dumy){b.isLeftLast=true;}}}};mCR_exportSVG.prototype.paintCellOutterLine=function(w,v,u,o,a,c,b,k,n){var x=v.getRectInPage();x.setLeft(w.getLeft()+x.getLeft());x.setTop(w.getTop()+x.getTop());x.setRight(w.getLeft()+x.getRight());x.setBottom(w.getTop()+x.getBottom());var J=n.cellMap[a][b];var D=this.objDocument.getLineStyle(v.leftLineStyleKey);var h=this.objDocument.getLineStyle(v.topLineStyleKey);var q=this.objDocument.getLineStyle(v.rightLineStyleKey);var t=this.objDocument.getLineStyle(v.bottomLineStyleKey);var B=this.objDocument.getLineStyle(v.frontDiagonalLineStyleKey);var j=this.objDocument.getLineStyle(v.backDiagonalLineStyleKey);if(D!=null&&h!=null&&q!=null&&t!=null&&h!=null){var y=false;var z=false;var m=false;var K=false;if(a==0){var F=this.objDocument.getLineStyle(o.outterlineStyleKey);if(F.style!=0){h=F;}}if(b==0){var F=this.objDocument.getLineStyle(o.outterlineStyleKey);if(F.style!=0){D=F;}}if(J.isLeftLast){var F=this.objDocument.getLineStyle(o.outterlineStyleKey);if(F.style!=0){q=F;}}if(J.isTopLast){var F=this.objDocument.getLineStyle(o.outterlineStyleKey);if(F.style!=0){t=F;}}var C=this.getWidthMarginNormal(D.width,D.style)/100;var E=this.getWidthMarginNormal(q.width,q.style)/100;var f=this.getWidthMarginNormal(h.width,h.style)/100;var i=this.getWidthMarginNormal(t.width,t.style)/100;var G=null;var r=null;var d=null;var l=null;var s=null;var L=null;var p=null;var A=null;if(D.style==mCR_LineStyle.DoubleLine){d=this.getWidthMarginOutter(h.width,h.style)/100;l=this.getWidthMarginOutter(t.width,t.style)/100;p=this.getWidthMarginInner(h.width,h.style)/100;A=this.getWidthMarginInner(t.width,t.style)/100;}else{if(D.style==mCR_LineStyle.InnerLine){p=this.getWidthMarginInner(h.width,h.style)/100;A=this.getWidthMarginInner(t.width,t.style)/100;}}if(h.style==mCR_LineStyle.DoubleLine){G=this.getWidthMarginOutter(D.width,D.style)/100;r=this.getWidthMarginOutter(q.width,q.style)/100;s=this.getWidthMarginInner(D.width,D.style)/100;L=this.getWidthMarginInner(q.width,q.style)/100;}else{if(h.style==mCR_LineStyle.InnerLine){s=this.getWidthMarginInner(D.width,D.style)/100;L=this.getWidthMarginInner(q.width,q.style)/100;}}if(q.style==mCR_LineStyle.DoubleLine){if(d==null){d=this.getWidthMarginOutter(h.width,h.style)/100;}if(l==null){l=this.getWidthMarginOutter(t.width,t.style)/100;}if(p==null){p=this.getWidthMarginInner(h.width,h.style)/100;}if(A==null){A=this.getWidthMarginInner(t.width,t.style)/100;}}else{if(q.style==mCR_LineStyle.InnerLine){if(p==null){p=this.getWidthMarginInner(h.width,h.style)/100;}if(A==null){A=this.getWidthMarginInner(t.width,t.style)/100;}}}if(t.style==mCR_LineStyle.DoubleLine){if(G==null){G=this.getWidthMarginOutter(D.width,D.style)/100;}if(r==null){r=this.getWidthMarginOutter(q.width,q.style)/100;}if(s==null){s=this.getWidthMarginInner(D.width,D.style)/100;}if(L==null){L=this.getWidthMarginInner(q.width,q.style)/100;}}else{if(t.style==mCR_LineStyle.InnerLine){if(s==null){s=this.getWidthMarginInner(D.width,D.style)/100;}if(L==null){L=this.getWidthMarginInner(q.width,q.style)/100;}}}if(a==0&&b==0){n.leftTopCell=v;if(o.roundLeftTop==1){y=true;}}if(a==0&&J.isLeftLast){n.rightTopCell=v;if(o.roundRightTop==1){z=true;}}if(J.isTopLast&&b==0){n.leftBottomCell=v;if(o.roundLeftBottom==1){m=true;}}if(J.isTopLast&&J.isLeftLast){n.rightBottomCell=v;if(o.roundRightBottom==1){K=true;}}if(D.style!=0){if(b!=0&&n.cellMap[a][b-1].rightLineStyleKey==0){}else{J.leftLineStyleKey=v.leftLineStyleKey;if(D.style==mCR_LineStyle.DoubleLine){var H=this.getCellLineWidth(D.width)/100;this.paintCellLineLeft(x,D,y,m,d,l,-H,u);this.paintCellLineLeft(x,D,y,m,p,A,H,u);}else{if(D.style==mCR_LineStyle.InnerLine){var H=this.getCellLineWidth(D.width)/100;this.paintCellLineLeft(x,D,y,m,p,A,H,u);}else{var H=0;this.paintCellLineLeft(x,D,y,m,f,i,H,u);}}}}if(h.style!=0){if(a!=0&&n.cellMap[a-1][b].bottomLineStyleKey==0){}else{J.topLineStyleKey=v.topLineStyleKey;if(h.style==mCR_LineStyle.DoubleLine){var I=this.getCellLineWidth(h.width)/100;this.paintCellLineTop(x,h,y,z,G,r,-I,u);this.paintCellLineTop(x,h,y,z,s,L,I,u);}else{if(h.style==mCR_LineStyle.InnerLine){var I=this.getCellLineWidth(h.width)/100;this.paintCellLineTop(x,h,y,z,s,L,I,u);}else{var I=0;this.paintCellLineTop(x,h,y,z,C,E,I,u);}}}}if(q.style!=0){if(!J.isLeftLast&&n.cellMap[a][b+1].leftLineStyleKey==0){}else{J.rightLineStyleKey=v.rightLineStyleKey;if(q.style==mCR_LineStyle.DoubleLine){var H=this.getCellLineWidth(q.width)/100;this.paintCellLineRight(x,q,z,K,d,l,H,u);this.paintCellLineRight(x,q,z,K,p,A,-H,u);}else{if(q.style==mCR_LineStyle.InnerLine){var H=this.getCellLineWidth(q.width)/100;this.paintCellLineRight(x,q,z,K,p,A,-H,u);}else{var H=0;this.paintCellLineRight(x,q,z,K,f,i,H,u);}}}}if(t.style!=0){if(!J.isTopLast&&n.cellMap[a+1][b].bottomLineStyleKey==0){}else{J.bottomLineStyleKey=v.bottomLineStyleKey;if(t.style==mCR_LineStyle.DoubleLine){var I=this.getCellLineWidth(t.width)/100;this.paintCellLineBottom(x,t,m,K,G,r,I,u);this.paintCellLineBottom(x,t,m,K,s,L,-I,u);}else{if(t.style==mCR_LineStyle.InnerLine){var I=this.getCellLineWidth(t.width)/100;this.paintCellLineBottom(x,t,m,K,s,L,-I,u);}else{var I=0;this.paintCellLineBottom(x,t,m,K,C,E,I,u);}}}}if(B.style!=0){var g=this.paintLineBDiagonal(x,x,B,m,z);u.appendChild(g);}if(j.style!=0){var g=this.paintLineFDiagonal(x,x,j,y,K);u.appendChild(g);}}};mCR_exportSVG.prototype.paintRoundLeftTop=function(j,b,i,d,k){var l=document.createElementNS("http://www.w3.org/2000/svg","path");this.paintLineStyle(b,l);var a=((j.getLeft())*0.378+i*37.8).toFixed(2);var g=((j.getTop()+j.getHeight()/2)*0.37795275591+d*37.8).toFixed(2);var h=((j.getTop()+j.getHeight()*0.2929)*0.37795275591+d*37.8).toFixed(2);var c=(((j.getLeft()+j.getWidth()/2*0.2929)*0.378)+i*37.8).toFixed(2);var f=((j.getTop()+j.getHeight()/2*0.2929)*0.37795275591+d*37.8).toFixed(2);l.setAttribute("d","M"+a+" "+g+" C"+a+" "+g+" "+a+" "+h+" "+c+" "+f);k.appendChild(l);};mCR_exportSVG.prototype.paintRoundTopLeft=function(j,c,i,f,k){var l=document.createElementNS("http://www.w3.org/2000/svg","path");this.paintLineStyle(c,l);var a=((j.getTop())*0.37795275591+f*37.8).toFixed(2);var g=(((j.getLeft()+j.getWidth()/2)*0.378)+i*37.8).toFixed(2);var b=((j.getLeft()+j.getWidth()*0.2929)*0.378+i*37.8).toFixed(2);var d=(((j.getLeft()+j.getWidth()/2*0.2929)*0.378)+i*37.8).toFixed(2);var h=((j.getTop()+j.getHeight()/2*0.2929)*0.37795275591+f*37.8).toFixed(2);l.setAttribute("d","M"+d+" "+h+" C"+b+" "+a+" "+g+" "+a+" "+g+" "+a);k.appendChild(l);};mCR_exportSVG.prototype.paintRoundTopRight=function(j,b,h,d,k){var l=document.createElementNS("http://www.w3.org/2000/svg","path");this.paintLineStyle(b,l);var a=(j.getTop()*0.37795275591+d*37.8).toFixed(2);var g=(j.getRight()*0.378+h*37.8).toFixed(2);var m=((j.getRight()-j.getWidth()/2)*0.378+h*37.8).toFixed(2);var c=((j.getRight()-j.getWidth()*0.2929)*0.378+h*37.8).toFixed(2);var i=(((j.getRight()-j.getWidth()/2*0.2929)*0.378)+h*37.8).toFixed(2);var f=((j.getTop()+j.getHeight()/2*0.2929)*0.37795275591+d*37.8).toFixed(2);l.setAttribute("d","M"+i+" "+f+" C"+c+" "+a+" "+m+" "+a+" "+m+" "+a);k.appendChild(l);};mCR_exportSVG.prototype.paintRoundRightTop=function(j,a,h,b,k){var l=document.createElementNS("http://www.w3.org/2000/svg","path");this.paintLineStyle(a,l);var d=(j.getRight()*0.378+h*37.8).toFixed(2);var i=(((j.getRight()-j.getWidth()/2*0.2929)*0.378)+h*37.8).toFixed(2);var g=((j.getTop()+j.getHeight()*0.2929)*0.37795275591+b*37.8).toFixed(2);var c=((j.getTop()+j.getHeight()/2*0.2929)*0.37795275591+b*37.8).toFixed(2);var f=((j.getTop()+j.getHeight()/2)*0.37795275591+b*37.8).toFixed(2);l.setAttribute("d","M"+d+" "+f+" C"+d+" "+f+" "+d+" "+g+" "+i+" "+c);k.appendChild(l);};mCR_exportSVG.prototype.paintRoundLeftBottom=function(j,b,i,d,k){var l=document.createElementNS("http://www.w3.org/2000/svg","path");this.paintLineStyle(b,l);var a=((j.getLeft())*0.378+i*37.8).toFixed(2);var g=((j.getBottom()-j.getHeight()/2)*0.37795275591+d*37.8).toFixed(2);var h=((j.getBottom()-j.getHeight()*0.2929)*0.37795275591+d*37.8).toFixed(2);var c=(((j.getLeft()+j.getWidth()/2*0.2929)*0.378)+i*37.8).toFixed(2);var f=((j.getBottom()-j.getHeight()/2*0.2929)*0.37795275591+d*37.8).toFixed(2);l.setAttribute("d","M"+a+" "+g+" C"+a+" "+g+" "+a+" "+h+" "+c+" "+f);k.appendChild(l);};mCR_exportSVG.prototype.paintRoundBottomLeft=function(i,b,h,d,j){var k=document.createElementNS("http://www.w3.org/2000/svg","path");this.paintLineStyle(b,k);var l=((i.getBottom())*0.37795275591+d*37.8).toFixed(2);var f=(((i.getLeft()+i.getWidth()/2)*0.378)+h*37.8).toFixed(2);var a=((i.getLeft()+i.getWidth()*0.2929)*0.378+h*37.8).toFixed(2);var c=(((i.getLeft()+i.getWidth()/2*0.2929)*0.378)+h*37.8).toFixed(2);var g=((i.getBottom()-i.getHeight()/2*0.2929)*0.37795275591+d*37.8).toFixed(2);k.setAttribute("d","M"+c+" "+g+" C"+a+" "+l+" "+f+" "+l+" "+f+" "+l);j.appendChild(k);};mCR_exportSVG.prototype.paintRoundRightBottom=function(j,a,h,b,k){var l=document.createElementNS("http://www.w3.org/2000/svg","path");this.paintLineStyle(a,l);var d=(j.getRight()*0.378+h*37.8).toFixed(2);var f=((j.getBottom()-j.getHeight()/2)*0.37795275591+b*37.8).toFixed(2);var i=(((j.getRight()-j.getWidth()/2*0.2929)*0.378)+h*37.8).toFixed(2);var g=((j.getBottom()-j.getHeight()*0.2929)*0.37795275591+b*37.8).toFixed(2);var c=((j.getBottom()-j.getHeight()/2*0.2929)*0.37795275591+b*37.8).toFixed(2);l.setAttribute("d","M"+d+" "+f+" C"+d+" "+f+" "+d+" "+g+" "+i+" "+c);k.appendChild(l);};mCR_exportSVG.prototype.paintRoundBottomRight=function(i,a,g,c,j){var k=document.createElementNS("http://www.w3.org/2000/svg","path");this.paintLineStyle(a,k);var l=((i.getBottom())*0.37795275591+c*37.8).toFixed(2);var f=(i.getRight()*0.378+g*37.8).toFixed(2);var m=((i.getRight()-i.getWidth()/2)*0.378+g*37.8).toFixed(2);var b=((i.getRight()-i.getWidth()*0.2929)*0.378+g*37.8).toFixed(2);var h=(((i.getRight()-i.getWidth()/2*0.2929)*0.378)+g*37.8).toFixed(2);var d=((i.getBottom()-i.getHeight()/2*0.2929)*0.37795275591+c*37.8).toFixed(2);k.setAttribute("d","M"+h+" "+d+" C"+b+" "+l+" "+m+" "+l+" "+m+" "+l);j.appendChild(k);};mCR_exportSVG.prototype.paintCellLineBottom=function(j,h,f,k,c,g,b,l){var m=document.createElementNS("http://www.w3.org/2000/svg","line");this.paintLineStyle(h,m);var i=(j.getBottom()/100)+b;var a=null;var d=null;if(!(f||k)){a=(j.getLeft()/100);d=(j.getRight()/100);a=a-c;d=d+g;m.setAttribute("x1",a+"cm");m.setAttribute("x2",d+"cm");m.setAttribute("y1",i+"cm");m.setAttribute("y2",i+"cm");if(!this.isEasyInput){this.lineDeduplication(a,i,d,i,h,m);}}else{if(f&&k){this.paintRoundBottomLeft(j,h,-b,b,l);this.paintRoundBottomRight(j,h,-b,-b,l);}else{if(f){this.paintRoundBottomLeft(j,h,-b,b,l);a=((j.getRight()-j.getWidth()/2)/100);d=(j.getRight()/100);a=a-c;d=d+g;m.setAttribute("x1",a+"cm");m.setAttribute("x2",d+"cm");m.setAttribute("y1",i+"cm");m.setAttribute("y2",i+"cm");if(!this.isEasyInput){this.lineDeduplication(a,i,d,i,h,m);}}else{this.paintRoundBottomRight(j,h,-b,-b,l);a=(j.getLeft()/100);d=((j.getLeft()+j.getWidth()/2)/100);a=a-c;d=d+g;m.setAttribute("x1",a+"cm");m.setAttribute("x2",d+"cm");m.setAttribute("y1",i+"cm");m.setAttribute("y2",i+"cm");if(!this.isEasyInput){this.lineDeduplication(a,i,d,i,h,m);}}}}l.appendChild(m);};mCR_exportSVG.prototype.paintCellLineRight=function(g,d,b,i,j,f,c,k){var m=document.createElementNS("http://www.w3.org/2000/svg","line");this.paintLineStyle(d,m);var h=c+(g.getRight()/100);var a=null;var l=null;if(!(b||i)){a=(g.getTop()/100);l=(g.getBottom()/100);a=a-j;l=l+f;m.setAttribute("x1",h+"cm");m.setAttribute("x2",h+"cm");m.setAttribute("y1",a+"cm");m.setAttribute("y2",l+"cm");if(!this.isEasyInput){this.lineDeduplication(h,a,h,l,d,m);}}else{if(b&&i){this.paintRoundRightBottom(g,d,-c,-c,k);this.paintRoundRightTop(g,d,c,-c,k);}else{if(i){this.paintRoundRightBottom(g,d,-c,-c,k);a=(g.getTop()/100);l=((g.getTop()+g.getHeight()/2)/100);a=a-j;l=l+f;m.setAttribute("x1",h+"cm");m.setAttribute("x2",h+"cm");m.setAttribute("y1",a+"cm");m.setAttribute("y2",l+"cm");if(!this.isEasyInput){this.lineDeduplication(h,a,h,l,d,m);}}else{this.paintRoundRightTop(g,d,c,-c,k);a=((g.getBottom()-g.getHeight()/2)/100);l=(g.getBottom()/100);a=a-j;l=l+f;m.setAttribute("x1",h+"cm");m.setAttribute("x2",h+"cm");m.setAttribute("y1",a+"cm");m.setAttribute("y2",l+"cm");if(!this.isEasyInput){this.lineDeduplication(h,a,h,l,d,m);}}}}k.appendChild(m);};mCR_exportSVG.prototype.paintCellLineTop=function(k,h,i,b,d,g,c,l){var m=document.createElementNS("http://www.w3.org/2000/svg","line");this.paintLineStyle(h,m);var j=(k.getTop()/100)+c;var a=null;var f=null;if(!(i||b)){a=(k.getLeft()/100);f=(k.getRight()/100);a=a-d;f=f+g;m.setAttribute("x1",a+"cm");m.setAttribute("x2",f+"cm");m.setAttribute("y1",j+"cm");m.setAttribute("y2",j+"cm");if(!this.isEasyInput){this.lineDeduplication(a,j,f,j,h,m);}}else{if(i&&b){this.paintRoundTopLeft(k,h,c,c,l);this.paintRoundTopRight(k,h,-c,c,l);}else{if(i){this.paintRoundTopLeft(k,h,c,c,l);a=((k.getRight()-k.getWidth()/2)/100);f=(k.getRight()/100);a=a-d;f=f+g;m.setAttribute("x1",a+"cm");m.setAttribute("x2",f+"cm");m.setAttribute("y1",j+"cm");m.setAttribute("y2",j+"cm");if(!this.isEasyInput){this.lineDeduplication(a,j,f,j,h,m);}}else{this.paintRoundTopRight(k,h,-c,c,l);a=(k.getLeft()/100);f=((k.getLeft()+k.getWidth()/2)/100);a=a-d;f=f+g;m.setAttribute("x1",a+"cm");m.setAttribute("x2",f+"cm");m.setAttribute("y1",j+"cm");m.setAttribute("y2",j+"cm");if(!this.isEasyInput){this.lineDeduplication(a,j,f,j,h,m);}}}}l.appendChild(m);};mCR_exportSVG.prototype.paintCellLineLeft=function(h,d,f,c,j,g,b,k){var m=document.createElementNS("http://www.w3.org/2000/svg","line");this.paintLineStyle(d,m);var i=b+(h.getLeft()/100);var a=null;var l=null;if(!(f||c)){a=(h.getTop()/100);l=(h.getBottom()/100);a=a-j;l=l+g;m.setAttribute("x1",i+"cm");m.setAttribute("x2",i+"cm");m.setAttribute("y1",a+"cm");m.setAttribute("y2",l+"cm");if(!this.isEasyInput){this.lineDeduplication(i,a,i,l,d,m);}}else{if(f&&c){this.paintRoundLeftBottom(h,d,b,-b,k);this.paintRoundLeftTop(h,d,b,b,k);}else{if(c){this.paintRoundLeftBottom(h,d,b,-b,k);a=(h.getTop()/100);l=((h.getTop()+h.getHeight()/2)/100);a=a-j;l=l+g;m.setAttribute("x1",i+"cm");m.setAttribute("x2",i+"cm");m.setAttribute("y1",a+"cm");m.setAttribute("y2",l+"cm");if(!this.isEasyInput){this.lineDeduplication(i,a,i,l,d,m);}}else{this.paintRoundLeftTop(h,d,b,b,k);a=((h.getBottom()-h.getHeight()/2)/100);l=(h.getBottom()/100);a=a-j;l=l+g;m.setAttribute("x1",i+"cm");m.setAttribute("x2",i+"cm");m.setAttribute("y1",a+"cm");m.setAttribute("y2",l+"cm");if(!this.isEasyInput){this.lineDeduplication(i,a,i,l,d,m);}}}}k.appendChild(m);};mCR_exportSVG.prototype.paintLineFDiagonal=function(f,l,c,d,j){var k=document.createElementNS("http://www.w3.org/2000/svg","line");this.paintLineStyle(c,k);var h=0.7071;var b=(f.getLeft()/100);var a=((l.getLeft()+l.getWidth())/100);var i=(f.getTop()/100);var g=((l.getTop()+l.getHeight())/100);if(d){b+=((f.getWidth()/2*(1-h))/100);i+=((f.getHeight()/2*(1-h))/100);}if(j){a-=((l.getWidth()/2*(1-h))/100);g-=((l.getHeight()/2*(1-h))/100);}k.setAttribute("x1",b+"cm");k.setAttribute("x2",a+"cm");k.setAttribute("y1",i+"cm");k.setAttribute("y2",g+"cm");this.lineDeduplication(b,i,a,g,c,k);return k;};mCR_exportSVG.prototype.paintLineBDiagonal=function(g,l,f,d,b){var k=document.createElementNS("http://www.w3.org/2000/svg","line");this.paintLineStyle(f,k);var i=0.7071;var c=(g.getLeft()/100);var a=((l.getLeft()+l.getWidth())/100);var j=((g.getTop()+g.getHeight())/100);var h=(l.getTop()/100);if(d){c+=((g.getWidth()/2*(1-i))/100);j-=((g.getHeight()/2*(1-i))/100);}if(b){a-=((l.getWidth()/2*(1-i))/100);h+=((l.getHeight()/2*(1-i))/100);}k.setAttribute("x1",c+"cm");k.setAttribute("x2",a+"cm");k.setAttribute("y1",j+"cm");k.setAttribute("y2",h+"cm");this.lineDeduplication(c,j,a,h,f,k);return k;};mCR_exportSVG.prototype.getWidthMarginNormal=function(b,a){var c=this.getCellLineWidth(b);var d=0;if(a==mCR_LineStyle.DoubleLine||a==mCR_LineStyle.InnerLine){d=c/2+2;}else{d=(c/2)-1;if(d<0){d=0;}}return d;};mCR_exportSVG.prototype.getWidthMarginOutter=function(b,a){var c=this.getCellLineWidth(b);var d=0;if(a==mCR_LineStyle.DoubleLine||a==mCR_LineStyle.InnerLine){d=c/2*3-2;}else{d=(c/2)-1;}return d;};mCR_exportSVG.prototype.getWidthMarginInner=function(b,a){var c=this.getCellLineWidth(b);var d=0;if(a==mCR_LineStyle.DoubleLine||a==mCR_LineStyle.InnerLine){d=-1*c/2-2;}else{d=(c/2)-1;}return d;};mCR_exportSVG.prototype.getCellLineWidth=function(a){var b=4;var c=a/72*2.54;if(c<b){c=b;}return c;};mCR_exportSVG.prototype.paintCellBackground=function(m,r,q,l,a,k,o){var p=r.getRectInPage();p.setLeft(m.getLeft()+p.getLeft());p.setTop(m.getTop()+p.getTop());p.setRight(m.getLeft()+p.getRight());p.setBottom(m.getTop()+p.getBottom());var j=new Object();j.shapeType=3;var h=this.objDocument.getBackgroundStyle(r.backgroundStyleKey);if((h!=null)&&(p.getWidth()!=0&&p.getHeight()!=0)){var f=null;var c=null;if(h.getBackStyle()!=mCR_BackStyleType.Transparent){if(l||a||k||o){f=this.paintCurvedShapeStyle(p,l,a,k,o);}else{f=this.paintShapeStyle(p,j);}this.paintBackgroundStyle(p,h,f);}if(r.imageInfo.imageDataKey!=-1){if(h.getBackStyle()!=1){f.setAttribute("stroke","none");q.appendChild(f);f=this.paintShapeStyle(p,j);}else{f=this.paintShapeStyle(p,j);}var i=this.objDocument.getBackgroundImageStyle(r.imageInfo.backgroundImageStyleKey);var g=0;if(r.tableRow.table.subSection.imagePo!=null){g=r.tableRow.table.subSection.imagePo;}var d=this.objDocumentPage.getImageData(Number(r.imageInfo.imageDataKey)+g);if(i!=null&&d!=null){this.paintBackgroundImageStyle(p,i,d,f,r.imageInfo,r);}}if(r.isCheckbox){c=this.makeTableGroup(false);q.appendChild(c);this.shiftCheckboxPosition(r,p);this.exportCheckbox(r.documentCheckbox,c,true);if(r.editable){var b=r.getRectInPage();b.offsetRect(m.left,m.top);this.setCheckEditWebLinkInfo(r.documentCheckbox,b,r.editableIndex,r.documentCheckbox.checkValue);}}else{if(r.editable){var b=r.getRectInPage();b.offsetRect(m.left,m.top);this.setEditWebLinkInfo(r,b,r.detailTextInfo,r.editableIndex);}}var n=this.paintText(p,r.detailTextInfo);if(f!=null){q.appendChild(f);}if(c!=null){q.appendChild(c);}if(n!=null){q.appendChild(n);}}};mCR_exportSVG.prototype.shiftCheckboxPosition=function(b,c){var f=c;var d=b.documentCheckbox.rect;var g=d.getWidth();var a=d.getHeight();var i=f.left+((f.getWidth()-g)/2);var h=f.top+((f.getHeight()-a)/2);d.left=i;d.top=h;d.right=i+g;d.bottom=h+a;};mCR_exportSVG.prototype.exportCrosstab=function(a){var c=this.makeTableGroup(true);this.drawMatrixCells(a.matrixHeader,c);this.drawMatrixCells(a.matrixRow,c);this.drawMatrixCells(a.matrixColumn,c);this.drawMatrixCells(a.matrixSummarized,c);var b=this.makeTableGroup(false);c.appendChild(b);this.drawCrosstabOutterline(a,b);this.elmChangeGroup.appendChild(c);};mCR_exportSVG.prototype.drawMatrixCells=function(a,q){var l=a.getRowCount();var n=a.getColumnCount();var i=new docStyleShape();i.shapeType=0;for(var k=0;k<l;k++){for(var o=0;o<n;o++){var b=a.getCrosstabBaseCell(k,o);if(b.getType()==mCR_DocumentControlType.TableCell){var j=b.getRectInPage();var i=new docStyleShape();i.shapeType=0;var d=null;var g=this.objDocument.getBackgroundStyle(b.backgroundStyleKey);if(g.getBackStyle()!=mCR_BackStyleType.Transparent){d=this.paintShapeStyle(j,i);this.paintBackgroundStyle(j,g,d);}if(b.imageInfo.imageDataKey!=-1){if(g.getBackStyle()!=1){d.setAttribute("stroke","none");elmTableGroup.appendChild(d);d=this.paintShapeStyle(j,i);}else{d=this.paintShapeStyle(j,i);}var h=this.objDocument.getBackgroundImageStyle(b.imageInfo.backgroundImageStyleKey);var f=0;if(a.crosstab.subSection.imagePo!=null){f=a.crosstab.subSection.imagePo;}var c=this.objDocumentPage.getImageData(Number(b.imageInfo.imageDataKey)+f);if(h!=null&&c!=null){this.paintBackgroundImageStyle(j,h,c,d,b.imageInfo,b);}}var m=this.paintText(j,b.detailTextInfo);if(d!=null){q.appendChild(d);}if(m!=null){q.appendChild(m);}if(b.editable){this.setEditWebLinkInfo(b,b.getRectInPage(),b.detailTextInfo,b.editableIndex);}if(b.webLinkInfo!=null){if(b.webLinkInfo.type!=-1){this.setWebLinkInfo(b.getRectInPage(),b.webLinkInfo);}}if(this.isAccessibility&&null!=b.accessibilityString){var r={type:20,msg:b.accessibilityString};if(this.elmLayoutButton!=null){this.setEFormAccessInfo(this.isEasyInput?b.rect:b.getRectInPage(),r);}else{this.setWebLinkInfo(b.getRectInPage(),r);}}}}}var p=this.makeTableGroup(false);q.appendChild(p);for(var k=0;k<l;k++){for(var o=0;o<n;o++){var b=a.getCrosstabBaseCell(k,o);if(b.getType()==mCR_DocumentControlType.TableCell){this.drawCellLine(b,p);}}}};mCR_exportSVG.prototype.drawCellLine=function(d,g){var m=d.getRectInPage();var n=this.objDocument.getLineStyle(d.leftLineStyleKey);var z=this.objDocument.getLineStyle(d.topLineStyleKey);var w=this.objDocument.getLineStyle(d.rightLineStyleKey);var f=this.objDocument.getLineStyle(d.bottomLineStyleKey);var t=this.objDocument.getLineStyle(d.frontDiagonalLineStyleKey);var A=this.objDocument.getLineStyle(d.backDiagonalLineStyleKey);if(n!=null&&z!=null&&w!=null&&f!=null&&z!=null){var a=this.getWidthMarginNormal(z.width,z.style)/100;var j=this.getWidthMarginNormal(f.width,f.style)/100;var r=this.getWidthMarginNormal(n.width,n.style)/100;var v=this.getWidthMarginNormal(w.width,w.style)/100;if(n.style!=0){var p=document.createElementNS("http://www.w3.org/2000/svg","line");this.paintLineStyle(n,p);var l=(m.getLeft()/100);var h=(m.getTop()/100)-a;var q=(m.getBottom()/100)+j;p.setAttribute("x1",l+"cm");p.setAttribute("x2",l+"cm");p.setAttribute("y1",h+"cm");p.setAttribute("y2",q+"cm");this.lineDeduplication(l,h,l,q,n,p);g.appendChild(p);}if(z.style!=0){var p=document.createElementNS("http://www.w3.org/2000/svg","line");this.paintLineStyle(z,p);var k=(m.getTop()/100);var i=(m.getLeft()/100)-r;var o=(m.getRight()/100)+v;p.setAttribute("x1",i+"cm");p.setAttribute("x2",o+"cm");p.setAttribute("y1",k+"cm");p.setAttribute("y2",k+"cm");this.lineDeduplication(i,k,o,k,z,p);g.appendChild(p);}if(w.style!=0){var p=document.createElementNS("http://www.w3.org/2000/svg","line");this.paintLineStyle(w,p);var l=(m.getRight()/100);var h=(m.getTop()/100)-a;var q=(m.getBottom()/100)+j;p.setAttribute("x1",l+"cm");p.setAttribute("x2",l+"cm");p.setAttribute("y1",h+"cm");p.setAttribute("y2",q+"cm");this.lineDeduplication(l,h,l,q,w,p);g.appendChild(p);}if(f.style!=0){var p=document.createElementNS("http://www.w3.org/2000/svg","line");this.paintLineStyle(f,p);var k=(m.getBottom()/100);var i=(m.getLeft()/100)-r;var o=(m.getRight()/100)+v;p.setAttribute("x1",i+"cm");p.setAttribute("x2",o+"cm");p.setAttribute("y1",k+"cm");p.setAttribute("y2",k+"cm");this.lineDeduplication(i,k,o,k,f,p);g.appendChild(p);}if(t.style!=0){var p=document.createElementNS("http://www.w3.org/2000/svg","line");this.paintLineStyle(t,p);var u=(m.getLeft()/100);var s=((m.getLeft()+m.getWidth())/100);var c=((m.getTop()+m.getHeight())/100);var b=(m.getTop()/100);p.setAttribute("x1",u+"cm");p.setAttribute("x2",s+"cm");p.setAttribute("y1",c+"cm");p.setAttribute("y2",b+"cm");this.lineDeduplication(u,c,s,b,t,p);g.appendChild(p);}if(A.style!=0){var p=document.createElementNS("http://www.w3.org/2000/svg","line");this.paintLineStyle(A,p);var u=(m.getLeft()/100);var s=((m.getLeft()+m.getWidth())/100);var c=(m.getTop()/100);var b=((m.getTop()+m.getHeight())/100);p.setAttribute("x1",u+"cm");p.setAttribute("x2",s+"cm");p.setAttribute("y1",c+"cm");p.setAttribute("y2",b+"cm");this.lineDeduplication(u,c,s,b,A,p);g.appendChild(p);}}};mCR_exportSVG.prototype.drawCrosstabOutterline=function(b,f){var d=b.getRectInPage();var a=this.objDocument.getLineStyle(b.outterlineStyleKey);var g=new docStyleShape();g.shapeType=0;var c=null;if(a.style!=mCR_LineStyle.None){c=this.paintShapeStyle(d,g);this.paintLineStyle(a,c);}if(c!=null){f.appendChild(c);}};mCR_exportSVG.prototype.exportLabel=function(c){var j=c.getRectInPage();var l=this.objDocument.getLineStyle(c.outterlineStyleKey);var g=this.objDocument.getShapeStyle(c.shapeStyleKey);var f=this.objDocument.getBackgroundStyle(c.backgroundStyleKey);if((null!=l&&null!=g&&null!=f)&&(j.getWidth()!=0&&j.getHeight()!=0)){var b=this.paintShapeStyle(j,g);this.paintBackgroundStyle(j,f,b);if(c.imageInfo.imageDataKey!=-1){if(f.backStyle!=1){b.setAttribute("stroke","none");this.elmChangeGroup.appendChild(b);b=this.paintShapeStyle(j,g);}var h=this.objDocument.getBackgroundImageStyle(c.imageInfo.backgroundImageStyleKey);var d=0;if(c.subSection.imagePo!=null){d=c.subSection.imagePo;}var a=this.objDocumentPage.getImageData(Number(c.imageInfo.imageDataKey)+d);if(null!=h&&null!=a){this.paintBackgroundImageStyle(j,h,a,b,c.imageInfo,c);}}this.paintLineStyle(l,b);var k=this.paintText(j,c.textInfo);this.elmChangeGroup.appendChild(b);if(k!=null){this.elmChangeGroup.appendChild(k);}if(c.editable){this.setEditWebLinkInfo(c,c.getRectInPage(),c.textInfo,c.editableIndex);}if(c.webLinkInfo!=null){if(c.webLinkInfo.type!=-1){this.setWebLinkInfo(c.getRectInPage(),c.webLinkInfo);}}if(this.isAccessibility&&null!=c.accessibilityString){var i=c.accessibilityString;i=i.replace(/\@pc\@|\@pn\@/g,c.textInfo.getOriginalTextInfo().text);var m={type:20,msg:i};if(this.elmLayoutButton!=null){this.setEFormAccessInfo(this.isEasyInput?c.rect:c.getRectInPage(),m);}else{this.setWebLinkInfo(c.getRectInPage(),m);}}}};mCR_exportSVG.prototype.exportVoiceBarcode=function(o){var j=o.getRectInPage();var g=this.objDocument.getShapeStyle(o.shapeStyleKey);var f=this.objDocument.getBackgroundStyle(o.backgroundStyleKey);if((j.getWidth()!=0&&j.getHeight()!=0)){var b=null;try{b=jQuery.parseJSON(o.data);}catch(h){b=null;window.console.log("not Found VoiceBarcode data >> "+o.data);}if(null!=b){var n=null;var c=null;if(null==window.objClipClientPaintConnection||window.objClipClientPaintConnection=="get"){n=mCR_makeImageURL(this.objDocument,o.getImagePath());if(this.strPostParam!=null){n+=this.strPostParam;}c=document.createElementNS("http://www.w3.org/2000/svg","image");c.setAttribute("x",(j.left/100)+"cm");c.setAttribute("y",(j.top/100)+"cm");c.setAttribute("width",(j.getWidth()/100)+"cm");c.setAttribute("height",(j.getHeight()/100)+"cm");c.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",n);this.pageImageCount++;var a=this;c.onload=function(){a.tempImageDrawCount++;if(a.pageImageCount<=a.tempImageDrawCount){if(null!=a.callFunction){a.callFunction();}a.callFunction=null;}};c.onerror=function(){window.console.log("VoiceBarcode image error url >> "+image);a.tempImageDrawCount++;if(a.pageImageCount<=a.tempImageDrawCount){if(null!=a.callFunction){a.callFunction();}a.callFunction=null;}};}else{if(window.objClipClientPaintConnection.toLocaleLowerCase()=="post"){c=document.createElementNS("http://www.w3.org/2000/svg","image");c.setAttribute("x",(j.left/100)+"cm");c.setAttribute("y",(j.top/100)+"cm");c.setAttribute("width",(j.getWidth()/100)+"cm");c.setAttribute("height",(j.getHeight()/100)+"cm");c.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",n);this.pageImageCount++;var a=this;mCR_ServerImageCallSVG(this,o,o.getImagePath(),c);}}this.elmChangeGroup.appendChild(c);var d=new docRect();d.copyRect(j);var q=o.getBarcodeSize();var m=j.getWidth();var l=(m-q)/2;d.setLeft(j.left+l);d.setTop(j.top+13);d.setWidth(q);d.setHeight(q);var p=document.createElementNS("http://www.w3.org/2000/svg","g");var i=new mCR_SymbologyQRCode(false,p,o,d);i.drawPattern(b);this.elmChangeGroup.appendChild(p);if(o.text!=""){var k=document.createElementNS("http://www.w3.org/2000/svg","text");k.setAttribute("font-size","5pt");k.setAttribute("font-family","'NanumGothic','나눔고딕'");k.setAttribute("stroke","rgb(0,0,0)");k.setAttribute("stroke-width","0.4");k.setAttribute("x",(d.getLeft()/100)+"cm");k.setAttribute("y",((j.bottom-4)/100)+"cm");k.textContent=o.text;this.elmChangeGroup.appendChild(k);}}}};mCR_exportSVG.prototype.exportVerifyBarcode=function(i){var h=i.getRectInPage();var c=this.objDocument.getShapeStyle(i.shapeStyleKey);var b=this.objDocument.getBackgroundStyle(i.backgroundStyleKey);if((h.getWidth()!=0&&h.getHeight()!=0)){var k=h.getHeight();h.setWidth(k);var a=null;try{a=jQuery.parseJSON(i.text);}catch(f){a=null;window.console.log("not Found VerifyBarcode data >> "+i.text);}if(null!=a){var j=document.createElementNS("http://www.w3.org/2000/svg","g");for(var d=0;d<a.length;d++){var g=new mCR_SymbologyQRCode(false,j,i,h);g.drawPattern(a[d]);h.offsetRect(k+50,0);}this.elmChangeGroup.appendChild(j);}}};mCR_exportSVG.prototype.exportBarcode=function(g){var f=g.getRectInPage();var h=this.objDocument.getShapeStyle(g.shapeStyleKey);var a=this.objDocument.getBackgroundStyle(g.backgroundStyleKey);if((f.getWidth()!=0&&f.getHeight()!=0)){var c=this.paintShapeStyle(f,h);this.paintBackgroundStyle(f,a,c);c.setAttribute("stroke","none");this.elmChangeGroup.appendChild(c);var d=document.createElementNS("http://www.w3.org/2000/svg","g");this.barcodePainterDraw(d,g,f);this.elmChangeGroup.appendChild(d);if(this.isAccessibility&&null!=g.accessibilityString){var b={type:20,msg:g.accessibilityString};if(this.elmLayoutButton!=null){this.setEFormAccessInfo(this.isEasyInput?g.rect:g.getRectInPage(),b);}else{this.setWebLinkInfo(g.getRectInPage(),b);}}}};mCR_exportSVG.prototype.exportChart=function(a){if(a.dataType=="png"){this.exportChartImage(a);}else{if(a.dataType=="doc"){this.exportChartDocument(a);}}if(this.isAccessibility&&null!=a.accessibilityString){var b={type:20,msg:a.accessibilityString};if(this.elmLayoutButton!=null){this.setEFormAccessInfo(this.isEasyInput?a.rect:a.getRectInPage(),b);}else{this.setWebLinkInfo(a.getRectInPage(),b);}}if(a.webLinkInfo!=null){if(a.webLinkInfo.type!=-1){this.setWebLinkInfo(a.getRectInPage(),a.webLinkInfo);}}};mCR_exportSVG.prototype.exportChartImage=function(a){var b=a.getRectInPage();if((b.getWidth()!=0&&b.getHeight()!=0)){var d=document.createElementNS("http://www.w3.org/2000/svg","image");d.setAttribute("x",(b.left/100)+"cm");d.setAttribute("y",(b.top/100)+"cm");d.setAttribute("width",(b.getWidth()/100)+"cm");d.setAttribute("height",(b.getHeight()/100)+"cm");d.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href","data:image/png;base64,"+a.svgString);this.pageImageCount++;var c=this;if(window.objClipClientPaintConnection.toLocaleLowerCase()!="post"){d.onload=function(){c.tempImageDrawCount++;if(c.pageImageCount<=c.tempImageDrawCount){if(null!=c.callFunction){c.callFunction();}c.callFunction=null;}};d.onerror=function(){window.console.log("chart image error url >> "+a.svgString);c.tempImageDrawCount++;if(c.pageImageCount<=c.tempImageDrawCount){if(null!=c.callFunction){c.callFunction();}c.callFunction=null;}};}else{d.onload=function(){c.tempImageDrawCount++;if(c.pageImageCount<=c.tempImageDrawCount){if(c.callFunction!=null){++c.printCount;if(c.pageImageCount==c.printCount){c.callFunction();}}}};d.onerror=function(){window.console.log("chart image error url >> "+a.svgString);c.tempImageDrawCount++;if(c.pageImageCount<=c.tempImageDrawCount){if(c.callFunction!=null){++c.printCount;if(c.pageImageCount==c.printCount){c.callFunction();}}}};}this.elmChangeGroup.appendChild(d);if(a.webLinkInfo!=null){if(a.webLinkInfo.type!=-1){this.setWebLinkInfo(a.getRectInPage(),a.webLinkInfo);}}}};mCR_exportSVG.prototype.exportChartDocument=function(a){var b=document.createElementNS("http://www.w3.org/2000/svg","g");b.setAttribute("id","chart");b.setAttribute("stroke","none");b.setAttribute("fill","none");this.elmChangeGroup.appendChild(b);var d=new mCR_exportChartPaintSvg(this,b,a.getRectInPage());var c=new mCR_exportChart(d,a.svgString);c.exportt();};mCR_exportSVG.prototype.exportVoiceEye=function(a){var b=a.getRectInPage();var c=a.svgString.trim();if((b.getWidth()!=0&&b.getHeight()!=0)&&""!=c){var f=document.createElementNS("http://www.w3.org/2000/svg","image");f.setAttribute("x",(b.left/100)+"cm");f.setAttribute("y",(b.top/100)+"cm");f.setAttribute("width",(b.getWidth()/100)+"cm");f.setAttribute("height",(b.getHeight()/100)+"cm");f.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href","data:image/png;base64,"+c);this.pageImageCount++;var d=this;if(window.objClipClientPaintConnection.toLocaleLowerCase()!="post"){f.onload=function(){d.tempImageDrawCount++;if(d.pageImageCount<=d.tempImageDrawCount){if(null!=d.callFunction){d.callFunction();}d.callFunction=null;}};f.onerror=function(){window.console.log("voiceEye image error url >> "+c);d.tempImageDrawCount++;if(d.pageImageCount<=d.tempImageDrawCount){if(null!=d.callFunction){d.callFunction();}d.callFunction=null;}};}else{f.onload=function(){d.tempImageDrawCount++;if(d.callFunction!=null){++d.printCount;if(d.pageImageCount==d.printCount){d.callFunction();}}};f.onerror=function(){window.console.log("voiceEye image error url >> "+c);d.tempImageDrawCount++;if(d.callFunction!=null){++d.printCount;if(d.pageImageCount==d.printCount){d.callFunction();}}};}this.elmChangeGroup.appendChild(f);}};mCR_exportSVG.prototype.exportMarkAnyVoice=function(a){var b=a.getRectInPage();var c=a.svgString.trim();if((b.getWidth()!=0&&b.getHeight()!=0)&&""!=c){var f=document.createElementNS("http://www.w3.org/2000/svg","image");f.setAttribute("x",(b.left/100)+"cm");f.setAttribute("y",(b.top/100)+"cm");f.setAttribute("width",(b.getWidth()/100)+"cm");f.setAttribute("height",(b.getHeight()/100)+"cm");f.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href","data:image/png;base64,"+c);this.pageImageCount++;var d=this;if(window.objClipClientPaintConnection.toLocaleLowerCase()!="post"){f.onload=function(){d.tempImageDrawCount++;if(d.pageImageCount<=d.tempImageDrawCount){if(null!=d.callFunction){d.callFunction();}d.callFunction=null;}};f.onerror=function(){window.console.log("MarkAynVoice image error url >> "+c);d.tempImageDrawCount++;if(d.pageImageCount<=d.tempImageDrawCount){if(null!=d.callFunction){d.callFunction();}d.callFunction=null;}};}else{f.onload=function(){d.tempImageDrawCount++;if(d.callFunction!=null){++d.printCount;if(d.pageImageCount==d.printCount){d.callFunction();}}};f.onerror=function(){window.console.log("MarkAynVoice image error url >> "+c);d.tempImageDrawCount++;if(d.callFunction!=null){++d.printCount;if(d.pageImageCount==d.printCount){d.callFunction();}}};}this.elmChangeGroup.appendChild(f);}};mCR_exportSVG.prototype.exportReportControl=function(a){for(var b=0;b<a.subSectionList.length;b++){this.exportReportControlSubSection(a.subSectionList[b]);}for(var b=0;b<a.subSectionList.length;b++){this.exportControlsInSubSection(a.subSectionList[b]);}};mCR_exportSVG.prototype.exportCheckbox=function(a,h,d){var i=a.getRectInPage();var j=this.objDocument.getLineStyle(a.outterlineStyleKey);var f=this.objDocument.getShapeStyle(a.shapeStyleKey);if((null!=j&&null!=f)&&(i.getWidth()!=0&&i.getHeight()!=0)){var c=this.paintShapeStyle(i,f);this.paintLineStyle(j,c);h.appendChild(c);if(a.checkValue){var g=checkboxRevisePosition(i);var b=this.brushCheck(g,a.checkType,a.checkColor);h.appendChild(b);}if(this.isAccessibility&&!d&&null!=a.accessibilityString){var k={type:20,msg:a.accessibilityString};if(this.elmLayoutButton!=null){this.setEFormAccessInfo(this.isEasyInput?a.rect:a.getRectInPage(),k);}else{this.setWebLinkInfo(a.getRectInPage(),k);}}}};mCR_exportSVG.prototype.exportShape=function(f){var d=f.getRectInPage();var b=this.objDocument.getLineStyle(f.outterlineStyleKey);var g=this.objDocument.getShapeStyle(f.shapeStyleKey);var a=this.objDocument.getBackgroundStyle(f.backgroundStyleKey);if((null!=b&&null!=g&&null!=a)&&(d.getWidth()!=0&&d.getHeight()!=0)&&(b.style!=0||a.backStyle!=1)){var c=this.paintShapeStyle(d,g);this.paintBackgroundStyle(d,a,c);this.paintLineStyle(b,c);this.elmChangeGroup.appendChild(c);}};mCR_exportSVG.prototype.exportLine=function(b){var c=b.getRectInPage();var a=this.objDocument.getLineStyle(b.lineStyleKey);if(null!=a&&a.style!=0){var d=document.createElementNS("http://www.w3.org/2000/svg","line");this.paintLineStyle(a,d);d.setAttribute("x1",(c.left/100)+"cm");d.setAttribute("x2",(c.right/100)+"cm");d.setAttribute("y1",(c.top/100)+"cm");d.setAttribute("y2",(c.bottom/100)+"cm");this.lineDeduplication(c.left,c.top,c.right,c.bottom,a,d);this.elmChangeGroup.appendChild(d);}};mCR_exportSVG.prototype.paintBackgroundImageStyle=function(g,h,c,f,b,a){if("null"==c.filePath||0==c.imageWidth||0==c.imageHeight){return;}var d=h.imageDrawMethod;switch(d){case 1:this.imageOriginalSize(g,h,c,f,b,a);break;case 2:this.imageStretch(g,h,c,f,b,a);break;case 3:this.imageTile(g,h,c,f,b,a);break;case 4:this.imageZoom(g,h,c,f,b,a);break;case 5:this.imageShrink(g,h,c,f,b,a);break;}};mCR_exportSVG.prototype.paintBackgroundStyle=function(c,a,b){if(a.backStyle==1){return;}if(a.gradientStyle==0){switch(a.fillStyle){case 0:b.setAttribute("fill",mCR_getStrColor(a.backColor));break;case 1:this.patternHorizontalLine(a,b);break;case 2:this.patternVerticalLine(a,b);break;case 3:this.patternCrossLine(a,b);break;case 4:this.patternBackDiagonalLine(a,b);break;case 5:this.patternFrontDiagonalLine(a,b);break;case 6:this.patternCrossDiagonalLine(a,b);break;case 7:this.patternDotDensed(a,b);break;case 8:this.patternDot(a,b);break;case 9:this.patternDotRare(a,b);break;}}else{switch(a.gradientStyle){case 1:this.gradientTopBottom(c,a,b);break;case 2:this.gradientBottomTop(c,a,b);break;case 3:this.gradientLeftRight(c,a,b);break;case 4:this.gradientRightLeft(c,a,b);break;case 5:this.gradientRadial(c,a,b);break;case 6:this.gradientDiagonalF(c,a,b);break;case 7:this.gradientDiagonalB(c,a,b);break;}}};mCR_exportSVG.prototype.paintShapeStyle=function(b,c){var a=null;if(c.shapeType==1){a=document.createElementNS("http://www.w3.org/2000/svg","ellipse");a.setAttribute("cx",((b.left/100)+(b.getWidth()/200))+"cm");a.setAttribute("cy",((b.top/100)+(b.getHeight()/200))+"cm");a.setAttribute("rx",(b.getWidth()/200)+"cm");a.setAttribute("ry",(b.getHeight()/200)+"cm");}else{a=document.createElementNS("http://www.w3.org/2000/svg","rect");a.setAttribute("x",(b.left/100)+"cm");a.setAttribute("y",(b.top/100)+"cm");a.setAttribute("width",(b.getWidth()/100)+"cm");a.setAttribute("height",(b.getHeight()/100)+"cm");if(c.shapeType==2){a.setAttribute("rx",(Math.min(b.getWidth(),b.getHeight())*this.nPixelRate*c.roundRate/2/100)+"px");a.setAttribute("ry",(Math.min(b.getWidth(),b.getHeight())*this.nPixelRate*c.roundRate/2/100)+"px");}}return a;};mCR_exportSVG.prototype.paintCurvedShapeStyle=function(r,o,c,l,q){var i=null;i=document.createElementNS("http://www.w3.org/2000/svg","path");var n="";if(o){var a=((r.getLeft())*0.378).toFixed(2);var k=((r.getTop()+r.getHeight()/2)*0.37795275591).toFixed(2);var m=((r.getTop())*0.37795275591).toFixed(2);var d=(((r.getLeft()+r.getWidth()/2)*0.378)).toFixed(2);var g=((r.getTop())*0.37795275591).toFixed(2);n="M"+a+" "+k+" C"+a+" "+k+" "+a+" "+m+" "+d+" "+g;}else{var a=((r.getLeft())*0.378).toFixed(2);var k=((r.getTop()+r.getHeight()/2)*0.37795275591).toFixed(2);var d=(((r.getLeft()+r.getWidth()/2)*0.378)).toFixed(2);var g=((r.getTop())*0.37795275591).toFixed(2);n="M"+a+" "+k+" L"+a+" "+g+" L"+d+" "+g;}if(c){var h=(r.getRight()*0.378).toFixed(2);var b=((r.getTop())*0.37795275591).toFixed(2);var g=((r.getTop()+r.getHeight()/2)*0.37795275591).toFixed(2);n+=(" C"+h+" "+b+" "+h+" "+g+" "+h+" "+g);}else{var h=(r.getRight()*0.378).toFixed(2);var b=((r.getTop())*0.37795275591).toFixed(2);var g=((r.getTop()+r.getHeight()/2)*0.37795275591).toFixed(2);n+=(" L"+h+" "+b+"  L"+h+" "+g);}if(q){var h=(r.getRight()*0.378).toFixed(2);var j=((r.getBottom()-r.getHeight()/2)*0.37795275591).toFixed(2);var p=(((r.getRight()-r.getWidth()/2)*0.378)).toFixed(2);var f=((r.getBottom())*0.37795275591).toFixed(2);n+=(" C"+h+" "+j+" "+h+" "+f+" "+p+" "+f);}else{var h=(r.getRight()*0.378).toFixed(2);var p=(((r.getRight()-r.getWidth()/2)*0.378)).toFixed(2);var f=((r.getBottom())*0.37795275591).toFixed(2);n+=(" L"+h+" "+f+" L"+p+" "+f);}if(l){var a=((r.getLeft())*0.378).toFixed(2);var j=((r.getBottom()-r.getHeight()/2)*0.37795275591).toFixed(2);var d=(((r.getLeft()+r.getWidth()/2)*0.378)).toFixed(2);var f=((r.getBottom())*0.37795275591).toFixed(2);n+=(" C"+d+" "+f+" "+a+" "+f+" "+a+" "+j);}else{var a=((r.getLeft())*0.378).toFixed(2);var j=((r.getBottom()-r.getHeight()/2)*0.37795275591).toFixed(2);var f=((r.getBottom())*0.37795275591).toFixed(2);n+=(" L"+a+" "+f+" L"+a+" "+j);}i.setAttribute("d",n);return i;};mCR_exportSVG.prototype.paintLineStyle=function(a,c,d){if(typeof d=="undefined"){d=false;}if(a.style==0){c.setAttribute("stroke","none");return;}if(a.width>75||d){c.setAttribute("stroke-width",(a.width/100)+"pt");}if(a.color!=0){c.setAttribute("stroke",mCR_getStrColor(a.color));}var b=a.width>100?a.width/100:1;switch(a.style){case 2:c.setAttribute("stroke-dasharray",(4*b)+","+(2*b));break;case 3:c.setAttribute("stroke-dasharray",(1.333*b)+","+(1.333*b));break;case 4:c.setAttribute("stroke-dasharray",(4*b)+","+(2*b)+","+(1.333*b)+","+(2*b));break;case 5:c.setAttribute("stroke-dasharray",(4*b)+","+(2*b)+","+(1.333*b)+","+(2*b)+","+(1.333*b)+","+(2*b));break;case 7:case 9:c.setAttribute("stroke-width",((a.width*1.5)/100)+"pt");break;case 11:c.setAttribute("stroke-dasharray",(4*5/3*b)+","+(4*b));break;}};mCR_exportSVG.prototype.setDefaultGroupStyle=function(){this.elmChangeGroup.setAttribute("stroke-linecap","butt");this.elmChangeGroup.setAttribute("stroke-width","0.75pt");this.elmChangeGroup.setAttribute("stroke","rgb(0,0,0)");this.elmChangeGroup.setAttribute("fill","none");};mCR_exportSVG.prototype.makeTextGroup=function(a,d){var c=document.createElementNS("http://www.w3.org/2000/svg","g");var f=this.objDocument.getFontStyle(d);if(f!=null){if(f.bold){c.setAttribute("font-weight","bold");}c.setAttribute("stroke","none");c.setAttribute("fill",mCR_getStrColor(f.color));if(f.italic){c.setAttribute("font-style","italic");}var b=this.objDocument.getFontNameStyle(f.nameEngIndex);if(b=="나눔고딕"||b=="NanumGothic"){c.setAttribute("font-family","'"+b+"','"+this.objDocument.getFontNameStyle(f.nameIndex)+"'");}else{c.setAttribute("font-family","'"+this.objDocument.getFontNameStyle(f.nameIndex)+"','"+b+"'");}c.setAttribute("font-size",f.size+"pt");if(f.underline||f.strike){}}return c;};mCR_exportSVG.prototype.paintText=function(d,k){if(k.getTextLineCount()>0){var t=k.getOriginalTextInfo().getFontStyleKey();var h=this.makeTextGroup(k,t);var d=d;var n=this.objDocument.getTextMarginStyle(k.getOriginalTextInfo().getTextMarginStyleKey());if(k.getUseMultiLanguage()||this.objDocument.getUseMultiLanguage()){d.setLeft(d.getLeft()+n.left);d.setRight(d.getRight()-n.right);d.setTop(d.getTop()+n.top);d.setBottom(d.getBottom()-n.bottom);var y=this.objDocument.getTextOptionStyle(k.getOriginalTextInfo().getTextOptionStyleKey());var a=y.getHorizontalAlignment();var s=y.getVerticalAlignment();var o=this.objDocument.getFontStyle(t);var m=d.getTop();var g=k.getHeight();if(mCR_VerticalAlignmentMethod.Bottom==s){m=d.getBottom()-g-(g*0.15);}else{if(mCR_VerticalAlignmentMethod.Center==s){m=(d.getBottom()+d.getTop()-g)/2;}}var b=k.getTextLineCount();for(var u=0;u<b;u++){var v=k.getTextLine(u);var x=d.getLeft();var w=m+v.getHeight();w+=v.getY();if(w<=d.getBottom()+(g*0.15)){var r=document.createElementNS("http://www.w3.org/2000/svg","text");if(o!=null){if(o.bold){r.setAttribute("font-weight","bold");}r.setAttribute("stroke","none");r.setAttribute("fill",mCR_getStrColor(o.color));if(o.italic){r.setAttribute("font-style","italic");}var c=this.objDocument.getFontNameStyle(o.nameEngIndex);if(c=="나눔고딕"||c=="NanumGothic"){r.setAttribute("font-family","'"+decodeURIComponent(c)+"','"+decodeURIComponent(this.objDocument.getFontNameStyle(o.nameIndex))+"'");}else{r.setAttribute("font-family","'"+decodeURIComponent(this.objDocument.getFontNameStyle(o.nameIndex))+"','"+decodeURIComponent(c)+"'");}r.setAttribute("font-size",o.size+"pt");}r.textContent=v.getText();var q=0;if(mCR_HorizontalAlignmentMethod.Right==a){q=this.getTextCanvasWidth(o,v);x=d.getRight()-q*254/96;}else{if(mCR_HorizontalAlignmentMethod.Middle==a){q=this.getTextCanvasWidth(o,v);x=(d.getRight()+d.getLeft()-q*254/96)/2;}}var l=k.getOriginalTextInfo().getCharDirection();if(l==0){}else{var f=1==l?true:false;if(f){r.setAttribute("direction","rtl");if(mCR_isIE){}else{x=d.getRight();if(mCR_HorizontalAlignmentMethod.Left==a){q=this.getTextCanvasWidth(o,v,true);x=d.getLeft()+q*254/96;}else{if(mCR_HorizontalAlignmentMethod.Middle==a){q=this.getTextCanvasWidth(o,v,true);x=d.getRight()-(d.getWidth()-q*254/96)/2;}}}}else{}}r.setAttribute("x",((x)/100)+"cm");r.setAttribute("y",((w)/100)+"cm");h.appendChild(r);}else{break;}}}else{var p=k.getOriginalTextInfo().getTextRotation();var j=d.getHeight();if(p==90){h.setAttribute("transform","rotate(270,"+d.getLeft()*0.378+","+d.getTop()*0.378+") translate("+d.getHeight()*0.378*(-1)+",0)");j=d.getWidth();}else{if(p==180){h.setAttribute("transform","rotate(180,"+d.getLeft()*0.378+","+d.getTop()*0.378+") translate("+d.getWidth()*0.378*(-1)+","+d.getHeight()*0.378*(-1)+")");}else{if(p==270){h.setAttribute("transform","rotate(90,"+d.getLeft()*0.378+","+d.getTop()*0.378+") translate(0,"+d.getWidth()*0.378*(-1)+")");j=d.getWidth();}}}this.drawTextLine(d,n,j,p,k,h,t);}return h;}else{return null;}};mCR_exportSVG.prototype.getTextCanvasWidth=function(i,h,f){if(this.elmCanvas==null){this.elmCanvas=document.createElement("canvas");}var c="";if(i.italic){c="italic ";}var d="";if(i.bold){d="bold ";}var b=this.elmCanvas.getContext("2d");if(f&&f!=null){b.direction="rtl";}else{b.direction="inherit";}var g=this.objDocument.getFontNameStyle(i.nameEngIndex);if(g=="나눔고딕"||g=="NanumGothic"){b.font=c+d+i.size+"pt '"+g+"'";}else{b.font=c+d+i.size+"pt '"+this.objDocument.getFontNameStyle(i.nameIndex)+"'";}var a=h.getText();return b.measureText(a).width;};mCR_exportSVG.prototype.drawTextShape=function(m,d,a,j){var c=a.getTextShapeCount();var n=null;if(c!=0){n=document.createElementNS("http://www.w3.org/2000/svg","g");n.setAttribute("stroke-linecap","butt");n.setAttribute("stroke-width","0.75pt");n.setAttribute("stroke","rgb(0,0,0)");n.setAttribute("fill","none");}for(var h=0;h<c;h++){var b=a.getTextShape(h);var g=b.rect;var o=this.objDocument.getLineStyle(b.lineStyleKey);var l=b.shapeType;if(null!=o&&o.style!=0){if(l==0){var p=document.createElementNS("http://www.w3.org/2000/svg","line");this.paintLineStyle(o,p);p.setAttribute("x1",((g.getLeft()+m.getLeft())/100)+"cm");p.setAttribute("x2",((g.getWidth()+m.getLeft())/100)+"cm");p.setAttribute("y1",((m.getTop()+g.getTop())/100)+"cm");p.setAttribute("y2",((m.getTop()+g.getTop())/100)+"cm");n.appendChild(p);if(o.style==mCR_LineStyle.DoubleLine){var d=this.getCellLineWidth(o.width);var k=m.getTop()+g.getTop()-(d*2);var p=document.createElementNS("http://www.w3.org/2000/svg","line");this.paintLineStyle(o,p);p.setAttribute("x1",((g.getLeft()+m.getLeft())/100)+"cm");p.setAttribute("x2",((g.getWidth()+m.getLeft())/100)+"cm");p.setAttribute("y1",((k)/100)+"cm");p.setAttribute("y2",((k)/100)+"cm");n.appendChild(p);}}else{if(l==2){var f=null;f=document.createElementNS("http://www.w3.org/2000/svg","rect");f.setAttribute("x",((g.getLeft()+m.getLeft())/100)+"cm");f.setAttribute("y",((m.getTop()+g.getTop())/100)+"cm");f.setAttribute("width",(g.getWidth()/100)+"cm");f.setAttribute("height",(g.getHeight()/100)+"cm");f.setAttribute("rx",(g.getWidth()/200)+"cm");f.setAttribute("ry",(g.getHeight()/200)+"cm");this.paintLineStyle(o,f,true);n.appendChild(f);}else{var f=null;f=document.createElementNS("http://www.w3.org/2000/svg","rect");f.setAttribute("x",((g.getLeft()+m.getLeft())/100)+"cm");f.setAttribute("y",((m.getTop()+g.getTop())/100)+"cm");f.setAttribute("width",(g.getWidth()/100)+"cm");f.setAttribute("height",(g.getHeight()/100)+"cm");this.paintLineStyle(o,f,true);n.appendChild(f);}}}}if(c!=0){j.appendChild(n);}};mCR_exportSVG.prototype.drawCharacter=function(l,b,d,h,k,n,a){var g=b.getCharacterCount();for(var f=0;f<g;f++){var o=b.getCharacter(f);var m=document.createElementNS("http://www.w3.org/2000/svg","text");if(k!=null){if(k.bold){m.setAttribute("font-weight","bold");}m.setAttribute("stroke","none");m.setAttribute("fill",mCR_getStrColor(k.color));if(k.italic){m.setAttribute("font-style","italic");}var j=this.objDocument.getFontNameStyle(k.nameEngIndex);if(j=="나눔고딕"||j=="NanumGothic"){m.setAttribute("font-family","'"+decodeURIComponent(j)+"','"+decodeURIComponent(this.objDocument.getFontNameStyle(k.nameIndex))+"'");}else{m.setAttribute("font-family","'"+decodeURIComponent(this.objDocument.getFontNameStyle(k.nameIndex))+"','"+decodeURIComponent(j)+"'");}m.setAttribute("font-size",k.size+"pt");}if(b.getIsSmallChar()){m.setAttribute("font-size",n.size*0.65+"pt");}else{if(b.getIsSup()||b.getIsSub()){m.setAttribute("font-size",n.size*0.5+"pt");}}var c=b.getCharMode();switch(c){case 0:m.setAttribute("x",((o.getX()+l.getLeft())/100)+"cm");m.setAttribute("y",((d)/100)+"cm");break;case 1:m.setAttribute("transform","scale(1,2)");m.setAttribute("x",((o.getX()+l.getLeft())/100)+"cm");m.setAttribute("y",((d)/100)/2+"cm");break;case 2:m.setAttribute("transform","scale(2,1)");m.setAttribute("x",((o.getX()+l.getLeft())/100)/2+"cm");m.setAttribute("y",((d)/100)+"cm");break;case 3:m.setAttribute("transform","scale(2,2)");m.setAttribute("x",((o.getX()+l.getLeft())/100)/2+"cm");m.setAttribute("y",((d)/100)/2+"cm");break;}m.textContent=o.getCharacter();h.appendChild(m);}};mCR_exportSVG.prototype.adjustDescent=function(d,c,i){var h=d.getTop()+c.getY();var f=i.getIsSmallChar();var g=i.getIsSup();var b=i.getIsSub();var a=c.getHeight();if(g||b){a=a*0.5;if(b){h=h+a;}}else{if(f){a=a*0.65;h+=a;h=h-a*0.8;}}h=h+a-a*0.15;return h;};mCR_exportSVG.prototype.drawTextLine=function(j,d,l,m,c,h,g){var b=c.getTextLineCount();var k=this.objDocument.getFontStyle(g);for(var f=0;f<b;f++){var a=c.getTextLine(f);if(m==0||m==180){if((a.getY2()<=l+a.getHeight()*0.15)||(f==0&&(a.getY()<j.getHeight()))){this.drawCharacterBatch(j,a,h,g,c,k);}else{break;}}else{if(a.getY2()<=l+a.getHeight()*0.15){this.drawCharacterBatch(j,a,h,g,c,k);}else{break;}}this.drawTextShape(j,d,a,h);}};mCR_exportSVG.prototype.drawCharacterBatch=function(k,a,h,g,b,l){var m=a.getCharacterBatchCount();for(var f=0;f<m;f++){var c=a.getCharacterBatch(f);var j=null;if(c.getFontStyleKey()!=g){j=this.objDocument.getFontStyle(c.getFontStyleKey());}var d=this.adjustDescent(k,a,c);this.drawCharacter(k,c,d,h,j,l,a);}};mCR_exportSVG.prototype.lineDeduplication=function(c,g,i,a,d,h){var b=new Array();b.push(c);b.push(g);b.push(i);b.push(a);b.push(d.style);b.push(d.width);b.push(d.color);var j=b.join(",");var f=this.objLineHashMap[j];if(null!=f){f.parentNode.removeChild(f);}this.objLineHashMap[j]=h;};mCR_exportSVG.prototype.setEFormAccessInfo=function(d,f){var b=document.createElement("span");var g=function(j,i){if(null!=i){var h=i.replace(/\'/g,"작은따옴표");h=h.replace(/\"/g,"큰따옴표");h=h.replace(/\<\/?(b|B|i|I|u|U|s|S|c|C|o|O|r|R|p|P|d|D|br|BR|Font|size|SIZE|FONT)\>/g,"");j.setAttribute("role","text");j.setAttribute("aria-label",h);}};if(null!=f.ctrl){var a=d.toString();var c=this.objAccHashMap[a];if(null!=c){if(f.type==20){c.type=20;c.msg=c.msg+f.msg;g(c.elmSpan,c.msg);return;}}else{f.elmSpan=b;this.objAccHashMap[a]=f;}}g(b,f.msg);b.tabIndex="0";if(this.nAccessibilityLevel==1){b.tabIndex="-1";}b.style.cssText="position:absolute;border:0 !important; padding: 0px 0px 0px 0px !important;color:gray;font-size:9pt;text-align:left;";b.style.left=(d.left*0.378)+"px";b.style.top=(d.top*0.378)+"px";b.style.width=(d.getWidth()*0.378)+"px";b.style.height=(d.getHeight()*0.378)+"px";this.elmLayoutButton.appendChild(b);};mCR_exportSVG.prototype.setWebLinkInfo=function(c,f){var d={rect:c,info:f};if(null!=f.ctrl){var a=c.toString();var b=this.objAccHashMap[a];if(null!=b){if(f.type==20){b.type=20;b.msg=b.msg+f.msg;return;}}else{this.objAccHashMap[a]=f;}}this.webLinkList.push(d);};mCR_exportSVG.prototype.setEditWebLinkInfo=function(j,g,c,f){var a=new docWebLinkInfo();a.type=1;a.editableIndex=f;a.editText=c.getOriginalTextInfo().text;a.objControl=j;var d=c.getOriginalTextInfo().getFontStyleKey();var i=this.objDocument.getFontStyle(d);var h=this.objDocument.getFontNameStyle(i.nameEngIndex);if(h=="나눔고딕"||h=="NanumGothic"){a.fontStyle="font-size:"+i.size+"pt;font-family:'"+h+"';";}else{a.fontStyle="font-size:"+i.size+"pt;font-family:'"+this.objDocument.getFontNameStyle(i.nameIndex)+"';";}var b={rect:g,info:a};this.webLinkList.push(b);};mCR_exportSVG.prototype.setCheckEditWebLinkInfo=function(b,c,a,f,h){var g=new docWebLinkInfo();g.type=4;g.editableIndex=f;g.objControl=b;g.isChecked=h;var d={rect:c,info:g};this.webLinkList.push(d);};mCR_exportSVG.prototype.setInputControlInfo=function(b,a){var c={rect:b,info:{type:10,ctrlName:a}};this.webLinkList.push(c);};mCR_exportSVG.prototype.brushCheck=function(j,b,c){var g=null;switch(b){case 0:g=document.createElementNS("http://www.w3.org/2000/svg","polygon");var k="";var f=j.left*0.378;var l=j.right*0.378;var i=j.top*0.378;var a=j.bottom*0.378;var d=(l-f)/6;var m=(a-i)/6;k+=(f+(d*0))+","+(i+(d*2))+" ";k+=(f+(d*2))+","+(i+(d*4))+" ";k+=(f+(d*6))+","+(i+(d*0))+" ";k+=(f+(d*6))+","+(i+(d*2))+" ";k+=(f+(d*2))+","+(i+(d*6))+" ";k+=(f+(d*0))+","+(i+(d*4));g.setAttribute("points",k);break;case 1:g=document.createElementNS("http://www.w3.org/2000/svg","rect");g.setAttribute("x",(j.left/100)+"cm");g.setAttribute("y",(j.top/100)+"cm");g.setAttribute("width",(j.getWidth()/100)+"cm");g.setAttribute("height",(j.getHeight()/100)+"cm");break;case 2:g=document.createElementNS("http://www.w3.org/2000/svg","ellipse");g.setAttribute("cx",((j.left/100)+(j.getWidth()/200))+"cm");g.setAttribute("cy",((j.top/100)+(j.getHeight()/200))+"cm");g.setAttribute("rx",(j.getWidth()/200)+"cm");g.setAttribute("ry",(j.getHeight()/200)+"cm");break;case 3:g=document.createElementNS("http://www.w3.org/2000/svg","rect");g.setAttribute("x",(j.left/100)+"cm");g.setAttribute("y",(j.top/100)+"cm");g.setAttribute("width",(j.getWidth()/100)+"cm");g.setAttribute("height",(j.getHeight()/100)+"cm");var h=(((j.getWidth()/2)*0.3)/100);g.setAttribute("rx",h+"cm");g.setAttribute("ry",h+"cm");break;}g.setAttribute("fill",mCR_getStrColor(c));g.setAttribute("stroke","none");return g;};mCR_exportSVG.prototype.gradientTopBottom=function(f,b,d){var a=mCR_UUID();var c=document.createElementNS("http://www.w3.org/2000/svg","linearGradient");c.setAttribute("id","gradient"+a);c.setAttribute("gradientUnits","userSpaceOnUse");c.setAttribute("spreadMethod","pad");c.setAttribute("x1",(f.left/100)+"cm");c.setAttribute("x2",(f.left/100)+"cm");c.setAttribute("y1",(f.top/100)+"cm");c.setAttribute("y2",(f.bottom/100)+"cm");var g=document.createElementNS("http://www.w3.org/2000/svg","stop");g.setAttribute("stop-opacity","1");g.setAttribute("offset","0%");g.setAttribute("stop-color",mCR_getStrColor(b.gradientStartColor));c.appendChild(g);g=document.createElementNS("http://www.w3.org/2000/svg","stop");g.setAttribute("stop-opacity","1");g.setAttribute("offset","100%");g.setAttribute("stop-color",mCR_getStrColor(b.gradientEndColor));c.appendChild(g);this.elmdefs.appendChild(c);d.setAttribute("fill","url(#gradient"+a+")");};mCR_exportSVG.prototype.gradientBottomTop=function(f,b,d){var a=mCR_UUID();var c=document.createElementNS("http://www.w3.org/2000/svg","linearGradient");c.setAttribute("id","gradient"+a);c.setAttribute("gradientUnits","userSpaceOnUse");c.setAttribute("spreadMethod","pad");c.setAttribute("x1",(f.left/100)+"cm");c.setAttribute("x2",(f.left/100)+"cm");c.setAttribute("y1",(f.top/100)+"cm");c.setAttribute("y2",(f.bottom/100)+"cm");var g=document.createElementNS("http://www.w3.org/2000/svg","stop");g.setAttribute("stop-opacity","1");g.setAttribute("offset","0%");g.setAttribute("stop-color",mCR_getStrColor(b.gradientEndColor));c.appendChild(g);g=document.createElementNS("http://www.w3.org/2000/svg","stop");g.setAttribute("stop-opacity","1");g.setAttribute("offset","100%");g.setAttribute("stop-color",mCR_getStrColor(b.gradientStartColor));c.appendChild(g);this.elmdefs.appendChild(c);d.setAttribute("fill","url(#gradient"+a+")");};mCR_exportSVG.prototype.gradientLeftRight=function(f,b,d){var a=mCR_UUID();var c=document.createElementNS("http://www.w3.org/2000/svg","linearGradient");c.setAttribute("id","gradient"+a);c.setAttribute("gradientUnits","userSpaceOnUse");c.setAttribute("spreadMethod","pad");c.setAttribute("x1",(f.left/100)+"cm");c.setAttribute("x2",(f.right/100)+"cm");c.setAttribute("y1",(f.top/100)+"cm");c.setAttribute("y2",(f.top/100)+"cm");var g=document.createElementNS("http://www.w3.org/2000/svg","stop");g.setAttribute("stop-opacity","1");g.setAttribute("offset","0%");g.setAttribute("stop-color",mCR_getStrColor(b.gradientStartColor));c.appendChild(g);g=document.createElementNS("http://www.w3.org/2000/svg","stop");g.setAttribute("stop-opacity","1");g.setAttribute("offset","100%");g.setAttribute("stop-color",mCR_getStrColor(b.gradientEndColor));c.appendChild(g);this.elmdefs.appendChild(c);d.setAttribute("fill","url(#gradient"+a+")");};mCR_exportSVG.prototype.gradientRightLeft=function(f,b,d){var a=mCR_UUID();var c=document.createElementNS("http://www.w3.org/2000/svg","linearGradient");c.setAttribute("id","gradient"+a);c.setAttribute("gradientUnits","userSpaceOnUse");c.setAttribute("spreadMethod","pad");c.setAttribute("x1",(f.left/100)+"cm");c.setAttribute("x2",(f.right/100)+"cm");c.setAttribute("y1",(f.top/100)+"cm");c.setAttribute("y2",(f.top/100)+"cm");var g=document.createElementNS("http://www.w3.org/2000/svg","stop");g.setAttribute("stop-opacity","1");g.setAttribute("offset","0%");g.setAttribute("stop-color",mCR_getStrColor(b.gradientEndColor));c.appendChild(g);g=document.createElementNS("http://www.w3.org/2000/svg","stop");g.setAttribute("stop-opacity","1");g.setAttribute("offset","100%");g.setAttribute("stop-color",mCR_getStrColor(b.gradientStartColor));c.appendChild(g);this.elmdefs.appendChild(c);d.setAttribute("fill","url(#gradient"+a+")");};mCR_exportSVG.prototype.gradientDiagonalF=function(f,b,d){var a=mCR_UUID();var c=document.createElementNS("http://www.w3.org/2000/svg","linearGradient");c.setAttribute("id","gradient"+a);c.setAttribute("gradientUnits","userSpaceOnUse");c.setAttribute("spreadMethod","pad");c.setAttribute("x1",(f.left/100)+"cm");c.setAttribute("x2",(f.right/100)+"cm");c.setAttribute("y1",(f.top/100)+"cm");c.setAttribute("y2",(f.bottom/100)+"cm");var g=document.createElementNS("http://www.w3.org/2000/svg","stop");g.setAttribute("stop-opacity","1");g.setAttribute("offset","0%");g.setAttribute("stop-color",mCR_getStrColor(b.gradientStartColor));c.appendChild(g);g=document.createElementNS("http://www.w3.org/2000/svg","stop");g.setAttribute("stop-opacity","1");g.setAttribute("offset","100%");g.setAttribute("stop-color",mCR_getStrColor(b.gradientEndColor));c.appendChild(g);this.elmdefs.appendChild(c);d.setAttribute("fill","url(#gradient"+a+")");};mCR_exportSVG.prototype.gradientDiagonalB=function(f,b,d){var a=mCR_UUID();var c=document.createElementNS("http://www.w3.org/2000/svg","linearGradient");c.setAttribute("id","gradient"+a);c.setAttribute("gradientUnits","userSpaceOnUse");c.setAttribute("spreadMethod","pad");c.setAttribute("x1",(f.right/100)+"cm");c.setAttribute("x2",(f.left/100)+"cm");c.setAttribute("y1",(f.top/100)+"cm");c.setAttribute("y2",(f.bottom/100)+"cm");var g=document.createElementNS("http://www.w3.org/2000/svg","stop");g.setAttribute("stop-opacity","1");g.setAttribute("offset","0%");g.setAttribute("stop-color",mCR_getStrColor(b.gradientStartColor));c.appendChild(g);g=document.createElementNS("http://www.w3.org/2000/svg","stop");g.setAttribute("stop-opacity","1");g.setAttribute("offset","100%");g.setAttribute("stop-color",mCR_getStrColor(b.gradientEndColor));c.appendChild(g);this.elmdefs.appendChild(c);d.setAttribute("fill","url(#gradient"+a+")");};mCR_exportSVG.prototype.gradientRadial=function(f,b,d){var a=mCR_UUID();var c=document.createElementNS("http://www.w3.org/2000/svg","radialGradient");c.setAttribute("id","gradient"+a);c.setAttribute("spreadMethod","pad");c.setAttribute("color-interpolation","sRGB");c.setAttribute("fx","50%");c.setAttribute("fy","50%");c.setAttribute("r","65%");var g=document.createElementNS("http://www.w3.org/2000/svg","stop");g.setAttribute("stop-opacity","1");g.setAttribute("offset","0%");g.setAttribute("stop-color",mCR_getStrColor(b.gradientStartColor));c.appendChild(g);g=document.createElementNS("http://www.w3.org/2000/svg","stop");g.setAttribute("stop-opacity","1");g.setAttribute("offset","100%");g.setAttribute("stop-color",mCR_getStrColor(b.gradientEndColor));c.appendChild(g);this.elmdefs.appendChild(c);d.setAttribute("fill","url(#gradient"+a+")");};mCR_exportSVG.prototype.patternHorizontalLine=function(d,g){var c=0.18;var b=mCR_UUID();var f=document.createElementNS("http://www.w3.org/2000/svg","pattern");f.setAttribute("id","pattern"+b);f.setAttribute("x","0cm");f.setAttribute("y","0cm");f.setAttribute("width",c+"cm");f.setAttribute("height",c+"cm");f.setAttribute("patternUnits","userSpaceOnUse");var a=document.createElementNS("http://www.w3.org/2000/svg","rect");a.setAttribute("x","0cm");a.setAttribute("y","0cm");a.setAttribute("width",c+"cm");a.setAttribute("height",c+"cm");a.setAttribute("fill",mCR_getStrColor(d.backColor));f.appendChild(a);var h=document.createElementNS("http://www.w3.org/2000/svg","line");h.setAttribute("stroke",mCR_getStrColor(d.fillColor));h.setAttribute("stroke-width","0.75pt");h.setAttribute("x1","0cm");h.setAttribute("x2",c+"cm");h.setAttribute("y1",(c/2)+"cm");h.setAttribute("y2",(c/2)+"cm");f.appendChild(h);this.elmdefs.appendChild(f);g.setAttribute("fill","url(#pattern"+b+")");};mCR_exportSVG.prototype.patternVerticalLine=function(d,g){var c=0.18;var b=mCR_UUID();var f=document.createElementNS("http://www.w3.org/2000/svg","pattern");f.setAttribute("id","pattern"+b);f.setAttribute("x","0cm");f.setAttribute("y","0cm");f.setAttribute("width",c+"cm");f.setAttribute("height",c+"cm");f.setAttribute("patternUnits","userSpaceOnUse");var a=document.createElementNS("http://www.w3.org/2000/svg","rect");a.setAttribute("x","0cm");a.setAttribute("y","0cm");a.setAttribute("width",c+"cm");a.setAttribute("height",c+"cm");a.setAttribute("fill",mCR_getStrColor(d.backColor));f.appendChild(a);var h=document.createElementNS("http://www.w3.org/2000/svg","line");h.setAttribute("stroke",mCR_getStrColor(d.fillColor));h.setAttribute("stroke-width","0.75pt");h.setAttribute("x1",(c/2)+"cm");h.setAttribute("x2",(c/2)+"cm");h.setAttribute("y1","0cm");h.setAttribute("y2",c+"cm");f.appendChild(h);this.elmdefs.appendChild(f);g.setAttribute("fill","url(#pattern"+b+")");};mCR_exportSVG.prototype.patternCrossLine=function(d,g){var c=0.18;var b=mCR_UUID();var f=document.createElementNS("http://www.w3.org/2000/svg","pattern");f.setAttribute("id","pattern"+b);f.setAttribute("x","0cm");f.setAttribute("y","0cm");f.setAttribute("width",c+"cm");f.setAttribute("height",c+"cm");f.setAttribute("patternUnits","userSpaceOnUse");var a=document.createElementNS("http://www.w3.org/2000/svg","rect");a.setAttribute("x","0cm");a.setAttribute("y","0cm");a.setAttribute("width",c+"cm");a.setAttribute("height",c+"cm");a.setAttribute("fill",mCR_getStrColor(d.backColor));f.appendChild(a);var h=document.createElementNS("http://www.w3.org/2000/svg","line");h.setAttribute("stroke",mCR_getStrColor(d.fillColor));h.setAttribute("stroke-width","0.75pt");h.setAttribute("x1",(c/2)+"cm");h.setAttribute("x2",(c/2)+"cm");h.setAttribute("y1","0cm");h.setAttribute("y2",c+"cm");f.appendChild(h);h=document.createElementNS("http://www.w3.org/2000/svg","line");h.setAttribute("stroke",mCR_getStrColor(d.fillColor));h.setAttribute("stroke-width","0.75pt");h.setAttribute("x1","0cm");h.setAttribute("x2",c+"cm");h.setAttribute("y1",(c/2)+"cm");h.setAttribute("y2",(c/2)+"cm");f.appendChild(h);this.elmdefs.appendChild(f);g.setAttribute("fill","url(#pattern"+b+")");};mCR_exportSVG.prototype.patternBackDiagonalLine=function(d,g){var c=0.18;var b=mCR_UUID();var f=document.createElementNS("http://www.w3.org/2000/svg","pattern");f.setAttribute("id","pattern"+b);f.setAttribute("x","0cm");f.setAttribute("y","0cm");f.setAttribute("width",c+"cm");f.setAttribute("height",c+"cm");f.setAttribute("patternUnits","userSpaceOnUse");var a=document.createElementNS("http://www.w3.org/2000/svg","rect");a.setAttribute("x","0cm");a.setAttribute("y","0cm");a.setAttribute("width",c+"cm");a.setAttribute("height",c+"cm");a.setAttribute("fill",mCR_getStrColor(d.backColor));f.appendChild(a);var h=document.createElementNS("http://www.w3.org/2000/svg","line");h.setAttribute("stroke",mCR_getStrColor(d.fillColor));h.setAttribute("stroke-width","0.75pt");h.setAttribute("x1","0cm");h.setAttribute("x2",c+"cm");h.setAttribute("y1","0cm");h.setAttribute("y2",c+"cm");f.appendChild(h);h=document.createElementNS("http://www.w3.org/2000/svg","line");h.setAttribute("stroke",mCR_getStrColor(d.fillColor));h.setAttribute("stroke-width","0.75pt");h.setAttribute("x1",c+"cm");h.setAttribute("x2",c+"cm");h.setAttribute("y1","0cm");h.setAttribute("y2","0cm");f.appendChild(h);h=document.createElementNS("http://www.w3.org/2000/svg","line");h.setAttribute("stroke",mCR_getStrColor(d.fillColor));h.setAttribute("stroke-width","0.75pt");h.setAttribute("x1","0cm");h.setAttribute("x2","0cm");h.setAttribute("y1",c+"cm");h.setAttribute("y2",c+"cm");f.appendChild(h);this.elmdefs.appendChild(f);g.setAttribute("fill","url(#pattern"+b+")");};mCR_exportSVG.prototype.patternFrontDiagonalLine=function(d,g){var c=0.18;var b=mCR_UUID();var f=document.createElementNS("http://www.w3.org/2000/svg","pattern");f.setAttribute("id","pattern"+b);f.setAttribute("x","0cm");f.setAttribute("y","0cm");f.setAttribute("width",c+"cm");f.setAttribute("height",c+"cm");f.setAttribute("patternUnits","userSpaceOnUse");var a=document.createElementNS("http://www.w3.org/2000/svg","rect");a.setAttribute("x","0cm");a.setAttribute("y","0cm");a.setAttribute("width",c+"cm");a.setAttribute("height",c+"cm");a.setAttribute("fill",mCR_getStrColor(d.backColor));f.appendChild(a);var h=document.createElementNS("http://www.w3.org/2000/svg","line");h.setAttribute("stroke",mCR_getStrColor(d.fillColor));h.setAttribute("stroke-width","0.75pt");h.setAttribute("x1",c+"cm");h.setAttribute("x2","0cm");h.setAttribute("y1","0cm");h.setAttribute("y2",c+"cm");f.appendChild(h);h=document.createElementNS("http://www.w3.org/2000/svg","line");h.setAttribute("stroke",mCR_getStrColor(d.fillColor));h.setAttribute("stroke-width","0.75pt");h.setAttribute("x1","0cm");h.setAttribute("x2","0cm");h.setAttribute("y1","0cm");h.setAttribute("y2","0cm");f.appendChild(h);h=document.createElementNS("http://www.w3.org/2000/svg","line");h.setAttribute("stroke",mCR_getStrColor(d.fillColor));h.setAttribute("stroke-width","0.75pt");h.setAttribute("x1",c+"cm");h.setAttribute("x2",c+"cm");h.setAttribute("y1",c+"cm");h.setAttribute("y2",c+"cm");f.appendChild(h);this.elmdefs.appendChild(f);g.setAttribute("fill","url(#pattern"+b+")");};mCR_exportSVG.prototype.patternCrossDiagonalLine=function(d,g){var c=0.18;var b=mCR_UUID();var f=document.createElementNS("http://www.w3.org/2000/svg","pattern");f.setAttribute("id","pattern"+b);f.setAttribute("x","0cm");f.setAttribute("y","0cm");f.setAttribute("width",c+"cm");f.setAttribute("height",c+"cm");f.setAttribute("patternUnits","userSpaceOnUse");var a=document.createElementNS("http://www.w3.org/2000/svg","rect");a.setAttribute("x","0cm");a.setAttribute("y","0cm");a.setAttribute("width",c+"cm");a.setAttribute("height",c+"cm");a.setAttribute("fill",mCR_getStrColor(d.backColor));f.appendChild(a);var h=document.createElementNS("http://www.w3.org/2000/svg","line");h.setAttribute("stroke",mCR_getStrColor(d.fillColor));h.setAttribute("stroke-width","0.75pt");h.setAttribute("x1",c+"cm");h.setAttribute("x2","0cm");h.setAttribute("y1","0cm");h.setAttribute("y2",c+"cm");f.appendChild(h);h=document.createElementNS("http://www.w3.org/2000/svg","line");h.setAttribute("stroke",mCR_getStrColor(d.fillColor));h.setAttribute("stroke-width","0.75pt");h.setAttribute("x1","0cm");h.setAttribute("x2",c+"cm");h.setAttribute("y1","0cm");h.setAttribute("y2",c+"cm");f.appendChild(h);this.elmdefs.appendChild(f);g.setAttribute("fill","url(#pattern"+b+")");};mCR_exportSVG.prototype.patternDotDensed=function(d,g){var c=0.08;var b=mCR_UUID();var f=document.createElementNS("http://www.w3.org/2000/svg","pattern");f.setAttribute("id","pattern"+b);f.setAttribute("x","0cm");f.setAttribute("y","0cm");f.setAttribute("width",(c)+"cm");f.setAttribute("height",(c)+"cm");f.setAttribute("patternUnits","userSpaceOnUse");var a=document.createElementNS("http://www.w3.org/2000/svg","rect");a.setAttribute("x","0cm");a.setAttribute("y","0cm");a.setAttribute("width",(c)+"cm");a.setAttribute("height",(c)+"cm");a.setAttribute("fill",mCR_getStrColor(d.backColor));f.appendChild(a);var a=document.createElementNS("http://www.w3.org/2000/svg","rect");a.setAttribute("x","0cm");a.setAttribute("y","0cm");a.setAttribute("width","1");a.setAttribute("height","1");a.setAttribute("fill",mCR_getStrColor(d.fillColor));f.appendChild(a);a=document.createElementNS("http://www.w3.org/2000/svg","rect");a.setAttribute("x",(c/2)+"cm");a.setAttribute("y",(c/2)+"cm");a.setAttribute("width","1");a.setAttribute("height","1");a.setAttribute("fill",mCR_getStrColor(d.fillColor));f.appendChild(a);this.elmdefs.appendChild(f);g.setAttribute("fill","url(#pattern"+b+")");};mCR_exportSVG.prototype.patternDot=function(d,g){var c=0.14;var b=mCR_UUID();var f=document.createElementNS("http://www.w3.org/2000/svg","pattern");f.setAttribute("id","pattern"+b);f.setAttribute("x","0cm");f.setAttribute("y","0cm");f.setAttribute("width",(c)+"cm");f.setAttribute("height",(c)+"cm");f.setAttribute("patternUnits","userSpaceOnUse");var a=document.createElementNS("http://www.w3.org/2000/svg","rect");a.setAttribute("x","0cm");a.setAttribute("y","0cm");a.setAttribute("width",(c)+"cm");a.setAttribute("height",(c)+"cm");a.setAttribute("fill",mCR_getStrColor(d.backColor));f.appendChild(a);var a=document.createElementNS("http://www.w3.org/2000/svg","rect");a.setAttribute("x","0cm");a.setAttribute("y","0cm");a.setAttribute("width","1");a.setAttribute("height","1");a.setAttribute("fill",mCR_getStrColor(d.fillColor));f.appendChild(a);a=document.createElementNS("http://www.w3.org/2000/svg","rect");a.setAttribute("x",(c/2)+"cm");a.setAttribute("y",(c/2)+"cm");a.setAttribute("width","1");a.setAttribute("height","1");a.setAttribute("fill",mCR_getStrColor(d.fillColor));f.appendChild(a);this.elmdefs.appendChild(f);g.setAttribute("fill","url(#pattern"+b+")");};mCR_exportSVG.prototype.patternDotRare=function(d,g){var c=0.2;var b=mCR_UUID();var f=document.createElementNS("http://www.w3.org/2000/svg","pattern");f.setAttribute("id","pattern"+b);f.setAttribute("x","0cm");f.setAttribute("y","0cm");f.setAttribute("width",(c)+"cm");f.setAttribute("height",(c)+"cm");f.setAttribute("patternUnits","userSpaceOnUse");var a=document.createElementNS("http://www.w3.org/2000/svg","rect");a.setAttribute("x","0cm");a.setAttribute("y","0cm");a.setAttribute("width",(c)+"cm");a.setAttribute("height",(c)+"cm");a.setAttribute("fill",mCR_getStrColor(d.backColor));f.appendChild(a);var a=document.createElementNS("http://www.w3.org/2000/svg","rect");a.setAttribute("x","0cm");a.setAttribute("y","0cm");a.setAttribute("width","1");a.setAttribute("height","1");a.setAttribute("fill",mCR_getStrColor(d.fillColor));f.appendChild(a);a=document.createElementNS("http://www.w3.org/2000/svg","rect");elmShape.setAttribute("x",(rect.left/100)+"cm");elmShape.setAttribute("y",(rect.top/100)+"cm");elmShape.setAttribute("width",(rect.getWidth()/100)+"cm");elmShape.setAttribute("height",(rect.getHeight()/100)+"cm");a.setAttribute("fill",mCR_getStrColor(d.fillColor));f.appendChild(a);this.elmdefs.appendChild(f);g.setAttribute("fill","url(#pattern"+b+")");};mCR_exportSVG.prototype.imageTile=function(h,f,d,g,m){var c=mCR_UUID();d.dpiX=d.dpiX>1?d.dpiX:96;d.dpiY=d.dpiY>1?d.dpiY:96;var i=(d.imageWidth/d.dpiX)*96;var j=(d.imageHeight/d.dpiY)*96;i=i*(f.rate/100);j=j*(f.rate/100);var l=document.createElementNS("http://www.w3.org/2000/svg","pattern");l.setAttribute("id","pattern"+c);l.setAttribute("x",(h.left/100)+"cm");l.setAttribute("y",(h.top/100)+"cm");l.setAttribute("width",i+"");l.setAttribute("height",j+"");l.setAttribute("patternUnits","userSpaceOnUse");var k=null;var b=null;if(null==window.objClipClientPaintConnection||window.objClipClientPaintConnection=="get"){k=mCR_makeImageURL(this.objDocument,d.filePath);if(this.strPostParam!=null){k+=this.strPostParam;}b=document.createElementNS("http://www.w3.org/2000/svg","image");b.setAttribute("x","0");b.setAttribute("y","0");b.setAttribute("width",i+"");b.setAttribute("height",j+"");b.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",k);b.setAttribute("preserveAspectRatio","none");this.pageImageCount++;var a=this;b.onload=function(){a.tempImageDrawCount++;if(a.pageImageCount<=a.tempImageDrawCount){if(null!=a.callFunction){a.callFunction();}a.callFunction=null;}};b.onerror=function(){window.console.log("img image error url >> "+k);a.tempImageDrawCount++;if(a.pageImageCount<=a.tempImageDrawCount){if(null!=a.callFunction){a.callFunction();}a.callFunction=null;}};}else{if(window.objClipClientPaintConnection.toLocaleLowerCase()=="post"){b=document.createElementNS("http://www.w3.org/2000/svg","image");b.setAttribute("x","0");b.setAttribute("y","0");b.setAttribute("width",i+"");b.setAttribute("height",j+"");b.setAttribute("preserveAspectRatio","none");this.pageImageCount++;var a=this;mCR_ServerImageCallSVG(this,m,d.filePath,b);}}l.appendChild(b);this.elmdefs.appendChild(l);g.setAttribute("fill","url(#pattern"+c+")");};mCR_exportSVG.prototype.imageStretch=function(i,f,d,g,k,m){var c=mCR_UUID();var l=this;var j=null;var b=null;if(null==window.objClipClientPaintConnection||window.objClipClientPaintConnection=="get"){j=mCR_makeImageURL(this.objDocument,d.filePath);if(this.strPostParam!=null){j+=this.strPostParam;}b=document.createElementNS("http://www.w3.org/2000/svg","image");b.setAttribute("x",(i.left/100)+"cm");b.setAttribute("y",(i.top/100)+"cm");b.setAttribute("width",(i.getWidth()/100)+"cm");b.setAttribute("height",(i.getHeight()/100)+"cm");if(k.startPosition==0&&k.endPosition==100){b.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",j);}else{var h=new Image();h.src=j;h.onload=function(){var p=document.createElement("canvas");var v=p.getContext("2d");var o=i.left*l.nPixelRate;var r=i.top*l.nPixelRate;var n=i.getWidth()*l.nPixelRate;var u=i.getHeight()*l.nPixelRate;var t=d.imageHeight*k.startPosition/100;var s=d.imageHeight*k.endPosition/100;var q=s-t;p.width=n;p.height=q;v.drawImage(h,0,t,d.imageWidth,q,0,0,n,q);b.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",p.toDataURL("image/jpeg",1));};h.onerror=function(){window.console.log("image error url cropped >> "+j);};}b.setAttribute("preserveAspectRatio","none");this.pageImageCount++;var a=this;b.onload=function(){a.tempImageDrawCount++;if(a.pageImageCount<=a.tempImageDrawCount){if(null!=a.callFunction){a.callFunction();}a.callFunction=null;}};b.onerror=function(){window.console.log("img image error url >> "+j);a.tempImageDrawCount++;if(a.pageImageCount<=a.tempImageDrawCount){if(null!=a.callFunction){a.callFunction();}a.callFunction=null;}};}else{if(window.objClipClientPaintConnection.toLocaleLowerCase()=="post"){b=document.createElementNS("http://www.w3.org/2000/svg","image");b.setAttribute("x",(i.left/100)+"cm");b.setAttribute("y",(i.top/100)+"cm");b.setAttribute("width",(i.getWidth()/100)+"cm");b.setAttribute("height",(i.getHeight()/100)+"cm");b.setAttribute("preserveAspectRatio","none");this.pageImageCount++;var a=this;if(k.startPosition==0&&k.endPosition==100){mCR_ServerImageCallSVG(this,m,d.filePath,b);}else{mCR_ServerCutStretchImageCallSVG(l,m,d.filePath,b,d,k,i);}}}this.elmChangeGroup.appendChild(b);};mCR_exportSVG.prototype.imageNotPatternOriginalSize=function(k,f,d,i,o){var n=0;var h=0;d.dpiX=d.dpiX>1?d.dpiX:96;d.dpiY=d.dpiY>1?d.dpiY:96;var l=(d.imageWidth/d.dpiX)*96;var j=(d.imageHeight/d.dpiY)*96;l=l*(f.rate/100);j=j*(f.rate/100);if(f.horizontalAlignment==1){var c=(k.getWidth()*0.378);if(c>l){n=(c-l)/2;}}else{if(f.horizontalAlignment==2){var c=(k.getWidth()*0.378);if(c>l){n=c-l;}}}if(f.verticalAlignment==1){var g=(k.getHeight()*0.378);if(g>j){h=(g-j)/2;}}else{if(f.verticalAlignment==2){var g=(k.getHeight()*0.378);if(g>j){h=(g-j);}}}var m=null;var b=null;if(null==window.objClipClientPaintConnection||window.objClipClientPaintConnection=="get"){m=mCR_makeImageURL(this.objDocument,d.filePath);if(this.strPostParam!=null){m+=this.strPostParam;}b=document.createElementNS("http://www.w3.org/2000/svg","image");b.setAttribute("x",(n+(k.left*0.378))+"");b.setAttribute("y",(h+(k.top*0.378))+"");b.setAttribute("width",l+"");b.setAttribute("height",j+"");b.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",m);this.pageImageCount++;var a=this;b.onload=function(){a.tempImageDrawCount++;if(a.pageImageCount<=a.tempImageDrawCount){if(null!=a.callFunction){a.callFunction();}a.callFunction=null;}};b.onerror=function(){window.console.log("img image error url >> "+m);a.tempImageDrawCount++;if(a.pageImageCount<=a.tempImageDrawCount){if(null!=a.callFunction){a.callFunction();}a.callFunction=null;}};}else{if(window.objClipClientPaintConnection.toLocaleLowerCase()=="post"){b=document.createElementNS("http://www.w3.org/2000/svg","image");b.setAttribute("x",(n+(k.left*0.378))+"");b.setAttribute("y",(h+(k.top*0.378))+"");b.setAttribute("width",l+"");b.setAttribute("height",j+"");this.pageImageCount++;var a=this;mCR_ServerImageCallSVG(this,o,d.filePath,b);}}this.elmChangeGroup.appendChild(b);};mCR_exportSVG.prototype.imageOriginalSize=function(b,i,h,g,s,x){if(mCR_checkImageRect(b,i,h,s)){if(s.startPosition==0&&s.endPosition==100){this.imageNotPatternOriginalSize(b,i,h,g,x);return;}}var p=mCR_UUID();var o=document.createElementNS("http://www.w3.org/2000/svg","pattern");o.setAttribute("id","pattern"+p);o.setAttribute("x",(b.left/100)+"cm");o.setAttribute("y",(b.top/100)+"cm");o.setAttribute("width",(b.getWidth()/100)+"cm");o.setAttribute("height",(b.getHeight()/100)+"cm");o.setAttribute("patternUnits","userSpaceOnUse");var c=0;var j=0;h.dpiX=h.dpiX>1?h.dpiX:96;h.dpiY=h.dpiY>1?h.dpiY:96;var l=(h.imageWidth/h.dpiX)*96;var v=(h.imageHeight/h.dpiY)*96;l=l*(i.rate/100);v=v*(i.rate/100);if(i.horizontalAlignment==1){var a=(b.getWidth()*0.378);if(a>l){c=(a-l)/2;}}else{if(i.horizontalAlignment==2){var a=(b.getWidth()*0.378);if(a>l){c=a-l;}}}if(s.startPosition==0&&s.endPosition==100){if(i.verticalAlignment==1){var t=(b.getHeight()*0.378);if(t>v){j=(t-v)/2;}}else{if(i.verticalAlignment==2){var t=(b.getHeight()*0.378);if(t>v){j=(t-v);}}}}else{var f=0;var t=(b.getHeight()*0.378);var n=t/(s.endPosition-s.startPosition)*100;if(n<=v){var q=h.imageHeight*n/v;f=q*s.startPosition/100;j=-f;}else{var u=n*s.startPosition/100;var y=n*s.endPosition/100;var k=0;var m=0;if(i.verticalAlignment==0){m=n-v;}else{if(i.verticalAlignment==1){k=(n-v)/2;m=(n-v)/2;}else{if(i.verticalAlignment==2){k=(n-v);}}}if(u>(n-m)||y<k){return;}if(u<k){f=(k-u);}else{f=-1*(u-k);}j+=f;}}var w=null;var r=null;if(null==window.objClipClientPaintConnection||window.objClipClientPaintConnection=="get"){w=mCR_makeImageURL(this.objDocument,h.filePath);if(this.strPostParam!=null){w+=this.strPostParam;}r=document.createElementNS("http://www.w3.org/2000/svg","image");r.setAttribute("x",c+"");r.setAttribute("y",j+"");r.setAttribute("width",l+"");r.setAttribute("height",v+"");r.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",w);this.pageImageCount++;var d=this;r.onload=function(){d.tempImageDrawCount++;if(d.pageImageCount<=d.tempImageDrawCount){if(null!=d.callFunction){d.callFunction();}d.callFunction=null;}};r.onerror=function(){window.console.log("img image error url >> "+w);d.tempImageDrawCount++;if(d.pageImageCount<=d.tempImageDrawCount){if(null!=d.callFunction){d.callFunction();}d.callFunction=null;}};}else{if(window.objClipClientPaintConnection.toLocaleLowerCase()=="post"){r=document.createElementNS("http://www.w3.org/2000/svg","image");r.setAttribute("x",c+"");r.setAttribute("y",j+"");r.setAttribute("width",l+"");r.setAttribute("height",v+"");this.pageImageCount++;var d=this;mCR_ServerImageCallSVG(this,x,h.filePath,r);}}o.appendChild(r);this.elmdefs.appendChild(o);g.setAttribute("fill","url(#pattern"+p+")");};mCR_exportSVG.prototype.imageZoom=function(c,j,i,g,u,F){if(u.startPosition==0&&u.endPosition==100){var b=(c.getWidth()*0.378);var w=(c.getHeight()*0.378);var d=0;var l=0;i.dpiX=i.dpiX>1?i.dpiX:96;i.dpiY=i.dpiY>1?i.dpiY:96;var p=(i.imageWidth/i.dpiX)*96;var z=(i.imageHeight/i.dpiY)*96;var y=p/z;var k=b/w;if(y>k){var G=z/p;z=b*G;p=b;if(j.verticalAlignment==1){if(w>z){l=(w-z)/2;}}else{if(j.verticalAlignment==2){if(w>z){l=(w-z);}}}}else{var G=p/z;p=w*G;z=w;if(j.horizontalAlignment==1){if(b>p){d=(b-p)/2;}}else{if(j.horizontalAlignment==2){if(b>p){d=b-p;}}}}if(u.margine!=null){d+=(parseInt(u.margine)*0.378);}var C=null;var t=null;if(null==window.objClipClientPaintConnection||window.objClipClientPaintConnection=="get"){C=mCR_makeImageURL(this.objDocument,i.filePath);if(this.strPostParam!=null){C+=this.strPostParam;}t=document.createElementNS("http://www.w3.org/2000/svg","image");t.setAttribute("x",(d+(c.left*0.378))+"");t.setAttribute("y",(l+(c.top*0.378))+"");t.setAttribute("width",p+"");t.setAttribute("height",z+"");t.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",C);this.pageImageCount++;var f=this;t.onload=function(){f.tempImageDrawCount++;if(f.pageImageCount<=f.tempImageDrawCount){if(null!=f.callFunction){f.callFunction();}f.callFunction=null;}};t.onerror=function(){window.console.log("img image error url >> "+C);f.tempImageDrawCount++;if(f.pageImageCount<=f.tempImageDrawCount){if(null!=f.callFunction){f.callFunction();}f.callFunction=null;}};}else{if(window.objClipClientPaintConnection.toLocaleLowerCase()=="post"){t=document.createElementNS("http://www.w3.org/2000/svg","image");t.setAttribute("x",(d+(c.left*0.378))+"");t.setAttribute("y",(l+(c.top*0.378))+"");t.setAttribute("width",p+"");t.setAttribute("height",z+"");this.pageImageCount++;mCR_ServerImageCallSVG(this,F,i.filePath,t);var f=this;}}this.elmChangeGroup.appendChild(t);}else{var r=this;var h=c.left*r.nPixelRate;var s=c.top*r.nPixelRate;var D=c.right*r.nPixelRate;var n=c.bottom*r.nPixelRate;var b=D-h;var w=n-s;var v=w;w=w/(u.endPosition-u.startPosition)*100;var d=0;var l=0;i.dpiX=i.dpiX>1?i.dpiX:96;i.dpiY=i.dpiY>1?i.dpiY:96;var p=(i.imageWidth/i.dpiX)*96;var z=(i.imageHeight/i.dpiY)*96;var y=p/z;var k=b/w;var a=i.imageHeight*u.startPosition/100;var o=i.imageHeight*u.endPosition/100;var E=o-a;if(y>k){var G=z/p;z=b*G;var B=z/i.imageHeight;p=b;var x=w*u.startPosition/100;var H=w*(100-u.endPosition)/100;var m=0;var q=0;if(j.verticalAlignment==0){if(w>z){q=(w-z);}}else{if(j.verticalAlignment==1){if(w>z){m=(w-z)/2;q=(w-z)/2;}}else{if(j.verticalAlignment==2){if(w>z){m=(w-z);}}}}if(x>=m){a=i.imageHeight*(x-m)/z;l=0;}else{l=m-x;}if(H>q){o=i.imageHeight*(w-H-m)/z;E=o-a;z=w-H-m;}else{if(x==0&&H!=0){o=i.imageHeight;}else{if(H==0&&x<m){a=0;}}E=o-a;z=E*B;}}else{var G=p/z;p=w*G;z=v;if(j.horizontalAlignment==1){if(b>p){d=(b-p)/2;}}else{if(j.horizontalAlignment==2){if(b>p){d=b-p;}}}}d+=h;l+=s;if(z<0){z=0;}var C=null;var t=null;if(null==window.objClipClientPaintConnection||window.objClipClientPaintConnection=="get"){C=mCR_makeImageURL(this.objDocument,i.filePath);if(this.strPostParam!=null){C+=this.strPostParam;}t=document.createElementNS("http://www.w3.org/2000/svg","image");t.setAttribute("x",d+"");t.setAttribute("y",l+"");t.setAttribute("width",p+"");t.setAttribute("height",z+"");var A=new Image();A.src=C;A.onload=function(){var J=document.createElement("canvas");var I=J.getContext("2d");J.width=p;J.height=E;I.drawImage(A,0,a,i.imageWidth,E,0,0,p,E);t.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",J.toDataURL("image/jpeg",1));};A.onerror=function(){window.console.log("image error url cropped >> "+C);};t.setAttribute("preserveAspectRatio","none");this.pageImageCount++;var f=this;t.onload=function(){f.tempImageDrawCount++;if(f.pageImageCount<=f.tempImageDrawCount){if(null!=f.callFunction){f.callFunction();}f.callFunction=null;}};t.onerror=function(){window.console.log("img image error url >> "+C);f.tempImageDrawCount++;if(f.pageImageCount<=f.tempImageDrawCount){if(null!=f.callFunction){f.callFunction();}f.callFunction=null;}};}else{if(window.objClipClientPaintConnection.toLocaleLowerCase()=="post"){t=document.createElementNS("http://www.w3.org/2000/svg","image");t.setAttribute("x",d+"");t.setAttribute("y",l+"");t.setAttribute("width",p+"");t.setAttribute("height",z+"");t.setAttribute("preserveAspectRatio","none");this.pageImageCount++;var f=this;mCR_ServerCutZoomImageCallSVG(this,F,i.filePath,t,p,E,a,i);}}this.elmChangeGroup.appendChild(t);}};mCR_exportSVG.prototype.imageShrink=function(f,g,c,d,b,a){if(mCR_checkImageRect(f,g,c,b)){if(b.startPosition==0&&b.endPosition==100){this.imageNotPatternOriginalSize(f,g,c,d,a);}else{this.imageOriginalSize(f,g,c,d,b,a);}}else{this.imageZoom(f,g,c,d,b,a);}};function mCR_checkImageRect(h,i,c,b){var g=(h.getWidth()*0.378);var f=(h.getHeight()*0.378);f=f/(b.endPosition-b.startPosition)*100;c.dpiX=c.dpiX>1?c.dpiX:96;c.dpiY=c.dpiY>1?c.dpiY:96;var d=(c.imageWidth/c.dpiX)*96;var a=(c.imageHeight/c.dpiY)*96;d=d*(i.rate/100);a=a*(i.rate/100);if(g>=d&&f>=a){return true;}else{return false;}}function mCR_makeImageURL(f,d){var g={image:d,reportkey:f.reportKey};var c=f.reportServerPath;var h="?";if(c.indexOf("?")!=-1){h="&";}var a=h+"uid="+f.reportKey+"&clipUID="+f.reportKey+"&ClipType=exportViewImage&ClipData="+encodeURIComponent(JSON.stringify(g));var b=f.reportServerPath+a;return b;}function mCR_makeImageSendData(c,b){var d={image:b,reportkey:c.reportKey};var a="uid="+c.reportKey+"&clipUID="+c.reportKey+"&ClipType=exportViewImageBase64&ClipData="+encodeURIComponent(JSON.stringify(d));return a;}function mCR_getStrColor(d){var c=d&255;var b=(d>>8)&255;var a=(d>>16)&255;return"rgb("+c+","+b+","+a+")";}function mCR_UUID(){var a=[];var d;var c=window.crypto||window.msCrypto;for(var b=0;b<32;b++){d=new Uint8Array(1);c.getRandomValues(d);a.push((d[0]%16).toString(16));}return a.join("");}mCR_exportSVG.prototype.barcodePainterDraw=function(c,d,b){var a=null;switch(d.barcodeSymbology){case 1:a=new mCR_SymbologyCode39(false,c,d,b);break;case 2:a=new mCR_SymbologyCode39A(false,c,d,b);break;case 3:a=new mCR_SymbologyCode93(false,c,d,b);break;case 4:a=new mCR_SymbologyCode93A(false,c,d,b);break;case 5:a=new mCR_SymbologyCodaBar(false,c,d,b);break;case 6:a=new mCR_SymbologyCode11(false,c,d,b);break;case 10:a=new mCR_SymbologyCode128(false,c,d,b);break;case 11:a=new mCR_SymbologyCode128A(false,c,d,b);break;case 12:a=new mCR_SymbologyCode128B(false,c,d,b);break;case 13:a=new mCR_SymbologyCode128C(false,c,d,b);break;case 15:a=new mCR_Symbology2of5IATA(false,c,d,b);break;case 16:a=new mCR_Symbology2of5Matrix(false,c,d,b);break;case 17:a=new mCR_Symbology2of5Industrial(false,c,d,b);break;case 18:a=new mCR_Symbology2of5Interleaved(false,c,d,b);break;case 20:a=new mCR_SymbologyEAN8(false,c,d,b);break;case 21:a=new mCR_SymbologyEAN13(false,c,d,b);break;case 40:a=new mCR_SymbologyKoreanPostalCode(false,c,d,b);break;case 50:a=new mCR_SymbologyQRCode(false,c,d,b);break;case 51:a=new mCR_SymbologyDataMatrix(false,c,d,b);break;case 52:a=new mCR_SymbologyPDF417(false,c,d,b);break;case 101:a=new mCR_SymbologyGS1_128(false,c,d,b);break;case 102:a=new mCR_SymbologyITF14(false,c,d,b);break;}if(null!=a){a.drawBarcode();}};function mCR_ServerCutStretchImageCallSVG(m,n,h,b,f,l,j){if("null"==h){return;}if(window.objClipClientPaintConnection.toLocaleLowerCase()=="post"){var d=m_reportHashMap[m.objDocument.reportKey];if(null!=d){var k=d.getProperty(h);if(null!=k){if(typeof k==="string"){var i=new Image();i.src="data:image/png;base64,"+k;n.imageKey=m.pageImageList.length;m.pageImageList.push(i);i.onload=function(){m.tempImageDrawCount++;if(m.pageImageList!=null){var q=document.createElement("canvas");var p=q.getContext("2d");var s=j.getWidth()*m.nPixelRate;var r=f.imageHeight*l.startPosition/100;var t=f.imageHeight*l.endPosition/100;var o=t-r;q.width=s;q.height=o;p.drawImage(i,0,r,f.imageWidth,o,0,0,s,o);b.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",q.toDataURL("image/jpeg",1));if(m.callFunction!=null){++m.printCount;if(m.pageImageCount==m.printCount){m.callFunction();}}}};return;}else{n.imageKey=k;}var c=m.pageImageList[k];if(null!=c){return;}}}n.imageKey=m.pageImageList.length;m.pageImageList.push(null);if(null!=d){d.setProperty(h,n.imageKey);}var g=mCR_makeImageSendData(m.objDocument,h);if(m.strPostParam!=null){g+=m.strPostParam;}var a=m.objDocument.reportServerPath;$.ajax({type:"POST",url:a,data:g,success:function(o){try{var r=jQuery.parseJSON(o);if(null!=r){if(r.resValue.status){var p=new Image();p.src="data:image/png;base64,"+r.resValue.viewData;m.pageImageList[n.imageKey]=p;d.setProperty(h,r.resValue.viewData);p.onload=function(){m.tempImageDrawCount++;if(m.pageImageList!=null){var u=document.createElement("canvas");var t=u.getContext("2d");var w=j.getWidth()*m.nPixelRate;var v=f.imageHeight*l.startPosition/100;var x=f.imageHeight*l.endPosition/100;var s=x-v;u.width=w;u.height=s;t.drawImage(p,0,v,f.imageWidth,s,0,0,w,s);b.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",u.toDataURL("image/jpeg",1));if(m.callFunction!=null){++m.printCount;if(m.pageImageCount==m.printCount){m.callFunction();}}}};}else{window.console.log("image server error code >> "+r.resValue.event);window.console.log("image ID >> "+h);m.tempImageDrawCount++;if(m.pageImageList!=null){if(m.pageImageList.length<=m.tempImageDrawCount){}}}}}catch(q){window.console.log("image server json code error >> "+o);window.console.log("image ID >> "+h);m.tempImageDrawCount++;if(m.pageImageList!=null){if(m.pageImageList.length<=m.tempImageDrawCount){}}}},error:function(o){window.console.log("image connection error >> "+o);window.console.log("image ID >> "+h);m.tempImageDrawCount++;if(m.pageImageList!=null){if(m.pageImageList.length<=m.tempImageDrawCount){}}},beforeSend:function(o){if(mCR_isAddRequestHeader){o.setRequestHeader(mCR_strRequestHeaderName,mCR_strRequestHeaderValue);}}});}}function mCR_ServerCutZoomImageCallSVG(n,o,i,b,k,h,m,f){if("null"==i){return;}if(window.objClipClientPaintConnection.toLocaleLowerCase()=="post"){var d=m_reportHashMap[n.objDocument.reportKey];if(null!=d){var l=d.getProperty(i);if(null!=l){if(typeof l==="string"){var j=new Image();j.src="data:image/png;base64,"+l;o.imageKey=n.pageImageList.length;n.pageImageList.push(j);j.onload=function(){n.tempImageDrawCount++;if(n.pageImageList!=null){var q=document.createElement("canvas");var p=q.getContext("2d");q.width=k;q.height=h;p.drawImage(j,0,m,f.imageWidth,h,0,0,k,h);b.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",q.toDataURL("image/jpeg",1));if(n.callFunction!=null){++n.printCount;if(n.pageImageCount==n.printCount){n.callFunction();}}}};return;}else{o.imageKey=l;}var c=n.pageImageList[l];if(null!=c){return;}}}o.imageKey=n.pageImageList.length;n.pageImageList.push(null);if(null!=d){d.setProperty(i,o.imageKey);}var g=mCR_makeImageSendData(n.objDocument,i);if(n.strPostParam!=null){g+=n.strPostParam;}var a=n.objDocument.reportServerPath;$.ajax({type:"POST",url:a,data:g,success:function(p){try{var s=jQuery.parseJSON(p);if(null!=s){if(s.resValue.status){var q=new Image();q.src="data:image/png;base64,"+s.resValue.viewData;n.pageImageList[o.imageKey]=q;d.setProperty(i,s.resValue.viewData);q.onload=function(){n.tempImageDrawCount++;if(n.pageImageList!=null){var u=document.createElement("canvas");var t=u.getContext("2d");u.width=k;u.height=h;t.drawImage(q,0,m,f.imageWidth,h,0,0,k,h);b.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",u.toDataURL("image/jpeg",1));if(n.callFunction!=null){++n.printCount;if(n.pageImageCount==n.printCount){n.callFunction();}}}};}else{window.console.log("image server error code >> "+s.resValue.event);window.console.log("image ID >> "+i);n.tempImageDrawCount++;if(n.pageImageList!=null){if(n.pageImageList.length<=n.tempImageDrawCount){}}}}}catch(r){window.console.log("image server json code error >> "+p);window.console.log("image ID >> "+i);n.tempImageDrawCount++;if(n.pageImageList!=null){if(n.pageImageList.length<=n.tempImageDrawCount){}}}},error:function(p){window.console.log("image connection error >> "+p);window.console.log("image ID >> "+i);n.tempImageDrawCount++;if(n.pageImageList!=null){if(n.pageImageList.length<=n.tempImageDrawCount){}}},beforeSend:function(p){if(mCR_isAddRequestHeader){p.setRequestHeader(mCR_strRequestHeaderName,mCR_strRequestHeaderValue);}}});}}function mCR_ServerImageCallSVG(j,k,g,b){if("null"==g){return;}if(window.objClipClientPaintConnection.toLocaleLowerCase()=="post"){var d=m_reportHashMap[j.objDocument.reportKey];if(null!=d){var i=d.getProperty(g);if(null!=i){if(typeof i==="string"){var h=new Image();h.src="data:image/png;base64,"+i;k.imageKey=j.pageImageList.length;j.pageImageList.push(h);h.onload=function(){j.tempImageDrawCount++;if(j.pageImageList!=null){b.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",h.src);if(j.callFunction!=null){++j.printCount;if(j.pageImageCount==j.printCount){j.callFunction();}}}};return;}else{k.imageKey=i;}var c=j.pageImageList[i];if(null!=c){return;}}}k.imageKey=j.pageImageList.length;j.pageImageList.push(null);if(null!=d){d.setProperty(g,k.imageKey);}var f=mCR_makeImageSendData(j.objDocument,g);if(j.strPostParam!=null){f+=j.strPostParam;}var a=j.objDocument.reportServerPath;$.ajax({type:"POST",url:a,data:f,success:function(l){try{var o=jQuery.parseJSON(l);if(null!=o){if(o.resValue.status){var m=new Image();m.src="data:image/png;base64,"+o.resValue.viewData;j.pageImageList[k.imageKey]=m;d.setProperty(g,o.resValue.viewData);m.onload=function(){j.tempImageDrawCount++;if(j.pageImageList!=null){b.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",m.src);if(j.callFunction!=null){++j.printCount;if(j.pageImageCount==j.printCount){j.callFunction();}}}};}else{window.console.log("image server error code >> "+o.resValue.event);window.console.log("image ID >> "+g);j.tempImageDrawCount++;if(j.pageImageList!=null){if(j.pageImageList.length<=j.tempImageDrawCount){}}}}}catch(n){window.console.log("image server json code error >> "+l);window.console.log("image ID >> "+g);j.tempImageDrawCount++;if(j.pageImageList!=null){if(j.pageImageList.length<=j.tempImageDrawCount){}}}},error:function(l){window.console.log("image connection error >> "+l);window.console.log("image ID >> "+g);j.tempImageDrawCount++;if(j.pageImageList!=null){if(j.pageImageList.length<=j.tempImageDrawCount){}}},beforeSend:function(l){if(mCR_isAddRequestHeader){l.setRequestHeader(mCR_strRequestHeaderName,mCR_strRequestHeaderValue);}}});}}function mCR_ServerImageCall(b,k,g){if("null"==g){return;}if(null==window.objClipClientPaintConnection||window.objClipClientPaintConnection=="get"){var j=mCR_makeImageURL(b.objDocument,g);if(b.strPostParam!=null){j+=b.strPostParam;}var h=new Image();h.src=j;k.imageKey=b.pageImageList.length;b.pageImageList.push(h);h.onload=function(){b.tempImageDrawCount++;if(b.pageImageList!=null){if(b.pageImageList.length<=b.tempImageDrawCount){b.callFunction();}}};h.onerror=function(){window.console.log("image error url >> "+j);k.imageKey=-1;b.tempImageDrawCount++;if(b.pageImageList!=null){if(b.pageImageList.length<=b.tempImageDrawCount){b.callFunction();}}};}else{if(window.objClipClientPaintConnection.toLocaleLowerCase()=="post"){var d=m_reportHashMap[b.objDocument.reportKey];if(null!=d){var i=d.getProperty(g);if(null!=i){if(typeof i==="string"){var h=new Image();h.src="data:image/png;base64,"+i;k.imageKey=b.pageImageList.length;b.pageImageList.push(h);h.onload=function(){b.tempImageDrawCount++;if(b.pageImageList!=null){if(b.pageImageList.length<=b.tempImageDrawCount){b.callFunction();}}};return;}else{k.imageKey=i;}var c=b.pageImageList[i];if(null!=c){return;}}}k.imageKey=b.pageImageList.length;b.pageImageList.push(null);if(null!=d){d.setProperty(g,k.imageKey);}var f=mCR_makeImageSendData(b.objDocument,g);if(b.strPostParam!=null){f+=b.strPostParam;}var a=b.objDocument.reportServerPath;$.ajax({type:"POST",url:a,data:f,success:function(l){try{var o=jQuery.parseJSON(l);if(null!=o){if(o.resValue.status){var m=new Image();m.src="data:image/png;base64,"+o.resValue.viewData;b.pageImageList[k.imageKey]=m;d.setProperty(g,o.resValue.viewData);m.onload=function(){b.tempImageDrawCount++;if(b.pageImageList!=null){if(b.pageImageList.length<=b.tempImageDrawCount){b.callFunction();}}};}else{window.console.log("image server error code >> "+o.resValue.event);window.console.log("image ID >> "+g);b.tempImageDrawCount++;if(b.pageImageList!=null){if(b.pageImageList.length<=b.tempImageDrawCount){b.callFunction();}}}}}catch(n){window.console.log("image server json code error >> "+l);window.console.log("image ID >> "+g);b.tempImageDrawCount++;if(b.pageImageList!=null){if(b.pageImageList.length<=b.tempImageDrawCount){b.callFunction();}}}},error:function(l){window.console.log("image connection error >> "+l);window.console.log("image ID >> "+g);b.tempImageDrawCount++;if(b.pageImageList!=null){if(b.pageImageList.length<=b.tempImageDrawCount){b.callFunction();}}},beforeSend:function(l){if(mCR_isAddRequestHeader){l.setRequestHeader(mCR_strRequestHeaderName,mCR_strRequestHeaderValue);}}});}}}function mCR_exportSVGForEForm(b,a,c){mCR_exportSVG.call(this,b,a);this.elmEFormLayoutDiv=c;this.elmLayoutTag=null;this.elmLayoutButton=null;this.pageEFormControlIDList=new Array();}mCR_exportSVGForEForm.prototype=Object.create(mCR_exportSVG.prototype);mCR_exportSVGForEForm.prototype.constructor=mCR_exportSVGForEForm;mCR_exportSVGForEForm.prototype.exportPageEFom=function(c,b,a,d){this.pageEFormControlIDList=a;return this.exportPage(c,b,d);};mCR_exportSVGForEForm.prototype.startPage=function(){this.objPageStyle=this.objDocument.getPageStyle(this.objDocumentPage.pageStyleKey);if(this.isEasyInput){var o=new docStylePage();o.paperType=this.objPageStyle.orientation;o.width=0;o.height=0;o.orientation=this.objPageStyle.orientation;o.leftMargin=0;o.topMargin=0;o.rightMargin=0;o.bottomMargin=0;o.pageCount=1;o.multiColumnDirection=this.objPageStyle.multiColumnDirection;for(var k=0;k<this.objDocumentPage.subSectionList.length;k++){var r=this.objDocumentPage.subSectionList[k];if(!r.isDrilling){var m=r.area.getHeight();r.area.top=o.height;o.height+=m;r.area.bottom=o.height;var f=r.area.getWidth();r.area.left=0;r.area.right=f;if(o.width<f){o.width=f;}}else{if(o.width==0){var f=r.area.getWidth();o.width=f;}}}this.objPageStyle=o;}this.elmSVG=document.createElementNS("http://www.w3.org/2000/svg","svg");this.elmSVG.setAttribute("fill-opacity","1");this.elmSVG.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink");this.elmSVG.setAttribute("xmlns","http://www.w3.org/2000/svg");this.elmSVG.setAttribute("color-rendering","auto");this.elmSVG.setAttribute("color-interpolation","auto");this.elmSVG.setAttribute("text-interpolation","auto");this.elmSVG.setAttribute("stroke-linecap","square");this.elmSVG.setAttribute("stroke-miterlimit","10");this.elmSVG.setAttribute("stroke-opacity","1");this.elmSVG.setAttribute("shape-rendering","auto");this.elmSVG.setAttribute("stroke-dasharray","none");this.elmSVG.setAttribute("stroke-linejoin","miter");this.elmSVG.setAttribute("stroke-dashoffset","0");this.elmSVG.setAttribute("image-rendering","auto");this.elmSVG.setAttribute("style","overflow:hidden");this.elmSVG.setAttribute("width",(this.objPageStyle.width/100)+"cm");this.elmSVG.setAttribute("height",(this.objPageStyle.height/100)+"cm");this.elmBodyGroup=document.createElementNS("http://www.w3.org/2000/svg","g");this.elmBodyGroup.setAttribute("transform","scale(1) translate(0,0)");this.elmdefs=document.createElementNS("http://www.w3.org/2000/svg","defs");this.elmBodyGroup.appendChild(this.elmdefs);var l=document.createElementNS("http://www.w3.org/2000/svg","g");l.setAttribute("fill","white");l.setAttribute("stroke","white");var b=document.createElementNS("http://www.w3.org/2000/svg","rect");b.setAttribute("x","0");b.setAttribute("y","0");b.setAttribute("width",(this.objPageStyle.width/100)+"cm");b.setAttribute("height",(this.objPageStyle.height/100)+"cm");b.setAttribute("stroke","none");var q=this.objPageStyle.width*this.nPixelRate;var d=this.objPageStyle.height*this.nPixelRate;this.objDocumentPage.width=this.objPageStyle.width;this.objDocumentPage.height=this.objPageStyle.height;l.appendChild(b);this.elmBodyGroup.appendChild(l);this.elmSVG.appendChild(this.elmBodyGroup);this.pageImageList=new Array();this.objLineHashMap=function(){};this.objAccHashMap=function(){};this.elmEFormLayoutDiv.style.cssText="position:relative;background-color:transparent;display:inline-block;width:"+q+"px;height:"+d+"px;";this.elmLayoutTagP=document.createElement("div");this.elmLayoutTagP.style.position="absolute";if(this.isEasyInput){this.elmLayoutTagP.style.left=(this.objPageStyle.leftMargin*this.nPixelRate)+"px";this.elmLayoutTagP.style.right=(this.objPageStyle.rightMargin*this.nPixelRate)+"px";this.elmLayoutTagP.style.top=(this.objPageStyle.topMargin*this.nPixelRate)+"px";this.elmLayoutTagP.style.bottom=(this.objPageStyle.bottomMargin*this.nPixelRate)+"px";}else{this.elmLayoutTagP.style.left="0px";this.elmLayoutTagP.style.right="0px";this.elmLayoutTagP.style.top="0px";this.elmLayoutTagP.style.bottom="0px";}this.elmLayoutTagP.setAttribute("role","text");var a="문서 전체영역 입니다.";if(""!=this.objDocument.title){a=this.objDocument.title;a=a.replace(/\'/g,"작은따옴표");a=a.replace(/\"/g,"큰따옴표");}this.elmLayoutTagP.setAttribute("aria-label",a);var g=new Array();g.push("<style type='text/css'>");g.push(".r_F_S{position:absolute;border:0px solid black !important;padding:0 0 0 0 !important;margin:0 0 0 0 !important;}");mCR_getFontCss(g,this.objDocument.styleManager.fontList,this.objDocument);g.push("</style>");this.elmLayoutTagP.innerHTML=g.join("");this.elmEFormLayoutDiv.appendChild(this.elmLayoutTagP);var p=document.createElement("div");p.id=this.objDocument.reportKey+"memo";p.style.cssText="position:absolute;overflow:hidden;left:0px;top:0px;right:0px;bottom:0px;background-color:rgba(255,255,255,0);";this.elmEFormLayoutDiv.appendChild(p);var i=document.createElement("div");i.id=this.objDocument.reportKey+"doodle";i.style.cssText="position:absolute;overflow:hidden;left:0px;top:0px;right:0px;bottom:0px;background-color:rgba(255,255,255,0);";i.innerHTML='<svg height="100%" version="1.1" width="100%" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" style="overflow: hidden; position: relative; shape-rendering: optimizeSpeed;"></svg>';this.elmEFormLayoutDiv.appendChild(i);this.elmLayoutButtonP=document.createElement("div");this.elmLayoutButtonP.style.position="absolute";if(this.isEasyInput){this.elmLayoutButtonP.style.left=(this.objPageStyle.leftMargin*this.nPixelRate)+"px";this.elmLayoutButtonP.style.right=(this.objPageStyle.rightMargin*this.nPixelRate)+"px";this.elmLayoutButtonP.style.top=(this.objPageStyle.topMargin*this.nPixelRate)+"px";this.elmLayoutButtonP.style.bottom=(this.objPageStyle.bottomMargin*this.nPixelRate)+"px";}else{this.elmLayoutButtonP.style.left="0px";this.elmLayoutButtonP.style.right="0px";this.elmLayoutButtonP.style.top="0px";this.elmLayoutButtonP.style.bottom="0px";}var c=document.createElement("div");c.id=this.objDocument.reportKey+"IndexOrder";c.className="eform_IndexOrder";var h=document.createElement("div");h.id=this.objDocument.reportKey+"IO_in";h.className="eform_IndexOrder_inner";var n=document.createElement("button");n.tabIndex="-1";n.className="eform_IndexOrder_left";var j=document.createElement("button");j.tabIndex="-1";j.className="eform_IndexOrder_right";h.appendChild(n);h.appendChild(j);this.elmLayoutButtonP.appendChild(c);this.elmLayoutButtonP.appendChild(h);this.elmEFormLayoutDiv.appendChild(this.elmLayoutButtonP);};mCR_exportSVGForEForm.prototype.exportControlsInSubSection=function(g){if(this.isEasyInput){this.elmLayoutTag=document.createElement("div");this.elmLayoutButton=document.createElement("div");if(g.isDrilling){this.elmLayoutTag.style.display="none";this.elmLayoutButton.style.display="none";}this.elmLayoutTagP.appendChild(this.elmLayoutTag);this.elmLayoutButtonP.appendChild(this.elmLayoutButton);var b=g.area.newRateRect(this.nPixelRate);this.elmLayoutTag.style.position=this.elmLayoutButton.style.position="relative";this.elmLayoutTag.style.top=this.elmLayoutButton.style.top="0px";this.elmLayoutTag.style.left=this.elmLayoutButton.style.left="0px";this.elmLayoutTag.style.width=this.elmLayoutButton.style.width=b.getWidth()+"px";this.elmLayoutTag.style.height=this.elmLayoutButton.style.height=b.getHeight()+"px";this.elmLayoutTag.id=this.elmLayoutButton.id=g.rName+"."+g.editEasyModeId;}else{this.elmLayoutTag=this.elmLayoutTagP;this.elmLayoutButton=this.elmLayoutButtonP;}for(var c=0;c<g.controlPageList.length;c++){var a=g.controlPageList[c];var f=true;if(-1!=a.visibleOptionStyleKey){var d=this.objDocument.getVisibleOptionStyle(a.visibleOptionStyleKey);if(null!=d){if(this.isPrint){f=d.toPrint;}else{f=d.toView;if(this.isEasyInput){f=d.toEasyMoad;}}}}if(f){this.exportControl(a);}}};mCR_exportSVGForEForm.prototype.exportReportControl=function(d){if(this.isEasyInput){var b=this.elmLayoutTagP;var i=this.elmLayoutButtonP;var j=this.elmLayoutTag;var f=this.elmLayoutButton;var a=d.rect.newRateRect(this.nPixelRate);var h=document.createElement("div");var c=document.createElement("div");h.style.position=c.style.position="absolute";h.style.top=c.style.top=a.top+"px";h.style.left=c.style.left=a.left+"px";h.style.width=c.style.width=a.getWidth()+"px";h.style.height=c.style.height=a.getHeight()+"px";this.elmLayoutTag.appendChild(h);this.elmLayoutButton.appendChild(c);this.elmLayoutTagP=h;this.elmLayoutButtonP=c;}for(var g=0;g<d.subSectionList.length;g++){this.exportReportControlSubSection(d.subSectionList[g]);}for(var g=0;g<d.subSectionList.length;g++){this.exportControlsInSubSection(d.subSectionList[g]);}if(this.isEasyInput){this.elmLayoutTagP=b;this.elmLayoutButtonP=i;this.elmLayoutTag=j;this.elmLayoutButton=f;}};mCR_exportSVGForEForm.prototype.exportInputCheckbox=function(t){var b=null;if(this.isEasyInput){b=t.rect;}else{b=t.getRectInPage();}var u=t.checkSize;this.pageEFormControlIDList.push(t.primaryName);var a=this.objDocument.documentStorage[t.primaryName];if(null!=a){var g=b.getHeight()-u;var m=this.objDocument.getLineStyle(t.outterlineStyleKey);var d=this.objDocument.getLineStyle(t.checkedBorderLineStyleKey);var l=this.objDocument.getShapeStyle(t.shapeStyleKey);var i=this.objDocument.getBackgroundStyle(t.backgroundStyleKey);var n=a.imageType=="check"?"CHECK":"RADIO";n=null==t.accessibilityString?n:t.accessibilityString;var c=document.createElement("div");c.style.cssText="position:absolute;overflow:hidden;";c.style.left=(b.left*this.nPixelRate)+"px";c.style.top=(b.top*this.nPixelRate)+"px";c.style.width=(b.getWidth()*this.nPixelRate)+"px";c.style.height=(b.getHeight()*this.nPixelRate)+"px";c.setAttribute("aria-hidden","true");var q=document.createElement("div");q.id=this.objDocument.reportKey+t.primaryName+"DIV";if(i.backStyle==0){q.style.cssText="background-color:"+mCR_changeRGBAColor(i.backColor,t.guideTransparency);}if(t.guideInCheckBox&&t.useText){q.style.position="absolute";if(t.checkboxLeftAlignment){q.style.left="0.02cm";}else{q.style.right="0.02cm";}q.style.top=((g/2)/100)+"cm";q.style.width=(u/100)+"cm";q.style.height=(u/100)+"cm";}else{q.className="eF_Rect";}var j=document.createElement("img");j.id=this.objDocument.reportKey+t.primaryName+"IMG";j.tabIndex="-1";var s="position:absolute;";if(t.useText){s+=(t.checkboxLeftAlignment?"left:0.02cm;":"right:0.02cm;")+"top:"+((g/2)/100)+"cm;width:"+(u/100)+"cm;height:"+(u/100)+"cm;";}else{s+="left:0cm;top:0cm;width:100%;height:100%;";}if(u<1){s+="visibility:hidden;";}if(l.shapeType==1){s+="border-radius: 100%;";}var o=mCR_getLineStyleTag(m);var f=d!=null?mCR_getLineStyleTag(d):o;j.setAttribute("uncheckborderstyle",o);j.setAttribute("checkborderstyle",f);if(m.style!=0){s+="border:"+o;}s+="box-sizing: border-box;";j.style.cssText=s;var r=document.createElement("div");r.id=this.objDocument.reportKey+t.primaryName+"FOCUS";r.className="eF_Rect";c.appendChild(q);c.appendChild(r);c.appendChild(j);if(t.useText){var p=document.createElement("span");p.tabIndex="-1";var k=new docRect();k.copyRect(b);if(t.checkboxLeftAlignment){k.left+=u;p.style.left=(u/100)+"cm";}else{k.setWidth(k.getWidth()-u);p.style.left="0cm";p.style.right=(u/100)+"cm";}if(!is_ie){p.style.lineHeight="0";}p.className="s_"+this.objDocument.reportKey+t.textInfo.getOriginalTextInfo().fontStyleKey+" eF_Rect";var h=mRe_createCheckboxTextSvg(k,t.textInfo,this.objDocument);p.innerHTML=h;c.appendChild(p);}this.elmLayoutTag.appendChild(c);var v=document.createElement("input");v.type="checkbox";v.tabIndex="0";v.className="eForm_hidden_button";v.id=this.objDocument.reportKey+t.primaryName;v.title=n;v.style.cssText="position:absolute;overflow:hidden;";if(t.checkboxLeftAlignment){v.style.left=(b.left*this.nPixelRate)+"px";}else{v.style.left=((b.left+b.getWidth()-(u+5))*this.nPixelRate)+"px";}v.style.top=(b.top*this.nPixelRate)+"px";v.style.zIndex="1";if(t.selectArea==0&&t.useText){v.style.width=((u+5)*this.nPixelRate)+"px";}else{v.style.width=(b.getWidth()*this.nPixelRate)+"px";}v.style.height=(b.getHeight()*this.nPixelRate)+"px";this.elmLayoutButton.appendChild(v);}};mCR_exportSVGForEForm.prototype.exportInputImage=function(m){var i=null;if(this.isEasyInput){i=m.rect;}else{i=m.getRectInPage();}this.pageEFormControlIDList.push(m.primaryName);var f=this.objDocument.documentStorage[m.primaryName];if(null!=f){var j=this.objDocument.getLineStyle(m.outterlineStyleKey);var g=this.objDocument.getBackgroundStyle(m.backgroundStyleKey);var l=m.accessibilityString;if(null==l){l="image";}var h=document.createElement("div");h.style.cssText="position:absolute;overflow:hidden;";h.style.left=(i.left*this.nPixelRate)+"px";h.style.top=(i.top*this.nPixelRate)+"px";h.style.width=(i.getWidth()*this.nPixelRate)+"px";h.style.height=(i.getHeight()*this.nPixelRate)+"px";h.setAttribute("aria-hidden","true");var b=document.createElement("span");b.id=this.objDocument.reportKey+m.primaryName+"Guide";b.className="eF_Rect";var a="";if(g.backStyle==0){a+="background-color:"+mCR_changeRGBAColor(g.backColor,m.transparencyRate)+";";}if(j.style!=0){a+="border:"+mCR_getLineStyleTag(j);a+="color:"+mCR_getStrColor(j.color)+" !important;";}a+="text-align:left !important;  padding: 0px 0px 0px 0px !important;font-size:10px !important;";b.style.cssText=a;var k=document.createElement("img");k.id=this.objDocument.reportKey+m.primaryName+"Canvas";k.className="eF_Rect2";var d=document.createElement("div");d.id=this.objDocument.reportKey+m.primaryName+"FOCUS";d.className="eF_Rect";h.appendChild(b);h.appendChild(k);h.appendChild(d);this.elmLayoutTag.appendChild(h);var c=document.createElement("button");c.tabIndex="0";c.className="eForm_hidden_button";c.id=this.objDocument.reportKey+m.primaryName;c.title=l;c.style.cssText="position:absolute;overflow:hidden;border:0.75pt solid !important; padding: 0px 0px 0px 0px !important;cursor:pointer;";c.style.left=(i.left*this.nPixelRate)+"px";c.style.top=(i.top*this.nPixelRate)+"px";c.style.width=(i.getWidth()*this.nPixelRate)+"px";c.style.height=(i.getHeight()*this.nPixelRate)+"px";c.style.zIndex="1";c.innerHTML=l;this.elmLayoutButton.appendChild(c);}};mCR_exportSVGForEForm.prototype.exportInputSign=function(i){var d=null;if(this.isEasyInput){d=i.rect;}else{d=i.getRectInPage();}this.pageEFormControlIDList.push(i.primaryName);var b=this.objDocument.documentStorage[i.primaryName];if(null!=b){var k=this.objDocument.getLineStyle(i.outterlineStyleKey);var m=this.objDocument.getShapeStyle(i.shapeStyleKey);var j=this.objDocument.getBackgroundStyle(i.backgroundStyleKey);if(null!=k&&null!=m){var g=this.paintShapeStyle(d,m);this.paintLineStyle(k,g);this.elmChangeGroup.appendChild(g);}var n=new docStyleLine();n.setStyle(i.guileLineStyle,i.guileLineWidth,i.guileLineColor);var r=i.accessibilityString;if(null==r){r="sign";}var t=document.createElement("div");t.style.cssText="position:absolute;overflow:hidden;";t.style.left=(d.left*this.nPixelRate)+"px";t.style.top=(d.top*this.nPixelRate)+"px";t.style.width=(d.getWidth()*this.nPixelRate)+"px";t.style.height=(d.getHeight()*this.nPixelRate)+"px";t.setAttribute("aria-hidden","true");var f=document.createElement("span");f.id=this.objDocument.reportKey+i.primaryName+"Guide";f.className="eF_Rect";var u="";if(j.backStyle==0){u+="background-color:"+mCR_changeRGBAColor(j.backColor,i.transparencyRate)+";";}if(n.style!=0){u+="border:"+mCR_getLineStyleTag(n);u+="color:"+mCR_getStrColor(n.color)+" !important;";}u+="text-align:left !important;  padding: 0px 0px 0px 0px !important;font-size:10px !important;";f.style.cssText=u;var c=document.createElement("div");c.className="eF_Rect2 eform_sign_paint_guide";var p=document.createElement("table");p.className="eform_table";p.border="0";p.cellSpacing="0";p.cellPadding="0";var h=document.createElement("tr");var l=document.createElement("td");var a=new docStyleTextOption();a.horizontalAlignment=i.horizontalAlignmentMethod;a.verticalAlignment=i.verticalAlignmentMethod;mCR_setAlignmentMethod(l,a);l.style.cssText="word-wrap:break-word;background-color:transparent !important;";c.id=this.objDocument.reportKey+i.primaryName+"GuideInput";var s=document.createElement("canvas");s.id=this.objDocument.reportKey+i.primaryName+"Canvas";s.className="eF_Rect2";var o=document.createElement("div");o.id=this.objDocument.reportKey+i.primaryName+"FOCUS";o.className="eF_Rect";h.appendChild(l);p.appendChild(h);c.appendChild(p);t.appendChild(f);t.appendChild(c);t.appendChild(s);t.appendChild(o);this.elmLayoutTag.appendChild(t);var q=document.createElement("button");q.tabIndex="0";q.className="eForm_hidden_button";q.id=this.objDocument.reportKey+i.primaryName;q.title=r;q.style.cssText="position:absolute;overflow:hidden;border:0.75pt solid !important; padding: 0px 0px 0px 0px !important;cursor:pointer;";q.style.left=(d.left*this.nPixelRate)+"px";q.style.top=(d.top*this.nPixelRate)+"px";q.style.width=(d.getWidth()*this.nPixelRate)+"px";q.style.height=(d.getHeight()*this.nPixelRate)+"px";q.style.zIndex="1";q.innerHTML=r;this.elmLayoutButton.appendChild(q);}};mCR_exportSVGForEForm.prototype.exportInputCalendar=function(h){var o=null;if(this.isEasyInput){o=h.rect;}else{o=h.getRectInPage();}this.pageEFormControlIDList.push(h.primaryName);var j=this.objDocument.documentStorage[h.primaryName];if(null!=j){var p=this.objDocument.getLineStyle(h.outterlineStyleKey);var k=this.objDocument.getBackgroundStyle(h.backgroundStyleKey);var l=this.objDocument.getTextOptionStyle(h.textOptionStyleKey);var q=h.accessibilityString;if(null==q){q="calendar";}var i=document.createElement("div");i.style.cssText="position:absolute;overflow:hidden;";i.style.left=(o.left*this.nPixelRate)+"px";i.style.top=(o.top*this.nPixelRate)+"px";i.style.width=(o.getWidth()*this.nPixelRate)+"px";i.style.height=(o.getHeight()*this.nPixelRate)+"px";i.setAttribute("aria-hidden","true");var c=document.createElement("div");c.id=this.objDocument.reportKey+h.primaryName+"SPAN";c.className="eF_Rect";var b="";if(k.backStyle==0){b+="background-color:"+mCR_changeRGBAColor(k.backColor,h.transparencyRate)+";";}if(p.style!=0){b+="border:"+mCR_getLineStyleTag(p);b+="color:"+mCR_getStrColor(p.color)+" !important;";}c.style.cssText=b;var d=document.createElement("div");d.className="eF_Rect";var n=document.createElement("table");n.className="eform_table";n.border="0";n.cellSpacing="0";n.cellPadding="0";var a=document.createElement("tr");var m=document.createElement("td");m.id=this.objDocument.reportKey+h.primaryName+"TD";mCR_setAlignmentMethod(m,l);m.style.cssText="word-wrap:break-word;background-color:transparent !important;";m.className="s_"+this.objDocument.reportKey+h.fontStyleKey;m.appendChild(document.createElement("nobr"));var g=document.createElement("div");g.id=this.objDocument.reportKey+h.primaryName+"FOCUS";g.className="eF_Rect";a.appendChild(m);n.appendChild(a);d.appendChild(n);i.appendChild(c);i.appendChild(d);i.appendChild(g);this.elmLayoutTag.appendChild(i);var f=document.createElement("button");f.tabIndex="0";f.className="eForm_hidden_button";f.id=this.objDocument.reportKey+h.primaryName;f.title=q;f.style.cssText="position:absolute;overflow:hidden;border:0.75pt solid !important; padding: 0px 0px 0px 0px !important;cursor:pointer;";f.style.left=(o.left*this.nPixelRate)+"px";f.style.top=(o.top*this.nPixelRate)+"px";f.style.width=(o.getWidth()*this.nPixelRate)+"px";f.style.height=(o.getHeight()*this.nPixelRate)+"px";f.style.zIndex="1";f.innerHTML=q;this.elmLayoutButton.appendChild(f);}};mCR_exportSVGForEForm.prototype.exportInputSelectBox=function(i){var d=null;if(this.isEasyInput){d=i.rect;}else{d=i.getRectInPage();}this.pageEFormControlIDList.push(i.primaryName);var b=this.objDocument.documentStorage[i.primaryName];if(null!=b){var m=this.objDocument.getLineStyle(i.outterlineStyleKey);var j=this.objDocument.getBackgroundStyle(i.backgroundStyleKey);var a=this.objDocument.getTextOptionStyle(i.textInfo.getOriginalTextInfo().textOptionStyleKey);var p=i.accessibilityString;if(null==p){p="selectbox";}var l=document.createElement("div");l.style.cssText="position:absolute;overflow:hidden;";l.style.left=(d.left*this.nPixelRate)+"px";l.style.top=(d.top*this.nPixelRate)+"px";l.style.width=(d.getWidth()*this.nPixelRate)+"px";l.style.height=(d.getHeight()*this.nPixelRate)+"px";l.setAttribute("aria-hidden","true");var f=document.createElement("div");f.id=this.objDocument.reportKey+i.primaryName+"SPAN";f.className="eF_Rect";var s="";if(j.backStyle==0){s+="background-color:"+mCR_changeRGBAColor(j.backColor,i.transparencyRate)+";";}if(m.style!=0){s+="border:"+mCR_getLineStyleTag(m);s+="color:"+mCR_getStrColor(m.color)+" !important;";}f.style.cssText=s;var c=document.createElement("div");c.className="eF_Rect";var n=document.createElement("table");n.className="eform_table";n.border="0";n.cellSpacing="0";n.cellPadding="0";var g=document.createElement("tr");var k=document.createElement("td");var r=document.createElement("nobr");k.id=this.objDocument.reportKey+i.primaryName+"TD";mCR_setAlignmentMethod(k,a);k.style.cssText="word-wrap:break-word;background-color:transparent !important;";k.className="s_"+this.objDocument.reportKey+i.textInfo.getOriginalTextInfo().fontStyleKey;var q=document.createElement("td");q.width="20px";q.align="center";q.vAlign="middle";q.style.fontSize="8pt";q.innerHTML="▼";var o=document.createElement("div");o.id=this.objDocument.reportKey+i.primaryName+"FOCUS";o.className="eF_Rect";k.appendChild(r);g.appendChild(k);g.appendChild(q);n.appendChild(g);c.appendChild(n);l.appendChild(f);l.appendChild(c);l.appendChild(o);this.elmLayoutTag.appendChild(l);var h=document.createElement("select");h.tabIndex="0";h.className="eForm_hidden_button";h.id=this.objDocument.reportKey+i.primaryName;h.title=p;h.style.cssText="position:absolute;overflow:hidden;border:0.75pt solid !important; padding: 0px 0px 0px 0px !important;cursor:pointer;";h.style.left=(d.left*this.nPixelRate)+"px";h.style.top=(d.top*this.nPixelRate)+"px";h.style.width=(d.getWidth()*this.nPixelRate)+"px";h.style.height=(d.getHeight()*this.nPixelRate)+"px";h.style.zIndex="1";h.innerHTML=p;this.elmLayoutButton.appendChild(h);}};mCR_exportSVGForEForm.prototype.exportInputButton=function(j){var o=null;if(this.isEasyInput){o=j.rect;}else{o=j.getRectInPage();}this.pageEFormControlIDList.push(j.primaryName);var i=this.objDocument.documentStorage[j.primaryName];if(null!=i){var p=this.objDocument.getLineStyle(j.outterlineStyleKey);var k=this.objDocument.getBackgroundStyle(j.backgroundStyleKey);var l=this.objDocument.getTextOptionStyle(j.textInfo.getOriginalTextInfo().textOptionStyleKey);var q=j.accessibilityString;if(null==q){q="button";}var h=document.createElement("div");h.style.cssText="position:absolute;overflow:hidden;";h.style.left=(o.left*this.nPixelRate)+"px";h.style.top=(o.top*this.nPixelRate)+"px";h.style.width=(o.getWidth()*this.nPixelRate)+"px";h.style.height=(o.getHeight()*this.nPixelRate)+"px";h.setAttribute("aria-hidden","true");var c=document.createElement("div");c.id=this.objDocument.reportKey+j.primaryName+"SPAN";c.className="eF_Rect";var b="";if(k.backStyle==0){b+="background-color:"+mCR_changeRGBAColor(k.backColor,j.transparencyRate)+";";}if(p.style!=0){b+="border:"+mCR_getLineStyleTag(p);b+="color:"+mCR_getStrColor(p.color)+" !important;";}c.style.cssText=b;var d=document.createElement("div");d.className="eF_Rect";var n=document.createElement("table");n.className="eform_table";n.border="0";n.cellSpacing="0";n.cellPadding="0";var a=document.createElement("tr");var m=document.createElement("td");m.id=this.objDocument.reportKey+j.primaryName+"TD";mCR_setAlignmentMethod(m,l);m.style.cssText="word-wrap:break-word;background-color:transparent !important;";m.className="s_"+this.objDocument.reportKey+j.textInfo.getOriginalTextInfo().fontStyleKey;var g=document.createElement("div");g.id=this.objDocument.reportKey+j.primaryName+"FOCUS";g.className="eF_Rect";a.appendChild(m);n.appendChild(a);d.appendChild(n);h.appendChild(c);h.appendChild(d);h.appendChild(g);this.elmLayoutTag.appendChild(h);var f=document.createElement("button");f.tabIndex="0";f.className="eForm_hidden_button";f.id=this.objDocument.reportKey+j.primaryName;f.title=q;f.style.cssText="position:absolute;overflow:hidden;border:0.75pt solid !important; padding: 0px 0px 0px 0px !important;cursor:pointer;";f.style.left=(o.left*this.nPixelRate)+"px";f.style.top=(o.top*this.nPixelRate)+"px";f.style.width=(o.getWidth()*this.nPixelRate)+"px";f.style.height=(o.getHeight()*this.nPixelRate)+"px";f.style.zIndex="1";f.innerHTML=q;this.elmLayoutButton.appendChild(f);}};mCR_exportSVGForEForm.prototype.exportInputVideo=function(j){var i=null;if(this.isEasyInput){i=j.rect;}else{i=j.getRectInPage();}this.pageEFormControlIDList.push(j.primaryName);var g=this.objDocument.documentStorage[j.primaryName];if(null!=g){var k=this.objDocument.getLineStyle(j.outterlineStyleKey);var h=this.objDocument.getBackgroundStyle(j.backgroundStyleKey);var l=j.accessibilityString;if(null==l){l="video";}var d=document.createElement("div");d.style.cssText="position:absolute;overflow:hidden;";d.style.left=(i.left*this.nPixelRate)+"px";d.style.top=(i.top*this.nPixelRate)+"px";d.style.width=(i.getWidth()*this.nPixelRate)+"px";d.style.height=(i.getHeight()*this.nPixelRate)+"px";d.setAttribute("aria-hidden","true");var b=document.createElement("div");b.id=this.objDocument.reportKey+j.primaryName+"SPAN";b.className="eF_Rect";var a="";if(h.backStyle==0){a+="background-color:"+mCR_changeRGBAColor(h.backColor,j.transparencyRate)+";";}if(k.style!=0){a+="border:"+mCR_getLineStyleTag(k);a+="color:"+mCR_getStrColor(k.color)+" !important;";}b.style.cssText=a;var c=document.createElement("div");c.id=this.objDocument.reportKey+j.primaryName+"FOCUS";c.className="eF_Rect";d.appendChild(b);d.appendChild(c);this.elmLayoutTag.appendChild(d);var f=document.createElement("video");f.tabIndex="0";f.id=this.objDocument.reportKey+j.primaryName;f.title=l;f.style.cssText="position:absolute;overflow:hidden;border:0 solid !important; padding: 0px 0px 0px 0px !important;cursor:pointer;";f.style.left=(i.left*this.nPixelRate)+"px";f.style.top=(i.top*this.nPixelRate)+"px";f.style.width=(i.getWidth()*this.nPixelRate)+"px";f.style.height=(i.getHeight()*this.nPixelRate)+"px";f.style.zIndex="1";f.controls=true;this.elmLayoutButton.appendChild(f);}};mCR_exportSVGForEForm.prototype.exportInputbox=function(r){var d=null;if(this.isEasyInput){d=r.rect;}else{d=r.getRectInPage();}this.pageEFormControlIDList.push(r.primaryName);var b=this.objDocument.documentStorage[r.primaryName];if(null!=b){var n=this.objDocument.getLineStyle(r.outterlineStyleKey);var i=this.objDocument.getBackgroundStyle(r.backgroundStyleKey);var a=this.objDocument.getTextOptionStyle(r.textInfo.getOriginalTextInfo().textOptionStyleKey);var k=this.objDocument.getFontStyle(r.textInfo.getOriginalTextInfo().fontStyleKey);var q=r.accessibilityString;if(null==q){q="inputbox";}var m=document.createElement("div");m.style.cssText="position:absolute;overflow:hidden;";m.style.left=(d.left*this.nPixelRate)+"px";m.style.top=(d.top*this.nPixelRate)+"px";m.style.width=(d.getWidth()*this.nPixelRate)+"px";m.style.height=(d.getHeight()*this.nPixelRate)+"px";m.setAttribute("aria-hidden","true");var f=document.createElement("div");f.id=this.objDocument.reportKey+r.primaryName+"SPAN";f.className="eF_Rect";var s="";if(i.backStyle==0){s+="background-color:"+mCR_changeRGBAColor(i.backColor,r.transparencyRate)+";";}if(n.style!=0){s+="border:"+mCR_getLineStyleTag(n);s+="color:"+mCR_getStrColor(n.color)+" !important;";}f.style.cssText=s;var c=document.createElement("div");c.className="eF_Rect";var o=document.createElement("table");o.className="eform_table";o.border="0";o.cellSpacing="0";o.cellPadding="0";var g=document.createElement("tr");var l=document.createElement("td");l.id=this.objDocument.reportKey+r.primaryName+"TD";mCR_setAlignmentMethod(l,a);l.style.cssText="word-wrap:break-word;background-color:transparent !important;";l.className="s_"+this.objDocument.reportKey+r.textInfo.getOriginalTextInfo().fontStyleKey;if(null!=k){l.style.fontSize=k.size+"pt";}g.appendChild(l);o.appendChild(g);c.appendChild(o);m.appendChild(f);m.appendChild(c);this.elmLayoutTag.appendChild(m);var p=document.createElement("textarea");if(b.isGuideText){var j=b.guideTextColor;var h=document.createElement("textarea");h.tabIndex="-1";h.readonly=true;h.className="eform_guide_textarea mRe_focus s_"+this.objDocument.reportKey+r.textInfo.getOriginalTextInfo().fontStyleKey;h.id=this.objDocument.reportKey+r.primaryName+"GT";h.style.left=(d.left*this.nPixelRate)+"px";h.style.top=(d.top*this.nPixelRate)+"px";h.style.width=(d.getWidth()*this.nPixelRate)+"px";h.style.height=(d.getHeight()*this.nPixelRate)+"px";h.style.color=mCR_getStrColor(j);h.value=decodeURIComponent(b.guideText);p.style.backgroundColor="RGBA(255,255,255,0)";mCR_setInputAlignmentMethod(h,a);mRe_spaceStyle(h,a,k);this.elmLayoutButton.appendChild(h);}p.tabIndex="0";p.className="eform_textarea mRe_focus s_"+this.objDocument.reportKey+r.textInfo.getOriginalTextInfo().fontStyleKey;p.title=q;p.id=this.objDocument.reportKey+r.primaryName;p.style.left=(d.left*this.nPixelRate)+"px";p.style.top=(d.top*this.nPixelRate)+"px";p.style.width=(d.getWidth()*this.nPixelRate)+"px";p.style.height=(d.getHeight()*this.nPixelRate)+"px";p.style.zIndex="1";this.elmLayoutButton.appendChild(p);mCR_setInputAlignmentMethod(p,a);mRe_spaceStyle(p,a,k);}};function mCR_exportSVGForZoom(b,a){mCR_exportSVG.call(this,b,a);}mCR_exportSVGForZoom.prototype=Object.create(mCR_exportSVG.prototype);mCR_exportSVGForZoom.prototype.constructor=mCR_exportSVGForZoom;mCR_exportSVGForZoom.prototype.exportControl=function(a){var c=true;if(a.pageCountConditionType==21){var b=this.objDocument.checkedTotalPageCount;var f=this.pageIndex+1==b/2+1;if(a.visible){if(f==true){c=false;}}else{c=f||a.conditionVisible;}}else{if(a.pageCountConditionType==22){var d=(this.pageIndex+1)%2;if(d==0){c=false;}}else{if(a.pageCountConditionType==23){var d=(this.pageIndex+1)%2;if(d==1){c=false;}}}}if(c){switch(a.type){case mCR_DocumentControlType.Line:this.exportLine(a);break;case mCR_DocumentControlType.Shape:this.exportShape(a);break;case mCR_DocumentControlType.Label:this.exportLabel(a);break;case mCR_DocumentControlType.Table:this.exportTable(a);break;case mCR_DocumentControlType.Crosstab:this.exportCrosstab(a);break;case mCR_DocumentControlType.Barcode:this.exportBarcode(a);break;case mCR_DocumentControlType.Chart:this.exportChart(a);break;case mCR_DocumentControlType.SubReport:this.exportReportControl(a);break;case mCR_DocumentControlType.Checkbox:this.exportCheckbox(a,this.elmChangeGroup,false);break;case mCR_DocumentControlType.VoiceEye:this.exportVoiceEye(a);break;case mCR_DocumentControlType.MarkAnyVoiceEye:this.exportMarkAnyVoice(a);break;case mCR_DocumentControlType.VerifyBarcode:this.exportVerifyBarcode(a);break;case mCR_DocumentControlType.VoiceBarcode:this.exportVoiceBarcode(a);break;case mCR_DocumentControlType.VerifyBarcode:this.exportVerifyBarcode(a);break;}}};mCR_exportSVGForZoom.prototype.exportSubSectionsInPage=function(){this.elmChangeGroup=document.createElementNS("http://www.w3.org/2000/svg","g");this.elmChangeGroup.setAttribute("id","mainSubSectionBG");for(var a=0;a<this.objDocumentPage.subSectionList.length;a++){var c=this.objDocumentPage.subSectionList[a];if(c.isDrillingView&&!c.isDrilling){this.exportSubSection(c);}}this.elmBodyGroup.appendChild(this.elmChangeGroup);var b=new Array();for(var a=0;a<this.objDocumentPage.subSectionList.length;a++){var c=this.objDocumentPage.subSectionList[a];if(c.isDrillingView&&!c.isDrilling){if(c.sectionType!=7){this.elmChangeGroup=document.createElementNS("http://www.w3.org/2000/svg","g");this.elmChangeGroup.setAttribute("id","mainSubSection"+a);this.setDefaultGroupStyle();this.exportControlsInSubSection(c);this.elmBodyGroup.appendChild(this.elmChangeGroup);}else{b.push(c);}}}b.sort(function(f,d){if(f.area.top>d.area.top){return 1;}if(f.area.top<d.area.top){return -1;}return 0;});for(var a=0;a<b.length;a++){this.elmChangeGroup=document.createElementNS("http://www.w3.org/2000/svg","g");this.elmChangeGroup.setAttribute("id","mainSubSectionPB"+a);this.setDefaultGroupStyle();this.exportControlsInSubSection(b[a]);this.elmBodyGroup.appendChild(this.elmChangeGroup);}b=null;};function mCR_exportCanvas(b,c,a){this.objDocument=b;this.objDocumentPage=null;this.objPageStyle=null;this.elmCanvas=null;this.objContext=null;this.nPixelRate=0.378;this.nPtToPxRate=1.32814;this.nZoom=c;this.pageIndex=null;this.objLineHashMap=null;this.pageImageList=null;this.tempImageDrawCount=0;this.callFunction=null;this.callbackFunction=a;this.webLinkList=new Array();this.isAccessibility=false;this.isEasyInput=false;this.ruleCtrlVisible=false;this.strPostParam=null;this.isOffScreenCanvas=window.OffscreenCanvas?true:false;this.elmTempCanvas=null;}mCR_exportCanvas.prototype.setPostParam=function(a){this.strPostParam=a;};mCR_exportCanvas.prototype.exportPage=function(b,c){var a=this;if(this.objDocument.documentPageList.length>b){this.objDocumentPage=this.objDocument.documentPageList[b];}else{this.objDocumentPage=this.objDocument.documentPageList[0];}this.pageIndex=b;this.startPage();this.elmCanvas.style.display="none";c.appendChild(this.elmCanvas);this.callFunction=function(){a.exportSubSectionsInPage();a.endPage();a.elmCanvas.style.display="";if(null!=a.callbackFunction){a.callbackFunction();}};this.exportSubSectionsInPageImage();this.elmCanvas.setAttribute("nZoom",this.nZoom);return this.elmCanvas;};mCR_exportCanvas.prototype.setEasyInput=function(a){this.isEasyInput=a;};mCR_exportCanvas.prototype.setRuleCtrlVisible=function(a){this.ruleCtrlVisible=a;};mCR_exportCanvas.prototype.setAccessibility=function(a){this.isAccessibility=a;};mCR_exportCanvas.prototype.callGetWebLinkList=function(){return this.webLinkList;};mCR_exportCanvas.prototype.startPage=function(){this.objPageStyle=this.objDocument.getPageStyle(this.objDocumentPage.pageStyleKey);if(this.isEasyInput){var b=new docStylePage();b.paperType=this.objPageStyle.orientation;b.width=0;b.height=0;b.orientation=this.objPageStyle.orientation;b.leftMargin=0;b.topMargin=0;b.rightMargin=0;b.bottomMargin=0;b.pageCount=1;b.multiColumnDirection=this.objPageStyle.multiColumnDirection;for(var f=0;f<this.objDocumentPage.subSectionList.length;f++){var h=this.objDocumentPage.subSectionList[f];if(!h.isDrilling){var d=h.area.getHeight();h.area.top=b.height;b.height+=d;h.area.bottom=b.height;var c=h.area.getWidth();h.area.left=0;h.area.right=c;if(b.width<c){b.width=c;}}else{if(b.width==0){var c=h.area.getWidth();b.width=c;}}}this.objPageStyle=b;}var a=this.objPageStyle.width*this.nPixelRate;var g=this.objPageStyle.height*this.nPixelRate;this.objDocumentPage.width=this.objPageStyle.width;this.objDocumentPage.height=this.objPageStyle.height;this.elmCanvas=document.createElement("canvas");if(this.isOffScreenCanvas){this.elmTempCanvas=new OffscreenCanvas((a)*(mCR_isSmartphone?2:this.nZoom),(g)*(mCR_isSmartphone?2:this.nZoom));}this.elmCanvas.setAttribute("width",a*this.nZoom);this.elmCanvas.setAttribute("height",g*this.nZoom);if(this.isOffScreenCanvas){this.objContext=this.elmTempCanvas.getContext("2d");this.objContext.scale((mCR_isSmartphone?2:this.nZoom),(mCR_isSmartphone?2:this.nZoom));}else{this.objContext=this.elmCanvas.getContext("2d");this.objContext.scale(this.nZoom,this.nZoom);}this.objContext.fillStyle="rgb(255,255,255)";this.objContext.fillRect(0,0,a,g);this.pageImageList=new Array();this.objLineHashMap=function(){};this.objAccHashMap=function(){};};mCR_exportCanvas.prototype.exportSubSectionsInPageImage=function(){if(!this.isEasyInput){if(this.objDocumentPage.backGround){this.findControlsInSubSectionImage(this.objDocumentPage.backGround);}}for(var a=0;a<this.objDocumentPage.subSectionList.length;a++){this.findControlsInSubSectionImage(this.objDocumentPage.subSectionList[a]);}if(!this.isEasyInput){if(this.objDocumentPage.foreGround){this.findControlsInSubSectionImage(this.objDocumentPage.foreGround);}}if(this.pageImageList.length==0){this.callFunction();}};mCR_exportCanvas.prototype.findControlsInSubSectionImage=function(f){for(var b=0;b<f.controlPageList.length;b++){var a=f.controlPageList[b];var d=true;if(-1!=a.visibleOptionStyleKey){var c=this.objDocument.getVisibleOptionStyle(a.visibleOptionStyleKey);if(null!=c){d=c.toView;if(this.isEasyInput){d=c.toEasyMoad;}}}if(d){this.findImageControl(a);}}};mCR_exportCanvas.prototype.findImageControl=function(a){var c=true;if(a.pageCountConditionType==21){var b=this.objDocument.checkedTotalPageCount;var f=this.pageIndex+1==b/2+1;if(a.visible){if(f==true){c=false;}}else{c=f||a.conditionVisible;}}else{if(a.pageCountConditionType==22){var d=(this.pageIndex+1)%2;if(d==0){c=false;}}else{if(a.pageCountConditionType==23){var d=(this.pageIndex+1)%2;if(d==1){c=false;}}}}if(c){switch(a.type){case mCR_DocumentControlType.Label:this.findImageLabel(a);break;case mCR_DocumentControlType.Table:this.findImageTable(a);break;case mCR_DocumentControlType.Crosstab:this.findImageCrosstab(a);break;case mCR_DocumentControlType.VoiceBarcode:this.findImageVoiceBarcode(a);break;case mCR_DocumentControlType.SubReport:this.findImageReportControl(a);break;case mCR_DocumentControlType.VoiceEye:this.findImageVoiceEye(a);break;case mCR_DocumentControlType.MarkAnyVoiceEye:this.findImageMarkAnyVoice(a);break;case mCR_DocumentControlType.InputSign:this.findInputSign(a);break;case mCR_DocumentControlType.InputImage:this.findInputImage(a);break;case mCR_DocumentControlType.InputCheckbox:this.findInputCheckbox(a);break;}}};mCR_exportCanvas.prototype.findInputCheckbox=function(a){var c=a.getRectInPage();var f=a.checkSize;var d=this.objDocument.documentStorage[a.primaryName];if(null!=d){if(d.visible){if("true"==d.checked){var b=d.imageType=="check"?this.objDocument.checkImageName:this.objDocument.radioImageName;mCR_ServerImageCall(this,a,b);}}}};mCR_exportCanvas.prototype.findInputImage=function(d){var c=d.getRectInPage();var f=this.objDocument.documentStorage[d.primaryName];if((c.getWidth()!=0&&c.getHeight()!=0)&&null!=f){if(f.visible&&""!=f.image){var g=f.image.replace(/\s/gi,"+");var b=new Image();b.src="data:image/png;base64,"+g;d.imageKey=this.pageImageList.length;this.pageImageList.push(b);var a=this;b.onload=function(){a.tempImageDrawCount++;if(a.pageImageList!=null){if(a.pageImageList.length<=a.tempImageDrawCount){a.callFunction();}}};b.onerror=function(){window.console.log("InputImage ID: "+f.id+" image Data error >>"+g);d.imageKey=-1;a.tempImageDrawCount++;if(a.pageImageList!=null){if(a.pageImageList.length<=a.tempImageDrawCount){a.callFunction();}}};}}};mCR_exportCanvas.prototype.findInputSign=function(a){var d=a.getRectInPage();var f=this.objDocument.documentStorage[a.primaryName];if((d.getWidth()!=0&&d.getHeight()!=0)&&null!=f){if(f.visible&&""!=f.image){var g=f.image.replace(/\s/gi,"+");var c=new Image();c.src="data:image/png;base64,"+g;a.imageKey=this.pageImageList.length;this.pageImageList.push(c);var b=this;c.onload=function(){b.tempImageDrawCount++;if(b.pageImageList!=null){if(b.pageImageList.length<=b.tempImageDrawCount){b.callFunction();}}};c.onerror=function(){window.console.log("InputSign ID: "+f.id+" image Data error >>"+g);a.imageKey=-1;b.tempImageDrawCount++;if(b.pageImageList!=null){if(b.pageImageList.length<=b.tempImageDrawCount){b.callFunction();}}};}}};mCR_exportCanvas.prototype.findImageReportControl=function(a){for(var b=0;b<a.subSectionList.length;b++){this.findControlsInSubSectionImage(a.subSectionList[b]);}};mCR_exportCanvas.prototype.findImageLabel=function(i){var f=i.getRectInPage();var c=this.objDocument.getLineStyle(i.outterlineStyleKey);var h=this.objDocument.getShapeStyle(i.shapeStyleKey);var b=this.objDocument.getBackgroundStyle(i.backgroundStyleKey);if((null!=c&&null!=h&&null!=b)&&(f.getWidth()!=0&&f.getHeight()!=0)){if(i.imageInfo.imageDataKey!=-1){var g=this.objDocument.getBackgroundImageStyle(i.imageInfo.backgroundImageStyleKey);var d=0;if(i.subSection.imagePo!=null){d=i.subSection.imagePo;}var a=this.objDocumentPage.getImageData(Number(i.imageInfo.imageDataKey)+d);if(null!=g&&null!=a&&"null"!=a.filePath&&0!=a.imageWidth&&0!=a.imageHeight){mCR_ServerImageCall(this,i,a.filePath);}}}};mCR_exportCanvas.prototype.findImageVoiceBarcode=function(c){var b=c.getRectInPage();var a=c.getImagePath();mCR_ServerImageCall(this,c,a);};mCR_exportCanvas.prototype.findImageTable=function(b){var g=b.getRectInPage();if((g.getWidth()!=0&&g.getHeight()!=0)){var c=b.getRowCount();for(var h=0;h<c;h++){var f=b.getColumnCount();for(var d=0;d<f;d++){var a=b.getTableCellNormal(h,d);if(a!=null){this.findImageCell(a);}}}}};mCR_exportCanvas.prototype.findImageCell=function(k){var j=k.getRectInPage();var i=this.objDocument.getLineStyle(k.leftLineStyleKey);var b=this.objDocument.getLineStyle(k.topLineStyleKey);var l=this.objDocument.getLineStyle(k.rightLineStyleKey);var a=this.objDocument.getLineStyle(k.bottomLineStyleKey);var h=new Object();h.shapeType=3;var f=this.objDocument.getBackgroundStyle(k.backgroundStyleKey);if((i!=null&&b!=null&&l!=null&&a!=null&&b!=null&&f!=null)&&(j.getWidth()!=0&&j.getHeight()!=0)){if(k.imageInfo.imageDataKey!=-1){var g=this.objDocument.getBackgroundImageStyle(k.imageInfo.backgroundImageStyleKey);var d=0;if(k.tableRow.table.subSection.imagePo!=null){d=k.tableRow.table.subSection.imagePo;}var c=this.objDocumentPage.getImageData(Number(k.imageInfo.imageDataKey)+d);if(g!=null&&c!=null&&"null"!=c.filePath&&0!=c.imageWidth&&0!=c.imageHeight){mCR_ServerImageCall(this,k,c.filePath);}}}};mCR_exportCanvas.prototype.findImageCrosstab=function(b){var g=b.getRectInPage();if((g.getWidth()!=0&&g.getHeight()!=0)){var c=b.matrixHeader.getRowCount();for(var h=0;h<c;h++){var f=b.matrixHeader.getColumnCount();for(var d=0;d<f;d++){var a=b.matrixHeader.getCrosstabBaseCell(h,d);if(a.getType()!=5){this.findImageCrosstabCell(a);}}}c=b.matrixRow.getRowCount();for(var h=0;h<c;h++){var f=b.matrixRow.getColumnCount();for(var d=0;d<f;d++){var a=b.matrixRow.getCrosstabBaseCell(h,d);if(a.getType()!=5){this.findImageCrosstabCell(a);}}}c=b.matrixColumn.getRowCount();for(var h=0;h<c;h++){var f=b.matrixColumn.getColumnCount();for(var d=0;d<f;d++){var a=b.matrixColumn.getCrosstabBaseCell(h,d);if(a.getType()!=5){this.findImageCrosstabCell(a);}}}c=b.matrixSummarized.getRowCount();for(var h=0;h<c;h++){var f=b.matrixSummarized.getColumnCount();for(var d=0;d<f;d++){var a=b.matrixSummarized.getCrosstabBaseCell(h,d);if(a.getType()!=5){this.findImageCrosstabCell(a);}}}}};mCR_exportCanvas.prototype.findImageCrosstabCell=function(k){var j=k.getRectInPage();var i=this.objDocument.getLineStyle(k.leftLineStyleKey);var b=this.objDocument.getLineStyle(k.topLineStyleKey);var l=this.objDocument.getLineStyle(k.rightLineStyleKey);var a=this.objDocument.getLineStyle(k.bottomLineStyleKey);var h=new Object();h.shapeType=3;var f=this.objDocument.getBackgroundStyle(k.backgroundStyleKey);if((i!=null&&b!=null&&l!=null&&a!=null&&b!=null&&f!=null)&&(j.getWidth()!=0&&j.getHeight()!=0)){if(k.imageInfo.imageDataKey!=-1){var g=this.objDocument.getBackgroundImageStyle(k.imageInfo.backgroundImageStyleKey);var d=0;if(k.crosstabRow.matrix.crosstab.subSection.imagePo!=null){d=k.crosstabRow.matrix.crosstab.subSection.imagePo;}var c=this.objDocumentPage.getImageData(Number(k.imageInfo.imageDataKey)+d);if(g!=null&&c!=null&&"null"!=c.filePath&&0!=c.imageWidth&&0!=c.imageHeight){mCR_ServerImageCall(this,k,c.filePath);}}}};mCR_exportCanvas.prototype.findImageBarcode=function(f){var d=f.getRectInPage();var g=this.objDocument.getShapeStyle(f.shapeStyleKey);var a=this.objDocument.getBackgroundStyle(f.backgroundStyleKey);if((d.getWidth()!=0&&d.getHeight()!=0)){var c=new Image();c.src="data:image/png;base64,"+f.svgString;f.imageKey=this.pageImageList.length;this.pageImageList.push(c);var b=this;c.onload=function(){b.tempImageDrawCount++;if(b.pageImageList!=null){if(b.pageImageList.length<=b.tempImageDrawCount){b.callFunction();}}};c.onerror=function(){window.console.log("Barcode image Data error >>"+imageUrl);f.imageKey=-1;b.tempImageDrawCount++;if(b.pageImageList!=null){if(b.pageImageList.length<=b.tempImageDrawCount){b.callFunction();}}};}};mCR_exportCanvas.prototype.findImageChart=function(a){var d=a.getRectInPage();if((d.getWidth()!=0&&d.getHeight()!=0)){var c=new Image();c.src="data:image/png;base64,"+a.svgString;a.imageKey=this.pageImageList.length;this.pageImageList.push(c);var b=this;c.onload=function(){b.tempImageDrawCount++;if(b.pageImageList!=null){if(b.pageImageList.length<=b.tempImageDrawCount){b.callFunction();}}};c.onerror=function(){window.console.log("Chart image Data error >>"+a.svgString);a.imageKey=-1;b.tempImageDrawCount++;if(b.pageImageList!=null){if(b.pageImageList.length<=b.tempImageDrawCount){b.callFunction();}}};}};mCR_exportCanvas.prototype.findImageVoiceEye=function(a){var d=a.getRectInPage();if((d.getWidth()!=0&&d.getHeight()!=0)){var c=new Image();c.src="data:image/png;base64,"+a.svgString;a.imageKey=this.pageImageList.length;this.pageImageList.push(c);var b=this;c.onload=function(){b.tempImageDrawCount++;if(b.pageImageList!=null){if(b.pageImageList.length<=b.tempImageDrawCount){b.callFunction();}}};c.onerror=function(){window.console.log("VoiceEye image Data error >>"+a.svgString);a.imageKey=-1;b.tempImageDrawCount++;if(b.pageImageList!=null){if(b.pageImageList.length<=b.tempImageDrawCount){b.callFunction();}}};}};mCR_exportCanvas.prototype.findImageMarkAnyVoice=function(a){var d=a.getRectInPage();if((d.getWidth()!=0&&d.getHeight()!=0)){var c=new Image();c.src="data:image/png;base64,"+a.svgString;a.imageKey=this.pageImageList.length;this.pageImageList.push(c);var b=this;c.onload=function(){b.tempImageDrawCount++;if(b.pageImageList!=null){if(b.pageImageList.length<=b.tempImageDrawCount){b.callFunction();}}};c.onerror=function(){window.console.log("MarkAnyVoice image Data error >>"+a.svgString);a.imageKey=-1;b.tempImageDrawCount++;if(b.pageImageList!=null){if(b.pageImageList.length<=b.tempImageDrawCount){b.callFunction();}}};}};mCR_exportCanvas.prototype.exportSubSectionsInPage=function(){if(this.objDocumentPage.backGround&&!this.isEasyInput){this.objDocumentPage.backGround.area.right=this.objPageStyle.width-this.objPageStyle.leftMargin-this.objPageStyle.rightMargin;this.exportSubSection(this.objDocumentPage.backGround);this.exportControlsInSubSection(this.objDocumentPage.backGround);}for(var a=0;a<this.objDocumentPage.subSectionList.length;a++){var c=this.objDocumentPage.subSectionList[a];if(c.isDrillingView){this.exportSubSection(c);}}var b=new Array();for(var a=0;a<this.objDocumentPage.subSectionList.length;a++){var c=this.objDocumentPage.subSectionList[a];if(c.isDrillingView){if(c.sectionType!=7){this.exportControlsInSubSection(c);}else{b.push(c);}}}b.sort(function(f,d){if(f.area.top>d.area.top){return 1;}if(f.area.top<d.area.top){return -1;}return 0;});for(var a=0;a<b.length;a++){this.exportControlsInSubSection(b[a]);}b=null;if(this.objDocumentPage.foreGround&&!this.isEasyInput){this.exportSubSection(this.objDocumentPage.foreGround);this.exportControlsInSubSection(this.objDocumentPage.foreGround);}};mCR_exportCanvas.prototype.endPage=function(){if(this.isOffScreenCanvas){var a=this.elmCanvas.getContext("2d");a.drawImage(this.elmTempCanvas,0,0,this.elmCanvas.width,this.elmCanvas.height);}this.objLineHashMap=null;this.pageImageList=null;this.tempImageDrawCount=0;this.callFunction=null;this.objAccHashMap=null;};mCR_exportCanvas.prototype.exportSubSection=function(f){var c=f.offsetRect(this.objPageStyle.leftMargin,this.objPageStyle.topMargin);var b=c.newRateRect(this.nPixelRate);var a=this.objDocument.getBackgroundStyle(f.backgroundStyleKey);if(null!=a&&a.backStyle==0){this.objContext.fillStyle=mCR_getStrColor(a.backColor);this.objContext.fillRect(b.left,b.top,b.getWidth(),b.getHeight());}if(this.ruleCtrlVisible){if(f.sectionType!=6&&f.sectionType!=7){var d=this.objContext;window.setTimeout(function(){d.strokeStyle="blue";d.lineWidth=2;d.rect(b.left,b.top,b.getWidth(),b.getHeight());d.stroke();d.font="11pt '나눔고딕' bold";d.fillStyle="blue";d.fillText(f.sectionName+"("+f.editEasyModeId+")",b.left+3,b.top+14);},300);}}};mCR_exportCanvas.prototype.exportControlsInSubSection=function(f){for(var b=0;b<f.controlPageList.length;b++){var a=f.controlPageList[b];var d=true;if(-1!=a.visibleOptionStyleKey){var c=this.objDocument.getVisibleOptionStyle(a.visibleOptionStyleKey);if(null!=c){d=c.toView;if(this.isEasyInput){d=c.toEasyMoad;}}}if(d){this.exportControl(a);}}};mCR_exportCanvas.prototype.exportControl=function(a){var c=true;if(a.pageCountConditionType==21){var b=this.objDocument.checkedTotalPageCount;var f=this.pageIndex+1==b/2+1;if(a.visible){if(f==true){c=false;}}else{c=f||a.conditionVisible;}}else{if(a.pageCountConditionType==22){var d=(this.pageIndex+1)%2;if(d==0){c=false;}}else{if(a.pageCountConditionType==23){var d=(this.pageIndex+1)%2;if(d==1){c=false;}}}}if(c){switch(a.type){case mCR_DocumentControlType.Line:this.exportLine(a);break;case mCR_DocumentControlType.Shape:this.exportShape(a);break;case mCR_DocumentControlType.Label:this.exportLabel(a);break;case mCR_DocumentControlType.Crosstab:this.exportCrosstab(a);break;case mCR_DocumentControlType.Table:this.exportTable(a);break;case mCR_DocumentControlType.Barcode:this.exportBarcode(a);break;case mCR_DocumentControlType.Chart:this.exportChart(a);break;case mCR_DocumentControlType.SubReport:this.exportReportControl(a);break;case mCR_DocumentControlType.Checkbox:this.exportCheckbox(a,false);break;case mCR_DocumentControlType.VoiceEye:this.exportVoiceEye(a);break;case mCR_DocumentControlType.MarkAnyVoiceEye:this.exportMarkAnyVoice(a);break;case mCR_DocumentControlType.VerifyBarcode:this.exportVerifyBarcode(a);break;case mCR_DocumentControlType.VoiceBarcode:this.exportVoiceBarcode(a);break;case mCR_DocumentControlType.Input:this.exportInputbox(a);break;case mCR_DocumentControlType.Button:this.exportInputButton(a);break;case mCR_DocumentControlType.InputSelectBox:this.exportInputSelectBox(a);break;case mCR_DocumentControlType.Calendar:this.exportInputCalendar(a);break;case mCR_DocumentControlType.InputSign:this.exportInputSign(a);break;case mCR_DocumentControlType.InputImage:this.exportInputImage(a);break;case mCR_DocumentControlType.InputCheckbox:this.exportInputCheckbox(a);break;}}};mCR_exportCanvas.prototype.exportInputCheckbox=function(f){var j=f.getRectInPage();var g=f.checkSize;var d=this.objDocument.documentStorage[f.primaryName];if(null!=d){if(d.visible){var b=null;if(f.useText){b=new docRect();b.set(0,0,g,g);var i=j.top+((j.getHeight()-g)/2);if(f.checkboxLeftAlignment){b.offsetRect(j.left,i);j.left+=g;}else{b.offsetRect((j.left+j.getWidth()-g),i);j.setWidth(j.getWidth()-g);}var c=new docRect();c.copyRect(j);this.paintText(c,f.textInfo);}else{b=j;}var k=this.objDocument.getLineStyle(f.outterlineStyleKey);var l=this.objDocument.getLineStyle(f.checkedBorderLineStyleKey);var h=this.objDocument.getShapeStyle(f.shapeStyleKey);if(null!=l&&"true"==d.checked){k=l;}if(null!=k&&null!=h){this.paintShapeStyle(h,b);this.paintLineStyle(k);this.objContext.stroke();}if("true"==d.checked){var a=b.newRateRect(this.nPixelRate);this.objContext.drawImage(this.pageImageList[f.imageKey],a.left,a.top,a.getWidth(),a.getHeight());}}else{if(f.useText){if(f.checkboxLeftAlignment){j.left+=g;}else{j.setWidth(j.getWidth()-g);}var c=new docRect();c.copyRect(j);this.paintText(c,f.textInfo);}}}};mCR_exportCanvas.prototype.exportInputImage=function(b){var c=b.getRectInPage();var d=this.objDocument.documentStorage[b.primaryName];if((c.getWidth()!=0&&c.getHeight()!=0)&&null!=d){if(d.visible&&""!=d.image&&d.image!=null){var a=c.newRateRect(this.nPixelRate);this.objContext.drawImage(this.pageImageList[b.imageKey],a.left,a.top,a.getWidth(),a.getHeight());}else{if(d.visible&&(""==d.image||d.image!=null)){this.setInputControlInfo(c,"image");}}}};mCR_exportCanvas.prototype.exportInputSign=function(c){var d=c.getRectInPage();var g=this.objDocument.documentStorage[c.primaryName];if((d.getWidth()!=0&&d.getHeight()!=0)&&null!=g){if(g.visible&&((""!=g.image&&g.image!=null)||g.showDisplayTextInDialog)){var b=this.objDocument.getLineStyle(c.outterlineStyleKey);var f=this.objDocument.getShapeStyle(c.shapeStyleKey);if(null!=b&&null!=f){this.paintShapeStyle(f,d);this.paintLineStyle(b);this.objContext.stroke();}var a=d.newRateRect(this.nPixelRate);if(g.showDisplayTextInDialog&&!(g.showDisplayTextByValue&&(""!=g.image&&g.image!=null))){this.drawInputSignGuideText(c,g,a);}if((""!=g.image&&g.image!=null)){this.objContext.drawImage(this.pageImageList[c.imageKey],a.left,a.top,a.getWidth(),a.getHeight());}}else{if(g.visible&&(""==g.image||g.image==null)){this.setInputControlInfo(d,"sign");}}}};mCR_exportCanvas.prototype.drawInputSignGuideText=function(O,D,w){var v=0.0264583333;var n=1.32814;var A=1.33333;var r=decodeURIComponent(D.fontName);var L=O.horizontalAlignmentMethod;var c=O.verticalAlignmentMethod;var t=decodeURIComponent(D.guideMessage);var a=D.fontBold;var d=D.fontItalic;var y=decodeURIComponent(D.fontColor);var o=D.fontSize.replace("pt","");var m=1.2*A;var M=0;this.objContext.font=D.fontSize+" "+r;var C=[];var k=0;var q=0;var I=[];var x="";var p=new textArray();var s=0;var E=t.length;var h=w.getHeight();var G=w.getWidth();var u=o*A;var N=0;var g=u;var F=0;var j=0;var B=0;var z=0;for(var H=0;H<E;H++){var f=0;var J=false;if(t[H]!="\n"){f=this.objContext.measureText(t[H]).width+M;k=k+f;}else{J=true;}if(k>G||J){C=k-f;j=N+u;break;}if(!J){x=x+t[H];p.push(new textInfo(t[H],0+k-f,g+N,F));}if(H==E-1){j=N+u;C=k;}}this.objContext.fillStyle=y;this.objContext.lineWidth=1;this.objContext.setLineDash([]);this.objContext.beginPath();if(L==1){B=(G-C)/2;}else{if(L==2){B=(G-C);}else{B=0;}}if(c==1){z=(h-j)/2;}else{if(c==2){z=(h-j-u*0.3);}else{z=0;}}var K="";if(a){K="bold ";}var l="";if(d){l="italic ";}this.objContext.font=l+K+(u/A)+"pt "+r;var b=p.array.length;for(var H=0;H<b;H++){this.objContext.fillText(p.array[H].character,p.array[H].tx+B+w.getLeft(),p.array[H].ty+z+w.getTop());}};mCR_exportCanvas.prototype.exportInputCalendar=function(a){var c=a.getRectInPage();var d=this.objDocument.documentStorage[a.primaryName];if(null!=d){if(d.visible){var b=new docRect();b.copyRect(c);this.paintText(b,a.textInfo);}}};mCR_exportCanvas.prototype.exportInputSelectBox=function(a){var c=a.getRectInPage();var d=this.objDocument.documentStorage[a.primaryName];if(null!=d){if(d.visible){var b=new docRect();b.copyRect(c);this.paintText(b,a.textInfo);}}};mCR_exportCanvas.prototype.exportInputButton=function(a){var c=a.getRectInPage();var d=this.objDocument.documentStorage[a.primaryName];if(null!=d){if(d.visible){var b=new docRect();b.copyRect(c);this.paintText(b,a.textInfo);}}};mCR_exportCanvas.prototype.exportInputbox=function(c){var b=c.getRectInPage();var d=this.objDocument.documentStorage[c.primaryName];if(null!=d){if(d.visible){var a=new docRect();a.copyRect(b);this.paintText(a,c.textInfo);}}};mCR_exportCanvas.prototype.exportLabel=function(d){var k=d.getRectInPage();var l=this.objDocument.getLineStyle(d.outterlineStyleKey);var h=this.objDocument.getShapeStyle(d.shapeStyleKey);var g=this.objDocument.getBackgroundStyle(d.backgroundStyleKey);if((null!=l&&null!=h&&null!=g)&&(k.getWidth()!=0&&k.getHeight()!=0)){this.paintShapeStyle(h,k);this.paintBackgroundStyle(g,k);this.objContext.fill();var b=new docRect();b.copyRect(k);if(d.imageInfo.imageDataKey!=-1){var i=this.objDocument.getBackgroundImageStyle(d.imageInfo.backgroundImageStyleKey);var f=0;if(d.subSection.imagePo!=null){f=d.subSection.imagePo;}var c=this.objDocumentPage.getImageData(Number(d.imageInfo.imageDataKey)+f);if(null!=i&&null!=c){var a=this;this.paintBackgroundImageStyle(h,i,c,k,d.imageKey,d.imageInfo);}}this.paintLineStyle(l);this.objContext.stroke();this.paintText(b,d.textInfo);if(d.editable){this.setEditWebLinkInfo(d,d.getRectInPage(),d.textInfo,d.editableIndex);}if(d.webLinkInfo!=null){if(d.webLinkInfo.type!=-1){this.setWebLinkInfo(d.getRectInPage(),d.webLinkInfo);}}if(this.isAccessibility&&null!=d.accessibilityString){var j=d.accessibilityString;j=j.replace(/\@pc\@|\@pn\@/g,d.textInfo.getOriginalTextInfo().text);var m={type:20,msg:j};this.setWebLinkInfo(d.getRectInPage(),m);}}};mCR_exportCanvas.prototype.exportLine=function(c){var d=c.getRectInPage();var b=d.newRateRect(this.nPixelRate);var a=this.objDocument.getLineStyle(c.lineStyleKey);if(null!=a&&a.style!=0){this.lineDeduplication(b.left,b.top,b.right,b.bottom,a);this.paintLineStyle(a);this.objContext.beginPath();this.objContext.moveTo(b.left,b.top);this.objContext.lineTo(b.right,b.bottom);this.objContext.stroke();}};mCR_exportCanvas.prototype.exportShape=function(d){var c=d.getRectInPage();var b=this.objDocument.getLineStyle(d.outterlineStyleKey);var f=this.objDocument.getShapeStyle(d.shapeStyleKey);var a=this.objDocument.getBackgroundStyle(d.backgroundStyleKey);if((null!=b&&null!=f&&null!=a)&&(c.getWidth()!=0&&c.getHeight()!=0)&&(b.style!=0||a.backStyle!=1)){this.paintShapeStyle(f,c);this.paintBackgroundStyle(a,c);this.objContext.fill();this.paintLineStyle(b);this.objContext.stroke();}};mCR_exportCanvas.prototype.exportBarcode=function(d){var c=d.getRectInPage();var f=this.objDocument.getShapeStyle(d.shapeStyleKey);var a=this.objDocument.getBackgroundStyle(d.backgroundStyleKey);if((c.getWidth()!=0&&c.getHeight()!=0)){this.paintShapeStyle(f,c);this.paintBackgroundStyle(a,c);this.objContext.fill();this.barcodePainterDraw(d,c);if(this.isAccessibility&&null!=d.accessibilityString){var b={type:20,msg:d.accessibilityString};this.setWebLinkInfo(d.getRectInPage(),b);}}};mCR_exportCanvas.prototype.exportChart=function(a){if(a.dataType=="png"){this.exportChartImage(a);}else{if(a.dataType=="doc"){this.exportChartDocument(a);}}if(this.isAccessibility&&null!=a.accessibilityString){var b={type:20,msg:a.accessibilityString};this.setWebLinkInfo(a.getRectInPage(),b);}if(a.webLinkInfo!=null){if(a.webLinkInfo.type!=-1){this.setWebLinkInfo(a.getRectInPage(),a.webLinkInfo);}}};mCR_exportCanvas.prototype.exportChartImage=function(a){var c=a.getRectInPage();if((c.getWidth()!=0&&c.getHeight()!=0)){var b=c.newRateRect(this.nPixelRate);var d=this.pageImageList[a.imageKey];if(null!=d){this.objContext.drawImage(d,b.left,b.top,b.getWidth(),b.getHeight());}if(a.webLinkInfo!=null){if(a.webLinkInfo.type!=-1){this.setWebLinkInfo(a.getRectInPage(),a.webLinkInfo);}}}};mCR_exportCanvas.prototype.exportChartDocument=function(a){var c=new mCR_exportChartPaintCanvas(this,a.getRectInPage());var b=new mCR_exportChart(c,a.svgString);b.exportt();};mCR_exportCanvas.prototype.exportVoiceEye=function(b){var c=b.getRectInPage();if((c.getWidth()!=0&&c.getHeight()!=0)){var a=c.newRateRect(this.nPixelRate);var d=this.pageImageList[b.imageKey];if(null!=d){this.objContext.drawImage(d,a.left,a.top,a.getWidth(),a.getHeight());}}};mCR_exportCanvas.prototype.exportMarkAnyVoice=function(b){var c=b.getRectInPage();if((c.getWidth()!=0&&c.getHeight()!=0)){var a=c.newRateRect(this.nPixelRate);var d=this.pageImageList[b.imageKey];if(null!=d){this.objContext.drawImage(d,a.left,a.top,a.getWidth(),a.getHeight());}}};mCR_exportCanvas.prototype.exportVoiceBarcode=function(l){var i=l.getRectInPage();var f=this.objDocument.getShapeStyle(l.shapeStyleKey);var d=this.objDocument.getBackgroundStyle(l.backgroundStyleKey);if((i.getWidth()!=0&&i.getHeight()!=0)){var a=null;try{a=jQuery.parseJSON(l.data);}catch(g){a=null;window.console.log("not Found VoiceBarcode data >> "+l.data);}if(null!=a){var b=this.pageImageList[l.imageKey];if(b!=null){this.objContext.drawImage(b,i.left*0.378,i.top*0.378,i.getWidth()*0.378,i.getHeight()*0.378);}var c=new docRect();c.copyRect(i);var m=l.getBarcodeSize();var k=i.getWidth();var j=(k-m)/2;c.setLeft(i.left+j);c.setTop(i.top+13);c.setWidth(m);c.setHeight(m);var h=new mCR_SymbologyQRCode(true,this.objContext,l,c);h.drawPattern(a);if(l.text!=""){this.objContext.font="bold 5pt 'NanumGothic'";this.objContext.fillStyle="black";this.objContext.fillText(l.text,c.left*0.378,(i.bottom-4)*0.378);}}}};mCR_exportCanvas.prototype.exportVerifyBarcode=function(i){var h=i.getRectInPage();var c=this.objDocument.getShapeStyle(i.shapeStyleKey);var b=this.objDocument.getBackgroundStyle(i.backgroundStyleKey);if((h.getWidth()!=0&&h.getHeight()!=0)){var j=h.getHeight();h.setWidth(j);var a=null;try{a=jQuery.parseJSON(i.text);}catch(f){a=null;window.console.log("not Found VerifyBarcode data >> "+i.text);}if(null!=a){for(var d=0;d<a.length;d++){var g=new mCR_SymbologyQRCode(true,this.objContext,i,h);g.drawPattern(a[d]);h.offsetRect(j+50,0);}}}};mCR_exportCanvas.prototype.exportCheckbox=function(a,c){var g=a.getRectInPage();var b=this.objDocument.getLineStyle(a.outterlineStyleKey);var h=this.objDocument.getShapeStyle(a.shapeStyleKey);if((null!=b&&null!=h)&&(g.getWidth()!=0&&g.getHeight()!=0)){this.paintShapeStyle(h,g);this.paintLineStyle(b);this.objContext.stroke();if(a.checkValue){var d=checkboxRevisePosition(g);this.brushCheck(d,a.checkType,a.checkColor);}if(this.isAccessibility&&!c&&null!=a.accessibilityString){var f={type:20,msg:a.accessibilityString};this.setWebLinkInfo(a.getRectInPage(),f);}}};mCR_exportCanvas.prototype.exportTable=function(a){var f=a;var d=f.getRectInPage();var b=new docCellMap();if(this.isAccessibility&&null!=f.accessibilityString&&""!=f.accessibilityString){var c={type:20,msg:f.accessibilityString};this.setWebLinkInfo(d,c);}this.paintCellsBackgroundText(d,f,b);this.paintCellsOutterLine(d,f,b);};mCR_exportCanvas.prototype.paintCellsBackgroundText=function(b,p,h){var i=p.getRowCount();for(var j=0;j<i;j++){var d=new Array();h.cellMap.push(d);var n=p.getColumnCount();for(var m=0;m<n;m++){var a=p.getTableCellNormal(j,m);if(a!=null){var f=new docCellInfo(false);f.colSpan=a.colSpan;f.rowSpan=a.rowSpan;d.push(f);var l=false;var g=false;var s=false;var c=false;if(j==0&&m==0){if(p.roundLeftTop==1){l=true;}}if(j==0&&(m==n-1)){if(p.roundRightTop==1){g=true;}}if((j==i-1)&&m==0){if(p.roundLeftBottom==1){s=true;}}if((j==i-1)&&(m==n-1)){if(p.roundRightBottom==1){c=true;}}this.paintCellBackground(b,a,l,g,s,c);if(a.webLinkInfo!=null){if(a.webLinkInfo.type!=-1){var k=a.getRectInPage();k.offsetRect(b.left,b.top);this.setWebLinkInfo(k,a.webLinkInfo);}}if(this.isAccessibility){if(null!=a.accessibilityString){var r=a.accessibilityString;r=r.replace(/\@pc\@|\@pn\@/g,a.detailTextInfo.getOriginalTextInfo().text);var q={type:20,ctrl:1,msg:r};var o=a.getRectInPage();o.offsetRect(b.left,b.top);this.setWebLinkInfo(o,q);}else{var q={type:400,ctrl:1,msg:""};var o=a.getRectInPage();o.offsetRect(b.left,b.top);this.setWebLinkInfo(o,q);}}}else{var f=new docCellInfo(true);d.push(f);}}}};mCR_exportCanvas.prototype.paintCellBackground=function(k,n,j,a,i,l){var m=n.getRectInPage();m.setLeft(k.getLeft()+m.getLeft());m.setTop(k.getTop()+m.getTop());m.setRight(k.getLeft()+m.getRight());m.setBottom(k.getTop()+m.getBottom());var h=new Object();h.shapeType=0;var f=this.objDocument.getBackgroundStyle(n.backgroundStyleKey);if((f!=null)&&(m.getWidth()!=0&&m.getHeight()!=0)){if(f.getBackStyle()!=mCR_BackStyleType.Transparent){if(j||a||i||l){this.paintCurvedShapeStyle(m,j,a,i,l);}else{this.paintShapeStyle(h,m);}this.paintBackgroundStyle(f,m);this.objContext.fill();}if(n.imageInfo.imageDataKey!=-1){var g=this.objDocument.getBackgroundImageStyle(n.imageInfo.backgroundImageStyleKey);var d=0;if(n.tableRow.table.subSection.imagePo!=null){d=n.tableRow.table.subSection.imagePo;}var c=this.objDocumentPage.getImageData(Number(n.imageInfo.imageDataKey)+d);if(g!=null&&c!=null){this.paintBackgroundImageStyle(h,g,c,m,n.imageKey,n.imageInfo);}}if(n.isCheckbox){this.shiftCheckboxPosition(n,m);this.exportCheckbox(n.documentCheckbox,true);if(n.editable){var b=n.getRectInPage();b.offsetRect(k.left,k.top);this.setCheckEditWebLinkInfo(n.documentCheckbox,b,n.editableIndex,n.documentCheckbox.checkValue);}}else{if(n.editable){var b=n.getRectInPage();b.offsetRect(k.left,k.top);this.setEditWebLinkInfo(n,b,n.detailTextInfo,n.editableIndex);}}this.paintText(m,n.detailTextInfo);}};mCR_exportCanvas.prototype.paintCellsOutterLine=function(f,k,c){this.checkingLastCell(c);var g=k.getRowCount();var h=null;for(var d=0;d<g;d++){h=k.getColumnCount();for(var i=0;i<h;i++){var j=k.getTableCellNormal(d,i);if(j!=null){this.paintCellOutterLine(f,j,k,d,g,i,h,c);}}}var a=this.objDocument.getLineStyle(k.lineFDiagonaStyleKey);if(a.style!=mCR_LineStyle.None){this.paintLineBDiagonal(c.leftBottomCell.getRectInPage().addRect(f.getLeft(),f.getTop(),f.getLeft(),f.getTop()),c.rightTopCell.getRectInPage().addRect(f.getLeft(),f.getTop(),f.getLeft(),f.getTop()),a,k.roundLeftBottom,k.roundRightTop);}var b=this.objDocument.getLineStyle(k.lineBDiagonaStyleKey);if(b.style!=mCR_LineStyle.None){this.paintLineFDiagonal(c.leftTopCell.getRectInPage().addRect(f.getLeft(),f.getTop(),f.getLeft(),f.getTop()),c.rightBottomCell.getRectInPage().addRect(f.getLeft(),f.getTop(),f.getLeft(),f.getTop()),b,k.roundLeftTop,k.roundRightBottom);}};mCR_exportCanvas.prototype.paintCellOutterLine=function(c,b,F,t,s,w,x,p){var y=b.getRectInPage();y.setLeft(c.getLeft()+y.getLeft());y.setTop(c.getTop()+y.getTop());y.setRight(c.getLeft()+y.getRight());y.setBottom(c.getTop()+y.getBottom());var n=p.cellMap[t][w];var z=this.objDocument.getLineStyle(b.leftLineStyleKey);var H=this.objDocument.getLineStyle(b.topLineStyleKey);var D=this.objDocument.getLineStyle(b.rightLineStyleKey);var h=this.objDocument.getLineStyle(b.bottomLineStyleKey);var C=this.objDocument.getLineStyle(b.frontDiagonalLineStyleKey);var I=this.objDocument.getLineStyle(b.backDiagonalLineStyleKey);if(z!=null&&H!=null&&D!=null&&h!=null&&H!=null){var v=false;var m=false;var J=false;var d=false;if(t==0){var k=this.objDocument.getLineStyle(F.outterlineStyleKey);if(k.style!=0){H=k;}}if(w==0){var k=this.objDocument.getLineStyle(F.outterlineStyleKey);if(k.style!=0){z=k;}}if(n.isLeftLast){var k=this.objDocument.getLineStyle(F.outterlineStyleKey);if(k.style!=0){D=k;}}if(n.isTopLast){var k=this.objDocument.getLineStyle(F.outterlineStyleKey);if(k.style!=0){h=k;}}var i=this.getWidthMarginNormal(z.width,z.style);var l=this.getWidthMarginNormal(D.width,D.style);var f=this.getWidthMarginNormal(H.width,H.style);var u=this.getWidthMarginNormal(h.width,h.style);var G=null;var E=null;var o=null;var g=null;var B=null;var r=null;var q=null;var a=null;if(z.style==mCR_LineStyle.DoubleLine){o=this.getWidthMarginOutter(H.width,H.style);g=this.getWidthMarginOutter(h.width,h.style);q=this.getWidthMarginInner(H.width,H.style);a=this.getWidthMarginInner(h.width,h.style);}else{if(z.style==mCR_LineStyle.InnerLine){q=this.getWidthMarginInner(H.width,H.style);a=this.getWidthMarginInner(h.width,h.style);}}if(H.style==mCR_LineStyle.DoubleLine){G=this.getWidthMarginOutter(z.width,z.style);E=this.getWidthMarginOutter(D.width,D.style);B=this.getWidthMarginInner(z.width,z.style);r=this.getWidthMarginInner(D.width,D.style);}else{if(H.style==mCR_LineStyle.InnerLine){B=this.getWidthMarginInner(z.width,z.style);r=this.getWidthMarginInner(D.width,D.style);}}if(D.style==mCR_LineStyle.DoubleLine){if(o==null){o=this.getWidthMarginOutter(H.width,H.style);}if(g==null){g=this.getWidthMarginOutter(h.width,h.style);}if(q==null){q=this.getWidthMarginInner(H.width,H.style);}if(a==null){a=this.getWidthMarginInner(h.width,h.style);}}else{if(D.style==mCR_LineStyle.InnerLine){if(q==null){q=this.getWidthMarginInner(H.width,H.style);}if(a==null){a=this.getWidthMarginInner(h.width,h.style);}}}if(h.style==mCR_LineStyle.DoubleLine){if(G==null){G=this.getWidthMarginOutter(z.width,z.style);}if(E==null){E=this.getWidthMarginOutter(D.width,D.style);}if(B==null){B=this.getWidthMarginInner(z.width,z.style);}if(r==null){r=this.getWidthMarginInner(D.width,D.style);}}else{if(h.style==mCR_LineStyle.InnerLine){if(B==null){B=this.getWidthMarginInner(z.width,z.style);}if(r==null){r=this.getWidthMarginInner(D.width,D.style);}}}if(t==0&&w==0){p.leftTopCell=b;if(F.roundLeftTop==1){v=true;}}if(t==0&&n.isLeftLast){p.rightTopCell=b;if(F.roundRightTop==1){m=true;}}if(n.isTopLast&&w==0){p.leftBottomCell=b;if(F.roundLeftBottom==1){J=true;}}if(n.isTopLast&&n.isLeftLast){p.rightBottomCell=b;if(F.roundRightBottom==1){d=true;}}if(z.style!=0){if(w!=0&&p.cellMap[t][w-1].rightLineStyleKey==0){}else{n.leftLineStyleKey=b.leftLineStyleKey;if(z.style==mCR_LineStyle.DoubleLine){var j=this.getCellLineWidth(z.width)/100*72/2.54*this.nPtToPxRate;this.paintCellLineLeft(y,z,v,J,o,g,-j);this.paintCellLineLeft(y,z,v,J,q,a,j);}else{if(z.style==mCR_LineStyle.InnerLine){var j=this.getCellLineWidth(z.width)/100*72/2.54*this.nPtToPxRate;this.paintCellLineLeft(y,z,v,J,q,a,j);}else{var j=0;this.paintCellLineLeft(y,z,v,J,f,u,j);}}}}if(H.style!=0){if(t!=0&&p.cellMap[t-1][w].bottomLineStyleKey==0){}else{n.topLineStyleKey=b.topLineStyleKey;if(H.style==mCR_LineStyle.DoubleLine){var A=this.getCellLineWidth(H.width)/100*72/2.54*this.nPtToPxRate;this.paintCellLineTop(y,H,v,m,G,E,-A);this.paintCellLineTop(y,H,v,m,B,r,A);}else{if(H.style==mCR_LineStyle.InnerLine){var A=this.getCellLineWidth(H.width)/100*72/2.54*this.nPtToPxRate;this.paintCellLineTop(y,H,v,m,B,r,A);}else{var A=0;this.paintCellLineTop(y,H,v,m,i,l,A);}}}}if(D.style!=0){if(!n.isLeftLast&&p.cellMap[t][w+1].leftLineStyleKey==0){}else{n.rightLineStyleKey=b.rightLineStyleKey;if(D.style==mCR_LineStyle.DoubleLine){var j=this.getCellLineWidth(D.width)/100*72/2.54*this.nPtToPxRate;this.paintCellLineRight(y,D,m,d,o,g,j);this.paintCellLineRight(y,D,m,d,q,a,-j);}else{if(D.style==mCR_LineStyle.InnerLine){var j=this.getCellLineWidth(D.width)/100*72/2.54*this.nPtToPxRate;this.paintCellLineRight(y,D,m,d,q,a,-j);}else{var j=0;this.paintCellLineRight(y,D,m,d,f,u,j);}}}}if(h.style!=0){if(!n.isTopLast&&p.cellMap[t+1][w].bottomLineStyleKey==0){}else{n.bottomLineStyleKey=b.bottomLineStyleKey;if(h.style==mCR_LineStyle.DoubleLine){var A=this.getCellLineWidth(h.width)/100*72/2.54*this.nPtToPxRate;this.paintCellLineBottom(y,h,J,d,G,E,A);this.paintCellLineBottom(y,h,J,d,B,r,-A);}else{if(h.style==mCR_LineStyle.InnerLine){var A=this.getCellLineWidth(h.width)/100*72/2.54*this.nPtToPxRate;this.paintCellLineBottom(y,h,J,d,B,r,-A);}else{var A=0;this.paintCellLineBottom(y,h,J,d,i,l,A);}}}}if(C.style!=0){this.paintLineBDiagonal(y,y,C,J,m);}if(I.style!=0){this.paintLineFDiagonal(y,y,I,v,d);}}};mCR_exportCanvas.prototype.paintCellLineLeft=function(h,d,f,c,j,g,b){var h=h.newRateRect(0.378);var i=b+(h.getLeft());var a=null;var k=null;if(!(f||c)){a=(h.getTop());k=(h.getBottom());a=a-j;k=k+g;if(!this.isEasyInput){this.lineDeduplication(i,a,i,k,d);}this.paintLineStyle(d);this.objContext.beginPath();this.objContext.moveTo(i,a);this.objContext.lineTo(i,k);this.objContext.stroke();}else{if(c&&f){this.paintRoundLeftBottom(h,d,b,-b);this.paintRoundLeftTop(h,d,b,b);}else{if(c){this.paintRoundLeftBottom(h,d,b,-b);a=(h.getTop());k=((h.getTop()+h.getHeight()/2));a=a-j;k=k+g;if(!this.isEasyInput){this.lineDeduplication(i,a,i,k,d);}this.paintLineStyle(d);this.objContext.beginPath();this.objContext.moveTo(i,a);this.objContext.lineTo(i,k);this.objContext.stroke();}else{this.paintRoundLeftTop(h,d,b,b);a=((h.getBottom()-h.getHeight()/2));k=(h.getBottom());a=a-j;k=k+g;if(!this.isEasyInput){this.lineDeduplication(i,a,i,k,d);}this.paintLineStyle(d);this.objContext.beginPath();this.objContext.moveTo(i,a);this.objContext.lineTo(i,k);this.objContext.stroke();}}}};mCR_exportCanvas.prototype.paintCellLineTop=function(k,h,i,b,d,g,c){var k=k.newRateRect(0.378);var j=(k.getTop())+c;var a=null;var f=null;if(!(i||b)){a=(k.getLeft());f=(k.getRight());a=a-d;f=f+g;if(!this.isEasyInput){this.lineDeduplication(a,j,f,j,h);}this.paintLineStyle(h);this.objContext.beginPath();this.objContext.moveTo(a,j);this.objContext.lineTo(f,j);this.objContext.stroke();}else{if(i&&b){this.paintRoundTopLeft(k,h,c,c);this.paintRoundTopRight(k,h,-c,c);}else{if(i){this.paintRoundTopLeft(k,h,c,c);a=((k.getRight()-k.getWidth()/2));f=(k.getRight());a=a-d;f=f+g;if(!this.isEasyInput){this.lineDeduplication(a,j,f,j,h);}this.paintLineStyle(h);this.objContext.beginPath();this.objContext.moveTo(a,j);this.objContext.lineTo(f,j);this.objContext.stroke();}else{this.paintRoundTopRight(k,h,-c,c);a=(k.getLeft());f=((k.getLeft()+k.getWidth()/2));a=a-d;f=f+g;if(!this.isEasyInput){this.lineDeduplication(a,j,f,j,h);}this.paintLineStyle(h);this.objContext.beginPath();this.objContext.moveTo(a,j);this.objContext.lineTo(f,j);this.objContext.stroke();}}}};mCR_exportCanvas.prototype.paintCellLineRight=function(g,d,b,i,j,f,c){var g=g.newRateRect(0.378);var h=c+(g.getRight());var a=null;var k=null;if(!(b||i)){a=(g.getTop());k=(g.getBottom());a=a-j;k=k+f;if(!this.isEasyInput){this.lineDeduplication(h,a,h,k,d);}this.paintLineStyle(d);this.objContext.beginPath();this.objContext.moveTo(h,a);this.objContext.lineTo(h,k);this.objContext.stroke();}else{if(b&&i){this.paintRoundRightBottom(g,d,-c,-c);this.paintRoundRightTop(g,d,c,-c);}else{if(i){this.paintRoundRightBottom(g,d,-c,-c);a=(g.getTop());k=((g.getTop()+g.getHeight()/2));a=a-j;k=k+f;if(!this.isEasyInput){this.lineDeduplication(h,a,h,k,d);}this.paintLineStyle(d);this.objContext.beginPath();this.objContext.moveTo(h,a);this.objContext.lineTo(h,k);this.objContext.stroke();}else{this.paintRoundRightTop(g,d,c,-c);a=((g.getBottom()-g.getHeight()/2));k=(g.getBottom());a=a-j;k=k+f;if(!this.isEasyInput){this.lineDeduplication(h,a,h,k,d);}this.paintLineStyle(d);this.objContext.beginPath();this.objContext.moveTo(h,a);this.objContext.lineTo(h,k);this.objContext.stroke();}}}};mCR_exportCanvas.prototype.paintCellLineBottom=function(j,h,f,k,c,g,b){var j=j.newRateRect(0.378);var i=(j.getBottom())+b;var a=null;var d=null;if(!(f||k)){a=(j.getLeft());d=(j.getRight());a=a-c;d=d+g;if(!this.isEasyInput){this.lineDeduplication(a,i,d,i,h);}this.paintLineStyle(h);this.objContext.beginPath();this.objContext.moveTo(a,i);this.objContext.lineTo(d,i);this.objContext.stroke();}else{if(f&&k){this.paintRoundBottomLeft(j,h,-b,b);this.paintRoundBottomRight(j,h,-b,-b);}else{if(f){this.paintRoundBottomLeft(j,h,-b,b);a=((j.getRight()-j.getWidth()/2));d=(j.getRight());a=a-c;d=d+g;if(!this.isEasyInput){this.lineDeduplication(a,i,d,i,h);}this.paintLineStyle(h);this.objContext.beginPath();this.objContext.moveTo(a,i);this.objContext.lineTo(d,i);this.objContext.stroke();}else{this.paintRoundBottomRight(j,h,-b,-b);a=(j.getLeft());d=((j.getLeft()+j.getWidth()/2));a=a-c;d=d+g;if(!this.isEasyInput){this.lineDeduplication(a,i,d,i,h);}this.paintLineStyle(h);this.objContext.beginPath();this.objContext.moveTo(a,i);this.objContext.lineTo(d,i);this.objContext.stroke();}}}};mCR_exportCanvas.prototype.paintLineFDiagonal=function(f,k,c,d,j){var f=f.newRateRect(0.378);var k=k.newRateRect(0.378);var h=0.7071;var b=(f.getLeft());var a=((k.getLeft()+k.getWidth()));var i=(f.getTop());var g=((k.getTop()+k.getHeight()));if(d){b+=((f.getWidth()/2*(1-h)));i+=((f.getHeight()/2*(1-h)));}if(j){a-=((k.getWidth()/2*(1-h)));g-=((k.getHeight()/2*(1-h)));}this.lineDeduplication(b,i,a,g,c);this.paintLineStyle(c);this.objContext.beginPath();this.objContext.moveTo(b,i);this.objContext.lineTo(a,g);this.objContext.stroke();};mCR_exportCanvas.prototype.paintLineBDiagonal=function(g,k,f,d,b){var g=g.newRateRect(0.378);var k=k.newRateRect(0.378);var i=0.7071;var c=(g.getLeft());var a=((k.getLeft()+k.getWidth()));var j=((g.getTop()+g.getHeight()));var h=(k.getTop());if(d){c+=((g.getWidth()/2*(1-i)));j-=((g.getHeight()/2*(1-i)));}if(b){a-=((k.getWidth()/2*(1-i)));h+=((k.getHeight()/2*(1-i)));}this.lineDeduplication(c,j,a,h,f);this.paintLineStyle(f);this.objContext.beginPath();this.objContext.moveTo(c,j);this.objContext.lineTo(a,h);this.objContext.stroke();};mCR_exportCanvas.prototype.paintRoundLeftTop=function(j,b,i,d){this.paintLineStyle(b);var a=((j.getLeft())+i).toFixed(2);var g=((j.getTop()+j.getHeight()/2)+d).toFixed(2);var h=((j.getTop()+j.getHeight()*0.2929)+d).toFixed(2);var c=(((j.getLeft()+j.getWidth()/2*0.2929))+i).toFixed(2);var f=((j.getTop()+j.getHeight()/2*0.2929)+d).toFixed(2);this.objContext.beginPath();this.objContext.moveTo(a,g);this.objContext.bezierCurveTo(a,g,a,h,c,f);this.objContext.stroke();};mCR_exportCanvas.prototype.paintRoundTopLeft=function(j,c,i,f){this.paintLineStyle(c);var a=((j.getTop())+f).toFixed(2);var g=(((j.getLeft()+j.getWidth()/2))+i).toFixed(2);var b=((j.getLeft()+j.getWidth()*0.2929)+i).toFixed(2);var d=(((j.getLeft()+j.getWidth()/2*0.2929))+i).toFixed(2);var h=((j.getTop()+j.getHeight()/2*0.2929)+f).toFixed(2);this.objContext.beginPath();this.objContext.moveTo(d,h);this.objContext.bezierCurveTo(b,a,g,a,g,a);this.objContext.stroke();};mCR_exportCanvas.prototype.paintRoundTopRight=function(j,b,h,d){this.paintLineStyle(b);var a=(j.getTop()+d).toFixed(2);var g=(j.getRight()+h).toFixed(2);var k=((j.getRight()-j.getWidth()/2)+h).toFixed(2);var c=((j.getRight()-j.getWidth()*0.2929)+h).toFixed(2);var i=(((j.getRight()-j.getWidth()/2*0.2929))+h).toFixed(2);var f=((j.getTop()+j.getHeight()/2*0.2929)+d).toFixed(2);this.objContext.beginPath();this.objContext.moveTo(i,f);this.objContext.bezierCurveTo(c,a,k,a,k,a);this.objContext.stroke();};mCR_exportCanvas.prototype.paintRoundRightTop=function(j,a,h,b){this.paintLineStyle(a);var d=(j.getRight()+h).toFixed(2);var i=(((j.getRight()-j.getWidth()/2*0.2929))+h).toFixed(2);var g=((j.getTop()+j.getHeight()*0.2929)+b).toFixed(2);var c=((j.getTop()+j.getHeight()/2*0.2929)+b).toFixed(2);var f=((j.getTop()+j.getHeight()/2)+b).toFixed(2);this.objContext.beginPath();this.objContext.moveTo(d,f);this.objContext.bezierCurveTo(d,f,d,g,i,c);this.objContext.stroke();};mCR_exportCanvas.prototype.paintRoundLeftBottom=function(j,b,i,d){this.paintLineStyle(b);var a=((j.getLeft())+i).toFixed(2);var g=((j.getBottom()-j.getHeight()/2)+d).toFixed(2);var h=((j.getBottom()-j.getHeight()*0.2929)+d).toFixed(2);var c=(((j.getLeft()+j.getWidth()/2*0.2929))+i).toFixed(2);var f=((j.getBottom()-j.getHeight()/2*0.2929)+d).toFixed(2);this.objContext.beginPath();this.objContext.moveTo(a,g);this.objContext.bezierCurveTo(a,g,a,h,c,f);this.objContext.stroke();};mCR_exportCanvas.prototype.paintRoundBottomLeft=function(i,b,h,d){this.paintLineStyle(b);var j=((i.getBottom())+d).toFixed(2);var f=(((i.getLeft()+i.getWidth()/2))+h).toFixed(2);var a=((i.getLeft()+i.getWidth()*0.2929)+h).toFixed(2);var c=(((i.getLeft()+i.getWidth()/2*0.2929))+h).toFixed(2);var g=((i.getBottom()-i.getHeight()/2*0.2929)+d).toFixed(2);this.objContext.beginPath();this.objContext.moveTo(c,g);this.objContext.bezierCurveTo(a,j,f,j,f,j);this.objContext.stroke();};mCR_exportCanvas.prototype.paintRoundRightBottom=function(j,a,h,b){this.paintLineStyle(a);var d=(j.getRight()+h).toFixed(2);var f=((j.getBottom()-j.getHeight()/2)+b).toFixed(2);var i=(((j.getRight()-j.getWidth()/2*0.2929))+h).toFixed(2);var g=((j.getBottom()-j.getHeight()*0.2929)+b).toFixed(2);var c=((j.getBottom()-j.getHeight()/2*0.2929)+b).toFixed(2);this.objContext.beginPath();this.objContext.moveTo(d,f);this.objContext.bezierCurveTo(d,f,d,g,i,c);this.objContext.stroke();};mCR_exportCanvas.prototype.paintRoundBottomRight=function(i,a,g,c){this.paintLineStyle(a);var j=((i.getBottom())+c).toFixed(2);var f=(i.getRight()+g).toFixed(2);var k=((i.getRight()-i.getWidth()/2)+g).toFixed(2);var b=((i.getRight()-i.getWidth()*0.2929)+g).toFixed(2);var h=(((i.getRight()-i.getWidth()/2*0.2929))+g).toFixed(2);var d=((i.getBottom()-i.getHeight()/2*0.2929)+c).toFixed(2);this.objContext.beginPath();this.objContext.moveTo(h,d);this.objContext.bezierCurveTo(b,j,k,j,k,j);this.objContext.stroke();};mCR_exportCanvas.prototype.getCellLineWidth=function(a){var b=4;var c=a/72*2.54;if(c<b){c=b;}return c;};mCR_exportCanvas.prototype.checkingLastCell=function(d){var a=d.cellMap.length;for(var f=0;f<a;f++){var g=d.cellMap[f].length;for(var c=0;c<g;c++){var b=d.cellMap[f][c];if(b.rowSpan>1){if(f+b.rowSpan==a){b.isTopLast=true;}}if(b.colSpan>1){if(c+b.colSpan==g){b.isLeftLast=true;}}if(f==a-1&&!b.dumy){b.isTopLast=true;}if(c==g-1&&!b.dumy){b.isLeftLast=true;}}}};mCR_exportCanvas.prototype.exportCrosstab=function(a){this.drawMatrixCells(a.matrixHeader);this.drawMatrixCells(a.matrixRow);this.drawMatrixCells(a.matrixColumn);this.drawMatrixCells(a.matrixSummarized);this.drawCrosstabOutterline(a);};mCR_exportCanvas.prototype.drawMatrixCells=function(a){var k=a.getRowCount();var l=a.getColumnCount();var h=new docStyleShape();h.shapeType=0;for(var i=0;i<k;i++){for(var m=0;m<l;m++){var b=a.getCrosstabBaseCell(i,m);if(b.getType()==mCR_DocumentControlType.TableCell){var j=b.getRectInPage();var h=new docStyleShape();h.shapeType=0;var f=this.objDocument.getBackgroundStyle(b.backgroundStyleKey);if((f!=null)&&(j.getWidth()!=0&&j.getHeight()!=0)){if(f.getBackStyle()!=mCR_BackStyleType.Transparent){this.paintShapeStyle(h,j);this.paintBackgroundStyle(f,j);this.objContext.fill();}if(b.imageInfo.imageDataKey!=-1){var g=this.objDocument.getBackgroundImageStyle(b.imageInfo.backgroundImageStyleKey);var d=0;if(b.crosstabRow.matrix.crosstab.subSection.imagePo!=null){d=b.crosstabRow.matrix.crosstab.subSection.imagePo;}var c=this.objDocumentPage.getImageData(Number(b.imageInfo.imageDataKey)+d);if(g!=null&&c!=null){this.paintBackgroundImageStyle(h,g,c,j,b.imageKey,b.imageInfo);}}this.paintText(j,b.detailTextInfo);if(b.editable){this.setEditWebLinkInfo(b,b.getRectInPage(),b.detailTextInfo,b.editableIndex);}}if(b.webLinkInfo!=null){if(b.webLinkInfo.type!=-1){this.setWebLinkInfo(b.getRectInPage(),b.webLinkInfo);}}if(this.isAccessibility&&null!=b.accessibilityString){var n={type:20,msg:b.accessibilityString};this.setWebLinkInfo(b.getRectInPage(),n);}}}}for(var i=0;i<k;i++){for(var m=0;m<l;m++){var b=a.getCrosstabBaseCell(i,m);if(b.getType()==mCR_DocumentControlType.TableCell){this.drawCellLine(b);}}}};mCR_exportCanvas.prototype.drawCellLine=function(m){var k=m.getRectInPage();k=k.newRateRect(0.378);var i=this.objDocument.getLineStyle(m.leftLineStyleKey);var d=this.objDocument.getLineStyle(m.topLineStyleKey);var l=this.objDocument.getLineStyle(m.rightLineStyleKey);var b=this.objDocument.getLineStyle(m.bottomLineStyleKey);var j=this.objDocument.getLineStyle(m.frontDiagonalLineStyleKey);var h=this.objDocument.getLineStyle(m.backDiagonalLineStyleKey);if(i!=null&&d!=null&&l!=null&&b!=null&&d!=null){if(i.style!=0){var f=this.getWidthMarginNormal(d.width,d.style);var c=this.getWidthMarginNormal(b.width,b.style);this.lineDeduplication(k.left,k.top-f,k.left,k.bottom+c,i);this.paintLineStyle(i);this.objContext.beginPath();this.objContext.moveTo(k.left,k.top-f);this.objContext.lineTo(k.left,k.bottom+c);this.objContext.stroke();}if(d.style!=0){var a=this.getWidthMarginNormal(i.width,i.style);var g=this.getWidthMarginNormal(l.width,l.style);this.lineDeduplication(k.left-a,k.top,k.right+g,k.top,d);this.paintLineStyle(d);this.objContext.beginPath();this.objContext.moveTo(k.left-a,k.top);this.objContext.lineTo(k.right+g,k.top);this.objContext.stroke();}if(l.style!=0){var f=this.getWidthMarginNormal(d.width,d.style);var c=this.getWidthMarginNormal(b.width,b.style);this.lineDeduplication(k.right,k.top-f,k.right,k.bottom+c,l);this.paintLineStyle(l);this.objContext.beginPath();this.objContext.moveTo(k.right,k.top-f);this.objContext.lineTo(k.right,k.bottom+c);this.objContext.stroke();}if(b.style!=0){var a=this.getWidthMarginNormal(i.width,i.style);var g=this.getWidthMarginNormal(l.width,l.style);this.lineDeduplication(k.left-a,k.bottom,k.right+g,k.bottom,b);this.paintLineStyle(b);this.objContext.beginPath();this.objContext.moveTo(k.left-a,k.bottom);this.objContext.lineTo(k.right+g,k.bottom);this.objContext.stroke();}if(j.style!=0){this.lineDeduplication(k.right,k.top,k.left,k.bottom,j);this.paintLineStyle(j);this.objContext.beginPath();this.objContext.moveTo(k.right,k.top);this.objContext.lineTo(k.left,k.bottom);this.objContext.stroke();}if(h.style!=0){this.lineDeduplication(k.left,k.top,k.right,k.bottom,h);this.paintLineStyle(h);this.objContext.beginPath();this.objContext.moveTo(k.left,k.top);this.objContext.lineTo(k.right,k.bottom);this.objContext.stroke();}}};mCR_exportCanvas.prototype.drawCrosstabOutterline=function(b){var c=b.getRectInPage();var a=this.objDocument.getLineStyle(b.outterlineStyleKey);var d=new docStyleShape();d.shapeType=0;this.paintShapeStyle(d,c);this.paintLineStyle(a);this.objContext.stroke();};mCR_exportCanvas.prototype.getWidthMarginNormal=function(b,a){var c=this.getCellLineWidth(b);var d=0;if(a==mCR_LineStyle.DoubleLine||a==mCR_LineStyle.InnerLine){d=+c/2+2;}else{d=(c/2)-1;if(d<0){d=0;}}return d/100*72/2.54*this.nPtToPxRate;};mCR_exportCanvas.prototype.getWidthMarginOutter=function(b,a){var c=this.getCellLineWidth(b);var d=0;if(a==mCR_LineStyle.DoubleLine||a==mCR_LineStyle.InnerLine){d=c/2*3-2;}else{d=(c/2)-1;}return d/100*72/2.54*this.nPtToPxRate;};mCR_exportCanvas.prototype.getWidthMarginInner=function(b,a){var c=this.getCellLineWidth(b);var d=0;if(a==mCR_LineStyle.DoubleLine||a==mCR_LineStyle.InnerLine){d=-1*c/2-2;}else{d=(c/2)-1;}return d/100*72/2.54*this.nPtToPxRate;};mCR_exportCanvas.prototype.shiftCheckboxPosition=function(b,c){var f=c;var d=b.documentCheckbox.rect;var g=d.getWidth();var a=d.getHeight();var i=f.left+((f.getWidth()-g)/2);var h=f.top+((f.getHeight()-a)/2);d.left=i;d.top=h;d.right=i+g;d.bottom=h+a;};mCR_exportCanvas.prototype.exportReportControl=function(a){for(var b=0;b<a.subSectionList.length;b++){this.exportReportControlSubSection(a.subSectionList[b]);}for(var b=0;b<a.subSectionList.length;b++){this.exportControlsInSubSection(a.subSectionList[b]);}};mCR_exportCanvas.prototype.exportReportControlSubSection=function(d){var c=d.getRectInPage();var b=c.newRateRect(this.nPixelRate);var a=this.objDocument.getBackgroundStyle(d.backgroundStyleKey);if(null!=a&&a.backStyle==0){this.objContext.fillStyle=mCR_getStrColor(a.backColor);this.objContext.fillRect(b.left,b.top,b.getWidth(),b.getHeight());}};mCR_exportCanvas.prototype.exportControlsInSubSection=function(f){for(var b=0;b<f.controlPageList.length;b++){var a=f.controlPageList[b];var d=true;if(-1!=a.visibleOptionStyleKey){var c=this.objDocument.getVisibleOptionStyle(a.visibleOptionStyleKey);if(null!=c){d=c.toView;if(this.isEasyInput){d=c.toEasyMoad;}}}if(d){this.exportControl(a);}}};mCR_exportCanvas.prototype.paintShapeStyle=function(i,f){var b=f.newRateRect(this.nPixelRate);var h=b.left;var g=b.top;var d=b.getWidth();var a=b.getHeight();if(i.shapeType==0){this.objContext.beginPath();this.objContext.rect(h,g,d,a);}else{if(i.shapeType==1){this.objContext.ellipseRect(h,g,d,a);}else{var c=(Math.min(d,a)*i.roundRate/100)/2;this.objContext.roundRect(h,g,d,a,c);}}};mCR_exportCanvas.prototype.paintCurvedShapeStyle=function(i,g,a,f,j){var c=i.newRateRect(this.nPixelRate);var d=c.left;var h=c.top;var b=c.getWidth();var k=c.getHeight();this.objContext.beginPath();this.objContext.moveTo(d+b/2,h);if(g){this.objContext.bezierCurveTo(d+b/2,h,d,h,d,h+k/2);}else{this.objContext.lineTo(d,h);this.objContext.lineTo(d,h+k/2);}if(f){this.objContext.bezierCurveTo(d,h+k/2,d,h+k,d+b/2,h+k);}else{this.objContext.lineTo(d,h+k);this.objContext.lineTo(d+b/2,h+k);}if(j){this.objContext.bezierCurveTo(d+b/2,h+k,d+b,h+k,d+b,h+k/2);}else{this.objContext.lineTo(d+b,h+k);this.objContext.lineTo(d+b,h+k/2);}if(a){this.objContext.bezierCurveTo(d+b,h+k/2,d+b,h,d+b/2,h);}else{this.objContext.lineTo(d+b,h);this.objContext.lineTo(d+b/2,h);}this.objContext.closePath();};mCR_exportCanvas.prototype.paintLineStyle=function(a,c){if(typeof c=="undefined"){c=false;}if(a.style==0){this.objContext.strokeStyle="rgba(0,0,0,0)";this.objContext.lineWidth=1;if(this.objContext.setLineDash!==undefined){this.objContext.setLineDash([]);}return;}if(a.width>75||c){this.objContext.lineWidth=(a.width/100)*this.nPtToPxRate;}else{this.objContext.lineWidth=1;}this.objContext.strokeStyle=mCR_getStrColor(a.color);var b=a.width>100?a.width/100:1;if(this.objContext.setLineDash!==undefined){this.objContext.setLineDash([]);switch(a.style){case 2:this.objContext.setLineDash([(4*b),(2*b)]);break;case 3:this.objContext.setLineDash([(1.333*b),(1.333*b)]);break;case 4:this.objContext.setLineDash([(4*b),(2*b),(1.333*b),(2*b)]);break;case 5:this.objContext.setLineDash([(4*b),(2*b),(1.333*b),(2*b),(1.333*b),(2*b)]);break;case 7:case 9:this.objContext.lineWidth=((a.width*1.5)/100)*this.nPtToPxRate;break;case 11:this.objContext.setLineDash([(4*5/3*b),(4*b)]);break;}}};mCR_exportCanvas.prototype.paintBackgroundStyle=function(a,b){if(a.backStyle==1){this.objContext.fillStyle="rgba(255,255,255,0)";return;}if(a.gradientStyle==0){switch(a.fillStyle){case 0:this.objContext.fillStyle=mCR_getStrColor(a.backColor);break;case 1:this.patternHorizontalLine(a);break;case 2:this.patternVerticalLine(a);break;case 3:this.patternCrossLine(a);break;case 4:this.patternBackDiagonalLine(a);break;case 5:this.patternFrontDiagonalLine(a);break;case 6:this.patternCrossDiagonalLine(a);break;case 7:this.patternDotDensed(a);break;case 8:this.patternDot(a);break;case 9:this.patternDotRare(a);break;}}else{switch(a.gradientStyle){case 1:this.gradientTopBottom(b,a);break;case 2:this.gradientBottomTop(b,a);break;case 3:this.gradientLeftRight(b,a);break;case 4:this.gradientRightLeft(b,a);break;case 5:this.gradientRadial(b,a);break;case 6:this.gradientDiagonalF(b,a);break;case 7:this.gradientDiagonalB(b,a);break;}}};mCR_exportCanvas.prototype.paintBackgroundImageStyle=function(i,h,b,g,f,a){if(null==f||-1==f){return;}var d=this.pageImageList[f];if(null==d){return;}var c=h.imageDrawMethod;switch(c){case 1:this.imageOriginalSize(i,h,b,g,f,a);break;case 2:this.imageStretch(i,b,g,f,a);break;case 3:this.imageTile(i,h,b,g,f,a);break;case 4:this.imageZoom(i,h,b,g,f,a);break;case 5:this.imageShrink(i,h,b,g,f,a);break;}};mCR_exportCanvas.prototype.paintText=function(d,k){var t=k.getOriginalTextInfo().getFontStyleKey();var n=this.objDocument.getTextMarginStyle(k.getOriginalTextInfo().getTextMarginStyleKey());if(k.getUseMultiLanguage()||this.objDocument.getUseMultiLanguage()){d.setLeft(d.getLeft()+n.left);d.setRight(d.getRight()-n.right);d.setTop(d.getTop()+n.top);d.setBottom(d.getBottom()-n.bottom);var y=this.objDocument.getTextOptionStyle(k.getOriginalTextInfo().getTextOptionStyleKey());var a=y.getHorizontalAlignment();var s=y.getVerticalAlignment();var o=this.objDocument.getFontStyle(t);var m=d.getTop();var g=k.getHeight();if(mCR_VerticalAlignmentMethod.Bottom==s){m=d.getBottom()-g-(g*0.15);}else{if(mCR_VerticalAlignmentMethod.Center==s){m=(d.getBottom()+d.getTop()-g)/2;}}var b=k.getTextLineCount();for(var u=0;u<b;u++){var v=k.getTextLine(u);var x=d.getLeft();var w=m+v.getHeight();w+=v.getY();if(w<=d.getBottom()+(g*0.15)){var r=false;var h="";if(o!=null){if(o.bold){r=true;h+="bold ";}if(o.italic){h+="italic ";}h+=o.size+"pt ";var c=this.objDocument.getFontNameStyle(o.nameEngIndex);if(c=="나눔고딕"||c=="NanumGothic"){h+="'"+c+"'";}else{h+="'"+this.objDocument.getFontNameStyle(o.nameIndex)+"'";}}this.objContext.font=h;this.objContext.fillStyle=mCR_getStrColor(o.color);var q=0;if(mCR_HorizontalAlignmentMethod.Right==a){q=this.getTextCanvasWidth(o,v);x=d.getRight()-q*254/96;}else{if(mCR_HorizontalAlignmentMethod.Middle==a){q=this.getTextCanvasWidth(o,v);x=(d.getRight()+d.getLeft()-q*254/96)/2;}}var l=k.getOriginalTextInfo().getCharDirection();if(l==0){this.objContext.direction="inherit";this.objContext.fillText(v.getText(),x*0.378,w*0.378);}else{var f=1==l?true:false;if(f){if(mCR_isEdge||mCR_isIE||mCR_isFirefox){}else{x=d.getRight();if(mCR_HorizontalAlignmentMethod.Left==a){q=this.getTextCanvasWidth(o,v,true);x=d.getLeft()+q*254/96;}else{if(mCR_HorizontalAlignmentMethod.Middle==a){q=this.getTextCanvasWidth(o,v,true);x=d.getRight()-(d.getWidth()-q*254/96)/2;}}}this.objContext.direction="rtl";}else{this.objContext.direction="inherit";}this.objContext.fillText(v.getText(),x*0.378,w*0.378);if(r){}}}else{break;}}}else{var p=k.getOriginalTextInfo().getTextRotation();var j=d.getHeight();this.objContext.save();this.isRotation=true;if(p==90){this.objContext.translate(d.left*0.378,(d.top+d.getHeight())*0.378);this.objContext.rotate(270*Math.PI/180);j=d.getWidth();}else{if(p==180){this.objContext.translate((d.left+d.getWidth())*0.378,(d.top+d.getHeight())*0.378);this.objContext.rotate(180*Math.PI/180);}else{if(p==270){this.objContext.translate((d.left+d.getWidth())*0.378,d.getTop()*0.378);this.objContext.rotate(90*Math.PI/180);j=d.getWidth();}else{this.isRotation=false;}}}this.drawTextLine(d,n,j,p,k,t);this.objContext.restore();this.isRotation=false;}};mCR_exportCanvas.prototype.getTextCanvasWidth=function(i,h,f){if(this.elmCanvas==null){this.elmCanvas=document.createElement("canvas");}var c="";if(i.italic){c="italic ";}var d="";if(i.bold){d="bold ";}var b=this.elmCanvas.getContext("2d");if(f&&f!=null){b.direction="rtl";}else{b.direction="inherit";}var g=this.objDocument.getFontNameStyle(i.nameEngIndex);if(g=="나눔고딕"||g=="NanumGothic"){b.font=c+d+i.size+"pt '"+decodeURIComponent(g)+"'";}else{b.font=c+d+i.size+"pt '"+decodeURIComponent(this.objDocument.getFontNameStyle(i.nameIndex))+"'";}var a=h.getText();return b.measureText(a).width;};mCR_exportCanvas.prototype.drawTextShape=function(q,j,b){var g=b.getTextShapeCount();var h=q.newRateRect(this.nPixelRate);for(var m=0;m<g;m++){var f=b.getTextShape(m);var l=f.rect.newRateRect(this.nPixelRate);var r=this.objDocument.getLineStyle(f.lineStyleKey);var p=f.shapeType;var d=h.left+l.left;var s=h.right+l.right;var o=h.top+l.top;var a=h.bottom+l.bottom;var c=h.left+l.getWidth();if(this.isRotation){var d=l.left;var s=l.right;var o=l.top;var a=l.bottom;var c=l.getWidth();}if(p==0){this.paintLineStyle(r);if(null!=r&&r.style!=0){this.objContext.beginPath();this.objContext.moveTo(d,o);this.objContext.lineTo(c,o);if(r.style==mCR_LineStyle.DoubleLine){this.objContext.stroke();var j=r.width/72*2.54;var n=o-(j);this.objContext.beginPath();this.objContext.moveTo(d,n);this.objContext.lineTo(c,n);}}}else{this.paintLineStyle(r,true);if(null!=r&&r.style!=0){var k=null;if(p==2){this.objContext.ellipseRect(d,o,l.getWidth(),l.getHeight());}else{this.objContext.beginPath();this.objContext.rect(d,o,l.getWidth(),l.getHeight());}}}this.objContext.stroke();}};mCR_exportCanvas.prototype.drawCharacter=function(m,b,f,l,n,a){var j=b.getCharacterCount();for(var h=0;h<j;h++){var o=b.getCharacter(h);var c=false;var g="";if(l!=null){if(l.bold){c=true;g+="bold ";}if(l.italic){g+="italic ";}if(b.getIsSmallChar()){g+=n.size*0.65+"pt ";}else{if(b.getIsSup()||b.getIsSub()){g+=n.size*0.5+"pt ";}else{g+=l.size+"pt ";}}var k=this.objDocument.getFontNameStyle(l.nameEngIndex);if(k=="나눔고딕"||k=="NanumGothic"){g+="'"+decodeURIComponent(k)+"'";}else{g+="'"+decodeURIComponent(this.objDocument.getFontNameStyle(l.nameIndex))+"'";}this.objContext.fillStyle=mCR_getStrColor(l.color);}else{if(n!=null){if(n.bold){c=true;g+="bold ";}if(n.italic){g+="italic ";}if(b.getIsSmallChar()){g+=n.size*0.65+"pt ";}else{if(b.getIsSup()||b.getIsSub()){g+=n.size*0.5+"pt ";}else{g+=n.size+"pt ";}}var k=this.objDocument.getFontNameStyle(n.nameEngIndex);if(k=="나눔고딕"||k=="NanumGothic"){g+="'"+decodeURIComponent(k)+"'";}else{g+="'"+decodeURIComponent(this.objDocument.getFontNameStyle(n.nameIndex))+"'";}this.objContext.fillStyle=mCR_getStrColor(n.color);}}this.objContext.font=g;if(this.isRotation){this.objContext.fillText(o.getCharacter(),(o.getX())*0.378,(f-m.top)*0.378);if(c){}}else{var d=b.getCharMode();switch(d){case 0:this.objContext.fillText(o.getCharacter(),(o.getX()+m.left)*0.378,(f)*0.378);if(c){}break;case 1:this.objContext.scale(1,2);this.objContext.fillText(o.getCharacter(),(o.getX()+m.left)*0.378,(f)*0.378/2);if(c){}this.objContext.scale(1,0.5);break;case 2:this.objContext.scale(2,1);this.objContext.fillText(o.getCharacter(),(o.getX()+m.left)*0.378/2,(f)*0.378);if(c){}this.objContext.scale(0.5,1);break;case 3:this.objContext.scale(2,2);this.objContext.fillText(o.getCharacter(),(o.getX()+m.left)*0.378/2,(f)*0.378/2);if(c){}this.objContext.scale(0.5,0.5);break;}}}};mCR_exportCanvas.prototype.adjustDescent=function(d,c,i){var h=d.getTop()+c.getY();var f=i.getIsSmallChar();var g=i.getIsSup();var b=i.getIsSub();var a=c.getHeight();if(g||b){a=a*0.5;if(b){h=h+a;}}else{if(f){a=a*0.65;h+=a;h=h-a*0.8;}}h=h+a-a*0.15;return h;};mCR_exportCanvas.prototype.drawTextLine=function(h,d,j,l,c,g){var b=c.getTextLineCount();var k=this.objDocument.getFontStyle(g);for(var f=0;f<b;f++){var a=c.getTextLine(f);if(l==0||l==180){if((a.getY2()<=j+a.getHeight()*0.15)||(f==0&&(a.getY()<h.getHeight()))){this.drawCharacterBatch(h,a,g,c,k);}else{break;}}else{if(a.getY2()<=j+a.getHeight()*0.15){this.drawCharacterBatch(h,a,g,c,k);}else{break;}}this.drawTextShape(h,d,a);}};mCR_exportCanvas.prototype.drawCharacterBatch=function(j,a,g,b,k){var l=a.getCharacterBatchCount();for(var f=0;f<l;f++){var c=a.getCharacterBatch(f);var h=null;if(c.getFontStyleKey()!=-1){h=this.objDocument.getFontStyle(c.getFontStyleKey());}var d=this.adjustDescent(j,a,c);this.drawCharacter(j,c,d,h,k,a);}};mCR_exportCanvas.prototype.lineDeduplication=function(c,g,i,a,d){var b=new Array();b.push(c);b.push(g);b.push(i);b.push(a);b.push(d.style);b.push(d.width);b.push(d.color);var j=b.join(",");var f=this.objLineHashMap[j];if(null!=f){var h=new docStyleLine();h.setStyle(d.style,d.width,16777215);this.paintLineStyle(h);this.objContext.beginPath();this.objContext.moveTo(c,g);this.objContext.lineTo(i,a);this.objContext.stroke();this.objContext.beginPath();this.objContext.moveTo(c,g);this.objContext.lineTo(i,a);this.objContext.stroke();}this.objLineHashMap[j]="temp";};mCR_exportCanvas.prototype.setWebLinkInfo=function(c,f){var d={rect:c,info:f};if(null!=f.ctrl){var a=c.toString();var b=this.objAccHashMap[a];if(null!=b){if(f.type==20){b.type=20;b.msg=b.msg+f.msg;return;}}else{this.objAccHashMap[a]=f;}}this.webLinkList.push(d);};mCR_exportCanvas.prototype.setEditWebLinkInfo=function(j,g,c,f){var a=new docWebLinkInfo();a.type=1;a.editableIndex=f;a.editText=c.getOriginalTextInfo().text;a.objControl=j;var d=c.getOriginalTextInfo().getFontStyleKey();var i=this.objDocument.getFontStyle(d);var h=this.objDocument.getFontNameStyle(i.nameEngIndex);if(h=="나눔고딕"||h=="NanumGothic"){a.fontStyle="font-size:"+i.size+"pt;font-family:'"+h+"';";}else{a.fontStyle="font-size:"+i.size+"pt;font-family:'"+this.objDocument.getFontNameStyle(i.nameIndex)+"';";}var b={rect:g,info:a};this.webLinkList.push(b);};mCR_exportCanvas.prototype.setCheckEditWebLinkInfo=function(a,b,d,g){var f=new docWebLinkInfo();f.type=4;f.editableIndex=d;f.objControl=a;f.isChecked=g;var c={rect:b,info:f};this.webLinkList.push(c);};mCR_exportCanvas.prototype.setInputControlInfo=function(b,a){var c={rect:b,info:{type:10,ctrlName:a}};this.webLinkList.push(c);};mCR_exportCanvas.prototype.imageShrink=function(c,d,b,j,f,k){var a=(j.getWidth()*0.378);var g=(j.getHeight()*0.378);g=g/(k.endPosition-k.startPosition)*100;b.dpiX=b.dpiX>1?b.dpiX:96;b.dpiY=b.dpiY>1?b.dpiY:96;var i=(b.imageWidth/b.dpiX)*96;var h=(b.imageHeight/b.dpiY)*96;i=i*(d.rate/100);h=h*(d.rate/100);if(a>=i&&g>=h){this.imageOriginalSize(c,d,b,j,f,k);}else{this.imageZoom(c,d,b,j,f,k);}};mCR_exportCanvas.prototype.imageZoom=function(b,C,F,z,K,E){var f=z.left*this.nPixelRate;var i=z.top*this.nPixelRate;var G=z.right*this.nPixelRate;var a=z.bottom*this.nPixelRate;var p=G-f;var j=a-i;var N=j;j=j/(E.endPosition-E.startPosition)*100;var m=0;var x=0;F.dpiX=F.dpiX>1?F.dpiX:96;F.dpiY=F.dpiY>1?F.dpiY:96;var r=(F.imageWidth/F.dpiX)*96;var d=(F.imageHeight/F.dpiY)*96;var y=r/d;var c=p/j;var q=F.imageHeight*E.startPosition/100;var M=F.imageHeight*E.endPosition/100;var B=M-q;if(y>c){var A=d/r;d=p*A;var H=d/F.imageHeight;r=p;var l=j*E.startPosition/100;var I=j*(100-E.endPosition)/100;var s=0;var L=0;if(C.verticalAlignment==0){if(j>d){L=(j-d);}}else{if(C.verticalAlignment==1){if(j>d){s=(j-d)/2;L=(j-d)/2;}}else{if(C.verticalAlignment==2){if(j>d){s=(j-d);}}}}if(l>=s){q=F.imageHeight*(l-s)/d;x=0;}else{x=s-l;}if(I>L){M=F.imageHeight*(j-I-s)/d;B=M-q;d=j-I-s;}else{if(l==0&&I!=0){M=F.imageHeight;}else{if(I==0&&l<s){q=0;}}B=M-q;d=B*H;}}else{var A=r/d;r=j*A;d=N;if(C.horizontalAlignment==1){if(p>r){m=(p-r)/2;}}else{if(C.horizontalAlignment==2){if(p>r){m=p-r;}}}}if(E.margine!=null){m+=(parseInt(E.margine)*this.nPixelRate);}m+=f;x+=i;this.paintShapeStyle(b,z);var u=this.pageImageList[K].width;var v=this.pageImageList[K].height;var k=1;var o=1;var n=1;o=r/u;n=d/v;if(o<n){k=n;}else{k=o;}if(k<1){k=k*2;var g=document.createElement("canvas");var t=g.getContext("2d");var D=u*k;var J=v*k;g.width=D;g.height=J;t.drawImage(this.pageImageList[K],0,q,F.imageWidth,B,0,0,D,J);this.objContext.drawImage(g,m,x,r,d);}else{this.objContext.drawImage(this.pageImageList[K],0,q,F.imageWidth,B,m,x,r,d);}};mCR_exportCanvas.prototype.imageTile=function(m,f,d,a,o,p){var g=document.createElement("canvas");var q=g.getContext("2d");var c=a.left*this.nPixelRate;var n=a.top*this.nPixelRate;var s=a.right*this.nPixelRate;var i=a.bottom*this.nPixelRate;g.width=s;g.height=i;var b=0;var h=0;d.dpiX=d.dpiX>1?d.dpiX:96;d.dpiY=d.dpiY>1?d.dpiY:96;var k=(d.imageWidth/d.dpiX)*96;var r=(d.imageHeight/d.dpiY)*96;k=k*(f.rate/100);r=r*(f.rate/100);b+=c;h+=n;for(var l=b;l<s;l+=k){for(var j=h;j<i;j+=r){q.drawImage(this.pageImageList[o],l,j,k,r);}}this.paintShapeStyle(m,a);this.objContext.fillStyle=this.objContext.createPattern(g,"repeat");this.objContext.fill();};mCR_exportCanvas.prototype.imageOriginalSize=function(p,h,g,b,s,t){var i=document.createElement("canvas");var u=i.getContext("2d");var f=b.left*this.nPixelRate;var q=b.top*this.nPixelRate;var y=b.right*this.nPixelRate;var l=b.bottom*this.nPixelRate;i.width=y;i.height=l;var c=0;var j=0;g.dpiX=g.dpiX>1?g.dpiX:96;g.dpiY=g.dpiY>1?g.dpiY:96;var m=(g.imageWidth/g.dpiX)*96;var x=(g.imageHeight/g.dpiY)*96;m=m*(h.rate/100);x=x*(h.rate/100);if(h.horizontalAlignment==1){var a=(b.getWidth()*0.378);if(a>m){c=(a-m)/2;}}else{if(h.horizontalAlignment==2){var a=(b.getWidth()*0.378);if(a>m){c=a-m;}}}c+=f;if(t.startPosition==0&&t.endPosition==100){if(h.verticalAlignment==1){var v=(b.getHeight()*0.378);if(v>x){j=(v-x)/2;}}else{if(h.verticalAlignment==2){var v=(b.getHeight()*0.378);if(v>x){j=(v-x);}}}j+=q;u.drawImage(this.pageImageList[s],c,j,m,x);}else{var d=0;var v=(b.getHeight()*0.378);var o=v/(t.endPosition-t.startPosition)*100;if(o<=x){var r=g.imageHeight*o/x;d=r*t.startPosition/100;realImageHeight=r*t.endPosition/100;x=realImageHeight;j+=q;}else{var w=o*t.startPosition/100;var z=o*t.endPosition/100;var k=0;var n=0;if(h.verticalAlignment==0){n=o-x;}else{if(h.verticalAlignment==1){k=(o-x)/2;n=(o-x)/2;}else{if(h.verticalAlignment==2){k=(o-x);}}}if(w>(o-n)||z<k){return;}if(w<k){q+=(k-w);}else{d=((w-k)/x*g.imageHeight);}if(z>(o-n)){l+=((o-n)-w);realImageHeight=l;x=realImageHeight*x/g.imageHeight;}else{realImageHeight=(z-k)*g.dpiX/96;x=(z-k);}j+=q;}u.drawImage(this.pageImageList[s],0,d,g.imageWidth,realImageHeight,c,j,m,x);}this.paintShapeStyle(p,b);this.objContext.fillStyle=this.objContext.createPattern(i,"no-repeat");this.objContext.fill();};mCR_exportCanvas.prototype.imageStretch=function(m,f,b,p,s){var d=b.left*this.nPixelRate;var n=b.top*this.nPixelRate;var r=b.getWidth()*this.nPixelRate;var o=b.getHeight()*this.nPixelRate;this.paintShapeStyle(m,b);var u=this.pageImageList[p].width;var g=this.pageImageList[p].height;var c=1;var l=1;var j=1;l=r/u;j=o/g;var a=f.imageHeight*s.startPosition/100;var i=f.imageHeight*s.endPosition/100;var x=i-a;if(l<j){c=j;}else{c=l;}if(c<1){c=c*2;var q=document.createElement("canvas");var t=q.getContext("2d");var k=parseInt(u*c);var v=parseInt(g*c);q.width=k;q.height=v;t.drawImage(this.pageImageList[p],0,a,f.imageWidth,x,0,0,k,v);this.objContext.drawImage(q,0,0,k,v,d,n,r,o);}else{this.objContext.drawImage(this.pageImageList[p],0,a,f.imageWidth,x,d,n,r,o);}};mCR_exportCanvas.prototype.brushCheck=function(i,b,c){var f=i.left*0.378;var j=i.right*0.378;var h=i.top*0.378;var a=i.bottom*0.378;switch(b){case 0:var d=(j-f)/6;var k=(a-h)/6;this.objContext.beginPath();this.objContext.moveTo((f+(d*0)),(h+(d*2)));this.objContext.lineTo((f+(d*2)),(h+(d*4)));this.objContext.lineTo((f+(d*6)),(h+(d*0)));this.objContext.lineTo((f+(d*6)),(h+(d*2)));this.objContext.lineTo((f+(d*2)),(h+(d*6)));this.objContext.lineTo((f+(d*0)),(h+(d*4)));this.objContext.closePath();break;case 1:this.objContext.beginPath();this.objContext.rect(f,h,j-f,a-h);break;case 2:this.objContext.ellipseRect(f,h,j-f,a-h);break;case 3:var g=((j-f)*0.3)/2;this.objContext.roundRect(f,h,j-f,a-h,g);break;}this.objContext.fillStyle=mCR_getStrColor(c);this.objContext.fill();};mCR_exportCanvas.prototype.gradientRadial=function(i,f){var c=i.left*this.nPixelRate;var h=i.top*this.nPixelRate;var k=i.right*this.nPixelRate;var a=i.bottom*this.nPixelRate;var g=c+((k-c)/2);var d=h+((a-h)/2);var b=Math.max(k-c,a-h)/2;var j=this.objContext.createRadialGradient(g,d,5,g,d,b);j.addColorStop(0,mCR_getStrColor(f.gradientStartColor));j.addColorStop(1,mCR_getStrColor(f.gradientEndColor));this.objContext.fillStyle=j;};mCR_exportCanvas.prototype.gradientDiagonalB=function(d,a){var h=d.left*this.nPixelRate;var g=d.top*this.nPixelRate;var c=d.right*this.nPixelRate;var b=d.bottom*this.nPixelRate;var f=this.objContext.createLinearGradient(c,g,h,b);f.addColorStop(0,mCR_getStrColor(a.gradientStartColor));f.addColorStop(1,mCR_getStrColor(a.gradientEndColor));this.objContext.fillStyle=f;};mCR_exportCanvas.prototype.gradientDiagonalF=function(d,a){var h=d.left*this.nPixelRate;var g=d.top*this.nPixelRate;var c=d.right*this.nPixelRate;var b=d.bottom*this.nPixelRate;var f=this.objContext.createLinearGradient(h,g,c,b);f.addColorStop(0,mCR_getStrColor(a.gradientStartColor));f.addColorStop(1,mCR_getStrColor(a.gradientEndColor));this.objContext.fillStyle=f;};mCR_exportCanvas.prototype.gradientRightLeft=function(d,a){var h=d.left*this.nPixelRate;var g=d.top*this.nPixelRate;var c=d.right*this.nPixelRate;var b=d.bottom*this.nPixelRate;var f=this.objContext.createLinearGradient(h,g,c,g);f.addColorStop(0,mCR_getStrColor(a.gradientEndColor));f.addColorStop(1,mCR_getStrColor(a.gradientStartColor));this.objContext.fillStyle=f;};mCR_exportCanvas.prototype.gradientLeftRight=function(d,a){var h=d.left*this.nPixelRate;var g=d.top*this.nPixelRate;var c=d.right*this.nPixelRate;var b=d.bottom*this.nPixelRate;var f=this.objContext.createLinearGradient(h,g,c,g);f.addColorStop(0,mCR_getStrColor(a.gradientStartColor));f.addColorStop(1,mCR_getStrColor(a.gradientEndColor));this.objContext.fillStyle=f;};mCR_exportCanvas.prototype.gradientBottomTop=function(d,a){var h=d.left*this.nPixelRate;var g=d.top*this.nPixelRate;var c=d.right*this.nPixelRate;var b=d.bottom*this.nPixelRate;var f=this.objContext.createLinearGradient(h,g,h,b);f.addColorStop(0,mCR_getStrColor(a.gradientEndColor));f.addColorStop(1,mCR_getStrColor(a.gradientStartColor));this.objContext.fillStyle=f;};mCR_exportCanvas.prototype.gradientTopBottom=function(d,a){var h=d.left*this.nPixelRate;var g=d.top*this.nPixelRate;var c=d.right*this.nPixelRate;var b=d.bottom*this.nPixelRate;var f=this.objContext.createLinearGradient(h,g,h,b);f.addColorStop(0,mCR_getStrColor(a.gradientStartColor));f.addColorStop(1,mCR_getStrColor(a.gradientEndColor));this.objContext.fillStyle=f;};mCR_exportCanvas.prototype.patternDotRare=function(b){var d=document.createElement("canvas");var c=d.getContext("2d");var a=7.56;d.width=a;d.height=a;c.fillStyle=mCR_getStrColor(b.backColor);c.fillRect(0,0,a,a);c.fillStyle=mCR_getStrColor(b.fillColor);c.fillRect(0,0,1,1);c.fillRect(a/2,a/2,1,1);this.objContext.fillStyle=this.objContext.createPattern(d,"repeat");};mCR_exportCanvas.prototype.patternDot=function(b){var d=document.createElement("canvas");var c=d.getContext("2d");var a=5.292;d.width=a;d.height=a;c.fillStyle=mCR_getStrColor(b.backColor);c.fillRect(0,0,a,a);c.fillStyle=mCR_getStrColor(b.fillColor);c.fillRect(0,0,1,1);c.fillRect(a/2,a/2,1,1);this.objContext.fillStyle=this.objContext.createPattern(d,"repeat");};mCR_exportCanvas.prototype.patternDotDensed=function(b){var d=document.createElement("canvas");var c=d.getContext("2d");var a=3.024;d.width=a;d.height=a;c.fillStyle=mCR_getStrColor(b.backColor);c.fillRect(0,0,a,a);c.fillStyle=mCR_getStrColor(b.fillColor);c.fillRect(0,0,1,1);c.fillRect(a/2,a/2,1,1);this.objContext.fillStyle=this.objContext.createPattern(d,"repeat");};mCR_exportCanvas.prototype.patternCrossDiagonalLine=function(b){var d=document.createElement("canvas");var c=d.getContext("2d");var a=6.804;d.width=a;d.height=a;c.fillStyle=mCR_getStrColor(b.backColor);c.fillRect(0,0,a,a);c.strokeStyle=mCR_getStrColor(b.fillColor);c.lineWidth=1;c.beginPath();c.moveTo(a,0);c.lineTo(0,a);c.stroke();c.beginPath();c.moveTo(0,0);c.lineTo(a,a);c.stroke();this.objContext.fillStyle=this.objContext.createPattern(d,"repeat");};mCR_exportCanvas.prototype.patternFrontDiagonalLine=function(b){var d=document.createElement("canvas");var c=d.getContext("2d");var a=6.804;d.width=a;d.height=a;c.fillStyle=mCR_getStrColor(b.backColor);c.fillRect(0,0,a,a);c.strokeStyle=mCR_getStrColor(b.fillColor);c.lineWidth=1;c.beginPath();c.moveTo(a,0);c.lineTo(0,a);c.stroke();c.beginPath();c.moveTo(0,0);c.lineTo(1,1);c.stroke();c.beginPath();c.moveTo(a,a);c.lineTo(a-1,a-1);c.stroke();this.objContext.fillStyle=this.objContext.createPattern(d,"repeat");};mCR_exportCanvas.prototype.patternBackDiagonalLine=function(b){var d=document.createElement("canvas");var c=d.getContext("2d");var a=6.804;d.width=a;d.height=a;c.fillStyle=mCR_getStrColor(b.backColor);c.fillRect(0,0,a,a);c.strokeStyle=mCR_getStrColor(b.fillColor);c.lineWidth=1;c.beginPath();c.moveTo(0,0);c.lineTo(a,a);c.stroke();c.beginPath();c.moveTo(0,a);c.lineTo(1,a-1);c.stroke();c.beginPath();c.moveTo(a,0);c.lineTo(a-1,1);c.stroke();this.objContext.fillStyle=this.objContext.createPattern(d,"repeat");};mCR_exportCanvas.prototype.patternCrossLine=function(b){var d=document.createElement("canvas");var c=d.getContext("2d");var a=6.804;d.width=a;d.height=a;c.fillStyle=mCR_getStrColor(b.backColor);c.fillRect(0,0,a,a);c.strokeStyle=mCR_getStrColor(b.fillColor);c.lineWidth=1;c.beginPath();c.moveTo(a/2,0);c.lineTo(a/2,a);c.stroke();c.beginPath();c.moveTo(0,a/2);c.lineTo(a,a/2);c.stroke();this.objContext.fillStyle=this.objContext.createPattern(d,"repeat");};mCR_exportCanvas.prototype.patternVerticalLine=function(b){var d=document.createElement("canvas");var c=d.getContext("2d");var a=6.804;d.width=a;d.height=a;c.fillStyle=mCR_getStrColor(b.backColor);c.fillRect(0,0,a,a);c.strokeStyle=mCR_getStrColor(b.fillColor);c.lineWidth=1;c.beginPath();c.moveTo(a/2,0);c.lineTo(a/2,a);c.stroke();this.objContext.fillStyle=this.objContext.createPattern(d,"repeat");};mCR_exportCanvas.prototype.patternHorizontalLine=function(b){var d=document.createElement("canvas");var c=d.getContext("2d");var a=6.804;d.width=a;d.height=a;c.fillStyle=mCR_getStrColor(b.backColor);c.fillRect(0,0,a,a);c.strokeStyle=mCR_getStrColor(b.fillColor);c.lineWidth=1;c.beginPath();c.moveTo(0,a/2);c.lineTo(a,a/2);c.stroke();this.objContext.fillStyle=this.objContext.createPattern(d,"repeat");};if(typeof window.CanvasRenderingContext2D!="undefined"){CanvasRenderingContext2D.prototype.roundRect=function(a,f,b,c,d){if(b<2*d){d=b/2;}if(c<2*d){d=c/2;}this.beginPath();this.moveTo(a+d,f);this.arcTo(a+b,f,a+b,f+c,d);this.arcTo(a+b,f+c,a,f+c,d);this.arcTo(a,f+c,a,f,d);this.arcTo(a,f,a+b,f,d);this.closePath();return this;};CanvasRenderingContext2D.prototype.ellipseRect=function(k,j,l,d){var i=0.5522848,c=(l/2)*i,a=(d/2)*i,m=k+l,g=j+d,f=k+l/2,b=j+d/2;this.beginPath();this.moveTo(k,b);this.bezierCurveTo(k,b-a,f-c,j,f,j);this.bezierCurveTo(f+c,j,m,b-a,m,b);this.bezierCurveTo(m,b+a,f+c,g,f,g);this.bezierCurveTo(f-c,g,k,b+a,k,b);return this;};}if(window.OffscreenCanvasRenderingContext2D){OffscreenCanvasRenderingContext2D.prototype.roundRect=function(a,f,b,c,d){if(b<2*d){d=b/2;}if(c<2*d){d=c/2;}this.beginPath();this.moveTo(a+d,f);this.arcTo(a+b,f,a+b,f+c,d);this.arcTo(a+b,f+c,a,f+c,d);this.arcTo(a,f+c,a,f,d);this.arcTo(a,f,a+b,f,d);this.closePath();return this;};OffscreenCanvasRenderingContext2D.prototype.ellipseRect=function(k,j,l,d){var i=0.5522848,c=(l/2)*i,a=(d/2)*i,m=k+l,g=j+d,f=k+l/2,b=j+d/2;this.beginPath();this.moveTo(k,b);this.bezierCurveTo(k,b-a,f-c,j,f,j);this.bezierCurveTo(f+c,j,m,b-a,m,b);this.bezierCurveTo(m,b+a,f+c,g,f,g);this.bezierCurveTo(f-c,g,k,b+a,k,b);return this;};}function mCR_getFontCss(d,f,c){for(var b=0;b<f.length;b++){var a=f[b];d.push(".s_"+c.reportKey+b+"{");d.push("font-size:");d.push(a.size);d.push("pt;");d.push("font-family:'");d.push(c.getFontNameStyle(a.nameEngIndex));d.push("','");d.push(c.getFontNameStyle(a.nameIndex));d.push("';");d.push("color:");d.push(mCR_getStrColor(a.color));d.push(";");d.push("fill:");d.push(mCR_getStrColor(a.color));d.push(";");if(a.bold){d.push("font-weight:bold;");}else{d.push("stroke-width:0;");}if(a.italic){d.push("font-style:italic;");}d.push("}");if(window.is_apple||window.mCR_isApple){if(a.bold){d.push(".b_"+c.reportKey+b+"{");d.push("font-weight:normal;");d.push("stroke:");d.push(mCR_getStrColor(a.color));d.push(";");d.push("stroke-width:0.8;");d.push("paint-order:stroke;");d.push("}");}}}}function mCR_changeRGBAColor(f,b){var d=f&255;var c=(f>>8)&255;var a=(f>>16)&255;return"rgba("+d+","+c+","+a+","+(b/100)+")";}function mCR_getLineStyleTag(a){var c="";var b=a.width>75?a.width:75;c+=(b/100)+"pt ";switch(a.style){case 0:c+="none ";break;case 2:case 4:case 5:c+="dashed ";break;case 3:c+="dotted ";break;case 8:c+="double ";break;default:c+="solid ";break;}c+=mCR_getStrColor(a.color)+";";return c;}function mCR_setAlignmentMethod(a,b){switch(b.horizontalAlignment){case 0:a.align="left";break;case 1:a.align="center";break;case 2:a.align="right";break;}switch(b.verticalAlignment){case 0:a.vAlign="top";break;case 1:a.vAlign="middle";break;case 2:a.vAlign="bottom";break;}}function mCR_setInputAlignmentMethod(a,b){switch(b.horizontalAlignment){case 0:a.style.textAlign="left";break;case 1:a.style.textAlign="center";break;case 2:a.style.textAlign="right";break;}}function mRe_spaceStyle(c,b,a){if(null!=b&&null!=a){c.style.lineHeight=(a.size+b.lineSpace)+"pt";c.style.letterSpacing=b.wordSpace+"pt";}}mCR_exportCanvas.prototype.barcodePainterDraw=function(c,b){var a=null;switch(c.barcodeSymbology){case 1:a=new mCR_SymbologyCode39(true,this.objContext,c,b);break;case 2:a=new mCR_SymbologyCode39A(true,this.objContext,c,b);break;case 3:a=new mCR_SymbologyCode93(true,this.objContext,c,b);break;case 4:a=new mCR_SymbologyCode93A(true,this.objContext,c,b);break;case 5:a=new mCR_SymbologyCodaBar(true,this.objContext,c,b);break;case 6:a=new mCR_SymbologyCode11(true,this.objContext,c,b);break;case 10:a=new mCR_SymbologyCode128(true,this.objContext,c,b);break;case 11:a=new mCR_SymbologyCode128A(true,this.objContext,c,b);break;case 12:a=new mCR_SymbologyCode128B(true,this.objContext,c,b);break;case 13:a=new mCR_SymbologyCode128C(true,this.objContext,c,b);break;case 15:a=new mCR_Symbology2of5IATA(true,this.objContext,c,b);break;case 16:a=new mCR_Symbology2of5Matrix(true,this.objContext,c,b);break;case 17:a=new mCR_Symbology2of5Industrial(true,this.objContext,c,b);break;case 18:a=new mCR_Symbology2of5Interleaved(true,this.objContext,c,b);break;case 20:a=new mCR_SymbologyEAN8(true,this.objContext,c,b);break;case 21:a=new mCR_SymbologyEAN13(true,this.objContext,c,b);break;case 40:a=new mCR_SymbologyKoreanPostalCode(true,this.objContext,c,b);break;case 50:a=new mCR_SymbologyQRCode(true,this.objContext,c,b);break;case 51:a=new mCR_SymbologyDataMatrix(true,this.objContext,c,b);break;case 52:a=new mCR_SymbologyPDF417(true,this.objContext,c,b);break;case 101:a=new mCR_SymbologyGS1_128(true,this.objContext,c,b);break;case 102:a=new mCR_SymbologyITF14(true,this.objContext,c,b);break;}if(null!=a){a.drawBarcode();}};function mCR_exportCanvasForZoom(b,c,a){mCR_exportCanvas.call(this,b,c,a);}mCR_exportCanvasForZoom.prototype=Object.create(mCR_exportCanvas.prototype);mCR_exportCanvasForZoom.prototype.constructor=mCR_exportCanvasForZoom;mCR_exportCanvasForZoom.prototype.findControlsInSubSectionImage=function(f){if(this.isEasyInput&&f.isDrilling){return;}for(var b=0;b<f.controlPageList.length;b++){var a=f.controlPageList[b];var d=true;if(-1!=a.visibleOptionStyleKey){var c=this.objDocument.getVisibleOptionStyle(a.visibleOptionStyleKey);if(null!=c){d=c.toView;if(this.isEasyInput){d=c.toEasyMoad;}}}if(d){this.findImageControl(a);}}};mCR_exportCanvasForZoom.prototype.exportSubSectionsInPage=function(){if(this.objDocumentPage.backGround&&!this.isEasyInput){this.objDocumentPage.backGround.area.right=this.objPageStyle.width-this.objPageStyle.leftMargin-this.objPageStyle.rightMargin;this.exportSubSection(this.objDocumentPage.backGround);this.exportControlsInSubSection(this.objDocumentPage.backGround);}for(var a=0;a<this.objDocumentPage.subSectionList.length;a++){var c=this.objDocumentPage.subSectionList[a];if(c.isDrillingView){if(this.isEasyInput&&c.isDrilling){continue;}this.exportSubSection(c);}}var b=new Array();for(var a=0;a<this.objDocumentPage.subSectionList.length;a++){var c=this.objDocumentPage.subSectionList[a];if(c.isDrillingView){if(c.sectionType!=7){if(this.isEasyInput&&c.isDrilling){continue;}else{this.exportControlsInSubSection(c);}}else{b.push(c);}}}b.sort(function(f,d){if(f.area.top>d.area.top){return 1;}if(f.area.top<d.area.top){return -1;}return 0;});for(var a=0;a<b.length;a++){this.exportControlsInSubSection(b[a]);}b=null;if(this.objDocumentPage.foreGround&&!this.isEasyInput){this.exportSubSection(this.objDocumentPage.foreGround);this.exportControlsInSubSection(this.objDocumentPage.foreGround);}};mCR_exportCanvasForZoom.prototype.findImageControl=function(a){var c=true;if(a.pageCountConditionType==21){var b=this.objDocument.checkedTotalPageCount;var f=this.pageIndex+1==b/2+1;if(a.visible){if(f==true){c=false;}}else{c=f||a.conditionVisible;}}else{if(a.pageCountConditionType==22){var d=(this.pageIndex+1)%2;if(d==0){c=false;}}else{if(a.pageCountConditionType==23){var d=(this.pageIndex+1)%2;if(d==1){c=false;}}}}if(c){switch(a.type){case mCR_DocumentControlType.Label:this.findImageLabel(a);break;case mCR_DocumentControlType.Table:this.findImageTable(a);break;case mCR_DocumentControlType.VoiceBarcode:this.findImageVoiceBarcode(a);break;case mCR_DocumentControlType.SubReport:this.findImageReportControl(a);break;case mCR_DocumentControlType.VoiceEye:this.findImageVoiceEye(a);break;case mCR_DocumentControlType.MarkAnyVoiceEye:this.findImageMarkAnyVoice(a);break;}}};mCR_exportCanvasForZoom.prototype.exportControl=function(a){var c=true;if(a.pageCountConditionType==21){var b=this.objDocument.checkedTotalPageCount;var f=this.pageIndex+1==b/2+1;if(a.visible){if(f==true){c=false;}}else{c=f||a.conditionVisible;}}else{if(a.pageCountConditionType==22){var d=(this.pageIndex+1)%2;if(d==0){c=false;}}else{if(a.pageCountConditionType==23){var d=(this.pageIndex+1)%2;if(d==1){c=false;}}}}if(c){switch(a.type){case mCR_DocumentControlType.Line:this.exportLine(a);break;case mCR_DocumentControlType.Shape:this.exportShape(a);break;case mCR_DocumentControlType.Label:this.exportLabel(a);break;case mCR_DocumentControlType.Crosstab:this.exportCrosstab(a);break;case mCR_DocumentControlType.Table:this.exportTable(a);break;case mCR_DocumentControlType.Barcode:this.exportBarcode(a);break;case mCR_DocumentControlType.Chart:this.exportChart(a);break;case mCR_DocumentControlType.SubReport:this.exportReportControl(a);break;case mCR_DocumentControlType.Checkbox:this.exportCheckbox(a,false);break;case mCR_DocumentControlType.VoiceEye:this.exportVoiceEye(a);break;case mCR_DocumentControlType.VoiceBarcode:this.exportVoiceBarcode(a);break;case mCR_DocumentControlType.MarkAnyVoiceEye:this.exportMarkAnyVoice(a);break;case mCR_DocumentControlType.InputSign:this.exportInputSign(a);break;case mCR_DocumentControlType.VerifyBarcode:this.exportVerifyBarcode(a);break;}}};mCR_exportCanvasForZoom.prototype.exportInputSign=function(b){var c=b.getRectInPage();var f=this.objDocument.documentStorage[b.primaryName];if(null!=f){var a=this.objDocument.getLineStyle(b.outterlineStyleKey);var d=this.objDocument.getShapeStyle(b.shapeStyleKey);if(null!=a&&null!=d){this.paintShapeStyle(d,c);this.paintLineStyle(a);this.objContext.stroke();}}};function mCR_exportCanvasForEForm(b,c,a,d){mCR_exportCanvasForZoom.call(this,b,c,a);this.elmEFormLayoutDiv=d;this.elmLayoutTag=null;this.elmLayoutButton=null;this.pageEFormControlIDList=new Array();}mCR_exportCanvasForEForm.prototype=Object.create(mCR_exportCanvasForZoom.prototype);mCR_exportCanvasForEForm.prototype.constructor=mCR_exportCanvasForEForm;mCR_exportCanvasForEForm.prototype.exportPageEFom=function(b,a,c){this.pageEFormControlIDList=a;return this.exportPage(b,c);};mCR_exportCanvasForEForm.prototype.startPage=function(){this.objPageStyle=this.objDocument.getPageStyle(this.objDocumentPage.pageStyleKey);if(this.isEasyInput){var m=new docStylePage();m.paperType=this.objPageStyle.orientation;m.width=0;m.height=0;m.orientation=this.objPageStyle.orientation;m.leftMargin=0;m.topMargin=0;m.rightMargin=0;m.bottomMargin=0;m.pageCount=1;m.multiColumnDirection=this.objPageStyle.multiColumnDirection;for(var j=0;j<this.objDocumentPage.subSectionList.length;j++){var p=this.objDocumentPage.subSectionList[j];if(!p.isDrilling){var k=p.area.getHeight();p.area.top=m.height;m.height+=k;p.area.bottom=m.height;var d=p.area.getWidth();p.area.left=0;p.area.right=d;if(m.width<d){m.width=d;}}else{if(m.width==0){var d=p.area.getWidth();m.width=d;}}}this.objPageStyle=m;}var o=this.objPageStyle.width*this.nPixelRate;var c=this.objPageStyle.height*this.nPixelRate;this.objDocumentPage.width=this.objPageStyle.width;this.objDocumentPage.height=this.objPageStyle.height;this.elmCanvas=document.createElement("canvas");if(this.isOffScreenCanvas){this.elmTempCanvas=new OffscreenCanvas((o)*(mCR_isSmartphone?2:this.nZoom),(c)*(mCR_isSmartphone?2:this.nZoom));}this.elmCanvas.setAttribute("width",o*this.nZoom);this.elmCanvas.setAttribute("height",c*this.nZoom);if(this.isOffScreenCanvas){this.objContext=this.elmTempCanvas.getContext("2d");this.objContext.scale((mCR_isSmartphone?2:this.nZoom),(mCR_isSmartphone?2:this.nZoom));}else{this.objContext=this.elmCanvas.getContext("2d");this.objContext.scale(this.nZoom,this.nZoom);}this.objContext.fillStyle="rgb(255,255,255)";this.objContext.fillRect(0,0,o,c);this.pageImageList=new Array();this.objLineHashMap=function(){};this.objAccHashMap=function(){};this.elmEFormLayoutDiv.style.cssText="position:relative;background-color:transparent;display:inline-block;width:"+o+"px;height:"+c+"px;";this.elmLayoutTagP=document.createElement("div");this.elmLayoutTagP.style.position="absolute";this.elmLayoutTagP.style.left=(this.objPageStyle.leftMargin*this.nPixelRate)+"px";this.elmLayoutTagP.style.right=(this.objPageStyle.rightMargin*this.nPixelRate)+"px";this.elmLayoutTagP.style.top=(this.objPageStyle.topMargin*this.nPixelRate)+"px";this.elmLayoutTagP.style.bottom=(this.objPageStyle.bottomMargin*this.nPixelRate)+"px";this.elmLayoutTagP.setAttribute("role","text");var a="문서 전체영역 입니다.";if(""!=this.objDocument.title){a=this.objDocument.title;a=a.replace(/\'/g,"작은따옴표");a=a.replace(/\"/g,"큰따옴표");}this.elmLayoutTagP.setAttribute("aria-label",a);var f=new Array();f.push("<style type='text/css'>");f.push(".r_F_S{position:absolute;border:0px solid black !important;padding:0 0 0 0 !important;margin:0 0 0 0 !important;}");mCR_getFontCss(f,this.objDocument.styleManager.fontList,this.objDocument);f.push("</style>");this.elmLayoutTagP.innerHTML=f.join("");this.elmEFormLayoutDiv.appendChild(this.elmLayoutTagP);var n=document.createElement("div");n.id=this.objDocument.reportKey+"memo";n.style.cssText="position:absolute;overflow:hidden;left:0px;top:0px;right:0px;bottom:0px;background-color:rgba(255,255,255,0);";this.elmEFormLayoutDiv.appendChild(n);var h=document.createElement("div");h.id=this.objDocument.reportKey+"doodle";h.style.cssText="position:absolute;overflow:hidden;left:0px;top:0px;right:0px;bottom:0px;background-color:rgba(255,255,255,0);";h.innerHTML='<svg height="100%" version="1.1" width="100%" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" style="overflow: hidden; position: relative; shape-rendering: optimizeSpeed;"></svg>';this.elmEFormLayoutDiv.appendChild(h);this.elmLayoutButtonP=document.createElement("div");this.elmLayoutButtonP.style.position="absolute";this.elmLayoutButtonP.style.left=(this.objPageStyle.leftMargin*this.nPixelRate)+"px";this.elmLayoutButtonP.style.right=(this.objPageStyle.rightMargin*this.nPixelRate)+"px";this.elmLayoutButtonP.style.top=(this.objPageStyle.topMargin*this.nPixelRate)+"px";this.elmLayoutButtonP.style.bottom=(this.objPageStyle.bottomMargin*this.nPixelRate)+"px";var b=document.createElement("div");b.id=this.objDocument.reportKey+"IndexOrder";b.className="eform_IndexOrder";var g=document.createElement("div");g.id=this.objDocument.reportKey+"IO_in";g.className="eform_IndexOrder_inner";var l=document.createElement("button");l.tabIndex="-1";l.className="eform_IndexOrder_left";var i=document.createElement("button");i.tabIndex="-1";i.className="eform_IndexOrder_right";g.appendChild(l);g.appendChild(i);this.elmLayoutButtonP.appendChild(b);this.elmLayoutButtonP.appendChild(g);this.elmEFormLayoutDiv.appendChild(this.elmLayoutButtonP);};mCR_exportCanvasForEForm.prototype.findImageControl=function(a){var c=true;if(a.pageCountConditionType==21){var b=this.objDocument.checkedTotalPageCount;var f=this.pageIndex+1==b/2+1;if(a.visible){if(f==true){c=false;}}else{c=f||a.conditionVisible;}}else{if(a.pageCountConditionType==22){var d=(this.pageIndex+1)%2;if(d==0){c=false;}}else{if(a.pageCountConditionType==23){var d=(this.pageIndex+1)%2;if(d==1){c=false;}}}}if(c){switch(a.type){case mCR_DocumentControlType.Label:this.findImageLabel(a);break;case mCR_DocumentControlType.Table:this.findImageTable(a);break;case mCR_DocumentControlType.VoiceBarcode:this.findImageVoiceBarcode(a);break;case mCR_DocumentControlType.SubReport:this.findImageReportControl(a);break;case mCR_DocumentControlType.VoiceEye:this.findImageVoiceEye(a);break;case mCR_DocumentControlType.MarkAnyVoiceEye:this.findImageMarkAnyVoice(a);break;case mCR_DocumentControlType.Input:this.exportEFomInputbox(a);break;case mCR_DocumentControlType.Button:this.exportEFomInputButton(a);break;case mCR_DocumentControlType.Video:this.exportEFomInputVideo(a);break;case mCR_DocumentControlType.InputSelectBox:this.exportEFomInputSelectBox(a);break;case mCR_DocumentControlType.Calendar:this.exportEFomInputCalendar(a);break;case mCR_DocumentControlType.InputSign:this.exportEFomInputSign(a);break;case mCR_DocumentControlType.InputImage:this.exportEFomInputImage(a);break;case mCR_DocumentControlType.InputCheckbox:this.exportEFomInputCheckbox(a);break;}}};mCR_exportCanvasForEForm.prototype.findControlsInSubSectionImage=function(g){if(this.isEasyInput){this.elmLayoutTag=document.createElement("div");this.elmLayoutButton=document.createElement("div");if(g.isDrilling){this.elmLayoutTag.style.display="none";this.elmLayoutButton.style.display="none";}this.elmLayoutTagP.appendChild(this.elmLayoutTag);this.elmLayoutButtonP.appendChild(this.elmLayoutButton);var b=g.area.newRateRect(this.nPixelRate);this.elmLayoutTag.style.position=this.elmLayoutButton.style.position="relative";this.elmLayoutTag.style.top=this.elmLayoutButton.style.top="0px";this.elmLayoutTag.style.left=this.elmLayoutButton.style.left="0px";this.elmLayoutTag.style.width=this.elmLayoutButton.style.width=b.getWidth()+"px";this.elmLayoutTag.style.height=this.elmLayoutButton.style.height=b.getHeight()+"px";this.elmLayoutTag.id=this.elmLayoutButton.id=g.rName+"."+g.editEasyModeId;}else{this.elmLayoutTag=this.elmLayoutTagP;this.elmLayoutButton=this.elmLayoutButtonP;}for(var c=0;c<g.controlPageList.length;c++){var a=g.controlPageList[c];var f=true;if(-1!=a.visibleOptionStyleKey){var d=this.objDocument.getVisibleOptionStyle(a.visibleOptionStyleKey);if(null!=d){f=d.toView;if(this.isEasyInput){f=d.toEasyMoad;}}}if(f){this.findImageControl(a);}}};mCR_exportCanvasForEForm.prototype.findImageReportControl=function(d){if(this.isEasyInput){var b=this.elmLayoutTagP;var i=this.elmLayoutButtonP;var j=this.elmLayoutTag;var f=this.elmLayoutButton;var a=d.rect.newRateRect(this.nPixelRate);var h=document.createElement("div");var c=document.createElement("div");h.style.position=c.style.position="absolute";h.style.top=c.style.top=a.top+"px";h.style.left=c.style.left=a.left+"px";h.style.width=c.style.width=a.getWidth()+"px";h.style.height=c.style.height=a.getHeight()+"px";this.elmLayoutTag.appendChild(h);this.elmLayoutButton.appendChild(c);this.elmLayoutTagP=h;this.elmLayoutButtonP=c;}for(var g=0;g<d.subSectionList.length;g++){this.findControlsInSubSectionImage(d.subSectionList[g]);}if(this.isEasyInput){this.elmLayoutTagP=b;this.elmLayoutButtonP=i;this.elmLayoutTag=j;this.elmLayoutButton=f;}};mCR_exportCanvasForEForm.prototype.exportEFomInputCheckbox=function(t){var b=null;if(this.isEasyInput){b=t.rect;}else{b=t.getRectInPage();}var u=t.checkSize;this.pageEFormControlIDList.push(t.primaryName);var a=this.objDocument.documentStorage[t.primaryName];if(null!=a){var g=b.getHeight()-u;var l=this.objDocument.getLineStyle(t.outterlineStyleKey);var d=this.objDocument.getLineStyle(t.checkedBorderLineStyleKey);var k=this.objDocument.getShapeStyle(t.shapeStyleKey);var h=this.objDocument.getBackgroundStyle(t.backgroundStyleKey);var n=a.imageType=="check"?"CHECK":"RADIO";n=null==t.accessibilityString?n:t.accessibilityString;var c=document.createElement("div");c.style.cssText="position:absolute;overflow:hidden;";c.style.left=(b.left*this.nPixelRate)+"px";c.style.top=(b.top*this.nPixelRate)+"px";c.style.width=(b.getWidth()*this.nPixelRate)+"px";c.style.height=(b.getHeight()*this.nPixelRate)+"px";c.setAttribute("aria-hidden","true");var q=document.createElement("div");q.id=this.objDocument.reportKey+t.primaryName+"DIV";if(h.backStyle==0){q.style.cssText="background-color:"+mCR_changeRGBAColor(h.backColor,t.guideTransparency);}if(t.guideInCheckBox&&t.useText){q.style.position="absolute";if(t.checkboxLeftAlignment){q.style.left="0.02cm";}else{q.style.right="0.02cm";}q.style.top=((g/2)/100)+"cm";q.style.width=(u/100)+"cm";q.style.height=(u/100)+"cm";}else{q.className="eF_Rect";}var i=document.createElement("img");i.id=this.objDocument.reportKey+t.primaryName+"IMG";i.tabIndex="-1";var s="position:absolute;";if(t.useText){s+=(t.checkboxLeftAlignment?"left:0.02cm;":"right:0.02cm;")+"top:"+((g/2)/100)+"cm;width:"+(u/100)+"cm;height:"+(u/100)+"cm;";}else{s+="left:0cm;top:0cm;width:100%;height:100%;";}if(u<1){s+="visibility:hidden;";}if(k.shapeType==1){s+="border-radius: 100%;";}var o=mCR_getLineStyleTag(l);var f=d!=null?mCR_getLineStyleTag(d):o;i.setAttribute("uncheckborderstyle",o);i.setAttribute("checkborderstyle",f);if(l.style!=0){s+="border:"+o;}s+="box-sizing: border-box;";i.style.cssText=s;var r=document.createElement("div");r.id=this.objDocument.reportKey+t.primaryName+"FOCUS";r.className="eF_Rect";c.appendChild(q);c.appendChild(r);c.appendChild(i);if(t.useText){var p=document.createElement("span");p.tabIndex="-1";var j=new docRect();j.copyRect(b);if(t.checkboxLeftAlignment){j.left+=u;p.style.left=(u/100)+"cm";}else{j.setWidth(j.getWidth()-u);p.style.left="0cm";p.style.right=(u/100)+"cm";}if(!is_ie){p.style.lineHeight="0";}p.className="s_"+this.objDocument.reportKey+t.textInfo.getOriginalTextInfo().fontStyleKey+" eF_Rect";var m=mRe_createCheckboxTextSvg(j,t.textInfo,this.objDocument);p.innerHTML=m;c.appendChild(p);}this.elmLayoutTag.appendChild(c);var v=document.createElement("input");v.type="checkbox";v.tabIndex="0";v.className="eForm_hidden_button";v.id=this.objDocument.reportKey+t.primaryName;v.title=n;v.style.cssText="position:absolute;overflow:hidden;";if(t.checkboxLeftAlignment){v.style.left=(b.left*this.nPixelRate)+"px";}else{v.style.left=((b.left+b.getWidth()-(u+5))*this.nPixelRate)+"px";}v.style.top=(b.top*this.nPixelRate)+"px";v.style.zIndex="1";if(t.selectArea==0&&t.useText){v.style.width=((u+5)*this.nPixelRate)+"px";}else{v.style.width=(b.getWidth()*this.nPixelRate)+"px";}v.style.height=(b.getHeight()*this.nPixelRate)+"px";this.elmLayoutButton.appendChild(v);}};mCR_exportCanvasForEForm.prototype.exportEFomInputImage=function(m){var i=null;if(this.isEasyInput){i=m.rect;}else{i=m.getRectInPage();}this.pageEFormControlIDList.push(m.primaryName);var f=this.objDocument.documentStorage[m.primaryName];if(null!=f){var j=this.objDocument.getLineStyle(m.outterlineStyleKey);var g=this.objDocument.getBackgroundStyle(m.backgroundStyleKey);var l=m.accessibilityString;if(null==l){l="image";}var h=document.createElement("div");h.style.cssText="position:absolute;overflow:hidden;";h.style.left=(i.left*this.nPixelRate)+"px";h.style.top=(i.top*this.nPixelRate)+"px";h.style.width=(i.getWidth()*this.nPixelRate)+"px";h.style.height=(i.getHeight()*this.nPixelRate)+"px";h.setAttribute("aria-hidden","true");var b=document.createElement("span");b.id=this.objDocument.reportKey+m.primaryName+"Guide";b.className="eF_Rect";var a="";if(g.backStyle==0){a+="background-color:"+mCR_changeRGBAColor(g.backColor,m.transparencyRate)+";";}if(j.style!=0){a+="border:"+mCR_getLineStyleTag(j);a+="color:"+mCR_getStrColor(j.color)+" !important;";}a+="text-align:left !important;  padding: 0px 0px 0px 0px !important;font-size:10px !important;";b.style.cssText=a;var k=document.createElement("img");k.id=this.objDocument.reportKey+m.primaryName+"Canvas";k.className="eF_Rect2";var d=document.createElement("div");d.id=this.objDocument.reportKey+m.primaryName+"FOCUS";d.className="eF_Rect";h.appendChild(b);h.appendChild(k);h.appendChild(d);this.elmLayoutTag.appendChild(h);var c=document.createElement("button");c.tabIndex="0";c.className="eForm_hidden_button";c.id=this.objDocument.reportKey+m.primaryName;c.title=l;c.style.cssText="position:absolute;overflow:hidden;border:0.75pt solid !important; padding: 0px 0px 0px 0px !important;cursor:pointer;";c.style.left=(i.left*this.nPixelRate)+"px";c.style.top=(i.top*this.nPixelRate)+"px";c.style.width=(i.getWidth()*this.nPixelRate)+"px";c.style.height=(i.getHeight()*this.nPixelRate)+"px";c.style.zIndex="1";c.innerHTML=l;this.elmLayoutButton.appendChild(c);}};mCR_exportCanvasForEForm.prototype.exportEFomInputSign=function(h){var d=null;if(this.isEasyInput){d=h.rect;}else{d=h.getRectInPage();}this.pageEFormControlIDList.push(h.primaryName);var b=this.objDocument.documentStorage[h.primaryName];if(null!=b){var j=this.objDocument.getLineStyle(h.outterlineStyleKey);var l=this.objDocument.getShapeStyle(h.shapeStyleKey);var i=this.objDocument.getBackgroundStyle(h.backgroundStyleKey);var m=new docStyleLine();m.setStyle(h.guileLineStyle,h.guileLineWidth,h.guileLineColor);var q=h.accessibilityString;if(null==q){q="sign";}var s=document.createElement("div");s.style.cssText="position:absolute;overflow:hidden;";s.style.left=(d.left*this.nPixelRate)+"px";s.style.top=(d.top*this.nPixelRate)+"px";s.style.width=(d.getWidth()*this.nPixelRate)+"px";s.style.height=(d.getHeight()*this.nPixelRate)+"px";s.setAttribute("aria-hidden","true");var f=document.createElement("span");f.id=this.objDocument.reportKey+h.primaryName+"Guide";f.className="eF_Rect";var t="";if(i.backStyle==0){t+="background-color:"+mCR_changeRGBAColor(i.backColor,h.transparencyRate)+";";}if(m.style!=0){t+="border:"+mCR_getLineStyleTag(m);t+="color:"+mCR_getStrColor(m.color)+" !important;";}t+="text-align:left !important;  padding: 0px 0px 0px 0px !important;font-size:10px !important;";f.style.cssText=t;var c=document.createElement("div");c.className="eF_Rect2 eform_sign_paint_guide";var o=document.createElement("table");o.className="eform_table";o.border="0";o.cellSpacing="0";o.cellPadding="0";var g=document.createElement("tr");var k=document.createElement("td");var a=new docStyleTextOption();a.horizontalAlignment=h.horizontalAlignmentMethod;a.verticalAlignment=h.verticalAlignmentMethod;mCR_setAlignmentMethod(k,a);k.style.cssText="word-wrap:break-word;background-color:transparent !important;";c.id=this.objDocument.reportKey+h.primaryName+"GuideInput";var r=document.createElement("canvas");r.id=this.objDocument.reportKey+h.primaryName+"Canvas";r.className="eF_Rect2";var n=document.createElement("div");n.id=this.objDocument.reportKey+h.primaryName+"FOCUS";n.className="eF_Rect";g.appendChild(k);o.appendChild(g);c.appendChild(o);s.appendChild(f);s.appendChild(c);s.appendChild(r);s.appendChild(n);this.elmLayoutTag.appendChild(s);var p=document.createElement("button");p.tabIndex="0";p.className="eForm_hidden_button";p.id=this.objDocument.reportKey+h.primaryName;p.title=q;p.style.cssText="position:absolute;overflow:hidden;border:0.75pt solid !important; padding: 0px 0px 0px 0px !important;cursor:pointer;";p.style.left=(d.left*this.nPixelRate)+"px";p.style.top=(d.top*this.nPixelRate)+"px";p.style.width=(d.getWidth()*this.nPixelRate)+"px";p.style.height=(d.getHeight()*this.nPixelRate)+"px";p.style.zIndex="1";p.innerHTML=q;this.elmLayoutButton.appendChild(p);}};mCR_exportCanvasForEForm.prototype.exportEFomInputCalendar=function(h){var o=null;if(this.isEasyInput){o=h.rect;}else{o=h.getRectInPage();}this.pageEFormControlIDList.push(h.primaryName);var j=this.objDocument.documentStorage[h.primaryName];if(null!=j){var p=this.objDocument.getLineStyle(h.outterlineStyleKey);var k=this.objDocument.getBackgroundStyle(h.backgroundStyleKey);var l=this.objDocument.getTextOptionStyle(h.textOptionStyleKey);var q=h.accessibilityString;if(null==q){q="calendar";}var i=document.createElement("div");i.style.cssText="position:absolute;overflow:hidden;";i.style.left=(o.left*this.nPixelRate)+"px";i.style.top=(o.top*this.nPixelRate)+"px";i.style.width=(o.getWidth()*this.nPixelRate)+"px";i.style.height=(o.getHeight()*this.nPixelRate)+"px";i.setAttribute("aria-hidden","true");var c=document.createElement("div");c.id=this.objDocument.reportKey+h.primaryName+"SPAN";c.className="eF_Rect";var b="";if(k.backStyle==0){b+="background-color:"+mCR_changeRGBAColor(k.backColor,h.transparencyRate)+";";}if(p.style!=0){b+="border:"+mCR_getLineStyleTag(p);b+="color:"+mCR_getStrColor(p.color)+" !important;";}c.style.cssText=b;var d=document.createElement("div");d.className="eF_Rect";var n=document.createElement("table");n.className="eform_table";n.border="0";n.cellSpacing="0";n.cellPadding="0";var a=document.createElement("tr");var m=document.createElement("td");m.id=this.objDocument.reportKey+h.primaryName+"TD";mCR_setAlignmentMethod(m,l);m.style.cssText="word-wrap:break-word;background-color:transparent !important;";m.className="s_"+this.objDocument.reportKey+h.fontStyleKey;m.appendChild(document.createElement("nobr"));var g=document.createElement("div");g.id=this.objDocument.reportKey+h.primaryName+"FOCUS";g.className="eF_Rect";a.appendChild(m);n.appendChild(a);d.appendChild(n);i.appendChild(c);i.appendChild(d);i.appendChild(g);this.elmLayoutTag.appendChild(i);var f=document.createElement("button");f.tabIndex="0";f.className="eForm_hidden_button";f.id=this.objDocument.reportKey+h.primaryName;f.title=q;f.style.cssText="position:absolute;overflow:hidden;border:0.75pt solid !important; padding: 0px 0px 0px 0px !important;cursor:pointer;";f.style.left=(o.left*this.nPixelRate)+"px";f.style.top=(o.top*this.nPixelRate)+"px";f.style.width=(o.getWidth()*this.nPixelRate)+"px";f.style.height=(o.getHeight()*this.nPixelRate)+"px";f.style.zIndex="1";f.innerHTML=q;this.elmLayoutButton.appendChild(f);}};mCR_exportCanvasForEForm.prototype.exportEFomInputSelectBox=function(i){var d=null;if(this.isEasyInput){d=i.rect;}else{d=i.getRectInPage();}this.pageEFormControlIDList.push(i.primaryName);var b=this.objDocument.documentStorage[i.primaryName];if(null!=b){var m=this.objDocument.getLineStyle(i.outterlineStyleKey);var j=this.objDocument.getBackgroundStyle(i.backgroundStyleKey);var a=this.objDocument.getTextOptionStyle(i.textInfo.getOriginalTextInfo().textOptionStyleKey);var p=i.accessibilityString;if(null==p){p="selectbox";}var l=document.createElement("div");l.style.cssText="position:absolute;overflow:hidden;";l.style.left=(d.left*this.nPixelRate)+"px";l.style.top=(d.top*this.nPixelRate)+"px";l.style.width=(d.getWidth()*this.nPixelRate)+"px";l.style.height=(d.getHeight()*this.nPixelRate)+"px";l.setAttribute("aria-hidden","true");var f=document.createElement("div");f.id=this.objDocument.reportKey+i.primaryName+"SPAN";f.className="eF_Rect";var s="";if(j.backStyle==0){s+="background-color:"+mCR_changeRGBAColor(j.backColor,i.transparencyRate)+";";}if(m.style!=0){s+="border:"+mCR_getLineStyleTag(m);s+="color:"+mCR_getStrColor(m.color)+" !important;";}f.style.cssText=s;var c=document.createElement("div");c.className="eF_Rect";var n=document.createElement("table");n.className="eform_table";n.border="0";n.cellSpacing="0";n.cellPadding="0";var g=document.createElement("tr");var k=document.createElement("td");var r=document.createElement("nobr");k.id=this.objDocument.reportKey+i.primaryName+"TD";mCR_setAlignmentMethod(k,a);k.style.cssText="word-wrap:break-word;background-color:transparent !important;";k.className="s_"+this.objDocument.reportKey+i.textInfo.getOriginalTextInfo().fontStyleKey;var q=document.createElement("td");q.width="20px";q.align="center";q.vAlign="middle";q.style.fontSize="8pt";q.innerHTML="▼";var o=document.createElement("div");o.id=this.objDocument.reportKey+i.primaryName+"FOCUS";o.className="eF_Rect";k.appendChild(r);g.appendChild(k);g.appendChild(q);n.appendChild(g);c.appendChild(n);l.appendChild(f);l.appendChild(c);l.appendChild(o);this.elmLayoutTag.appendChild(l);var h=document.createElement("select");h.tabIndex="0";h.className="eForm_hidden_button";h.id=this.objDocument.reportKey+i.primaryName;h.title=p;h.style.cssText="position:absolute;overflow:hidden;border:0.75pt solid !important; padding: 0px 0px 0px 0px !important;cursor:pointer;";h.style.left=(d.left*this.nPixelRate)+"px";h.style.top=(d.top*this.nPixelRate)+"px";h.style.width=(d.getWidth()*this.nPixelRate)+"px";h.style.height=(d.getHeight()*this.nPixelRate)+"px";h.style.zIndex="1";h.innerHTML=p;this.elmLayoutButton.appendChild(h);}};mCR_exportCanvasForEForm.prototype.exportEFomInputButton=function(j){var o=null;if(this.isEasyInput){o=j.rect;}else{o=j.getRectInPage();}this.pageEFormControlIDList.push(j.primaryName);var i=this.objDocument.documentStorage[j.primaryName];if(null!=i){var p=this.objDocument.getLineStyle(j.outterlineStyleKey);var k=this.objDocument.getBackgroundStyle(j.backgroundStyleKey);var l=this.objDocument.getTextOptionStyle(j.textInfo.getOriginalTextInfo().textOptionStyleKey);var q=j.accessibilityString;if(null==q){q="button";}var h=document.createElement("div");h.style.cssText="position:absolute;overflow:hidden;";h.style.left=(o.left*this.nPixelRate)+"px";h.style.top=(o.top*this.nPixelRate)+"px";h.style.width=(o.getWidth()*this.nPixelRate)+"px";h.style.height=(o.getHeight()*this.nPixelRate)+"px";h.setAttribute("aria-hidden","true");var c=document.createElement("div");c.id=this.objDocument.reportKey+j.primaryName+"SPAN";c.className="eF_Rect";var b="";if(k.backStyle==0){b+="background-color:"+mCR_changeRGBAColor(k.backColor,j.transparencyRate)+";";}if(p.style!=0){b+="border:"+mCR_getLineStyleTag(p);b+="color:"+mCR_getStrColor(p.color)+" !important;";}c.style.cssText=b;var d=document.createElement("div");d.className="eF_Rect";var n=document.createElement("table");n.className="eform_table";n.border="0";n.cellSpacing="0";n.cellPadding="0";var a=document.createElement("tr");var m=document.createElement("td");m.id=this.objDocument.reportKey+j.primaryName+"TD";mCR_setAlignmentMethod(m,l);m.style.cssText="word-wrap:break-word;background-color:transparent !important;";m.className="s_"+this.objDocument.reportKey+j.textInfo.getOriginalTextInfo().fontStyleKey;var g=document.createElement("div");g.id=this.objDocument.reportKey+j.primaryName+"FOCUS";g.className="eF_Rect";a.appendChild(m);n.appendChild(a);d.appendChild(n);h.appendChild(c);h.appendChild(d);h.appendChild(g);this.elmLayoutTag.appendChild(h);var f=document.createElement("button");f.tabIndex="0";f.className="eForm_hidden_button";f.id=this.objDocument.reportKey+j.primaryName;f.title=q;f.style.cssText="position:absolute;overflow:hidden;border:0.75pt solid !important; padding: 0px 0px 0px 0px !important;cursor:pointer;";f.style.left=(o.left*this.nPixelRate)+"px";f.style.top=(o.top*this.nPixelRate)+"px";f.style.width=(o.getWidth()*this.nPixelRate)+"px";f.style.height=(o.getHeight()*this.nPixelRate)+"px";f.style.zIndex="1";f.innerHTML=q;this.elmLayoutButton.appendChild(f);}};mCR_exportCanvasForEForm.prototype.exportEFomInputVideo=function(j){var i=null;if(this.isEasyInput){i=j.rect;}else{i=j.getRectInPage();}this.pageEFormControlIDList.push(j.primaryName);var g=this.objDocument.documentStorage[j.primaryName];if(null!=g){var k=this.objDocument.getLineStyle(j.outterlineStyleKey);var h=this.objDocument.getBackgroundStyle(j.backgroundStyleKey);var l=j.accessibilityString;if(null==l){l="video";}var d=document.createElement("div");d.style.cssText="position:absolute;overflow:hidden;";d.style.left=(i.left*this.nPixelRate)+"px";d.style.top=(i.top*this.nPixelRate)+"px";d.style.width=(i.getWidth()*this.nPixelRate)+"px";d.style.height=(i.getHeight()*this.nPixelRate)+"px";d.setAttribute("aria-hidden","true");var b=document.createElement("div");b.id=this.objDocument.reportKey+j.primaryName+"SPAN";b.className="eF_Rect";var a="";if(h.backStyle==0){a+="background-color:"+mCR_changeRGBAColor(h.backColor,j.transparencyRate)+";";}if(k.style!=0){a+="border:"+mCR_getLineStyleTag(k);a+="color:"+mCR_getStrColor(k.color)+" !important;";}b.style.cssText=a;var c=document.createElement("div");c.id=this.objDocument.reportKey+j.primaryName+"FOCUS";c.className="eF_Rect";d.appendChild(b);d.appendChild(c);this.elmLayoutTag.appendChild(d);var f=document.createElement("video");f.tabIndex="0";f.id=this.objDocument.reportKey+j.primaryName;f.title=l;f.style.cssText="position:absolute;overflow:hidden;border:0 solid !important; padding: 0px 0px 0px 0px !important;cursor:pointer;";f.style.left=(i.left*this.nPixelRate)+"px";f.style.top=(i.top*this.nPixelRate)+"px";f.style.width=(i.getWidth()*this.nPixelRate)+"px";f.style.height=(i.getHeight()*this.nPixelRate)+"px";f.style.zIndex="1";f.controls=true;this.elmLayoutButton.appendChild(f);}};mCR_exportCanvasForEForm.prototype.exportEFomInputbox=function(r){var d=null;if(this.isEasyInput){d=r.rect;}else{d=r.getRectInPage();}this.pageEFormControlIDList.push(r.primaryName);var b=this.objDocument.documentStorage[r.primaryName];if(null!=b){var n=this.objDocument.getLineStyle(r.outterlineStyleKey);var i=this.objDocument.getBackgroundStyle(r.backgroundStyleKey);var a=this.objDocument.getTextOptionStyle(r.textInfo.getOriginalTextInfo().textOptionStyleKey);var k=this.objDocument.getFontStyle(r.textInfo.getOriginalTextInfo().fontStyleKey);var q=r.accessibilityString;if(null==q){q="inputbox";}var m=document.createElement("div");m.style.cssText="position:absolute;overflow:hidden;";m.style.left=(d.left*this.nPixelRate)+"px";m.style.top=(d.top*this.nPixelRate)+"px";m.style.width=(d.getWidth()*this.nPixelRate)+"px";m.style.height=(d.getHeight()*this.nPixelRate)+"px";m.setAttribute("aria-hidden","true");var f=document.createElement("div");f.id=this.objDocument.reportKey+r.primaryName+"SPAN";f.className="eF_Rect";var s="";if(i.backStyle==0){s+="background-color:"+mCR_changeRGBAColor(i.backColor,r.transparencyRate)+";";}if(n.style!=0){s+="border:"+mCR_getLineStyleTag(n);s+="color:"+mCR_getStrColor(n.color)+" !important;";}f.style.cssText=s;var c=document.createElement("div");c.className="eF_Rect";var o=document.createElement("table");o.className="eform_table";o.border="0";o.cellSpacing="0";o.cellPadding="0";var g=document.createElement("tr");var l=document.createElement("td");l.id=this.objDocument.reportKey+r.primaryName+"TD";mCR_setAlignmentMethod(l,a);l.style.cssText="word-wrap:break-word;background-color:transparent !important;";l.className="s_"+this.objDocument.reportKey+r.textInfo.getOriginalTextInfo().fontStyleKey;if(null!=k){l.style.fontSize=k.size+"pt";}g.appendChild(l);o.appendChild(g);c.appendChild(o);m.appendChild(f);m.appendChild(c);this.elmLayoutTag.appendChild(m);var p=document.createElement("textarea");if(b.isGuideText){var j=b.guideTextColor;var h=document.createElement("textarea");h.tabIndex="-1";h.readonly=true;h.className="eform_guide_textarea mRe_focus s_"+this.objDocument.reportKey+r.textInfo.getOriginalTextInfo().fontStyleKey;h.id=this.objDocument.reportKey+r.primaryName+"GT";h.style.left=(d.left*this.nPixelRate)+"px";h.style.top=(d.top*this.nPixelRate)+"px";h.style.width=(d.getWidth()*this.nPixelRate)+"px";h.style.height=(d.getHeight()*this.nPixelRate)+"px";h.style.color=mCR_getStrColor(j);h.value=decodeURIComponent(b.guideText);p.style.backgroundColor="RGBA(255,255,255,0)";mCR_setInputAlignmentMethod(h,a);mRe_spaceStyle(h,a,k);this.elmLayoutButton.appendChild(h);}p.tabIndex="0";p.className="eform_textarea mRe_focus s_"+this.objDocument.reportKey+r.textInfo.getOriginalTextInfo().fontStyleKey;p.title=q;p.id=this.objDocument.reportKey+r.primaryName;p.style.left=(d.left*this.nPixelRate)+"px";p.style.top=(d.top*this.nPixelRate)+"px";p.style.width=(d.getWidth()*this.nPixelRate)+"px";p.style.height=(d.getHeight()*this.nPixelRate)+"px";p.style.zIndex="1";mCR_setInputAlignmentMethod(p,a);mRe_spaceStyle(p,a,k);this.elmLayoutButton.appendChild(p);}};function mRe_createCheckboxTextSvg(h,b,g){var d=new Array();d.push("<svg ");d.push('width="'+(h.getWidth()/100)+'cm" ');d.push('height="'+(h.getHeight()/100)+'cm" ');d.push('fill-opacity="1" xmlns:xlink="http://www.w3.org/1999/xlink" color-rendering="auto" color-interpolation="auto" text-rendering="auto"  style="overflow:hidden" stroke-linecap="square"  stroke-miterlimit="10" shape-rendering="auto" stroke-opacity="1" stroke-dasharray="none" font-weight="normal" stroke-width="1"  xmlns="http://www.w3.org/2000/svg" font-style="normal" stroke-linejoin="miter" stroke-dashoffset="0" image-rendering="auto">');d.push('<g stroke-linecap="butt" >');var a=b.getUseMultiLanguage();var i=b.textLineList;for(var f=0;f<i.length;f++){var c=i[f];if(c.isPaint(h.getHeight(),f)){mRe_textSVGLine(d,c,a,g);}else{break;}}d.push("</g>");d.push("</svg>");return d.join("");}function mRe_textSVGLine(c,b,a,f){var h=b.getY();if(a){mRe_makeLineSVGText(c,0,h+b.getHeight()-(b.getHeight()*0.15),b.getText());}else{var g=b.getCharacterBatchCount();for(var d=0;d<g;d++){mRe_characterSVGBatch(c,h+b.getHeight()-(b.getHeight()*0.15),b.getCharacterBatch(d),f);}}}function mRe_makeLineSVGText(b,a,d,c){b.push("<text  class='r_F_S' x='"+(a/100)+"cm' y='"+(d/100)+"cm' >");c=c.replace(/\</gi,"&lt;");c=c.replace(/\>/gi,"&gt;");c=c.replace(/\&/gi,"&amp;");b.push(c);b.push("</text>");}function mRe_characterSVGBatch(b,h,a,f){var d=a.getFontStyleKey();var g=null;for(var c=0;c<a.getCharacterCount();c++){g=a.getCharacter(c);mRe_makePositionSVGText(b,d,g.getX(),h,g.getCharacter(),f);}}function mRe_makePositionSVGText(b,d,a,g,f,c){b.push("<text class='r_F_S s_"+c.reportKey+d+" ");if(window.is_apple||window.mCR_isApple){b.push("r_F_S b_"+c.reportKey+d);}b.push("'");b.push("x='"+(a/100)+"cm' y='"+(g/100)+"cm'>");if("<"==f){f="&lt;";}else{if(">"==f){f="&gt;";}else{if("&"==f){f="&amp;";}}}b.push(f);b.push("</text>");}function mRe_createCheckboxTextSpan(h,b,g){var d=new Array();var a=b.getUseMultiLanguage();var i=b.textLineList;for(var f=0;f<i.length;f++){var c=i[f];if(c.isPaint(h.getHeight(),f)){mRe_textSpanLine(d,c,a,g);}else{break;}}return d.join("");}function mRe_textSpanLine(c,b,a,f){var h=b.getY();if(a){mRe_makeLineSpanText(c,0,h,b.getText());}else{var g=b.getCharacterBatchCount();for(var d=0;d<g;d++){mRe_characterSpanBatch(c,h,b.getCharacterBatch(d),f);}}}function mRe_makeLineSpanText(b,a,d,c){b.push("<span class='r_F_S' style='position:absolute;left:"+(a/100)+"cm;top:"+(d/100)+"cm;line-height:100%;'>");c=c.replace(/\</gi,"&lt;");c=c.replace(/\>/gi,"&gt;");c=c.replace(/\&/gi,"&amp;");b.push(c);b.push("</span>");}function mRe_characterSpanBatch(b,h,a,f){var d=a.getFontStyleKey();var g=null;for(var c=0;c<a.getCharacterCount();c++){g=a.getCharacter(c);mRe_makePositionSpanText(b,d,g.getX(),h,g.getCharacter(),f);}}function mRe_makePositionSpanText(b,d,a,g,f,c){b.push("<span class='r_F_S s_"+c.reportKey+d+"' ");b.push("style='position:absolute;left:"+(a/100)+"cm;top:"+(g/100)+"cm;line-height:100%;'>");if("<"==f){f="&lt;";}else{if(">"==f){f="&gt;";}else{if("&"==f){f="&amp;";}}}b.push(f);b.push("</span>");}function mCR_exportChart(d,v){var l=new mCR_exportChartShapePaint(d);var s=new mCR_exportChartShape(l);this.exportt=function(){var D=new mCR_exportChartDocument(v);o(D.panel);C(D.frameList);a(D.legend);x(D.panel);};function x(D){t(D.shapeLabel);}function o(D){t(D.shapePanel);}function a(D){B();t(D.shapeLegend);w();}function C(D){B();D.map(function(E){p(E);});w();}function p(D){return{0:z,1:r,2:y}[D.type](D);}function z(D){t(D.XYAxis.shapeListWall);b(D.seriesGroupList,D.XYAxis.vertical);t(D.XYAxis.shapeListAxis);c(D.seriesGroupList);h(D.seriesGroupList);}function b(E,D){E.map(function(F){if(f(F)){u(F);A(F,D);w();}else{g(F.frontRect);m(F);w();}});}function u(F){var D=new mCR_exportChartUtilRectangle(F.frontRect);var E=D.union(F.rearRect);g(E);}function g(D){l.beginClip(D);}function w(){l.endClip();}function B(){l.defaultClip();}function f(D){if(!D.seriesList){return false;}if(D.seriesList.length==0){return false;}exportChartLog.log("seriesTypeCode:"+D.seriesList[0].type);exportChartLog.log("seriesTypeName:"+D.seriesList[0].typeName);return(D.seriesList[0].typeName=="bar");}function A(F,E){var D=[];F.seriesList.map(function(G){G.seriesItemList.map(function(H){var I=n(H.rect,F.frontRect,E);D.push({key:I,value:H});});});D.sort(function(H,G){return H.key-G.key;});D.map(function(H){var G=H.value;t(G.shapeList);});}function n(K,J,E){var I=K.left-J.left;var H=K.bottom-J.top;var G=J.right-J.left;var D=J.bottom-J.top;var F=0;if(E==true){F=(I*D)+(D-H);}else{F=(-H*G)-(G-I);}return F;}function m(D){D.seriesList.map(function(E){E.seriesItemList.map(function(F){t(F.shapeList);});});}function c(D){k(D,function(E){t(E.pointList);});}function h(D){k(D,function(E){t(E.markList);});}function k(E,D){E.map(function(F){F.seriesList.map(function(G){G.seriesItemList.map(D);});});}function r(D){q(D.seriesGroupList);h(D.seriesGroupList);}function q(D){D.map(function(E){E.seriesList.map(function(F){var G=new mCR_exportChartSeriesPie(l);F.seriesItemList.map(function(H){H.shapeList.map(function(I){G.add(new mCR_exportChartDocumentShape(I));});});G.exportt();});});}function y(D){t(D.radar.shapeList);i(D.seriesGroupList);h(D.seriesGroupList);}function i(D){D.map(function(E){m(E);});}function t(D){if(!D){return;}D.map(function(E){j(E);});}function j(E){var D=new mCR_exportChartDocumentShape(E);s.paint(D);}}function mCR_exportChartShape(k){var c=new mCR_exportChartShapePoint(k);var a=new mCR_exportChartShapeBar(k);this.paint=function(p){var o={0:h,1:i,2:m,3:n,4:b,5:g,6:j,7:d,8:l,9:f};o[p.type](p);};function h(o){o.rectangleType===1?k.ellipse(o.background,o.line,o.rect):k.rectangle(o.background,o.line,o.rect);}function l(o){k.rectangle(o.background,o.line,o.rect);k.text(o.font,o.option,o.rect,o.text,o.angle,o.rotate);}function n(o){k.line(o.line,o.start,o.end);}function j(o){c.paint(o);}function i(o){k.regularPolygon(o.background,o.line,o.rect,o.startAngle,o.slice);}function m(o){k.irregularPolygon(o.background,o.line,o.pointList);}function b(o){k.curveLine(o.line,o.pointList,o.tension);}function g(o){a.paint(o);}function d(o){}function f(o){k.curveSurface(o.background,o.line,o.topPointList,o.topTension,o.bottomPointList,o.bottomTension,o.lineTopOnly);}}var exportChartLog=new function(){var a=false;this.log=function(b){if(a){console.log(b);}};};function mCR_exportChartPaintCanvas(b,k){var d=new mCR_exportChartClipDocument(b.objDocument);var r=new mCR_exportChartPaintCoordinateTranslate({x:k.left,y:k.top});var g=new mCR_exportChartPaintUnitType();var a=b.objContext;var p=new mCR_exportChartPaintCanvasBackground(a,g);var n=new mCR_exportChartPaintCanvasClip(a,g,k);var i=new mCR_exportChartPaintCanvasClipExport(b,p);var l=new mCR_exportChartPaintCanvasStyle(i,a,g);var j=new mCR_exportChartPaintCanvasRectangle(l,a,g);var o=new mCR_exportChartPaintCanvasCircle(l,a,g);var m=new mCR_exportChartPaintCanvasEllipse(l,a,g);var c=new mCR_exportChartPaintCanvasLine(l,a,g);var f=new mCR_exportChartPaintCanvasText(i,a,g);var t=new mCR_exportChartPaintCanvasPolygon(l,a,g);var h=new mCR_exportChartPaintCanvasCurve(l,a,g);var q=new mCR_exportChartPaintCanvasPie(l,a,g);var s=new mCR_exportChartPaintCanvasArcFace(l,a,g);this.rectangle=function(v,u,w){v=d.background(v);u=d.line(u);w=r.rect(w);j.rectangle(v,u,w);};this.circle=function(v,u,w){v=d.background(v);u=d.line(u);w=r.rect(w);o.paint(v,u,w);};this.ellipse=function(v,u,w){v=d.background(v);u=d.line(u);w=r.rect(w);m.paint(v,u,w);};this.line=function(v,w,u){v=d.line(v);w=r.point(w);u=r.point(u);c.line(v,w,u);};this.text=function(u,w,x,z,y,v){u=d.font(u);w=d.textOption(w);x=r.rect(x);f.text(u,w,x,z,y,v);};this.polygon=function(x,v,u,w){x=d.background(x);v=d.line(v);u=r.pointList(u);w=w?r.rect(w):w;t.polygon(x,v,u,w);};this.curveLine=function(v,u,w){v=d.line(v);u=r.pointList(u);h.line(v,u,w);};this.curveSurface=function(x,u,w,A,v,y,z){x=d.background(x);u=d.line(u);w=r.pointList(w);v=r.pointList(v);h.surface(x,u,w,A,v,y,z);};this.pie=function(x,v,z,w,u,y){x=d.background(x);v=d.line(v);z=r.rect(z);q.pie(x,v,z,w,u,y);};this.arcFace=function(w,u,x,v){w=d.background(w);u=d.line(u);x.map(function(y){y.rect=r.rect(y.rect);});v=v?r.rect(v):v;s.arcFace(w,u,x,v);};this.beginClip=function(u){u=r.rect(u);n.begin(u);};this.defaultClip=function(){n.defaultt();};this.endClip=function(){n.end();};}function mCR_exportChartPaintCanvasClip(a,b,c){this.begin=function(d){a.save();a.beginPath();d=b.px().rect2(d);a.rect(d.x,d.y,d.width,d.height);a.clip();};this.defaultt=function(){a.save();a.beginPath();var d=b.px().rect2(c);a.rect(d.x,d.y,d.width,d.height);a.clip();};this.end=function(){a.restore();};}var mCR_exportChartPaintCanvasBackground=function(a,b){this.radialIn=function(d,g){var c=b.px().ellipse(g);var f=c.rx<c.ry?c.ry:c.rx;var h=a.createRadialGradient(c.cx,c.cy,0,c.cx,c.cy,f);h.addColorStop(0,mCR_getStrColor(d.gradientEndColor));h.addColorStop(1,mCR_getStrColor(d.gradientStartColor));a.fillStyle=h;};};function mCR_exportChartPaintCanvasClipExport(b,a){this.styleBackground=function(d,c){if(c.gradientStyle==8){a.radialIn(c,d);}else{b.paintBackgroundStyle(c,d);}};this.styleLine=function(c){b.paintLineStyle(c);};this.styleFontName=function(c){return b.objDocument.getFontNameStyle(c);};}function mCR_exportChartPaintCanvasStyle(a,b,d){this.background=function(f,g){if(f){a.styleBackground(g,f);c(f.alpha);}};this.line=function(f){if(f){a.styleLine(f);c(f.alpha);}};function c(f){b.globalAlpha=f/255;}}function mCR_exportChartPaintCanvasRectangle(a,b,c){this.rectangle=function(f,d,g){var h=c.px().rect2(g);if(f){a.background(f,g);b.fillRect(h.x,h.y,h.width,h.height);}if(d){a.line(d);b.strokeRect(h.x,h.y,h.width,h.height);}};}function mCR_exportChartPaintCanvasLine(a,b,c){this.line=function(g,i,f){if(g){var h=c.px().point(i);var d=c.px().point(f);a.line(g);b.beginPath();b.moveTo(h.x,h.y);b.lineTo(d.x,d.y);b.stroke();}};}function mCR_exportChartPaintCanvasText(d,l,a){this.text=function(t,v,w,y,x,u){if(!t){return;}l.font=b(t);l.fillStyle=mCR_getStrColor(t.color);l.textAlign=r(v.horizontalAlignment);o(w,v,y,x,u);};function m(u,t){return{x:s(u,t.horizontalAlignment),y:p(u,t.verticalAlignment)};}function s(u,t){switch(t){case 0:return u.left;case 1:return new mCR_exportChartUtilRectangle(u).center();case 2:return u.right;default:return u.left;}}function p(u,t){return u.top+(u.getHeight()*0.85);}function r(t){switch(t){case 0:return"start";case 1:return"center";case 2:return"end";default:return"start";}}function o(w,v,y,x,u){var t={0:h,1:q,2:c,3:c};t[u](w,v,y,x);}function h(v,u,w){var t=m(v,u);l.fillText(w,a.px().value(t.x),a.px().value(t.y));}function q(u,t,w,v){}function c(v,u,x,w){var t=j(v,w,u.horizontalAlignment);l.save();l.translate(a.px().value(t.x),a.px().value(t.y));l.rotate(k(w));l.fillText(x,0,0);l.restore();}function j(u,v,t){switch(t){case 0:return g(u);case 1:return n(u,v);case 2:return i(u,v);default:return g(u);}}function g(t,u){return{x:t.left,y:t.top};}function n(v,w){var t=new mCR_exportChartUtilTrigonometry().cosSin((v.right-v.left)*0.5,w);var u=new mCR_exportChartUtilTrigonometry().cosSin((v.bottom-v.top)*0.85,w);return{x:v.left+t.width+u.width,y:v.top-t.height+u.height};}function i(v,w){var t=new mCR_exportChartUtilTrigonometry().cosSin((v.right-v.left),w);var u=new mCR_exportChartUtilTrigonometry().cosSin((v.bottom-v.top)*0.85,w);return{x:v.left+t.width+u.width,y:v.top-t.height+u.height};}function b(t){return(t.bold==true?"bold ":"")+(t.italic==true?"italic ":"")+(t.size)+"pt "+d.styleFontName(t.nameEngIndex);}function k(t){return f(t)*Math.PI/180;}function f(t){return 360-(t%360);}}function mCR_exportChartPaintCanvasCircle(a,c,b){this.paint=function(f,d,h){var g=b.px().circle(h);if(f){c.beginPath();c.arc(g.cx,g.cy,g.r,0,2*Math.PI,false);a.background(f,h);c.fill();}if(d){c.beginPath();c.arc(g.cx,g.cy,g.r,0,2*Math.PI,false);a.line(d);c.stroke();}};}function mCR_exportChartPaintCanvasEllipse(a,c,b){this.paint=function(g,d,h){var f=b.px().ellipse(h);if(g){c.beginPath();c.ellipse(f.cx,f.cy,f.rx,f.ry,0,0,2*Math.PI,false);a.background(g,h);c.fill();}if(d){c.beginPath();c.ellipse(f.cx,f.cy,f.rx,f.ry,0,0,2*Math.PI,false);a.line(d);c.stroke();}};}function mCR_exportChartPaintCanvasPolygon(a,b,c){this.polygon=function(h,f,d,g){if(h){g=g?g:this.pointListToRect(d);b.beginPath();a.background(h,g);d.map(function(i){b.lineTo(c.px().value(i.x),c.px().value(i.y));});b.fill();}if(f){a.line(f);b.beginPath();d.map(function(i){b.lineTo(c.px().value(i.x),c.px().value(i.y));});b.closePath();b.stroke();}};this.pointListToRect=function(d){var f=new docRect();if(0<d.length){f.left=d[0].x;f.top=d[0].y;f.right=d[0].x;f.bottom=d[0].y;}d.map(function(g){f.left=g.x<f.left?g.x:f.left;f.top=g.y<f.top?g.y:f.top;f.right=f.right<g.x?g.x:f.right;f.bottom=f.bottom<g.y?g.y:f.bottom;});return f;};}function mCR_exportChartPaintCanvasCurve(b,d,h){var c=new mCR_exportChartPaintCanvasPolygon(b,d,h);var g=new mCR_exportChartPaintCanvasCurvePath(d);this.line=function(k,j,l){a(k,j,l);};this.surface=function(m,j,l,p,k,n,o){if(o==true){f(m,l,p,k,n);a(j,l,p);}else{f(m,l,p,k,n);i(j,l,p,k,n);}};function a(k,j,m){d.beginPath();b.line(k);var l=h.px().pointList(j);g.line(l,m);d.stroke();}function f(m,l,p,j,n){d.beginPath();b.background(m,c.pointListToRect([].concat(l,j)));var k=h.px().pointList(l);var o=h.px().pointList(j).reverse();g.surface(k,p,o,n);d.closePath();d.fill();}function i(j,m,p,k,n){d.beginPath();b.line(j);var l=h.px().pointList(m);var o=h.px().pointList(k).reverse();g.surface(l,p,o,n);d.closePath();d.stroke();}}function mCR_exportChartPaintCanvasCurvePath(d){this.line=function(h,i){b(h[0]);f(h,i);};this.surface=function(i,k,h,j){b(i[0]);f(i,k);a(h[0]);f(h,j);};function f(h,i){if(i!=0&&2<h.length){var j=new mCR_exportChartPaintCatmullRomSpline(h,i);g(h,j.controlPoints);}else{c(h);}}function g(o,h){var q,n,m,p;var l=0,k=0;for(l=0;l<o.length-1;l++){q=o[l];n=h[k++];m=h[k++];p=o[l+1];d.bezierCurveTo(n.x,n.y,m.x,m.y,p.x,p.y);}}function c(j){var l,k;var h=0;for(h=0;h<j.length-1;h++){l=j[h];k=j[h+1];d.lineTo(k.x,k.y);}}function b(h){d.moveTo(h.x,h.y);}function a(h){d.lineTo(h.x,h.y);}}var mCR_exportChartPaintCanvasPie=function(d,c,k){this.pie=function(o,y,u,t,w,r){var p=u;var x=k.px().rect1(u);var s=k.px().value(r);if(0<r){var q=new mCR_exportChartUtilPie(x);var v=q.slice(t,w,s);b(v,x,t,t+w,q.holeRect(s));}else{g(x,t,t+w);}m(o,p);h(y);};function m(p,o){if(!p){return;}d.background(p,o);c.fill();}function h(o){if(!o){return;}d.line(o);c.stroke();}function b(w,u,r,o,x){c.beginPath();var t=new mCR_exportChartUtilRectangle(u).centerMid();var s=a(u);var p=f(u);n(t.x,t.y,s,p,r,o,true);c.lineTo(w.inner.end.x,w.inner.end.y);var q=a(x);var v=f(x);n(t.x,t.y,q,v,o,r,false);c.closePath();}function g(s,r,q){c.beginPath();var t=new mCR_exportChartUtilRectangle(s).centerMid();var o=a(s);var p=f(s);n(t.x,t.y,o,p,r,q,true);c.lineTo(t.x,t.y);c.closePath();}function l(o,s,r,q,p){exportChartLog.log("startAngle:"+q+","+j(q)+"/endAngle:"+p+","+j(p));c.beginPath();c.arc(o,s,r,j(q),j(p),true);c.stroke();}function n(o,u,t,s,r,p,q){c.save();c.translate(o-t,u-s);c.scale(t,s);c.arc(1,1,1,j(r),j(p),q);c.restore();}function a(o){return(o.right-o.left)*0.5;}function f(o){return(o.bottom-o.top)*0.5;}function j(o){return i(o)*Math.PI/180;}function i(o){return 360-(o%360);}};var mCR_exportChartPaintCanvasArcFace=function(d,a,h){this.arcFace=function(m,k,n,l){a.beginPath();f(n);i(m,l);g(k);};function f(k){k.map(function(m,l){var n=h.px().rect1(m.rect);b(l,c(n,m.startAngle));j(n,m.startAngle,m.endAngle,m.startAngle<m.endAngle);});}function c(k,l){return new mCR_exportChartUtilEllipse(k).point(l);}function b(l,k){if(l==0){a.moveTo(k.x,k.y);}else{a.lineTo(k.x,k.y);}}function j(o,m,k,l){var n=new mCR_exportChartPaintCanvasEllipseTool(a);n.arc(o,m,k,l);}function i(l,k){if(!l){return;}d.background(l,k);a.fill();}function g(k){if(!k){return;}d.line(k);a.stroke();}};function mCR_exportChartPaintCanvasEllipseTool(a){this.arc=function(n,m,k,l){var o=h(n);var i=f(n);var j=b(n);c(o.x,o.y,i,j,m,k,l);};function c(i,o,n,m,l,j,k){a.save();a.translate(i-n,o-m);a.scale(n,m);a.arc(1,1,1,g(l),g(j),k);a.restore();}function h(i){return new mCR_exportChartUtilRectangle(i).centerMid();}function f(i){return(i.right-i.left)*0.5;}function b(i){return(i.bottom-i.top)*0.5;}function g(i){return d(i)*Math.PI/180;}function d(i){return 360-(i%360);}}function mCR_exportChartPaintSvg(g,p,k){var b=new mCR_exportChartClipDocument(g.objDocument);var t=new mCR_exportChartPaintCoordinateTranslate({x:k.left,y:k.top});var h=new mCR_exportChartPaintUnitType();var q=new mCR_exportChartPaintSvgDefs();var r=new mCR_exportChartPaintSvgBackground(q,h);var n=new mCR_exportChartPaintSvgClip(q,h,k);var i=new mCR_exportChartPaintSvgClipExport(g,p,q,n,r);var l=new mCR_exportChartPaintSvgStyle(i,h);var j=new mCR_exportChartPaintSvgRectangle(l,i,h);var o=new mCR_exportChartPaintSvgCircle(l,i,h);var m=new mCR_exportChartPaintSvgEllipse(l,i,h);var a=new mCR_exportChartPaintSvgLine(l,i,h);var c=new mCR_exportChartPaintSvgText(i,h);var v=new mCR_exportChartPaintSvgPolygon(l,i,h);var f=new mCR_exportChartPaintSvgCurve(l,i,h);var s=new mCR_exportChartPaintSvgPie(l,i,h);var u=new mCR_exportChartPaintSvgArcFace(l,i,h);var d=new mCR_exportChartPaintSvgImage(q,i,h);this.rectangle=function(x,w,y){x=b.background(x);w=b.line(w);y=t.rect(y);j.rectangle(x,w,y);};this.circle=function(x,w,y){x=b.background(x);w=b.line(w);y=t.rect(y);o.paint(x,w,y);};this.ellipse=function(x,w,y){x=b.background(x);w=b.line(w);y=t.rect(y);m.paint(x,w,y);};this.imageBinary=function(x,w){w=t.rect(w);d.binary(x,w);};this.line=function(x,y,w){x=b.line(x);y=t.point(y);w=t.point(w);a.line(x,y,w);};this.text=function(w,y,z,B,A,x){w=b.font(w);y=b.textOption(y);z=t.rect(z);c.text(w,y,z,B,A,x);};this.polygon=function(z,x,w,y){z=b.background(z);x=b.line(x);w=t.pointList(w);y=y?t.rect(y):y;v.polygon(z,x,w,y);};this.curveLine=function(x,w,y){x=b.line(x);w=t.pointList(w);f.line(x,w,y);};this.curveSurface=function(z,w,y,C,x,A,B){z=b.background(z);w=b.line(w);y=t.pointList(y);x=t.pointList(x);f.surface(z,w,y,C,x,A,B);};this.pie=function(z,x,B,y,w,A){z=b.background(z);x=b.line(x);B=t.rect(B);s.pie(z,x,B,y,w,A);};this.arcFace=function(y,w,z,x){y=b.background(y);w=b.line(w);z.map(function(A){A.rect=t.rect(A.rect);});x=x?t.rect(x):x;u.arcFace(y,w,z,x);};this.beginClip=function(w){w=t.rect(w);n.begin(w);};this.endClip=function(){n.end();};this.defaultClip=function(){n.defaultt();};}function mCR_exportChartPaintSvgDefs(){var a=document.createElementNS("http://www.w3.org/2000/svg","defs");a.setAttribute("id","clip");return a;}function mCR_exportChartPaintSvgBackground(f,b){this.radialIn=function(h,i,j){var l=c();var k=g(l,j);d(k,i);f.appendChild(k);h.setAttribute("fill","url(#"+l+")");};function d(i,h){i.appendChild(a(0,h.gradientEndColor));i.appendChild(a(100,h.gradientStartColor));}function a(j,h){var i=document.createElementNS("http://www.w3.org/2000/svg","stop");i.setAttribute("offset",j+"%");i.setAttribute("stop-color",mCR_getStrColor(h));return i;}function g(l,j){var k=document.createElementNS("http://www.w3.org/2000/svg","radialGradient");k.setAttribute("id",l);var h=b.cm().ellipse(j);var i=h.rx<h.ry?h.ry:h.rx;k.setAttribute("cx",h.cx+"cm");k.setAttribute("cy",h.cy+"cm");k.setAttribute("r",i+"cm");k.setAttribute("gradientUnits","userSpaceOnUse");k.setAttribute("spreadMethod","pad");return k;}function c(){return"grad"+mCR_UUID();}}function mCR_exportChartPaintSvgClip(b,g,i){var a="";var c="";this.begin=function(l){a=k();j(a,h(l));};this.defaultt=function(){if(c==""){c=k();j(c,h(i));}a=c;};this.end=function(){a="";};this.applyClip=function(l){if(a==""){return;}l.setAttribute("clip-path","url(#"+a+")");};function h(l){var m=g.cm().rect2(l);return d(m);}function d(m){var l=document.createElementNS("http://www.w3.org/2000/svg","rect");l.setAttribute("x",m.x+"cm");l.setAttribute("y",m.y+"cm");l.setAttribute("width",m.width+"cm");l.setAttribute("height",m.height+"cm");return l;}function k(){return"clip"+mCR_UUID();}function j(n,l){var m=f(n);m.appendChild(l);b.appendChild(m);}function f(m){var l=document.createElementNS("http://www.w3.org/2000/svg","clipPath");l.setAttribute("id",m);return l;}}function mCR_exportChartPaintSvgClipExport(b,d,f,c,a){d.appendChild(f);this.appendChild=function(g){c.applyClip(g);d.appendChild(g);};this.styleBackground=function(i,h,g){if(h.gradientStyle==8){a.radialIn(g,h,i);}else{b.paintBackgroundStyle(i,h,g);}};this.styleFontName=function(g){return b.objDocument.getFontNameStyle(g);};}function mCR_exportChartPaintSvgStyle(a,d){this.background=function(g,h,i){if(h){a.styleBackground(i,h,g);c(g,h.alpha);}};this.line=function(h,g){if(g){f(h,b(g));c(h,g.alpha);}};function b(g){return{style:g.style,width:d.cm().value(g.width),color:g.color};}function f(h,g){if(g.style==0){h.setAttribute("stroke","none");return;}h.setAttribute("stroke",mCR_getStrColor(g.color));h.setAttribute("stroke-width",g.width+"pt");var i=g.width>100?g.width:1;switch(g.style){case 2:h.setAttribute("stroke-dasharray",(4*i)+","+(2*i));break;case 3:h.setAttribute("stroke-dasharray",(1.333*i)+","+(1.333*i));break;case 4:h.setAttribute("stroke-dasharray",(4*i)+","+(2*i)+","+(1.333*i)+","+(2*i));break;case 5:h.setAttribute("stroke-dasharray",(4*i)+","+(2*i)+","+(1.333*i)+","+(2*i)+","+(1.333*i)+","+(2*i));break;case 7:case 9:h.setAttribute("stroke-width",g.width*1.5+"pt");break;case 11:h.setAttribute("stroke-dasharray",(4*5/3*i)+","+(4*i));break;}}function c(g,h){g.setAttribute("opacity",(h/255));}}function mCR_exportChartPaintSvgRectangle(b,a,c){this.rectangle=function(i,f,h){var j=c.cm().rect2(h);var g=d(j);b.background(g,i,h);b.line(g,f);a.appendChild(g);};function d(g){var f=document.createElementNS("http://www.w3.org/2000/svg","rect");f.setAttribute("x",g.x+"cm");f.setAttribute("y",g.y+"cm");f.setAttribute("width",g.width+"cm");f.setAttribute("height",g.height+"cm");return f;}}function mCR_exportChartPaintSvgCircle(b,a,d){this.paint=function(j,f,i){var h=d.cm().circle(i);var g=c(h);b.background(g,j,i);b.line(g,f);a.appendChild(g);};function c(g){var f=document.createElementNS("http://www.w3.org/2000/svg","circle");f.setAttribute("cx",g.cx+"cm");f.setAttribute("cy",g.cy+"cm");f.setAttribute("r",g.r+"cm");return f;}}function mCR_exportChartPaintSvgEllipse(b,a,c){this.paint=function(i,f,h){var j=c.cm().ellipse(h);var g=d(j);b.background(g,i,h);b.line(g,f);a.appendChild(g);};function d(g){var f=document.createElementNS("http://www.w3.org/2000/svg","ellipse");f.setAttribute("cx",g.cx+"cm");f.setAttribute("cy",g.cy+"cm");f.setAttribute("rx",g.rx+"cm");f.setAttribute("ry",g.ry+"cm");return f;}}function mCR_exportChartPaintSvgImage(b,a,i){this.binary=function(p,o){var m=i.cm().rect2(o);var n=k(m,p);a.appendChild(n);};function k(m,o){var q=c();l(q,o.dataBinary);d(q,m,o.drawMethod);var r=j();var p=h(m,r);p.appendChild(q);b.appendChild(p);var n=g(m);f(n,r);return n;}function f(m,n){m.setAttribute("fill","url(#"+n+")");}function c(){return document.createElementNS("http://www.w3.org/2000/svg","image");}function l(n,m){var o="data:image/png;base64,";n.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",o+m);}function d(n,m,o){if(o===1){}if(o===2){n.setAttribute("preserveAspectRatio","none");n.setAttribute("width",m.width+"cm");n.setAttribute("height",m.height+"cm");}if(o===3){n.setAttribute("preserveAspectRatio","xMidYMid");n.setAttribute("width",m.width+"cm");n.setAttribute("height",m.height+"cm");}}function j(){return"image-"+mCR_UUID();}function h(m,o){var n=document.createElementNS("http://www.w3.org/2000/svg","pattern");n.setAttribute("id",o);n.setAttribute("patternUnits","userSpaceOnUse");n.setAttribute("x",m.x+"cm");n.setAttribute("y",m.y+"cm");n.setAttribute("width",m.width+"cm");n.setAttribute("height",m.height+"cm");return n;}function g(m){var n=document.createElementNS("http://www.w3.org/2000/svg","rect");n.setAttribute("x",m.x+"cm");n.setAttribute("y",m.y+"cm");n.setAttribute("width",m.width+"cm");n.setAttribute("height",m.height+"cm");return n;}}function mCR_exportChartPaintSvgLine(b,a,c){this.line=function(g,k,j){var i=c.cm().point(k);var f=c.cm().point(j);var h=d(i,f);b.line(h,g);a.appendChild(h);};function d(h,f){var g=document.createElementNS("http://www.w3.org/2000/svg","line");g.setAttribute("x1",h.x+"cm");g.setAttribute("y1",h.y+"cm");g.setAttribute("x2",f.x+"cm");g.setAttribute("y2",f.y+"cm");return g;}}function mCR_exportChartPaintSvgText(a,m){this.text=function(t,v,w,y,x,u){exportChartLog.log("--------option");exportChartLog.log(v);var s=document.createElementNS("http://www.w3.org/2000/svg","text");r(s,v,w,x,u);f(s,t);d(s,t.color);k(s,y);a.appendChild(s);};function r(t,v,w,x,u){var s=n(w,v);c(t,s);h(t,v);o(t,w,x,u);}function c(t,s){t.setAttribute("x",m.cm().value(s.x)+"cm");t.setAttribute("y",m.cm().value(s.y)+"cm");}function n(t,s){return{x:j(t,s.horizontalAlignment),y:q(t,s.verticalAlignment)};}function j(t,s){switch(s){case 0:return t.left;case 1:return new mCR_exportChartUtilRectangle(t).center();case 2:return t.right;default:return t.left;}}function q(t,s){return t.top+(t.getHeight()*0.85);}function h(s,u){var t=g(u.horizontalAlignment);exportChartLog.log("---anchor:"+t);s.setAttribute("text-anchor",t);}function g(s){switch(s){case 0:return"start";case 1:return"middle";case 2:return"end";default:return"start";}}function o(t,v,w,u){var s={0:i,1:l,2:b,3:b};s[u](t,v,w);}function i(){}function l(s,t,u){}function b(s,t,u){s.setAttribute("transform","rotate("+(-u)+","+m.px().value(t.left)+","+m.px().value(t.top)+")");}function f(t,s){if(!s){return;}if(s.bold){t.setAttribute("font-weight","bold");}if(s.italic){t.setAttribute("font-style","italic");}t.setAttribute("font-family",p(s));t.setAttribute("font-size",(s.size)+"pt");}function d(t,s){t.setAttribute("fill",mCR_getStrColor(s));}function k(s,t){s.textContent=t;}function p(s){return a.styleFontName(s.nameEngIndex)+","+a.styleFontName(s.nameIndex);}}function mCR_exportChartPaintSvgPolygon(b,a,c){this.polygon=function(j,g,f,i){var h=document.createElementNS("http://www.w3.org/2000/svg","polygon");h.setAttribute("points",d(f));if(i){exportChartLog.log("gradient rect");b.background(h,j,i);}else{b.background(h,j,this.pointListToRect(f));}b.line(h,g);a.appendChild(h);};function d(f){var g="";f.map(function(h,i){g+=(c.px().value(h.x)+" "+c.px().value(h.y));if(i!=(f.length-1)){g+=",";}});return g;}this.pointListToRect=function(f){var g=new docRect();if(0<f.length){g.left=f[0].x;g.top=f[0].y;g.right=f[0].x;g.bottom=f[0].y;}f.map(function(h){g.left=h.x<g.left?h.x:g.left;g.top=h.y<g.top?h.y:g.top;g.right=g.right<h.x?h.x:g.right;g.bottom=g.bottom<h.y?h.y:g.bottom;});return g;};}function mCR_exportChartPaintSvgCurve(c,b,h){var g=new mCR_exportChartPaintSvgPolygon(c,b,h);this.line=function(k,j,l){a(k,j,l);};this.surface=function(n,j,m,q,l,o,p){if(p==true){d(n,m,q,l,o);a(j,m,q);}else{var k=d(n,m,q,l,o);c.line(k,j);}};function a(k,j,m){var l=i(j,m);c.line(l,k);b.appendChild(l);return l;}function d(m,l,o,k,n){var j=f(l,o,k,n);c.background(j,m,g.pointListToRect([].concat(l,k)));b.appendChild(j);return j;}function i(j,m){var l=h.px().pointList(j);var k=new mCR_exportChartPaintSvgCurvePath();return k.line(l,m);}function f(m,p,k,n){var l=h.px().pointList(m);var o=h.px().pointList(k).reverse();var j=new mCR_exportChartPaintSvgCurvePath();return j.surface(l,p,o,n);}}function mCR_exportChartPaintSvgCurvePath(){this.line=function(h,j){var k=b(h[0]);var i=f(h,j);return d(k+i);};this.surface=function(j,o,i,k){var n=b(j[0]);var m=f(j,o);var l=a(i[0]);var h=f(i,k);return d(n+m+l+h+" Z");};function b(h){return" M"+h.x+" "+h.y+" ";}function a(h){return" L"+h.x+" "+h.y+" ";}function f(h,i){if(i!=0&&2<h.length){var j=new mCR_exportChartPaintCatmullRomSpline(h,i);return g(h,j.controlPoints);}else{return c(h);}}function g(p,r){var h="";var q,m,l,o;var n=0,k=0;for(n=0;n<p.length-1;n++){q=p[n];m=r[k++];l=r[k++];o=p[n+1];h+=" C "+m.x+" "+m.y+" "+l.x+" "+l.y+" "+o.x+" "+o.y;}return h;}function c(j){var l="";var m,k;var h=0;for(h=0;h<j.length-1;h++){m=j[h];k=j[h+1];l+=" L"+k.x+" "+k.y;}return l;}function d(i){var h=document.createElementNS("http://www.w3.org/2000/svg","path");h.setAttribute("d",i);return h;}}function mCR_exportChartPaintSvgPie(d,a,i){this.pie=function(o,l,q,n,k,p){var m=f(i.px().rect1(q),n,k,i.px().value(p));d.background(m,o,q);d.line(m,l);a.appendChild(m);};function f(q,o,k,p){var m=new mCR_exportChartUtilPie(q,p);var r=m.slice(o,k,p);var l;if(0<p){l=j(r,q,k,m.holeRect(p));}else{l=h(r,q,k);}var n=document.createElementNS("http://www.w3.org/2000/svg","path");n.setAttribute("d",l);return n;}function h(q,m,k){var l=g(q.outer.start);var o=c(m,k,q.outer.end);var n=b(q.inner.end);var p=" Z";return l+o+n+p;}function j(o,r,p,l){var s=g(o.outer.start);var k=c(r,p,o.outer.end);var m=b(o.inner.end);var n=c(l,-p,o.inner.start);var q=" Z";return s+k+m+n+q;}function c(q,m,l){var k=(q.right-q.left)*0.5;var n=(q.bottom-q.top)*0.5;var o=0;var r=(Math.abs(m)<180)?0:1;var p=(-1<m)?0:1;return" A"+k+" "+n+" "+o+" "+r+" "+p+" "+l.x+" "+l.y+" ";}function g(k){return" M"+k.x+" "+k.y+" ";}function b(k){return" L"+k.x+" "+k.y+" ";}}function mCR_exportChartPaintSvgArcFace(d,a,g){this.arcFace=function(n,k,o,l){var m=j(o);d.background(m,n,l);d.line(m,k);a.appendChild(m);};function j(l){var m=h(l);var k=document.createElementNS("http://www.w3.org/2000/svg","path");k.setAttribute("d",m);return k;}function h(k){var l="";k.map(function(n,m){l+=i(n,m);});l+=" Z";return l;}function i(m,k){var o="";var n=g.px().rect1(m.rect);var l=new mCR_exportChartUtilEllipse(n);if(k==0){o+=f(l.point(m.startAngle));}else{o+=c(l.point(m.startAngle));}o+=b(n,m.sweepAngle,l.point(m.endAngle));return o;}function f(k){return" M"+k.x+" "+k.y+" ";}function c(k){return" L"+k.x+" "+k.y+" ";}function b(q,m,l){var k=(q.right-q.left)*0.5;var n=(q.bottom-q.top)*0.5;var o=0;var r=(Math.abs(m)<180)?0:1;var p=(-1<m)?0:1;return" A"+k+" "+n+" "+o+" "+r+" "+p+" "+l.x+" "+l.y+" ";}}function mCR_exportChartDocument(l){var m=new mCR_exportChartDocumentCoordinate();function b(n){return !n?{}:{rect:m.rect(n[1]),shapePanel:n[2],shapeLabel:n[3]};}function k(n){return !n?{}:{rect:m.rect(n[1]),shapeLegend:n[2]};}function c(n){return !n?null:{type:n[1],rect:m.rect(n[2]),XYAxis:a(n[3]),radar:g(n[4]),seriesGroupList:i(n[5],j)};}function a(n){return !n?null:{shapeListWall:n[1],shapeListAxis:n[2],vertical:n[3]};}function g(n){return !n?null:{shapeList:n[1]};}function j(n){return !n?null:{seriesList:i(n[1],f),frontRect:m.rect(n[2]),rearRect:m.rect(n[3])};}function f(n){return !n?null:{type:n[1],seriesItemList:i(n[2],h),typeName:n[3]};}function h(n){return !n?null:{rect:m.rect(n[1]),point:m.point(n[2]),shapeList:n[3],pointList:n[4],markList:n[5]};}function i(o,n){return d(o,n);}function d(p,n){if(!p){return[];}var o=[];p.map(function(q){o.push(n(q));});return o;}return{rect:m.rect(l[1]),panel:b(l[2]),legend:k(l[3]),frameList:i(l[4],c)};}function mCR_exportChartDocumentShape(l){var n=new mCR_exportChartDocumentCoordinate();var f=new mCR_exportChartDocumentElement();function b(o){return{type:o[1],background:f.background(o[2]),image:f.image(o[3]),line:f.line(o[4]),rect:n.rect(o[5]),rectangleType:o[6]};}function d(o){return{type:o[1],background:f.background(o[2]),image:f.image(o[3]),line:f.line(o[4]),rect:n.rect(o[5]),startAngle:o[6],slice:o[7]};}function j(o){return{type:o[1],background:f.background(o[2]),image:f.image(o[3]),line:f.line(o[4]),pointList:n.pointList(o[5])};}function k(o){return{type:o[1],line:f.line(o[2]),start:n.point(o[3]),end:n.point(o[4])};}function h(o){return{type:o[1],line:f.line(o[2]),pointList:n.pointList(o[3]),tension:o[4]};}function a(o){return{type:o[1],background:f.background(o[2]),image:f.image(o[3]),line:f.line(o[4]),rect:n.rect(o[5]),barType:o[6],sideLightness:o[7],edgeLightness:o[8],diagonal3D:o[9],dimensionAngle3D:o[10],enable3D:o[11],direct:o[12],origin:o[13],dur:o[14]};}function c(o){return{type:o[1],background:f.background(o[2]),image:f.image(o[3]),line:f.line(o[4]),point:n.point(o[5]),pointType:o[6],size:o[7]};}function m(o){return{type:o[1],background:f.background(o[2]),image:f.image(o[3]),line:f.line(o[4]),rect:n.rect(o[5]),startAngle:o[6],sweepAngle:o[7],depth:o[8],holeWidth:o[9],sideLightness:o[10]};}function g(o){return{type:o[1],background:f.background(o[2]),image:f.image(o[3]),line:f.line(o[4]),rect:n.rect(o[5]),point:n.point(o[6]),font:o[7],option:o[8],text:decodeURIComponent(o[9]),angle:o[10],axisIndex:o[11],rotate:o[12]};}function i(o){return{type:o[1],background:f.background(o[2]),image:f.image(o[3]),line:f.line(o[4]),topPointList:n.pointList(o[5]),topTension:o[6],bottomPointList:n.pointList(o[7]),bottomTension:o[8],lineTopOnly:o[9]};}return{0:b,1:d,2:j,3:k,4:h,5:a,6:c,7:m,8:g,9:i}[l[1]](l);}function mCR_exportChartDocumentCoordinate(){this.rect=function(a){return !a?null:{left:a[1],top:a[2],right:a[3],bottom:a[4]};};this.point=function(a){return !a?null:{x:a[1],y:a[2]};};this.pointList=function(a){var b=this;var c=[];a.map(function(d){c.push(b.point(d));});return c;};}function mCR_exportChartDocumentElement(){this.background=function(b){return !b?null:{styleKey:b[1],gradientStartLightness:b[2],gradientEndLightness:b[3],lightness:0,alpha:b[4]};};this.image=function(b){return{};};this.line=function(b){return !b?null:{styleKey:b[1],alpha:b[2]};};function a(b){return !b?null:b.replace(/_/g,"/").replace(/-/g,"+");}}function mCR_exportChartClipDocument(a){var b=new mCR_exportChartClipDocumentLightness();this.background=function(c){if(!c){return c;}var d=a.getBackgroundStyle(c.styleKey);if(d.backStyle==1&&d.gradientStyle!=0){d.backStyle=0;}d=b.background(d,c.gradientStartLightness,c.gradientEndLightness,c.lightness,c.type);d.alpha=c.alpha;return d;};this.line=function(c){if(!c){return c;}var d=a.getLineStyle(c.styleKey);d.alpha=c.alpha;return d;};this.font=function(c){return a.getFontStyle(c);};this.textOption=function(c){return a.getTextOptionStyle(c);};}function mCR_exportChartClipDocumentLightness(){var f=new mCR_exportChartShapeColorCorrection();this.background=function(j,g,h,k,i){j=d(j);c(j,k);a(j,g);b(j,h,i);return j;};function c(g,h){if(h!=0){g.backColor=f.bright(g.backColor,h);g.fillColor=f.bright(g.fillColor,h);g.gradientStartColor=f.bright(g.gradientStartColor,h);g.gradientEndColor=f.bright(g.gradientEndColor,h);}}function a(h,g){if(g!=0){h.gradientStartColor=f.bright(h.gradientStartColor,g);}}function b(i,g,h){if(g!=0){if(h=="side"){i.gradientEndColor=f.bright(i.gradientStartColor,g);}else{i.gradientEndColor=f.bright(i.gradientEndColor,g);}}}function d(h){if(h===null||typeof(h)!=="object"){return h;}var g={};Object.keys(h).map(function(i){if(h.hasOwnProperty(i)){g[i]=h[i];}});return g;}}function mCR_exportChartShapeColorCorrection(){this.bright=function(j,k){if(k==0){return j;}if(d(k)){return f(j,k);}else{return i(j,k);}};function d(j){return j<0;}function f(k,l){var n=h(k);var m=a(k);var j=g(k);n=(n+(n*l));m=(m+(m*l));j=(j+(j*l));return b(n,m,j);}function i(l,m){var o=h(l);var n=a(l);var j=g(l);var k=255;o=(o+(c(k,o)*m));n=(n+(c(k,n)*m));j=(j+(c(k,j)*m));return b(o,n,j);}function c(k,j){return(j==0)?0:k%j;}function h(j){return(j&255);}function a(j){return((j>>8)&255);}function g(j){return((j>>16)&255);}function b(l,k,j){return(j<<16)|(k<<8)|(l);}}function mCR_exportChartPaintCoordinateTranslate(a){this.rect=function(b){var c=new docRect();c.left=b.left+a.x;c.top=b.top+a.y;c.right=b.right+a.x;c.bottom=b.bottom+a.y;return c;};this.point=function(b){return{x:b.x+a.x,y:b.y+a.y};};this.pointList=function(b){var c=this;var d=[];b.map(function(f){d.push(c.point(f));});return d;};}function mCR_exportChartPaintUnit(){this.cm=function(a){return(a*0.01);};this.px=function(b){var a=96;return b*a/254;};}var mCR_exportChartPaintUnitType=function(){var a=new mCR_exportChartPaintUnit();var b=function(c){return c;};this.cm=function(){b=a.cm;return this;};this.px=function(){b=a.px;return this;};this.rect1=function(c){return{left:b(c.left),top:b(c.top),right:b(c.right),bottom:b(c.bottom)};};this.rect2=function(c){return{x:b(c.left),y:b(c.top),width:b(c.right-c.left),height:b(c.bottom-c.top)};};this.circle=function(c){var d=(c.right-c.left)*0.5;return{cx:b(c.left+d),cy:b(c.top+d),r:b(d)};};this.ellipse=function(c){var f=(c.right-c.left)*0.5;var d=(c.bottom-c.top)*0.5;return{cx:b(c.left+f),cy:b(c.top+d),rx:b(f),ry:b(d)};};this.point=function(c){return{x:b(c.x),y:b(c.y)};};this.pointList=function(d){var c=[];d.map(function(f){c.push({x:b(f.x),y:b(f.y)});});return c;};this.value=function(c){return b(c);};};function mCR_exportChartPaintCatmullRomSpline(d,b){function f(){var o=[];var v=[];var l=[];var r=a(d);if(r.length<3){return;}var m=(b*0.5)/0.9;var n=r[r.length-2];var q=r[r.length-1];r.push(h(q,i(q,n)));var t=h(r[0],i(r[0],r[1]));var s=r[0];var p=null;var k;for(k=0;k<r.length-1;k++){p=r[k+1];var u=c(m*g(i(t,s)),i(t,p));o.push(u);v.push(h(s,u));var j=c(m*g(i(p,s)),i(p,t));l.push(j);v.push(h(s,j));t=s;s=p;}v.shift();v.pop();return v;}function i(k,j){return{x:k.x-j.x,y:k.y-j.y};}function g(j){return Math.sqrt(j.x*j.x+j.y*j.y);}function c(l,j){var k=l/g(j);return{x:j.x*k,y:j.y*k};}function h(k,j){return{x:k.x+j.x,y:k.y+j.y};}function a(k){var j=[];k.map(function(l){j.push(l);});return j;}this.controlPoints=f();}function mCR_exportChartSeriesPie(m){var b={bottom:[],wall:[],top:[]};var k=new mCR_exportChartUtilRectangle({left:0,top:0,right:0,bottom:0});this.add=function(v){if(v.depth==0){n(v);}else{u(v);}};function n(v){b.bottom.push(v);}function u(v){c(v);p(v);h(v);}function c(v){v=o(v);v.rect=j(v.rect,v.depth);b.bottom.push(v);}function j(v,w){return{left:v.left,top:v.top+w,right:v.right,bottom:v.bottom};}function q(x,y){var w=d(x,y);var v=j(x,y);k=k.union(w).union(v);}function p(w){w=o(w);w.background=o(w.background);w.background.lightness=w.sideLightness;q(w.rect,w.depth);var x=d(w.rect,w.depth);var v=j(w.rect,w.depth);t(w,x,v);s(w,x,v);}function t(y,z,v){var A=f(y,z,v);A.map(function(C){b.wall.push(C);});exportChartLog.log("outer");exportChartLog.log(A);var x=l(z,y.holeWidth);var B=l(v,y.holeWidth);var w=f(y,x,B);w.map(function(C){b.wall.push(C);});exportChartLog.log("inner");exportChartLog.log(w);}function l(v,w){return mCR_exportChartUtilPie(v).holeRect(w);}function f(A,y,w){var z=A.startAngle;var E=A.sweepAngle;var x=z+E;function D(I){var K=new mCR_exportChartUtilEllipse(I.rect);var J=K.point(I.startAngle);var H=K.point(I.endAngle);return(J.y>H.y)?H.y:J.y;}function C(H,I){return{key:H,value:{background:A.background,line:A.line,type:"arc",value:I}};}function G(){var K=g(y,z,E);var I=g(w,x,-E);var J=(z<270&&270<x)?w.bottom:D(K);var H=C(J,[K,I]);return[H];}function F(){var J=[];var P=360-z;var T=g(y,z,P);var V=g(w,360,-P);var aa=P<=90?D(T):w.bottom;var L=C(aa,[T,V]);J.push(L);var O=x-360;if(O<=180){var R=g(y,0,O);var U=g(w,O,-O);var Z=O<=90?D(R):y.top;var I=C(Z,[R,U]);J.push(I);}else{var W=g(y,0,180);var X=g(w,180,-180);var M=y.top;var K=C(M,[W,X]);J.push(K);var N=x-(360+180);var Q=g(y,180,N);var S=g(w,x,-N);var Y=N<=90?D(Q):w.bottom;var H=C(Y,[Q,S]);J.push(H);}return J;}function B(){var K=g(y,z,E);var I=g(w,x,-E);var J=(z<90&&90<x)?y.top:D(K);var H=C(J,[K,I]);return[H];}function v(){var J=[];var P=180-z;var T=g(y,z,P);var V=g(w,180,-P);var aa=P<=90?D(T):y.top;var L=C(aa,[T,V]);J.push(L);var O=x-180;if(O<=180){var R=g(y,180,O);var U=g(w,180+O,-O);var Z=O<=90?D(R):w.bottom;var I=C(Z,[R,U]);J.push(I);}else{var W=g(y,180,180);var X=g(w,360,-180);var M=w.bottom;var K=C(M,[W,X]);J.push(K);var N=x-360;var Q=g(y,0,N);var S=g(w,N,-N);var Y=N<=90?D(Q):y.top;var H=C(Y,[Q,S]);J.push(H);}return J;}if(180<=z){if(x<=360){return G();}else{return F();}}else{if(x<=180){return B();}else{return v();}}}function g(x,w,v){return{rect:x,startAngle:w,sweepAngle:v,endAngle:w+v};}function s(y,z,w){var A=new mCR_exportChartUtilPie(z).slice(y.startAngle,y.sweepAngle,y.holeWidth);var x=new mCR_exportChartUtilPie(w).slice(y.startAngle,y.sweepAngle,y.holeWidth);var v=r(A.outer.start,A.inner.start,x.inner.start,x.outer.start,y.background,y.line);b.wall.push(v);var B=r(A.outer.end,A.inner.end,x.inner.end,x.outer.end,y.background,y.line);b.wall.push(B);}function r(w,C,A,z,y,v){var B=[w,C,A,z];var x=Math.min(w.y,C.y);return{key:x,value:{background:y,line:v,type:"path",path:B}};}function h(v){v=o(v);v.rect=d(v.rect,v.depth);b.top.push(v);}function d(v,w){return{left:v.left,top:v.top,right:v.right,bottom:v.bottom-w};}this.exportt=function(){b.bottom.map(function(v){a(v);});b.wall.sort(function(w,v){return w.key-v.key;});b.wall.map(function(v){i(v.value);});b.top.map(function(v){a(v);});};function i(v){if(v.type=="path"){m.polygon(v.background,v.line,v.path,k);}else{if(v.type=="arc"){m.arcFace(v.background,v.line,v.value,k);}}}function a(w){var v=360<=w.sweepAngle?359.9:w.sweepAngle;m.pie(w.background,w.line,w.rect,w.startAngle,v,w.depth,w.holeWidth,w.sideLightness);}function o(w){if(w===null||typeof(w)!=="object"){return w;}var v={};Object.keys(w).map(function(x){if(w.hasOwnProperty(x)){v[x]=w[x];}});return v;}}function mCR_exportChartShapeBar(c){this.paint=function(i){var h={0:b,1:g,2:a,3:d,4:f};h[i.barType](i);};function b(h){var i=new mCR_exportChartShapeBarRectangle(c);i.paint(h);}function g(h){}function a(h){}function d(h){}function f(h){}}function mCR_exportChartShapeBarRectangle(b){var c=new mCR_exportChartUtilTrigonometry();this.paint=function(t){if(t.enable3D==true){o(t);}else{j(t);}};function j(t){b.rectangle(t.background,t.line,t.rect);}function o(u){var t=q(u.rect);var v=p(u.rect,u.diagonal3D,u.dimensionAngle3D);f(u.line,t,v,u.dimensionAngle3D);m(u.background,t,v,u.dimensionAngle3D,u.sideLightness);s(u.background,t);a(u.line,t,v,u.dimensionAngle3D);}function q(t){return mCR_exportChartUtilRectangle({left:t.left,top:t.top,right:t.right,bottom:t.bottom});}function p(u,w,v){var t=c.cosSin(w,v);return mCR_exportChartUtilRectangle({left:u.left+t.width,top:u.top-t.height,right:u.right+t.width,bottom:u.bottom-t.height});}function f(u,t,w,v){if(v<=90){b.line(u,w.leftTop(),w.leftBottom());b.line(u,t.leftBottom(),w.leftBottom());b.line(u,w.rightBottom(),w.leftBottom());}else{b.line(u,w.rightTop(),w.rightBottom());b.line(u,t.rightBottom(),w.rightBottom());b.line(u,w.leftBottom(),w.rightBottom());}}function m(w,u,y,x,t){w.lightness=t;w.type="side";var v=i(u,y);d(w,u,y,v,x);n(w,u,y,v);}function i(t,u){return t.union(u);}function d(v,t,y,u,x){var w=g(t,y,x);b.irregularPolygon(v,null,w,u);}function g(t,w,v){var u=[];if(v<=90){u.push(t.rightTop());u.push(w.rightTop());u.push(w.rightBottom());u.push(t.rightBottom());}else{u.push(w.leftTop());u.push(t.leftTop());u.push(t.leftBottom());u.push(w.leftBottom());}return u;}function n(v,t,x,u){var w=r(t,x);b.irregularPolygon(v,null,w,u);}function r(t,v){var u=[];u.push(v.leftTop());u.push(v.rightTop());u.push(t.rightTop());u.push(t.leftTop());return u;}function s(t,u){t.lightness=0;t.type="normal";b.rectangle(t,null,u);}function a(u,t,w,v){h(u,t,w);k(u,t,w,v);l(u,t,w,v);}function h(u,t,v){b.line(u,v.leftTop(),v.rightTop());b.line(u,v.rightTop(),t.rightTop());b.line(u,t.rightTop(),t.leftTop());b.line(u,t.leftTop(),v.leftTop());}function k(u,t,w,v){if(v<=90){b.line(u,t.leftTop(),t.leftBottom());b.line(u,t.rightTop(),t.rightBottom());b.line(u,w.rightTop(),w.rightBottom());}else{b.line(u,w.leftTop(),w.leftBottom());b.line(u,t.leftTop(),t.leftBottom());b.line(u,t.rightTop(),t.rightBottom());}}function l(u,t,w,v){if(v<=90){b.line(u,t.leftBottom(),t.rightBottom());b.line(u,t.rightBottom(),w.rightBottom());}else{b.line(u,w.leftBottom(),t.leftBottom());b.line(u,t.leftBottom(),t.rightBottom());}}}function mCR_exportChartShapePaint(c){this.rectangle=function(i,h,j){if(!i&&!h){return;}if(f(j)){var k=b(j);a(h,k.start,k.end);}else{c.rectangle(i,h,j);}};this.circle=function(i,h,j){if(!i&&!h){return;}if(f(j)){var k=b(j);a(h,k.start,k.end);}else{c.circle(i,h,j);}};this.ellipse=function(i,h,j){if(!i&&!h){return;}if(f(j)){var k=b(j);a(h,k.start,k.end);}else{c.ellipse(i,h,j);}};this.image=function(i,h){if(!i&&!f(h)){return;}if(i.drawMethod===0){return;}if(i.dataType===1&&i.dataBinary){c.imageBinary(i,h);}};this.line=function(i,j,h){a(i,j,h);};this.text=function(h,j,k,m,l,i){c.text(h,j,k,m,l,i);};this.regularPolygon=function(k,i,l,j,m){if(m<3){return;}var h=d(l,j,m);this.polygon(k,i,h);};function d(m,l,o){var j=new mCR_exportChartUtilEllipse(m);var i=new mCR_exportSVGChartUtilCircularIterator(l,-1);var p=(360/o);var h=[];var n=0;for(n=0;n<o;n++){var k=j.point(i.current());h.push(k);i.next(p);}return h;}this.irregularPolygon=function(k,i,h,j){if(h.length==0){return;}this.polygon(k,i,h,j);};this.polygon=function(k,i,h,j){c.polygon(k,i,h,j);};this.curveLine=function(i,h,j){c.curveLine(i,h,j);};this.curveSurface=function(k,h,j,n,i,l,m){if(j.length<2){return;}if(i.length<2){return;}c.curveSurface(k,h,j,n,i,l,m);};this.pie=function(l,j,n,k,h,o,m,i){c.pie(l,j,n,k,h,m);};this.arcFace=function(j,h,k,i){if(!j&&!h){return;}c.arcFace(j,h,k,i);};function f(h){return((h.right-h.left)==0||(h.bottom-h.top)==0);}function g(i,h){return(i.x==h.x&&i.y==h.y);}function a(i,j,h){if(!i){return;}if(g(j,h)){return;}c.line(i,j,h);}function b(h){return{start:{x:h.left,y:h.top},end:{x:h.right,y:h.bottom}};}this.beginClip=function(h){if(!h){return;}if(f(h)){return;}c.beginClip(h);};this.endClip=function(){c.endClip();};this.defaultClip=function(){c.defaultClip();};}function mCR_exportChartShapePoint(m){this.paint=function(p){var o={0:n,1:b,2:g,3:d,4:h,5:k,6:l,7:j,8:i,9:a};o[p.pointType](p);};function f(o){var p=c(o.point,o.size);m.image(o.image,p);}function n(o){var p=c(o.point,o.size);m.rectangle(o.background,o.line,p);}function b(o){var p=c(o.point,o.size);m.circle(o.background,o.line,p);}function g(o){var p=c(o.point,o.size);m.regularPolygon(o.background,o.line,p,90,3);}function d(o){var p=c(o.point,o.size);m.regularPolygon(o.background,o.line,p,270,3);}function h(o){var p=c(o.point,o.size);m.regularPolygon(o.background,o.line,p,180,3);}function k(o){var p=c(o.point,o.size);m.regularPolygon(o.background,o.line,p,0,3);}function l(o){var p=c(o.point,o.size);p=mCR_exportChartUtilRectangle(p);m.line(o.line,p.centerTop(),p.centerBottom());m.line(o.line,p.leftMid(),p.rightMid());}function j(o){var p=c(o.point,o.size);p=mCR_exportChartUtilRectangle(p);m.line(o.line,p.leftTop(),p.rightBottom());m.line(o.line,p.rightTop(),p.leftBottom());}function i(o){var p=c(o.point,o.size);var q=mCR_exportChartShapePointStarPoints(p);m.polygon(o.background,o.line,q,p);}function a(o){var p=c(o.point,o.size);m.regularPolygon(o.background,o.line,p,0,4);}function c(o,p){return{left:o.x-(p/2),top:o.y-(p/2),right:o.x+(p/2),bottom:o.y+(p/2)};}}function mCR_exportChartShapePointStarPoints(d){function a(){return c(d);}function c(l){var f=new mCR_exportChartUtilEllipse(l);var i=f.point(90);var m=f.point(18);var k=f.point(306);var o=f.point(234);var g=f.point(162);var p=b(i,k,m,o,g);var h=b(m,o,g,k,g);var j=b(g,k,i,o,g);var n=b(i,o,g,m,g);var q=b(g,m,i,k,g);return[p,k,h,o,j,g,n,i,q,m];}function b(o,m,g,f,i){var n;var p;var j=(f.y-g.y)*(m.x-o.x)-(f.x-g.x)*(m.y-o.y);if(j==0){return i;}var k=(f.x-g.x)*(o.y-g.y)-(f.y-g.y)*(o.x-g.x);var l=(m.x-o.x)*(o.y-g.y)-(m.y-o.y)*(o.x-g.x);n=k/j;p=l/j;if(n<0||n>1||p<0||p>1){return i;}if(k===0&&l===0){return i;}var h={x:0,y:0};h.x=(o.x+n*(m.x-o.x));h.y=(o.y+n*(m.y-o.y));return h;}return a();}function mCR_exportSVGChartUtilCircularIterator(c,b){var a=c;this.current=function(){return a;};this.next=function(d){a=this.rotate(d);return a;};this.rotate=function(d){return((a+(d*b))+360)%360;};this.isClockwise=function(){var d=-1;return b==d;};return this;}function mCR_exportChartUtilEllipse(a){a=new mCR_exportChartUtilRectangle(a);this.point=function(c){var b=this.cosSin(c);var d=a.centerMid();return new mCR_exportChartUtilPoint(d).moveXY(b.width,-b.height);};this.cosSin=function(b){return new mCR_exportChartUtilTrigonometry().cosSinXY(a.width()/2,a.height()/2,b);};return this;}function mCR_exportChartUtilPoint(a){this.move=function(b){return this.moveXY(b,b);};this.moveXY=function(c,b){this.moveX(c);this.moveY(b);return a;};this.moveX=function(b){a.x+=b;return a;};this.moveY=function(b){a.y+=b;return a;};return this;}function mCR_exportChartUtilTrigonometry(){this.cosSin=function(a,b){return this.cosSinXY(a,a,b);};this.cosSinXY=function(c,a,b){return{width:this.cosX(c,b),height:this.sinY(a,b)};};this.cosX=function(b,a){return b*this.cos(a);};this.sinY=function(a,b){return a*this.sin(b);};this.cos=function(a){return Math.cos(this.radian(a));};this.sin=function(a){return Math.sin(this.radian(a));};this.radian=function(a){return a*Math.PI/180;};return this;}function mCR_exportChartUtilPie(a){this.holeRect=function(b){var g=new mCR_exportChartUtilRectangle(a).centerMid();var f=b/a.width()*a.height();var d=b*0.5;var c=f*0.5;return{left:g.x-d,top:g.y-c,right:g.x+d,bottom:g.y+c};};this.slice=function(f,c,b){var d={};d.inner=this.inner(f,c,b);d.outer=this.outer(f,c);return d;};this.inner=function(f,d,c){var b=new mCR_exportChartUtilEllipse(this.holeRect(c));return{start:b.point(f),end:b.point(f+d)};};this.outer=function(d,c){var b=new mCR_exportChartUtilEllipse(a);return{start:b.point(d),end:b.point(d+c)};};return this;}function mCR_exportChartUtilRectangle(b){function a(d,c){return{x:d,y:c};}b.x=function(){return b.left;};b.y=function(){return b.top;};b.width=function(){return b.right-b.left;};b.height=function(){return b.bottom-b.top;};b.center=function(){return(b.left+b.right)*0.5;};b.mid=function(){return(b.top+b.bottom)*0.5;};b.centerMid=function(){return a(b.center(),b.mid());};b.leftTop=function(){return a(b.left,b.top);};b.centerTop=function(){return a(b.center(),b.top);};b.rightTop=function(){return a(b.right,b.top);};b.rightMid=function(){return a(b.right,b.mid());};b.rightBottom=function(){return a(b.right,b.bottom);};b.centerBottom=function(){return a(b.center(),b.bottom);};b.leftBottom=function(){return a(b.left,b.bottom);};b.leftMid=function(){return a(b.left,b.mid());};b.union=function(c){return{left:b.left<c.left?b.left:c.left,top:b.top<c.top?b.top:c.top,right:b.right<c.right?c.right:b.right,bottom:b.bottom<c.bottom?c.bottom:b.bottom,union:b.union};};return b;}function docSpeechBubble(){this.tx=0;this.ty=0;this.width=220;this.height=200;this.text="";this.index=null;this.type="memoText";this.isReduceFontSize=false;this.radius=10;this.pointerSide="bottom";this.verticalAlign="top";this.horizontalAlign="left";this.marginRight=20;this.maxPointerSize=26;this.textDivMargin=15;this.fontName="나눔고딕";this.fontSize=10;this.fontBold=false;this.fontColorR=255;this.fontColorG=255;this.fontColorB=255;this.backgroundColorR=50;this.backgroundColorG=50;this.backgroundColorB=50;}docSpeechBubble.prototype.setStyle=function(d){var f=d.split(",");var c=f.length;for(var b=0;b<c;b++){var a=f[b].split(":");switch(a[0]){case"tx":this.tx=parseInt(a[1]);break;case"ty":this.ty=parseInt(a[1]);break;case"width":this.width=parseInt(a[1]);break;case"height":this.height=parseInt(a[1]);break;case"text":this.text=a[1];break;case"isReduceFontSize":this.isReduceFontSize=JSON.parse(a[1]);break;case"pointerSide":this.pointerSide=a[1];break;case"verticalAlign":this.verticalAlign=a[1];break;case"horizontalAlign":this.horizontalAlign=a[1];break;case"fontName":this.fontName=a[1];break;case"fontSize":this.fontSize=parseInt(a[1]);break;case"fontBold":this.fontBold=JSON.parse(a[1]);break;case"fontColorR":this.fontColorR=parseInt(a[1]);break;case"fontColorG":this.fontColorG=parseInt(a[1]);break;case"fontColorB":this.fontColorB=parseInt(a[1]);break;case"backgroundColorR":this.backgroundColorR=parseInt(a[1]);break;case"backgroundColorG":this.backgroundColorG=parseInt(a[1]);break;case"backgroundColorB":this.backgroundColorB=parseInt(a[1]);break;}}};docSpeechBubble.prototype.setFontColor=function(a){var b=a.match(/[A-Za-z0-9]{2}/g).map(function(c){return parseInt(c,16);});this.fontColorR=b[0];this.fontColorG=b[1];this.fontColorB=b[2];};docSpeechBubble.prototype.getFontColor=function(){var c=this.fontColorR.toString(16);var b=this.fontColorG.toString(16);var a=this.fontColorB.toString(16);if(c.length<2){c="0"+c;}if(b.length<2){b="0"+b;}if(a.length<2){a="0"+a;}return"#"+c+b+a;};docSpeechBubble.prototype.getFontColorRGB=function(){return"rgb("+this.fontColorR+","+this.fontColorG+","+this.fontColorB+")";};docSpeechBubble.prototype.setBackgroundColor=function(a){var b=a.match(/[A-Za-z0-9]{2}/g).map(function(c){return parseInt(c,16);});this.backgroundColorR=b[0];this.backgroundColorG=b[1];this.backgroundColorB=b[2];};docSpeechBubble.prototype.getBackgroundColor=function(){var b=this.backgroundColorR.toString(16);var a=this.backgroundColorG.toString(16);var c=this.backgroundColorB.toString(16);if(b.length<2){b="0"+b;}if(a.length<2){a="0"+a;}if(c.length<2){c="0"+c;}return"#"+b+a+c;};function mCR_ReportSpeechBubbleFrame(a,b){this.objReport=a;this.objCss={strClass:"",strStyle:""};this.selectedPage=0;this.elmReportSpeechBubbleFullFrame=null;this.elmReportSpeechBubbleFrame=null;this.elmReportSpeechBubbleText=null;this.elmReportSpeechBubbleTX=null;this.elmReportSpeechBubbleTY=null;this.elmReportSpeechBubbleWidth=null;this.elmReportSpeechBubbleHeight=null;this.elmReportSpeechBubbleFontSize=null;this.elmReportSpeechBubbleFontColor=null;this.elmReportSpeechBubbleLineType=null;this.elmReportSpeechBubbleBackgroundColor=null;this.elmTargetDom=null;this.nHeaderHeight=null;this.nZoomRate=1;this.arrSpeechBubbleArray=new Array();this.objSpeechBubbleInfo={objDocSpeechBubble:null,elmSpeechBubbleDiv:null,elmSpeechBubble:null,elmPosition:null,elmSize:null,elmDelete:null};this.isIE=b;this.arrSpeechBubbleElementArray=new Array();this.isMemoColorDisplay=true;this.strMemoStyle=null;this.strMemoSignStyle=null;this.nGapMemo=10;this.nSpeechBubbleTextSize=310;this.nToggleButtonSize=20;this.isFocusTextInput=false;this.m_objLanguageMap=null;}mCR_ReportSpeechBubbleFrame.prototype.setIsMemoColorDisplay=function(a){this.isMemoColorDisplay=a;};mCR_ReportSpeechBubbleFrame.prototype.createSpeechBubbleFrame=function(a){var g=this.objReport;if(null!=window.ReportView){this.m_objLanguageMap=g.objLanguageMap;}else{this.m_objLanguageMap=g.m_languageMap;}var k=this;this.objSpeechBubbleInfo.objDocSpeechBubble=a;var f=document.createElement("div");f.id="report_speech_bubble_full_frame";f.className="report_speech_bubble_full_frame "+this.objCss.strClass;if(this.nHeaderHeight==null){if(this.objReport.objStyleInfo.strHeaderHeight!=null){f.style.top=this.objReport.objStyleInfo.strHeaderHeight;}}else{f.style.top=this.nHeaderHeight+"px";}if(this.elmTargetDom==null){this.objReport.objTargetDOM.appendChild(f);}else{this.elmTargetDom.appendChild(f);}this.elmReportSpeechBubbleFullFrame=f;var d=document.createElement("div");d.id="report_speech_bubble_title_div";d.className="report_speech_bubble_title_div";f.appendChild(d);var i=document.createElement("SPAN");i.style.position="absolute";i.style.left="10px";i.style.top="4px";var j=document.createTextNode(this.m_objLanguageMap.memoInfo);i.appendChild(j);d.appendChild(i);var h=document.createElement("button");h.id="report_speech_bubble_close_button";h.className="report_speech_bubble_close_button";h.onclick=function(){k.closeSpeechBubbleFrame();};d.appendChild(h);var b=document.createElement("div");b.id="report_speech_bubble_frame_div";b.className="report_speech_bubble_frame_div "+this.objCss.strClass;if(this.nHeaderHeight==null){if(!this.objReport.isUpperMenu){b.className=b.className+" clip_report_menu_up";}}b.style.cssText=this.objCss.strStyle;b.onscoll=function(){};this.elmReportSpeechBubbleFrame=b;f.appendChild(b);this.makingSpeechBubbleMainDiv();var c=document.createElement("div");c.id="report_speech_bubble_frame_div";c.className="report_speech_bubble_frame_div "+this.objCss.strClass;if(this.nHeaderHeight==null){if(!this.objReport.isUpperMenu){c.className=c.className+" clip_report_menu_up";}}c.style.cssText=this.objCss.strStyle;c.onscoll=function(){};this.elmReportMemoSignFrame=c;f.appendChild(c);this.makingMemoSignMainDiv();};mCR_ReportSpeechBubbleFrame.prototype.makingSpeechBubbleMainDiv=function(){this.makingSpeechBubbleTextDiv();this.makingSpeechBubblePositionDiv();this.makingSpeechBubbleFontStyleDiv();this.makingSpeechBubbleAlignmentDiv();this.makingSpeechBubbleMemoAlignmentDiv();};mCR_ReportSpeechBubbleFrame.prototype.makingMemoSignMainDiv=function(){this.makingMemoSignPositionDiv();this.makingMemoSignPenStyleDiv();};mCR_ReportSpeechBubbleFrame.prototype.makingSpeechBubbleTextDiv=function(){var b=this;var h=document.createElement("div");h.id="report_speech_bubble_detail_frame_div";h.className="report_speech_bubble_detail_frame_div ";h.style.top="3px";h.style.height="110px";this.elmReportSpeechBubbleFrame.appendChild(h);var g=document.createElement("div");g.id="report_speech_bubble_detail_title_div";g.className="report_speech_bubble_detail_title_div";h.appendChild(g);var a=document.createElement("SPAN");a.style.position="absolute";a.style.left="10px";a.style.top="4px";var c=document.createTextNode(this.m_objLanguageMap.memoText);a.appendChild(c);g.appendChild(a);var f=document.createElement("div");f.id="report_speech_bubble_detail_div";f.className="report_speech_bubble_detail_div "+this.objCss.strClass;h.appendChild(f);f.style.height="76px";var d=document.createElement("textarea");d.style.width="97%";d.style.height="100%";d.style.resize="none";f.appendChild(d);d.value=this.objSpeechBubbleInfo.objDocSpeechBubble.text;d.addEventListener("change",function(){b.setSpeechBubbleText(this.value);b.redrawTextSpeechBubble();});this.elmReportSpeechBubbleText=d;};mCR_ReportSpeechBubbleFrame.prototype.makingSpeechBubblePositionDiv=function(){var m=this;var g=document.createElement("div");g.id="report_speech_bubble_detail_frame_div";g.className="report_speech_bubble_detail_frame_div ";g.style.top="115px";g.style.height="120px";this.elmReportSpeechBubbleFrame.appendChild(g);var f=document.createElement("div");f.id="report_speech_bubble_detail_title_div";f.className="report_speech_bubble_detail_title_div";g.appendChild(f);var i=document.createElement("SPAN");i.style.position="absolute";i.style.left="10px";i.style.top="4px";var j=document.createTextNode(this.m_objLanguageMap.memoPo);i.appendChild(j);f.appendChild(i);var h=document.createElement("div");h.id="report_speech_bubble_detail_div";h.className="report_speech_bubble_detail_div";g.appendChild(h);var l=document.createElement("div");l.style.position="absolute";l.style.left="0px";l.style.top="0px";l.style.width="101px";l.style.height="21px";h.appendChild(l);var j=document.createTextNode(this.m_objLanguageMap.memoPoX+" : ");l.appendChild(j);var k=document.createElement("div");k.style.position="absolute";k.style.right="0px";k.style.top="0px";k.style.width="202px";k.style.height="21px";h.appendChild(k);var d=document.createElement("INPUT");d.setAttribute("type","text");d.style.width="93%";d.style.height="83%";k.appendChild(d);this.elmReportSpeechBubbleTX=d;d.value=this.objSpeechBubbleInfo.objDocSpeechBubble.tx;d.addEventListener("change",function(){m.setSpeechBubblePositionX(this.value);m.resetThisSpeechBubblePosition();});d.onkeypress=function(){m.keyCheckEvent(event);};var l=document.createElement("div");l.style.position="absolute";l.style.left="0px";l.style.top="21px";l.style.width="101px";l.style.height="21px";h.appendChild(l);var j=document.createTextNode(this.m_objLanguageMap.memoPoY+" : ");l.appendChild(j);var k=document.createElement("div");k.style.position="absolute";k.style.right="0px";k.style.top="21px";k.style.width="202px";k.style.height="21px";h.appendChild(k);var c=document.createElement("INPUT");c.setAttribute("type","text");c.style.width="93%";c.style.height="83%";k.appendChild(c);this.elmReportSpeechBubbleTY=c;c.value=this.objSpeechBubbleInfo.objDocSpeechBubble.ty;c.addEventListener("change",function(){m.setSpeechBubblePositionY(this.value);m.resetThisSpeechBubblePosition();});c.onkeypress=function(){m.keyCheckEvent(event);};var l=document.createElement("div");l.style.position="absolute";l.style.left="0px";l.style.top="42px";l.style.width="101px";l.style.height="21px";h.appendChild(l);var j=document.createTextNode(this.m_objLanguageMap.memoPoWidth+" : ");l.appendChild(j);var k=document.createElement("div");k.style.position="absolute";k.style.right="0px";k.style.top="42px";k.style.width="202px";k.style.height="21px";h.appendChild(k);var b=document.createElement("INPUT");b.setAttribute("type","text");b.style.width="93%";b.style.height="83%";k.appendChild(b);this.elmReportSpeechBubbleWidth=b;b.value=this.objSpeechBubbleInfo.objDocSpeechBubble.width-20;b.addEventListener("change",function(){m.setSpeechBubbleWidth(parseInt(this.value)+20);m.resetThisSpeechBubbleSize();m.resetThisSpeechBubbleStyle();});b.onkeypress=function(){m.keyCheckEvent(event);};var l=document.createElement("div");l.style.position="absolute";l.style.left="0px";l.style.top="63px";l.style.width="101px";l.style.height="21px";h.appendChild(l);var j=document.createTextNode(this.m_objLanguageMap.memoPoHeight+" : ");l.appendChild(j);var k=document.createElement("div");k.style.position="absolute";k.style.right="0px";k.style.top="63px";k.style.width="202px";k.style.height="21px";h.appendChild(k);var a=document.createElement("INPUT");a.setAttribute("type","text");a.style.width="93%";a.style.height="83%";k.appendChild(a);this.elmReportSpeechBubbleHeight=a;a.value=this.objSpeechBubbleInfo.objDocSpeechBubble.height;a.addEventListener("change",function(){m.setSpeechBubbleHeight(this.value);m.resetThisSpeechBubbleSize();m.resetThisSpeechBubbleStyle();});a.onkeypress=function(){m.keyCheckEvent(event);};};mCR_ReportSpeechBubbleFrame.prototype.makingMemoSignPositionDiv=function(){var m=this;var g=document.createElement("div");g.id="report_speech_bubble_detail_frame_div";g.className="report_speech_bubble_detail_frame_div ";g.style.top="3px";g.style.height="120px";this.elmReportMemoSignFrame.appendChild(g);var f=document.createElement("div");f.id="report_speech_bubble_detail_title_div";f.className="report_speech_bubble_detail_title_div";g.appendChild(f);var i=document.createElement("SPAN");i.style.position="absolute";i.style.left="10px";i.style.top="4px";var j=document.createTextNode(this.m_objLanguageMap.memoPo);i.appendChild(j);f.appendChild(i);var h=document.createElement("div");h.id="report_speech_bubble_detail_div";h.className="report_speech_bubble_detail_div";g.appendChild(h);var l=document.createElement("div");l.style.position="absolute";l.style.left="0px";l.style.top="0px";l.style.width="101px";l.style.height="21px";h.appendChild(l);var j=document.createTextNode(this.m_objLanguageMap.memoPoX+" : ");l.appendChild(j);var k=document.createElement("div");k.style.position="absolute";k.style.right="0px";k.style.top="0px";k.style.width="202px";k.style.height="21px";h.appendChild(k);var d=document.createElement("INPUT");d.setAttribute("type","text");d.style.width="93%";d.style.height="83%";k.appendChild(d);this.elmReportMemoSignTX=d;d.value=this.objSpeechBubbleInfo.objDocSpeechBubble.tx;d.addEventListener("change",function(){m.setMemoSignPositionX(this.value);m.resetThisMemoSignPosition();});d.onkeypress=function(){m.keyCheckEvent(event);};var l=document.createElement("div");l.style.position="absolute";l.style.left="0px";l.style.top="21px";l.style.width="101px";l.style.height="21px";h.appendChild(l);var j=document.createTextNode(this.m_objLanguageMap.memoPoY+" : ");l.appendChild(j);var k=document.createElement("div");k.style.position="absolute";k.style.right="0px";k.style.top="21px";k.style.width="202px";k.style.height="21px";h.appendChild(k);var c=document.createElement("INPUT");c.setAttribute("type","text");c.style.width="93%";c.style.height="83%";k.appendChild(c);this.elmReportMemoSignTY=c;c.value=this.objSpeechBubbleInfo.objDocSpeechBubble.ty;c.addEventListener("change",function(){m.setSpeechBubblePositionY(this.value);m.resetThisMemoSignPosition();});c.onkeypress=function(){m.keyCheckEvent(event);};var l=document.createElement("div");l.style.position="absolute";l.style.left="0px";l.style.top="42px";l.style.width="101px";l.style.height="21px";h.appendChild(l);var j=document.createTextNode(this.m_objLanguageMap.memoPoWidth+" : ");l.appendChild(j);var k=document.createElement("div");k.style.position="absolute";k.style.right="0px";k.style.top="42px";k.style.width="202px";k.style.height="21px";h.appendChild(k);var b=document.createElement("INPUT");b.setAttribute("type","text");b.style.width="93%";b.style.height="83%";k.appendChild(b);this.elmReportMemoSignWidth=b;b.value=this.objSpeechBubbleInfo.objDocSpeechBubble.width-20;b.addEventListener("change",function(){m.setMemoSignWidth(parseInt(this.value)+20);m.resetThisMemoSignSize();});b.onkeypress=function(){m.keyCheckEvent(event);};var l=document.createElement("div");l.style.position="absolute";l.style.left="0px";l.style.top="63px";l.style.width="101px";l.style.height="21px";h.appendChild(l);var j=document.createTextNode(this.m_objLanguageMap.memoPoHeight+" : ");l.appendChild(j);var k=document.createElement("div");k.style.position="absolute";k.style.right="0px";k.style.top="63px";k.style.width="202px";k.style.height="21px";h.appendChild(k);var a=document.createElement("INPUT");a.setAttribute("type","text");a.style.width="93%";a.style.height="83%";k.appendChild(a);this.elmReportMemoSignHeight=a;a.value=this.objSpeechBubbleInfo.objDocSpeechBubble.height;a.addEventListener("change",function(){m.setMemoSignHeight(this.value);m.resetThisMemoSignSize();});a.onkeypress=function(){m.keyCheckEvent(event);};};mCR_ReportSpeechBubbleFrame.prototype.makingSpeechBubbleFontStyleDiv=function(){var m=this;var g=document.createElement("div");g.id="report_speech_bubble_detail_frame_div";g.className="report_speech_bubble_detail_frame_div ";g.style.top="238px";g.style.height="120px";this.elmReportSpeechBubbleFrame.appendChild(g);var f=document.createElement("div");f.id="report_speech_bubble_detail_title_div";f.className="report_speech_bubble_detail_title_div";g.appendChild(f);var i=document.createElement("SPAN");i.style.position="absolute";i.style.left="10px";i.style.top="4px";var j=document.createTextNode(this.m_objLanguageMap.memoFont);i.appendChild(j);f.appendChild(i);var h=document.createElement("div");h.id="report_speech_bubble_detail_div";h.className="report_speech_bubble_detail_div";g.appendChild(h);var l=document.createElement("div");l.style.position="absolute";l.style.left="0px";l.style.top="0px";l.style.width="101px";l.style.height="21px";h.appendChild(l);var j=document.createTextNode(this.m_objLanguageMap.memoFontSize+" : ");l.appendChild(j);var k=document.createElement("div");k.style.position="absolute";k.style.right="0px";k.style.top="0px";k.style.width="202px";k.style.height="21px";h.appendChild(k);var b=document.createElement("INPUT");b.setAttribute("type","text");b.style.width="93%";b.style.height="83%";k.appendChild(b);this.elmReportSpeechBubbleFontSize=b;b.value=this.objSpeechBubbleInfo.objDocSpeechBubble.fontSize;b.addEventListener("change",function(){m.setSpeechBubbleFontSize(this.value);m.redrawTextSpeechBubble();});var l=document.createElement("div");l.style.position="absolute";l.style.left="0px";l.style.top="21px";l.style.width="101px";l.style.height="21px";if(!this.isMemoColorDisplay){l.style.display="none";}h.appendChild(l);var j=document.createTextNode(this.m_objLanguageMap.memoFontColor+" : ");l.appendChild(j);var k=document.createElement("div");k.style.position="absolute";k.style.right="0px";k.style.top="21px";k.style.width="202px";k.style.height="21px";if(!this.isMemoColorDisplay){k.style.display="none";}h.appendChild(k);var c=document.createElement("INPUT");c.setAttribute("type","color");c.style.width="93%";c.style.height="83%";k.appendChild(c);this.elmReportSpeechBubbleFontColor=c;if(this.objSpeechBubbleInfo.objDocSpeechBubble.type!="memoSign"){c.value=this.getDocFontColor(this.objSpeechBubbleInfo.objDocSpeechBubble);}if((typeof mCR_isSpectrum!="undefined")&&mCR_isIE){$(c).spectrum({color:c.value,change:function(n){m.setSpeechBubbleFontColor(n.toHexString());m.redrawTextSpeechBubble();}});}else{c.addEventListener("change",function(){m.setSpeechBubbleFontColor(this.value);m.redrawTextSpeechBubble();});}var l=document.createElement("div");l.style.position="absolute";l.style.left="0px";l.style.top="42px";l.style.width="101px";l.style.height="21px";h.appendChild(l);var j=document.createTextNode(this.m_objLanguageMap.memoFontReSize+" : ");l.appendChild(j);var k=document.createElement("div");k.style.position="absolute";k.style.right="0px";k.style.top="42px";k.style.width="202px";k.style.height="21px";h.appendChild(k);var d=document.createElement("INPUT");d.setAttribute("type","checkbox");d.style.width="93%";d.style.height="83%";k.appendChild(d);this.elmReportSpeechBubbleIsReduceFontSize=d;d.value=this.objSpeechBubbleInfo.objDocSpeechBubble.isReduceFontSize;d.addEventListener("change",function(){m.setSpeechBubbleIsReduceFontSize(this.checked);m.redrawTextSpeechBubble();});var l=document.createElement("div");l.style.position="absolute";l.style.left="0px";l.style.top="63px";l.style.width="101px";l.style.height="21px";if(!this.isMemoColorDisplay){l.style.display="none";}h.appendChild(l);var j=document.createTextNode(this.m_objLanguageMap.memoFontBGColor+" : ");l.appendChild(j);var k=document.createElement("div");k.style.position="absolute";k.style.right="0px";k.style.top="63px";k.style.width="202px";k.style.height="21px";if(!this.isMemoColorDisplay){k.style.display="none";}h.appendChild(k);var a=document.createElement("INPUT");a.setAttribute("type","color");a.style.width="93%";a.style.height="83%";k.appendChild(a);this.elmReportSpeechBubbleBackgroundColor=a;a.value=this.getDocBackgroundColor(this.objSpeechBubbleInfo.objDocSpeechBubble);if((typeof mCR_isSpectrum!="undefined")&&mCR_isIE){$(a).spectrum({color:a.value,change:function(n){m.setSpeechBubbleBackgroundColor(n.toHexString());m.resetThisSpeechBubbleStyle();}});}else{a.addEventListener("change",function(){m.setSpeechBubbleBackgroundColor(this.value);m.resetThisSpeechBubbleStyle();});}};mCR_ReportSpeechBubbleFrame.prototype.makingMemoSignPenStyleDiv=function(){var l=this;var c=document.createElement("div");c.id="report_speech_bubble_detail_frame_div";c.className="report_speech_bubble_detail_frame_div ";c.style.top="126px";c.style.height="120px";this.elmReportMemoSignFrame.appendChild(c);var b=document.createElement("div");b.id="report_speech_bubble_detail_title_div";b.className="report_speech_bubble_detail_title_div";c.appendChild(b);var h=document.createElement("SPAN");h.style.position="absolute";h.style.left="10px";h.style.top="4px";var i=document.createTextNode(this.m_objLanguageMap.memoFont);h.appendChild(i);b.appendChild(h);var d=document.createElement("div");d.id="report_speech_bubble_detail_div";d.className="report_speech_bubble_detail_div";c.appendChild(d);var k=document.createElement("div");k.style.position="absolute";k.style.left="0px";k.style.top="0px";k.style.width="101px";k.style.height="21px";d.appendChild(k);var i=document.createTextNode(this.m_objLanguageMap.memoSignMaxPenSize+" : ");k.appendChild(i);var j=document.createElement("div");j.style.position="absolute";j.style.right="0px";j.style.top="0px";j.style.width="202px";j.style.height="21px";d.appendChild(j);var g=document.createElement("INPUT");g.setAttribute("type","text");g.style.width="93%";g.style.height="83%";j.appendChild(g);this.elmReportMemoSignMaxPenSize=g;if(this.objSpeechBubbleInfo.objDocSpeechBubble.type=="memoSign"){g.value=this.objSpeechBubbleInfo.objDocSpeechBubble.maxWidth;}g.addEventListener("change",function(){l.setMemoSignMaxPenSize(parseFloat(this.value));l.resetThisMemoSignStylePenSize();});var k=document.createElement("div");k.style.position="absolute";k.style.left="0px";k.style.top="21px";k.style.width="101px";k.style.height="21px";d.appendChild(k);var i=document.createTextNode(this.m_objLanguageMap.memoSignMinimumPenSize+" : ");k.appendChild(i);var j=document.createElement("div");j.style.position="absolute";j.style.right="0px";j.style.top="21px";j.style.width="202px";j.style.height="21px";d.appendChild(j);var f=document.createElement("INPUT");f.setAttribute("type","text");f.style.width="93%";f.style.height="83%";j.appendChild(f);this.elmReportMemoSignMinimumPenSize=f;if(this.objSpeechBubbleInfo.objDocSpeechBubble.type=="memoSign"){f.value=this.objSpeechBubbleInfo.objDocSpeechBubble.minWidth;}f.addEventListener("change",function(){l.setMemoSignMinimumPenSize(parseFloat(this.value));l.resetThisMemoSignStylePenSize();});var k=document.createElement("div");k.style.position="absolute";k.style.left="0px";k.style.top="42px";k.style.width="101px";k.style.height="21px";if(!this.isMemoColorDisplay){k.style.display="none";}d.appendChild(k);var i=document.createTextNode(this.m_objLanguageMap.memoSignPenColor+" : ");k.appendChild(i);var j=document.createElement("div");j.style.position="absolute";j.style.right="0px";j.style.top="42px";j.style.width="202px";j.style.height="21px";if(!this.isMemoColorDisplay){j.style.display="none";}d.appendChild(j);var a=document.createElement("INPUT");a.setAttribute("type","color");a.style.width="93%";a.style.height="83%";j.appendChild(a);this.elmReportMemoSignPenColor=a;if(this.objSpeechBubbleInfo.objDocSpeechBubble.type=="memoSign"){a.value=this.getDocPenColor(this.objSpeechBubbleInfo.objDocSpeechBubble);}a.addEventListener("change",function(){l.setSpeechBubblePenColor(this.value);l.resetThisMemoSignStyleColor();});};mCR_ReportSpeechBubbleFrame.prototype.makingSpeechBubbleMemoAlignmentDiv=function(){var b=this;var d=document.createElement("div");d.id="report_speech_bubble_detail_frame_div";d.className="report_speech_bubble_detail_frame_div ";d.style.top="524px";d.style.height="95px";this.elmReportSpeechBubbleFrame.appendChild(d);var c=document.createElement("div");c.id="report_speech_bubble_detail_title_div";c.className="report_speech_bubble_detail_title_div";d.appendChild(c);var h=document.createElement("SPAN");h.style.position="absolute";h.style.left="10px";h.style.top="4px";var i=document.createTextNode(this.m_objLanguageMap.memoBlowingDirection);h.appendChild(i);c.appendChild(h);var g=document.createElement("div");g.id="report_speech_bubble_detail_div";g.className="report_speech_bubble_detail_div";d.appendChild(g);var j=document.createElement("div");j.style.position="absolute";j.style.left="0px";j.style.top="0px";j.style.width="59px";j.style.height="14px";g.appendChild(j);var a=document.createElement("INPUT");a.setAttribute("type","radio");a.name="memo_alignment";a.id="top";a.style.width="93%";a.style.height="83%";this.elmReportSpeechBubbleMemoAlignTopRadio=a;j.appendChild(a);if(this.objSpeechBubbleInfo.objDocSpeechBubble.pointerSide=="top"){a.checked=true;}else{a.checked=false;}j.onclick=function(){b.checkSpeechBubblePointerSide(a);};var j=document.createElement("div");j.style.position="absolute";j.style.left="59px";j.style.top="0px";j.style.width="59px";j.style.height="14px";g.appendChild(j);var n=document.createElement("INPUT");n.setAttribute("type","radio");n.name="memo_alignment";n.id="left";n.style.width="93%";n.style.height="83%";this.elmReportSpeechBubbleMemoAlignLeftRadio=n;j.appendChild(n);if(this.objSpeechBubbleInfo.objDocSpeechBubble.pointerSide=="left"){n.checked=true;}else{n.checked=false;}j.onclick=function(){b.checkSpeechBubblePointerSide(n);};var j=document.createElement("div");j.style.position="absolute";j.style.left="118px";j.style.top="0px";j.style.width="59px";j.style.height="14px";g.appendChild(j);var m=document.createElement("INPUT");m.setAttribute("type","radio");m.name="memo_alignment";m.id="bottom";m.style.width="93%";m.style.height="83%";this.elmReportSpeechBubbleMemoAlignBottomRadio=m;j.appendChild(m);if(this.objSpeechBubbleInfo.objDocSpeechBubble.pointerSide=="bottom"){m.checked=true;}else{m.checked=false;}j.onclick=function(){b.checkSpeechBubblePointerSide(m);};var j=document.createElement("div");j.style.position="absolute";j.style.left="177px";j.style.top="0px";j.style.width="59px";j.style.height="14px";g.appendChild(j);var l=document.createElement("INPUT");l.setAttribute("type","radio");l.name="memo_alignment";l.id="right";l.style.width="93%";l.style.height="83%";this.elmReportSpeechBubbleMemoAlignRightRadio=l;j.appendChild(l);if(this.objSpeechBubbleInfo.objDocSpeechBubble.pointerSide=="right"){l.checked=true;}else{l.checked=false;}j.onclick=function(){b.checkSpeechBubblePointerSide(l);};var j=document.createElement("div");j.style.position="absolute";j.style.left="236px";j.style.top="0px";j.style.width="59px";j.style.height="14px";g.appendChild(j);var f=document.createElement("INPUT");f.setAttribute("type","radio");f.name="memo_alignment";f.id="none";f.style.width="93%";f.style.height="83%";this.elmReportSpeechBubbleMemoAlignNoneRadio=f;j.appendChild(f);if(this.objSpeechBubbleInfo.objDocSpeechBubble.pointerSide=="none"){f.checked=true;}else{f.checked=false;}j.onclick=function(){b.checkSpeechBubblePointerSide(f);};var k=document.createElement("div");k.style.position="absolute";k.style.left="0px";k.style.top="14px";k.style.width="59px";k.style.height="55px";k.id="bubble_speech_frame_pointer_top_div";k.className="bubble_speech_frame_pointer_top_div";g.appendChild(k);var k=document.createElement("div");k.style.position="absolute";k.style.left="59px";k.style.top="14px";k.style.width="59px";k.style.height="55px";k.id="bubble_speech_frame_pointer_left_div";k.className="bubble_speech_frame_pointer_left_div";g.appendChild(k);var k=document.createElement("div");k.style.position="absolute";k.style.left="118px";k.style.top="14px";k.style.width="59px";k.style.height="55px";k.id="bubble_speech_frame_pointer_bottom_div";k.className="bubble_speech_frame_pointer_bottom_div";g.appendChild(k);var k=document.createElement("div");k.style.position="absolute";k.style.left="177px";k.style.top="14px";k.style.width="59px";k.style.height="55px";k.id="bubble_speech_frame_pointer_right_div";k.className="bubble_speech_frame_pointer_right_div";g.appendChild(k);var k=document.createElement("div");k.style.position="absolute";k.style.left="236px";k.style.top="14px";k.style.width="59px";k.style.height="55px";k.id="bubble_speech_frame_pointer_none_div";k.className="bubble_speech_frame_pointer_none_div";g.appendChild(k);};mCR_ReportSpeechBubbleFrame.prototype.checkSpeechBubblePointerSide=function(a){if(a.id=="top"){if(a.checked){this.objSpeechBubbleInfo.objDocSpeechBubble.pointerSide="top";}}else{if(a.id=="left"){if(a.checked){this.objSpeechBubbleInfo.objDocSpeechBubble.pointerSide="left";}}else{if(a.id=="bottom"){if(a.checked){this.objSpeechBubbleInfo.objDocSpeechBubble.pointerSide="bottom";}}else{if(a.id=="right"){if(a.checked){this.objSpeechBubbleInfo.objDocSpeechBubble.pointerSide="right";}}else{if(a.checked){this.objSpeechBubbleInfo.objDocSpeechBubble.pointerSide="none";}}}}}this.resetThisSpeechBubbleStyle();};mCR_ReportSpeechBubbleFrame.prototype.makingSpeechBubbleAlignmentDiv=function(){var b=this;var h=document.createElement("div");h.id="report_speech_bubble_detail_frame_div";h.className="report_speech_bubble_detail_frame_div ";h.style.top="361px";h.style.height="160px";this.elmReportSpeechBubbleFrame.appendChild(h);var g=document.createElement("div");g.id="report_speech_bubble_detail_title_div";g.className="report_speech_bubble_detail_title_div";h.appendChild(g);var k=document.createElement("SPAN");k.style.position="absolute";k.style.left="10px";k.style.top="4px";var l=document.createTextNode(this.m_objLanguageMap.memoReplacement);k.appendChild(l);g.appendChild(k);var i=document.createElement("div");i.id="report_speech_bubble_detail_div";i.className="report_speech_bubble_detail_div";h.appendChild(i);var m=document.createElement("div");m.style.position="absolute";m.style.left="0px";m.style.top="0px";m.style.width="100px";m.style.height="13px";i.appendChild(m);var a=document.createElement("INPUT");a.setAttribute("type","radio");a.name="horizontal_alignment";a.id="left";a.style.width="93%";a.style.height="83%";this.elmReportSpeechBubbleHorizontalAlignLeftRadio=a;m.appendChild(a);if(this.objSpeechBubbleInfo.objDocSpeechBubble.horizontalAlign=="left"){a.checked=true;}else{a.checked=false;}m.onclick=function(){b.checkSpeechBubbleHorizontalAlign(a);};var m=document.createElement("div");m.style.position="absolute";m.style.left="100px";m.style.top="0px";m.style.width="100px";m.style.height="13px";i.appendChild(m);var o=document.createElement("INPUT");o.setAttribute("type","radio");o.name="horizontal_alignment";o.id="center";o.style.width="93%";o.style.height="83%";this.elmReportSpeechBubbleHorizontalAlignCenterRadio=o;m.appendChild(o);if(this.objSpeechBubbleInfo.objDocSpeechBubble.horizontalAlign=="center"){o.checked=true;}else{o.checked=false;}m.onclick=function(){b.checkSpeechBubbleHorizontalAlign(o);};var m=document.createElement("div");m.style.position="absolute";m.style.left="200px";m.style.top="0px";m.style.width="100px";m.style.height="13px";i.appendChild(m);var f=document.createElement("INPUT");f.setAttribute("type","radio");f.name="horizontal_alignment";f.id="right";f.style.width="93%";f.style.height="83%";this.elmReportSpeechBubbleHorizontalAlignRightRadio=f;m.appendChild(f);if(this.objSpeechBubbleInfo.objDocSpeechBubble.horizontalAlign=="right"){f.checked=true;}else{f.checked=false;}m.onclick=function(){b.checkSpeechBubbleHorizontalAlign(f);};var n=document.createElement("div");n.style.position="absolute";n.style.left="0px";n.style.top="13px";n.style.width="100px";n.style.height="52px";n.id="bubble_speech_frame_sentence_left_div";n.className="bubble_speech_frame_sentence_left_div";i.appendChild(n);var n=document.createElement("div");n.style.position="absolute";n.style.left="100px";n.style.top="13px";n.style.width="100px";n.style.height="52px";n.id="bubble_speech_frame_sentence_center_div";n.className="bubble_speech_frame_sentence_center_div";i.appendChild(n);var n=document.createElement("div");n.style.position="absolute";n.style.left="200px";n.style.top="13px";n.style.width="100px";n.style.height="52px";n.id="bubble_speech_frame_sentence_right_div";n.className="bubble_speech_frame_sentence_right_div";i.appendChild(n);var m=document.createElement("div");m.style.position="absolute";m.style.left="0px";m.style.top="65px";m.style.width="100px";m.style.height="13px";i.appendChild(m);var c=document.createElement("INPUT");c.setAttribute("type","radio");c.name="vertical_alignment";c.id="top";c.style.width="93%";c.style.height="83%";this.elmReportSpeechBubbleVerticalAlignTopRadio=c;m.appendChild(c);if(this.objSpeechBubbleInfo.objDocSpeechBubble.verticalAlign=="top"){c.checked=true;}else{c.checked=false;}m.onclick=function(){b.checkSpeechBubbleVerticalAlign(c);};var m=document.createElement("div");m.style.position="absolute";m.style.left="100px";m.style.top="65px";m.style.width="100px";m.style.height="13px";i.appendChild(m);var d=document.createElement("INPUT");d.setAttribute("type","radio");d.name="vertical_alignment";d.id="middle";d.style.width="93%";d.style.height="83%";this.elmReportSpeechBubbleVerticalAlignMiddleRadio=d;m.appendChild(d);if(this.objSpeechBubbleInfo.objDocSpeechBubble.verticalAlign=="middle"){d.checked=true;}else{d.checked=false;}m.onclick=function(){b.checkSpeechBubbleVerticalAlign(d);};var m=document.createElement("div");m.style.position="absolute";m.style.left="200px";m.style.top="65px";m.style.width="100px";m.style.height="13px";i.appendChild(m);var j=document.createElement("INPUT");j.setAttribute("type","radio");j.name="vertical_alignment";j.id="bottom";j.style.width="93%";j.style.height="83%";this.elmReportSpeechBubbleVerticalAlignBottomRadio=j;m.appendChild(j);if(this.objSpeechBubbleInfo.objDocSpeechBubble.verticalAlign=="bottom"){j.checked=true;}else{j.checked=false;}m.onclick=function(){b.checkSpeechBubbleVerticalAlign(j);};var n=document.createElement("div");n.style.position="absolute";n.style.left="0px";n.style.top="78px";n.style.width="100px";n.style.height="52px";n.id="bubble_speech_frame_sentence_top_div";n.className="bubble_speech_frame_sentence_top_div";i.appendChild(n);var n=document.createElement("div");n.style.position="absolute";n.style.left="100px";n.style.top="78px";n.style.width="100px";n.style.height="52px";n.id="bubble_speech_frame_sentence_middle_div";n.className="bubble_speech_frame_sentence_middle_div";i.appendChild(n);var n=document.createElement("div");n.style.position="absolute";n.style.left="200px";n.style.top="78px";n.style.width="100px";n.style.height="52px";n.id="bubble_speech_frame_sentence_bottom_div";n.className="bubble_speech_frame_sentence_bottom_div";i.appendChild(n);};mCR_ReportSpeechBubbleFrame.prototype.checkSpeechBubbleHorizontalAlign=function(a){if(a.id=="left"){if(a.checked){this.objSpeechBubbleInfo.objDocSpeechBubble.horizontalAlign="left";}}else{if(a.id=="center"){if(a.checked){this.objSpeechBubbleInfo.objDocSpeechBubble.horizontalAlign="center";}}else{if(a.checked){this.objSpeechBubbleInfo.objDocSpeechBubble.horizontalAlign="right";}}}this.reDrawTextInSpeechBubble();};mCR_ReportSpeechBubbleFrame.prototype.checkSpeechBubbleVerticalAlign=function(a){if(a.id=="top"){if(a.checked){this.objSpeechBubbleInfo.objDocSpeechBubble.verticalAlign="top";}}else{if(a.id=="middle"){if(a.checked){this.objSpeechBubbleInfo.objDocSpeechBubble.verticalAlign="middle";}}else{if(a.checked){this.objSpeechBubbleInfo.objDocSpeechBubble.verticalAlign="bottom";}}}this.reDrawTextInSpeechBubble();};mCR_ReportSpeechBubbleFrame.prototype.openSpeechBubbleFrame=function(){if(this.checkDataSpeechBubbleFrame()!=0){this.elmReportSpeechBubbleFullFrame.style.width=(this.nSpeechBubbleTextSize+this.nToggleButtonSize)+"px";this.toggleSpeechBubbleFrameView();this.elmReportSpeechBubbleFullFrame.style.display="block";}};mCR_ReportSpeechBubbleFrame.prototype.toggleSpeechBubbleFrameView=function(){if(this.objSpeechBubbleInfo.objDocSpeechBubble.type=="memoSign"){this.elmReportMemoSignFrame.style.visibility="visible";this.elmReportSpeechBubbleFrame.style.visibility="hidden";}else{this.elmReportMemoSignFrame.style.visibility="hidden";this.elmReportSpeechBubbleFrame.style.visibility="visible";}};mCR_ReportSpeechBubbleFrame.prototype.refreshSpeechBubbleValue=function(a){if(a.type=="memoSign"){this.elmReportMemoSignTX.value=a.tx;this.elmReportMemoSignTY.value=a.ty;this.elmReportMemoSignWidth.value=a.width-20;this.elmReportMemoSignHeight.value=a.height;this.elmReportMemoSignMaxPenSize.value=a.maxWidth;this.elmReportMemoSignMinimumPenSize.value=a.minWidth;this.elmReportMemoSignPenColor.value=this.getDocPenColor(a);}else{this.elmReportSpeechBubbleText.value=a.text;this.elmReportSpeechBubbleTX.value=a.tx;this.elmReportSpeechBubbleTY.value=a.ty;this.elmReportSpeechBubbleWidth.value=a.width-20;this.elmReportSpeechBubbleHeight.value=a.height;this.elmReportSpeechBubbleFontSize.value=a.fontSize;this.elmReportSpeechBubbleFontColor.value=this.getDocFontColor(a);this.elmReportSpeechBubbleIsReduceFontSize.value=a.isReduceFontSize;this.elmReportSpeechBubbleBackgroundColor.value=this.getDocBackgroundColor(a);if((typeof mCR_isSpectrum!="undefined")&&mCR_isIE){this.elmReportSpeechBubbleFontColor.nextElementSibling.firstChild.firstChild.style.backgroundColor=this.getDocFontColorRGB(a);this.elmReportSpeechBubbleBackgroundColor.nextElementSibling.firstChild.firstChild.style.backgroundColor=this.getDocBackgroundColorRGB(a);}if(a.horizontalAlign=="left"){this.elmReportSpeechBubbleHorizontalAlignLeftRadio.checked=true;}else{if(a.horizontalAlign=="center"){this.elmReportSpeechBubbleHorizontalAlignCenterRadio.checked=true;}else{this.elmReportSpeechBubbleHorizontalAlignRightRadio.checked=true;}}if(a.verticalAlign=="top"){this.elmReportSpeechBubbleVerticalAlignTopRadio.checked=true;}else{if(a.verticalAlign=="middle"){this.elmReportSpeechBubbleVerticalAlignMiddleRadio.checked=true;}else{this.elmReportSpeechBubbleVerticalAlignBottomRadio.checked=true;}}if(a.pointerSide=="top"){this.elmReportSpeechBubbleMemoAlignTopRadio.checked=true;}else{if(a.pointerSide=="left"){this.elmReportSpeechBubbleMemoAlignLeftRadio.checked=true;}else{if(a.pointerSide=="bottom"){this.elmReportSpeechBubbleMemoAlignBottomRadio.checked=true;}else{if(a.pointerSide=="right"){this.elmReportSpeechBubbleMemoAlignRightRadio.checked=true;}else{this.elmReportSpeechBubbleMemoAlignNoneRadio.checked=true;}}}}if(null!=this.objReport&&null!=this.objReport.multiView){var b=this.objReport.multiView;if(b.isSocket&&this.objReport.isMain){b.socket.sendMemoData(this.arrSpeechBubbleArray,this.objReport.m_uid);}}}};mCR_ReportSpeechBubbleFrame.prototype.closeSpeechBubbleFrame=function(){if(this.elmReportSpeechBubbleFullFrame!=null){this.elmReportSpeechBubbleFullFrame.style.width="0px";this.elmReportSpeechBubbleFullFrame.style.display="none";}this.changeSpeechBubbleStyle(null);};mCR_ReportSpeechBubbleFrame.prototype.getWidth=function(){return(this.nSpeechBubbleTextSize+this.nToggleButtonSize);};mCR_ReportSpeechBubbleFrame.prototype.changeSpeechBubbleStyle=function(a){if(this.elmSelectedSpeechBubble!=null){this.elmSelectedSpeechBubble.className=this.elmSelectedSpeechBubble.className.replace(" selected_SpeechBubble_div","");}this.elmSelectedSpeechBubble=a;if(this.elmSelectedSpeechBubble!=null){this.elmSelectedSpeechBubble.className=this.elmSelectedSpeechBubble.className+" selected_SpeechBubble_div";}};mCR_ReportSpeechBubbleFrame.prototype.keyCheckEvent=function(b){var a=b.keyCode;if(!((a>=48&&a<=57))){if(b.preventDefault){b.preventDefault();}b.returnValue=false;}else{return;}};mCR_ReportSpeechBubbleFrame.prototype.changeIsSpeechBubbleControl=function(c){if(c){if(!mCR_isFirefox){this.nZoomRate=this.objSpeechBubbleInfo.elmSpeechBubbleDiv.parentElement.style.zoom;}else{this.nZoomRate=this.objSpeechBubbleInfo.elmSpeechBubbleDiv.parentElement.style.transform.replace("scale(","").replace(")","");}var b=this.arrSpeechBubbleElementArray.length;for(var a=0;a<b;a++){this.arrSpeechBubbleElementArray[a].elmSize.style.display="block";this.arrSpeechBubbleElementArray[a].elmDelete.style.display="block";if(this.arrSpeechBubbleElementArray[a].elmErase!=null){this.arrSpeechBubbleElementArray[a].elmErase.style.display="block";}this.arrSpeechBubbleElementArray[a].elmSpeechBubble.style.zIndex="1";}}else{var b=this.arrSpeechBubbleElementArray.length;for(var a=0;a<b;a++){this.arrSpeechBubbleElementArray[a].elmSize.style.display="none";this.arrSpeechBubbleElementArray[a].elmDelete.style.display="none";if(this.arrSpeechBubbleElementArray[a].elmErase!=null){this.arrSpeechBubbleElementArray[a].elmErase.style.display="none";}this.arrSpeechBubbleElementArray[a].elmSpeechBubble.style.zIndex="0";}}};mCR_ReportSpeechBubbleFrame.prototype.reDrawTextInSpeechBubble=function(){this.objReport.objTextBuilder.drawTextFromSpeechBubble(this.objSpeechBubbleInfo.elmSpeechBubble.firstChild.firstChild.firstChild,this.objSpeechBubbleInfo.objDocSpeechBubble,false);if(null!=this.objReport&&null!=this.objReport.multiView){var a=this.objReport.multiView;if(a.isSocket&&this.objReport.isMain){a.socket.sendMemoData(this.arrSpeechBubbleArray,this.objReport.m_uid);}}};mCR_ReportSpeechBubbleFrame.prototype.searchDocSpeechBubble=function(b){var d=this.selectedPage;var c=this.arrSpeechBubbleElementArray.length;for(var a=0;a<c;a++){if(this.arrSpeechBubbleElementArray[a].elmSpeechBubble==b){return this.arrSpeechBubbleArray[d][a];}}};mCR_ReportSpeechBubbleFrame.prototype.deleteDocSpeechBubble=function(c){var f=this.selectedPage;var b=this.arrSpeechBubbleElementArray.length;for(var a=0;a<b;a++){if(this.arrSpeechBubbleElementArray[a].elmDelete==c){var g=this.arrSpeechBubbleElementArray[a].elmSpeechBubble;if(this.isIE){g.removeNode(this.arrSpeechBubbleElementArray[a].elmSpeechBubble);}else{g.remove(this.arrSpeechBubbleElementArray[a].elmSpeechBubble);}this.arrSpeechBubbleElementArray.splice(a,1);this.arrSpeechBubbleArray[f].splice(a,1);if(this.checkDataSpeechBubbleFrame()==0){this.closeSpeechBubbleFrame();}break;}}if(null!=this.objReport&&null!=this.objReport.multiView){var d=this.objReport.multiView;if(d.isSocket&&this.objReport.isMain){d.socket.sendMemoData(this.arrSpeechBubbleArray,this.objReport.m_uid);}}};mCR_ReportSpeechBubbleFrame.prototype.createSpeechBubbleStyle=function(a,b){var c=document.createElement("style");c.textContent=this.createSpeechBubbleCSSText(a,b);return c;};mCR_ReportSpeechBubbleFrame.prototype.resetSpeechBubbleStyle=function(c,a,b){c.textContent=this.createSpeechBubbleCSSText(a,b);if(null!=this.objReport&&null!=this.objReport.multiView){var d=this.objReport.multiView;if(d.isSocket&&this.objReport.isMain){d.socket.sendMemoData(this.arrSpeechBubbleArray,this.objReport.m_uid);}}};mCR_ReportSpeechBubbleFrame.prototype.resetThisSpeechBubbleStyle=function(){this.objSpeechBubbleInfo.elmSpeechBubble.firstChild.lastChild.textContent=this.createSpeechBubbleCSSText(this.objSpeechBubbleInfo.elmSpeechBubble.firstChild.className,this.objSpeechBubbleInfo.objDocSpeechBubble);if(null!=this.objReport&&null!=this.objReport.multiView){var a=this.objReport.multiView;if(a.isSocket&&this.objReport.isMain){a.socket.sendMemoData(this.arrSpeechBubbleArray,this.objReport.m_uid);}}};mCR_ReportSpeechBubbleFrame.prototype.resetSpeechBubbleStyleSize=function(b,a){this.objSpeechBubbleInfo.elmSpeechBubble.firstChild.lastChild.textContent=this.createSpeechBubbleCSSText(this.objSpeechBubbleInfo.elmSpeechBubble.firstChild.className,this.objSpeechBubbleInfo.objDocSpeechBubble,b,a);if(null!=this.objReport&&null!=this.objReport.multiView){var c=this.objReport.multiView;if(c.isSocket&&this.objReport.isMain){c.socket.sendMemoData(this.arrSpeechBubbleArray,this.objReport.m_uid);}}};mCR_ReportSpeechBubbleFrame.prototype.resetThisSpeechBubblePosition=function(){this.objSpeechBubbleInfo.elmSpeechBubble.style.left=this.objSpeechBubbleInfo.objDocSpeechBubble.tx+"px";this.objSpeechBubbleInfo.elmSpeechBubble.style.top=this.objSpeechBubbleInfo.objDocSpeechBubble.ty+"px";if(null!=this.objReport&&null!=this.objReport.multiView){var a=this.objReport.multiView;if(a.isSocket&&this.objReport.isMain){a.socket.sendMemoData(this.arrSpeechBubbleArray,this.objReport.m_uid);}}};mCR_ReportSpeechBubbleFrame.prototype.resetThisMemoSignPosition=function(){this.objSpeechBubbleInfo.elmSpeechBubble.style.left=this.objSpeechBubbleInfo.objDocSpeechBubble.tx+"px";this.objSpeechBubbleInfo.elmSpeechBubble.style.top=this.objSpeechBubbleInfo.objDocSpeechBubble.ty+"px";};mCR_ReportSpeechBubbleFrame.prototype.resetThisMemoSignStyleColor=function(){if(report.objSpeechBubbleFrame.objSpeechBubbleInfo.objMemoSign!=null){report.objSpeechBubbleFrame.objSpeechBubbleInfo.objMemoSign.penColor=this.getDocPenColorRGB(this.objSpeechBubbleInfo.objDocSpeechBubble);}};mCR_ReportSpeechBubbleFrame.prototype.resetThisMemoSignStylePenSize=function(){if(report.objSpeechBubbleFrame.objSpeechBubbleInfo.objMemoSign!=null){report.objSpeechBubbleFrame.objSpeechBubbleInfo.objMemoSign.minWidth=this.objSpeechBubbleInfo.objDocSpeechBubble.minWidth;report.objSpeechBubbleFrame.objSpeechBubbleInfo.objMemoSign.maxWidth=this.objSpeechBubbleInfo.objDocSpeechBubble.maxWidth;report.objSpeechBubbleFrame.objSpeechBubbleInfo.objMemoSign.dotSize=(this.objSpeechBubbleInfo.objDocSpeechBubble.minWidth+this.objSpeechBubbleInfo.objDocSpeechBubble.maxWidth)/2;}};mCR_ReportSpeechBubbleFrame.prototype.resetThisSpeechBubbleSize=function(){this.objSpeechBubbleInfo.elmSpeechBubble.style.width=this.objSpeechBubbleInfo.objDocSpeechBubble.width+"px";this.objSpeechBubbleInfo.elmSpeechBubble.style.height=this.objSpeechBubbleInfo.objDocSpeechBubble.height+"px";this.reDrawTextInSpeechBubble();};mCR_ReportSpeechBubbleFrame.prototype.resetThisMemoSignSize=function(){this.objSpeechBubbleInfo.elmSpeechBubble.style.width=this.objSpeechBubbleInfo.objDocSpeechBubble.width+"px";this.objSpeechBubbleInfo.elmSpeechBubble.style.height=this.objSpeechBubbleInfo.objDocSpeechBubble.height+"px";if(this.objSpeechBubbleInfo.objMemoSign!=null){this.objSpeechBubbleInfo.objMemoSign.resize();}};mCR_ReportSpeechBubbleFrame.prototype.createSpeechBubbleCSSText=function(c,o,n,l){var f={},s={},j={};var q=null;var p=o.pointerSide;var i=null;var d=null;var a=null;var m=o.width;var t=o.height;var r=o.maxPointerSize;if(n!=null){m=n;}if(l!=null){t=l;}var g=0;var k=0;f.position="absolute";if(o.type=="memoSign"){f["background-color"]="transparent";}else{f["background-color"]=this.getDocBackgroundColor(o);}f["border-radius"]=o.radius+"px";f["margin-right"]=o.marginRight+"px";f.left="0px";f.top="0px";f.right="0px";f.bottom="0px";f.cursor="all-scroll";if(p=="top"){q="left";d=this.getDocBackgroundColor(o)+" transparent";a="rgba(0, 0, 0, .3) transparent";k=m-20;g=k*0.1;if(g>r){g=r;}i="0 "+g+"px "+g+"px";}if(p=="bottom"){q="left";d=this.getDocBackgroundColor(o)+" transparent";a="rgba(0, 0, 0, .3) transparent";k=m-20;g=k*0.1;if(g>r){g=r;}i=g+"px "+g+"px 0";}if(p=="left"){q="top";d="transparent "+this.getDocBackgroundColor(o);a="transparent rgba(0, 0, 0, .3)";k=t;g=k*0.1;if(g>r){g=r;}i=g+"px "+g+"px "+g+"px 0px";}if(p=="right"){q="top";d="transparent "+this.getDocBackgroundColor(o);a="transparent rgba(0, 0, 0, .3)";k=t;g=k*0.1;if(g>r){g=r;}i=g+"px 0px "+g+"px "+g+"px";}if(o.type=="memoSign"){f.border="1px dashed black";}else{f.border="1px solid rgba(0,0,0,.3)";}if(p!="none"){s.content="''";s.position="absolute";var h=k*0.5-g;s[q]=h+"px";var b=g-2;s[p]="-"+b+"px";s["border-width"]=i;s["border-style"]="solid";s["border-color"]=d;s.display="block";s.width="0";s.height="0";j.content="''";j.position="absolute";j[q]=h+"px";j[p]="-"+g+"px";j["border-width"]=i;j["border-style"]="solid";j["border-color"]=a;j.display="block";j.width="0";j.height="0";return this.createCSSText(c+":before",j)+"\n\n"+this.createCSSText(c,f)+"\n\n"+this.createCSSText(c+":after",s);}else{return this.createCSSText(c,f);}};mCR_ReportSpeechBubbleFrame.prototype.createCSSText=function(a,c){var b="."+a+" {\n";for(key in c){b+="	"+key+": "+c[key]+";\n";}b+="}";return b;};mCR_ReportSpeechBubbleFrame.prototype.getHighIndexNumber=function(){var d=this.arrSpeechBubbleArray[this.selectedPage].length;var c=-1;for(var b=0;b<d;b++){var a=this.arrSpeechBubbleArray[this.selectedPage][b].index;if(c<a){c=a;}}return c+1;};mCR_ReportSpeechBubbleFrame.prototype.createSpeechBubble=function(n,q,b){var m=this.objReport;var s=this;var i=document.createElement("div");i.className="bubble_speech_layout_div";i.id="bubble_speech_layout_div";i.style.width=q.width+"px";i.style.height=q.height+"px";i.style.left=q.tx+"px";i.style.top=q.ty+"px";n.appendChild(i);var d=null;if(b){d=q.index;}else{d=this.getHighIndexNumber();}var h=document.createElement("div");h.className="bubble_speech_"+d;h.id="bubble_speech";i.appendChild(h);q.index=d;var r=document.createElement("div");r.className="bubble_speech_text_div";r.id="bubble_speech_text_div";h.appendChild(r);h.appendChild(this.createSpeechBubbleStyle("bubble_speech_"+d,q));var u=null;if(q.type=="memoSign"){r.style.border="1px";var l=document.createElement("canvas");l.className="bubble_speech_text";l.id="bubble_speech_text";r.appendChild(l);l.width=l.offsetWidth;l.height=l.offsetHeight;if(q.signData!=null){var p=l.getContext("2d");var y="data:image/png;base64,"+q.signData;var z=new Image();z.onload=function(){p.drawImage(this,0,0);};z.src=y;}u=new SignaturePad(l,{minWidth:q.minWidth,maxWidth:q.maxWidth,penColor:"rgb("+q.penColorR+","+q.penColorG+","+q.penColorB+")"},null);u.throttle=3;u.minDistance=0;l.onclick=l.ontouchend=function(){var D=event.target?event.target:event.srcElement;var B=D.parentElement.parentElement;var C=B.parentElement;var A=s.searchDocSpeechBubble(C);A.signData=u.toDataURL().split("base64,")[1];};}else{var c=document.createElement("canvas");c.className="bubble_speech_text";c.id="bubble_speech_text";r.appendChild(c);var w=document.createElement("textArea");w.className="bubble_speech_text";w.id="bubble_speech_text";w.style.display="none";w.style.resize="none";w.style.overflow="hidden";w.style.backgroundColor="rgba(0,0,0,0)";r.appendChild(w);c.onclick=c.ontouch=function(){var F=event.target?event.target:event.srcElement;var A=F.parentElement.parentElement;var G=A.parentElement.childNodes[1];var E=A.parentElement;var C=A.parentElement.childNodes[2];var D=A.parentElement.childNodes[3];s.objSpeechBubbleInfo.elmPosition=G;s.objSpeechBubbleInfo.elmSpeechBubble=E;s.objSpeechBubbleInfo.elmSize=C;s.objSpeechBubbleInfo.elmDelete=D;s.objSpeechBubbleInfo.objDocSpeechBubble=s.searchDocSpeechBubble(E);s.refreshSpeechBubbleValue(s.objSpeechBubbleInfo.objDocSpeechBubble);c.style.display="none";w.style.display="block";var B="";if(s.objSpeechBubbleInfo.objDocSpeechBubble.fontBold){B="bold ";}w.style.font=B+s.objSpeechBubbleInfo.objDocSpeechBubble.fontSize+"pt "+s.objSpeechBubbleInfo.objDocSpeechBubble.fontName;w.style.color=s.getDocFontColor(s.objSpeechBubbleInfo.objDocSpeechBubble);w.value=s.objSpeechBubbleInfo.objDocSpeechBubble.text;w.focus();};w.onkeyup=function(){s.setSpeechBubbleText(this.value);};w.onblur=function(){s.refreshSpeechBubbleValue(s.objSpeechBubbleInfo.objDocSpeechBubble);w.style.display="none";c.style.display="block";var D=event.target?event.target:event.srcElement;var B=D.parentElement.parentElement;var C=B.parentElement;var A=s.searchDocSpeechBubble(C);s.redrawTextSpeechBubbleInTextArea(c,A);};}var t=document.createElement("div");t.className="bubble_speech_position_div";t.id="bubble_speech_position_div";i.appendChild(t);var g=document.createElement("div");g.className="bubble_speech_size_div";g.id="bubble_speech_size_div";i.appendChild(g);var x=document.createElement("div");x.className="bubble_speech_delete_div";x.id="bubble_speech_delete_div";i.appendChild(x);this.objSpeechBubbleInfo.elmPosition=t;this.objSpeechBubbleInfo.elmSpeechBubble=i;this.objSpeechBubbleInfo.elmSize=g;this.objSpeechBubbleInfo.elmDelete=x;this.objSpeechBubbleInfo.objMemoSign=u;var j=null;if(q.type=="memoSign"){j=document.createElement("div");j.className="bubble_speech_erase_div";j.id="bubble_speech_erase_div";i.appendChild(j);}this.objSpeechBubbleInfo.elmErase=j;this.objSpeechBubbleInfo.objDocSpeechBubble=q;this.arrSpeechBubbleElementArray.push({elmSpeechBubble:i,elmPosition:t,elmSize:g,elmDelete:x,elmErase:j,objMemoSign:u});if(!b){this.arrSpeechBubbleArray[this.selectedPage].push(q);}this.refreshSpeechBubbleValue(q);if(q.type=="memoSign"){}else{m.objTextBuilder.drawTextFromSpeechBubble(i.firstChild.firstChild.firstChild,q,false);}s.toggleSpeechBubbleFrameView();if(this.isFocusTextInput){var o=t;var v=i;var f=g;var k=x;s.objSpeechBubbleInfo.elmPosition=o;s.objSpeechBubbleInfo.elmSpeechBubble=v;s.objSpeechBubbleInfo.elmSize=f;s.objSpeechBubbleInfo.elmDelete=k;s.objSpeechBubbleInfo.objDocSpeechBubble=q;s.refreshSpeechBubbleValue(q);c.style.display="none";w.style.display="block";var a="";if(s.objSpeechBubbleInfo.objDocSpeechBubble.fontBold){a="bold ";}w.style.font=a+s.objSpeechBubbleInfo.objDocSpeechBubble.fontSize+"pt "+s.objSpeechBubbleInfo.objDocSpeechBubble.fontName;w.style.color=s.getDocFontColor(s.objSpeechBubbleInfo.objDocSpeechBubble);w.value=s.objSpeechBubbleInfo.objDocSpeechBubble.text;w.focus();}};mCR_ReportSpeechBubbleFrame.prototype.redrawTextSpeechBubble=function(){this.objReport.objTextBuilder.drawTextFromSpeechBubble(this.objSpeechBubbleInfo.elmSpeechBubble.firstChild.firstChild.firstChild,this.objSpeechBubbleInfo.objDocSpeechBubble,false);if(null!=this.objReport&&null!=this.objReport.multiView){var a=this.objReport.multiView;if(a.isSocket&&this.objReport.isMain){a.socket.sendMemoData(this.arrSpeechBubbleArray,this.objReport.m_uid);}}};mCR_ReportSpeechBubbleFrame.prototype.redrawTextSpeechBubbleInTextArea=function(b,a){this.objReport.objTextBuilder.drawTextFromSpeechBubble(b,a,false);};mCR_ReportSpeechBubbleFrame.prototype.setSpeechBubbleText=function(a){this.objSpeechBubbleInfo.objDocSpeechBubble.text=a;};mCR_ReportSpeechBubbleFrame.prototype.setSpeechBubbleFontSize=function(a){this.objSpeechBubbleInfo.objDocSpeechBubble.fontSize=parseInt(a);};mCR_ReportSpeechBubbleFrame.prototype.setMemoSignMaxPenSize=function(a){this.objSpeechBubbleInfo.objDocSpeechBubble.maxWidth=parseFloat(a);};mCR_ReportSpeechBubbleFrame.prototype.setMemoSignMinimumPenSize=function(a){this.objSpeechBubbleInfo.objDocSpeechBubble.minWidth=parseFloat(a);};mCR_ReportSpeechBubbleFrame.prototype.setSpeechBubbleIsReduceFontSize=function(a){this.objSpeechBubbleInfo.objDocSpeechBubble.isReduceFontSize=a;};mCR_ReportSpeechBubbleFrame.prototype.setSpeechBubbleFontColor=function(a){this.setDocFontColor(a,this.objSpeechBubbleInfo.objDocSpeechBubble);};mCR_ReportSpeechBubbleFrame.prototype.setSpeechBubblePenColor=function(a){this.setDocPenColor(a,this.objSpeechBubbleInfo.objDocSpeechBubble);};mCR_ReportSpeechBubbleFrame.prototype.setSpeechBubbleBackgroundColor=function(a){this.setDocBackgroundColor(a,this.objSpeechBubbleInfo.objDocSpeechBubble);};mCR_ReportSpeechBubbleFrame.prototype.setSpeechBubblePositionX=function(a){this.objSpeechBubbleInfo.objDocSpeechBubble.tx=parseInt(a);};mCR_ReportSpeechBubbleFrame.prototype.setSpeechBubblePositionY=function(a){this.objSpeechBubbleInfo.objDocSpeechBubble.ty=parseInt(a);};mCR_ReportSpeechBubbleFrame.prototype.setSpeechBubbleWidth=function(a){this.objSpeechBubbleInfo.objDocSpeechBubble.width=parseInt(a);};mCR_ReportSpeechBubbleFrame.prototype.setSpeechBubbleHeight=function(a){this.objSpeechBubbleInfo.objDocSpeechBubble.height=parseInt(a);};mCR_ReportSpeechBubbleFrame.prototype.setSpeechBubblePointerSide=function(a){this.objSpeechBubbleInfo.objDocSpeechBubble.pointerSide=a;};mCR_ReportSpeechBubbleFrame.prototype.setSelectedPage=function(a){this.selectedPage=a;};mCR_ReportSpeechBubbleFrame.prototype.setMemoSignPositionX=function(a){this.objSpeechBubbleInfo.objDocSpeechBubble.tx=parseInt(a);};mCR_ReportSpeechBubbleFrame.prototype.setMemoSignPositionY=function(a){this.objSpeechBubbleInfo.objDocSpeechBubble.ty=parseInt(a);};mCR_ReportSpeechBubbleFrame.prototype.setMemoSignWidth=function(a){this.objSpeechBubbleInfo.objDocSpeechBubble.width=parseInt(a);};mCR_ReportSpeechBubbleFrame.prototype.setMemoSignHeight=function(a){this.objSpeechBubbleInfo.objDocSpeechBubble.height=parseInt(a);};mCR_ReportSpeechBubbleFrame.prototype.setDocFontColor=function(b,a){var c=b.match(/[A-Za-z0-9]{2}/g).map(function(d){return parseInt(d,16);});a.fontColorR=c[0];a.fontColorG=c[1];a.fontColorB=c[2];};mCR_ReportSpeechBubbleFrame.prototype.getDocFontColor=function(b){var d=b.fontColorR.toString(16);var c=b.fontColorG.toString(16);var a=b.fontColorB.toString(16);if(d.length<2){d="0"+d;}if(c.length<2){c="0"+c;}if(a.length<2){a="0"+a;}return"#"+d+c+a;};mCR_ReportSpeechBubbleFrame.prototype.getDocFontColorRGB=function(a){return"rgb("+a.fontColorR+","+a.fontColorG+","+a.fontColorB+")";};mCR_ReportSpeechBubbleFrame.prototype.setDocPenColor=function(c,a){var b=c.match(/[A-Za-z0-9]{2}/g).map(function(d){return parseInt(d,16);});a.penColorR=b[0];a.penColorG=b[1];a.penColorB=b[2];};mCR_ReportSpeechBubbleFrame.prototype.getDocPenColor=function(a){var d=a.penColorR.toString(16);var c=a.penColorG.toString(16);var b=a.penColorB.toString(16);if(d.length<2){d="0"+d;}if(c.length<2){c="0"+c;}if(b.length<2){b="0"+b;}return"#"+d+c+b;};mCR_ReportSpeechBubbleFrame.prototype.getDocPenColorRGB=function(a){return"rgb("+a.penColorR+","+a.penColorG+","+a.penColorB+")";};mCR_ReportSpeechBubbleFrame.prototype.setDocBackgroundColor=function(b,a){var c=b.match(/[A-Za-z0-9]{2}/g).map(function(d){return parseInt(d,16);});a.backgroundColorR=c[0];a.backgroundColorG=c[1];a.backgroundColorB=c[2];};mCR_ReportSpeechBubbleFrame.prototype.getDocBackgroundColor=function(a){var c=a.backgroundColorR.toString(16);var b=a.backgroundColorG.toString(16);var d=a.backgroundColorB.toString(16);if(c.length<2){c="0"+c;}if(b.length<2){b="0"+b;}if(d.length<2){d="0"+d;}return"#"+c+b+d;};mCR_ReportSpeechBubbleFrame.prototype.getDocBackgroundColorRGB=function(a){return"rgb("+a.backgroundColorR+","+a.backgroundColorG+","+a.backgroundColorB+")";};mCR_ReportSpeechBubbleFrame.prototype.createSpeechBubbleDiv=function(a){var b=document.createElement("div");b.style.cssText="position: absolute; left:0px; right:0px; top:0px; bottom:0px; ";a.lastChild.insertBefore(b,a.lastChild.firstChild);return b;};mCR_ReportSpeechBubbleFrame.prototype.setSpeechBubbleDiv=function(u){var d=u;this.objSpeechBubbleInfo.elmSpeechBubbleDiv=d;var p=this.nZoomRate;var l=this.objReport;var s=this;var k=d.offsetLeft;var h=d.offsetTop;var c=d.offsetWidth;var q=d.offsetHeight;var a=d.parentElement;while(true){k+=a.offsetLeft;h+=a.offsetTop;if(a.offsetLeft==0&&a.offsetTop==0){break;}a=a.parentElement;}var v=1;var t=0;var r=0;var n=0;var i=0;var f=0;var j=0;var o=0;var g=0;var m=s.objSpeechBubbleInfo.elmSpeechBubbleDiv.parentElement.parentElement;var b=0;d.onmousedown=d.ontouchstart=function(w){var F,E;p=s.nZoomRate;if(w.type=="touchstart"){F=(w.touches[0].clientX/parseFloat(p)).toFixed(0);E=(w.touches[0].clientY/parseFloat(p)).toFixed(0);}else{F=(w.clientX/parseFloat(p)).toFixed(0);E=(w.clientY/parseFloat(p)).toFixed(0);}b=m.scrollTop;var z=w.target?w.target:w.srcElement;if(z.id=="bubble_speech_position_div"){var B=z.parentElement;var C=s.getSpeechBubbleElementJson(B);s.objSpeechBubbleInfo.elmPosition=C.elmPosition;s.objSpeechBubbleInfo.elmSpeechBubble=C.elmSpeechBubble;s.objSpeechBubbleInfo.elmSize=C.elmSize;s.objSpeechBubbleInfo.objDocSpeechBubble=s.searchDocSpeechBubble(B);s.objSpeechBubbleInfo.elmErase=C.elmErase;s.objSpeechBubbleInfo.objMemoSign=C.objMemoSign;s.toggleSpeechBubbleFrameView();s.refreshSpeechBubbleValue(s.objSpeechBubbleInfo.objDocSpeechBubble);B.parentElement.appendChild(B);d.style.cursor="all-scroll";B.style.cursor="all-scroll";t=F;r=E;n=F-k-B.offsetLeft;i=E-h-B.offsetTop;f=B.offsetWidth;j=B.offsetHeight;v=2;}if(z.id=="bubble_speech_size_div"){var B=z.parentElement;var C=s.getSpeechBubbleElementJson(B);s.objSpeechBubbleInfo.elmPosition=C.elmPosition;s.objSpeechBubbleInfo.elmSpeechBubble=C.elmSpeechBubble;s.objSpeechBubbleInfo.elmSize=C.elmSize;s.objSpeechBubbleInfo.objDocSpeechBubble=s.searchDocSpeechBubble(B);s.objSpeechBubbleInfo.elmErase=C.elmErase;s.objSpeechBubbleInfo.objMemoSign=C.objMemoSign;if(C.objMemoSign!=null){C.objMemoSign.clear();s.objSpeechBubbleInfo.objDocSpeechBubble.signData=null;}s.toggleSpeechBubbleFrameView();s.refreshSpeechBubbleValue(s.objSpeechBubbleInfo.objDocSpeechBubble);B.parentElement.appendChild(B);d.style.cursor="nw-resize";B.style.cursor="nw-resize";t=F;r=E;f=B.offsetWidth;j=B.offsetHeight;n=k+B.offsetLeft+B.offsetWidth-F;i=h+B.offsetTop+B.offsetHeight-E;v=3;o=B.offsetWidth-B.clientWidth;g=B.offsetHeight-B.clientHeight;}if(z.id=="bubble_speech"){var A=z;var B=z.parentElement;var C=s.getSpeechBubbleElementJson(B);s.objSpeechBubbleInfo.elmPosition=C.elmPosition;s.objSpeechBubbleInfo.elmSpeechBubble=C.elmSpeechBubble;s.objSpeechBubbleInfo.elmSize=C.elmSize;s.objSpeechBubbleInfo.objDocSpeechBubble=s.searchDocSpeechBubble(B);s.objSpeechBubbleInfo.elmErase=C.elmErase;s.objSpeechBubbleInfo.objMemoSign=C.objMemoSign;s.toggleSpeechBubbleFrameView();s.refreshSpeechBubbleValue(s.objSpeechBubbleInfo.objDocSpeechBubble);B.parentElement.appendChild(B);d.style.cursor="all-scroll";A.style.cursor="all-scroll";t=F;r=E;n=F-k-B.offsetLeft;i=E-h-B.offsetTop;f=B.offsetWidth;j=B.offsetHeight;v=2;}if(z.id=="bubble_speech_erase_div"){var A=z;var B=z.parentElement;var C=s.getSpeechBubbleElementJson(B);s.objSpeechBubbleInfo.elmPosition=C.elmPosition;s.objSpeechBubbleInfo.elmSpeechBubble=C.elmSpeechBubble;s.objSpeechBubbleInfo.elmSize=C.elmSize;s.objSpeechBubbleInfo.objDocSpeechBubble=s.searchDocSpeechBubble(B);s.objSpeechBubbleInfo.elmErase=C.elmErase;s.objSpeechBubbleInfo.objMemoSign=C.objMemoSign;s.toggleSpeechBubbleFrameView();s.refreshSpeechBubbleValue(s.objSpeechBubbleInfo.objDocSpeechBubble);B.parentElement.appendChild(B);C.objMemoSign.clear();s.objSpeechBubbleInfo.objDocSpeechBubble.signData=null;}if(z.id=="bubble_speech_delete_div"){var y=z.parentElement.childNodes[1];var B=z.parentElement;var D=z.parentElement.childNodes[2];var x=z;s.deleteDocSpeechBubble(x);v=1;}};d.onmouseout=function(w){var x=s.objSpeechBubbleInfo.elmSpeechBubble;if(v==2||v==3){if((k-s.objSpeechBubbleInfo.offsetWidth)>=w.clientX||(k+s.objSpeechBubbleInfo.offsetWidth*2)<=w.clientX||(h-s.objSpeechBubbleInfo.elmSpeechBubbleDiv.offsetHeight)>=w.clientY||(h+s.objSpeechBubbleInfo.elmSpeechBubbleDiv.offsetHeight*2)<=w.clientY){d.style.cursor="default";if(x!=null){x.style.cursor="default";}v=1;}}};d.onmousemove=d.ontouchmove=function(w){var F,D;p=s.nZoomRate;var z=s.objSpeechBubbleInfo.elmPosition;var A=s.objSpeechBubbleInfo.elmSpeechBubble;var C=s.objSpeechBubbleInfo.elmSize;if(w.type=="touchmove"){F=(w.touches[0].clientX/parseFloat(p)).toFixed(0);D=(w.touches[0].clientY/parseFloat(p)).toFixed(0);}else{F=(w.clientX/parseFloat(p)).toFixed(0);D=(w.clientY/parseFloat(p)).toFixed(0);}b=m.scrollTop;if(v==2){var y=(F/1)-n-k;var B=(D/1)-i-h;if(y<0){A.style.left=0+"px";}else{if((s.objSpeechBubbleInfo.elmSpeechBubbleDiv.offsetWidth)<(y+A.offsetWidth)){A.style.left=s.objSpeechBubbleInfo.elmSpeechBubbleDiv.offsetWidth-A.offsetWidth+"px";}else{A.style.left=y+"px";}}if(B<0){A.style.top=0+"px";}else{if((s.objSpeechBubbleInfo.elmSpeechBubbleDiv.offsetHeight)<(B+A.offsetHeight)){A.style.top=s.objSpeechBubbleInfo.elmSpeechBubbleDiv.offsetHeight-A.offsetHeight+"px";}else{A.style.top=B+"px";}}}else{if(v==3){var x=(F/1)+n-k-A.offsetLeft;var E=(D/1)+i-h-A.offsetTop;if(119>=x||s.objSpeechBubbleInfo.elmSpeechBubbleDiv.offsetWidth<x+A.offsetLeft||99>=E||s.objSpeechBubbleInfo.elmSpeechBubbleDiv.offsetHeight<E+A.offsetTop){if(119>=x||99>=E){if(119>=x){x=120;A.style.width="120px";if(99<E){A.style.height=E-g+"px";}}if(99>=E){E=100;A.style.height="100px";if(119<x){A.style.width=x-o+"px";}}s.resetSpeechBubbleStyleSize(x,E);}}else{A.style.width=x-o+"px";A.style.height=E-g+"px";s.resetSpeechBubbleStyleSize(x-o,E-g);}}}};d.onmouseup=d.ontouchend=function(w){d.style.cursor="default";var C=s.objSpeechBubbleInfo.elmPosition;var D=s.objSpeechBubbleInfo.elmSpeechBubble;var F=s.objSpeechBubbleInfo.elmSize;p=s.nZoomRate;if(D!=null){D.style.cursor="default";}var I,G;if(w.type=="touchend"){I=(w.changedTouches[0].clientX/parseFloat(p)).toFixed(0);G=(w.changedTouches[0].clientY/parseFloat(p)).toFixed(0);}else{I=(w.clientX/parseFloat(p)).toFixed(0);G=(w.clientY/parseFloat(p)).toFixed(0);}if(v==2){var y=D.parentElement;var x=D.parentElement.offsetWidth;var H=D.parentElement.offsetHeight;var z=(I/1)-n-k;var E=(G/1)-i-h;var B=x-D.offsetWidth;var A=H-D.offsetHeight;if(z<0){z=0;D.style.left=z+"px";}else{if(z>B){z=B;D.style.left=z+"px";}else{if((s.objSpeechBubbleInfo.elmSpeechBubbleDiv.offsetWidth)<(z+D.offsetWidth)){D.style.left=s.objSpeechBubbleInfo.elmSpeechBubbleDiv.offsetWidth-D.offsetWidth+"px";}else{D.style.left=z+"px";}}}if(E<0){E=0;D.style.top=E+"px";}else{if(E>A){E=A;D.style.top=E+"px";}else{if((s.objSpeechBubbleInfo.elmSpeechBubbleDiv.offsetHeight)<(E+D.offsetHeight)){D.style.top=s.objSpeechBubbleInfo.elmSpeechBubbleDiv.offsetHeight-D.offsetHeight+"px";}else{D.style.top=E+"px";}}}s.objSpeechBubbleInfo.objDocSpeechBubble.tx=z;s.objSpeechBubbleInfo.objDocSpeechBubble.ty=E;s.refreshSpeechBubbleValue(s.objSpeechBubbleInfo.objDocSpeechBubble);v=1;}else{if(v==3){var x=(I/1)+n-k-D.offsetLeft;var H=(G/1)+i-h-D.offsetTop;if(119>=x||s.objSpeechBubbleInfo.elmSpeechBubbleDiv.offsetWidth<x+D.offsetLeft||99>=H||s.objSpeechBubbleInfo.elmSpeechBubbleDiv.offsetHeight<H+D.offsetTop){if(119>=x){x=120;D.style.width="120px";}if(99>=H){H=100;D.style.height="100px";}}else{D.style.width=x-o+"px";D.style.height=H-g+"px";}v=1;s.objSpeechBubbleInfo.objDocSpeechBubble.width=x;s.objSpeechBubbleInfo.objDocSpeechBubble.height=H;s.resetThisSpeechBubbleStyle();s.refreshSpeechBubbleValue(s.objSpeechBubbleInfo.objDocSpeechBubble);if(s.objSpeechBubbleInfo.objDocSpeechBubble.type!="memoSign"){l.objTextBuilder.drawTextFromSpeechBubble(D.firstChild.firstChild.firstChild,s.objSpeechBubbleInfo.objDocSpeechBubble,false);}else{s.objSpeechBubbleInfo.objMemoSign.resize();s.objSpeechBubbleInfo.objDocSpeechBubble.signData=null;}}}};return d;};mCR_ReportSpeechBubbleFrame.prototype.createSpeechBubbleArray=function(b){var b=b;this.arrSpeechBubbleArray=new Array();for(var a=0;a<b;a++){this.arrSpeechBubbleArray.push(new Array());}};mCR_ReportSpeechBubbleFrame.prototype.addSpeechBubbleArray=function(b){var b=b;for(var a=0;a<b;a++){this.arrSpeechBubbleArray.push(new Array());}};mCR_ReportSpeechBubbleFrame.prototype.cutSpeechBubbleArray=function(b){var b=this.arrSpeechBubbleArray.length-b;for(var a=0;a<b;a++){this.arrSpeechBubbleArray.pop();}};mCR_ReportSpeechBubbleFrame.prototype.changeControlDivDepth=function(){if(this.objSpeechBubbleInfo.elmSpeechBubbleDiv.parentElement.firstChild==this.objSpeechBubbleInfo.elmSpeechBubbleDiv){this.objSpeechBubbleInfo.elmSpeechBubbleDiv.parentElement.appendChild(this.objSpeechBubbleInfo.elmSpeechBubbleDiv);this.changeIsSpeechBubbleControl(true);}else{this.objSpeechBubbleInfo.elmSpeechBubbleDiv.parentElement.appendChild(this.objSpeechBubbleInfo.elmSpeechBubbleDiv.parentElement.firstChild);this.changeIsSpeechBubbleControl(false);}};mCR_ReportSpeechBubbleFrame.prototype.memoPage=function(a){this.setSelectedPage(a);this.changeControlDivDepth();};mCR_ReportSpeechBubbleFrame.prototype.returnFromMemoPage=function(){this.updateMemoSignData();this.objReport.updateMemo();this.changeControlDivDepth();};mCR_ReportSpeechBubbleFrame.prototype.updateMemoSignData=function(){var c=this.selectedPage;var b=this.arrSpeechBubbleElementArray.length;for(var a=0;a<b;a++){if(this.arrSpeechBubbleElementArray[a].objMemoSign!=null){this.arrSpeechBubbleArray[c][a].signData=this.arrSpeechBubbleElementArray[a].objMemoSign.toDataURL().split("base64,")[1];}}};mCR_ReportSpeechBubbleFrame.prototype.checkDataSpeechBubbleFrame=function(){var a=this.arrSpeechBubbleElementArray.length;return a;};mCR_ReportSpeechBubbleFrame.prototype.makeMemo=function(c){var b=new docSpeechBubble();if(this.strMemoStyle!=null){if(this.strMemoStyle.indexOf("tx:")==-1&&this.strMemoStyle.indexOf("ty:")==-1){b.setStyle(this.strMemoStyle);var a=this.getHighIndexNumber();b.tx+=a*this.nGapMemo;b.ty+=a*this.nGapMemo;if(c!=null){b.ty+=c;}}else{b.setStyle(this.strMemoStyle);}}else{var a=this.getHighIndexNumber();b.tx+=a*this.nGapMemo;b.ty+=a*this.nGapMemo;if(c!=null){b.ty+=c;}}this.objSpeechBubbleInfo.objDocSpeechBubble=b;if(this.elmReportSpeechBubbleFullFrame==null){this.createSpeechBubbleFrame(b);}this.createSpeechBubble(this.objSpeechBubbleInfo.elmSpeechBubbleDiv,b,false);};mCR_ReportSpeechBubbleFrame.prototype.makeMemoSign=function(c){var b=new docMemoSign();this.objSpeechBubbleInfo.objDocSpeechBubble=b;if(this.strMemoSignStyle!=null){if(this.strMemoSignStyle.indexOf("tx:")==-1&&this.strMemoSignStyle.indexOf("ty:")==-1){b.setStyle(this.strMemoSignStyle);var a=this.getHighIndexNumber();b.tx+=a*this.nGapMemo;b.ty+=a*this.nGapMemo;if(c!=null){b.ty+=c;}}else{b.setStyle(this.strMemoSignStyle);}}else{var a=this.getHighIndexNumber();b.tx+=a*this.nGapMemo;b.ty+=a*this.nGapMemo;if(c!=null){b.ty+=c;}}if(this.elmReportSpeechBubbleFullFrame==null){this.createSpeechBubbleFrame(b);}this.createSpeechBubble(this.objSpeechBubbleInfo.elmSpeechBubbleDiv,b,false);};mCR_ReportSpeechBubbleFrame.prototype.toggleSpeechBubbleFrame=function(){if(this.checkDataSpeechBubbleFrame()!=0){if(this.elmReportSpeechBubbleFullFrame.offsetWidth==0){this.openSpeechBubbleFrame();}else{this.closeSpeechBubbleFrame();}}};mCR_ReportSpeechBubbleFrame.prototype.getSpeechBubbleElementJson=function(b){var c=this.arrSpeechBubbleElementArray.length;for(var a=0;a<c;a++){if(this.arrSpeechBubbleElementArray[a].elmSpeechBubble==b){return this.arrSpeechBubbleElementArray[a];}}return null;};mCR_ReportSpeechBubbleFrame.prototype.deleteElementMemo=function(){this.arrSpeechBubbleElementArray=null;this.arrSpeechBubbleElementArray=new Array();};mCR_ReportSpeechBubbleFrame.prototype.getLengthFromSpeechBubbleArray=function(a){if(this.arrSpeechBubbleArray[a]!=null){return this.arrSpeechBubbleArray[a].length;}else{return 0;}};mCR_ReportSpeechBubbleFrame.prototype.makeAllPageMemo=function(a,d){this.deleteElementMemo();var b=this.getLengthFromSpeechBubbleArray(a);for(var c=0;c<b;c++){if(this.elmReportSpeechBubbleFullFrame==null){this.createSpeechBubbleFrame(this.arrSpeechBubbleArray[a][c]);}this.createSpeechBubble(d,this.arrSpeechBubbleArray[a][c],true);}this.changeIsSpeechBubbleControl(false);};mCR_ReportSpeechBubbleFrame.prototype.setTargetDom=function(a){this.elmTargetDom=a;};mCR_ReportSpeechBubbleFrame.prototype.setHeaderHeight=function(a){this.nHeaderHeight=a;};function mCR_TextBuilder(){this.pxToCm=0.0264583333;this.ptToPx=1.32814;this.ptToPxInFont=1.33333;}mCR_TextBuilder.prototype.drawTextFromSpeechBubble=function(n,L,b){if(n==null){return"error : canvas don't exist";}var r=L.fontName;var p=n.getContext("2d");p.scale(1,1);p.font=L.fontSize+"pt "+r;var q=L.fontSize;var K=L.horizontalAlign;var c=L.verticalAlign;var u=L.isReduceFontSize;var t=L.text;var a=L.fontBold;var x=this.getFontColorRGB(L);var l=1.2*this.ptToPxInFont;if(L.lineSpace!=null){l=L.lineSpace;l=l*this.ptToPxInFont;}var M=0;if(L.wordSpace!=null){M=L.wordSpace;M=M*this.ptToPxInFont;}var A=0;if(L.reduceWidth){A=L.reduceWidth;}var C=[];var k=0;var o=0;var I=[];var w="";var m=new textArray();var s=0;var D=t.length;var g=n.offsetHeight==0?n.height:n.offsetHeight;var F=n.offsetWidth==0?n.width:n.offsetWidth;var v=q*this.ptToPxInFont;var N=0;var f=v;var y=false;var E=0;var h=0;var B=0;var z=0;for(var G=0;G<q;G++){if(y){break;}else{if(!u){y=true;}for(var H=0;H<D;H++){var d=0;var J=false;if(t[H]!="\n"){d=this.getWidth(p,t[H])+M;k=k+d;}else{J=true;}if(k>F||J){if(N+(v)*2+l<(g-v*0.15)){N=N+v+l;h=h+v+l;C.push(k-d);E++;}else{if(u){E=0;k=0;o=0;w="";m.clear();I=[];C=[];v=(v-this.ptToPxInFont);N=0;s=0;f=0+v;p.font=(v/this.ptToPxInFont)+"pt "+L.fontName;break;}else{C.push(k-d);E++;h=h+v+l;break;}}I.push(w);w="";k=0;k=k+d;s++;}if(!J){w=w+t[H];m.push(new textInfo(t[H],0+k-d,f+N,E));}if(H==D-1){y=true;h=N+v;C.push(k);}}}}L.changeFontSize=v;if(!b){n.width=F+A;n.height=g;return this.drawTextInfoToCanvas(n,K,F,c,g,h,v,m,E,z,B,r,a,x,C);}else{return this.drawTextInfoToSVG(n,K,F,c,g,h,v,m,E,z,B,r,a,x,C,A);}};mCR_TextBuilder.prototype.drawTextInfoToCanvas=function(r,o,u,b,d,c,q,l,s,n,h,m,k,f,g){var p=r.getContext("2d");p.fillStyle=f;p.lineWidth=1;p.setLineDash([]);p.beginPath();p.scale(1,1);var j=g.length;for(var t=0;t<j;t++){if(o=="center"){h=(u-g[t])/2;}else{if(o=="right"){h=(u-g[t]);}else{h=0;}}g[t]=h;}if(b=="middle"){n=(d-c)/2;}else{if(b=="bottom"){n=(d-c-q*0.3);}else{n=0;}}var a="";if(k){a="bold ";}p.font=a+(q/this.ptToPxInFont)+"pt "+m;textCount=l.array.length;for(var t=0;t<textCount;t++){p.fillText(l.array[t].character,l.array[t].tx+g[l.array[t].verticalPosition],l.array[t].ty+n);}return null;};mCR_TextBuilder.prototype.drawTextInfoToSVG=function(r,p,v,a,c,b,q,l,s,o,h,n,k,d,f,m){var j=f.length;for(var u=0;u<j;u++){if(p=="center"){h=(v-f[u])/2;}else{if(p=="right"){h=(v-f[u]);}else{h=0;}}f[u]=h;}if(a=="middle"){o=(c-b)/2;}else{if(a=="bottom"){o=(c-b);}else{o=0;}}var w=document.createElementNS("http://www.w3.org/2000/svg","svg");w.setAttribute("fill-opacity","1");w.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink");w.setAttribute("xmlns","http://www.w3.org/2000/svg");w.setAttribute("color-rendering","auto");w.setAttribute("color-interpolation","auto");w.setAttribute("text-interpolation","auto");w.setAttribute("stroke-linecap","square");w.setAttribute("stroke-miterlimit","10");w.setAttribute("stroke-opacity","1");w.setAttribute("shape-rendering","auto");w.setAttribute("stroke-dasharray","none");w.setAttribute("stroke-linejoin","miter");w.setAttribute("stroke-dashoffset","0");w.setAttribute("image-rendering","auto");w.setAttribute("style","overflow:hidden");w.setAttribute("width",v+m);w.setAttribute("height",c);var g=document.createElementNS("http://www.w3.org/2000/svg","g");if(k){if(window.is_apple||window.mCR_isApple){g.setAttribute("font-weight","normal");g.setAttribute("stroke-width","0.4");g.setAttribute("paint-order","stroke");g.setAttribute("stroke",d);}else{g.setAttribute("font-weight","bold");g.setAttribute("stroke","none");}}g.setAttribute("fill",d);g.setAttribute("font-size",(q/this.ptToPxInFont)+"pt");g.setAttribute("font-family",n);w.appendChild(g);textCount=l.array.length;for(var u=0;u<textCount;u++){var t=document.createElementNS("http://www.w3.org/2000/svg","text");t.textContent=l.array[u].character;t.setAttribute("x",l.array[u].tx+f[l.array[u].verticalPosition]);t.setAttribute("y",l.array[u].ty+o);g.appendChild(t);}return w;};mCR_TextBuilder.prototype.getIsVerticalPosition=function(c,a){var d=c.length;for(var b=0;b<d;b++){if(c[b]==a){return true;}}return false;};mCR_TextBuilder.prototype.getWidth=function(b,a){return b.measureText(a).width;};mCR_TextBuilder.prototype.getFontColorRGB=function(a){return"rgb("+a.fontColorR+","+a.fontColorG+","+a.fontColorB+")";};function textArray(){this.array=new Array();}textArray.prototype.push=function(a){this.array.push(a);};textArray.prototype.clear=function(){var b=this.array.length;for(var a=0;a<b;a++){this.array.pop();}};function textInfo(d,c,a,b){this.character=d;this.tx=c;this.ty=a;this.verticalPosition=b;}var mRe_FocusControl={objCtrl:null};function createMainReSetEForm(b,f,d,c){if(null==c){mRe_ReportEventHandler(20);}var a=new Report(b,null,null,null,c);a.is_eForm=true;a.m_reportKey=d;eform_init(a);a.multiView.isSocket=true;a.multiView.socket=f;a.multiView.socket.main_connect_reset_info(a,d,c);a.isMain=true;a.m_isObjJSONSVG=true;a.m_isJsonAllPage=true;return a;}function createMainEForm(c,b,d,g,f){if(null==f){mRe_ReportEventHandler(20);}var a=new Report(c,null,null,null,f);a.is_eForm=true;a.m_reportKey=g;eform_init(a);a.multiView.isSocket=true;a.multiView.socket=new EFormSocket();a.multiView.socket.main_connect_info(a,b,g,d,f);a.isMain=true;a.m_isObjJSONSVG=true;a.m_isJsonAllPage=true;return a;}function creatMainEForm(b,a,c,f,d){return createMainEForm(b,a,c,f,d);}function createSubEForm(c,b,d,f){if(null==f){mRe_ReportEventHandler(20);}var a=new Report(c,null,null,null,f);a.is_eForm=true;eform_init(a);a.m_isDefaultDoodleVisble=true;a.multiView.isSocket=true;a.multiView.socket=new EFormSocket();a.multiView.socket.sub_connect_info(a,b,d,f);a.isMain=false;a.m_isObjJSONSVG=true;a.m_isJsonAllPage=true;return a;}function creatSubEForm(b,a,c,d){return createSubEForm(b,a,c,d);}function resetSubEForm(b){b.is_eFormData=false;b.beforePageIndex=1;b.m_pageCount=0;var c=b.eForm_isNecessary.is_start;b.eForm_isNecessary={pageList:null,check:false,is_start:c};b.eFormData=null;b.eFormCheckImage=null;b.eFormRadioImage=null;b.eFormControlList=null;b.eFormControlGroupList=null;var a=b.eFormDoodleOption.okButtonEvent;b.eFormDoodleOption={is_Ds:false,is_eraser:false,is_eraser_down:false,is_down:false,is_move:false,zoomIn:1,tos:null,path:null,pathArray:null,gesture:{isStart:false,pos:null,zoom:1,line:0,zoomUp:1},pens:{width:16,color:"rgb(237, 68, 61)",op:0.5},tempPens:{width:16,color:"rgb(237, 68, 61)",op:0.5,penList:[],opList:[],colorList:[]},pagePathSave:[],pageImgSave:[],okButtonEvent:a};a=null;b.swipeOption.is_start=false;b.swipeOption.s_x=0;b.swipeOption.s_y=0;b.swipeOption.e_x=0;b.swipeOption.e_y=0;b.tripleEvent.x=0;b.tripleEvent.y=0;b.tripleEvent.cnt=0;b.eFormRadioChecked={};b.eFormCheckboxChecked={};b.m_nextPageSave={poNum:-1,strPageData:null};b.m_properties=function(){};b.m_isThumbnail=false;b.m_isSplitView=false;b.m_splitView={pos:null,arr:null,zoomRate:null,stopPos:{x:0,y:0},isStopButton:false,isMoveButton:true,leftButton:null,centerButton:null,rightButton:null,isQuick:false,time:5000,pageInfo:[],event:null,inputOrder:null};b.m_eformPageDisabled=[];b.m_objClipDocument=null;b.m_isNecessaryInfo=null;b.ctrlEvent={inputFocusEvent:null,inputBlurEvent:null,inputKeyUpEvent:null,inputRequiredGuideEvent:null,inputChangeEvent:null,buttonClickEvent:null,calendarClickEvent:null,calendarDayClickEvent:null,checkboxCheckedEvent:null,checkboxUnCheckedEvent:null,imageClickEvent:null,radioboxSelectedEvent:null,radioboxUnSelectedEvent:null,radioboxSelectedClickEvent:null,selectboxChangeEvent:null,signClickEvent:null,signOkButtonEvent:null,signCencelButtonEvent:null,signNextButtonEvent:null,signGroupClickEvent:null,signGroupOkButtonEvent:null,signGroupCencelButtonEvent:null,signGroupNextButtonEvent:null,disabledEvent:null};b.m_objReportCheck.checkCount=0;b.m_chat.message=[];b.m_chat.viewDom=null;b.m_chat.body=null;b.m_SearchWordDocument=null;b.m_saveJsonDoc=null;b.m_saveJsonDocPageList=null;b.m_saveOrigin=null;return b;}function createEForm(b,c,d){if(null==d){mRe_ReportEventHandler(20);}var a=new Report(b,null,null,c,d);a.is_eForm=true;eform_init(a);return a;}function createJSPEForm(c,d,b,f){if(null==f){mRe_ReportEventHandler(20);}var a=new Report(c,d,b,null,f);a.is_eForm=true;eform_init(a);return a;}function createImportJSPEForm(b,d,c){if(null==c){mRe_ReportEventHandler(20);}var a=new Report(b,null,null,null,c);a.is_eForm=true;a.m_reportKey=d;eform_init(a);return a;}function createImportViewDataEForm(b,d){if(null==d){mRe_ReportEventHandler(20);}var a=new Report(null,null,null,null,d,b);a.is_eForm=true;var c=mCR_UUID();a.m_reportKey="({'status':true,'pageNum':0,'wait':0.0,'uid':'"+c+"','version':{'build':'','day':''}})";eform_init(a);a.m_isObjJSONSVG=true;a.m_isJsonAllPage=true;return a;}function eform_init(a){a.tocOption={nec:[false,false,false],viewPN:[{visible:false,startCh:"",endCh:""},{visible:false,startCh:"",endCh:""},{visible:false,startCh:"",endCh:""}]};a.tripleEvent={isDisabled:false,x:0,y:0,cnt:0};a.m_eformDisabled=false;a.m_eformDisabledMirr=false;a.m_eformPageDisabled=[];a.m_isEFormPageMoveEvent=null;a.eFormRadioChecked={};a.eFormCheckboxChecked={};a.m_twoTouchEvtDisabled=false;a.m_signMoveCount=9;a.m_isPreviewImg=false;a.m_nextPageSave={poNum:-1,strPageData:null};a.m_isDefaultDoodleVisble=false;a.multiView={isSocket:false,socekt:null};a.m_isMultiViewFoucs=false;a.m_isThumbnail=false;a.m_isInputFocus=false;a.m_focusInputDOM=null;a.m_isSplitView=false;a.m_splitView={pos:null,arr:null,zoomRate:null,stopPos:{x:0,y:0},isStopButton:false,isMoveButton:true,leftButton:null,centerButton:null,rightButton:null,isQuick:false,time:5000,pageInfo:[],event:null,inputOrder:null};a.m_subReportEvent={callReportBefore:null,closeReportAfter:null};a.m_socketReportEvent={userData:null,socketStatusEvnet:null};a.m_isPopupSelect=false;a.m_isHybridQuickControl=false;a.m_isHybridQuickControlLock=false;a.m_nQuickControlMobileZoom=null;a.m_nQuickControlMobileZoomEnabled=true;a.m_nHybridTempZoom=null;a.m_HybridQuickControlEvent=null;a.m_isGuiderLineDisplay=true;a.m_isGuiderLinePinPaper=false;if(is_exeMirroring){a.m_isGuiderLineDisplay=false;}a.m_SubInputCallButtonText="사용자입력";a.m_isHybridQuickControlZoom=false;a.isSubWebApp=false;a.isSubAppType=false;a.m_socketViewEvent=null;a.m_BeforeInputMovementEvent=null;a.m_isOldMultiSign=false;a.m_isObjectStamp=true;a.m_bDisPlayTitle=true;a.m_isBottomPopSign=false;a.m_isBottomPopScroll=false;a.m_isBottomPopTitle=false;a.m_isBottomPopHeight=0;a.m_isBottomPopLandscapeHeight=0;a.m_signMirroringVisible=false;a.m_isImagePointer={visible:false,visibleRect:false,focusOutHidden:false,delayHidden:false,delayTime:3,timeOutEvent:null,imgPo:1};a.ctrlEvent={inputFocusEvent:null,inputBlurEvent:null,inputKeyUpEvent:null,inputRequiredGuideEvent:null,inputChangeEvent:null,buttonClickEvent:null,calendarClickEvent:null,calendarDayClickEvent:null,checkboxCheckedEvent:null,checkboxUnCheckedEvent:null,imageClickEvent:null,radioboxSelectedEvent:null,radioboxUnSelectedEvent:null,radioboxSelectedClickEvent:null,selectboxChangeEvent:null,signClickEvent:null,signOkButtonEvent:null,signCencelButtonEvent:null,signNextButtonEvent:null,signGroupClickEvent:null,signGroupOkButtonEvent:null,signGroupCencelButtonEvent:null,signGroupNextButtonEvent:null,signValidationEvent:null,eventTarget:null};a.neterrEvent=null;a.m_ControlDoodleVisible=false;if(typeof window.report_version!="undefined"){if(-1!=window.report_version.indexOf("5.")){a.m_ControlDoodleVisible=true;}}a.objSpeechBubbleFrame=new mCR_ReportSpeechBubbleFrame(a,is_ie);a.objTextBuilder=new mCR_TextBuilder();a.m_chat={isVisible:false,message:[],viewDom:null,body:null};a.isEasyInput=false;a.isEasyInputHidden=false;a.m_RuleCtrlVisible=false;a.isUseSignPopupBGEvent=true;a.m_isEFormAutoIndex=false;a.penDefaultShiftKey=false;a.mustSignPenWidth=null;a.mustInputNumberPadMaxLength=null;a.mustSignStrokeWidth=null;a.isUseSignGroupSlide=false;a.isUseSignSlide=false;a.isUseSignSlideByViewText=false;a.isSignUndoRedoHidden=false;a.m_doodlePenToggleBtn=false;a.m_doodlePenToggleBtnDom=null;a.m_doodlePenBGOpacity=0.6;a.m_saveReportInfoList=null;a.m_blockScreenType="none";a.m_isEndMainData=false;a.m_isEndViewData=false;a.m_stampDefaultType=0;a.m_isStampDefaultTypeIgnore=false;a.m_zeroValueKBD=false;a.m_multiSignViewType=0;a.m_isEngKeyOnly=true;a.m_UseWonFormat=true;a.m_useSubViewCtrl=false;a.m_useSubViewCtrlStyle="";a.m_useSubViewCtrlClassName="";a.m_useSubViewCtrlIsMouse=true;a.m_useDirectDoodlePen=false;a.m_useDirectDoodlePenEvent=false;a.m_exeSignScriptRate=128;a.memoButtonEvent=null;a.memoBGClickEvent=null;a.m_isUsePopupInputFrame={input:false,calendar:false,check:false,radio:false,select:false,sign:false,signGroup:false};a.titleSpeechBubble={isEnable:false,id:null,bgColor:"rgb(0,0,0)",color:"rgb(255,255,255)",size:25,time:3000,width:400,height:90,textMargin:10,textAlign:"left",clearTime:null,visible:{input:true,sign:true,signGroup:true,checkbox:false,radiobox:false,selectbox:false,calendar:false,button:false,image:false}};a.isMainStampScanner=false;a.mainStampScannerEvent=null;a.m_mirroringScrollSyncTime=null;a.m_eformCheckLabelVisible=false;a.m_eformSignMarginSync=false;a.isSignRatioCorrection=false;a.m_isSignWriteAlong=false;a.m_isSignWriteAlongByFontSize=120;a.m_isSignWriteAlongByOnlyPen=false;a.beforeSendViewDataEvent=null;a.endSendViewDataEvent=null;a.isDBLClickSubCallKeyboard=false;a.m_isServerSyncMirroring=false;a.m_aSyncMirrData=[];a.m_isMainNecessaryInputEnabled=true;}Report.prototype.setMainNecessaryInputEnabled=function(a){this.m_isMainNecessaryInputEnabled=a;};Report.prototype.mRe_MainNecessaryInputEnabledCheckControl=function(a){if(this.isMain&&this.multiView.isSocket&&!this.m_isMainNecessaryInputEnabled&&"true"==a.controlData.isNecessaryCheck){return false;}return true;};Report.prototype.setServerSyncMirroring=function(a){this.m_isServerSyncMirroring=a;};Report.prototype.setUseDirectDoodlePen=function(a){this.m_useDirectDoodlePen=a;};Report.prototype.setDBLClickSubCallKeyboard=function(a){this.isDBLClickSubCallKeyboard=a;};Report.prototype.setBeforeSendViewDataEvent=function(a){this.beforeSendViewDataEvent=a;};Report.prototype.setEndSendViewDataEvent=function(a){this.endSendViewDataEvent=a;};Report.prototype.setUseSignMarginSync=function(a){this.m_eformSignMarginSync=a;};Report.prototype.setUseCheckLabelVisibleSync=function(a){this.m_eformCheckLabelVisible=a;};Report.prototype.setUseMainStampScanner=function(a){this.isMainStampScanner=a;};Report.prototype.setUseSignRatioCorrection=function(a){this.isSignRatioCorrection=a;};Report.prototype.setMainStampScannerEvent=function(a){this.mainStampScannerEvent=a;};Report.prototype.setMirroringScrollSyncTime=function(a){this.m_mirroringScrollSyncTime=a;};Report.prototype.setUsePopupInputFrame=function(a){if(is_smartphone){if(a){this.setBottomPopSign(true);this.m_isPopupSelect=true;this.m_isUsePopupInputFrame.input=true;this.m_isUsePopupInputFrame.calendar=true;this.m_isUsePopupInputFrame.check=true;this.m_isUsePopupInputFrame.radio=true;this.m_isUsePopupInputFrame.select=true;this.m_isUsePopupInputFrame.sign=true;this.m_isUsePopupInputFrame.signGroup=true;}}};Report.prototype.setUsePopupInputFrameByTypeInput=function(a){if(is_smartphone){if(a){this.m_isUsePopupInputFrame.input=true;}}};Report.prototype.setUsePopupInputFrameByTypeCalendar=function(a){if(is_smartphone){if(a){this.m_isUsePopupInputFrame.calendar=true;}}};Report.prototype.setUsePopupInputFrameByTypeCheckbox=function(a){if(is_smartphone){if(a){this.m_isUsePopupInputFrame.check=true;}}};Report.prototype.setUsePopupInputFrameByTypeRadiobox=function(a){if(is_smartphone){if(a){this.m_isUsePopupInputFrame.radio=true;}}};Report.prototype.setUsePopupInputFrameByTypeSelectbox=function(a){if(is_smartphone){if(a){this.m_isUsePopupInputFrame.select=true;this.m_isPopupSelect=true;}}};Report.prototype.setUsePopupInputFrameByTypeSign=function(a){if(is_smartphone){if(a){this.setBottomPopSign(true);this.m_isUsePopupInputFrame.sign=true;}}};Report.prototype.setUsePopupInputFrameByTypeSignGroup=function(a){if(is_smartphone){if(a){this.m_isUsePopupInputFrame.signGroup=true;}}};Report.prototype.setBottomPopSignHeight=function(b,a){this.m_isBottomPopHeight=b;if(typeof a=="undefined"){this.m_isBottomPopLandscapeHeight=b;}else{this.m_isBottomPopLandscapeHeight=a;}};Report.prototype.setBottomPopSignSingleTitle=function(a){this.m_isBottomPopTitle=a;};Report.prototype.setBottomPopSignSingleTitle=function(a){this.m_isBottomPopTitle=a;};Report.prototype.setBottomPopSignScroll=function(a){this.m_isBottomPopScroll=a;};Report.prototype.setBottomPopSign=function(a){this.m_isBottomPopSign=a;};Report.prototype.setInputDisPlayTitle=function(a){this.m_bDisPlayTitle=a;};Report.prototype.pageScrollEFormEvent=function(c){if(this.m_isInputFocus&&!is_smartphone){this.m_isHybridQuickControlZoom=false;}if(this.multiView.isSocket){if(!this.multiView.socket.isMain){this.multiView.socket.sendScrollPosition(c,this.m_uid);}else{var b=document.getElementById("scroll_guider"+this.m_uid);if(b!=null){var a=document.getElementById("scroll_guider_selector"+this.m_uid);var g=a.getAttribute("pinStatus");if(g=="true"&&!this.multiView.socket.m_scrollYLock){b.style.top=a.style.top=this.paintDiv.offsetTop+"px";this.multiView.socket.sendScrollYPosition(c,this.m_uid);this.multiView.socket.scrollTop=this.paintDiv.scrollTop;}else{var f=this.multiView.socket.scrollTop;var d=this.paintDiv.offsetTop-this.paintDiv.scrollTop;b.style.top=a.style.top=(f+d)+"px";}}}}};Report.prototype.createEFormView=function(){if(this.m_isSplitView){this.first_button.style.cssText="left:-9999px;top:-999px;";this.last_button.style.cssText="left:-9999px;top:-999px;";this.save_button.style.cssText="left:-9999px;top:-999px;";this.zoomCombo.style.cssText="left:-9999px;top:-999px;";this.doodle_button.style.cssText="left:-9999px;top:-999px;";var d=this.m_splitView.leftButton=document.createElement("button");var m=this.m_splitView.centerButton=document.createElement("button");var l=this.m_splitView.rightButton=document.createElement("button");d.className="eform_slide_button eform_slide_button_left";m.className="eform_slide_button eform_slide_button_center";l.className="eform_slide_button eform_slide_button_right";var h=this;if(this.m_splitView.isQuick){var k=this.m_splitView.inputOrder;d.onclick=function(){h.focusSplitViewQuickInputOrder(k);};m.onclick=function(){h.changeRatioCombo("PageWidth");};l.onclick=function(){h.focusSplitViewQuickInputOrder(k);};}else{m.className="eform_slide_button eform_slide_button_stop";d.onclick=function(){m.className="eform_slide_button eform_slide_button_play";h.prevSplitView();};m.onclick=function(){m.className="eform_slide_button eform_slide_button_stop";h.stopSplitView();};l.onclick=function(){m.className="eform_slide_button eform_slide_button_play";h.nextSplitView();};}this.targetDiv.firstChild.appendChild(d);this.targetDiv.firstChild.appendChild(m);this.targetDiv.firstChild.appendChild(l);}var i=document.getElementById("scroll_guider_selector"+this.m_uid);if(i!=null&&this.m_useSubViewCtrlIsMouse){var j=document.getElementById("scroll_guider"+this.m_uid);var b=this.paintDiv.offsetTop;var g=this;i.downFlag=2;i.addEventListener("mousedown",function(o){i.downFlag=0;i.moveFlag=0;g.debugMeg("sg_selector:mousedown:event:",o);i.event=o;j.style.zIndex="149";},false);j.onmousemove=i.onmousemove=function(t){i.moveFlag=1;var u=0;if(!t.which&&t.button){if(t.button&1){t.which=1;}}u=t.which;if(is_ie){if(t.buttons!=null){u=t.buttons;}}if(u!=1){i.downFlag=2;}if(i.downFlag==0){var s=t.movementY;s=t.clientY-i.event.clientY;i.event=t;g.debugMeg("sg_selector.event:event.clientY:",t);if(j!=null){var p=parseInt(j.style.top,10);var q=parseInt(j.style.height,10);var o=g.paintDiv.firstChild.clientHeight;var r=g.paintDiv.scrollTop;if(p+s>=b-r){if(p+s+q+r<o+b){j.style.top=i.style.top=(p+s)+"px";}}else{j.style.top=i.style.top=b+"px";}}else{g.debugMeg("guider null!!");}}};j.onmouseup=i.onmouseup=function(o){g.debugMeg("sg_selector:mouseup:event:",o);if(i.moveFlag===0){i.downFlag=1;g.debugMeg("click");}else{if(i.moveFlag===1&&i.downFlag==0){g.debugMeg("drag");i.downFlag=1;g.multiView.socket.sendScrollTo(g);}}i.downFlag=2;j.style.zIndex="130";};j.onmouseleave=function(o){if(i.moveFlag===0){i.downFlag=1;g.debugMeg("click");}else{if(i.moveFlag===1&&i.downFlag==0){g.debugMeg("drag");i.downFlag=1;g.multiView.socket.sendScrollTo(g);}}i.downFlag=2;j.style.zIndex="130";};this.paintDiv.addEventListener("mousedown",function(s){if(s.ctrlKey){if(i.offsetHeight>10){if(j!=null){var o=parseInt(j.style.height,10)/2;var t=0;var q=g.paintDiv;while(null!=q){t+=q.offsetTop;q=q.parentElement;}var r=g.paintDiv.scrollTop;var p=s.clientY-t;if((o)>(p+r)){j.style.top=i.style.top=b+"px";}else{j.style.top=i.style.top=(p-b)+"px";}}g.multiView.socket.sendScrollTo(g);}}});}else{this.debugMeg("sg_selector null!!!");}if(this.multiView.isSocket){var n=document.createElement("button");n.className="eform_image_chat";if(this.m_chat.isVisible){n.style.display="block";}this.targetDiv.appendChild(n);var f=this;n.onclick=function(){f.mRe_chatPopup();};}if(this.m_doodlePenToggleBtn){var c=document.createElement("button");this.m_doodlePenToggleBtnDom=c;if(this.eFormDoodleOption.is_Ds){this.m_doodlePenToggleBtnDom.className="eform_doodlepen_toggleBtn_close";}else{this.m_doodlePenToggleBtnDom.className="eform_doodlepen_toggleBtn";}var a=this;this.m_doodlePenToggleBtnDom.onmousedown=this.m_doodlePenToggleBtnDom.touchstart=function(){if(a.eFormDoodleOption.is_Ds){a.closeDoodle();}else{a.EFormDoodle();}};this.targetDiv.appendChild(c);}};Report.prototype.mRe_chatPopup=function(){if(null==this.m_chat.viewDom||null==this.m_chat.viewDom.parentElement){var c=this;var k=document.createElement("div");k.className="eform_chat_layout";this.targetDiv.appendChild(k);this.m_chat.viewDom=k;var b=document.createElement("div");b.className="eform_chat_frame";k.appendChild(b);var a=document.createElement("div");a.className="eform_chat_body";b.appendChild(a);this.m_chat.body=a;var i=document.createElement("input");i.className="eform_chat_box eform_chat_input";i.placeholder="Enter your message...";b.appendChild(i);var j=document.createElement("button");j.className="eform_chat_box eform_chat_sendButton";j.innerHTML="전송";b.appendChild(j);var f=document.createElement("button");f.className="eform_chat_box eform_chat_closeButton";f.innerHTML="닫기";b.appendChild(f);if(is_appControl||(is_exeControl&&this.multiView.isSocket&&!this.multiView.isMain)){if(is_appControl){i.readOnly=true;}var h;try{h=window.top;}catch(g){console.error("최상위 window 객체에 접근할 수 없습니다:",g);h=window;}h.set_report_input_data_ex=function(m,l){if("set"===m){c.mRe_chatSendData(l);i.value="";}};h.set_report_input_data=function(m,l){if("ok"==m||"next"==m){c.mRe_chatSendData(l);i.value="";}};i.onmousedown=function(){var m=new Object();m.id=i.id;m.title="메시지 입력";m.guideMsg="";m.type="text";m.maxLength=0;m.text="";m.format="";m.isSetRealTimeKeyPressed=c.m_exeOption.isVirtualKeyboardKeyPressedSetInputText;if(is_appControl){ClipHybrid.callNativeControl("edit",JSON.stringify(m));}else{var l={methodName:"ShowVirtualKeyboard",data:null};l.data=m;window.external.ClipSubWebBrowserCtrl_Invoke(JSON.stringify(l));}};}else{i.onkeypress=function(l){if(l.keyCode==13){var m=i.value;c.mRe_chatSendData(m);i.value="";}};}j.onclick=function(){var l=i.value;c.mRe_chatSendData(l);i.value="";};f.onclick=function(){i.value="";k.style.display="none";};window.addEventListener("resize",function(){c.mRe_chatPopupReSize();});for(var d=0;d<this.m_chat.message.length;d++){this.mRe_chatMakeMsgBox(this.m_chat.message[d]);}}else{if("block"==this.m_chat.viewDom.style.display){return;}this.m_chat.viewDom.style.display="block";}this.mRe_chatPopupReSize();};Report.prototype.mRe_chatPopupReSize=function(){if(this.m_chat&&null!=this.m_chat.viewDom){var b=this.m_chat.viewDom.firstChild;var a=(this.m_chat.viewDom.offsetWidth-b.offsetWidth)/2;b.style.left=a+"px";}};Report.prototype.mRe_chatMakeMsgBox=function(a){var c=document.createElement("div");var b=document.createElement("div");c.appendChild(b);if(a.user==1){c.className="eform_chat_right_Layout";b.className="eform_chat_right_msg";}else{c.className="eform_chat_left_Layout";b.className="eform_chat_left_msg";}b.innerHTML=a.data;a.dom=c;this.m_chat.body.appendChild(c);this.m_chat.body.scrollTop=this.m_chat.body.scrollHeight;};Report.prototype.mRe_chatSendData=function(b){if(b.trim()==""){return;}var a={data:b,user:1,dom:null};this.mRe_chatMakeMsgBox(a);this.m_chat.message.push(a);if(this.multiView.isSocket){this.multiView.socket.sendChatMessage(b,this.m_uid);}};Report.prototype.mRe_chatReceiveData=function(b){var a={data:b,user:0,dom:null};this.mRe_chatMakeMsgBox(a);this.m_chat.message.push(a);};Report.prototype.eformCreateTag=function(l,o){var h=is_smartphone?"m_":"";var b=this;if(this.multiView.isSocket){if(this.multiView.socket.isMain){var E="";if(!this.m_isGuiderLineDisplay){E="display:none;";}var c=mRe_makeDivTag("scroll_guider"+o,"eform_scroll_guider","position:absolute;left:2px;top:0px;height: 0px; border:0px solid gold;overflow:hidden;margin:0 auto;z-index:130;"+E);l.appendChild(c);var s="width:22px;background:gold;";if(this.m_useSubViewCtrl){s="width:12px;background:rgba(255,215,0,0.5);";}else{c.style.right="18px";}var d=mRe_makeDivTag("scroll_guider_selector"+o,"eform_scroll_guiderBar","position:absolute;left:2px;top:0px;height: 0px;border:0px solid gold;overflow:hidden;pointer-events: auto;text-align:center;z-index:149;"+E+s);var r=mRe_makeButtonTag("","","eform_scroll_guiderPin","position:relative;left:0px;right:0px;height:30px;background:none;border:none;padding:0;",false,function(){var aa=d.getAttribute("pinStatus");if(aa=="false"){d.setAttribute("pinStatus","true");this.innerText="▶";}else{d.setAttribute("pinStatus","false");this.innerText="▽";}});if(this.m_isGuiderLinePinPaper){d.setAttribute("pinStatus","true");r.innerText="▶";}else{d.setAttribute("pinStatus","false");r.innerText="▽";}d.appendChild(r);l.appendChild(d);}window.addEventListener("resize",function(){b.zoomChangeEForm();});}var P=mRe_makeDivTag("re_menu"+o,h+"eform_menu_div",((this.m_isMenu)?"":"height:0px;display:none;")+(null!=this.menuDiv?(typeof this.menuDiv==="string"?this.menuDiv:this.menuDiv.style.cssText):"")+";z-index:150;");l.appendChild(P);var Z=mRe_makeTableNobrTag(P,null,null,"report_menu_table","report_menu_table_td",h+"eform_menu_table_td_div");if(this.m_isSplitView){var T=mRe_makeButtonTag("re_setting"+o,"setting",h+"eform_menu_button "+(this.m_disControl.setting?h+"eform_menu_dis_setting_button":h+"eform_menu_setting_button"),(null!=this.setting_button?(typeof this.setting_button==="string"?this.setting_button:this.setting_button.style.cssText):""),this.m_disControl.setting,function(){b.m_splitViewSetting();return false;});Z.appendChild(T);}var a=mRe_makeButtonTag("re_first"+o,this.m_languageMap.first_page,h+"eform_menu_button "+(this.m_disControl.first?h+"eform_menu_dis_leftEnd_button":h+"eform_menu_leftEnd_button"),(null!=this.first_button?(typeof this.first_button==="string"?this.first_button:this.first_button.style.cssText):""),this.m_disControl.first,function(){b.firstPage("menu_button");return false;});Z.appendChild(a);var v=mRe_makeButtonTag("re_prev"+o,this.m_languageMap.prv_page,h+"eform_menu_button "+(this.m_disControl.prev?h+"eform_menu_dis_left_button":h+"eform_menu_left_button"),(null!=this.prev_button?(typeof this.prev_button==="string"?this.prev_button:this.prev_button.style.cssText):""),this.m_disControl.prev,function(){b.previousPage("menu_button");return false;});Z.appendChild(v);var i=mRe_makeTableTag(Z,null,null,h+"eform_input_table",h+"eform_input_table_td_input");var I=mRe_makeMenuInputTag("re_input"+o,"","1",h+"eform_menu_pageCount_input",this.m_languageMap.page,"border:0px none !important;"+(null!=this.input?(typeof this.input==="string"?this.input:this.input.style.cssText):""));I.disabled=this.m_disControl.input;if(is_smartphone){if(is_apple){I.type="tel";}else{I.type="number";}}I.onkeypress=function(aa){enterEvent(aa,b,this);};I.onblur=function(aa){b.selectPage(Number(this.value)-1,"menu_input");};i.appendChild(I);var N=document.createElement("td");N.className=h+"eform_input_table_td";N.onclick=function(){b.mRe_pageCountLabelClick();return false;};i.parentElement.appendChild(N);var Y=mRe_makeMenuInputTag("re_totalCountNumber"+o,"","/ 0",h+"eform_menu_pageCount_span",this.m_languageMap.total_page,(null!=this.totalCountSpan?this.totalCountSpan:""));Y.readOnly=true;N.appendChild(Y);var t=document.createElement("span");t.id="re_totalCount"+o;t.className=h+"eform_menu_pageCount_span";t.style.cssText="border:0px none !important;"+(null!=this.totalCountSpan?(typeof this.totalCountSpan==="string"?this.totalCountSpan:this.totalCountSpan.style.cssText):"");t.disabled=this.m_disControl.caption;N.appendChild(t);var m=document.createElement("img");m.id="re_progressImg"+o;m.alt="전자서식 생성중 표시";m.className="report_menu_progress";m.src=progressImg();t.appendChild(m);var W=mRe_makeButtonTag("re_next"+o,this.m_languageMap.next_page,h+"eform_menu_button "+(this.m_disControl.next?h+"eform_menu_dis_right_button":h+"eform_menu_right_button"),(null!=this.next_button?(typeof this.next_button==="string"?this.next_button:this.next_button.style.cssText):""),this.m_disControl.next,function(){b.nextPage("menu_button");return false;});Z.appendChild(W);var f=mRe_makeButtonTag("re_last"+o,this.m_languageMap.last_page,h+"eform_menu_button "+(this.m_disControl.last?h+"eform_menu_dis_rightEnd_button":h+"eform_menu_rightEnd_button"),(null!=this.last_button?(typeof this.last_button==="string"?this.last_button:this.last_button.style.cssText):""),this.m_disControl.last,function(){b.lastPage("menu_button");return false;});Z.appendChild(f);var M=document.createElement("select");M.id="re_zoomSelect"+o;M.name="zoomSelect";M.title=this.m_languageMap.zoomIn;M.className=h+"eform_menu_zoom_combo";M.style.cssText=(null!=this.zoomCombo?(typeof this.zoomCombo==="string"?this.zoomCombo:this.zoomCombo.style.cssText):"");M.disabled=this.m_disControl.zoomIn;M.onchange=function(){b.zoomIn(this);};this.comboOptionCreateTag(M);Z.appendChild(M);if(!is_window_safari){if(!this.m_isAccessibility){var y=mRe_makeButtonTag("re_doodle"+o,this.m_languageMap.doodle,h+"eform_menu_button "+(this.m_disControl.doodle?h+"eform_menu_dis_doodle_button":h+"eform_menu_doodle_button"),(null!=this.doodle_button?(typeof this.doodle_button==="string"?this.doodle_button:this.doodle_button.style.cssText):""),this.m_disControl.doodle,function(){b.EFormDoodle();return false;});Z.appendChild(y);}if((typeof window.report_version=="undefined")||((-1!=window.report_version.indexOf("5."))&&(!this.multiView.isSocket||(this.multiView.isSocket&&this.isMain)))){if(!this.m_isAccessibility){var k=mRe_makeButtonTag("re_memo"+o,this.m_languageMap.memo,h+"eform_menu_button "+(this.m_disControl.memo?"eform_menu_dis_memo_button":"eform_menu_memo_button"),(null!=this.memo_button?(typeof this.memo_button==="string"?this.memo_button:this.memo_button.style.cssText):""),this.m_disControl.memo,function(){b.EFormMemo(true);return false;});Z.appendChild(k);}var Q=mRe_makeButtonTag("re_eformInfo"+o,this.m_languageMap.report_info,h+"eform_menu_button eform_menu_eformInfo_button",(null!=this.reportInfo_button?(typeof this.reportInfo_button==="string"?this.reportInfo_button:this.reportInfo_button.style.cssText):"display:none;"),this.m_disControl.reportInfo,function(){b.reportInfo();return false;});Z.appendChild(Q);if(this.m_isObjJSONSVG&&this.isSearchWord){var K=mRe_makeButtonTag("re_searchWord"+o,this.m_languageMap.search,h+"eform_menu_button eform_menu_searchword_button",(null!=this.searchWord_button?(typeof this.searchWord_button==="string"?this.searchWord_button:this.searchWord_button.style.cssText):""),false,function(){b.m_callSearchWord();return false;});Z.appendChild(K);}}}if(!is_smartphone){var G=mRe_makeButtonTag("re_print"+o,this.m_languageMap.print,h+"eform_menu_button "+(this.m_disControl.print?h+"eform_menu_dis_print_button":h+"eform_menu_print_button"),(null!=this.print_button?(typeof this.print_button==="string"?this.print_button:this.print_button.style.cssText):""),this.m_disControl.print,function(){b.EFormPrint();return false;});Z.appendChild(G);}if(this.m_useSubViewCtrl&&this.multiView.isSocket&&this.isMain){var B=document.createElement("select");B.id="re_subZoomSelect"+o;B.name="subZoomSelect";B.title="sub"+this.m_languageMap.zoomIn;B.className="eform_menu_sub_zoom_combo "+this.m_useSubViewCtrlClassName;B.style.cssText=this.m_useSubViewCtrlStyle;B.onchange=function(){b.subZoomIn(this.value);};mRe_makeOptionTag(B,"p125","1.25",this.m_comboNames.num125.name);mRe_makeOptionTag(B,"p150","1.5",this.m_comboNames.num150.name);mRe_makeOptionTag(B,"p200","2",this.m_comboNames.num200.name);mRe_makeOptionTag(B,"pWidth","PageWidth",this.m_comboNames.pagewidth.name);var u=mRe_makeOptionTag(B,"pWhole","WholePage",this.m_comboNames.wholepage.name);u.selected=true;Z.appendChild(B);}var j=mRe_makeButtonTag("re_save"+o,this.m_languageMap.save,h+"eform_menu_button "+(this.m_disControl.save?h+"eform_menu_dis_save_button":h+"eform_menu_save_button"),(null!=this.save_button?(typeof this.save_button==="string"?this.save_button:this.save_button.style.cssText):""),this.m_disControl.save,function(){b.EFormSave();return false;});Z.appendChild(j);var H=mRe_makeButtonTag("re_close"+o,this.m_languageMap.close,h+"eform_menu_button "+(this.m_disControl.close?h+"eform_menu_dis_close_button":h+"eform_menu_close_button"),(null!=this.close_button?(typeof this.close_button==="string"?this.close_button:this.close_button.style.cssText):""),this.m_disControl.close,function(){b.closeReport();return false;});Z.appendChild(H);for(var U=0;U<this.m_menuCustomButton.length;U++){var z=this.m_menuCustomButton[U];var p=z.elm;p.className=h+"eform_menu_button "+z.css;p.style.cssText=z.style;p.innerText=z.text;p.onclick=z.func;Z.appendChild(p);}Z=mRe_makeTableNobrTag(P,"re_doodleDiv"+o,"display:none;","report_menu_table","report_menu_table_td",h+"eform_menu_table_td_div");if(!this.m_isAccessibility){var g=mRe_makeButtonTag("re_doodleprev"+o,this.m_languageMap.prv_page,h+"eform_menu_button "+(this.m_disControl.prev?h+"eform_menu_dis_left_button":h+"eform_menu_doodleleft_button"),(null!=this.prev_button?(typeof this.prev_button==="string"?this.prev_button:this.prev_button.style.cssText):""),this.m_disControl.prev,function(){b.previousDoodlePage();return false;});Z.appendChild(g);var i=mRe_makeTableTag(Z,null,null,h+"eform_doodle_pageinfo_table","");i.id="re_doodle_pageinfo"+o;i.onclick=function(){b.mRe_pageCountLabelClick();return false;};var J=mRe_makeButtonTag("re_doodlenext"+o,this.m_languageMap.next_page,h+"eform_menu_button "+(this.m_disControl.next?h+"eform_menu_dis_right_button":h+"eform_menu_doodleright_button"),(null!=this.next_button?(typeof this.next_button==="string"?this.next_button:this.next_button.style.cssText):""),this.m_disControl.next,function(){b.nextDoodlePage();return false;});Z.appendChild(J);var L=mRe_makeButtonTag("re_doodlepen"+o,this.m_languageMap.doodle,h+"eform_menu_button "+h+"eform_menu_doodlePen_button","",false,function(){b.penDoodle();return false;});Z.appendChild(L);var X=mRe_makeButtonTag("re_doodlepallet"+o,this.m_languageMap.doodleSetting,h+"eform_menu_button "+h+"eform_menu_doodlePallet_button","",false,function(){b.palletDoodle();return false;});Z.appendChild(X);var n=mRe_makeButtonTag("re_doodleeraser"+o,this.m_languageMap.doodleEraser,h+"eform_menu_button "+h+"eform_menu_doodleEraser_button","",false,function(){b.eraserDoodle();return false;});Z.appendChild(n);var R=mRe_makeButtonTag("re_doodleeraserall"+o,this.m_languageMap.doodleClear,h+"eform_menu_button "+h+"eform_menu_doodleEraserAll_button","",false,function(){b.eraserAllDoodle();return false;});Z.appendChild(R);if(is_smartphone){var O=mRe_makeButtonTag("re_doodlemove"+o,"",h+"eform_menu_button "+h+"eform_menu_doodleMove_button","",false,function(){b.moveDoodle();return false;});Z.appendChild(O);}if(this.m_ControlDoodleVisible){var w=mRe_makeButtonTag("re_doodleNecessaryRectAll"+o,this.m_languageMap.doodleRequired,h+"eform_menu_button "+h+"eform_menu_NecessaryRectAll_button","",false,function(){b.mRe_NecessaryRectDoodle();return false;});Z.appendChild(w);}if((typeof window.report_version=="undefined")||((-1!=window.report_version.indexOf("5."))&&!this.multiView.isSocket)){if(is_indexedDB&&!is_ie){var V=mRe_makeButtonTag("re_doodleSave"+o,this.m_languageMap.doodleSave,h+"eform_menu_button eform_menu_doodleOption_button","",false,function(){b.mRe_DoodleSavePopup(this);return false;});Z.appendChild(V);}}H=mRe_makeButtonTag("re_doodleclose"+o,this.m_languageMap.close,h+"eform_menu_button "+(this.m_disControl.close?h+"eform_menu_dis_doodleClose_button":h+"eform_menu_doodleClose_button"),(null!=this.doodle_close_button?(typeof this.doodle_close_button==="string"?this.doodle_close_button:this.doodle_close_button.style.cssText):""),this.m_disControl.close,function(){b.closeDoodle();return false;});Z.appendChild(H);}if((typeof window.report_version=="undefined")||((-1!=window.report_version.indexOf("5."))&&(!this.multiView.isSocket||(this.multiView.isSocket&&this.isMain)))){Z=mRe_makeTableNobrTag(P,"re_memoDiv"+o,"display:none;","report_menu_table","report_menu_table_td",h+"eform_menu_table_td_div");if(!this.m_isAccessibility){var D=mRe_makeButtonTag("re_memonew"+o,this.m_languageMap.memoCreate,"eform_menu_button "+(this.m_disControl.newMemo?"eform_menu_dis_newMemo_button":"eform_menu_newMemo_button"),(null!=this.memo_new_button?(typeof this.memo_new_button==="string"?this.memo_new_button:this.memo_new_button.style.cssText):""),this.m_disControl.newMemo,function(){b.newMemo();return false;});Z.appendChild(D);var F=mRe_makeButtonTag("re_memoopacity"+o,this.m_languageMap.memoViewLook,"eform_menu_button "+(this.m_disControl.opacityMemo?"eform_menu_dis_opacityMemo_button":"eform_menu_opacityMemo_button"),(null!=this.memo_opacity_button?(typeof this.memo_opacity_button==="string"?this.memo_opacity_button:this.memo_opacity_button.style.cssText):""),this.m_disControl.opacityMemo,function(){b.opacityMemo();return false;});Z.appendChild(F);var A=mRe_makeButtonTag("re_memooption"+o,this.m_languageMap.memoSetting,"eform_menu_button "+(this.m_disControl.optionMemo?"eform_menu_dis_optionMemo_button":"eform_menu_optionMemo_button"),(null!=this.memo_option_button?(typeof this.memo_option_button==="string"?this.memo_option_button:this.memo_option_button.style.cssText):""),this.m_disControl.optionMemo,function(){b.optionMemo();return false;});Z.appendChild(A);var C=mRe_makeButtonTag("re_memoclose"+o,this.m_languageMap.close,h+"eform_menu_button "+(this.m_disControl.close?h+"eform_menu_dis_doodleClose_button":h+"eform_menu_doodleClose_button"),(null!=this.memo_close_button?(typeof this.memo_close_button==="string"?this.memo_close_button:this.memo_close_button.style.cssText):""),this.m_disControl.close,function(){b.closeMemo(false);return false;});Z.appendChild(C);}}var S=mRe_makeDivTag("re_paintDiv"+o,h+"eform_paint_div",((this.m_isMenu)?"":"top:0px;")+(null!=this.paintDiv?(typeof this.paintDiv==="string"?this.paintDiv:this.paintDiv.style.cssText):""));S.name="CLIP_REPORT_DIV";if(this.m_mirroringScrollSyncTime){var q=mEM_throttle(function(aa){b.pageScrollEvent(aa);},this.m_mirroringScrollSyncTime);S.addEventListener("scroll",q);if(this.m_mirroringScrollSyncTime>10){var x=mEM_debounce(function(aa){b.pageScrollEvent(aa);},this.m_mirroringScrollSyncTime);S.addEventListener("scroll",x);}}else{S.onscroll=function(aa){b.pageScrollEvent(aa);};}if(is_firefox){S.onwheel=function(aa){if(b.zoomCombo.value=="WholePage"){if(b.mRe_wheelTimeout==null){b.pageMousewheelEvent(aa);}clearTimeout(b.mRe_wheelTimeout);b.mRe_wheelTimeout=setTimeout(function(){b.mRe_wheelTimeout=null;},300);}else{b.pageMousewheelEvent(aa);}};}else{S.onmousewheel=function(aa){if(b.zoomCombo.value=="WholePage"){if(b.mRe_wheelTimeout==null){b.pageMousewheelEvent(aa);}clearTimeout(b.mRe_wheelTimeout);b.mRe_wheelTimeout=setTimeout(function(){b.mRe_wheelTimeout=null;},300);}else{b.pageMousewheelEvent(aa);}};}if(this.m_useDirectDoodlePen){this.addEventDirectDoodlePen(S);}else{if(this.m_useSubViewCtrl&&this.multiView.isSocket&&this.isMain){this.addEventSubViewCtrl(S);}}l.appendChild(S);};Report.prototype.getEFormSaveData=function(b,a){b=null==b?true:b;a=null==a?true:a;this.EF_DoodlePageSave();var c={uid:null,data:null,doodleInfo:[[]]};c.uid=this.m_uid;c.data=this.eFormData;if(a){c.doodleInfo=this.eFormDoodleOption.pagePathSave;}if(b){return mCR_Base64.encode(JSON.stringify(c));}return JSON.stringify(c);};Report.prototype.getEFormTemporaryData=function(b,a){b=null==b?true:b;a=null==a?true:a;this.EF_DoodlePageSave();var c={doodleInfo:[[]],data:null};if(a){c.doodleInfo=this.eFormDoodleOption.pagePathSave;}c.data=this.eFormData;if(b){return mCR_Base64.encode(JSON.stringify(c));}return JSON.stringify(c);};Report.prototype.getEFormTemporaryPenData=function(a){a=null==a?true:a;this.EF_DoodlePageSave();var b=this.eFormDoodleOption.pagePathSave;if(a){return mCR_Base64.encode(JSON.stringify(b));}return JSON.stringify(b);};Report.prototype.setEFormTemporaryPenData=function(c,a){a=null==a?true:a;var b=null;if(a){var b=mCR_Base64.decode(c);}else{var b=c;}if(null!=b){var d=JSON.parse(b);if(null!=d){this.m_isDefaultDoodleVisble=true;this.eFormDoodleOption.pagePathSave=d;if(this.m_isEndReport){this.eraserAllDoodle();this.eFormDoodleOption.pagePathSave=d;this.EF_setLoadPath();}}}};Report.prototype.setEFormTemporaryData=function(c,a){a=null==a?true:a;var b=null;if(a){var b=mCR_Base64.decode(c);}else{var b=c;}if(null!=b){var d=JSON.parse(b);if(null!=d){this.eFormTempData=d;d=null;}}};Report.prototype.setEFormAppendData=function(d,a){a=null==a?true:a;var b=null;if(a){b=mCR_Base64.decode(d);}else{b=d;}if(null!=b){var c=JSON.parse(b);if(null!=c){this.eFormAppendData=c;c=null;}}};Report.prototype.validationEFormData=function(b){var c=false;for(var a in b){if(null==this.eFormTempData.data[a]){this.debugMeg("report log :: 임시저장의 데이터 불일치 control name:"+decodeURI(a.replace(/[r]/ig,"%"))+"  key :"+b[a].id);c=true;}}if(c){this.eFormData=b;this.debugMeg("report log :: 임시저장의 데이터가 리포트폼과 맞지 않습니다.");return;}this.eFormData=this.eFormTempData.data;if(null!=this.m_saveOrigin){this.m_saveOrigin.eformData=this.eFormData;}this.eFormDoodleOption.pagePathSave=this.eFormTempData.doodleInfo;this.eFormTempData=null;};Report.prototype.appendEFormData=function(){if(null!=this.eFormAppendData){for(var b in this.eFormData){var c=this.eFormAppendData.data[b];if(null!=c){var a=this.eFormData[b].pageNumber;c.pageNumber=a;this.eFormData[b]=c;}}this.eFormAppendData=null;}};Report.prototype.updateEFormControl=function(f){for(var b in this.eFormControlList){var d=this.eFormControlList[b];var c=f.eFormControlList[b];if(null==d||null==c){continue;}var a=c.controlData;if(a.type=="sign"||a.type=="signGroup"||a.type=="image"){d.setValue(c.getValue());}else{if(a.type=="input"){d.setValue(c.getValue(),false);}else{if(a.type=="checkbox"){if(a.checked=="true"){d.check(false);}else{d.unCheck(false);}}else{if(a.type=="radiobox"){if(a.checked=="true"){d.select(false);}}else{if(a.type=="calendar"){d.setValue(a.yearValue,a.monthValue,a.dayValue);}else{if(a.type=="selectbox"){if(JSON.stringify(d.controlData.options)==JSON.stringify(a.options)){d.setValue(c.getValue());}else{d.controlData.value=a.value;d.setOptions(a.options);}}else{if(a.type=="button"){d.setValue(c.getValue());d.setLabel(c.getLabel());}}}}}}}d.setDisabled(c.getDisabled(),false);d.setVisible(c.getVisible(),false);}};Report.prototype.getEFormData=function(f){if(typeof f=="undefined"){f=false;}var c=new Object();for(var b in this.eFormControlList){var d=this.eFormControlList[b];var a=d.controlData;if(c[a.id]==null){c[a.id]={data:new Array()};}if(a.type=="sign"||a.type=="signGroup"||a.type=="image"){c[a.id].data.push(a.image);}else{if(a.type=="input"){if(f){c[a.id].data.push(a.value);}else{c[a.id].data.push(a.formatData);}}else{if(a.type=="radiobox"){if(a.checked=="true"){c[a.id].data.push(a.value);}}else{if(a.type=="checkbox"){if(a.checked=="true"){c[a.id].data.push(a.value);}else{if(a.useFalseValue){c[a.id].data.push(a.falseValue);}}}else{if(a.type=="calendar"){c[a.id].data.push(d.getValue());}else{if(a.type=="selectbox"){c[a.id].data.push(a.value);}else{if(a.type=="button"){c[a.id].data.push(a.value);}else{if(a.type=="video"){c[a.id].data.push(a.value);}}}}}}}}}return c;};Report.prototype.EFormPrint=function(){if(this.m_isEndReport){this.eForm_isNecessary.check=false;if(this.RequiredCheckControl()){if(this.eForm_isNecessary.is_start){this.eForm_isNecessary.check=true;}this.eFormSubmitSave("print");this.printWindowView();}}};Report.prototype.EFormSave=function(){if(this.m_isEndReport){this.eForm_isNecessary.check=false;if(this.RequiredCheckControl()){if(this.eForm_isNecessary.is_start){this.eForm_isNecessary.check=true;}if(this.m_buttonEvent.startSaveButton!=null){var a=this.m_buttonEvent.startSaveButton();if(a!=true){return;}}this.eFormSubmitSave("save");}}else{mRe_ReportEventHandler(10);}};Report.prototype.eformDoodlePosition=function(b,c,a,i){var h={x:0,y:0};var j=null;if(b==0){j=c.getBoundingClientRect();var d=document.documentElement;if(is_android&&!is_samsung_browser){j.top=j.top+(d.scrollTop)-(d.clientTop||0);j.left=j.left+(d.scrollLeft)-(d.clientLeft||0);}else{j.top=j.top+(window.pageYOffset||d.scrollTop)-(d.clientTop||0);j.left=j.left+(window.pageXOffset||d.scrollLeft)-(d.clientLeft||0);}this.eFormDoodleOption.tos=j;}else{j=this.eFormDoodleOption.tos;}var f=this.eFormDoodleOption.zoomIn;var k=i?a:a.touches[0];var g=f;if(is_chrome128||is_edge||is_firefox||is_ie){g=1;}if(is_PosiFix){h.x=((j.left*-1*g)+k.clientX)/f;h.y=((j.top*-1*g)+k.clientY)/f;}else{h.x=((j.left*-1*g)+k.pageX)/f;h.y=((j.top*-1*g)+k.pageY)/f;}return h;};Report.prototype.setCloseDoodleButtonEvent=function(a){this.m_buttonEvent.closeDoodleButton=a;};Report.prototype.setVisibleControlDoodle=function(a){this.m_ControlDoodleVisible=a;};Report.prototype.closeMemo=function(a){if(typeof a==="undefined"){a=false;}this.eFormDoodleOption.is_Ds=false;var b=document.getElementById(this.m_uid+"memo");this.memoDiv.previousSibling.previousSibling.style.display="";this.memoDiv.style.display="none";b.style.zIndex="";var c=document.getElementById(this.m_uid+"memo");c.style.opacity=this.nMemoTransparency;this.updateMemo(true);this.objSpeechBubbleFrame.changeIsSpeechBubbleControl(false);this.objSpeechBubbleFrame.closeSpeechBubbleFrame();if(null!=this.memoBGClickEvent){b.isTarget=null;this.paintDiv.memoTempEForm=null;this.paintDiv.removeEventListener("mousedown",memoBGListener);}if(!a){this.m_isMemoEnabled=false;}};Report.prototype.updateMemo=function(h){var b=this;if(this.multiView.isSocket&&h){this.multiView.socket.sendMemoData(this.objSpeechBubbleFrame.arrSpeechBubbleArray,this.m_uid);}var a="uid="+this.m_uid+"&";a+="clipUID="+this.m_uid+"&";a+="ClipType=memoUpdate&ClipData=";var i=this.m_uid;var c=mCR_Base64.encode(JSON.stringify(this.objSpeechBubbleFrame.arrSpeechBubbleArray));var d={reportkey:i,value:c};a+=encodeURIComponent(JSON.stringify(d));if(this.m_postParam!=null){a+=this.m_postParam.getParam();}a=mRe_onBeforeSend(a);if("{clip_enc}"==a){return;}var g=null!=this.m_syncPageServletPath?this.m_syncPageServletPath:this.servletPath;this.debugMeg("EForm log :: 메모 데이터 업로드 통신을 시도합니다 >>>> "+g);var f=new HttpClient();f.send(g,a,true,function(){if(4==this.readyState){if(200==this.status){b.debugMeg("EForm log :: 메모 데이터 업로드 성공!!");}else{b.networkErrorAlert(this.status,true);b.debugMeg("EForm log :: 서버 통신 오류 발생 >>> ajax 통신 상태 "+this.status);mRe_ReportEventHandler(40);b.endDebugMeg(false);mRe_ReportWebLog(this.status);}}});};Report.prototype.receiveMemoData=function(a){var b=document.getElementById(this.m_uid+"memo");if(null!=b){b.innerHTML="";this.objSpeechBubbleFrame.arrSpeechBubbleArray=a;var c=this.objSpeechBubbleFrame.setSpeechBubbleDiv(b);this.objSpeechBubbleFrame.makeAllPageMemo(this.beforePageIndex,c);}};Report.prototype.closeDoodle=function(){this.removePalletDoodle();if(null!=this.m_buttonEvent.closeDoodleButton){try{this.m_buttonEvent.closeDoodleButton();}catch(d){mRe_ReportWebLog(d.stack);}}var a=document.getElementById(this.m_uid+"doodle");var b=a.firstChild;if(0!=b.childNodes.length){var c=b.firstChild;while(c){var f=c;c=c.nextSibling;if("rect"==f.tagName){b.removeChild(f);}}}this.EF_DoodlePageSave();this.eFormDoodleOption.is_Ds=false;this.doodleDiv.previousSibling.style.display="";this.doodleDiv.style.display="none";a.style.zIndex="";this.paintDiv.firstChild.style.opacity="1";a.previousSibling.style.opacity="1";if(this.m_doodlePenToggleBtnDom!=null){this.m_doodlePenToggleBtnDom.className="eform_doodlepen_toggleBtn";}};Report.prototype.previousDoodlePage=function(b){if(typeof b==="undefined"){b="API";}if(!this.eFormDoodleOption.is_Ds){return;}this.removePalletDoodle();this.debugMeg("report log :: 이전 페이지로 이동 합니다.",true);if(this.m_isButtonLock==false){if(this.m_buttonEvent.startPrevButton!=null){var a=this.m_buttonEvent.startPrevButton();if(a!=true){return;}}this.selectPage((this.beforePageIndex-1),b);}};Report.prototype.nextDoodlePage=function(b){if(typeof b==="undefined"){b="API";}if(!this.eFormDoodleOption.is_Ds){return;}this.removePalletDoodle();this.debugMeg("report log :: 다음 페이지로 이동 합니다.",true);if(this.m_isButtonLock==false){if(this.m_buttonEvent.startNextButton!=null){var a=this.m_buttonEvent.startNextButton();if(a!=true){return;}}this.selectPage((this.beforePageIndex+1),b);}};Report.prototype.setMultiSignViewType=function(a){this.m_multiSignViewType=a;};Report.prototype.setEngKeyOnly=function(a){this.m_isEngKeyOnly=a;};Report.prototype.setIsPreviewImg=function(a){this.m_isPreviewImg=a;};Report.prototype.setSignMoveCount=function(a){this.m_signMoveCount=a;};Report.prototype.setSelectBoxPopupView=function(a){this.m_isPopupSelect=a;};Report.prototype.setSubInputCallButtonText=function(a){this.m_SubInputCallButtonText=a;};Report.prototype.pageMove=function(a,b){if(typeof b==="undefined"){b="API";}if(isNaN(a)||!this.m_isEndReport){return;}a--;if(a<0||this.m_pageCount<=a||this.beforePageIndex==a){return;}if(this.eFormDoodleOption.is_Ds){this.removePalletDoodle();}this.m_popupAllClose();this.selectPage(a,b);};Report.prototype.m_popupAllClose=function(){if(null!=mRe_sign){mRe_sign.cencelButton.click();}if(null!=window.mRe_multiSign_close){window.mRe_multiSign_close.click();mRe_reSetPopupStatus();}if(null!=window.mRe_popupInput_close){window.mRe_popupInput_close.click();mRe_reSetPopupStatus();}if(null!=mRe_calendar){var b=mRe_calendar;b.removeCalendarView();b=null;}if(null!=mRe_selectbox){var a=mRe_selectbox;a.removeSelectboxView();a=null;}};Report.prototype.EF_DoodlePageSave=function(){var a=document.getElementById(this.m_uid+"doodle");if(null!=a){var c=a.firstChild;var g=c.childNodes.length;var j=new Array();var b=0;for(var d=0;d<g;d++){var h=c.childNodes[d];var f=h.getAttribute("eraser");if(null==f&&"path"==h.tagName){j[b]=new Object();j[b].id=h.getAttribute("id");j[b].stroke_width=h.getAttributeNS(null,"stroke-width");j[b].stroke=h.getAttributeNS(null,"stroke");j[b].stroke_opacity=h.getAttributeNS(null,"stroke-opacity");j[b].d=h.getAttributeNS(null,"d");b++;}}this.eFormDoodleOption.pagePathSave[this.beforePageIndex]=j;}};Report.prototype.EF_setPathPage=function(){var b=document.getElementById(this.m_uid+"doodle");if(null==b){return;}var c=b.firstChild;if(0==c.childNodes.length){var a=this;var h=this.eFormDoodleOption.pagePathSave[this.beforePageIndex];if(null!=h){var f=h.length;for(var d=0;d<f;d++){var g=document.createElementNS("http://www.w3.org/2000/svg","path");g.setAttribute("id",h[d].id);g.setAttributeNS(null,"style","-webkit-tap-highlight-color: rgba(0, 0, 0, 0);");g.setAttributeNS(null,"stroke-width",h[d].stroke_width);g.setAttributeNS(null,"fill","none");g.setAttributeNS(null,"stroke",h[d].stroke);g.setAttributeNS(null,"stroke-opacity",h[d].stroke_opacity);g.setAttributeNS(null,"d",h[d].d);g.onclick=function(){if(a.eFormDoodleOption.is_eraser){if(a.multiView.isSocket){a.multiView.socket.sendDoodlePathRemove(this,a.m_uid);}c.removeChild(this);}};g.onmousemove=g.ontouchmove=function(){if(a.eFormDoodleOption.is_eraser&&a.eFormDoodleOption.is_eraser_down){if(a.multiView.isSocket){a.multiView.socket.sendDoodlePathRemove(this,a.m_uid);}c.removeChild(this);}};c.appendChild(g);}}}};Report.prototype.mRe_controlLayoutDoodle=function(c){var b=this;var h=this.beforePageIndex;for(var a in this.eFormControlList){var g=this.eFormControlList[a];if(h==g.controlData.pageNumber){var f=g.getRect();if(null!=f){var d=document.createElementNS("http://www.w3.org/2000/svg","rect");d.setAttributeNS(null,"id",this.m_uid+g.ctrlID+"_rect");if(g.controlData.is_nc){d.setAttributeNS(null,"class","svg_rect_Necessary");}else{if("true"==g.controlData.isNecessaryCheck){d.setAttributeNS(null,"class","svg_rect_Necessary_checked");}else{d.setAttributeNS(null,"class","svg_rect_normal");}}d.setAttributeNS(null,"x",f.left);d.setAttributeNS(null,"y",f.top);d.setAttributeNS(null,"width",f.width);d.setAttributeNS(null,"height",f.height);c.appendChild(d);d.addEventListener("mousedown",function(k){if(b.eFormDoodleOption.is_move||!b.eFormDoodleOption.is_Ds){return;}var l=k.currentTarget;var q=l.getAttributeNS(null,"id");var j=Number(l.getAttributeNS(null,"x"));var i=Number(l.getAttributeNS(null,"y"));var n=Number(l.getAttributeNS(null,"width"));var p=Number(l.getAttributeNS(null,"height"));var r=document.getElementById("clip_path"+q);if(b.eFormDoodleOption.is_eraser){if(null!=r){c.removeChild(r);if(b.multiView.isSocket){b.multiView.socket.sendDoodlePathRemove(r,b.m_uid);}}return;}else{if(null!=r){k.stopPropagation();return;}}var o=b.eFormDoodleOption.pens;var r=document.createElementNS("http://www.w3.org/2000/svg","path");r.setAttribute("id","clip_path"+q);r.setAttribute("class","svg_path");r.setAttributeNS(null,"style","-webkit-tap-highlight-color: rgba(0, 0, 0, 0);");r.setAttributeNS(null,"stroke-width",p);r.setAttributeNS(null,"fill","none");r.setAttributeNS(null,"stroke",o.color);r.setAttributeNS(null,"stroke-opacity",o.op);var m=new Array();m[0]="M"+j+","+(i+(p/2));m[1]="L"+(j+n)+","+(i+(p/2));setPath(r,m);c.insertBefore(r,l);r.onclick=function(){if(b.eFormDoodleOption.is_eraser){if(b.multiView.isSocket){b.multiView.socket.sendDoodlePathRemove(this,b.m_uid);}c.removeChild(this);}};r.onmousemove=function(){if(b.eFormDoodleOption.is_eraser&&b.eFormDoodleOption.is_eraser_down){if(b.multiView.isSocket){b.multiView.socket.sendDoodlePathRemove(this,b.m_uid);}c.removeChild(this);}};k.stopPropagation();},false);d.addEventListener("mousemove",function(j){if(b.eFormDoodleOption.is_move||!b.eFormDoodleOption.is_Ds){return;}var i=j.currentTarget;var l=i.getAttributeNS(null,"id");if(b.eFormDoodleOption.is_eraser&&b.eFormDoodleOption.is_eraser_down){var k=document.getElementById("clip_path"+l);if(null!=k){c.removeChild(k);if(b.multiView.isSocket){b.multiView.socket.sendDoodlePathRemove(k,b.m_uid);}}return;}},false);d.addEventListener("mouseup",function(k){if(b.eFormDoodleOption.is_move||!b.eFormDoodleOption.is_Ds){return;}var j=k.currentTarget;var m=j.getAttributeNS(null,"id");if(!b.eFormDoodleOption.is_eraser){if(b.multiView.isSocket){var l=document.getElementById("clip_path"+m);if(null!=l){var i=l.getAttribute("isSendPath");if(null==i){l.setAttribute("isSendPath",true);b.multiView.socket.sendDoodlePathDraw(l,b.m_uid);}}}}},false);d.addEventListener("touchstart",function(k){if(k.touches.length==1){if(b.eFormDoodleOption.is_move||!b.eFormDoodleOption.is_Ds){return;}var l=k.currentTarget;var q=l.getAttributeNS(null,"id");var j=Number(l.getAttributeNS(null,"x"));var i=Number(l.getAttributeNS(null,"y"));var n=Number(l.getAttributeNS(null,"width"));var p=Number(l.getAttributeNS(null,"height"));var r=document.getElementById("clip_path"+q);if(b.eFormDoodleOption.is_eraser){if(null!=r){c.removeChild(r);if(b.multiView.isSocket){b.multiView.socket.sendDoodlePathRemove(r,b.m_uid);}}return;}else{if(null!=r){k.stopPropagation();return;}}var o=b.eFormDoodleOption.pens;var r=document.createElementNS("http://www.w3.org/2000/svg","path");r.setAttribute("id","clip_path"+q);r.setAttributeNS(null,"style","-webkit-tap-highlight-color: rgba(0, 0, 0, 0);");r.setAttributeNS(null,"stroke-width",p);r.setAttributeNS(null,"fill","none");r.setAttributeNS(null,"stroke",o.color);r.setAttributeNS(null,"stroke-opacity",o.op);var m=new Array();m[0]="M"+j+","+(i+(p/2));m[1]="L"+(j+n)+","+(i+(p/2));setPath(r,m);c.insertBefore(r,l);r.onclick=function(){if(b.eFormDoodleOption.is_eraser){if(b.multiView.isSocket){b.multiView.socket.sendDoodlePathRemove(this,b.m_uid);}c.removeChild(this);}};r.onmousemove=function(){if(b.eFormDoodleOption.is_eraser&&b.eFormDoodleOption.is_eraser_down){if(b.multiView.isSocket){b.multiView.socket.sendDoodlePathRemove(this,b.m_uid);}c.removeChild(this);}};k.stopPropagation();}},false);d.addEventListener("touchmove",function(j){if(j.touches.length<2){if(b.eFormDoodleOption.is_move||!b.eFormDoodleOption.is_Ds){return;}var i=j.currentTarget;var l=i.getAttributeNS(null,"id");if(b.eFormDoodleOption.is_eraser&&b.eFormDoodleOption.is_eraser_down){var k=document.getElementById("clip_path"+l);if(null!=k){c.removeChild(k);if(b.multiView.isSocket){b.multiView.socket.sendDoodlePathRemove(k,b.m_uid);}}return;}}},false);d.addEventListener("touchend",function(k){if(b.eFormDoodleOption.is_move||!b.eFormDoodleOption.is_Ds){return;}var j=k.currentTarget;var m=j.getAttributeNS(null,"id");if(!b.eFormDoodleOption.is_eraser){if(b.multiView.isSocket){var l=document.getElementById("clip_path"+m);if(null!=l){var i=l.getAttribute("isSendPath");if(null==i){l.setAttribute("isSendPath",true);b.multiView.socket.sendDoodlePathDraw(l,b.m_uid);}}}}},false);}}}};Report.prototype.previousMemoPage=function(b){var a=this.beforePageIndex-1;if(!(a<0||this.m_pageCount<=a)){this.closeMemo(true);}this.previousPage(b);};Report.prototype.nextMemoPage=function(b){var a=this.beforePageIndex+1;if(!(a<0||this.m_pageCount<=a)){this.closeMemo(true);}this.nextPage(b);};var memoBGListener=function(b){if(b.target==this.firstChild||(b.target.isTarget)){if(null!=this.memoTempEForm){var a=this.memoTempEForm;window.setTimeout(function(){a.memoBGClickEvent();},200);}}};Report.prototype.EFormMemo=function(b){if(typeof b==="undefined"){b=false;}if(this.m_isEndReport){this.eFormDoodleOption.is_Ds=true;this.memoDiv.previousSibling.previousSibling.style.display="none";this.memoDiv.style.display="";var a=document.getElementById(this.m_uid+"memo");a.style.zIndex="300";this.objSpeechBubbleFrame.setSelectedPage(this.beforePageIndex);this.objSpeechBubbleFrame.changeIsSpeechBubbleControl(true);if(null!=this.memoBGClickEvent){a.isTarget=true;this.paintDiv.memoTempEForm=this;this.paintDiv.addEventListener("mousedown",memoBGListener);}this.m_isMemoEnabled=true;if(b){if(null!=this.memoButtonEvent){this.memoButtonEvent();}}}};Report.prototype.setEndMemoButtonEvent=function(a){this.memoButtonEvent=a;};Report.prototype.setBGMemoClickEvent=function(a){this.memoBGClickEvent=a;};Report.prototype.newMemo=function(){if(this.m_isMemoEnabled){this.objSpeechBubbleFrame.makeMemo(this.paintDiv.scrollTop);}else{ReportWebLog("Memo is not activated.");}};Report.prototype.opacityMemo=function(){var b=document.getElementById(this.m_uid+"memo");var a=b.style.opacity;if(null==a||"1"==a){if(1!=this.nMemoTransparency){b.style.opacity=this.nMemoTransparency;}else{b.style.opacity=0.1;}}else{b.style.opacity="1";}};Report.prototype.optionMemo=function(){this.objSpeechBubbleFrame.toggleSpeechBubbleFrame();};Report.prototype.setMemoStyle=function(d){if(null!=this.objSpeechBubbleFrame){if(typeof d!=="string"){var f=new Array();var c=Object.keys(d);for(var b=0;b<c.length;b++){var a=c[b];f.push(a+":"+d[a]);}d=f.join(",");}else{if(typeof d==="undefined"){d="";}}this.objSpeechBubbleFrame.strMemoStyle=d;}};Report.prototype.getMemoStyle=function(){if(null!=this.objSpeechBubbleFrame){if(null!=this.objSpeechBubbleFrame.objSpeechBubbleInfo.objDocSpeechBubble){var a=JSON.parse(JSON.stringify(this.objSpeechBubbleFrame.objSpeechBubbleInfo.objDocSpeechBubble));return a;}else{return null;}}return null;};Report.prototype.setGapMemo=function(a){if(null!=this.objSpeechBubbleFrame){this.objSpeechBubbleFrame.nGapMemo=a;}};Report.prototype.setIsMemoColorDisplay=function(a){if(null!=this.objSpeechBubbleFrame){this.objSpeechBubbleFrame.setIsMemoColorDisplay(a);}};Report.prototype.setIsFocusTextInput=function(a){if(null!=this.objSpeechBubbleFrame){this.objSpeechBubbleFrame.isFocusTextInput=a;}};Report.prototype.getMemoData=function(){if(null!=this.objSpeechBubbleFrame){return this.objSpeechBubbleFrame.arrSpeechBubbleArray;}else{return null;}};Report.prototype.setMemoData=function(a){if(a.length==0){this.objSpeechBubbleMemoData=null;}else{this.objSpeechBubbleMemoData=a;}};Report.prototype.setEFormMustSignPenWidth=function(a){this.mustSignPenWidth=a;};Report.prototype.setEFormMustSignStrokeWidth=function(a){this.mustSignStrokeWidth=a;};Report.prototype.setEFormMustInputNumberPadMaxLength=function(a){this.mustInputNumberPadMaxLength=a;};Report.prototype.setEFormDoodlePenDefaultShiftKey=function(a){this.penDefaultShiftKey=a;};window.mReDoodlePenCount=0;Report.prototype.EFormDoodle=function(){this.eFormDoodleOption.is_Ds=true;if(this.m_doodlePenToggleBtnDom!=null){this.m_doodlePenToggleBtnDom.className="eform_doodlepen_toggleBtn_close";}var i=this.beforePageIndex;var c=document.getElementById("re_doodle_pageinfo"+this.m_uid);if(null!=c){c.innerHTML=(i+1)+this.m_TPC.before+this.m_pageCount+this.m_TPC.after;}this.doodleDiv.previousSibling.style.display="none";this.doodleDiv.style.display="";if(this.eFormDoodleOption.is_eraser){this.eraserDoodle();}else{this.penDoodle();}var d=document.getElementById(this.m_uid+"doodle");d.style.zIndex="300";this.paintDiv.firstChild.style.opacity=""+this.m_doodlePenBGOpacity;d.previousSibling.style.opacity=""+this.m_doodlePenBGOpacity;var b=d.firstChild;this.EF_setPathPage();var g=this;var a=null;var j=null;if(this.m_ControlDoodleVisible){this.mRe_controlLayoutDoodle(b);}var f=b.getAttribute("isTouchEvent");if(null==f){b.setAttribute("isTouchEvent","true");}else{if(f=="true"){return;}else{b.setAttribute("isTouchEvent","true");}}b.addEventListener("mousedown",function(m){if(g.eFormDoodleOption.is_move||!g.eFormDoodleOption.is_Ds){return;}if(m.which===1||(m.which===3&&g.m_useDirectDoodlePen)){g.eFormDoodleOption.is_down=true;if(g.eFormDoodleOption.is_eraser){g.eFormDoodleOption.is_eraser_down=true;var l=g.eFormDoodleOption.pens;var o=g.eformDoodlePosition(0,this,m,true);j=document.createElementNS("http://www.w3.org/2000/svg","path");j.setAttributeNS(null,"style","-webkit-tap-highlight-color: rgba(0, 0, 0, 0);");j.setAttributeNS(null,"fill","none");j.setAttributeNS(null,"stroke-width",6);j.setAttributeNS(null,"stroke","rgb(255,255,255)");j.setAttributeNS(null,"stroke-opacity",0.5);j.setAttribute("eraser",true);a=new Array();a[0]="M"+o.x+","+o.y;setPath(j,a);b.appendChild(j);}else{var l=g.eFormDoodleOption.pens;var o=g.eformDoodlePosition(0,this,m,true);var n=new Date().getTime();j=document.createElementNS("http://www.w3.org/2000/svg","path");var k=g.beforePageIndex+"_"+n+window.mReDoodlePenCount;window.mReDoodlePenCount++;j.setAttribute("id","clip_path"+k);j.setAttributeNS(null,"style","-webkit-tap-highlight-color: rgba(0, 0, 0, 0);");j.setAttributeNS(null,"stroke-width",l.width);j.setAttributeNS(null,"fill","none");j.setAttributeNS(null,"stroke",l.color);j.setAttributeNS(null,"stroke-opacity",l.op);a=new Array();a[0]="M"+o.x+","+o.y;setPath(j,a);b.appendChild(j);j.onclick=function(){if(g.eFormDoodleOption.is_eraser){if(g.multiView.isSocket){g.multiView.socket.sendDoodlePathRemove(this,g.m_uid);}b.removeChild(this);}};j.onmousemove=function(){if(g.eFormDoodleOption.is_eraser&&g.eFormDoodleOption.is_eraser_down){if(g.multiView.isSocket){g.multiView.socket.sendDoodlePathRemove(this,g.m_uid);}b.removeChild(this);}};}window.mRe_path=j;window.mRe_path_pageIndex=g.beforePageIndex;}},false);b.addEventListener("mousemove",function(k){if(g.eFormDoodleOption.is_move||!g.eFormDoodleOption.is_Ds){return;}if(g.eFormDoodleOption.is_down){if(null!=a){var m=g.eformDoodlePosition(1,this,k,true);var l=a.length;if(k.shiftKey||g.penDefaultShiftKey){a[l]="H"+m.x;}else{a[l]="L"+m.x+","+m.y;}if(is_opera){if(a.length%7==0){setPath(j,a);}}else{setPath(j,a);}}}},false);var h=function(k){if(g.eFormDoodleOption.is_move||!g.eFormDoodleOption.is_Ds){return;}if((k.which===1||(k.which===3&&g.m_useDirectDoodlePen))&&g.eFormDoodleOption.is_down){g.eFormDoodleOption.is_down=false;if(g.eFormDoodleOption.is_eraser){g.eFormDoodleOption.is_eraser_down=false;window.setTimeout(function(){g.remove_eraser_path();},500);}else{if(g.multiView.isSocket){if(null!=window.mRe_path){g.multiView.socket.sendDoodlePathDraw(window.mRe_path,g.m_uid,window.mRe_path_pageIndex);}}}window.mRe_path=null;window.mRe_path_pageIndex=null;j=null;a=null;if(g.m_useDirectDoodlePenEvent){g.closeDoodle();g.m_useDirectDoodlePenEvent=false;}}};document.addEventListener("mouseup",h,false);b.addEventListener("touchstart",function(m){if(m.touches.length==1){if(g.eFormDoodleOption.is_move||!g.eFormDoodleOption.is_Ds){return;}if(g.eFormDoodleOption.is_eraser){g.eFormDoodleOption.is_eraser_down=true;var l=g.eFormDoodleOption.pens;var o=g.eformDoodlePosition(0,this,m,false);j=document.createElementNS("http://www.w3.org/2000/svg","path");j.setAttributeNS(null,"style","-webkit-tap-highlight-color: rgba(0, 0, 0, 0);");j.setAttributeNS(null,"fill","none");j.setAttributeNS(null,"stroke-width",6);j.setAttributeNS(null,"stroke","rgb(255,255,255)");j.setAttributeNS(null,"stroke-opacity",0.6);j.setAttribute("eraser",true);a=new Array();a[0]="M"+o.x+","+o.y;setPath(j,a);b.appendChild(j);}else{var l=g.eFormDoodleOption.pens;var o=g.eformDoodlePosition(0,this,m,false);var n=new Date().getTime();j=document.createElementNS("http://www.w3.org/2000/svg","path");var k=g.beforePageIndex+"_"+n+window.mReDoodlePenCount;window.mReDoodlePenCount++;j.setAttribute("id","clip_path"+k);j.setAttributeNS(null,"style","-webkit-tap-highlight-color: rgba(0, 0, 0, 0);");j.setAttributeNS(null,"stroke-width",l.width);j.setAttributeNS(null,"fill","none");j.setAttributeNS(null,"stroke",l.color);j.setAttributeNS(null,"stroke-opacity",l.op);a=new Array();a[0]="M"+o.x+","+o.y;setPath(j,a);b.appendChild(j);j.onclick=function(){if(g.eFormDoodleOption.is_eraser){if(g.multiView.isSocket){g.multiView.socket.sendDoodlePathRemove(this,g.m_uid);}b.removeChild(this);}};}}},false);b.addEventListener("touchmove",function(k){if(null!=a&&(k.touches.length<2)){if(g.eFormDoodleOption.is_move||!g.eFormDoodleOption.is_Ds){return;}if(k.cancelable){k.preventDefault();}var n=g.eformDoodlePosition(1,this,k,false);var l=a.length;a[l]="L"+n.x+","+n.y;if(g.eFormDoodleOption.is_eraser){var m=document.elementFromPoint(k.touches[0].clientX,k.touches[0].clientY);if("path"==m.tagName){if(g.multiView.isSocket){g.multiView.socket.sendDoodlePathRemove(m,g.m_uid);}b.removeChild(m);}}setPath(j,a);}},false);b.addEventListener("touchend",function(k){if(g.eFormDoodleOption.is_move||!g.eFormDoodleOption.is_Ds){return;}setPath(j,a);if(g.eFormDoodleOption.is_eraser){g.eFormDoodleOption.is_eraser_down=false;window.setTimeout(function(){g.remove_eraser_path(b);},500);}else{if(g.multiView.isSocket){if(null!=j){g.multiView.socket.sendDoodlePathDraw(j,g.m_uid);}}}j=null;a=null;},false);};Report.prototype.remove_eraser_path=function(b){if(typeof b==="undefined"){var a=document.getElementById(this.m_uid+"doodle");b=a.firstChild;}var f=b.childNodes.length;for(var c=f-1;c>-1;c--){var g=b.childNodes[c];var d=g.getAttribute("eraser");if(null!=d&&d){b.removeChild(g);}}};Report.prototype.penDoodle=function(){if(!this.eFormDoodleOption.is_Ds){return;}this.removePalletDoodle();this.eFormDoodleOption.is_eraser=false;this.eFormDoodleOption.is_move=false;var a=document.getElementById("re_doodlepen"+this.m_uid);var c=document.getElementById("re_doodleeraser"+this.m_uid);var b=document.getElementById("re_doodlemove"+this.m_uid);if(null!=c){c.style.border="";}if(null!=b){b.style.border="";}if(null!=a){a.style.border="2px solid rgba(33, 150, 243, 0.8)";a.focus();}};Report.prototype.palletDoodle=function(){if(!this.eFormDoodleOption.is_Ds){return;}var c=document.getElementById("eformPallet"+this.m_uid);if(null!=c){return;}mRe_pallet=this;var c=document.createElement("div");c.id="eformPallet"+this.m_uid;if(is_smartphone){c.className="m_eform_pallet_background";}else{c.className="eform_pallet_background";}var a=document.createElement("div");a.className="eform_pallet_OP_background";c.appendChild(a);var b=this.paintDiv.offsetHeight;if(null!=b){if(320<b){this.palletDoodleHeight(c);}else{this.palletDoodleWidth(c);}}this.m_bodyDiv.appendChild(c);};Report.prototype.removePalletDoodle=function(){var a=document.getElementById("eformPallet"+this.m_uid);if(null!=a){this.m_bodyDiv.removeChild(a);mRe_pallet=null;}};Report.prototype.eraserDoodle=function(){if(!this.eFormDoodleOption.is_Ds){return;}this.removePalletDoodle();this.eFormDoodleOption.is_eraser=true;this.eFormDoodleOption.is_move=false;var a=document.getElementById("re_doodlepen"+this.m_uid);var c=document.getElementById("re_doodleeraser"+this.m_uid);var b=document.getElementById("re_doodlemove"+this.m_uid);if(null!=a){a.style.border="";}if(null!=b){b.style.border="";}if(null!=c){c.style.border="2px solid rgba(33, 150, 243, 0.8)";c.focus();}};Report.prototype.moveDoodle=function(){if(!this.eFormDoodleOption.is_Ds){return;}this.removePalletDoodle();this.eFormDoodleOption.is_move=true;this.eFormDoodleOption.is_eraser=false;var a=document.getElementById("re_doodlepen"+this.m_uid);var c=document.getElementById("re_doodleeraser"+this.m_uid);var b=document.getElementById("re_doodlemove"+this.m_uid);if(null!=a){a.style.border="";}if(null!=b){b.style.border="2px solid rgba(33, 150, 243, 0.8)";b.focus();}if(null!=c){c.style.border="";}};Report.prototype.mRe_NecessaryRectDoodle=function(){if(!this.eFormDoodleOption.is_Ds){return;}this.penDoodle();var i=this;var f=document.getElementById(this.m_uid+"doodle");var d=f.firstChild;if(0!=d.childNodes.length){var n=d.firstChild;while(n){var k=n;n=n.nextSibling;if("rect"==k.tagName){if("svg_rect_Necessary"==k.className.baseVal){if(i.eFormDoodleOption.is_move||!i.eFormDoodleOption.is_Ds){return;}var c=k;var m=c.getAttributeNS(null,"id");var b=Number(c.getAttributeNS(null,"x"));var a=Number(c.getAttributeNS(null,"y"));var h=Number(c.getAttributeNS(null,"width"));var l=Number(c.getAttributeNS(null,"height"));var o=document.getElementById("clip_path"+m);if(i.eFormDoodleOption.is_eraser){if(null!=o){d.removeChild(o);if(i.multiView.isSocket){i.multiView.socket.sendDoodlePathRemove(o,i.m_uid);}}continue;}else{if(null!=o){continue;}}var j=i.eFormDoodleOption.pens;var o=document.createElementNS("http://www.w3.org/2000/svg","path");o.setAttribute("id","clip_path"+m);o.setAttribute("class","svg_path");o.setAttributeNS(null,"style","-webkit-tap-highlight-color: rgba(0, 0, 0, 0);");o.setAttributeNS(null,"stroke-width",l);o.setAttributeNS(null,"fill","none");o.setAttributeNS(null,"stroke",j.color);o.setAttributeNS(null,"stroke-opacity",j.op);var g=new Array();g[0]="M"+b+","+(a+(l/2));g[1]="L"+(b+h)+","+(a+(l/2));setPath(o,g);d.insertBefore(o,c);o.onclick=function(){if(i.eFormDoodleOption.is_eraser){if(i.multiView.isSocket){i.multiView.socket.sendDoodlePathRemove(this,i.m_uid);}d.removeChild(this);}};o.onmousemove=function(){if(i.eFormDoodleOption.is_eraser&&i.eFormDoodleOption.is_eraser_down){if(i.multiView.isSocket){i.multiView.socket.sendDoodlePathRemove(this,i.m_uid);}d.removeChild(this);}};}}}}};Report.prototype.EFormDeleteAllDoodle=function(){var a=document.getElementById(this.m_uid+"doodle");if(null!=a){var b=a.firstChild;if(0!=b.childNodes.length){var d=b.firstChild;while(d){var f=d;d=d.nextSibling;if("rect"!=f.tagName){b.removeChild(f);}}}}for(var c=0;c<this.m_pageCount;c++){this.eFormDoodleOption.pagePathSave[c]=new Array();}if(this.multiView.isSocket&&this.isMain){this.multiView.socket.sendDoodleDeleteAll(this.m_uid);}};Report.prototype.eraserAllDoodle=function(){if(!this.eFormDoodleOption.is_Ds){return;}var a=document.getElementById(this.m_uid+"doodle");var b=a.firstChild;if(0!=b.childNodes.length){var c=b.firstChild;while(c){var d=c;c=c.nextSibling;if("rect"!=d.tagName){b.removeChild(d);}}}this.eFormDoodleOption.pagePathSave[this.beforePageIndex]=new Array();this.penDoodle();if(this.multiView.isSocket){this.multiView.socket.sendDoodlePathRemoveAll(this.m_uid);}};Report.prototype.eformReceiveData=function(d){var a=this;var c=jQuery.parseJSON(d);if(null!=c){var b=mCR_Base64.decode(c.viewData);switch(c.id){case 1:resultPageCountText(b,a);break;case 2:paintEFormReportText(b);break;case 3:eFormResultText(b,"save");break;}}};Report.prototype.mRe_validationCanvas=function(f,d,a){var c=document.createElement("canvas");c.width=d;c.height=a;var b=c.toDataURL().split("base64,")[1];if(b==f){if(null!=this.ctrlEvent.signValidationEvent){this.ctrlEvent.signValidationEvent();}}};Report.prototype.setMemoExport=function(a){this.isMemoExport=a;};Report.prototype.setMemoTransparency=function(a){this.nMemoTransparency=a;};Report.prototype.EFormTemporarySave=function(g,k){if(g=="undefined"){g=false;}if(k=="undefined"){k=null;}if(!this.m_isEndReport||null==this.eFormData){if(null!=k){k(1);}return;}var l="ClipID=R31";if(this.m_postParam!=null){l+=this.m_postParam.getParam();}l+="&uid="+this.m_uid;l+="&clipUID="+this.m_uid+"&data="+encodeURIComponent(this.getEFormTemporaryData(true))+"&";l=mRe_onBeforeSend(l);var c=this.servletPath;if(c.indexOf("?")!=-1){var a=c.indexOf("?");var f=c.substring(a+1);c=c.substring(0,a);l+=f;}this.debugMeg("report log ::  eform 에서 작성한 내용을 임시 저장하기위해 서버접속 시도합니다 >>>> "+c);var b=new HttpClient();if(g){var d=this;b.send(c,l,true,function(){if(4==this.readyState){if(200==this.status){var m=objectCall(this.responseText);if(typeof m=="string"){m=objectCall(m);}if(null!=m){var n=m_reportHashMap[m.uid];if(null!=n){if(m.status){n.debugMeg("report log :: 임시 저장 성공!");if(null!=k){k(0);}}else{n.debugMeg("report log :: 서버에서 저장중 오류 발생 서버 로그 확인 필요!");if(null!=k){k(3);}}}}}else{d.networkErrorAlert(this.status,false);d.debugMeg("report log :: 서버 통신 오류 발생 >>> ajax 통신 상태 "+this.status);mRe_ReportEventHandler(40);d.endDebugMeg(false);mRe_ReportWebLog(this.status);if(null!=k){k(2);}}}});}else{try{var j=b.send(c,l,false,null);var i=objectCall(j);if(typeof i=="string"){i=objectCall(i);}if(null!=i){var d=m_reportHashMap[i.uid];if(null!=d){if(i.status){d.debugMeg("report log :: 임시 저장 성공!");if(null!=k){k(0);}}else{d.debugMeg("report log :: 서버에서 저장중 오류 발생 서버 로그 확인 필요!");if(null!=k){k(3);}}}}else{if(null!=k){k(2);}}}catch(h){if(null!=k){k(2);}mRe_ReportWebLog(h.stack);}}};Report.prototype.eFormTempSubmitSave=function(g){if(!this.m_isEndReport||null==this.eFormData){return;}if(this.m_isServerSyncMirroring){this.m_isEndMainData=false;}if(g=="undefined"){g=false;}if(typeof window.onBrokenSendData!="undefined"){var j={type:"update",uid:this.m_uid,data:this.getEFormTemporaryData(true)};if(!onBrokenSendData(this,j)){return;}}var j="ClipID=R31";if(this.m_postParam!=null){j+=this.m_postParam.getParam();}j+="&uid="+this.m_uid;j+="&clipUID="+this.m_uid+"&data="+encodeURIComponent(this.getEFormTemporaryData(true))+"&";j=mRe_onBeforeSend(j);var c=this.servletPath;if(c.indexOf("?")!=-1){var a=c.indexOf("?");var f=c.substring(a+1);c=c.substring(0,a);j+=f;}this.debugMeg("report log :: 듀얼모니터 eform 에서 작성한 내용을 임시 저장하기위해 서버접속 시도합니다 >>>> "+c);var b=new HttpClient();if(g){var d=this;b.send(c,j,true,function(){if(4==this.readyState){if(200==this.status){var k=objectCall(this.responseText);if(typeof k=="string"){k=objectCall(k);}if(null!=k){var l=m_reportHashMap[k.uid];if(null!=l){if(k.status){l.debugMeg("report log :: 임시 저장 성공!");}else{l.debugMeg("report log :: 서버에서 저장중 오류 발생 서버 로그 확인 필요!");}}}}else{d.networkErrorAlert(this.status,false);d.debugMeg("report log :: 서버 통신 오류 발생 >>> ajax 통신 상태 "+this.status);mRe_ReportEventHandler(40);d.endDebugMeg(false);mRe_ReportWebLog(this.status);}}});}else{var i=b.send(c,j,false,null);var h=objectCall(i);if(typeof h=="string"){h=objectCall(h);}if(null!=h){var d=m_reportHashMap[h.uid];if(null!=d){if(h.status){d.debugMeg("report log :: 임시 저장 성공!");}else{d.debugMeg("report log :: 서버에서 저장중 오류 발생 서버 로그 확인 필요!");}}}}};Report.prototype.eFormSubmitSave=function(h){if(typeof window.onBrokenSendData!="undefined"){var c={type:"update",uid:this.m_uid,data:this.getEFormTemporaryData(true)};if(!onBrokenSendData(this,c)){return;}}var c="ClipID=R31";if(this.m_postParam!=null){c+=this.m_postParam.getParam();}c+="&uid="+this.m_uid;if(is_samsung_browser){c+="&clipUID="+this.m_uid+"&data="+encodeURIComponent('"'+this.getEFormTemporaryData(true))+"&";}else{c+="&clipUID="+this.m_uid+"&data="+encodeURIComponent(this.getEFormTemporaryData(true))+"&";}c=mRe_onBeforeSend(c);var g=this.servletPath;this.debugMeg("report log :: eform 작성한 내용을 저장하기위해 서버접속 시도합니다 >>>> "+g);if(this.m_isCrossDomain){var b=this;if(window.XDomainRequest){var a=new XDomainRequest();var d=g+"?"+c;if(-1!=g.indexOf("?")){d=g+"&"+c;}if(a){a.onload=function(){eFormResultText(mRe_onAfterSend(a.responseText),h);};a.onerror=function(){b.debugMeg("report log :: IE8 크로스도메인 오류 발생 .. ");mRe_ReportEventHandler(40);b.endDebugMeg(false);};a.open("GET",d);a.send();}}else{$.ajax({type:"POST",url:g,crossDomain:true,data:c,success:function(i){eFormResultText(mRe_onAfterSend(i),h);},error:function(i){b.debugMeg("report log :: 서버 통신 오류 발생 >>> "+i);mRe_ReportEventHandler(40);b.endDebugMeg(false);}});}}else{var b=this;var f=new HttpClient();f.send(g,c,true,function(){if(4==this.readyState){if(200==this.status){eFormResultText(mRe_onAfterSend(this.responseText),h);}else{b.networkErrorAlert(this.status,false);b.debugMeg("report log :: 서버 통신 오류 발생 >>> ajax 통신 상태 "+this.status);mRe_ReportEventHandler(40);b.endDebugMeg(false);mRe_ReportWebLog(this.status);}}});}};Report.prototype.RequiredCheckMessage=function(){var c=new Array();for(var b in this.eFormData){var a=this.eFormData[b];if(a.is_nc){if(a.disable||!a.visible){continue;}if(""!=a.necessaryMessage){c.push(a.necessaryMessage);}}}return c;};Report.prototype.RequiredCheckControl=function(){var g=this.eFormAllIndexControlList.length;for(var d=0;d<g;d++){var b=this.eFormAllIndexControlList[d];var a=this.eFormData[b];if(null==a){continue;}else{if(null==a.disable||null==a.visible){continue;}else{if(a.disable||!a.visible){continue;}else{if(this.isEasyInput){var c=this.eFormControlList[b];if(c.isDOM){var h=c.getHE();if(null!=h){if(h.offsetWidth==0){continue;}}}if(c.isNotEasyInput){continue;}}}}}if(a.is_nc){this.debugMeg("report log :: 필수항목이 모두 체크되지 않았습니다. 서버에 데이터 업데이트를 중지합니다.");this.eForm_isNecessary.check=true;var f=this;EFormNecessaryCheckMessage(this.RequiredCheckMessage(),function(){f.m_isNecessaryInfo=b;f.sendNecessaryInfo();if(null!=a.pageNumber){if(f.beforePageIndex==a.pageNumber||f.isEasyInput){f.resetEFormPage(a.pageNumber);}else{f.selectPage(a.pageNumber,"required");}}else{for(var j=0;j<f.eForm_isNecessary.pageList.length;j++){if(null==f.eForm_isNecessary.pageList[j]){f.selectPage(j,"required");break;}}}},this.m_languageMap);return false;}}return true;};Report.prototype.RulesRequiredCheckMessage=function(){var c=new Array();for(var b in this.eFormData){var a=this.eFormData[b];if(a.is_nc){if(a.disable||!a.visible){continue;}if(""!=a.necessaryMessage){var d={id:a.id,reportName:a.rName,message:a.necessaryMessage};c.push(d);}}}return c;};Report.prototype.RulesRequiredCheckControl=function(b){if(null==b){b=true;}var l={returnValue:{isChecked:true,data:null},objCtrl:null,ctrlName:null};var d=new Array();var f=null;var c=null;var h=this.eFormAllIndexControlList.length;for(var i=0;i<h;i++){var a=this.eFormAllIndexControlList[i];var g=this.eFormData[a];if(null==g){continue;}else{if(null==g.disable||null==g.visible){continue;}else{if(g.disable||!g.visible){continue;}else{if(this.isEasyInput){var k=this.eFormControlList[a];if(k.isDOM){var j=k.getHE();if(null!=j){if(j.offsetWidth==0){continue;}}}if(k.isNotEasyInput){continue;}}}}}if(g.type=="input"){var k=this.eFormControlList[a];k.closeFocusSetValue();}if(g.is_nc){d.push(g.rName+":"+g.id);l.returnValue.isChecked=false;if(null==f){f=g;c=a;}}}l.returnValue.data=d;l.objCtrl=f;l.ctrlName=c;if(b){var m=this;window.setTimeout(function(){m.RulesRequiredControlSelect(f,c);},100);}return l;};Report.prototype.RulesRequiredControlSelect=function(a,b){if(null==a){return;}this.m_isNecessaryInfo=b;this.sendNecessaryInfo();if(null!=a.pageNumber){if(this.beforePageIndex==a.pageNumber||this.isEasyInput){this.resetEFormPage(a.pageNumber);}else{this.selectPage(a.pageNumber,"required");}}else{for(var c=0;c<this.eForm_isNecessary.pageList.length;c++){if(null==this.eForm_isNecessary.pageList[c]){this.selectPage(c,"required");break;}}}};Report.prototype.getNecessaryCheckPage=function(k){var l=true;var b=new Array();var f=this.eFormAllIndexControlList.length;var c=true;for(var g=0;g<f;g++){var a=this.eFormAllIndexControlList[g];var d=this.eFormData[a];if(null==d){continue;}else{if(null==d.disable||null==d.visible){continue;}else{if(d.disable||!d.visible){continue;}else{if(this.isEasyInput){var i=this.eFormControlList[a];if(i.isDOM){var h=i.getHE();if(null!=h){if(h.offsetWidth==0){continue;}}}if(i.isNotEasyInput){continue;}}}}}if(d.is_nc){this.eForm_isNecessary.check=true;if(null!=d.pageNumber){if(this.beforePageIndex==d.pageNumber||this.isEasyInput){l=false;if(""!=d.necessaryMessage){b.push(d.necessaryMessage);}if(c){this.m_isNecessaryInfo=a;this.sendNecessaryInfo();c=false;}}}}}if(!l){if(k){var j=this;EFormNecessaryCheckMessage(b,function(){j.resetEFormPage(j.beforePageIndex);},this.m_languageMap);}else{this.resetEFormPage(this.beforePageIndex);}}return l;};Report.prototype.sendNecessaryInfo=function(){if(this.is_eForm){if(this.multiView.isSocket){this.multiView.socket.sendNecessaryInfo(this.m_isNecessaryInfo,this.m_uid);}}};Report.prototype.getNecessaryCheck=function(h){if(typeof h=="undefined"){h=false;}if(h){return this.RequiredCheckControl();}var g=this.eFormAllIndexControlList.length;for(var d=0;d<g;d++){var b=this.eFormAllIndexControlList[d];var a=this.eFormData[b];if(null==a){continue;}else{if(null==a.disable||null==a.visible){continue;}else{if(a.disable||!a.visible){continue;}else{if(this.isEasyInput){var c=this.eFormControlList[b];if(c.isDOM){var j=c.getHE();if(null!=j){if(j.offsetWidth==0){continue;}}}if(c.isNotEasyInput){continue;}}}}}if(a.is_nc){this.eForm_isNecessary.check=true;this.m_isNecessaryInfo=b;this.sendNecessaryInfo();if(null!=a.pageNumber){if(this.beforePageIndex==a.pageNumber||this.isEasyInput){this.resetEFormPage(a.pageNumber);}else{this.selectPage(a.pageNumber,"required");}}else{for(var f=0;f<this.eForm_isNecessary.pageList.length;f++){if(null==this.eForm_isNecessary.pageList[f]){this.selectPage(f,"required");break;}}}return false;}}return true;};Report.prototype.findEFormControls=function(b){if(this.eForm_isNecessary.pageList==null){this.eForm_isNecessary.pageList=new Array(this.m_pageCount);}this.eForm_isNecessary.pageList[this.beforePageIndex]=true;for(var d=0;d<b.length;d++){var c=this.eFormControlList[b[d]];switch(c.getType()){case"image":c.eventHandlerImage();break;case"input":c.eventHandlerInput();break;case"sign":c.eventHandlerSign();break;case"signGroup":c.eventHandlerSignGroup();break;case"checkbox":c.eventHandlerInputCheckbox();break;case"radiobox":c.eventHandlerInputRadiobox();break;case"calendar":c.eventHandlerCalendar();break;case"selectbox":c.eventHandlerSelectBox();break;case"button":c.eventHandlerButton();break;case"video":c.eventHandlerVideo();break;default:break;}if(c.isDOM){if(!this.m_bDisPlayTitle){c.setTitle("");}}}if(this.isEasyInput){for(var a in this.eFormControlList){var f=this.eFormControlList[a];if(!f.isDOM){f.isNotEasyInput=true;}else{f.isNotEasyInput=false;}}}};Report.prototype.eformControlReSet=function(){this.m_IO_HE=null;for(var a in this.eFormControlList){var b=this.eFormControlList[a];b.resetDOM();}};Report.prototype.defaultControlSet=function(){this.eFormControlList=new Object();this.eFormControlGroupList=new Object();this.eFormIndexControlList=new Array();this.eFormAllIndexControlList=new Array();var k=new Array();var g=new Array();var b=1;for(var h in this.eFormData){var i=this.eFormData[h];var f=null;if(null!=i.inputOrder){k[(i.inputOrder-1)]=h;}else{g.push(h);}if(this.m_isEFormAutoIndex){i.inputOrder=b;b++;}switch(i.type){case"radiobox":f=new EFormRadiobox();f.init(h,i,this);if(null==this.eFormRadioChecked[i.id+i.rName]){if(i.checked=="true"){i.is_nc=false;for(var d in this.eFormData){var a=this.eFormData[d];if(i.id==a.id&&h!=d&&i.rName==a.rName){a.checked="false";a.is_nc=false;}}this.eFormRadioChecked[i.id+i.rName]=h;}if(null==i.is_nc){if(i.isNecessaryCheck=="true"){i.is_nc=true;}else{i.is_nc=false;}}}break;case"checkbox":f=new EFormCheckbox();f.init(h,i,this);i.is_nc=false;if(i.isNecessaryCheck=="true"){if(i.checked=="false"){if(i.requiredCheckInGroup){var c=true;for(var d in this.eFormData){var a=this.eFormData[d];if(i.id==a.id&&h!=d){if(a.checked=="true"){c=false;break;}}}i.is_nc=c;}else{i.is_nc=true;}}}break;case"input":f=new EFormInput();f.init(h,i,this);i.is_nc=false;if(i.isNecessaryCheck=="true"&&ClipStrTrim(i.value)==""){i.is_nc=true;}break;case"sign":f=new EFormSign();f.init(h,i,this);i.is_nc=false;if(i.isNecessaryCheck=="true"&&i.image==""){i.is_nc=true;}break;case"signGroup":f=new EFormSignGroup();f.init(h,i,this);i.is_nc=false;if(i.isNecessaryCheck=="true"&&i.image==""){i.is_nc=true;}break;case"image":f=new EFormImage();f.init(h,i,this);i.is_nc=false;if(i.isNecessaryCheck=="true"&&i.image==""){i.is_nc=true;}break;case"calendar":f=new EFormCalendar();f.init(h,i,this);i.is_nc=false;if(i.isNecessaryCheck=="true"&&f.getValue()==""){i.is_nc=true;}break;case"selectbox":f=new EFormSelectbox();f.init(h,i,this);i.is_nc=false;if(i.isNecessaryCheck=="true"&&f.getValue()==""){i.is_nc=true;}break;case"button":f=new EFormButton();f.init(h,i,this);break;case"video":f=new EFormVideo();f.init(h,i,this);break;default:break;}this.eFormControlList[h]=f;var j=this.eFormControlGroupList[i.id];if(null==j){j=new EFormGroup();j.init(i.id,this);j.appendControl(f);this.eFormControlGroupList[i.id]=j;}else{j.appendControl(f);}f.setGroup(j);}this.eFormAllIndexControlList=k.concat(g);k=null;g=null;};Report.prototype.defaultTOCSet=function(b){if(null==b){this.eFormTOCList=new Array();return;}this.eFormTOCList=b;var c=this.eFormTOCList.length;for(var a=0;a<c;a++){var d=this.eFormTOCList[a];d.title=mCR_Base64.decode(d.title);}b=null;};Report.prototype.resetEFormPage=function(a){this.eformControlReSet();var c=new Array();for(var b in this.eFormControlList){var d=this.eFormControlList[b];if(this.isEasyInput){if(!d.isNotEasyInput){c.push(b);}}else{if(a==d.controlData.pageNumber){c.push(b);}}}this.findEFormControls(c);this.focusInputOrder();this.necessaryFocus();c=null;};Report.prototype.sendEFormData=function(a){if(null!=this.signPaintDiv){try{this.signPaintDiv.parentElement.removeChild(this.signPaintDiv);this.signPaintDiv=null;}catch(d){mRe_ReportWebLog(d.stack);}}if(this.m_isSlidePage&&null!=this.m_tempPaintDiv){this.slideImageView(a);this.m_tempPaintDiv.style.overflowX="hidden";this.m_tempPaintDiv.style.overflowY="hidden";var c=$(this.m_tempPaintDiv).attr("next");var b=this;if("right"==c){$(this.m_tempPaintDiv).animate({left:"100%",width:"100%"},700,function(){try{b.targetDiv.firstChild.removeChild(this);b.m_tempPaintDiv=null;}catch(f){mRe_ReportWebLog(f.stack);}});}else{$(this.m_tempPaintDiv).animate({left:"-100%",width:"100%"},700,function(){try{b.targetDiv.firstChild.removeChild(this);b.m_tempPaintDiv=null;}catch(f){mRe_ReportWebLog(f.stack);}});}$(this.paintDiv).animate({left:"0%",width:"100%",opacity:1},700,function(){b.createEditableProgress();if(!b.m_isAccessibility&&b.m_isObjJSONSVG){b.sendEFormDataToJson(a,b.m_isJsonAllPage);}else{b.sendEFormPageData(a);}});}else{if(!this.m_isAccessibility&&this.m_isObjJSONSVG){this.sendEFormDataToJson(a,this.m_isJsonAllPage);}else{this.sendEFormPageData(a);}}};Report.prototype.sendEFormDataToJson=function(b,h){var g=this;if(null!=this.m_saveJsonDoc){this.clientPaintEFormJson(b);return;}if(this.m_nextPageSave.poNum==b){window.setTimeout(function(){g.paintEFormJson(g.m_nextPageSave.strPageData);},10);return;}var j="uid="+this.m_uid+"&";j+="clipUID="+this.m_uid+"&";j+="ClipType=DocumentPageView&ClipData=";var d=this.m_uid;isMakeDocStatus=true;if(null!=this.m_objClipDocument){isMakeDocStatus=false;}if(typeof h=="undefined"){h=false;}var i=b;if(h){i="TotalPage";isMakeDocStatus=true;}var a={reportkey:d,isMakeDocument:isMakeDocStatus,pageMethod:i};j+=encodeURIComponent(JSON.stringify(a));if(this.m_postParam!=null){j+=this.m_postParam.getParam();}j=mRe_onBeforeSend(j);if("{clip_enc}"==j){return;}var f=null!=this.m_syncPageServletPath?this.m_syncPageServletPath:this.servletPath;this.debugMeg("EForm log :: 이폼 화면을 가져오는 통신을 시도합니다 >>>> "+f);var g=this;var c=new HttpClient();c.send(f,j,true,function(){if(4==this.readyState){if(200==this.status){g.paintEFormJson(mRe_onAfterSend(this.responseText),h);}else{g.networkErrorAlert(this.status,true);g.debugMeg("EForm log :: 서버 통신 오류 발생 >>> ajax 통신 상태 "+this.status);mRe_ReportEventHandler(40);g.endDebugMeg(false);g.m_isButtonLock=false;g.pageSlideShow();mRe_ReportWebLog(this.status);}}});};Report.prototype.sendEFormNaxtPageDataToJson=function(a){var c="uid="+this.m_uid+"&";c+="clipUID="+this.m_uid+"&";c+="ClipType=DocumentPageView&ClipData=";var h=this.m_uid;isMakeDocStatus=true;if(null!=this.m_objClipDocument){isMakeDocStatus=false;}var d={reportkey:h,isMakeDocument:isMakeDocStatus,pageMethod:a};c+=encodeURIComponent(JSON.stringify(d));if(this.m_postParam!=null){c+=this.m_postParam.getParam();}c=mRe_onBeforeSend(c);if("{clip_enc}"==c){return;}var g=null!=this.m_syncPageServletPath?this.m_syncPageServletPath:this.servletPath;this.debugMeg("EForm log :: 이폼 화면을 가져오는 통신을 시도합니다 >>>> "+g);var b=this;var f=new HttpClient();f.send(g,c,true,function(){if(4==this.readyState){if(200==this.status){b.nextReportTextSave(mRe_onAfterSend(this.responseText),a);}else{b.networkErrorAlert(this.status,true);b.debugMeg("EForm log :: 서버 통신 오류 발생 >>> ajax 통신 상태 "+this.status);mRe_ReportEventHandler(40);b.endDebugMeg(false);b.m_isButtonLock=false;b.pageSlideShow();mRe_ReportWebLog(this.status);}}});};Report.prototype.clientPaintEFormJson=function(w){var C=this;var o=null;var d=new documentReader();var s=d.documentReaderFromJSON(this.m_saveJsonDoc,this.servletPath,this.m_uid);this.filePageCountList=s.getFilePageCountList();if(null!=window.m_EF_RulesNameMap){var B=s.documentReportInfoList;if(null!=B&&null==this.m_saveReportInfoIndexList){var b=s.checkedTotalPageCount;this.m_saveReportInfoIndexList=new Array();this.m_saveReportInfoList=new Array();for(p=0;p<B.length;p++){var n=B[p].reportID;var i=B[p].startPage-1;while(i<b){this.m_saveReportInfoIndexList[i]=n;i++;}this.m_saveReportInfoList.push(n);window.m_EF_RulesNameMap[n]=this;}}}if(this.isEasyInput){o=d.readDocumentPage(this.m_saveJsonDocPageList[0],true);var n=this.m_saveReportInfoIndexList[0];for(var h=0;h<o.subSectionList.length;h++){var g=o.subSectionList[h];g.rName=n;}for(var p=1;p<this.m_saveJsonDocPageList.length;p++){n=this.m_saveReportInfoIndexList[p];var q=d.readDocumentPage(this.m_saveJsonDocPageList[p],true);var f=o.imageList.length;for(var D=0;D<q.subSectionList.length;D++){var k=q.subSectionList[D];k.rName=n;k.imagePo=f;o.subSectionList.push(k);}for(var D=0;D<q.imageList.length;D++){o.imageList.push(q.imageList[D]);}}if(null!=this.m_easyInputMap){for(var p=0;p<o.subSectionList.length;p++){var k=o.subSectionList[p];var c=this.m_easyInputMap[k.rName+"."+k.editEasyModeId];var a=!k.isEditEasyModeVisible;var E=k.isEditEasyMode;if(null!=c){if(null!=c.hidden){a=c.hidden;}if(null!=c.mode){E=c.mode;}}else{c={hidden:a,mode:E};this.m_easyInputMap[k.rName+"."+k.editEasyModeId]=c;}if(a||!E){k.isDrilling=true;}else{k.isDrilling=false;}}}}if(!this.isEasyInput){if(this.m_pageCount!=s.checkedTotalPageCount){this.totalCountText.value="/ "+s.checkedTotalPageCount;this.m_pageCount=s.checkedTotalPageCount;}}else{if(this.m_pageCount!=1){this.totalCountText.value="/ 1";this.m_pageCount=1;this.beforePageIndex=0;this.input.value="1";}}var o=null!=o?o:d.readDocumentPage(this.m_saveJsonDocPageList[w]);s.addPage(o);var v=s.styleManager.pageList[o.pageStyleKey];this.pageWidth=v.width*0.378;this.pageHeight=v.height*0.378;var u=ClipStrTrim(s.title);if(""!=u){this.m_strFileName=u;}var j=document.createElement("div");j.style.cssText="position:absolute;left:0px;top:0px;width:100%;overflow:visible";var y=document.createElement("div");var C=this;this.m_objClipDocument=s;var r=new Array();var z=null;var x=null;this.removeEditableProgress();this.paintDiv.innerHTML="";this.paintDiv.appendChild(j);this.paintDiv.appendChild(y);if(this.m_isObjJSONViewType=="canvas"){this.createEditableProgress();var l=true;this.m_objCavasRate=this.getZoomRate(this.zoomCombo);var A=this.m_objCavasRate<1?1:this.m_objCavasRate;z=new mCR_exportCanvasForEForm(s,is_smartphone?(A*2):A,function(){C.makeWeblinkTag(y,z.callGetWebLinkList());C.removeEditableProgress();y.style.visibility="visible";l=false;C.zoomChangeEForm();},y);z.setPostParam((null!=this.m_postParam)?this.m_postParam.getParam():null);z.setEasyInput(this.isEasyInput);z.setRuleCtrlVisible(this.m_RuleCtrlVisible);z.setAccessibility(this.m_isObjJSONViewAccessibility);j.setAttribute("aria-hidden","true");x=z.exportPageEFom(w,r,j);if(is_smartphone){x.style.zoom=this.m_objCavasRate<1?(this.m_objCavasRate*0.5):"0.5";}else{x.style.zoom=this.m_objCavasRate<1?this.m_objCavasRate:"1";}if(l){y.style.visibility="hidden";}}else{z=new mCR_exportSVGForEForm(s,false,y);z.setPostParam((null!=this.m_postParam)?this.m_postParam.getParam():null);z.setEasyInput(this.isEasyInput);z.setRuleCtrlVisible(this.m_RuleCtrlVisible);z.setAccessibility(this.m_isObjJSONViewAccessibility);z.setAccessibilityLevel(this.m_nObjJSONViewAccLevel);j.setAttribute("aria-hidden","true");x=z.exportPageEFom(w,null,r,j);this.makeWeblinkTag(y,z.callGetWebLinkList());}this.pageWidth=z.objPageStyle.width*0.378;this.pageHeight=z.objPageStyle.height*0.378;this.m_printPage.pageWidth=z.objPageStyle.width;this.m_printPage.pageHeight=z.objPageStyle.height;var t=false;this.eformControlReSet();this.debugMeg("report log :: eform 리포트 화면를 "+this.m_isObjJSONViewType+" 로 표현!");this.defaultEFormSet();this.zoomImageView();if(is_smartphone){if(this.m_isSplitView&&!this.m_splitView.isQuick){this.eFormSplitViewZoom();}else{if(t){this.zoomIn(this.zoomCombo);}else{this.eFormZoom(this.eFormDoodleOption.zoomIn,1);}}}else{this.zoomIn(this.zoomCombo);}this.eFormGestureEvent();this.setPaintDivEvent(this.paintDiv,this.m_uid);this.m_isButtonLock=false;this.findEFormControls(r);if(this.eFormDoodleOption.is_Ds){this.EFormDoodle();}else{this.EF_setPathPage();}if(this.m_isMemoEnabled){this.EFormMemo(false);}if(null==this.m_drilingTop){if((is_smartphone&&this.m_mobile.scrollTop)||(!is_smartphone&&this.m_pcView.scrollTop)){this.paintDiv.scrollTop=1;}else{if(this.m_scrollEv.isScrollPaging&&this.isWheelPrev){this.isWheelPrev=false;var m=this.paintDiv.scrollHeight-this.paintDiv.clientHeight-50;this.paintDiv.scrollTop=m;}else{this.paintDiv.scrollTop=1;}}}else{this.paintDiv.scrollTop=this.m_drilingTop;this.m_drilingTop=null;}if(!this.is_eFormData){if(null!=this.dynamicScript){window.setTimeout(function(){try{C.dynamicScript();}catch(F){C.resetDynamicScript();C.debugMeg("report log :: 리포트파일에 설정된 동적 속성 스크립에 문제가 있습니다. >> ");window.console.log(F.stack);mRe_ReportEventHandler(31);}},0);}this.is_eFormData=true;}this.focusInputOrder();this.necessaryFocus();this.rulesControlFocus();if(this.m_isEndReport&&this.m_isEndReportEvent){if(this.m_endreportprogress.is_visible){this.m_endreportprogress.is_visible=false;this.removeEndReportProgress();}mRe_ReportEventHandler(200);if(this.m_isReportEndFunction!=null){window.setTimeout(this.m_isReportEndFunction,0);}this.m_isEndReportEvent=false;this.debugMeg("report log :: eform 리포트 뷰어 종료!");this.endDebugMeg(false);this.createStaticPageMoveButton();if(null!=this.objSpeechBubbleMemoData){this.objSpeechBubbleFrame.arrSpeechBubbleArray=this.objSpeechBubbleMemoData;this.updateMemo(false);this.objSpeechBubbleMemoData=null;}else{if(this.m_objClipDocument.documentMemo.length!=0){this.objSpeechBubbleFrame.arrSpeechBubbleArray=this.m_objClipDocument.documentMemo;}else{this.objSpeechBubbleFrame.createSpeechBubbleArray(this.m_objClipDocument.checkedTotalPageCount);}}this.objSpeechBubbleFrame.setTargetDom(this.targetDiv);this.objSpeechBubbleFrame.setHeaderHeight(this.menuDiv.offsetHeight);}else{if(!this.m_isEndReport){if(this.m_endreportprogress.is_visible){this.createEndReportProgress();}}}this.createSpeechBubbleDiv();this.endDebugMeg(true);if((C.beforePageIndex+1<C.m_pageCount)&&C.m_is_eform_nextPage){this.sendEFormNaxtPageDataToJson(C.beforePageIndex+1);}if(!t&&this.m_isEFormPageMoveEvent!=null){window.setTimeout(function(){C.m_isEFormPageMoveEvent();C.removeHybridProgress();},10);}else{this.removeHybridProgress();}};Report.prototype.subPaintEFormJson=function(x){this.m_isObjJSONSVG=true;this.m_isJsonAllPage=true;var H=true;this.m_isEndReport=true;this.progressImg.style.display="none";try{if(null==this.m_easyInputMap){this.m_easyInputMap=function(){};}for(var q=0;q<x.easyInputSectionList.length;q++){this.m_easyInputMap[x.easyInputSectionList[q].id]=x.easyInputSectionList[q].status;}this.m_saveOrigin=x;var I=mCR_Base64.decode(x.viewData);I=I.replace(/\+/gi," ");var d=new documentReader();var l=JSON.parse(I);var p=null;if(H){this.m_saveJsonDoc=l.document;this.m_saveJsonDocPageList=l.pageList;}var t=null;if(null!=this.m_objClipDocument&&null!=l.style){t=this.m_objClipDocument;t.styleManager=d.styleManagerReaderFromJSON(l.style);t.removeAllPage();}else{t=d.documentReaderFromJSON(l.document,this.servletPath,this.m_uid);this.filePageCountList=t.getFilePageCountList();if(null!=window.m_EF_RulesNameMap){var C=t.documentReportInfoList;if(null!=C){var c=t.checkedTotalPageCount;this.m_saveReportInfoIndexList=new Array();this.m_saveReportInfoList=new Array();for(q=0;q<C.length;q++){var o=C[q].reportID;var i=C[q].startPage-1;while(i<c){this.m_saveReportInfoIndexList[i]=o;i++;}this.m_saveReportInfoList.push(o);window.m_EF_RulesNameMap[o]=this;}}}}if(this.isEasyInput){p=d.readDocumentPage(l.pageList[0],true);var o=this.m_saveReportInfoIndexList[0];for(var h=0;h<p.subSectionList.length;h++){var g=p.subSectionList[h];g.rName=o;}for(var q=1;q<l.pageList.length;q++){o=this.m_saveReportInfoIndexList[q];var r=d.readDocumentPage(l.pageList[q],true);var f=p.imageList.length;for(var E=0;E<r.subSectionList.length;E++){var k=r.subSectionList[E];k.rName=o;k.imagePo=f;p.subSectionList.push(k);}for(var E=0;E<r.imageList.length;E++){p.imageList.push(r.imageList[E]);}}if(null!=this.m_easyInputMap){for(var q=0;q<p.subSectionList.length;q++){var k=p.subSectionList[q];var b=this.m_easyInputMap[k.rName+"."+k.editEasyModeId];var a=!k.isEditEasyModeVisible;var G=k.isEditEasyMode;if(null!=b){if(null!=b.hidden){a=b.hidden;}if(null!=b.mode){G=b.mode;}}else{b={hidden:a,mode:G};this.m_easyInputMap[k.rName+"."+k.editEasyModeId]=b;}if(a||!G){k.isDrilling=true;}else{k.isDrilling=false;}}}}if(!this.isEasyInput){if(this.m_pageCount!=t.checkedTotalPageCount){this.totalCountText.value="/ "+t.checkedTotalPageCount;this.m_pageCount=t.checkedTotalPageCount;}this.input.value=(this.beforePageIndex+1)+"";}else{if(this.m_pageCount!=1){this.totalCountText.value="/ 1";this.m_pageCount=1;this.beforePageIndex=0;this.input.value="1";}}var p=null!=p?p:d.readDocumentPage(l.pageList[this.beforePageIndex]);t.addPage(p);var w=t.styleManager.pageList[p.pageStyleKey];this.pageWidth=w.width*0.378;this.pageHeight=w.height*0.378;var v=ClipStrTrim(t.title);if(""!=v){this.m_strFileName=v;}var j=document.createElement("div");j.style.cssText="position:absolute;left:0px;top:0px;width:100%;overflow:visible";var z=document.createElement("div");var D=this;this.m_objClipDocument=t;var s=new Array();var A=null;var y=null;this.removeEditableProgress();this.paintDiv.innerHTML="";this.paintDiv.appendChild(j);this.paintDiv.appendChild(z);if(this.m_isObjJSONViewType=="canvas"){this.createEditableProgress();var m=true;this.m_objCavasRate=this.getZoomRate(this.zoomCombo);var B=this.m_objCavasRate<1?1:this.m_objCavasRate;A=new mCR_exportCanvasForEForm(t,is_smartphone?(B*2):B,function(){D.makeWeblinkTag(z,A.callGetWebLinkList());D.removeEditableProgress();z.style.visibility="visible";m=false;D.zoomChangeEForm();},z);A.setPostParam((null!=this.m_postParam)?this.m_postParam.getParam():null);A.setEasyInput(this.isEasyInput);A.setRuleCtrlVisible(this.m_RuleCtrlVisible);A.setAccessibility(this.m_isObjJSONViewAccessibility);j.setAttribute("aria-hidden","true");y=A.exportPageEFom(this.beforePageIndex,s,j);if(is_smartphone){y.style.zoom=this.m_objCavasRate<1?(this.m_objCavasRate*0.5):"0.5";}else{y.style.zoom=this.m_objCavasRate<1?this.m_objCavasRate:"1";}if(m){z.style.visibility="hidden";}}else{A=new mCR_exportSVGForEForm(t,false,z);A.setPostParam((null!=this.m_postParam)?this.m_postParam.getParam():null);A.setEasyInput(this.isEasyInput);A.setRuleCtrlVisible(this.m_RuleCtrlVisible);A.setAccessibility(this.m_isObjJSONViewAccessibility);A.setAccessibilityLevel(this.m_nObjJSONViewAccLevel);j.setAttribute("aria-hidden","true");y=A.exportPageEFom(this.beforePageIndex,null,s,j);this.makeWeblinkTag(z,A.callGetWebLinkList());}this.pageWidth=A.objPageStyle.width*0.378;this.pageHeight=A.objPageStyle.height*0.378;this.m_printPage.pageWidth=A.objPageStyle.width;this.m_printPage.pageHeight=A.objPageStyle.height;var u=false;if(!this.is_eFormData){l.dynamicScript=l.dynamicScript.replace(/\s/gi,"+");this.m_dynamicScript(l.dynamicScript);if(null!=this.eFormTempData){this.validationEFormData(x.eformData);}else{this.eFormData=x.eformData;if(x.eformDisabledMirr){this.m_eformDisabled=x.eformDisabled;}if(x.doodleInfo.length>0){this.eFormDoodleOption.pagePathSave=x.doodleInfo;}else{if(this.m_isDefaultDoodleVisble&&null!=t.objDoodleInfo&&(null==this.eFormDoodleOption.pagePathSave||0==this.eFormDoodleOption.pagePathSave.length)){this.eFormDoodleOption.pagePathSave=t.objDoodleInfo;}}}this.appendEFormData();this.defaultControlSet();this.eFormTOCList=t.arrTocItem;this.m_isThumbnail=t.isThumbnail;if(null!=x.checkImage){this.eFormCheckImage="data:image/png;base64,"+x.checkImage;this.eFormRadioImage="data:image/png;base64,"+x.radioImage;}else{this.eFormCheckImage=mCR_makeImageURL(t,t.checkImageName);this.eFormRadioImage=mCR_makeImageURL(t,t.radioImageName);}u=true;}this.eformControlReSet();this.debugMeg("report log :: eform 리포트 화면를 "+this.m_isObjJSONViewType+" 로 표현!");this.defaultEFormSet();this.zoomImageView();if(is_smartphone){if(this.m_isSplitView&&!this.m_splitView.isQuick){this.eFormSplitViewZoom();}else{if(u){this.zoomIn(this.zoomCombo);}else{this.eFormZoom(this.eFormDoodleOption.zoomIn,1);}}}else{this.zoomIn(this.zoomCombo);}this.eFormGestureEvent();this.setPaintDivEvent(this.paintDiv,this.m_uid);this.m_isButtonLock=false;this.findEFormControls(s);if(this.eFormDoodleOption.is_Ds){this.EFormDoodle();}else{this.EF_setPathPage();}if(this.m_isMemoEnabled){this.EFormMemo(false);}if(null==this.m_drilingTop){if((is_smartphone&&this.m_mobile.scrollTop)||(!is_smartphone&&this.m_pcView.scrollTop)){this.paintDiv.scrollTop=1;}else{if(this.m_scrollEv.isScrollPaging&&this.isWheelPrev){this.isWheelPrev=false;var n=this.paintDiv.scrollHeight-this.paintDiv.clientHeight-50;this.paintDiv.scrollTop=n;}else{this.paintDiv.scrollTop=1;}}}else{this.paintDiv.scrollTop=this.m_drilingTop;this.m_drilingTop=null;}if(!this.is_eFormData){if(null!=this.dynamicScript){window.setTimeout(function(){try{D.dynamicScript();}catch(J){D.resetDynamicScript();D.debugMeg("report log :: 리포트파일에 설정된 동적 속성 스크립에 문제가 있습니다. >> ");window.console.log(J.stack);mRe_ReportEventHandler(31);}},0);}this.is_eFormData=true;}this.focusInputOrder();this.necessaryFocus();this.rulesControlFocus();if(this.m_isEndReport&&this.m_isEndReportEvent){if(this.m_endreportprogress.is_visible){this.m_endreportprogress.is_visible=false;this.removeEndReportProgress();}mRe_ReportEventHandler(200);if(this.m_isReportEndFunction!=null){window.setTimeout(this.m_isReportEndFunction,0);}this.m_isEndReportEvent=false;this.debugMeg("report log :: eform 리포트 뷰어 종료!");this.endDebugMeg(false);this.createStaticPageMoveButton();if(null!=this.objSpeechBubbleMemoData){this.objSpeechBubbleFrame.arrSpeechBubbleArray=this.objSpeechBubbleMemoData;}else{if(this.m_objClipDocument.documentMemo.length!=0){this.objSpeechBubbleFrame.arrSpeechBubbleArray=this.m_objClipDocument.documentMemo;}else{if(null!=this.m_saveOrigin.objSpeechBubbleMemoData){this.objSpeechBubbleFrame.arrSpeechBubbleArray=this.m_saveOrigin.objSpeechBubbleMemoData;}else{this.objSpeechBubbleFrame.createSpeechBubbleArray(this.m_objClipDocument.checkedTotalPageCount);}}}this.objSpeechBubbleFrame.setTargetDom(this.targetDiv);this.objSpeechBubbleFrame.setHeaderHeight(this.menuDiv.offsetHeight);}else{if(!this.m_isEndReport){if(this.m_endreportprogress.is_visible){this.createEndReportProgress();}}}this.createSpeechBubbleDiv();this.mEF_setRulesCmd();this.mEF_onloadSubRuleCmd();try{this.m_exeViewEndFunc();}catch(F){mRe_ReportWebLog(F.stack);}if(this.m_isServerSyncMirroring){if(this.multiView.isSocket){this.multiView.socket.sendServerSyncMirroring(this);}}else{this.m_isEndMainData=true;}this.endDebugMeg(true);if((D.beforePageIndex+1<D.m_pageCount)&&D.m_is_eform_nextPage){this.sendEFormNaxtPageDataToJson(D.beforePageIndex+1);}if(!u&&this.m_isEFormPageMoveEvent!=null){window.setTimeout(function(){D.m_isEFormPageMoveEvent();D.removeHybridProgress();},10);}else{this.removeHybridProgress();}}catch(F){this.debugMeg("report log :: 서버에서 내려온 결과 메시지 >>> "+x);this.debugMeg("report log :: 서버에서 내려온 메시지 오류 >>> "+F.stack);this.paintDiv.innerHTML=this.m_languageMap.report_error;mRe_ReportEventHandler(30);this.m_isButtonLock=false;}};Report.prototype.paintEFormJson=function(h,O){var L=this;if(!this.m_reportKey){console.log("eform log :: "+this.m_uid+" 삭제된 뷰어로 보입니다(fn :paintEFormJson).");return;}if(null!=h){var b=null;if(typeof h==="string"){b=jQuery.parseJSON(h);}else{b=h;if(b.resValue.imageList!=null){var i=b.resValue.imageList.length;for(var m=0;m<i;m++){var S=b.resValue.imageList[m];this.setProperty(S.key,S.base64);}}}b=b.resValue;if(b.status){if(b.event==18){this.debugMeg("report log :: 이폼 서버의 사용자가 많아서 화면 호출을 다시 시도 합니다.");window.setTimeout(function(){L.sendEFormDataToJson(L.beforePageIndex,O);},300);return;}else{if(b.event==404){this.debugMeg("report log :: 이폼 서버 세션에서 리포트를 찾을 수 없습니다.");this.debugMeg("report log :: 서식이 삭제되었거나 이중화 서버일 가능성이 있습니다.");}else{if(b.event==200){try{this.m_saveOrigin=b;this.m_saveOrigin.doodleInfo=this.eFormDoodleOption.pagePathSave;var P=mCR_Base64.decode(b.viewData);P=P.replace(/\+/gi," ");var k=new documentReader();var F=JSON.parse(P);var R=null;if(O){this.m_saveJsonDoc=F.document;this.m_saveJsonDocPageList=F.pageList;}var a=null;if(null!=this.m_objClipDocument){a=this.m_objClipDocument;a.styleManager=k.styleManagerReaderFromJSON(F.style);a.removeAllPage();}else{a=k.documentReaderFromJSON(F.document,this.servletPath,this.m_uid);this.filePageCountList=a.getFilePageCountList();if(null==window.m_EF_RulesNameMap){window.m_EF_RulesNameMap=function(){};}var u=a.documentReportInfoList;if(null!=u){var H=F.pageList.length;this.m_saveReportInfoIndexList=new Array();this.m_saveReportInfoList=new Array();for(z=0;z<u.length;z++){var q=u[z].reportID;var f=u[z].startPage-1;while(f<H){this.m_saveReportInfoIndexList[f]=q;f++;}this.m_saveReportInfoList.push(q);window.m_EF_RulesNameMap[q]=this;}}}if(this.isEasyInput){R=k.readDocumentPage(F.pageList[0],true);var q=this.m_saveReportInfoIndexList[0];for(var d=0;d<R.subSectionList.length;d++){var c=R.subSectionList[d];c.rName=q;}for(var z=1;z<F.pageList.length;z++){q=this.m_saveReportInfoIndexList[z];var K=k.readDocumentPage(F.pageList[z],true);var l=R.imageList.length;for(var s=0;s<K.subSectionList.length;s++){var E=K.subSectionList[s];E.rName=q;E.imagePo=l;R.subSectionList.push(E);}for(var s=0;s<K.imageList.length;s++){R.imageList.push(K.imageList[s]);}}if(null==this.m_easyInputMap){this.m_easyInputMap=function(){};}for(var z=0;z<R.subSectionList.length;z++){var E=R.subSectionList[z];var w=this.m_easyInputMap[E.rName+"."+E.editEasyModeId];var D=!E.isEditEasyModeVisible;var A=E.isEditEasyMode;if(null!=w){if(null!=w.hidden){D=w.hidden;}if(null!=w.mode){A=w.mode;}}else{w={hidden:D,mode:A};this.m_easyInputMap[E.rName+"."+E.editEasyModeId]=w;}if(D||!A){E.isDrilling=true;}else{E.isDrilling=false;}}}var R=null!=R?R:k.readDocumentPage(F.pageList[O?this.beforePageIndex:0]);a.addPage(R);var o=a.styleManager.pageList[R.pageStyleKey];this.pageWidth=o.width*0.378;this.pageHeight=o.height*0.378;var y=ClipStrTrim(a.title);if(""!=y){this.m_strFileName=y;}var Q=document.createElement("div");Q.style.cssText="position:absolute;left:0px;top:0px;width:100%;overflow:visible";var n=document.createElement("div");var L=this;this.m_objClipDocument=a;var t=new Array();var J=null;var p=null;this.removeEditableProgress();this.paintDiv.innerHTML="";this.paintDiv.appendChild(Q);this.paintDiv.appendChild(n);var C=this.isEasyInput&&this.isEasyInputHidden;if(!C){if(this.m_isObjJSONViewType=="canvas"){this.createEditableProgress();var M=true;this.m_objCavasRate=this.getZoomRate(this.zoomCombo);var I=this.m_objCavasRate<1?1:this.m_objCavasRate;J=new mCR_exportCanvasForEForm(a,is_smartphone?(I*2):I,function(){L.makeWeblinkTag(n,J.callGetWebLinkList());L.removeEditableProgress();n.style.visibility="visible";M=false;L.zoomChangeEForm();},n);J.setPostParam((null!=this.m_postParam)?this.m_postParam.getParam():null);J.setEasyInput(this.isEasyInput);J.setRuleCtrlVisible(this.m_RuleCtrlVisible);J.setAccessibility(this.m_isObjJSONViewAccessibility);Q.setAttribute("aria-hidden","true");p=J.exportPageEFom(this.beforePageIndex,t,Q);if(is_smartphone){p.style.zoom=this.m_objCavasRate<1?(this.m_objCavasRate*0.5):"0.5";}else{p.style.zoom=this.m_objCavasRate<1?this.m_objCavasRate:"1";}if(M){n.style.visibility="hidden";}}else{J=new mCR_exportSVGForEForm(a,false,n);J.setPostParam((null!=this.m_postParam)?this.m_postParam.getParam():null);J.setEasyInput(this.isEasyInput);J.setRuleCtrlVisible(this.m_RuleCtrlVisible);J.setAccessibility(this.m_isObjJSONViewAccessibility);J.setAccessibilityLevel(this.m_nObjJSONViewAccLevel);Q.setAttribute("aria-hidden","true");p=J.exportPageEFom(this.beforePageIndex,null,t,Q);this.makeWeblinkTag(n,J.callGetWebLinkList());}this.pageWidth=J.objPageStyle.width*0.378;this.pageHeight=J.objPageStyle.height*0.378;this.m_printPage.pageWidth=J.objPageStyle.width;this.m_printPage.pageHeight=J.objPageStyle.height;}var x=false;if(!this.is_eFormData){F.dynamicScript=F.dynamicScript.replace(/\s/gi,"+");this.m_dynamicScript(F.dynamicScript);if(null!=this.eFormTempData){this.validationEFormData(b.eformData);}else{this.eFormData=b.eformData;if(this.m_isDefaultDoodleVisble&&null!=a.objDoodleInfo&&(null==this.eFormDoodleOption.pagePathSave||0==this.eFormDoodleOption.pagePathSave.length)){this.eFormDoodleOption.pagePathSave=a.objDoodleInfo;}}this.appendEFormData();this.defaultControlSet();this.eFormTOCList=a.arrTocItem;this.m_isThumbnail=a.isThumbnail;if(null!=b.checkImage){this.eFormCheckImage="data:image/png;base64,"+b.checkImage;this.eFormRadioImage="data:image/png;base64,"+b.radioImage;}else{this.eFormCheckImage=mCR_makeImageURL(a,a.checkImageName);this.eFormRadioImage=mCR_makeImageURL(a,a.radioImageName);}x=true;}this.eformControlReSet();this.debugMeg("report log :: eform 리포트 화면를 "+this.m_isObjJSONViewType+" 로 표현!");if(!C){this.defaultEFormSet();this.zoomImageView();}if(is_smartphone){if(this.m_isSplitView&&!this.m_splitView.isQuick){this.eFormSplitViewZoom();}else{if(x){this.zoomIn(this.zoomCombo);}else{this.eFormZoom(this.eFormDoodleOption.zoomIn,1);}}}else{this.zoomIn(this.zoomCombo);}this.eFormGestureEvent();this.setPaintDivEvent(this.paintDiv,this.m_uid);this.m_isButtonLock=false;this.findEFormControls(t);if(!C){if(this.eFormDoodleOption.is_Ds){this.EFormDoodle();}else{this.EF_setPathPage();}if(this.m_isMemoEnabled){this.EFormMemo(false);}}if(null==this.m_drilingTop){if((is_smartphone&&this.m_mobile.scrollTop)||(!is_smartphone&&this.m_pcView.scrollTop)){this.paintDiv.scrollTop=1;}else{if(this.m_scrollEv.isScrollPaging&&this.isWheelPrev){this.isWheelPrev=false;var g=this.paintDiv.scrollHeight-this.paintDiv.clientHeight-50;this.paintDiv.scrollTop=g;}else{this.paintDiv.scrollTop=1;}}}else{this.paintDiv.scrollTop=this.m_drilingTop;this.m_drilingTop=null;}if(!this.is_eFormData){if(null!=this.dynamicScript){window.setTimeout(function(){try{L.dynamicScript();}catch(T){L.resetDynamicScript();L.debugMeg("report log :: 리포트파일에 설정된 동적 속성 스크립에 문제가 있습니다. >> ");window.console.log(T.stack);mRe_ReportEventHandler(31);}},0);}this.is_eFormData=true;}this.focusInputOrder();this.necessaryFocus();this.rulesControlFocus();if(this.m_isEndReport&&this.m_isEndReportEvent){if(this.m_endreportprogress.is_visible){this.m_endreportprogress.is_visible=false;this.removeEndReportProgress();}mRe_ReportEventHandler(200);if(this.m_isReportEndFunction!=null){window.setTimeout(this.m_isReportEndFunction,0);}this.m_isEndReportEvent=false;this.debugMeg("report log :: eform 리포트 뷰어 종료!");this.endDebugMeg(false);this.createStaticPageMoveButton();if(null!=this.objSpeechBubbleMemoData){this.m_saveOrigin.objSpeechBubbleMemoData=this.objSpeechBubbleFrame.arrSpeechBubbleArray=this.objSpeechBubbleMemoData;if(this.m_objClipDocument.checkedTotalPageCount>this.objSpeechBubbleFrame.arrSpeechBubbleArray.length){this.objSpeechBubbleFrame.addSpeechBubbleArray(this.m_objClipDocument.checkedTotalPageCount-this.objSpeechBubbleFrame.arrSpeechBubbleArray.length);}else{if(this.m_objClipDocument.checkedTotalPageCount<this.objSpeechBubbleFrame.arrSpeechBubbleArray.length){this.objSpeechBubbleFrame.cutSpeechBubbleArray(this.m_objClipDocument.checkedTotalPageCount);}}this.updateMemo(false);this.objSpeechBubbleMemoData=null;}else{if(this.m_objClipDocument.documentMemo.length!=0){this.objSpeechBubbleFrame.arrSpeechBubbleArray=this.m_objClipDocument.documentMemo;if(this.m_objClipDocument.checkedTotalPageCount>this.objSpeechBubbleFrame.arrSpeechBubbleArray.length){this.objSpeechBubbleFrame.addSpeechBubbleArray(this.m_objClipDocument.checkedTotalPageCount-this.objSpeechBubbleFrame.arrSpeechBubbleArray.length);}else{if(this.m_objClipDocument.checkedTotalPageCount<this.objSpeechBubbleFrame.arrSpeechBubbleArray.length){this.objSpeechBubbleFrame.cutSpeechBubbleArray(this.m_objClipDocument.checkedTotalPageCount);}}}else{this.objSpeechBubbleFrame.createSpeechBubbleArray(this.m_objClipDocument.checkedTotalPageCount);}}this.objSpeechBubbleFrame.setTargetDom(this.targetDiv);this.objSpeechBubbleFrame.setHeaderHeight(this.menuDiv.offsetHeight);}else{if(!this.m_isEndReport){if(this.m_endreportprogress.is_visible){this.createEndReportProgress();}}}if(!C){this.createSpeechBubbleDiv();}this.mEF_setRulesCmd();this.mEF_onloadRuleCmd();try{this.m_exeViewEndFunc();}catch(N){mRe_ReportWebLog(N.stack);}if(null!=this.m_easyInputMap){var r=new Array();for(var v in this.m_easyInputMap){var G=this.m_easyInputMap[v];var B={id:v,status:G};r.push(B);}b.easyInputSectionList=r;}else{b.easyInputSectionList=new Array();}if(this.m_isServerSyncMirroring){if(this.multiView.isSocket){this.multiView.socket.sendServerSyncMirroring(this);if(this.m_aSyncMirrData.length>0){this.multiView.socket.bufferedSendDataMulti(this.m_aSyncMirrData);this.m_aSyncMirrData=[];}this.m_isEndViewData=true;}}else{this.m_isEndMainData=true;}this.endDebugMeg(true);if((L.beforePageIndex+1<L.m_pageCount)&&L.m_is_eform_nextPage){this.sendEFormNaxtPageDataToJson(L.beforePageIndex+1);}if(!x&&this.m_isEFormPageMoveEvent!=null){window.setTimeout(function(){L.m_isEFormPageMoveEvent();L.removeHybridProgress();},10);}else{this.removeHybridProgress();}}catch(N){this.debugMeg("report log :: 서버에서 내려온 결과 메시지 >>> "+h);this.debugMeg("report log :: 서버에서 내려온 메시지 오류 >>> "+N.stack);this.paintDiv.innerHTML=this.m_languageMap.report_error;mRe_ReportEventHandler(30);this.m_isButtonLock=false;}}else{this.debugMeg("report log :: eform 리포트 생성중 오류 발생(export) >>> 서버로그 확인 필요!");this.debugMeg("report log :: eform 리포트 페이지 서버 수신 메시지 >>> "+h);var j=this.m_languageMap.report_error;if(b.event==12){this.debugMeg("report log :: EFORM 사용 권한이 없습니다 (라이센스)");if(this.m_isViewer){j=this.m_languageMap.lic_error+".!! (errorCode : LE0"+b.event+")";mRe_ReportEventHandler(12);}}else{mRe_ReportEventHandler(30);if(b.event==60){j=this.m_languageMap.sesstion_error;mRe_ReportEventHandler(60);this.debugMeg("report log :: eform 리포트서버와의 세션 종료!");}}this.paintDiv.innerHTML=j;this.m_isButtonLock=false;}}}}else{this.debugMeg("report log :: 페이지 호출 후 받은 데이터 >>> 에러코드:"+b.event);var j=this.m_languageMap.report_error;mRe_ReportEventHandler(b.event);this.paintDiv.innerHTML=j;}}else{this.debugMeg("report log :: 페이지 호출 후 받은 데이터가 없습니다.>>> 데이터:"+h);this.paintDiv.innerHTML=this.m_languageMap.report_error;mRe_ReportEventHandler(30);}if(this.m_pageMoveEvent.end!=null){this.m_pageMoveEvent.end();}};Report.prototype.createSpeechBubbleDiv=function(){var a=document.getElementById(this.m_uid+"memo");var b=this.objSpeechBubbleFrame.setSpeechBubbleDiv(a);this.objSpeechBubbleFrame.makeAllPageMemo(this.beforePageIndex,b);a.style.opacity=this.nMemoTransparency;};Report.prototype.sendEFormPageData=function(c){var h=this;if(this.m_nextPageSave.poNum==c){window.setTimeout(function(){paintEFormReportText(h.m_nextPageSave.strPageData);},10);return;}var a=this.is_eFormData;var j=this.m_isAccessibility;var i={isData:a,pageNumber:c,isAccessibility:j};if(typeof window.onBrokenSendData!="undefined"){var k={type:"pageView",uid:this.m_uid,options:i};if(!onBrokenSendData(this,k)){return;}}var k="ClipID=R30&uid="+this.m_uid+"&clipUID="+this.m_uid+"&option="+JSON.stringify(i);if(this.m_postParam!=null){k+=this.m_postParam.getParam();}k=mRe_onBeforeSend(k);var g=this.servletPath;this.debugMeg("report log :: eform 화면을 가져오는 통신을 시도합니다 >>>> "+g);if(this.m_isCrossDomain){if(window.XDomainRequest){var f=new XDomainRequest();var b=g+"?"+k;if(-1!=g.indexOf("?")){b=g+"&"+k;}if(f){f.onload=function(){paintEFormReportText(mRe_onAfterSend(f.responseText));};f.onerror=function(){h.debugMeg("report log :: IE8 크로스도메인 오류 발생 .. ");mRe_ReportEventHandler(40);h.endDebugMeg(false);};f.open("GET",b);f.send();}}else{$.ajax({type:"POST",url:g,crossDomain:true,data:k,success:function(l){paintEFormReportText(mRe_onAfterSend(l));},error:function(l){h.debugMeg("report log :: 서버 통신 오류 발생 >>> "+l);mRe_ReportEventHandler(40);h.endDebugMeg(false);}});}}else{var h=this;var d=new HttpClient();d.send(g,k,true,function(){if(4==this.readyState){if(200==this.status){paintEFormReportText(mRe_onAfterSend(this.responseText));}else{h.networkErrorAlert(this.status,true);h.debugMeg("report log :: 서버 통신 오류 발생 >>> ajax 통신 상태 "+this.status);mRe_ReportEventHandler(40);h.endDebugMeg(false);h.m_isButtonLock=false;mRe_ReportWebLog(this.status);}}});}};Report.prototype.networkErrorAlert=function(a,b){if(b){this.input.value=(this.old_beforePageIndex+1);this.beforePageIndex=this.old_beforePageIndex;}if(null==this.objErrorAlert){this.networkErrorAlertUI("안내","서버에 연결할 수 없습니다.<br> 일시적인 네트워크 불안정이 원인일 수 있습니다.<br>code : "+a);}};Report.prototype.networkErrorAlertUI=function(h,m){this.disabledMenu(true);var b=this;var a=document.createElement("div");if(is_smartphone){a.className="m_eform_neterror_background";}else{a.className="eform_neterror_background";}var d=this.targetDiv.offsetWidth;var c=this.targetDiv.offsetHeight;var i=document.createElement("div");i.className="eform_neterror_layout";var j=document.createElement("div");j.className="eform_neterror_font eform_neterror_layout_head";j.innerHTML=h;var n=document.createElement("div");n.className="eform_neterror_font eform_neterror_layout_body";n.innerHTML=m;var f=document.createElement("div");f.className="eform_neterror_font eform_neterror_layout_bottom";var g=document.createElement("button");var l=this;g.onclick=function(){b.targetDiv.removeChild(b.objErrorAlert);b.objErrorAlert=null;b.disabledMenu(false);if(l.neterrEvent!=null){l.neterrEvent(l);}};g.className="eform_neterror_button";g.innerHTML="확인";f.appendChild(g);i.appendChild(j);i.appendChild(n);i.appendChild(f);a.appendChild(i);this.objErrorAlert=a;this.targetDiv.appendChild(a);i.style.left=((d/2)-(i.offsetWidth/2))+"px";i.style.top=((c/2)-(i.offsetHeight+50))+"px";var k=this.paintDiv.lastChild;if(null!=k&&is_smartphone){if(k.className=="eform_progress"){this.paintDiv.removeChild(k);}}};Report.prototype.sendEFormNaxtPageData=function(c){var a=this.is_eFormData;var j=this.m_isAccessibility;var i={isData:a,pageNumber:c,isAccessibility:j};var k="ClipID=R30&uid="+this.m_uid+"&clipUID="+this.m_uid+"&option="+JSON.stringify(i);if(this.m_postParam!=null){k+=this.m_postParam.getParam();}k=mRe_onBeforeSend(k);var g=this.servletPath;this.debugMeg("report log :: eform 화면을 가져오는 통신을 시도합니다 >>>> "+g);if(this.m_isCrossDomain){var h=this;if(window.XDomainRequest){var f=new XDomainRequest();var b=g+"?"+k;if(-1!=g.indexOf("?")){b=g+"&"+k;}if(f){f.onload=function(){h.nextReportTextSave(mRe_onAfterSend(f.responseText),c);};f.onerror=function(){h.debugMeg("report log :: IE8 크로스도메인 오류 발생 .. ");mRe_ReportEventHandler(40);h.endDebugMeg(false);};f.open("GET",b);f.send();}}else{$.ajax({type:"POST",url:g,crossDomain:true,data:k,success:function(l){h.nextReportTextSave(mRe_onAfterSend(l),c);},error:function(l){h.debugMeg("report log :: 서버 통신 오류 발생 >>> "+l);mRe_ReportEventHandler(40);h.endDebugMeg(false);}});}}else{var h=this;var d=new HttpClient();d.send(g,k,true,function(){if(4==this.readyState){if(200==this.status){h.nextReportTextSave(mRe_onAfterSend(this.responseText),c);}else{h.networkErrorAlert(this.status,true);h.debugMeg("report log :: 서버 통신 오류 발생 >>> ajax 통신 상태 "+this.status);mRe_ReportEventHandler(40);h.endDebugMeg(false);h.m_isButtonLock=false;mRe_ReportWebLog(this.status);}}});}};Report.prototype.nextReportTextSave=function(b,a){this.m_nextPageSave.poNum=a;this.m_nextPageSave.strPageData=b;};Report.prototype.EFormDisabled=function(b,d){this.m_eformDisabled=b;this.m_eformDisabledMirr=d;if(null!=this.eFormControlList){for(var a in this.eFormControlList){var c=this.eFormControlList[a];if(null!=c){c.setDisabled(c.controlData.disable,false);}}}if(d){if(null!=this.multiView&&this.multiView.isSocket){this.multiView.socket.sendEFormDisabled(this,b);}}};Report.prototype.EFormPageDisabled=function(c,b,f){c=c-1;this.m_eformPageDisabled[c]=b;if(null!=this.eFormControlList){for(var a in this.eFormControlList){var d=this.eFormControlList[a];if(null!=d){if(d.controlData.pageNumber==c||this.isEasyInput){d.setDisabled(d.getDisabled(),f);}}}}};Report.prototype.setEasyInput=function(a){this.isEasyInput=a;if(a){this.m_isObjJSONSVG=true;this.m_isJsonAllPage=true;}};Report.prototype.setEasyInputViewHidden=function(a){this.isEasyInputHidden=a;};Report.prototype.ModeNomarlInput=function(){var a=0;if(!this.isEasyInput){a=this.beforePageIndex;}this.setEasyInput(false);this.setRuleControlVisible(false);this.clientPaintEFormJson(a);if(null!=this.multiView&&this.multiView.isSocket&&this.multiView.socket.isMain){this.multiView.socket.sendChangeMode(this.m_uid,"nomarl");}};Report.prototype.ModeEasyInput=function(){this.setEasyInput(true);this.setRuleControlVisible(false);this.clientPaintEFormJson(0);if(null!=this.multiView&&this.multiView.isSocket&&this.multiView.socket.isMain){this.multiView.socket.sendChangeMode(this.m_uid,"easy");}};Report.prototype.ModeDisplayInput=function(){var a=0;if(!this.isEasyInput){a=this.beforePageIndex;}this.setRuleControlVisible(true);this.clientPaintEFormJson(a);if(null!=this.multiView&&this.multiView.isSocket&&this.multiView.socket.isMain){this.multiView.socket.sendChangeMode(this.m_uid,"display");}};Report.prototype.eformEasyInputSectionVisibleMultiData=function(a){this.default_eformEasyInputSectionVisibleMultiData(a);if(this.is_eForm){if(this.multiView.isSocket){if(this.multiView.socket.isMain){this.multiView.socket.sendRulesSectionVisibleMultiData(this.m_uid,a);}}}};Report.prototype.default_eformEasyInputSectionVisibleMultiData=function(d){if(null!=this.m_easyInputMap&&null!=d){for(var i=0;i<d.length;i++){var g=d[i];if(null==g.id){g.id=g.easyInputID;}var k={hidden:!g.visible,mode:g.mode};this.m_easyInputMap[g.reportName+"."+g.id]=k;}}for(var f in this.m_easyInputMap){var k=this.m_easyInputMap[f];var t=this.paintDiv.querySelectorAll("[id='"+f+"']");if(null!=t){for(var l=0;l<t.length;l++){if(k.mode&&!k.hidden){t[l].style.display="";}else{t[l].style.display="none";}}}}var h=this.m_objClipDocument.documentPageList[0];for(var q=0;q<h.subSectionList.length;q++){var c=h.subSectionList[q];var b=this.m_easyInputMap[c.rName+"."+c.editEasyModeId];var a=!c.isEditEasyModeVisible;var r=c.isEditEasyMode;if(null!=b){if(null!=b.hidden){a=b.hidden;}if(null!=b.mode){r=b.mode;}}else{b={hidden:a,mode:r};this.m_easyInputMap[c.rName+"."+c.editEasyModeId]=b;}if(a||!r){c.isDrilling=true;}else{c.isDrilling=false;}}if(this.isEasyInputHidden){return;}var o=this.paintDiv.firstChild;var s=this.paintDiv.lastChild;var m=o.firstChild;o.removeChild(m);var j=this.m_objCavasRate;var n=null;o.setAttribute("aria-hidden","true");if(this.m_isObjJSONViewType=="canvas"){var p=this;if(j<1){n=new mCR_exportCanvasForZoom(this.m_objClipDocument,is_smartphone?(1*2):1,function(){p.zoomChangeEForm();});}else{n=new mCR_exportCanvasForZoom(this.m_objClipDocument,is_smartphone?(j*2):j,function(){p.zoomChangeEForm();});}n.setPostParam((null!=this.m_postParam)?this.m_postParam.getParam():null);n.setEasyInput(this.isEasyInput);n.setRuleCtrlVisible(this.m_RuleCtrlVisible);var m=n.exportPage(this.beforePageIndex,o);if(is_smartphone){m.style.zoom=j<1?(j*0.5):"0.5";}else{m.style.zoom=j<1?j:"1";}}else{n=new mCR_exportSVGForZoom(this.m_objClipDocument,false);n.setPostParam((null!=this.m_postParam)?this.m_postParam.getParam():null);n.setEasyInput(this.isEasyInput);n.setRuleCtrlVisible(this.m_RuleCtrlVisible);m=n.exportPage(this.beforePageIndex,null,o);m.setAttribute("width",(n.objPageStyle.width*0.378)*j);m.setAttribute("height",(n.objPageStyle.height*0.378)*j);if(null!=m.lastChild){m.lastChild.setAttribute("transform","scale("+j+") translate(0,0)");}}s.style.width=(n.objPageStyle.width*0.378)+"px";s.style.height=(n.objPageStyle.height*0.378)+"px";this.pageWidth=n.objPageStyle.width*0.378;this.pageHeight=n.objPageStyle.height*0.378;this.m_printPage.pageWidth=n.objPageStyle.width;this.m_printPage.pageHeight=n.objPageStyle.height;if(this.m_pageMoveEvent.end!=null){this.m_pageMoveEvent.end();}};Report.prototype.eformEasyInputSectionVisible=function(c,b,f,d){var a=this.default_eformEasyInputSectionVisible(c,b,f,d);if(0==a.code){if(this.is_eForm){if(this.multiView.isSocket){if(this.multiView.socket.isMain){this.multiView.socket.sendRulesSectionVisible(this.m_uid,c,b,f,d);}}}}return a;};Report.prototype.default_eformEasyInputSectionVisible=function(d,h,c,k){if(typeof c=="undefined"){c=null;}if(typeof k=="undefined"){k=null;}var l={code:0,message:"성공"};if(null==this.m_easyInputMap){this.m_easyInputMap=function(){};}if(null==this.m_objClipDocument){var j=this.m_easyInputMap[d+"."+h];if(null==j){j={};j.hidden=null==c?c:!c;j.mode=k;this.m_easyInputMap[d+"."+h]=j;}else{if(null!=c){j.hidden=!c;}if(null!=k){j.mode=k;}}l.code=2;l.message="뷰어가 활성화된 상태가 아닙니다.";return l;}if(!this.isEasyInput){l.code=3;l.message="간편입력 모드가 아닙니다.";ReportWebLog(l.message);return l;}var f=this.m_objClipDocument.documentPageList[0];var a=false;for(var q=0;q<f.subSectionList.length;q++){var b=f.subSectionList[q];if(d!=b.rName){continue;}if(b.editEasyModeId==h){a=true;var j=this.m_easyInputMap[d+"."+h];if(null==j){j={hidden:!b.isEditEasyModeVisible,mode:b.isEditEasyMode};this.m_easyInputMap[d+"."+h]=j;}if(null!=c){j.hidden=!c;}if(null!=k){j.mode=k;}if(j.hidden||!j.mode){b.isDrilling=true;}else{b.isDrilling=false;}}}if(!a){l.code=4;l.message="간편 입력 세션이 없습니다.";return l;}if(this.isEasyInputHidden){l.code=5;l.message="숨김처리된 뷰어입니다.";return l;}var o=this.paintDiv.firstChild;var r=this.paintDiv.lastChild;var m=o.firstChild;o.removeChild(m);var i=this.m_objCavasRate;var n=null;o.setAttribute("aria-hidden","true");if(this.m_isObjJSONViewType=="canvas"){var p=this;if(i<1){n=new mCR_exportCanvasForZoom(this.m_objClipDocument,is_smartphone?(1*2):1,function(){p.zoomChangeEForm();});}else{n=new mCR_exportCanvasForZoom(this.m_objClipDocument,is_smartphone?(i*2):i,function(){p.zoomChangeEForm();});}n.setPostParam((null!=this.m_postParam)?this.m_postParam.getParam():null);n.setEasyInput(this.isEasyInput);n.setRuleCtrlVisible(this.m_RuleCtrlVisible);var m=n.exportPage(this.beforePageIndex,o);if(is_smartphone){m.style.zoom=i<1?(i*0.5):"0.5";}else{m.style.zoom=i<1?i:"1";}}else{n=new mCR_exportSVGForZoom(this.m_objClipDocument,false);n.setPostParam((null!=this.m_postParam)?this.m_postParam.getParam():null);n.setEasyInput(this.isEasyInput);n.setRuleCtrlVisible(this.m_RuleCtrlVisible);m=n.exportPage(this.beforePageIndex,null,o);m.setAttribute("width",(n.objPageStyle.width*0.378)*i);m.setAttribute("height",(n.objPageStyle.height*0.378)*i);if(null!=m.lastChild){m.lastChild.setAttribute("transform","scale("+i+") translate(0,0)");}}r.style.width=(n.objPageStyle.width*0.378)+"px";r.style.height=(n.objPageStyle.height*0.378)+"px";this.pageWidth=n.objPageStyle.width*0.378;this.pageHeight=n.objPageStyle.height*0.378;this.m_printPage.pageWidth=n.objPageStyle.width;this.m_printPage.pageHeight=n.objPageStyle.height;var j=this.m_easyInputMap[d+"."+h];if(null!=j){var s=this.paintDiv.querySelectorAll("[id='"+d+"."+h+"']");if(null!=s){for(var g=0;g<s.length;g++){if(j.mode&&!j.hidden){s[g].style.display="";}else{s[g].style.display="none";}}}}if(this.m_pageMoveEvent.end!=null){this.m_pageMoveEvent.end();}return l;};Report.prototype.setEFormDataAllJsonData=function(a){if(null!=a){if(null==this.m_objClipDocument){this.m_tempJsonAllData=a;return;}var g=new Array();for(var d=0;d<a.length;d++){var f=a[d];if(f.easyInputID!=null){g.push(f);}else{ctrlGroup=this.findGroup(f.inputID);var b=ctrlGroup.controlList;for(var i=0;i<b.length;i++){var h=b[i];if((null!=f.reportName)&&(h.controlData.rName!=f.reportName)){continue;}if("input"==h.getType()){if(null!=f.value){h.setValue(f.value,false);}if(null!=f.isNecessaryCheck){h.setNecessaryCheck(f.isNecessaryCheck,true);}if(null!=f.disabled){h.setDisabled(f.disabled,true);}if(null!=f.visible){h.setVisible(f.visible,true);}}else{if("checkbox"==h.getType()){if(null==f.value||h.controlData.value==f.value){if(f.isChecked){h.check(false);}else{h.unCheck(false);}if(null!=f.isNecessaryCheck){h.setNecessaryCheck(f.isNecessaryCheck,true);}if(null!=f.disabled){h.setDisabled(f.disabled,true);}if(null!=f.visible){h.setVisible(f.visible,true);}}}else{if("radiobox"==h.getType()){if(null==f.value||h.controlData.value==f.value){if(f.isSelected){h.select(false);}if(null!=f.isNecessaryCheck){h.setNecessaryCheck(f.isNecessaryCheck,true);}if(null!=f.disabled){h.setDisabled(f.disabled,true);}if(null!=f.visible){h.setVisible(f.visible,true);}}}else{if("selectbox"==h.getType()){if(null!=f.value){h.setValue(f.value);}if(null!=f.isNecessaryCheck){h.setNecessaryCheck(f.isNecessaryCheck,true);}if(null!=f.disabled){h.setDisabled(f.disabled,true);}if(null!=f.visible){h.setVisible(f.visible,true);}}else{if("button"==h.getType()){if(null!=f.label){h.setLabel(f.label);}if(null!=f.value){h.setValue(f.value);}if(null!=f.isNecessaryCheck){h.setNecessaryCheck(f.isNecessaryCheck,true);}if(null!=f.disabled){h.setDisabled(f.disabled,true);}if(null!=f.visible){h.setVisible(f.visible,true);}}else{if("calendar"==h.getType()){if(null!=f.yearValue&&null!=f.monthValue&&null!=f.dayValue){h.setValue(f.yearValue,f.monthValue,f.dayValue,false);}if(null!=f.isNecessaryCheck){h.setNecessaryCheck(f.isNecessaryCheck,true);}if(null!=f.disabled){h.setDisabled(f.disabled,true);}if(null!=f.visible){h.setVisible(f.visible,true);}}else{if("image"==h.getType()){if(null!=f.image){h.setValue(f.image,false);}if(null!=f.isNecessaryCheck){h.setNecessaryCheck(f.isNecessaryCheck,true);}if(null!=f.disabled){h.setDisabled(f.disabled,true);}if(null!=f.visible){h.setVisible(f.visible,true);}}else{if("sign"==h.getType()||"signGroup"==h.getType()){var c=h.ctrlID;if(-1!=c.indexOf(".")){c=c.substring(c.indexOf(".")+1);}c=decodeURI(c.replace(/[r]/g,"%"));c=c.substring(0,c.lastIndexOf("_"));if(null==f.title||c==f.title){if(null!=f.image){h.controlData.pathString=null;h.setValue(f.image);}if(null!=f.path&&""!=f.path){h.controlData.pathString=f.path;}if(null!=f.isNecessaryCheck){h.setNecessaryCheck(f.isNecessaryCheck,true);}if(null!=f.disabled){h.setDisabled(f.disabled,true);}if(null!=f.visible){h.setVisible(f.visible,true);}}}}}}}}}}}}}if(this.isEasyInput){this.eformEasyInputSectionVisibleMultiData(g);}}};Report.prototype.getEFormDataAllJsonData=function(f){var m={code:0,message:"성공"};if(null==this.m_objClipDocument){m.code=2;m.message="뷰어가 활성화된 상태가 아닙니다.";return m;}var l=this.findGroupByName("");var a=[];var q=l.controlList;var o=f;if(q.length>0){for(var k=0;k<q.length;k++){var h=q[k];if(null==f||"*"==f){o=h.controlData.rName;}else{if(h.controlData.rName!=o){continue;}}switch(h.controlData.type){case"radiobox":var p={};p.inputID=h.controlData.id;p.reportName=o;p.type="radiobox";p.value=h.controlData.value;p.disabled=h.controlData.disable;p.visible=h.controlData.visible;p.isNecessaryCheck="true"==h.controlData.isNecessaryCheck;p.isSelected="true"==h.controlData.checked;p.isNecessaryChecked=!h.controlData.is_nc;p.sectionName=h.controlData.sName?h.controlData.sName:"";a.push(p);break;case"checkbox":var p={};p.inputID=h.controlData.id;p.reportName=o;p.type="checkbox";p.value=h.controlData.value;p.disabled=h.controlData.disable;p.visible=h.controlData.visible;p.isNecessaryCheck="true"==h.controlData.isNecessaryCheck;p.isChecked="true"==h.controlData.checked;p.isNecessaryChecked=!h.controlData.is_nc;p.sectionName=h.controlData.sName?h.controlData.sName:"";a.push(p);break;case"input":var p={};p.inputID=h.controlData.id;p.reportName=o;p.type="input";p.value=h.controlData.value;p.label=h.controlData.formatData;p.disabled=h.controlData.disable;p.visible=h.controlData.visible;p.isNecessaryCheck="true"==h.controlData.isNecessaryCheck;p.isNecessaryChecked=!h.controlData.is_nc;p.sectionName=h.controlData.sName?h.controlData.sName:"";a.push(p);break;case"sign":case"signGroup":var c=h.ctrlID;if(-1!=c.indexOf(".")){c=c.substring(c.indexOf(".")+1);}c=decodeURI(c.replace(/[r]/g,"%"));c=c.substring(0,c.lastIndexOf("_"));var p={};p.inputID=h.controlData.id;p.reportName=o;p.type="sign";p.image=h.controlData.image;p.value="";p.path=h.controlData.pathString;p.title=c;p.disabled=h.controlData.disable;p.visible=h.controlData.visible;p.isNecessaryCheck="true"==h.controlData.isNecessaryCheck;p.isNecessaryChecked=!h.controlData.is_nc;p.sectionName=h.controlData.sName?h.controlData.sName:"";a.push(p);break;case"image":var p={};p.inputID=h.controlData.id;p.reportName=o;p.type="image";p.image=h.controlData.image;p.value="";p.disabled=h.controlData.disable;p.visible=h.controlData.visible;p.isNecessaryCheck="true"==h.controlData.isNecessaryCheck;p.isNecessaryChecked=!h.controlData.is_nc;p.sectionName=h.controlData.sName?h.controlData.sName:"";a.push(p);break;case"calendar":var p={};p.inputID=h.controlData.id;p.reportName=o;p.type="calendar";p.yearValue=h.controlData.yearValue;p.monthValue=h.controlData.monthValue;p.dayValue=h.controlData.dayValue;p.value="";p.disabled=h.controlData.disable;p.visible=h.controlData.visible;p.isNecessaryCheck="true"==h.controlData.isNecessaryCheck;p.isNecessaryChecked=!h.controlData.is_nc;p.sectionName=h.controlData.sName?h.controlData.sName:"";a.push(p);break;case"selectbox":var p={};p.inputID=h.controlData.id;p.reportName=o;p.type="selectbox";p.value=h.controlData.value;p.label=h.controlData.label;p.disabled=h.controlData.disable;p.visible=h.controlData.visible;p.isNecessaryCheck="true"==h.controlData.isNecessaryCheck;p.isNecessaryChecked=!h.controlData.is_nc;p.sectionName=h.controlData.sName?h.controlData.sName:"";a.push(p);break;case"button":var p={};p.inputID=h.controlData.id;p.reportName=o;p.type="button";p.value=h.controlData.value;p.label=h.controlData.label;p.disabled=h.controlData.disable;p.visible=h.controlData.visible;p.isNecessaryCheck="true"==h.controlData.isNecessaryCheck;p.isNecessaryChecked=!h.controlData.is_nc;p.sectionName=h.controlData.sName?h.controlData.sName:"";a.push(p);break;case"video":break;default:break;}}}if(null!=this.m_saveJsonDocPageList){var i=new documentReader();var d=0;for(var k=0;k<this.m_saveJsonDocPageList.length;k++){if(null==f||"*"==f){o=this.m_saveReportInfoIndexList[k];}else{if(null!=o){if(o!=this.m_saveReportInfoIndexList[k]){continue;}}}var b=i.readDocumentPage(this.m_saveJsonDocPageList[k],true);for(var j=0;j<b.subSectionList.length;j++){var n=b.subSectionList[j];var p={};p.easyInputID=p.id=n.editEasyModeId;p.reportName=o;p.name=n.sectionName;p.type="section";p.value="";p.visible=n.isEditEasyModeVisible;p.mode=n.isEditEasyMode;if(null!=this.m_easyInputMap){var g=this.m_easyInputMap[o+"."+n.editEasyModeId];if(null!=g){if(null!=g.hidden){p.visible=!g.hidden;}if(null!=g.mode){p.mode=g.mode;}}}if(!this.isEasyInput){p.visible=true;p.mode=true;}a.push(p);}}}m.json=a;return m;};Report.prototype.mRe_findReport=function(f){if(this.isEasyInput){var g=this.paintDiv.querySelectorAll("[id*='"+f+".']");for(var b=0;b<g.length;b++){var c=g[b];if(c.style.display!="none"&&0==c.id.indexOf(f)){this.paintDiv.scrollTop=(c.offsetTop*this.m_objCavasRate);if(this.multiView.isSocket){var d=document.getElementById("scroll_guider"+this.m_uid);if(null!=d){d.top=c.offsetTop;if(this.multiView.socket.isMain){this.multiView.socket.sendScrollTo(this);}}}break;}}}else{for(var b=0;b<this.m_saveReportInfoIndexList.length;b++){var a=this.m_saveReportInfoIndexList[b];if(f==a){this.selectPage(b,"rule_cmd");break;}}}};Report.prototype.getEFormRulesCommandData=function(i,k){var h={code:0,message:"성공"};if(null==this.m_objClipDocument){h.code=2;h.message="뷰어가 활성화된 상태가 아닙니다.";return h;}var g=null;if(k=="*"){g=this.findGroupByName("");}else{g=this.findGroup(k);}var l=g.controlList;var d=true;if(l.length>0){var a=[];for(var f=0;f<l.length;f++){var c=l[f];if(c.controlData.rName!=i){continue;}else{d=false;}switch(c.controlData.type){case"radiobox":var j={};j.inputID=c.controlData.id;j.reportName=i;j.type="radiobox";j.value=c.controlData.value;j.disabled=c.controlData.disable;j.visible=c.controlData.visible;j.isNecessaryCheck="true"==c.controlData.isNecessaryCheck;j.isSelected="true"==c.controlData.checked;j.isNecessaryChecked=!c.controlData.is_nc;j.sectionName=c.controlData.sName?c.controlData.sName:"";a.push(j);break;case"checkbox":var j={};j.inputID=c.controlData.id;j.reportName=i;j.type="checkbox";j.value=c.controlData.value;j.disabled=c.controlData.disable;j.visible=c.controlData.visible;j.isNecessaryCheck="true"==c.controlData.isNecessaryCheck;j.isChecked="true"==c.controlData.checked;j.isNecessaryChecked=!c.controlData.is_nc;j.sectionName=c.controlData.sName?c.controlData.sName:"";a.push(j);break;case"input":var j={};j.inputID=c.controlData.id;j.reportName=i;j.type="input";j.value=c.controlData.value;j.disabled=c.controlData.disable;j.visible=c.controlData.visible;j.isNecessaryCheck="true"==c.controlData.isNecessaryCheck;j.isNecessaryChecked=!c.controlData.is_nc;j.sectionName=c.controlData.sName?c.controlData.sName:"";a.push(j);break;case"sign":case"signGroup":var b=c.ctrlID;if(-1!=b.indexOf(".")){b=b.substring(b.indexOf(".")+1);}b=decodeURI(b.replace(/[r]/g,"%"));b=b.substring(0,b.lastIndexOf("_"));var j={};j.inputID=c.controlData.id;j.reportName=i;j.type="sign";j.image=c.controlData.image;j.path=c.controlData.pathString;j.title=b;j.disabled=c.controlData.disable;j.visible=c.controlData.visible;j.isNecessaryCheck="true"==c.controlData.isNecessaryCheck;j.isNecessaryChecked=!c.controlData.is_nc;j.sectionName=c.controlData.sName?c.controlData.sName:"";a.push(j);break;case"image":var j={};j.inputID=c.controlData.id;j.reportName=i;j.type="image";j.image=c.controlData.image;j.disabled=c.controlData.disable;j.visible=c.controlData.visible;j.isNecessaryCheck="true"==c.controlData.isNecessaryCheck;j.isNecessaryChecked=!c.controlData.is_nc;j.sectionName=c.controlData.sName?c.controlData.sName:"";a.push(j);break;case"calendar":var j={};j.inputID=c.controlData.id;j.reportName=i;j.type="calendar";j.yearValue=c.controlData.yearValue;j.monthValue=c.controlData.monthValue;j.dayValue=c.controlData.dayValue;j.disabled=c.controlData.disable;j.visible=c.controlData.visible;j.isNecessaryCheck="true"==c.controlData.isNecessaryCheck;j.isNecessaryChecked=!c.controlData.is_nc;j.sectionName=c.controlData.sName?c.controlData.sName:"";a.push(j);break;case"selectbox":var j={};j.inputID=c.controlData.id;j.reportName=i;j.type="selectbox";j.value=c.controlData.value;j.disabled=c.controlData.disable;j.visible=c.controlData.visible;j.isNecessaryCheck="true"==c.controlData.isNecessaryCheck;j.isNecessaryChecked=!c.controlData.is_nc;j.sectionName=c.controlData.sName?c.controlData.sName:"";a.push(j);break;case"button":var j={};j.inputID=c.controlData.id;j.reportName=i;j.type="button";j.value=c.controlData.value;j.label=c.controlData.label;j.disabled=c.controlData.disable;j.visible=c.controlData.visible;j.isNecessaryCheck="true"==c.controlData.isNecessaryCheck;j.isNecessaryChecked=!c.controlData.is_nc;j.sectionName=c.controlData.sName?c.controlData.sName:"";a.push(j);break;case"video":break;default:break;}}h.json=a;}if(d){h.code=5;h.message="id : "+k+" 컨트롤을 찾을 수 없습니다.";}return h;};Report.prototype.eformRulesCommand=function(g){var h={code:0,message:"성공"};if(null==this.m_objClipDocument){h.code=2;h.message="뷰어가 활성화된 상태가 아닙니다.";return h;}if(null!=g.type&&g.type=="color"){return this.setEFormRulesCommandColor(g.reportName,g.inputID,g.red,g.green,g.blue,g.alpha);}if(null!=g.type&&g.type=="stamp"){this.mRe_setStamp(g);return h;}var f=null;if(g.inputID=="*"){f=this.findGroupByName("");}else{f=this.findGroup(g.inputID);}var j=f.controlList;var c=true;if(j.length>0){for(var d=0;d<j.length;d++){var b=j[d];if((null!=g.reportName)&&("*"!=g.reportName)){if(b.controlData.rName!=g.reportName){continue;}}c=false;if(g.event=="focus"){if("radiobox"==b.getType()&&null!=g.value&&b.controlData.value!=g.value){continue;}else{if(("sign"==b.getType()||"signGroup"==b.getType())&&null!=g.title){var a=b.ctrlID;if(-1!=a.indexOf(".")){a=a.substring(a.indexOf(".")+1);}a=decodeURI(a.replace(/[r]/g,"%"));a=a.substring(0,a.lastIndexOf("_"));if(a!=g.title){continue;}}}b.focus();break;}else{if(null==g.type||"*"==g.type){if(null!=g.isNecessaryCheck){b.setNecessaryCheck(g.isNecessaryCheck,true);}if(null!=g.disabled){b.setDisabled(g.disabled,true);}if(null!=g.visible){b.setVisible(g.visible,true);}continue;}else{if("input"==b.getType()){if(g.event=="change"){if(null!=g.value){b.setValue(g.value,false);}if(null!=g.isNecessaryCheck){b.setNecessaryCheck(g.isNecessaryCheck,true);}if(null!=g.disabled){b.setDisabled(g.disabled,true);}if(null!=g.visible){b.setVisible(g.visible,true);}}}else{if("checkbox"==b.getType()){if(g.event=="change"){if(null!=g.value){b.controlData.value=g.value;}if(null!=g.isNecessaryCheck){b.setNecessaryCheck(g.isNecessaryCheck,true);}if(null!=g.disabled){b.setDisabled(g.disabled,true);}if(null!=g.visible){b.setVisible(g.visible,true);}}else{if(g.event=="checked"){b.check(false);}else{if(g.event=="unChecked"){b.unCheck(false);}}}}else{if("radiobox"==b.getType()){if(g.event=="change"){if(null==g.value||b.controlData.value==g.value){if(null!=g.isNecessaryCheck){b.setNecessaryCheck(g.isNecessaryCheck,true);}if(null!=g.disabled){b.setDisabled(g.disabled,true);}if(null!=g.visible){b.setVisible(g.visible,true);}}}else{if(g.event=="select"){if(b.controlData.value==g.value){b.select(false);}}else{if(g.event=="unSelect"){b.group.unSelect(false,b.controlData.rName);}}}}else{if("selectbox"==b.getType()){if(g.event=="change"){if(null!=g.options){b.setOptions(JSON.stringify(g.options));}if(null!=g.isNecessaryCheck){b.setNecessaryCheck(g.isNecessaryCheck,true);}if(null!=g.disabled){b.setDisabled(g.disabled,true);}if(null!=g.visible){b.setVisible(g.visible,true);}}else{if(g.event=="select"){b.setValue(g.value);}}}else{if("button"==b.getType()){if(g.event=="change"){if(null!=g.label){b.setLabel(g.label);}if(null!=g.value){b.setValue(g.value);}if(null!=g.isNecessaryCheck){b.setNecessaryCheck(g.isNecessaryCheck,true);}if(null!=g.disabled){b.setDisabled(g.disabled,true);}if(null!=g.visible){b.setVisible(g.visible,true);}}}else{if("calendar"==b.getType()){if(g.event=="change"){if(null!=g.yearValue&&null!=g.monthValue&&null!=g.dayValue){b.setValue(g.yearValue,g.monthValue,g.dayValue,false);}if(null!=g.isNecessaryCheck){b.setNecessaryCheck(g.isNecessaryCheck,true);}if(null!=g.disabled){b.setDisabled(g.disabled,true);}if(null!=g.visible){b.setVisible(g.visible,true);}}}else{if("image"==b.getType()){if(g.event=="change"){if(null!=g.image){b.setValue(g.image,false);}if(null!=g.isNecessaryCheck){b.setNecessaryCheck(g.isNecessaryCheck,true);}if(null!=g.disabled){b.setDisabled(g.disabled,true);}if(null!=g.visible){b.setVisible(g.visible,true);}}}else{if("sign"==b.getType()||"signGroup"==b.getType()){if(g.event=="change"){var a=b.ctrlID;if(-1!=a.indexOf(".")){a=a.substring(a.indexOf(".")+1);}a=decodeURI(a.replace(/[r]/g,"%"));a=a.substring(0,a.lastIndexOf("_"));if(null==g.title||a==g.title||"*"==g.title){var i=false;if(null!=g.path){i=b.m_setPath(g.path,true,true,true);}if(null!=g.image&&!i){b.controlData.pathString=null;b.setValue(g.image,false);}if(null!=g.isNecessaryCheck){b.setNecessaryCheck(g.isNecessaryCheck,true);}if(null!=g.disabled){b.setDisabled(g.disabled,true);}if(null!=g.visible){b.setVisible(g.visible,true);}if(null!=g.guideText){b.setGuideText(g.guideText,true);}if(null!=g.isStamp){b.setStampStatus(g.isStamp);}}}}}}}}}}}}}}}if(c){h.code=5;h.message="id : "+g.inputID+" 컨트롤을 찾을 수 없습니다.";}return h;};Report.prototype.rulesControlFocus=function(){if(null!=this.m_isrulesControlInfo){var b=this.eFormControlList[this.m_isrulesControlInfo];if(null!=b){var a=b.getHE();if(null!=a){setTimeout(function(){a.focus();},100);}}}this.m_isrulesControlInfo=null;};Report.prototype.sendRulesControlInfo=function(){if(this.is_eForm){if(this.multiView.isSocket){this.multiView.socket.sendRulesControlInfo(this.m_isrulesControlInfo,this.m_uid);}}};Report.prototype.getFormMetaData=function(g){if(typeof g==="number"){g=this.m_saveReportInfoList[g];}var a=new Array();for(var l in this.eFormData){var c=l;if(-1!=c.indexOf(".")){c=c.substring(c.indexOf(".")+1);}try{c=decodeURI(c.replace(/[r]/g,"%"));}catch(k){c=decodeURI(c);}c=c.substring(0,c.lastIndexOf("_"));var f=this.eFormControlList[l];if(null!=g){if(f.controlData.rName!=g){continue;}}switch(f.controlData.type){case"radiobox":var n={};n.id=f.controlData.id;n.name=c;n.type="radiobox";n.value=f.controlData.value;n.disabled=f.controlData.disable;n.visible=f.controlData.visible;n.isNecessaryCheck="true"==f.controlData.isNecessaryCheck;n.isSelected="true"==f.controlData.checked;a.push(n);break;case"checkbox":var n={};n.id=f.controlData.id;n.name=c;n.type="checkbox";n.value=f.controlData.value;n.disabled=f.controlData.disable;n.visible=f.controlData.visible;n.isNecessaryCheck="true"==f.controlData.isNecessaryCheck;n.isChecked="true"==f.controlData.checked;a.push(n);break;case"input":var n={};n.id=f.controlData.id;n.name=c;n.type="input";n.value=f.controlData.value;n.disabled=f.controlData.disable;n.visible=f.controlData.visible;n.isNecessaryCheck="true"==f.controlData.isNecessaryCheck;a.push(n);break;case"sign":case"signGroup":var n={};n.id=f.controlData.id;n.name=c;n.type="sign";n.value=f.controlData.image;n.title=c;n.disabled=f.controlData.disable;n.visible=f.controlData.visible;n.isNecessaryCheck="true"==f.controlData.isNecessaryCheck;a.push(n);break;case"image":var n={};n.id=f.controlData.id;n.name=c;n.type="image";n.value=f.controlData.image;n.disabled=f.controlData.disable;n.visible=f.controlData.visible;n.isNecessaryCheck="true"==f.controlData.isNecessaryCheck;a.push(n);break;case"calendar":var n={};n.id=f.controlData.id;n.name=c;n.type="calendar";n.yearValue=f.controlData.yearValue;n.monthValue=f.controlData.monthValue;n.dayValue=f.controlData.dayValue;n.value="";n.disabled=f.controlData.disable;n.visible=f.controlData.visible;n.isNecessaryCheck="true"==f.controlData.isNecessaryCheck;a.push(n);break;case"selectbox":var n={};n.id=f.controlData.id;n.name=c;n.type="selectbox";n.value=f.controlData.value;n.options=f.controlData.options;n.disabled=f.controlData.disable;n.visible=f.controlData.visible;n.isNecessaryCheck="true"==f.controlData.isNecessaryCheck;a.push(n);break;case"button":var n={};n.id=f.controlData.id;n.name=c;n.type="button";n.value=f.controlData.value;n.label=f.controlData.label;n.disabled=f.controlData.disable;n.visible=f.controlData.visible;n.isNecessaryCheck="true"==f.controlData.isNecessaryCheck;a.push(n);break;case"video":break;default:break;}}if(null!=this.m_saveJsonDocPageList){var h=new documentReader();var d=0;for(var j=0;j<this.m_saveJsonDocPageList.length;j++){if(null!=g){if(g!=this.m_saveReportInfoIndexList[j]){continue;}}var b=h.readDocumentPage(this.m_saveJsonDocPageList[j],true);for(var i=0;i<b.subSectionList.length;i++){var m=b.subSectionList[i];var n={};n.id=m.editEasyModeId;n.name=m.sectionName;n.type="section";n.value="";n.mode=m.isEditEasyMode;n.visible=m.isEditEasyModeVisible;a.push(n);}}}return a;};Report.prototype.mEF_setRulesCmd=function(){if(typeof m_EF_RulesSectionCmdList!="undefined"){var c=m_EF_RulesSectionCmdList.length;for(var d=0;d<c;d++){mEF_runSectionRulesCommand(m_EF_RulesSectionCmdList[d]);}m_EF_RulesSectionCmdList=m_EF_RulesSectionCmdList.slice(c,m_EF_RulesSectionCmdList.length);}if(typeof m_EF_RulesControlCmdList!="undefined"){var f=m_EF_RulesControlCmdList.length;for(var d=0;d<f;d++){mEF_runRulesCommand(m_EF_RulesControlCmdList[d]);}m_EF_RulesControlCmdList=m_EF_RulesControlCmdList.slice(f,m_EF_RulesControlCmdList.length);}if(typeof m_EF_initData_inzent!="undefined"){var g=new Array();while(0!=m_EF_initData_inzent.length){var b=m_EF_initData_inzent.pop();var a=this.setEFormRulesCommandData_inzent(b.r,b.c,b.v);if(a.code!=0){g.push(b);}}m_EF_initData_inzent=g;}if(this.m_initData_inzent!=null){for(var d=0;d<this.m_initData_inzent.length;d++){var b=this.m_initData_inzent[d];this.setEFormRulesCommandData_inzent(b.r,b.c,b.v);}this.m_initData_inzent=null;}if(null!=this.m_tempJsonAllData){this.setEFormDataAllJsonData(this.m_tempJsonAllData);this.m_tempJsonAllData=null;}};Report.prototype.mEF_selectedPageRuleCmd=function(){if(typeof getEFormSelectedPageCommand!="undefined"){var a={uid:"",type:"selectedPage",pageNumber:0};a.uid=this.m_uid;a.pageNumber=this.beforePageIndex+1;getEFormSelectedPageCommand(a);}};Report.prototype.mEF_screenBlockRuleCmd=function(a,c){if(typeof getEFormScreenBlockCommand!="undefined"){var b={uid:"",block:null,type:"screenBlock",option:"none"};b.uid=this.m_uid;b.block=a;b.option=c;getEFormScreenBlockCommand(b);}};Report.prototype.mEF_onloadSubRuleCmd=function(){if(typeof getEFormSubLoadRulesCommand!="undefined"){var b={uid:"",reportNameList:null,};b.uid=this.m_uid;b.serverVersion=this.m_versionInfo.build;var a="1.0.0.0";if(typeof report_version!=="undefined"){a=report_version;}b.viewVersion=a;var c="None";if(typeof fileUUid!=="undefined"){c=fileUUid;}b.fileUUid=c;b.reportNameList=this.m_saveReportInfoList;if(this.parentTab&&this.parentTab.name){b.tabName=this.parentTab.name;}getEFormSubLoadRulesCommand(b);}};Report.prototype.mEF_onloadRuleCmd=function(){if(typeof getEFormLoadRulesCommand!="undefined"){var d={uid:"",reportNameList:null,};d.result=this.m_reportKey;d.uid=this.m_uid;d.serverVersion=this.m_versionInfo.build;var c="1.0.0.0";if(typeof report_version!=="undefined"){c=report_version;}d.viewVersion=c;var f="None";if(typeof fileUUid!=="undefined"){f=fileUUid;}d.fileUUid=f;d.reportNameList=this.m_saveReportInfoList;if(this.parentTab&&this.parentTab.name){d.tabName=this.parentTab.name;}getEFormLoadRulesCommand(d);}if(null!=this.m_controlColorList&&null!=this.setEFormRulesCommandColor_inzent){for(var b=0;b<this.m_controlColorList.length;b++){var a=this.m_controlColorList[b];this.setEFormRulesCommandColor_inzent(a.reportID,a.controlID,a.red,a.green,a.blue,a.alpha);}this.m_controlColorList=null;}else{if(null!=this.m_controlColorList&&null!=this.setEFormRulesCommandColor){for(var b=0;b<this.m_controlColorList.length;b++){var a=this.m_controlColorList[b];this.setEFormRulesCommandColor(a.reportID,a.controlID,a.red,a.green,a.blue,a.alpha);}this.m_controlColorList=null;}}};Report.prototype.setRuleControlVisible=function(a){this.m_RuleCtrlVisible=a;};Report.prototype.setDefaultPageNumber=function(a){this.beforePageIndex=a-1;};Report.prototype.setEFormAutoIndex=function(a){this.m_isEFormAutoIndex=a;};Report.prototype.setEFormMobileSwipeDisabled=function(a){this.swipeOption.isDisabled=a;};Report.prototype.setEFormMobileDoubleTouchDisabled=function(a){this.tripleEvent.isDisabled=a;};Report.prototype.setEFormMobilePageMoveButtonDisabled=function(a){this.m_PageMove.ButtonDisabled=a;this.swipeOption.isDisabled=true;this.tripleEvent.isDisabled=true;};Report.prototype.setEFormUsePageMoveButton=function(b,a){this.m_PageMove.eformPCButton=b;if(typeof a!=="undefined"){this.m_PageMove.isStatic=a;}};Report.prototype.setEndPageMoveEvent=function(a){this.m_isEFormPageMoveEvent=a;};Report.prototype.setNecessaryEnabled=function(a){this.eForm_isNecessary.is_start=a;};Report.prototype.setNextPageLoading=function(a){this.m_is_eform_nextPage=a;};Report.prototype.setTouchZoomInDisabled=function(a){this.m_twoTouchEvtDisabled=a;};Report.prototype.setDoodlePenDefaultVisible=function(a){this.m_isDefaultDoodleVisble=a;};Report.prototype.eFormGestureEvent=function(){var a=this;var b=a.eFormDoodleOption.gesture;if(null!=b){b.overflowX=a.paintDiv.style.overflowX;b.overflowY=a.paintDiv.style.overflowY;}this.paintDiv.ontouchstart=function(f){if(f.touches.length==1){if(!a.eFormDoodleOption.is_Ds){var h=f.touches[0];var c,g;if(is_PosiFix){c=h.clientX;g=h.clientY;}else{c=h.pageX;g=h.pageY;}if(!a.m_PageMove.ButtonDisabled&&!a.m_PageMove.isStatic){a.createPageMoveButton("eform");}if(!a.swipeOption.isDisabled){a.swipeOption.is_start=true;a.swipeOption.s_x=c;a.swipeOption.s_y=g;a.swipeOption.e_x=0;a.swipeOption.e_y=0;}if(!a.tripleEvent.isDisabled){if(h.target.tagName!="DIV"||((a.tripleEvent.x+30)<c||(a.tripleEvent.x-30)>c)||((a.tripleEvent.y+30)<g||(a.tripleEvent.y-30)>g)){a.tripleEvent.cnt=0;a.tripleEvent.x=c;a.tripleEvent.y=g;}else{if(a.tripleEvent.x==0&&a.tripleEvent.y==0){a.tripleEvent.x=c;a.tripleEvent.y=g;}}}}}if(!a.m_twoTouchEvtDisabled){if(f.touches.length==2&&f.cancelable){f.preventDefault();a.swipeOption.is_start=false;var d=a.eFormDoodleOption.gesture;d.zoom=a.eFormDoodleOption.zoomIn;d.isStart=true;var c,g;if(is_PosiFix){c=Math.abs(f.touches[0].clientX-f.touches[1].clientX);g=Math.abs(f.touches[0].clientY-f.touches[1].clientY);}else{c=Math.abs(f.touches[0].pageX-f.touches[1].pageX);g=Math.abs(f.touches[0].pageY-f.touches[1].pageY);}a.eFormDoodleOption.gesture.line=Math.sqrt((c*c)+(g*g));a.eFormDoodleOption.gesture.pos=a.eformDoodlePosition(0,this,f,false);if(a.paintDiv.scrollWidth>a.paintDiv.offsetWidth){d.nTouchX=(f.touches[0].clientX-a.paintDiv.offsetLeft+f.touches[1].clientX-a.paintDiv.offsetLeft)/2;}else{d.nTouchX=((f.touches[0].clientX-a.paintDiv.offsetLeft+f.touches[1].clientX-a.paintDiv.offsetLeft)/2)-a.paintDiv.lastChild.offsetLeft;}d.nTouchY=(f.touches[0].clientY-a.paintDiv.offsetTop+f.touches[1].clientY-a.paintDiv.offsetTop)/2;d.nStartX=(a.paintDiv.scrollLeft+d.nTouchX)/d.zoom;d.nStartY=(a.paintDiv.scrollTop+d.nTouchY)/d.zoom;if((!a.m_isObjJSONSVG||a.m_isAccessibility)||(a.m_isObjJSONViewType=="svg"&&!is_smartphone)){a.paintDiv.lastChild.lastChild.style.display="block";a.paintDiv.firstChild.style.display="none";a.paintDiv.lastChild.firstChild.style.display="none";}a.paintDiv.style.overflowX="hidden";a.paintDiv.style.overflowY="hidden";}}};this.paintDiv.ontouchmove=function(c){if(c.touches.length==1){if(!a.eFormDoodleOption.is_Ds){if(a.swipeOption.is_start&&!a.swipeOption.isDisabled){var j,i;if(is_PosiFix){j=c.touches[0].clientX;i=c.touches[0].clientY;}else{j=c.touches[0].pageX;i=c.touches[0].pageY;}if(a.swipeOption.is_start){a.swipeOption.e_x=j;a.swipeOption.e_y=i;}}}}if(!a.m_twoTouchEvtDisabled){if(c.touches.length==2&&c.cancelable){a.swipeOption.is_start=false;var k=a.eFormDoodleOption.gesture;c.preventDefault();var j,i;if(is_PosiFix){j=Math.abs(c.touches[0].clientX-c.touches[1].clientX);i=Math.abs(c.touches[0].clientY-c.touches[1].clientY);}else{j=Math.abs(c.touches[0].pageX-c.touches[1].pageX);i=Math.abs(c.touches[0].pageY-c.touches[1].pageY);}var m=Math.sqrt((j*j)+(i*i));var l=null;if(m>k.line){l=k.zoom*(m/k.line);}else{l=k.zoom/(k.line/m);}var h=a.paintDiv.clientWidth;minZoomSize=h/Number(a.pageWidth);if(minZoomSize>0.75){minZoomSize=0.75;}var d=2;if(a.m_comboNames.num400.visible){d=4;}else{if(a.m_comboNames.num300.visible){d=3;}}if(l>d){l=d;}else{if(l<minZoomSize){if(is_android_mobile44&&minZoomSize<0.5){minZoomSize=0.55;}l=minZoomSize;}}k.zoomUp=l;a.eFormZoom(l,0);var g=0;var f=0;g=k.nStartX*l-k.nTouchX;f=k.nStartY*l-k.nTouchY;a.paintDiv.scrollTo(g,f);}}};this.paintDiv.ontouchend=function(g){if(!a.eFormDoodleOption.is_Ds){var i=g.changedTouches[0];var c,h;if(is_PosiFix){c=i.clientX;h=i.clientY;}else{c=i.pageX;h=i.pageY;}if(((a.tripleEvent.x+30)>c&&(a.tripleEvent.x-30)<c)&&((a.tripleEvent.y+30)>h&&(a.tripleEvent.y-30)<h)){a.tripleEvent.cnt++;}if(!a.tripleEvent.isDisabled&&a.tripleEvent.cnt==2){var f=a.paintDiv.offsetWidth/2;if(a.tripleEvent.x>f){a.nextPage("touch");}else{a.previousPage("touch");}a.tripleEvent.cnt=0;a.tripleEvent.x=0;a.tripleEvent.y=0;a.swipeOption.s_x=0;a.swipeOption.s_y=0;a.swipeOption.e_x=0;a.swipeOption.e_y=0;}else{if(!a.swipeOption.isDisabled&&a.swipeOption.is_start){a.swipeOption.is_start=false;if(a.swipeOption.s_x-a.swipeOption.e_x>140&&a.swipeOption.e_x!=0){a.swipeEForm(0);}if(a.swipeOption.s_x-a.swipeOption.e_x<-140&&a.swipeOption.e_x!=0){a.swipeEForm(1);}a.swipeOption.s_x=0;a.swipeOption.s_y=0;a.swipeOption.e_x=0;a.swipeOption.e_y=0;}}a.swipeOption.is_start=false;}var d=a.eFormDoodleOption.gesture;if(d.isStart){if((!a.m_isObjJSONSVG||a.m_isAccessibility)||(a.m_isObjJSONViewType=="svg"&&!is_smartphone)){a.eFormZoom(d.zoomUp,1);a.paintDiv.lastChild.lastChild.style.display="";a.paintDiv.firstChild.style.display="block";a.paintDiv.lastChild.firstChild.style.display="";}else{a.eFormZoom(d.zoomUp,0);}a.paintDiv.style.overflowX=d.overflowX;a.paintDiv.style.overflowY=d.overflowY;}d.isStart=false;};};Report.prototype.swipeEForm=function(a){switch(a){case 0:if((this.paintDiv.clientWidth+this.paintDiv.scrollLeft+3)>=this.paintDiv.scrollWidth){this.nextPage("touch");}break;case 1:if(this.paintDiv.scrollLeft==0){this.previousPage("touch");}break;default:break;}};Report.prototype.slideImageView=function(a){if(this.m_isPreviewImg){var b="ClipID=R98&startPageNum="+(a+1)+"&endPageNum="+(a+1)+"&uid="+this.m_uid+"&clipUID="+this.m_uid;if(this.m_postParam!=null){b+=this.m_postParam.getParam();}var c=document.createElement("img");c.tabIndex="-1";c.setAttribute("aria-hidden","true");c.className="eform_zoomInOut";c.style.display="block";if(null!=this.paintDiv.firstChild){this.paintDiv.firstChild.appendChild(c);}b=mRe_onBeforeSend(b);var g=this.servletPath;var f=new HttpClient();var d=f.send(g,b,false,null);c.src="data:image/png;base64,"+d;this.mRe_beforeImgData=d;}else{var c=document.createElement("img");c.tabIndex="-1";c.setAttribute("aria-hidden","true");c.className="eform_zoomInOut";if(null!=this.paintDiv.firstChild){this.paintDiv.firstChild.appendChild(c);}c.src="data:image/png;base64,"+mRe_whiteImg;this.mRe_beforeImgData=mRe_whiteImg;}};Report.prototype.zoomImageView=function(){var a=document.createElement("img");a.className="eform_zoomInOut";a.tabIndex="-1";a.setAttribute("aria-hidden","true");if(null!=this.paintDiv.lastChild){this.paintDiv.lastChild.appendChild(a);}this.mRe_beforeImgData=null;};Report.prototype.setSplitView=function(a){if(is_smartphone){this.m_isSplitView=a;this.setDefaultRatio("PageWidth");}};Report.prototype.setSplitViewQuick=function(a){this.m_splitView.isQuick=a;if(a){this.swipeOption.isDisabled=false;this.tripleEvent.isDisabled=false;}else{this.swipeOption.isDisabled=true;this.tripleEvent.isDisabled=true;}};Report.prototype.setSplitViewSlideTime=function(a){if(!isNaN(Number(a))){this.m_splitView.time=Number(a)*1000;}};Report.prototype.setSpliteViewPageMoveRequiredEvent=function(a){this.m_splitView.event=a;};Report.prototype.m_splitViewSetting=function(){if(!this.m_splitView.isQuick){this.stopSplitView();}this.disabledMenu(true);this.m_popupViewDiv=document.createElement("div");this.m_popupViewDiv.className="report_popup_view";this.m_popupViewDiv.style.position="absolute";this.m_bodyDiv.appendChild(this.m_popupViewDiv);var c=this;var g=document.createElement("div");g.className="eform_setting_view_box";var l=document.createElement("table");l.className="eform_setting_view_table";var a=document.createElement("tr");l.appendChild(a);var o=document.createElement("td");o.innerHTML="슬라이드 시간 : ";a.appendChild(o);o=document.createElement("td");var k=document.createElement("select");k.className="eform_setting_view_select";var n=(this.m_splitView.time/1000);for(var d=1;d<11;d++){var f=document.createElement("option");f.value=d+"";f.innerHTML=d+"초";if(d==n){f.selected=true;}k.appendChild(f);}o.appendChild(k);a.appendChild(o);a=document.createElement("tr");l.appendChild(a);o=document.createElement("td");var h=document.createElement("input");h.type="checkbox";h.className="eform_setting_view_checkbox";h.checked=this.m_splitView.isQuick;o.appendChild(h);var j=document.createElement("span");j.innerHTML="퀵모드 전환";o.appendChild(j);a.appendChild(o);o=document.createElement("td");a.appendChild(o);var m=document.createElement("button");m.className="eform_setting_view_okButton";m.innerHTML=this.m_languageMap.ok;m.onclick=function(){c.m_splitViewSetting_ok(k,h);};var b=document.createElement("button");b.className="eform_setting_view_cencelButton";b.innerHTML=this.m_languageMap.cancel;b.onclick=function(){c.m_splitViewSetting_close();};g.appendChild(l);g.appendChild(m);g.appendChild(b);this.m_popupViewDiv.appendChild(g);};Report.prototype.m_splitViewSetting_ok=function(f,c){var g=f.value;this.m_splitView.time=Number(g)*1000;if(c.checked!=this.m_splitView.isQuick){this.m_splitView.isQuick=c.checked;var b=this;if(this.m_splitView.isQuick){this.swipeOption.isDisabled=false;this.tripleEvent.isDisabled=false;var d=this.m_splitView.inputOrder;this.m_splitView.centerButton.className="eform_slide_button eform_slide_button_center";this.m_splitView.centerButton.onclick=function(){b.changeRatioCombo("PageWidth");};this.m_splitView.leftButton.onclick=function(){b.focusSplitViewQuickInputOrder(d);};this.m_splitView.rightButton.onclick=function(){b.focusSplitViewQuickInputOrder(d);};this.changeRatioCombo("PageWidth");}else{this.swipeOption.isDisabled=true;this.tripleEvent.isDisabled=true;var a=this.m_splitView.centerButton;a.className="eform_slide_button eform_slide_button_stop";this.m_splitView.leftButton.disabled=false;this.m_splitView.leftButton.onclick=function(){a.className="eform_slide_button eform_slide_button_play";b.prevSplitView();};this.m_splitView.centerButton.onclick=function(){a.className="eform_slide_button eform_slide_button_stop";b.stopSplitView();};this.m_splitView.rightButton.disabled=false;this.m_splitView.rightButton.onclick=function(){a.className="eform_slide_button eform_slide_button_play";b.nextSplitView();};this.eFormSplitViewZoom();}}this.m_splitViewSetting_close();};Report.prototype.m_splitViewSetting_close=function(){this.m_bodyDiv.removeChild(this.m_popupViewDiv);this.disabledMenu(false);this.m_popupViewDiv=null;};Report.prototype.stopSplitView=function(){if(this.m_isSplitView){if(this.m_splitView.isStopButton){var a=this.paintDiv;$(a).stop(true,false);this.m_setSplitViewStopButton(false);this.m_setSplitViewMoveButton(true);this.m_stopSplitViewPosition();}}};Report.prototype.m_setSplitViewStopButton=function(a){this.m_splitView.isStopButton=a;};Report.prototype.m_setSplitViewMoveButton=function(a){this.m_splitView.isMoveButton=a;};Report.prototype.m_stopSplitViewPosition=function(){var a=this.paintDiv;this.m_splitView.stopPos.x=a.scrollLeft;this.m_splitView.stopPos.y=a.scrollTop;};Report.prototype.m_splitViewMovePosition=function(){var a=this.paintDiv;a.scrollLeft=this.m_splitView.stopPos.x;a.scrollTop=this.m_splitView.stopPos.y;};Report.prototype.prevSplitView=function(){if(this.m_isSplitView){if(!this.m_splitView.isMoveButton){}else{this.m_setSplitViewStopButton(true);this.m_setSplitViewMoveButton(false);this.m_splitViewMovePosition();if(this.m_splitView.pos-1>=0){var b=this;this.eFormZoom(this.m_splitView.zoomRate,1);var a=null;var c=null;if(this.m_splitView.pos==1&&this.paintDiv.scrollTop>0){a=this.m_splitView.arr[this.m_splitView.pos];}else{if(this.m_splitView.pos==1&&this.paintDiv.scrollLeft<parseInt(Number(this.pageWidth*this.m_splitView.zoomRate)-Number(this.paintDiv.clientWidth))){a=this.m_splitView.arr[this.m_splitView.pos-1];}else{if(this.m_splitView.pos==2&&this.paintDiv.scrollTop<parseInt(Number(this.pageHeight*this.m_splitView.zoomRate)/2)){a=this.m_splitView.arr[this.m_splitView.pos-1];}else{if(this.m_splitView.pos==2&&this.paintDiv.scrollLeft>0){a=this.m_splitView.arr[this.m_splitView.pos];}else{a=this.m_splitView.arr[this.m_splitView.pos-1];}}}}var d=this.paintDiv;$(d).animate({scrollLeft:a.x,scrollTop:a.y},this.m_splitView.time,function(){--b.m_splitView.pos;b.m_stopSplitViewPosition();b.m_setSplitViewMoveButton(true);b.prevSplitView();});}else{if(this.m_splitView.pos==0){if(this.paintDiv.scrollLeft>0||this.paintDiv.scrollTop>0){var b=this;this.eFormZoom(this.m_splitView.zoomRate,1);var a=this.m_splitView.arr[this.m_splitView.pos];var d=this.paintDiv;$(d).animate({scrollLeft:a.x,scrollTop:a.y},this.m_splitView.time,function(){b.m_stopSplitViewPosition();b.m_setSplitViewStopButton(false);b.m_setSplitViewMoveButton(true);});}else{this.m_setSplitViewStopButton(false);this.m_setSplitViewMoveButton(true);}}}}}};Report.prototype.nextSplitView=function(){if(this.m_isSplitView){if(!this.m_splitView.isMoveButton){}else{this.m_setSplitViewStopButton(true);this.m_setSplitViewMoveButton(false);this.m_splitViewMovePosition();if(this.m_splitView.pos+1<4){var b=this;this.eFormZoom(this.m_splitView.zoomRate,1);var a=null;if(this.m_splitView.pos==1&&this.paintDiv.scrollTop>0){a=this.m_splitView.arr[this.m_splitView.pos+1];}else{if(this.m_splitView.pos==1&&this.paintDiv.scrollLeft<parseInt(Number(this.pageWidth*this.m_splitView.zoomRate)-Number(this.paintDiv.clientWidth))){a=this.m_splitView.arr[this.m_splitView.pos];}else{if(this.m_splitView.pos==2&&this.paintDiv.scrollTop<parseInt(Number(this.pageHeight*this.m_splitView.zoomRate)/2)){a=this.m_splitView.arr[this.m_splitView.pos];}else{if(this.m_splitView.pos==2&&this.paintDiv.scrollLeft>0){a=this.m_splitView.arr[this.m_splitView.pos+1];}else{a=this.m_splitView.arr[this.m_splitView.pos+1];}}}}var c=this.paintDiv;$(c).animate({scrollLeft:a.x,scrollTop:a.y},this.m_splitView.time,function(){++b.m_splitView.pos;if(b.m_splitView.pos==3){b.m_splitView.pageInfo[b.beforePageIndex]=true;}b.m_stopSplitViewPosition();b.m_setSplitViewMoveButton(true);b.nextSplitView();});}else{if(this.m_splitView.pos==3){if(this.paintDiv.scrollLeft<parseInt(Number(this.pageWidth*this.m_splitView.zoomRate)-Number(this.paintDiv.clientWidth))){var b=this;this.eFormZoom(this.m_splitView.zoomRate,1);var a=this.m_splitView.arr[this.m_splitView.pos];var c=this.paintDiv;$(c).animate({scrollLeft:a.x,scrollTop:a.y},this.m_splitView.time,function(){b.m_stopSplitViewPosition();b.m_setSplitViewStopButton(false);b.m_setSplitViewMoveButton(true);});}else{this.m_setSplitViewStopButton(false);this.m_setSplitViewMoveButton(true);}}}}}};Report.prototype.eFormSplitViewZoom=function(){var a=this.paintDiv.clientHeight;var c=this.paintDiv.clientWidth;var b=(a*2)/Number(this.pageHeight);this.m_splitView.zoomRate=b;this.m_splitView.pos=0;this.m_splitView.arr=new Array(4);this.m_splitView.arr[0]={x:0,y:0};this.m_splitView.arr[1]={x:parseInt(Number(this.pageWidth*b)-Number(c)),y:0};this.m_splitView.arr[2]={x:0,y:((Number(this.pageHeight)*b)/2)};this.m_splitView.arr[3]={x:parseInt(Number(this.pageWidth*b)-Number(c)),y:(parseInt(Number(this.pageHeight*b)/2))};this.m_splitView.stopPos={x:0,y:0};this.paintDiv.scrollTop=0;this.paintDiv.scrollLeft=0;this.eFormZoom(b,1);};Report.prototype.EFormSubZoomIn=function(b){var a=null;switch(b){case"1.25":a=b;break;case"1.5":a=b;break;case"2":a=b;break;case"PageWidth":a=b;break;case"WholePage":a=b;break;}if(a!=null){this.subZoomIn(a);}};Report.prototype.setSubViewControl=function(d,c,a,b){this.m_useSubViewCtrl=d;this.m_useSubViewCtrlStyle=c;this.m_useSubViewCtrlClassName=a;if(typeof b=="undefined"){b=false;}this.m_useSubViewCtrlIsMouse=b;};Report.prototype.subZoomIn=function(a){if(this.multiView.isSocket){if(this.multiView.socket.isMain){this.multiView.socket.sendSubViewZoom(a,this.m_uid);}}};Report.prototype.receiveZoomIn=function(a){if(null!=a){switch(a){case"1.25":this.changeRatioCombo("125%");break;case"1.5":this.changeRatioCombo("150%");break;case"2":this.changeRatioCombo("200%");break;case"PageWidth":this.changeRatioCombo("PageWidth");break;case"WholePage":this.changeRatioCombo("WholePage");break;}}};Report.prototype.addEventDirectDoodlePen=function(b){var a=this;b.addEventListener("mousedown",function(f){var h=false;if("which" in f){h=f.which==3;}else{if("button" in f){h=f.button==2;}}if(h){if(a.m_isEndReport&&!a.m_useDirectDoodlePenEvent){a.m_useDirectDoodlePenEvent=true;a.EFormDoodle();a.penDoodle();var c=document.getElementById(a.m_uid+"doodle");var d=c.firstChild;var g;if(typeof MouseEvent==="function"){g=new MouseEvent("mousedown",{bubbles:true,cancelable:true,view:window,clientX:f.clientX,clientY:f.clientY,button:f.button,which:f.which});}else{g=document.createEvent("MouseEvents");g.initMouseEvent("mousedown",true,true,window,0,f.screenX,f.screenY,f.clientX,f.clientY,f.ctrlKey,f.altKey,f.shiftKey,f.metaKey,f.button,null);Object.defineProperty(g,"which",{value:f.which});}d.dispatchEvent(g);}}},false);b.addEventListener("contextmenu",function(c){c.preventDefault();},false);};Report.prototype.addEventSubViewCtrl=function(b){var a=this;b.addEventListener("contextmenu",function(c){var f=false;if("which" in c){f=c.which==3;}else{if("button" in c){f=c.button==2;}}if(f){var l=getElementOffsetTop(b);var k=getElementOffsetLeft(b);var d=b.offsetWidth;var m=b.lastChild.offsetWidth;var i=a.eFormDoodleOption.zoomIn;var j=(d-(m*i))/2;var h=c.clientX-k;var g=c.clientY-l;if(j>0){if((j>h)||(j+(m*i))<h){return;}}else{j=0;}h=((h-j)+b.scrollLeft)/i;g=(g+b.scrollTop)/i;if(a.multiView.isSocket){if(a.multiView.socket.isMain){a.multiView.socket.sendMainViewPoint(h,g,a.m_uid);}}}c.preventDefault();},false);};Report.prototype.receiveViewPoint=function(a,g){var c=this.paintDiv.offsetWidth;var b=this.paintDiv.lastChild.offsetWidth;var d=this.eFormDoodleOption.zoomIn;var f=(c-(b*d))/2;if(!(f>0)){a=(a*d)-200;if(a>0){this.paintDiv.scrollLeft=a;}else{this.paintDiv.scrollLeft=0;}}else{this.paintDiv.scrollLeft=0;}g=(g*d)-200;if(g>0){this.paintDiv.scrollTop=g;}else{this.paintDiv.scrollTop=0;}};Report.prototype.changeRatioEFormZoom=function(a){a=a/100;var c=this.eFormDoodleOption.zoomIn;var b=this.eFormDoodleOption.zoomIn+a;b=0.5>b?0.5:(2<b?2:b);if(c!=b){this.eFormZoom(b,1);}return Math.floor(b*100);};Report.prototype.eFormZoom=function(m,f){var l=m;this.eFormDoodleOption.zoomIn=Re_zoom.rate=l;var b=Number(l);if(!(b==0.5||b==0.75||b==1||b==1.25||b==2||b==3||b==4)){var j=this.zoomCombo.firstChild;if(null!=j){if(j.value=="0.5"){var h=document.createElement("option");h.name="custom";h.value=b+"";h.innerHTML=(Math.floor(b*100))+"%";this.zoomCombo.insertBefore(h,j);}else{j.value=b+"";j.innerHTML=(Math.floor(b*100))+"%";}}}this.zoomCombo.value=l+"";var g=this.paintDiv.firstChild.firstChild;if(null!=g&&"svg"==g.tagName&&(f>0||is_smartphone)){this.m_objCavasRate=l;g.setAttribute("width",Number(this.pageWidth)*Number(l));g.setAttribute("height",Number(this.pageHeight)*Number(l));if(null!=g.lastChild){g.lastChild.setAttribute("transform","scale("+l+") translate(0,0)");}}else{if(null!=g&&"CANVAS"==g.tagName){if(f>0){if(this.m_objCavasRate!=l){this.m_objCavasRate=l;var a=g.parentElement;a.removeChild(g);if(l<1){var i=this.reDrawCanvasPage(1,a);if(is_smartphone){i.style.zoom=(l*0.5);}else{i.style.zoom=l;}}else{var i=this.reDrawCanvasPage(l,a);}}else{if(is_smartphone){g.style.zoom=this.m_objCavasRate<1?(this.m_objCavasRate*0.5):"0.5";}else{g.style.zoom=this.m_objCavasRate<1?this.m_objCavasRate:"1";}}}else{this.m_objCavasRate=l;g.style.zoom=l/Number(g.getAttribute("nZoom"));}}}var d=this.paintDiv.firstChild.nextSibling;if(null!=d&&f>=0){d.style.zoom=l;if(is_smartphone){d.style.display="block";d.style.position="absolute";var k=d.offsetWidth*l;if((k)>this.paintDiv.offsetWidth){d.style.left="0px";}else{var c=((this.paintDiv.offsetWidth-k)/2)/l;d.style.left=c+"px";}}}this.zoomChangeEForm();this.scrollCorrection(b);};Report.prototype.zoomChangeEForm=function(){if(this.multiView&&this.multiView.isSocket){if(!this.multiView.socket.isMain){var a=this.paintDiv;var i={srcElement:a};this.multiView.socket.sendScrollPosition(i,this.m_uid);}else{var p=document.getElementById("scroll_guider"+this.m_uid);if(p!=null){var n=document.getElementById("scroll_guider_selector"+this.m_uid);var k=this.multiView.socket;var u=this.getProperty("sub_position");if(null!=u){var q=this.paintDiv.firstChild.clientHeight;var l=this.paintDiv.offsetTop-this.paintDiv.scrollTop;var g=u.contentHeight;var r=u.clientHeight;var s=u.scrollTop;var h=r/g*q;k.scrollTop=s/g*q;p.style.height=n.style.height=h+"px";p.style.top=n.style.top=(k.scrollTop+l)+"px";if(h>0){p.style.borderWidth=n.style.borderWidth="2px";}if(this.m_useSubViewCtrl){var o=this.paintDiv.lastChild.clientWidth*this.m_objCavasRate;var d=this.paintDiv.firstChild.clientWidth;var f=this.paintDiv.offsetLeft-this.paintDiv.scrollLeft;if(d-o>0){f=f+((d-o)/2);}var c=u.clientWidth;var b=u.contentWidth;var m=u.scrollLeft;var t=c/b*o;k.scrollLeft=m/b*o;p.style.width=t+"px";p.style.left=n.style.left=(k.scrollLeft+f)+"px";}var j=n.getAttribute("pinStatus");if(null!=j){if(j=="true"){this.paintDiv.scrollTop=k.scrollTop;if(this.m_useSubViewCtrl){this.paintDiv.scrollLeft=k.scrollLeft;}}}}}}}};Report.prototype.setTitleSpeechBubbleVisibleInput=function(h,g,f,a,b,c,d){this.titleSpeechBubble.visible.input=h;this.titleSpeechBubble.visible.sign=g;this.titleSpeechBubble.visible.signGroup=f;this.titleSpeechBubble.visible.checkbox=a;this.titleSpeechBubble.visible.radiobox=b;this.titleSpeechBubble.visible.selectbox=c;this.titleSpeechBubble.visible.calendar=d;};Report.prototype.setTitleSpeechBubble=function(b,h,f,c,a,i,j,d,g){if(typeof i==="undefined"){i=400;}if(typeof j==="undefined"){j=90;}if(typeof d==="undefined"){d=10;}if(typeof g==="undefined"){g="left";}this.titleSpeechBubble.isEnable=b;this.titleSpeechBubble.bgColor=h;this.titleSpeechBubble.color=f;this.titleSpeechBubble.size=c;this.titleSpeechBubble.time=a;this.titleSpeechBubble.width=i;this.titleSpeechBubble.height=j;this.titleSpeechBubble.textMargin=d;this.titleSpeechBubble.textAlign=g;};Report.prototype.inputCreateTitleSpeechBubble=function(a){if(!this.titleSpeechBubble.isEnable){return;}var b=this;setTimeout(function(){b.mRe_intervalCreateTitleSpeechBubble(a);},50);};Report.prototype.mRe_intervalCreateTitleSpeechBubble=function(o){this.inputRemoveTitleSpeechBubble();var p=o.controlData.title;var i=o.getHE();if(typeof p=="undefined"){p="";}if(p.trim()!=""&&null!=i){var c=i.offsetTop;var f=i.offsetLeft;var k=i.offsetWidth;var d=i.offsetHeight;if(c==0&&f==0&&k==0&&d==0){return;}var h=this.paintDiv.scrollTop/this.m_objCavasRate;var j=c-this.titleSpeechBubble.height;var b="top";if((c-h)<(this.titleSpeechBubble.height+10)){j=c+d;b="bottom";}var m=i.parentElement.offsetWidth;var a=f-20;var l="left";if(f+(this.titleSpeechBubble.width+50)>m){a=f-(this.titleSpeechBubble.width-k);l="right";}var g={targetElm:i.parentElement,left:a,top:j,width:this.titleSpeechBubble.width,height:this.titleSpeechBubble.height,bgColor:this.titleSpeechBubble.bgColor,color:this.titleSpeechBubble.color,arrowVAlign:b,arrowAlign:l,text:p,textMargin:this.titleSpeechBubble.textMargin,textAlign:this.titleSpeechBubble.textAlign,fontSize:this.titleSpeechBubble.size};this.titleSpeechBubble.id=createTitleSpeechBubble(g);var n=this;this.titleSpeechBubble.clearTime=setTimeout(function(){n.titleSpeechBubble.clearTime=null;n.inputRemoveTitleSpeechBubble();},this.titleSpeechBubble.time);}};Report.prototype.inputRemoveTitleSpeechBubble=function(){if(null!=this.titleSpeechBubble.clearTime){clearTimeout(this.titleSpeechBubble.clearTime);this.titleSpeechBubble.clearTime=null;}if(null!=this.titleSpeechBubble.id){removeTitleSpeechBubble(this.titleSpeechBubble.id);this.titleSpeechBubble.id=null;}};Report.prototype.inputImagePointerOut=function(){if(this.m_isImagePointer.visible&&this.m_isImagePointer.focusOutHidden){this.mRe_ImagePointerOut();}if(this.m_isImagePointer.visibleRect&&this.m_isImagePointer.focusOutHidden){this.mRe_ImagePointerRectOut();}};Report.prototype.mRe_ImagePointerOut=function(){var a=document.getElementById(this.m_uid+"ImagePointer");if(null!=a){a.style.display="none";}};Report.prototype.mRe_ImagePointerRectOut=function(){var a=document.getElementById(this.m_uid+"ImagePointerRect");if(null!=a){a.style.display="none";}};Report.prototype.inputImagePointerIn=function(k){var c=k.getHE();if(null!=c){var d=c.offsetTop;var h=c.offsetLeft;var m=c.offsetWidth;var f=c.offsetHeight;if(d==0&&h==0&&m==0&&f==0){if(this.m_isImagePointer.visibleRect){this.mRe_ImagePointerRectOut();}if(this.m_isImagePointer.visible){this.mRe_ImagePointerOut();}return;}if(this.m_isImagePointer.visibleRect){var b=document.getElementById(this.m_uid+"ImagePointerRect");if(null==b){b=document.createElement("div");b.id=this.m_uid+"ImagePointerRect";b.className="eform_image_pointerRect";b.tabIndex="-1";}c.parentNode.insertBefore(b,c);b.style.display="block";b.style.left=c.style.left;b.style.top=c.style.top;b.style.width=c.style.width;b.style.height=c.style.height;if(null!=this.m_isImagePointer.timeOutEvent){window.clearTimeout(this.m_isImagePointer.timeOutEvent);}if(this.m_isImagePointer.delayHidden){var j=this;this.m_isImagePointer.timeOutEvent=window.setTimeout(function(){j.mRe_ImagePointerRectOut();},(this.m_isImagePointer.delayTime*1000));}}if(this.m_isImagePointer.visible){var n=document.getElementById(this.m_uid+"ImagePointer");if(null==n){n=document.createElement("div");n.id=this.m_uid+"ImagePointer";n.className="eform_image_pointer";var i=document.getElementById(this.m_uid+"IO_in");i.parentNode.appendChild(n);}n.style.display="block";var a=this.eFormDoodleOption.zoomIn;if(this.isEasyInput){var l=c.parentElement;while((l.offsetTop>0||l.offsetLeft>0)||l.style.position=="relative"){d+=l.offsetTop;h+=l.offsetLeft;l=l.parentElement;}}d=is_edge?d/a:d;h=is_edge?h/a:h;var o=(h-(n.offsetWidth/2));var g=(d+(c.offsetHeight*0.7));if(this.m_isImagePointer.imgPo==0){o=(h-n.offsetWidth);g=(d+c.offsetHeight);}n.style.left=o+"px";n.style.top=g+"px";if(null!=this.m_isImagePointer.timeOutEvent){window.clearTimeout(this.m_isImagePointer.timeOutEvent);}if(this.m_isImagePointer.delayHidden){var j=this;this.m_isImagePointer.timeOutEvent=window.setTimeout(function(){j.mRe_ImagePointerOut();},(this.m_isImagePointer.delayTime*1000));}}}};Report.prototype.inputOrderFoucs=function(k){if(this.m_isHybridQuickControl&&this.m_isHybridQuickControlLock){if(k.controlData.disable||!k.controlData.visible||k.controlData.indexOrderDisable||!k.controlData.is_nc){return;}}if(null==this.m_IO_HE){this.m_IO_HE=new Object();this.m_IO_HE.main=document.getElementById(this.m_uid+"IndexOrder");this.m_IO_HE.inner=document.getElementById(this.m_uid+"IO_in");this.m_IO_HE.left=this.m_IO_HE.inner.firstChild;this.m_IO_HE.right=this.m_IO_HE.inner.lastChild;}var c=k.getHE();var n=this.m_IO_HE;var j=this;this.m_IO_HE.target=c;if(null!=c){var a=this.eFormDoodleOption.zoomIn;if((this.m_isHybridQuickControl&&this.m_nQuickControlMobileZoomEnabled)&&is_smartphone){if(a!=this.m_nQuickControlMobileZoom){this.m_nHybridTempZoom=a;}this.eFormZoom(this.m_nQuickControlMobileZoom,1);a=this.eFormDoodleOption.zoomIn;}n.main.style.display="block";n.inner.style.display="block";var f=is_edge?c.offsetTop/a:c.offsetTop;var h=is_edge?c.offsetLeft/a:c.offsetLeft;var m=k.controlData.inputOrder;if(this.m_isSplitView){n.left.style.display="none";n.right.style.display="none";n.main.onclick=function(){j.inputOrderBlur();};if(this.m_splitView.isQuick){this.m_splitView.inputOrder=m;if(findPrevControl(this.eFormIndexControlList,m)){this.m_splitView.leftButton.onclick=null;this.m_splitView.leftButton.disabled=true;}else{this.m_splitView.leftButton.disabled=false;this.m_splitView.leftButton.onclick=function(o){j.defaultFoucsOut(k);j.nextInputOrder(m-1,false);if(o.stopPropagation){o.stopPropagation();}else{o.cancelBubble=true;}};}if(findNextControl(this.eFormIndexControlList,m)){this.m_splitView.rightButton.onclick=null;this.m_splitView.rightButton.disabled=true;}else{this.m_splitView.rightButton.disabled=false;this.m_splitView.rightButton.onclick=function(o){j.defaultFoucsOut(k);j.nextInputOrder(m+1,true);if(o.stopPropagation){o.stopPropagation();}else{o.cancelBubble=true;}};}}}else{if(this.m_isHybridQuickControl){n.left.style.display="none";n.right.style.display="none";n.main.style.display="none";n.inner.style.display="none";n.main.onclick=function(){j.inputOrderBlur();};if(null!=this.paintDiv){this.m_isHybridQuickControlZoom=true;f=f+c.parentElement.offsetTop;h=h+c.parentElement.offsetLeft;var b=(this.paintDiv.offsetWidth-c.offsetWidth)/2;var l=(this.paintDiv.offsetHeight-c.offsetHeight)/2;var i=(h-(b/a))*a;var d=(f-100)*a;if(this.paintDiv.style.overflowX!="hidden"){if(i<0){i=1;}this.paintDiv.scrollLeft=i;}if(d<0){d=1;}this.paintDiv.scrollTop=d;}return;}else{if(this.isEasyInput){n.left.style.display="none";n.right.style.display="none";n.main.style.display="none";n.inner.style.display="none";n.main.onclick=function(){j.inputOrderBlur();};return;}else{if(this.multiView.isSocket){n.left.style.display="none";n.right.style.display="none";}else{n.left.style.display="block";n.right.style.display="block";}var g=2;if(findPrevControl(this.eFormIndexControlList,m)){n.left.style.display="none";g--;}if(findNextControl(this.eFormIndexControlList,m)){n.right.style.display="none";g--;}if(g>1&&45>c.offsetWidth){n.inner.style.left=(c.offsetLeft-13)+"px";n.inner.style.top=(f-25)+"px";n.inner.style.width="1.2cm";}else{n.inner.style.left=c.style.left;n.inner.style.top=(f-25)+"px";n.inner.style.width=c.style.width;}n.main.onclick=function(){j.inputOrderBlur();};n.left.onclick=function(o){j.defaultFoucsOut(k);j.nextInputOrder(m-1,false);if(o.stopPropagation){o.stopPropagation();}else{o.cancelBubble=true;}};n.right.onclick=function(o){j.defaultFoucsOut(k);j.nextInputOrder(m+1,true);if(o.stopPropagation){o.stopPropagation();}else{o.cancelBubble=true;}};}}}if(null!=this.paintDiv){this.m_isHybridQuickControlZoom=true;if((this.paintDiv.scrollHeight+5)>this.paintDiv.offsetHeight){this.paintDiv.scrollTop=(f-30)*a;}if((this.paintDiv.scrollWidth+5)>this.paintDiv.offsetWidth){this.paintDiv.scrollLeft=(h-10)*a;}}}};Report.prototype.defaultFoucsOut=function(a){if(("sign"==a.getType()||"signGroup"==a.getType())&&a.isDOM){if(a.controlData.isDirectSign){var b=document.getElementById(this.m_uid+"okUBT");if(null!=b){b.click();}}}};Report.prototype.defaultFoucsIn=function(a){if(a.isDOM){a.getHE().focus();if(("sign"==a.getType()||"signGroup"==a.getType())){if(a.controlData.isDirectSign){if(null!=a.signElement){a.signElement.click();}}}}};Report.prototype.inputOrderBlur=function(){if(null!=this.m_IO_HE){this.m_IO_HE.target.style.zIndex="";this.m_IO_HE.main.style.display="";this.m_IO_HE.inner.style.display="";}if(this.m_isHybridQuickControl){if(null!=this.m_nHybridTempZoom){this.eFormZoom(this.m_nHybridTempZoom,1);}}};Report.prototype.focusInputOrder=function(){if(null!=this.eFormIndexInfo){this.nextInputOrder(this.eFormIndexInfo.inputOrder,this.eFormIndexInfo.isNext);}else{if(this.m_isSplitView){if(this.m_splitView.isQuick){for(var c=0;c<this.eFormIndexControlList.length;c++){var d=this.eFormIndexControlList[c];if(null!=d){if(this.isEasyInput){if(!d.isNotEasyInput){this.defaultFoucsIn(d);break;}}else{if(d.controlData.pageNumber==this.beforePageIndex){this.defaultFoucsIn(d);break;}}}}var a=this;var b=this.m_splitView.inputOrder;this.m_splitView.leftButton.disabled=false;this.m_splitView.rightButton.disabled=false;this.m_splitView.leftButton.onclick=function(){a.focusSplitViewQuickInputOrder(b);};this.m_splitView.rightButton.onclick=function(){a.focusSplitViewQuickInputOrder(b);};}}}};Report.prototype.focusSplitViewQuickInputOrder=function(b){for(var a=0;a<this.eFormIndexControlList.length;a++){var c=this.eFormIndexControlList[a];if(null!=c){if(null==b){if(this.isEasyInput){if(!c.isNotEasyInput){this.defaultFoucsIn(c);}}else{if(c.controlData.pageNumber==this.beforePageIndex){this.defaultFoucsIn(c);}else{this.eFormIndexInfo=new Object();this.eFormIndexInfo.inputOrder=c.controlData.inputOrder;this.eFormIndexInfo.isNext=true;this.selectPage(c.controlData.pageNumber,"input_order");}}break;}else{if(c.controlData.inputOrder==b){if(this.isEasyInput){if(!c.isNotEasyInput){this.defaultFoucsIn(c);}}else{if(c.controlData.pageNumber==this.beforePageIndex){this.defaultFoucsIn(c);}else{this.eFormIndexInfo=new Object();this.eFormIndexInfo.inputOrder=c.controlData.inputOrder;this.eFormIndexInfo.isNext=true;this.selectPage(c.controlData.pageNumber,"input_order");}}break;}}}}};Report.prototype.nextInputOrder=function(a,c){var b=this.eFormIndexControlList[a];if(null!=b){if(!b.controlData.disable&&b.controlData.visible&&!b.controlData.indexOrderDisable){if(b.isDOM){this.eFormIndexInfo=null;this.defaultFoucsIn(b);}else{this.eFormIndexInfo=new Object();this.eFormIndexInfo.inputOrder=a;this.eFormIndexInfo.isNext=c;this.selectPage(b.controlData.pageNumber,"input_order");}}else{this.eFormIndexInfo=null;if(c){this.nextInputOrder(a+1,true);}else{this.nextInputOrder(a-1,false);}}}};Report.prototype.nextHybridInputOrder=function(d,b){try{var c=this.eFormIndexControlList[b];if(null!=c){if(!c.controlData.disable&&c.controlData.visible&&!c.controlData.indexOrderDisable&&c.controlData.is_nc){if(c.isDOM){this.eFormIndexInfo=null;this.defaultFoucsIn(c);}else{var i=this.eFormIndexControlList[d];for(var a=0;a<d;a++){var h=this.eFormIndexControlList[a];if(null!=h&&h.controlData.is_nc&&(h.controlData.pageNumber==i.controlData.pageNumber||this.isEasyInput)&&!h.controlData.disable&&h.controlData.visible){if(this.isEasyInput){if(!h.isNotEasyInput){this.eFormIndexInfo=null;this.defaultFoucsIn(h);return;}}else{this.eFormIndexInfo=null;this.defaultFoucsIn(h);return;}}}this.eFormIndexInfo=new Object();this.eFormIndexInfo.inputOrder=b;this.eFormIndexInfo.isNext=true;this.selectPage(c.controlData.pageNumber,"input_order");}}else{this.eFormIndexInfo=null;this.nextHybridInputOrder(d,b+1);}}else{var i=this.eFormIndexControlList[d];var f=null;for(var a=0;a<b;a++){var h=this.eFormIndexControlList[a];if(null!=h&&h.controlData.is_nc&&!h.controlData.disable&&h.controlData.visible){if(h.controlData.pageNumber==i.controlData.pageNumber||this.isEasyInput){if(this.isEasyInput){if(!h.isNotEasyInput){this.eFormIndexInfo=null;this.defaultFoucsIn(h);return;}}else{this.eFormIndexInfo=null;this.defaultFoucsIn(h);return;}}else{if(null==f){f=h;}}}}if(null!=f){this.eFormIndexInfo=new Object();this.eFormIndexInfo.inputOrder=f.controlData.inputOrder;this.eFormIndexInfo.isNext=true;this.selectPage(f.controlData.pageNumber,"input_order");return;}if(this.m_HybridQuickControlEvent!=null){this.m_HybridQuickControlEvent();}}}catch(g){window.console.log("삭제된 뷰어 보입니다. 뷰어 코드 : "+this.m_uid);window.console.log(g.stack);}};Report.prototype.setBeforeInputMovementEvent=function(a){this.m_BeforeInputMovementEvent=a;};Report.prototype.setEXEKeyboardUseWonFormat=function(a){this.m_UseWonFormat=a;};Report.prototype.setOldMultiSign=function(a){this.m_isOldMultiSign=a;};Report.prototype.setSignSlide=function(a){this.isUseSignSlide=a;};Report.prototype.setSignSlideVisibleGuideText=function(a){this.isUseSignSlideByViewText=a;};Report.prototype.setSignUndoRedoHidden=function(a){this.isSignUndoRedoHidden=a;};Report.prototype.setMultiSignSlide=function(a){this.isUseSignGroupSlide=a;};Report.prototype.setStampDefaultType=function(a,b){this.m_stampDefaultType=a;this.m_isStampDefaultTypeIgnore=b;};Report.prototype.setIsObjectStamp=function(a){this.m_isObjectStamp=a;};Report.prototype.nextEasyInputControl=function(c){if(null!=c.controlData.inputOrder){var a=c.controlData.inputOrder;this.defaultFoucsOut(c);var b=this;window.setTimeout(function(){b.nextHybridInputOrder(a,a+1);},100);return true;}return false;};Report.prototype.nextHybridInputControl=function(d){if(this.m_isHybridQuickControl){var c=true;try{if(null!=this.m_BeforeInputMovementEvent){c=this.m_BeforeInputMovementEvent(d.controlData.id);}}catch(f){c=true;mRe_ReportWebLog(f.stack);}if(!c){return false;}if(null!=d.controlData.inputOrder){var a=d.controlData.inputOrder;this.defaultFoucsOut(d);var b=this;window.setTimeout(function(){b.nextHybridInputOrder(a,a+1);},100);return true;}}return false;};Report.prototype.necessaryFocus=function(){if(null!=this.m_isNecessaryInfo){var b=this.eFormControlList[this.m_isNecessaryInfo];if(null!=b){var a=b.getHE();if(null!=a){setTimeout(function(){a.focus();},200);}}}this.m_isNecessaryInfo=null;};Report.prototype.m_dynamicScript=function(b){if(null!=b&&""!=b){try{b=mCR_Base64.decode(b);b=b.trim();b+="\r\n var mRe_breakCode__11=0;";this.dynamicScript=objectEFormCall("function(){if(this.m_debug.isDebug){debugger;}\r\n"+b+"}");}catch(a){this.dynamicScript=null;this.debugMeg("report log :: 리포트파일에 설정된 동적 속성 스크립에 문제가 있습니다. >> "+a.stack);mRe_ReportEventHandler(31);}}};function objectEFormCall(a){var b=(new Function("return ("+a+")"))();return b;}Report.prototype.resetDynamicScript=function(){for(var a in this.eFormData){var b=this.eFormControlList[a];switch(b.controlData.type){case"radiobox":b.event.selectedEvent=null;b.event.unSelectedEvent=null;b.event.selectedClickEvent=null;break;case"checkbox":b.event.checkedEvent=null;b.event.unCheckedEvent=null;break;case"input":b.event.focusEvent=null;b.event.blurEvent=null;b.event.keyUpEvent=null;b.event.requiredGuideEvent=null;break;case"sign":case"signGroup":b.event.clickEvent=null;b.event.okButtonEvent=null;b.event.cencelButtonEvent=null;b.event.nextButtonEvent=null;break;case"image":b.event.clickEvent=null;b.event.changeEvent=null;break;case"calendar":b.event.clickEvent=null;b.event.dayClickEvent=null;break;case"selectbox":b.event.changeEvent=null;break;case"button":b.event.clickEvent=null;break;case"video":b.event.playEvent=null;b.event.pauseEvent=null;b.event.errorEvent=null;break;default:break;}}};Report.prototype.defaultEFormSet=function(a){this.paintDiv.firstChild.firstChild.style.overflow="hidden";if((!this.m_isObjJSONSVG||this.m_isAccessibility)&&null!=a){if(null!=a.pageWidth){this.pageWidth=Number(a.pageWidth)*0.378;this.pageHeight=Number(a.pageHeight)*0.378;}else{this.pageWidth=this.paintDiv.firstChild.firstChild.getAttribute("width");this.pageHeight=this.paintDiv.firstChild.firstChild.getAttribute("height");}}if(this.multiView.isSocket){if(this.multiView.socket.isMain){var d=this.paintDiv.childNodes[1].childNodes;for(var c=0;c<d.length;c++){var b=d[c];if("DIV"==b.tagName){var f=110+(c*10);b.style.zIndex=""+f;}}}}};Report.prototype.getFormat=function(b,a){return b.formatting(a);};Report.prototype.setGuiderLineDisplay=function(a){this.m_isGuiderLineDisplay=a;};Report.prototype.setGuiderLinePinPaper=function(a){this.m_isGuiderLinePinPaper=a;};Report.prototype.guiderLineDisplay=function(a){var c=document.getElementById("scroll_guider"+this.m_uid);var b=document.getElementById("scroll_guider_selector"+this.m_uid);if(null!=c&&null!=b){if(a){c.style.visibility=b.style.visibility="visible";c.style.zIndex="130";b.style.zIndex="149";}else{c.style.visibility=b.style.visibility="hidden";c.style.zIndex=b.style.zIndex="0";}}};Report.prototype.setHybridProgress=function(a){this.m_isHybridProgress=a;};Report.prototype.setHybridQuickControlCompleteEvent=function(a){this.setQuickControlCompleteEvent(a);};Report.prototype.setQuickControlCompleteEvent=function(a){this.m_HybridQuickControlEvent=a;};Report.prototype.setHybridQuickControl=function(a){this.setQuickControl(a);};Report.prototype.setQuickControl=function(a){this.m_isHybridQuickControl=a;if(a&&null==this.m_nQuickControlMobileZoom){this.m_nQuickControlMobileZoom=1.4;}};Report.prototype.setQuickControlMobileZoom=function(a){this.m_nQuickControlMobileZoom=a;};Report.prototype.setQuickControlAutoMobileZoom=function(a){this.m_nQuickControlMobileZoomEnabled=a;};Report.prototype.setPositionLockExcludingQuickControl=function(a){this.m_isHybridQuickControlLock=a;};Report.prototype.callSubReport=function(){if(this.multiView.isSocket){if(this.multiView.socket.isMain){this.multiView.socket.callSubReport(this.m_uid);}}else{this.debugMeg("report log :: eform 소켓 설정이 없습니다....");}};Report.prototype.closeSubReport=function(){if(this.multiView.isSocket){if(this.multiView.socket.isMain){this.multiView.socket.closeSubReport();}}else{this.debugMeg("report log :: eform 소켓 설정이 없습니다....");}};Report.prototype.setSubCallReportEvent=function(a){this.m_subReportEvent.callReportBefore=a;};Report.prototype.setSubCloseReportEvent=function(a){this.m_subReportEvent.closeReportAfter=a;};Report.prototype.sendUserData=function(a){if(this.multiView.isSocket){this.multiView.socket.sendUserData(a);}else{this.debugMeg("report log :: eform 소켓 설정이 없습니다....");}};Report.prototype.receiveUserDataCallBack=function(a){this.m_socketReportEvent.userData=a;};Report.prototype.setStampCallEvent=function(a){this.m_socketReportEvent.stampCall=a;};Report.prototype.setSocketViewEvent=function(a){this.m_socketViewEvent=a;};Report.prototype.sendStampData=function(a){if(null!=this.multiView.socket){this.multiView.socket.sendStampData(a);}};Report.prototype.sendStampCancel=function(){if(null!=this.multiView.socket){this.multiView.socket.sendStampMainCancel();}};Report.prototype.setZeroValueClearKeyboard=function(a){this.m_zeroValueKBD=a;};Report.prototype.setStampCancelEvent=function(a){this.m_socketReportEvent.stampCancel=a;};Report.prototype.getIsMain=function(){return this.isMain;};Report.prototype.getSocketObject=function(){if(this.multiView.isSocket){return this.multiView.socket;}else{return null;}};Report.prototype.setSocketStatusEvent=function(a){this.m_socketReportEvent.userData=a;};Report.prototype.callMainCreateBlockScreen=function(a){if(this.multiView.isSocket){if(!this.multiView.socket.isMain){this.multiView.socket.sendMainScreenLock(a,this.m_uid);}}};Report.prototype.callMainRemoveBlockScreen=function(){if(this.multiView.isSocket){if(!this.multiView.socket.isMain){this.multiView.socket.sendMainScreenUnLock(this.m_uid);}}};Report.prototype.createMainBlockScreen=function(d){var g="";if(typeof d=="undefined"){d="subLoading";}this.m_blockScreenType=g=d;if(d=="exeSign"){d="sign";}this.removeMainBlockScreen(false);this.m_signBlockScreen=document.createElement("div");this.m_signBlockScreen.id="mRe_ScreenLockID";this.m_signBlockScreen.addEventListener("contextmenu",function(h){h.preventDefault();},false);this.m_signBlockScreen.style.cssText="position:absolute;left:0px;right:0px;top:0px;bottom:0px;background-color:rgba(192,192,192,0.3);z-index:800;";var b=document.createElement("div");b.style.cssText="position:absolute;overflow:visible;";var f=document.createElement("div");f.className="eform_"+d+"_wait";var a=this;this.m_signBlockScreen.appendChild(b);b.appendChild(f);document.body.appendChild(this.m_signBlockScreen);this.mRe_reSizeBlockScreen(b);this.mEF_screenBlockRuleCmd(true,g);var c=this;window.addEventListener("resize",function(){c.mRe_reSizeBlockScreen(b);},false);};Report.prototype.removeMainBlockScreen=function(b){if(typeof b=="undefined"){b=true;}if(this.m_signBlockScreen!=null){try{if(null!=this.m_signBlockScreenClose){this.m_signBlockScreenClose.setAttribute("dEvent","true");this.m_signBlockScreenClose.click();}this.m_signBlockScreenClose=null;document.body.removeChild(this.m_signBlockScreen);if(b){this.mEF_screenBlockRuleCmd(false,this.m_blockScreenType);}this.m_signBlockScreen=null;this.debugMeg("report log : 메인 스크린블럭 removeMainBlockScreen 호출 삭제 ");}catch(a){this.debugMeg("report log : warning 스크린블럭이 존재하지 않지만 삭제요청이 들어옴 ");}}};Report.prototype.createSignBlockScreen=function(f,b){var s="";if(typeof f=="undefined"){f="none";}if(typeof b==="undefined"){b=[];}this.m_blockScreenType=s=f;if(f=="exeSign"){f="sign";}this.removeSignBlockScreen(false);this.m_signBlockScreen=document.createElement("div");this.m_signBlockScreen.id="mRe_ScreenLockID";this.m_signBlockScreen.addEventListener("contextmenu",function(z){z.preventDefault();},false);this.m_signBlockScreen.style.cssText="position:absolute;left:0px;right:0px;top:0px;bottom:0px;background-color:rgba(192,192,192,0.3);z-index:800;";var w=document.createElement("div");w.style.cssText="position:absolute;overflow:visible;";var p=document.createElement("div");var d=null;if(f=="key"||f=="calendar"||f=="selectbox"){p.className="eform_keyboard_wait";}else{if(f=="singlesign"||f=="appsign"){p.className="eform_singleSign_wait";}else{p.className="eform_sign_wait";}}var c=document.createElement("button");c.className="eform_wait_close_button";c.innerHTML="×";this.m_signBlockScreenClose=c;var g=this;c.onclick=function(){if(g.multiView.isSocket){g.multiView.socket.sendHybirdClose(f);}var z=this.getAttribute("dEvent");if(null==z){g.removeSignBlockScreen();g.m_signBlockScreenClose=null;}};this.m_signBlockScreen.appendChild(w);w.appendChild(p);w.appendChild(c);document.body.appendChild(this.m_signBlockScreen);this.mEF_screenBlockRuleCmd(true,s);this.mRe_reSizeBlockScreen(w);p.style.top="15px";p.style.left=c.style.top="0px";c.style.left=(p.offsetWidth-20)+"px";if((f=="singlesign"||f=="appsign")&&b.length>0){var h="저장";var j="인감";var r="초기화";if(typeof window.objClipMainSaveButtonName!="undefined"){h=window.objClipMainSaveButtonName;}if(typeof window.objClipMainStampButtonName!="undefined"){j=window.objClipMainStampButtonName;}if(typeof window.objClipMainResetButtonName!="undefined"){r=window.objClipMainResetButtonName;}var y=document.createElement("button");y.className="eform_wait_stamp_ok_button";y.innerHTML=h;y.onclick=function(){if(g.multiView.isSocket){if(f=="singlesign"){g.multiView.socket.sendSingleSignOk();}else{g.multiView.socket.sendAppRemoteOK(0);}}if(f!="appsign"){g.removeSignBlockScreen();}};y.style.left="0px";y.style.top=(p.offsetTop+p.offsetHeight+10)+"px";w.appendChild(y);var v=b.length;var a=0;var o=null;for(var l=0;l<v;l++){var i=b[l];var t=this.eFormControlList[i];var m=null!=t&&""!=t.controlData.title?t.controlData.title:(l+1)+"";if(this.isMainStampScanner){if(null!=t&&t.controlData.useStamp){var u=document.createElement("button");u.className="eform_wait_stamp_button";if(is_ie&&m.length>3){u.innerText=j;}else{u.innerText=j+"\n("+m+")";}u.title=m;u.ctrlID=i;u.onclick=function(){g.callMainStampScanner(this.ctrlID);};w.appendChild(u);u.style.left=(p.offsetWidth-200)+"px";u.style.top=(p.offsetTop+(p.offsetHeight+10)+((50)*a))+"px";u.style.fontSize="11pt";u.style.height="40px";a++;o=u;}}var n=document.createElement("button");n.className="eform_wait_stamp_reset_button";n.title=m;if(is_ie&&m.length>5){n.innerText=r;}else{n.innerText=r+"\n("+m+")";}n.ctrlID=i;n.onclick=function(){if(g.multiView.isSocket){if(f=="singlesign"){g.multiView.socket.sendSingleSignReset(this.ctrlID);}else{g.clearAppSignImg(this.ctrlID);g.multiView.socket.sendAppRemoteReset(this.ctrlID,0);}}};w.appendChild(n);n.style.left=(p.offsetWidth-n.offsetWidth)+"px";n.style.top=(p.offsetTop+(p.offsetHeight+10)+((50)*l))+"px";if(v>1){n.style.fontSize="11pt";n.style.height="40px";}else{y.style.height=n.style.height="60px";}var d=document.createElement("canvas");d.className="eform_singleSign_wait_canvas";p.appendChild(d);var q=d.offsetWidth/v;d.style.left=(q*l)+"px";d.style.width=q+"px";d.width=q;d.height=d.offsetHeight;if(v>1){d.style.borderRight="1px dashed silver";}var k=true;if(f=="singlesign"){d.id=this.m_uid+"appSign"+i;if(null==this.m_signBlockScreenCanvas){this.m_signBlockScreenCanvas={};}this.m_signBlockScreenCanvas[i]=new SignaturePad(d,{minWidth:1,maxWidth:1});this.m_signBlockScreenCanvas[i].off();}else{d.id=this.m_uid+"appSign"+i;if(null!=t){this.receiveAppSignImg(i,t.controlData.image);k=false;}}if(null!=t&&t.controlData.useStamp){if(null!=t.controlData.image&&t.controlData.image.length>0){if(typeof t.controlData.pathString==="string"&&" "==t.controlData.pathString){t.isStampCheck=true;t.stampImage=t.controlData.image;if(k){this.receiveAppSignImg(i,t.stampImage);}}}}}if(a==1&&null!=o){o.style.fontSize="";o.style.height="60px";}}var x=this;window.addEventListener("resize",function(){x.mRe_reSizeBlockScreen(w);},false);};Report.prototype.clearAppSignImg=function(f){var d=document.getElementById(this.m_uid+"appSign"+f);if(null!=d){var b=d.getContext("2d");var a=d.width;var c=d.height;b.clearRect(0,0,a,c);return d;}return null;};Report.prototype.receiveAppSignImg=function(a,b){this.receiveStampImg(a,b,null,null);};Report.prototype.receiveStampImg=function(g,i,f,h){var d=this.clearAppSignImg(g);if(null!=d){if(null==f){f=d.width;h=d.height;}var a=d.getContext("2d");var c="data:image/png;base64,"+i;var b=new Image();b.src=c;b.onload=function(){var j=d.width;var l=d.height;var r=f/h;var s=j/l;var t,m;if(s>r){t=l*r;m=l;}else{t=j;m=j/r;}var k=(j-t)/2;var u=(l-m)/2;var p=b.width;var o=b.height;j=t;l=m;r=p/o;s=j/l;if(s>r){t=l*r;m=l;}else{t=j;m=j/r;}var q=k+((j-t)/2);var n=u+((l-m)/2);a.drawImage(b,q,n,t,m);};}};Report.prototype.drawSignBlockScreenCanvas=function(f,c){if(null!=this.m_signBlockScreenCanvas){var d=this.m_signBlockScreenCanvas[c];if(null!=d){if(null==d.orginTempPath){d.orginTempPath=f;}else{f=d.orginTempPath=d.orginTempPath.concat(f);}var g=mRe_copyObj(f);var b=mRe_RectPoint(g);mRe_RatePath(g,1,"/",-(b.x1-5),-(b.y1-5));var a=mRe_calcRect((b.x2-b.x1+10),(b.y2-b.y1+10),d._offsetWidth,d._offsetHeight);mRe_RatePath(g,a.canvasRate,"/",a.offsetX,a.offsetY);d.fromData(g);d.undoRedoClear();}}};Report.prototype.clearSignBlockScreenCanvas=function(a){if(null!=this.m_signBlockScreenCanvas&&null!=this.m_signBlockScreenCanvas[a]){this.m_signBlockScreenCanvas[a].orginTempPath=null;this.m_signBlockScreenCanvas[a].clear();}};Report.prototype.signUndoRedoSet=function(a,b){if(null!=this.m_signBlockScreenCanvas&&null!=this.m_signBlockScreenCanvas[a]){if(b==0){this.m_signBlockScreenCanvas[a].undo();}else{this.m_signBlockScreenCanvas[a].redo();}}};Report.prototype.appendScreenLockStampButton=function(n,k){var b=document.body.lastChild;if(b.id=="mRe_ScreenLockID"){this.m_signBlockScreen=b;this.m_signBlockScreen.addEventListener("contextmenu",function(i){i.preventDefault();},false);}var r=this;window.send_sub_stamp_data=function(y,i){if(r.multiView.isSocket){r.multiView.socket.sendExeMainStampData(r.m_uid,y,i);}};if(this.m_signBlockScreen!=null){var o=this.m_signBlockScreen.firstChild.firstChild;var u=o.offsetLeft;var w=o.offsetHeight;var h="저장";var j="인감";var d="전환";var q="초기화";if(typeof window.objClipMainSaveButtonName!="undefined"){h=window.objClipMainSaveButtonName;}if(typeof window.objClipMainStampButtonName!="undefined"){j=window.objClipMainStampButtonName;}if(typeof window.objClipMainChangeButtonName!="undefined"){d=window.objClipMainChangeButtonName;}if(typeof window.objClipMainResetButtonName!="undefined"){q=window.objClipMainResetButtonName;}var x=document.createElement("button");x.className="eform_wait_stamp_ok_button";x.innerHTML=h;x.style.left=u+"px";x.style.top=(w+50)+"px";this.m_signBlockScreen.firstChild.appendChild(x);x.onclick=function(){if(k==0){r.callExeSaveSignatureCtrlForm();}else{if(k==1){r.callExeSaveVirtualKeyboardCtrlForm();}else{if(k==2||k==3||k==4){r.callAppSaveCtrlForm(k);}}}};if(k==0){if(null!=n){var g=n.length;x.style.height=((g*50)-10)+"px";var c=0;var a=new Array();var t=new Array();for(var s=0;s<g;s++){var f=n[s];if(f.useStamp){var v=document.createElement("button");v.className="eform_wait_stamp_button";if(f.title==""){v.innerHTML=j+"<br>("+(s+1)+")";}else{v.innerHTML=j+"<br>("+f.title+")";}v.setAttribute("mRe_findIndex",f.id);v.style.left=(u+110)+"px";v.style.top=(w+50)+"px";this.m_signBlockScreen.firstChild.appendChild(v);a.push(v);v.onclick=function(){r.callExeShowStampDlg(this.getAttribute("mRe_findIndex"),true);};if(typeof f.stampDefaultType==="undefined"){f.stampDefaultType=1;}if(f.stampDefaultType!=3){var p=document.createElement("button");p.className="eform_wait_change_stamp_button";if(f.title==""){p.innerHTML=d+"<br>("+(s+1)+")";}else{p.innerHTML=d+"<br>("+f.title+")";}p.setAttribute("mRe_findIndex",f.id);p.style.left=(u+195)+"px";p.style.top=(w+50)+"px";this.m_signBlockScreen.appendChild(p);t.push(p);p.onclick=function(){r.callExeChangeSignatureCtrlForm(this.getAttribute("mRe_findIndex"));};}c++;}var m=document.createElement("button");m.className="eform_wait_stamp_reset_button";if(f.title==""){m.innerHTML=q+"<br>("+(s+1)+")";}else{m.innerHTML=q+"<br>("+f.title+")";}m.setAttribute("mRe_findIndex",f.id);m.style.top=((w+50)+(s*50))+"px";if(g>1){m.style.fontSize="11pt";m.style.height="40px";}else{x.style.height=m.style.height="60px";}this.m_signBlockScreen.firstChild.appendChild(m);m.style.left=(o.offsetLeft+o.offsetWidth-m.offsetWidth)+"px";m.onclick=function(){r.callExeInitSignatureCtrlForm(this.getAttribute("mRe_findIndex"));};}if(a.length>0){if(a.length==1){if(g>1){t[0].style.height=a[0].style.height=((g*50)-10)+"px";}else{t[0].style.height=a[0].style.height="60px";}}else{var l=(g*50)/a.length;for(var s=0;s<a.length;s++){t[0].style.top=a[s].style.top=(420+(s*l))+"px";t[0].style.fontSize=a[s].style.fontSize="11pt";t[0].style.height=a[s].style.height=(l-10)+"px";if((l-10)>55){t[0].style.fontSize=a[s].style.fontSize="14pt";}}}a=null;t=null;}}}else{if(k!=3&&k!=4){var m=document.createElement("button");m.className="eform_wait_stamp_reset_button";m.innerHTML=q;this.m_signBlockScreen.firstChild.appendChild(m);m.style.left=(o.offsetLeft+o.offsetWidth-m.offsetWidth)+"px";m.style.top=(w+50)+"px";m.onclick=function(){if(k==1){r.callExeClearTextVirtualKeyboardCtrlForm();}else{if(k==2){r.callAppClearTextCtrlForm(k);}}};}}}};Report.prototype.callAppSaveCtrlForm=function(b){if(this.multiView.isSocket){var a=this.multiView.socket;if(null!=a){a.sendAppRemoteOK(b);}}};Report.prototype.callAppClearTextCtrlForm=function(b){if(this.multiView.isSocket){var a=this.multiView.socket;if(null!=a){a.sendAppRemoteReset(null,b);}}};Report.prototype.isViewDisabled=function(){var a=this.m_disabledMenu;if(is_exeMirroring){a=false;}return(a||null!=window.m_clipAlert||this.isScreenBlock()||null!=this.m_userProg);};Report.prototype.isScreenBlock=function(){return this.m_signBlockScreen!=null;};Report.prototype.removeAllBlockScreen=function(){if(null!=this.m_signBlockScreenClose){this.m_signBlockScreenClose.click();}else{this.removeSignBlockScreen();}};Report.prototype.removeSignBlockScreen=function(b){if(typeof isNotRuleCmd=="undefined"){b=true;}if(this.m_signBlockScreen!=null){try{document.body.removeChild(this.m_signBlockScreen);if(b){this.mEF_screenBlockRuleCmd(false,this.m_blockScreenType);}this.m_signBlockScreen=null;this.m_signBlockScreenCanvas=null;if(null!=mRe_FocusControl){mRe_FocusControl.objCtrl.multiViewBlur();}}catch(a){this.debugMeg("report log : warning 동시서명 화면에 스크린블럭이 존재하지 않지만 삭제요청이 들어옴 ");}}};Report.prototype.mRe_createBlockScreen=function(c){if(typeof c=="undefined"){c="none";}this.m_blockScreenType=c;this.mRe_removeBlockScreen(false);this.m_signBlockScreen=document.createElement("div");this.m_signBlockScreen.id="mRe_ScreenLockID";this.m_signBlockScreen.addEventListener("contextmenu",function(d){d.preventDefault();},false);this.m_signBlockScreen.style.cssText="position:absolute;left:0px;right:0px;top:0px;bottom:0px;background-color:rgba(192,192,192,0.3);z-index:800;";document.body.appendChild(this.m_signBlockScreen);var a=document.createElement("div");a.style.cssText="position:absolute;overflow:visible;";this.m_signBlockScreen.appendChild(a);this.mRe_reSizeBlockScreen(a);this.mEF_screenBlockRuleCmd(true,c);var b=this;window.addEventListener("resize",function(){b.mRe_reSizeBlockScreen(a);},false);};Report.prototype.mRe_reSizeBlockScreen=function(a){var f=this.targetDiv.offsetWidth;var b=340;var h=382;if(null!=f){if(0==f){var g=this.targetDiv.getAttribute("wo");if(g){f=Number(g);}}if(a.firstChild){if(a.firstChild.offsetWidth>0){h=a.firstChild.offsetWidth;}}b=(f/2)-(h/2);}var c=this.targetDiv.offsetHeight;var d=120;var j=286;if(null!=c){if(0==c){var i=this.targetDiv.getAttribute("ho");if(i){c=Number(i);}}if(a.firstChild){if(a.firstChild.offsetHeight>0){j=a.firstChild.offsetHeight;}}d=(c/3)-(j/3);}a.style.top=d+"px";a.style.left=b+"px";};Report.prototype.mRe_removeBlockScreen=function(b){if(typeof isNotRuleCmd=="undefined"){b=true;}if(this.m_signBlockScreen!=null){try{if(null!=this.m_signBlockScreenClose){this.m_signBlockScreenClose.setAttribute("dEvent","true");this.m_signBlockScreenClose.click();}this.m_signBlockScreenClose=null;document.body.removeChild(this.m_signBlockScreen);if(b){this.mEF_screenBlockRuleCmd(false,this.m_blockScreenType);}this.m_signBlockScreen=null;this.m_signBlockScreenCanvas=null;if(null!=mRe_FocusControl){mRe_FocusControl.objCtrl.multiViewBlur();}}catch(a){this.debugMeg("report log : 스크린블럭이 존재하지 않지만 삭제요청이 들어옴 ");}}};Report.prototype.mRe_closeScroll_guider=function(){var b=document.getElementById("scroll_guider"+this.m_uid);var a=document.getElementById("scroll_guider_selector"+this.m_uid);if(null!=b){b.style.height=b.style.top="0px";b.style.borderWidth="0px";}if(null!=a){a.style.height=a.style.top="0px";a.style.borderWidth="0px";}};Report.prototype.onDisabledEvent=function(a){this.ctrlEvent.disabledEvent=a;};Report.prototype.onInputFocusEvent=function(a){this.ctrlEvent.inputFocusEvent=a;};Report.prototype.onInputChangeEvent=function(a){this.ctrlEvent.inputChangeEvent=a;};Report.prototype.onInputRequiredGuideEvent=function(a){this.ctrlEvent.inputRequiredGuideEvent=a;};Report.prototype.onInputKeyUpEvent=function(a){this.ctrlEvent.inputKeyUpEvent=a;};Report.prototype.onInputBlurEvent=function(a){this.ctrlEvent.inputBlurEvent=a;};Report.prototype.onButtonClickEvent=function(a){this.ctrlEvent.buttonClickEvent=a;};Report.prototype.onCalendarDayClickEvent=function(a){this.ctrlEvent.calendarDayClickEvent=a;};Report.prototype.onCalendarClickEvent=function(a){this.ctrlEvent.calendarClickEvent=a;};Report.prototype.onCheckboxUnCheckedEvent=function(a){this.ctrlEvent.checkboxUnCheckedEvent=a;};Report.prototype.onCheckboxCheckedEvent=function(a){this.ctrlEvent.checkboxCheckedEvent=a;};Report.prototype.onImageClickEvent=function(a){this.ctrlEvent.imageClickEvent=a;};Report.prototype.onRadioboxUnSelectedEvent=function(a){this.ctrlEvent.radioboxUnSelectedEvent=a;};Report.prototype.onRadioboxSelectedEvent=function(a){this.ctrlEvent.radioboxSelectedEvent=a;};Report.prototype.onRadioboxSelectedClickEvent=function(a){this.ctrlEvent.radioboxSelectedClickEvent=a;};Report.prototype.onSelectboxChangeEvent=function(a){this.ctrlEvent.selectboxChangeEvent=a;};Report.prototype.onSignClickEvent=function(a){this.ctrlEvent.signClickEvent=a;};Report.prototype.onSignOkButtonEvent=function(a){this.ctrlEvent.signOkButtonEvent=a;};Report.prototype.onSignCencelButtonEvent=function(a){this.ctrlEvent.signCencelButtonEvent=a;};Report.prototype.onSignNextButtonEvent=function(a){this.ctrlEvent.signNextButtonEvent=a;};Report.prototype.onSignValidationEvent=function(a){this.ctrlEvent.signValidationEvent=a;};Report.prototype.setNetErrorButtonEvent=function(a){this.neterrEvent=a;};Report.prototype.setSignMirroringVisible=function(a){this.m_signMirroringVisible=a;};Report.prototype.setEFormImagePointer=function(b,d,f,a,c){this.m_isImagePointer.visible=b;this.m_isImagePointer.focusOutHidden=d;this.m_isImagePointer.delayHidden=f;this.m_isImagePointer.delayTime=a;if(typeof c!=="undefined"){this.m_isImagePointer.imgPo=c;}};Report.prototype.setEFormImagePointerRect=function(a){this.m_isImagePointer.visibleRect=a;};Report.prototype.setUseSignPopupBGEvent=function(a){this.isUseSignPopupBGEvent=a;};Report.prototype.setEFormDoodlePenBGOpacity=function(a){this.m_doodlePenBGOpacity=a;};Report.prototype.setEFormDoodlePenToggle=function(a){this.m_doodlePenToggleBtn=a;};Report.prototype.setSignWriteAlong=function(b,c,a){if(typeof a!=="undefined"){this.m_isSignWriteAlongByOnlyPen=a;}if(typeof c!=="undefined"){this.m_isSignWriteAlongByFontSize=c;}if(!is_android_mobile&&!is_iphone){this.m_isSignWriteAlong=b;}};Report.prototype.setEFormChatBox=function(a){this.m_chat.isVisible=a;};Report.prototype.mRe_runStamp=function(h,g){if(null!=h){h.jSign.off();}this.m_Stamp={elm_stampDiv:null,tableTD_temp:null,time_out:null,index:3,displayMsg:g,objJson:h};try{var d=document.createElement("div");d.className="eform_zoom_lock";this.m_Stamp.elm_stampDiv=d;var b=document.createElement("table");var c=document.createElement("tr");var f=document.createElement("td");b.style.cssText="position: absolute; width: 100%; height: 100%;";f.style.textAlign="center";f.style.fontSize="5em";b.appendChild(c);c.appendChild(f);d.appendChild(b);document.body.appendChild(d);f.innerHTML=g+"...";this.m_Stamp.elm_stampDiv=d;this.m_Stamp.tableTD_temp=f;var a=this;this.m_Stamp.time_out=window.setTimeout(function(){a.mRe_stamp_ani();},1000);}catch(i){mRe_ReportWebLog(i.stack);}};Report.prototype.mRe_uiStampAppendButton=function(i,a,k){if(null!=this.m_Stamp.tableTD_temp){var d=this.m_Stamp.tableTD_temp.parentElement.parentElement;var b=document.createElement("tr");var g=document.createElement("td");d.appendChild(b);g.style.cssText=" text-align: center;vertical-align: top;";var j=document.createElement("span");j.innerHTML="&nbsp;&nbsp;";var f=document.createElement("button");f.className="eform_sign_button eform_sign_save";f.style.cssText="height:50px;border: 2px black solid;background-color: black;";f.innerHTML="저장";g.appendChild(f);f.onclick=function(){i();};g.appendChild(j);var h=document.createElement("button");h.className="eform_sign_button eform_sign_reset";h.style.cssText="height:50px;border: 2px black solid;background-color: black;";h.innerHTML="초기화";g.appendChild(h);h.onclick=function(){a();};g.appendChild(j.cloneNode(true));var c=document.createElement("button");c.className="eform_sign_button eform_sign_cancel";c.style.cssText="height:50px;";c.innerHTML="취소";g.appendChild(c);c.onclick=function(){k();};b.appendChild(g);}};Report.prototype.mRe_stamp_ani=function(){try{var b="";if(this.m_Stamp.index==3){this.m_Stamp.index=1;b=".";}else{this.m_Stamp.index++;if(this.m_Stamp.index==2){b="..";}else{if(this.m_Stamp.index==3){b="...";}}}this.m_Stamp.tableTD_temp.innerHTML=this.m_Stamp.displayMsg+b;var a=this;this.m_Stamp.time_out=window.setTimeout(function(){a.mRe_stamp_ani();},1000);}catch(c){mRe_ReportWebLog(c.stack);}};Report.prototype.mRe_setStamp=function(a){if(null!=this.m_Stamp){try{window.clearTimeout(this.m_Stamp.time_out);document.body.removeChild(this.m_Stamp.elm_stampDiv);if(null!=this.m_Stamp.objJson){var c=this.m_Stamp.objJson.jSign;if(a.image!=""){c.clear();c.fromDataURL("data:image/png;base64,"+a.image,{ratio:1});this.m_Stamp.objJson.isStampCheck=true;this.m_Stamp.objJson.stampImage=a.image;}else{c.on();this.m_Stamp.objJson.isStampCheck=false;this.m_Stamp.objJson.stampImage=null;}}}catch(b){mRe_ReportWebLog(b.stack);}if(this.multiView.isSocket){if(this.multiView.socket.isMain&&null==a){this.multiView.socket.sendCloseStampProgress(this.m_uid);}}}this.m_Stamp=null;};Report.prototype.mRe_popupSubsection=function(x){if(""!=x.trim()){if(null!=this.m_easyInputPopDiv){try{document.body.removeChild(this.m_easyInputPopDiv);this.m_easyInputPopDiv=null;}catch(z){mRe_ReportWebLog(z.stack);}}var v=function(){};var A=x.split(";");for(var n=0;n<A.length;n++){v[A[n]]=true;}var a=new documentReader();var m=a.readDocumentPage(this.m_saveJsonDocPageList[0],false);var k=this.m_saveReportInfoIndexList[0];var l=new Array();for(var d=0;d<m.subSectionList.length;d++){var c=m.subSectionList[d];c.rName=k;if(v[c.sectionName]){l.push(c);}}m.subSectionList=l;for(var n=1;n<this.m_saveJsonDocPageList.length;n++){k=this.m_saveReportInfoIndexList[n];var p=a.readDocumentPage(this.m_saveJsonDocPageList[n],false);var b=m.imageList.length;for(var w=0;w<p.subSectionList.length;w++){var g=p.subSectionList[w];g.rName=k;g.imagePo=b;if(v[g.sectionName]){m.subSectionList.push(g);}}for(var w=0;w<p.imageList.length;w++){m.imageList.push(p.imageList[w]);}}var o=document.createElement("div");o.className="eform_easyInput_popup_body";var h=document.createElement("div");var u=document.createElement("div");u.className="eform_easyInput_popup_head";u.innerHTML="&nbsp;&nbsp;고객 설명사항";o.appendChild(u);var r=document.createElement("div");r.className="eform_easyInput_popup_bg";document.body.appendChild(r);r.appendChild(o);var q=a.documentReaderFromJSON(this.m_saveJsonDoc,this.servletPath,this.m_uid);q.addPage(m);objCanvas=new mCR_exportCanvas(q,r.offsetWidth/800,function(){});objCanvas.setEasyInput(true);h.setAttribute("aria-hidden","true");elmCanvas=objCanvas.exportPage(0,h);elmCanvas.style.position="relative";console.log("width: >>"+elmCanvas.width);console.log("height: >>"+elmCanvas.height);if(r.offsetWidth>elmCanvas.width+35){var s=(r.offsetWidth-(elmCanvas.width+35))/2;o.style.left=s+"px";o.style.right=s+"px";}else{o.style.left="0px";o.style.right="0px";}h.className="eform_easyInput_popup_canvas";if(is_smartphone){h.style.textAlign="center";}var t=document.createElement("button");t.className="eform_easyInput_popup_button";if((o.offsetHeight>elmCanvas.height+40)){t.style.bottom="0px";}else{t.style.top=(elmCanvas.height)+"px";if(is_exeMirroringSub){t.style.width="auto";t.style.right="40px";h.style.overflow="hidden";o.style.right="45px";var j=document.createElement("button");var f=document.createElement("button");j.className="eform_easyInput_popup_scoll_button";f.className="eform_easyInput_popup_scoll_button";var i=(o.offsetHeight-40)/2;j.style.top="40px";j.style.height=(i-10)+"px";f.style.top=(i+40)+"px";f.style.height=(i-10)+"px";j.innerHTML="△";f.innerHTML="▽";o.appendChild(j);o.appendChild(f);j.onclick=function(){if(h.scrollTop-h.offsetHeight>0){h.scrollTop-=h.scrollTop-h.offsetHeight;}else{h.scrollTop=0;}};f.onclick=function(){h.scrollTop+=h.scrollTop+h.offsetHeight;};}}t.innerHTML="확인";h.appendChild(t);o.appendChild(h);this.m_easyInputPopDiv=r;var y=this;t.onclick=function(){y.mRe_popupSubsectionClose(true);};}};Report.prototype.mRe_popupSubsectionClose=function(b){try{document.body.removeChild(this.m_easyInputPopDiv);this.m_easyInputPopDiv=null;if(null!=this.multiView&&this.multiView.isSocket&&b){this.multiView.socket.sendPopupSubsectionClose(this.m_uid);}}catch(a){mRe_ReportWebLog(a.stack);}};function paintEFormReportText(i){if(0==i.indexOf('"')){i=i.substring(1,i.length-1);}var c=i.split("{clipreport_separator}");var g=objectCall(ClipStrTrim(c[0]));if(typeof g=="string"){g=objectCall(g);}var a=m_reportHashMap[g.uid];a.debugMeg("report log :: eform 리포트 페이지 서버 수신 완료...");try{if(g.status){a.debugMeg("report log :: eform 리포트 페이지 서버 수신 완료 메시지 >>> "+c[0]);if(null!=g.pageWidth){a.m_printPage.pageWidth=g.pageWidth;a.m_printPage.pageHeight=g.pageHeight;}var b=false;if(!a.is_eFormData){var h=objectCall(c[3]);if(typeof h=="string"){h=objectCall(h);}a.eFormCheckImage="data:image/png;base64,"+h.checkImage;a.eFormRadioImage="data:image/png;base64,"+h.radioImage;a.m_dynamicScript(h.dynamicScript);if(null!=a.eFormTempData){a.validationEFormData(h.data);}else{a.eFormData=h.data;if(a.m_isDefaultDoodleVisble&&null!=h.doodleInfo&&(null==a.eFormDoodleOption.pagePathSave||0==a.eFormDoodleOption.pagePathSave.length)){a.eFormDoodleOption.pagePathSave=h.doodleInfo;}}a.appendEFormData();a.defaultControlSet();a.defaultTOCSet(h.toc);if(null!=h.thumbnail){a.m_isThumbnail=h.thumbnail;}h=null;b=true;}a.eformControlReSet();a.debugMeg("report log :: eform 리포트 화면를 SVG로 표현!");a.removeEditableProgress();a.paintDiv.innerHTML=unescape(c[1]);a.defaultEFormSet(g);a.zoomImageView();if(is_smartphone){if(a.m_isSplitView&&!a.m_splitView.isQuick){a.eFormSplitViewZoom();}else{if(b){a.zoomIn(a.zoomCombo);}else{a.eFormZoom(a.eFormDoodleOption.zoomIn,1);}}}else{a.zoomIn(a.zoomCombo);}a.eFormGestureEvent();a.setPaintDivEvent(a.paintDiv,g.uid);a.m_isButtonLock=false;var k=objectCall(c[2]);if(typeof k=="string"){k=objectCall(k);}a.findEFormControls(k);if(a.eFormDoodleOption.is_Ds){a.EFormDoodle();}else{a.EF_setPathPage();}if(a.m_isMemoEnabled){a.EFormMemo(false);}if(null==a.m_drilingTop){if((is_smartphone&&a.m_mobile.scrollTop)||(!is_smartphone&&a.m_pcView.scrollTop)){a.paintDiv.scrollTop=1;}else{if(a.m_scrollEv.isScrollPaging&&a.isWheelPrev){a.isWheelPrev=false;var d=a.paintDiv.scrollHeight-a.paintDiv.clientHeight-50;a.paintDiv.scrollTop=d;}else{a.paintDiv.scrollTop=1;}}}else{a.paintDiv.scrollTop=a.m_drilingTop;a.m_drilingTop=null;}if(!a.is_eFormData){if(null!=a.dynamicScript){window.setTimeout(function(){try{a.dynamicScript();}catch(l){a.resetDynamicScript();a.debugMeg("report log :: 리포트파일에 설정된 동적 속성 스크립에 문제가 있습니다. >> "+l.stack);mRe_ReportEventHandler(31);}},0);}a.is_eFormData=true;}a.focusInputOrder();a.necessaryFocus();a.rulesControlFocus();if(a.m_isEndReport&&a.m_isEndReportEvent){if(a.m_endreportprogress.is_visible){a.m_endreportprogress.is_visible=false;a.removeEndReportProgress();}mRe_ReportEventHandler(200);try{a.m_exeViewEndFunc();}catch(f){mRe_ReportWebLog(f.stack);}if(a.m_isReportEndFunction!=null){window.setTimeout(a.m_isReportEndFunction,0);}a.m_isEndReportEvent=false;a.debugMeg("report log :: eform 리포트 뷰어 종료!");a.endDebugMeg(false);a.createStaticPageMoveButton();a.objSpeechBubbleFrame.createSpeechBubbleArray(a.m_pageCount);a.objSpeechBubbleFrame.setTargetDom(a.targetDiv);a.objSpeechBubbleFrame.setHeaderHeight(a.menuDiv.offsetHeight);}else{if(!a.m_isEndReport){if(a.m_endreportprogress.is_visible){a.createEndReportProgress();}}}a.createSpeechBubbleDiv();a.endDebugMeg(true);if((a.beforePageIndex+1<a.m_pageCount)&&a.m_is_eform_nextPage){a.sendEFormNaxtPageData(a.beforePageIndex+1);}if(!b&&a.m_isEFormPageMoveEvent!=null){window.setTimeout(function(){a.m_isEFormPageMoveEvent();a.removeHybridProgress();},10);}else{a.removeHybridProgress();}}else{a.debugMeg("report log :: eform 리포트 생성중 오류 발생(export) >>> 서버로그 확인 필요!");a.debugMeg("report log :: eform 리포트 페이지 서버 수신 메시지 >>> "+c[0]);var j=a.m_languageMap.report_error;if(g.event==12){a.debugMeg("report log :: EFORM 사용 권한이 없습니다 (라이센스)");if(a.m_isViewer){j=a.m_languageMap.lic_error+".!! (errorCode : LE0"+g.event+")";mRe_ReportEventHandler(12);}}else{mRe_ReportEventHandler(30);if(g.event==60){j=a.m_languageMap.sesstion_error;mRe_ReportEventHandler(60);a.debugMeg("report log :: eform 리포트서버와의 세션 종료!");}}j=j.replace(/\<|\>|\"|\'|\%|\;|\(|\)|\&|\+|\-/g,"");a.paintDiv.innerHTML=j;a.m_isButtonLock=false;}}catch(f){a.debugMeg("report log :: 서버에서 내려온 결과 메시지 >>> "+i);a.debugMeg("report log :: 서버에서 내려온 메시지 오류 >>> "+f.stack);a.paintDiv.innerHTML=a.m_languageMap.report_error;mRe_ReportEventHandler(30);a.m_isButtonLock=false;}if(a.m_pageMoveEvent.end!=null){a.m_pageMoveEvent.end();}}function eFormResultText(b,d){var a=objectCall(b);if(typeof a=="string"){a=objectCall(a);}if(null!=a){var c=m_reportHashMap[a.uid];if(null!=c){if(a.status){c.debugMeg("report log :: 저장 성공!");if("save"==d&&c.m_buttonEvent.endSaveButton!=null){c.m_buttonEvent.endSaveButton();}}else{c.debugMeg("report log :: 서버에서 저장중 오류 발생 서버 로그 확인 필요!");}}}mRe_ReportEventHandler(a.event);}Report.prototype.mRe_inputFocusRectBlur=function(){if(this.is_eForm){var b=this.m_bodyDiv.querySelectorAll(".eform_control_focus");if(b){for(var a=0;a<b.length;a++){b[a].classList.remove("eform_control_focus");}}}};function eFormFocusControl(a){a.className+=" eform_control_focus";}function eFormBlurControl(a){var b=a.className;b=b.replace("eform_control_focus","");a.className=b;}function setPath(a,b){a.setAttributeNS(null,"d",b.join(""));}function findPrevControl(c,a){var b=null;for(;a>1;a--){b=c[a];if(!b.controlData.disable&&b.controlData.visible){return false;}}return true;}function findNextControl(c,a){var b=null;a++;for(;a<c.length;a++){b=c[a];if(!b.controlData.disable&&b.controlData.visible){return false;}}return true;}Report.prototype.m_exeViewEndFunc=function(){if(this.is_eForm){var c=this;if(is_exeMirroring){if(c.m_exeOption.isMirroringInternalEvent){if(this.multiView.socket){if(this.multiView.socket.isMain){try{var b=c.getReportKey();var a=c.getTotalPageCount();exeMirroringReportWebLog("미러링시 메인에서 사용되는 이벤트 등록을 시작합니다.="+b);MainWebBrowserCtrl_InitializeEvent(c);var f={};f.uid=b;f.totalPage=a;f.result=c.m_reportKey;f.isMobile=c.m_exeOption.isMobile;f.wsPath=c.multiView.socket.wsPath;f.isMobile=c.multiView.socket.wsPath!=="localhost";f.isTab=c.m_exeOption.isTab;if(f.isTab){f.parentTabName=c.parentTab.name;f.tabName=c.parentTab.name;f.isTabAppendSelect=c.parentTab.parentPlugin.isAppendSelect;}if("MainWebBrowserCtrl_EFormGenerationCompletedEx" in window.external){ReportWebLog("exeMirroring 메인 이폼이 완료 되었습니다.");window.external.MainWebBrowserCtrl_EFormGenerationCompletedEx(JSON.stringify(f));}exeMirroringReportWebLog("미러링시 메인에서 사용되는 이벤트 등록을 완료 하였습니다.");}catch(d){exeMirroringReportWebLog(d.stack);}}else{try{var b=c.getReportKey();var a=c.getTotalPageCount();exeMirroringReportWebLog("미러링시 서브에서 사용되는 이벤트 등록을 시작합니다.="+b);SubWebBrowserCtrl_InitializeEvent(c);var f={uid:b,totalPage:a,result:c.m_reportKey,isMobile:c.m_exeOption.isMobile,isTab:c.m_exeOption.isTab};f.wsPath=c.multiView.socket.wsPath;f.isMobile=c.multiView.socket.wsPath!=="localhost";if(f.isTab){if(typeof c.parentTab!=="undefined"){if(typeof c.parentTab.name!=="undefined"){f.parentTabName=c.parentTab.name;}if(typeof c.parentTab.parentPlugin!=="undefined"){f.isTabAppendSelect=c.parentTab.parentPlugin.isAppendSelect;}}}if(f.isMobile){if(window&&window.external&&"SubWebBrowserCtrl_InitializeTablet" in window.external){window.external.SubWebBrowserCtrl_InitializeTablet();}}if("SubWebBrowserCtrl_EFormGenerationCompletedEx" in window.external){window.external.SubWebBrowserCtrl_EFormGenerationCompletedEx(JSON.stringify(f));exeMirroringReportWebLog("서브 이폼이 완료 되었습니다.");}exeMirroringReportWebLog("미러링시 서브에서 사용되는 이벤트 등록을 완료 하였습니다.");}catch(d){exeMirroringReportWebLog(d.stack);}}}else{try{var b=c.getReportKey();var a=c.getTotalPageCount();exeMirroringReportWebLog("미러링시 메인에서 사용되는 이벤트 등록을 시작합니다.="+b);MainWebBrowserCtrl_InitializeEvent(c);var f={};f.uid=b;f.totalPage=a;f.result=c.m_reportKey;f.isMobile=false;f.wsPath="localhost";f.isTab=c.m_exeOption.isTab;if(f.isTab){f.parentTabName=c.parentTab.name;f.tabName=c.parentTab.name;f.isTabAppendSelect=c.parentTab.parentPlugin.isAppendSelect;}if("MainWebBrowserCtrl_EFormGenerationCompletedEx" in window.external){ReportWebLog("exeMirroring 메인 이폼이 완료 되었습니다.");window.external.MainWebBrowserCtrl_EFormGenerationCompletedEx(JSON.stringify(f));}exeMirroringReportWebLog("미러링시 메인에서 사용되는 이벤트 등록을 완료 하였습니다.");}catch(d){exeMirroringReportWebLog(d.stack);}}}}else{if(is_appControl){}}}};function getElementOffsetTop(a){var b=0;while(a){b+=a.offsetTop;a=a.offsetParent;}return b;}function getElementOffsetLeft(a){var b=0;while(a){b+=a.offsetLeft;a=a.offsetParent;}return b;}function mRe_reSetPopupStatus(){Re_zoom.isPop=false;window.is_clipSignPlugin=false;window.mRe_multiSign_ok=null;window.mRe_popupInput_close=null;window.mRe_multiSign_close=null;window.mRe_multiSign_reset=null;window.mRe_signaturePad=null;}function createTitleSpeechBubble(g){var a=document.createElement("div");a.style.position="absolute";a.style.left=g.left+"px";a.style.top=g.top+"px";a.style.width=g.width+"px";a.style.height=g.height+"px";a.id="titleSpeechBubble001";g.targetElm.appendChild(a);var i=document.createElementNS("http://www.w3.org/2000/svg","svg");i.setAttribute("width",g.width);i.setAttribute("height",g.height);a.appendChild(i);var n=document.createElementNS("http://www.w3.org/2000/svg","path");n.setAttribute("fill",g.bgColor);var m=new Array();var k=g.width;var h=g.height;var b=g.arrowAlign=="left"?((g.width/4)<40?40:60):(g.arrowAlign=="center"?(g.width/2):((g.width/4)*3.7));var c=10;if(b>(g.width-20)){b=g.width-20;}var d=g.textMargin;if(g.arrowVAlign=="top"){m.push("M0 20 Q0 0, 20 0 ");m.push("L20 0, "+(k-20)+" 0 Q"+k+" 0, "+k+" 20 L"+k+" 20, "+k+" "+(h-30)+" ");m.push("Q"+k+" "+(h-10)+", "+(k-20)+" "+(h-10)+" ");m.push("L"+(h-10)+" "+(h-10)+", ");m.push(b+" "+(h-10)+", "+(b-c)+" "+(h)+", "+(b-(c*2))+" "+(h-10)+", 20 "+(h-10)+" ");m.push("Q0 "+(h-10)+", 0 "+(h-30)+" Z");}else{d=d+10;m.push("M0 30 Q0 10, 20 10 L20 10, ");m.push((b-(c*2))+" 10, "+(b-c)+" 0, "+(b)+" 10, "+(k-20)+" 10 ");m.push("Q"+k+" 10, "+k+" 30 L"+k+" 30, "+k+" "+(h-20)+" ");m.push("Q"+k+" "+h+", "+(k-20)+" "+h+" L"+(k-20)+" "+h+", 20 "+h+" ");m.push("Q0 "+h+", 0 "+(h-20)+" Z");}n.setAttribute("d",m.join(""));i.appendChild(n);var j=document.createElement("div");j.style.cssText="position: absolute; left:"+g.textMargin+"px; right: "+g.textMargin+"px; top:"+d+"px; overflow: visible";j.style.fontSize=g.fontSize+"px";j.style.fontWeight="bold";j.style.color=g.color;j.style.textAlign=g.textAlign;j.innerText=g.text;a.appendChild(j);var l=g.height-(g.textMargin*2)-10;var o=g.fontSize;var f=j.offsetHeight;while(l<f){o-=1;j.style.fontSize=o+"px";f=j.offsetHeight;}return a.id;}function removeTitleSpeechBubble(a){var b=document.getElementById(a);if(null!=b){b.parentElement.removeChild(b);}}function mEM_throttle(c,a){var b=0;return function(){var d=new Date().getTime();if(d-b<a){return;}b=d;c.apply(null,arguments);};}function mEM_debounce(c,a){var b;return function(){var f=this;var d=arguments;clearTimeout(b);b=setTimeout(function(){c.apply(f,d);},a);};}Report.prototype.getProperty=function(a){return this.m_properties[a];};Report.prototype.setProperty=function(a,b){this.m_properties[a]=b;};Report.prototype.newGroup=function(){var a=new EFormGroup();a.init("",this);return a;};Report.prototype.findControl=function(a){var c=this.findGroup(a);if(null!=c){var b=c.getControlList();if(null!=b&&b.length>0){c=b[0];}}return c;};Report.prototype.findControlByID=function(a){var b=null;if(null!=this.eFormControlList){b=this.eFormControlList[a];}return b;};Report.prototype.findGroup=function(a){if(null!=this.eFormControlGroupList){var b=this.eFormControlGroupList[a];if(null==b){b=new EFormGroup();b.init("",this);}return b;}else{return null;}};Report.prototype.findGroupByName=function(b){var c=new EFormGroup();c.init(b,this);for(var a in this.eFormData){if(-1!=this.eFormData[a].id.indexOf(b)){c.appendControl(this.eFormControlList[a]);}}return c;};Report.prototype.findGroupByControlType=function(d){var c=new EFormGroup();c.init("",this);for(var b in this.eFormData){var a=this.eFormData[b];if(d==a.type){c.appendControl(this.eFormControlList[b]);}}return c;};Report.prototype.findCloneControl=function(f){var c=new Array();for(var b in this.eFormData){var a=this.eFormData[b];var d=this.eFormControlList[b];if(f!=d&&f.controlData.repeatSyncName==a.repeatSyncName){c.push(d);}}return c;};Report.prototype.findGroupByNameAndControlType=function(c,f){var d=new EFormGroup();d.init(c,this);for(var b in this.eFormData){var a=this.eFormData[b];if(f==a.type&&-1!=a.id.indexOf(c)){d.appendControl(this.eFormControlList[b]);}}return d;};function EFormGroup(){this.parent=null;this.groupID=null;this.controlList=null;}EFormGroup.prototype.init=function(a,b){this.parent=b;this.groupID=a;this.controlList=new Array();};EFormGroup.prototype.deleteMe=function(){this.parent=null;this.groupID=null;this.controlList=null;};EFormGroup.prototype.appendControl=function(a){this.controlList.push(a);};EFormGroup.prototype.appendGroup=function(a){if(null!=a.controlList){this.controlList.push.apply(this.controlList,a.controlList);}};EFormGroup.prototype.getGroupId=function(){return this.groupID;};EFormGroup.prototype.setVisible=function(a,f){var c=this.controlList.length;for(var b=0;b<c;b++){var d=this.controlList[b];d.setVisible(a,f);}};EFormGroup.prototype.setDisabled=function(d,g,c){var b=this.controlList.length;for(var a=0;a<b;a++){var f=this.controlList[a];f.setDisabled(d,g,c);}};EFormGroup.prototype.setGuideBGColor=function(c,b,h,d){var f=this.controlList.length;for(var a=0;a<f;a++){var g=this.controlList[a];g.setGuideBGColor(c,b,h,d);}};EFormGroup.prototype.getControlList=function(){return this.controlList;};EFormGroup.prototype.getValueOfControl=function(c){var b=this.controlList.length;for(var a=0;a<b;a++){var d=this.controlList[a];if(d.getValue()==c){return d;}}return null;};EFormGroup.prototype.check=function(c){if(typeof c=="undefined"){c=true;}var b=this.controlList.length;for(var a=0;a<b;a++){var d=this.controlList[a];if("checkbox"==d.getType()){d.check(c);}}};EFormGroup.prototype.unCheck=function(c){if(typeof c=="undefined"){c=true;}var b=this.controlList.length;for(var a=0;a<b;a++){var d=this.controlList[a];if("checkbox"==d.getType()){d.unCheck(c);}}};EFormGroup.prototype.unSelect=function(b,a){this.un_Default_Select(b,a);if(null!=this.parent){if(this.parent.multiView.isSocket){this.parent.multiView.socket.sendUnSelectGroup(this,b,a);}}};EFormGroup.prototype.un_Default_Select=function(d,a){if(typeof a=="undefined"){a=null;}if(typeof d=="undefined"){d=true;}var c=this.controlList.length;for(var b=0;b<c;b++){var f=this.controlList[b];if(null!=a&&f.controlData.rName!=a){continue;}if("radiobox"==f.getType()){f.controlData.checked="false";if("true"==f.controlData.isNecessaryCheck){f.controlData.is_nc=true;}if(f.isDOM){f.checkElement.checked=false;f.checkElement_img.src="data:image/png;base64,"+mRe_blankImg;if(null!=f.unCheckBorderStyle){f.checkElement_img.style.border=f.unCheckBorderStyle;}}f.eform.eFormRadioChecked[f.controlData.id+f.controlData.rName]=null;f.setDisabled(f.controlData.disable,false,d);f.onUnSelected(d);}}};EFormGroup.prototype.getRadioValue=function(){var b="";var c=this.controlList.length;for(var a=0;a<c;a++){var d=this.controlList[a];if("radiobox"==d.getType()){if("true"==d.controlData.checked){if(""!=b){b+=" ";}b+=d.controlData.value;}}}return b;};window.mRe_FocusInputStatus=false;if(is_ie){if(window.addEventListener){window.addEventListener("blur",function(){if(null!=window.mRe_targetFocusInput){document.body.focus();window.mRe_targetFocusInput=null;}});}}function EFormInput(){this.eform=null;this.ctrlID=null;this.controlData=null;this.group=null;this.isDOM=false;this.inputElement=null;this.inputElement_div=null;this.inputElement_td=null;this.inputElement_GT=null;this.inputElement_td_GT=null;this.event={focusEvent:null,blurEvent:null,keyUpEvent:null,requiredGuideEvent:null,changeEvent:null,eventTarget:null};this.title=null;this.isScroll=false;this.is_mousedown=false;this.callKeyboardButton=null;this.isCallKeyboardConnect=false;this.bgColor=null;this.isInputFocus=false;this.disabledClass="";}EFormInput.prototype.setGroup=function(a){this.group=a;};EFormInput.prototype.init=function(b,a,c){this.eform=c;this.ctrlID=b;this.controlData=a;this.controlData.necessaryMessage=a.necessaryMessage.replace(/\\\//g,"/").replace(/\\\\/g,"\\").replace(/\\\"/g,'"');this.controlData.value=a.value.replace(/\\\//g,"/").replace(/\\\\/g,"\\").replace(/\\\"/g,'"').replace(/\\t/g,"    ");this.controlData.value=unescape(a.value.replace(/\\u/g,"%u"));if(null!=this.controlData.guideText){this.controlData.guideText=a.guideText.replace(/\\\//g,"/").replace(/\\\\/g,"\\").replace(/\\\"/g,'"').replace(/\\t/g,"    ");this.controlData.guideText=unescape(a.guideText.replace(/\\u/g,"%u"));}if(null!=a.inputOrder){this.eform.eFormIndexControlList[a.inputOrder]=this;}if(null==a.maxLength){this.controlData.maxLength=0;}if(null==a.indexOrderDisable){a.indexOrderDisable=false;}if(null==a.isNumber){a.isNumber=false;}if(null==a.isNoWrap){a.isNoWrap=false;}if(null==a.isGuideText){a.isGuideText=false;}if(null==a.isToView){a.isToView=true;}if(null==a.isToEasyMode){a.isToEasyMode=true;}if(c.isEasyInput&&a.isToEasyMode){a.isToView=true;}if(!a.isToView){a.is_nc=false;}if(null==a.isFollowText){a.isFollowText=true;}if(null!=a.title){this.controlData.title=a.title.replace(/\\\//g,"/").replace(/\\\\/g,"\\").replace(/\\\"/g,'"');this.title=this.controlData.title;}if(null==a.formatUserType){a.formatUserType=0;}if(null==a.format){this.controlData.format="";this.controlData.formatData=this.controlData.value;}else{a.format=a.format.replace(/\\\//g,"/").replace(/\\\\/g,"\\").replace(/\\\"/g,'"');var d=a.format;if(a.formatUserType!==0){d=a.format.replace(/\*/g,"9");}this.controlData.formatData=this.controlData.value.formatting(d);}if(null==a.autoSizeFont){this.controlData.autoSizeFont=false;}if(null==a.isKeyType){a.isKeyType=0;}if(null==a.isAutoNextFocus){a.isAutoNextFocus=true;}if(null==a.repeatSync){a.repeatSync=false;}if(null==a.isGuideTextType){a.isGuideTextType=0;}if(null==a.wordSpace){a.wordSpace=0;}if(null==a.lineSpace){a.lineSpace=0;}if(a.isNumber&&null!=this.eform.mustInputNumberPadMaxLength&&a.maxLength==0){a.maxLength=this.eform.mustInputNumberPadMaxLength;}if(null==a.subOnlyEdit){a.subOnlyEdit=false;}if(null==a.zeroValueKBD){a.zeroValueKBD=false;}if(null==a.sName){a.sName="";}};EFormInput.prototype.deleteMe=function(){this.eform=null;this.ctrlID=null;this.controlData=null;this.event=null;this.group=null;this.deleteDOM();};EFormInput.prototype.resetDOM=function(){this.isDOM=false;this.inputElement=null;this.inputElement_div=null;this.inputElement_td=null;this.inputElement_GT=null;this.inputElement_td_GT=null;};EFormInput.prototype.deleteDOM=function(){if(this.inputElement){if(this.inputElement.parentElement){this.inputElement.parentElement.removeChild(this.inputElement);}else{delete this.inputElement;}}if(this.inputElement_div){if(this.inputElement_div.parentElement){this.inputElement_div.parentElement.removeChild(this.inputElement_div);}else{delete this.inputElement_div;}}if(this.inputElement_td){if(this.inputElement_td.parentElement){this.inputElement_td.parentElement.removeChild(this.inputElement_td);}else{delete this.inputElement_td;}}if(this.inputElement_GT){if(this.inputElement_GT.parentElement){this.inputElement_GT.parentElement.removeChild(this.inputElement_GT);}else{delete this.inputElement_GT;}}if(this.inputElement_td_GT){if(this.inputElement_td_GT.parentElement){this.inputElement_td_GT.parentElement.removeChild(this.inputElement_td_GT);}else{delete this.inputElement_td_GT;}}this.resetDOM();};EFormInput.prototype.getRect=function(){if(this.isDOM){var b={left:0,top:0,width:0,height:0};var d=this.inputElement;var c=d.parentElement.offsetLeft;var a=d.parentElement.offsetTop;b.left=c+d.offsetLeft;b.top=a+d.offsetTop;b.width=d.offsetWidth;b.height=d.offsetHeight;return b;}return null;};EFormInput.prototype.getHE=function(){if(this.isDOM){return this.inputElement;}return null;};EFormInput.prototype.eventHandlerInput=function(){if(!this.controlData.isToView){return;}if(typeof this.controlData.pageNumber=="undefined"){this.controlData.pageNumber=this.eform.beforePageIndex;}this.isDOM=true;this.inputElement=document.getElementById(this.eform.m_uid+this.ctrlID);this.inputElement_div=document.getElementById(this.eform.m_uid+this.ctrlID+"SPAN");this.inputElement_td=document.getElementById(this.eform.m_uid+this.ctrlID+"TD");if(this.eform.m_RuleCtrlVisible){if(null!=this.inputElement_div){var m=this.inputElement_div.parentElement;if(null!=m){var b=document.createElement("div");b.style.position="absolute";b.style.left=m.style.left;b.style.top=m.style.top;b.style.width=m.style.width;b.style.height=m.style.height;b.style.color="red";b.style.fontSize="8pt";b.style.fontWeight="bold";var p=this.ctrlID;if(-1!=p.indexOf(".")){p=p.substring(p.indexOf(".")+1);}p=decodeURI(p.replace(/[r]/g,"%"));p=p.substring(0,p.lastIndexOf("_"));b.innerHTML=p+" ("+this.controlData.id+")";var n=m.parentElement;var t=m.nextSibling;if(null!=t){n.insertBefore(b,t);}else{n.appendChild(b);}}}}if(this.controlData.isGuideText){this.inputElement_GT=document.getElementById(this.eform.m_uid+this.ctrlID+"GT");this.inputElement_GT.value="";if(this.controlData.isGuideTextType==0||this.controlData.isGuideTextType==1){this.inputElement_GT.value=this.controlData.guideText;}else{if(this.controlData.isGuideTextType==3){this.inputElement.placeholder=this.controlData.guideText;}}if(this.controlData.isGuideTextType==1||this.controlData.isGuideTextType==3||this.controlData.isGuideTextType==4){var r=document.getElementById(this.eform.m_uid+this.ctrlID+"TD_GT");if(null==r){var d=this.inputElement_td;while(true){d=d.parentElement;if(d.tagName=="TABLE"||d==null){break;}}if(null!=d){var h=d.cloneNode(true);var l=h;while(true){l=l.firstChild;if(l.tagName=="TD"||l==null){break;}}this.inputElement_td_GT=l;this.inputElement_td_GT.id=this.eform.m_uid+this.ctrlID+"TD_GT";d.parentElement.insertBefore(h,d);var u=getComputedStyle(this.inputElement_GT);this.inputElement_td_GT.style.fontFamily=u.fontFamily;var k=this.inputElement_td_GT.style.fontSize;if(null==k||""==k){this.inputElement_td_GT.style.fontSize=u.fontSize;}this.inputElement_td_GT.style.color=u.color;var g=this.controlData.guideText;this.mRe_setGuideDisplayValue(g);}}else{this.inputElement_td_GT=r;var g=this.controlData.guideText;this.mRe_setGuideDisplayValue(g);}}}if(null==this.title){this.title=this.inputElement.title;}else{this.inputElement.title=this.title;}var f=this;var c=this.controlData;this.inputElement.oninput=function(){if(c.maxLength>0){this.value=this.value.slice(0,c.maxLength);}if(!is_smartphone){f.onKeyUp(this);}};this.inputElement.onkeyup=function(){if(c.maxLength>0){this.value=this.value.slice(0,c.maxLength);}if(is_smartphone){f.onKeyUp(this);}};if(this.controlData.isNumber){if(!is_appControl&&!is_exeMirroringSub){if(is_smartphone){var j=this.inputElement.parentElement;var i=document.createElement("input");i.type="number";i.step="0.01";i.id=this.inputElement.id;i.title=this.inputElement.title;i.className=this.inputElement.className;i.tabIndex=this.inputElement.tabIndex;i.style.cssText=this.inputElement.style.cssText;i.placeholder=this.inputElement.placeholder;j.insertBefore(i,this.inputElement);j.removeChild(this.inputElement);this.inputElement=i;}if(this.controlData.isKeyType!=1&&this.controlData.isKeyType!=5){this.inputElement.oninput=function(y){var z=this.value;if(!(is_smartphone&&(y.data=="."||y.data=="-"||y.inputType=="deleteContentBackward"))){if(z!="-"||f.controlData.isKeyType==4){var C=parseFloat(z);if(isNaN(C)){this.value="";}else{if(z=="00"&&f.controlData.isKeyType!=0){this.value="0";}else{if(z=="-00"&&f.controlData.isKeyType!=0){this.value="-0";}else{if(z.length==2&&z.charAt(1)!="."&&z.charAt(0)!="-"&&C<10&&f.controlData.isKeyType!=0){this.value=C+"";}else{if(z.length==3&&z.charAt(0)=="-"&&z.charAt(2)!="."&&C<0&&f.controlData.isKeyType!=0){this.value=C+"";}else{var w="";if(z.charAt(0)=="-"){w="-";}var B=z.indexOf(".");if(-1==B){z=z.replace(/[^0-9]/g,"");}else{var x=z.substring(0,B);var A=z.substring(B+1);x=x.replace(/[^0-9]/g,"");A=A.replace(/[^0-9]/g,"");if(A==""){z=x+".";}else{z=x+"."+A;}}this.value=w+z;}}}}}}else{this.value=z;}var v=this.maxLength;if(null!=v&&v>0){if(this.value.length>v){this.value=this.value.slice(0,v);}}if(!is_smartphone){f.onKeyUp(this);}}};}}}if((this.controlData.isKeyType==1&&this.eform.m_isEngKeyOnly)||this.controlData.isKeyType==3||this.controlData.isKeyType==5||this.controlData.isKeyType==6){this.inputElement.oninput=function(w){var x=this.value;if(f.controlData.isKeyType==1){x=x.replace(/[^a-zA-Z0-9\-\_\s\.\@\,]/g,"");}else{if(f.controlData.isKeyType==3){if(x.length==1&&x=="0"){x="";}else{x=x.replace(/[^0-9]/g,"");}}else{if(f.controlData.isKeyType==6){x=x.replace(/[^0-9]/g,"");}else{x=x.replace(/[^0-9\-\.]/g,"");}}}this.value=x;var v=this.maxLength;if(null!=v&&v>0){if(this.value.length>v){this.value=this.value.slice(0,v);}}if(!is_smartphone){f.onKeyUp(this);}};}this.inputElement.value=this.controlData.value.replace(/(\\r\\n)|(\\n)/g,String.fromCharCode(13));if(0<this.controlData.maxLength){this.inputElement.maxLength=this.controlData.maxLength;}else{this.inputElement.maxLength=524288;}var s=this.controlData.value;this.controlData.formatData=s;if(""!=this.controlData.format){this.controlData.formatData=s.formatting(this.controlData.format);s=this.controlData.formatData;var a=this.controlData.format;if(this.controlData.formatUserType==2){var o="@";if(-1!=this.controlData.format.indexOf("9")){o="9";}a=this.controlData.format.replace(/\*|\?/g,o);this.controlData.formatData=this.controlData.value.formatting(a);}else{if(this.controlData.formatUserType==1){var o="@";if(-1!=this.controlData.format.indexOf("9")){o="9";}a=this.controlData.format.replace(/\*|\?/g,o);this.controlData.formatData=this.controlData.value.formatting(a);if(!((this.eform.multiView.isSocket&&this.eform.isMain)||!this.eform.multiView.isSocket)){s=this.controlData.formatData;}}}}if(this.eform.multiView.isSocket&&this.eform.isMain&&this.controlData.subOnlyEdit){this.inputElement.className=this.inputElement.className.replace("mRe_focus","");}if(""!=ClipStrTrim(s)||(""!=this.controlData.formatData&&-1!=this.controlData.format.indexOf("?"))){this.controlData.is_nc=false;if(this.controlData.isGuideTextType==3||this.controlData.isGuideTextType==4){this.inputElement_td_GT.innerHTML="";}}else{var q="";if(this.controlData.isNecessaryCheck=="true"){this.controlData.is_nc=true;q=" eForm_inputNecessary";}if(this.controlData.disable){this.inputElement_div.className="eF_Rect eForm_inputDisabled "+this.disabledClass;}else{if(this.eform.eForm_isNecessary.check&&this.controlData.is_nc){this.inputElement_div.className="eF_Rect eForm_NecessaryCheck";}else{this.inputElement_div.className="eF_Rect eForm_inputDefault_bg"+q;}}}if(this.controlData.autoSizeFont){s=s.replace(/(\\r\\n)|(\\n)/g,"\n");mRe_autoSizeTextDraw(this.inputElement_td,s,true,this.controlData.lineSpace,this.controlData.wordSpace,this.inputElement,this.controlData.fontSize);}else{if(this.eform.m_isObjJSONSVG&&!this.eform.m_isAccessibility){s=s.replace(/(\\r\\n)|(\\n)/g,"\n");mRe_autoSizeTextDraw(this.inputElement_td,s,false,this.controlData.lineSpace,this.controlData.wordSpace,this.inputElement,this.controlData.fontSize);}else{if(typeof this.inputElement_td.innerText!=="undefined"){s=s.replace(/(\\r\\n)|(\\n)/g,String.fromCharCode(13));s=s.split(" ").join("\u00A0");this.inputElement_td.innerText=s;}else{this.inputElement_td.innerHTML=s.replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/\n/g,"<br />\n");}}}this.inputElement.onblur=function(){f.blurControl(this);f.onBlur();if(f.eform.multiView.isSocket){f.eform.multiView.socket.sendFocusControl(f,"out");}};this.inputElement.onfocus=function(){f.onFocus();f.focusControl();if(f.eform.multiView.isSocket){f.eform.multiView.socket.sendFocusControl(f,"in");}};this.inputElement.onmousedown=function(v){var w=false;if("which" in v){w=v.which==3;}else{if("button" in v){w=v.button==2;}}if(w){v.preventDefault();return;}if(f.eform.mRe_MainNecessaryInputEnabledCheckControl(f)){this.readOnly=false;}else{this.readOnly=true;window.setTimeout(function(){f.eform.multiView.socket.sendHybridInputCallKeyboard(f);},window.mRe_exeCallInterval);}};if(this.eform.isMain&&this.eform.isDBLClickSubCallKeyboard){this.inputElement.ondblclick=function(v){setTimeout(function(){f.inputElement.blur();f.subCallKeyboard();},300);};}if(is_appControl||is_exeControl||this.eform.m_isUsePopupInputFrame.input){if(!is_exeControl){this.inputElement.readOnly=true;}this.inputElement.onmousedown=function(v){var w=false;if("which" in v){w=v.which==3;}else{if("button" in v){w=v.button==2;}}if(w){v.preventDefault();return;}f.is_mousedown=true;window.setTimeout(function(){if(f.eform.m_isUsePopupInputFrame.input){f.callFrameInput();}else{f.callHybridInput();}},window.mRe_exeCallInterval);};}if(this.controlData.subOnlyEdit){if(is_exeMirroringSub){this.inputElement.readOnly=true;}if(this.eform.multiView.isSocket&&this.eform.isMain){this.inputElement.readOnly=true;this.inputElement.onmousedown=function(v){var w=false;if("which" in v){w=v.which==3;}else{if("button" in v){w=v.button==2;}}if(w){v.preventDefault();return;}f.is_mousedown=true;window.setTimeout(function(){f.eform.multiView.socket.sendHybridInputCallKeyboard(f);},window.mRe_exeCallInterval);};}}this.checkKeyEvent();this.setIsScroll(this.isScroll);this.m_setBGColor();this.setDisabled(this.controlData.disable,false);this.setVisible(this.controlData.visible,false);};EFormInput.prototype.bulrHybridInput=function(){this.blurControl(this.inputElement);this.onBlur();if(this.eform.multiView.isSocket){this.eform.multiView.socket.sendFocusControl(this,"out");}};EFormInput.prototype.callHybridInput=function(){if(!is_appControl&&!is_exeControl){return;}this.eform.inputOrderFoucs(this);if(this.controlData.isGuideText){this.inputElement_GT.style.opacity=0;}this.inputElement.blur();var i=this;var c=null;if(this.eform.multiView.isSocket){c=i.eform.multiView.socket;c.sendScreenLock("key",i.eform.m_uid);}var b;try{b=window.top;}catch(d){console.error("최상위 window 객체에 접근할 수 없습니다:",d);b=window;}b.set_report_input_data_ex=function(k,j){if((i.controlData.isKeyType==0&&i.controlData.isNumber)||(i.controlData.isKeyType==2&&!i.eform.m_UseWonFormat)){if(typeof j==="string"){j=mRe_NumberFormat(j);}}if("set"===k){i.setValue(j);}else{if("cencel"===k||"cancel"===k){i.setValue(j);}}};b.set_report_input_data=function(l,k){if((i.controlData.isKeyType==0&&i.controlData.isNumber)||(i.controlData.isKeyType==2&&!i.eform.m_UseWonFormat)){if(typeof k==="string"){k=mRe_NumberFormat(k);}}if("next"==l){ReportWebLog("set_report_input_data next "+k);i.setValue(k);if(i.eform.multiView.isSocket){i.eform.multiView.socket.sendFocusControl(i,"out");}i.bulrHybridInput();if(i.controlData.isAutoNextFocus){var j=i.eform.nextHybridInputControl(i);if(!j){i.eform.nextEasyInputControl(i);}}}else{if("cencel"==l||"cancel"==l){i.bulrHybridInput();}else{if("ok"==l){i.setValue(k);if(i.eform.multiView.isSocket){i.eform.multiView.socket.sendFocusControl(i,"out");}i.bulrHybridInput();}}}if(null!=c){c.sendScreenUnLock(i.eform.m_uid);}};var g=new Object();g.id=this.inputElement.id;g.key=this.controlData.id;g.rName=this.controlData.rName;g.title=this.getTitle();g.isMirroring=!this.eform.getIsMain();g.guideMsg="";if(this.controlData.isGuideText){if(this.isDOM){g.guideMsg=this.inputElement_GT.value;}}if(this.controlData.isKeyType==0){g.type=this.controlData.isNumber?"number":"text";}else{if(this.controlData.isKeyType==1){g.type="eng";}else{if(this.controlData.isKeyType==2){g.type="money2";}else{if(this.controlData.isKeyType==3){g.type="money";}else{if(this.controlData.isKeyType==4){g.type="numberPositive";}else{if(this.controlData.isKeyType==5){g.type="number";}else{if(this.controlData.isKeyType==6){g.type="numberOnlyStr";}}}}}}}g.maxLength=this.controlData.maxLength;g.text=this.inputElement.value;if(g.type=="money"){g.text=g.text.formatting("#,###");}if(g.type=="number"){if(this.controlData.isKeyType!=5){g.text=mRe_NumberFormat(g.text);}if((this.eform.m_zeroValueKBD||this.controlData.zeroValueKBD)&&this.controlData.isKeyType==0){if(g.text=="0"){g.text="";}}}else{if(g.type=="numberOnlyStr"){g.text=g.text.replace(/[^0-9]/g,"");}}g.format=this.controlData.format;g.isSetRealTimeKeyPressed=this.eform.m_exeOption.isVirtualKeyboardKeyPressedSetInputText;if(null!=this.eform.m_exeOption.decimalPointLength){g.decimalPointLength=this.eform.m_exeOption.decimalPointLength;}else{g.decimalPointLength=0;}if(is_exeMirroring||is_appControl){if(this.eform.multiView.isSocket){var a=this.eform;c=this.eform.multiView.socket;var h=is_exeMirroring?1:is_appControl?2:0;window.setTimeout(function(){c.sendScreenLockStampButton(a.m_uid,null,h);},100);}}if(is_appControl){ClipHybrid.callNativeControl("edit",JSON.stringify(g));}else{var f={methodName:"ShowVirtualKeyboard",data:null};f.data=g;window.external.ClipSubWebBrowserCtrl_Invoke(JSON.stringify(f));}if(this.eform.multiView.isSocket){this.eform.multiView.socket.sendFocusControl(this,"in");}};EFormInput.prototype.callFrameInput=function(){if(!this.eform.m_isUsePopupInputFrame.input||null!=this.eform.signPaintDiv){return;}var b=this;var r=this.eform;r.inputOrderFoucs(this);var k=null;if(r.multiView.isSocket){k=r.multiView.socket;k.sendScreenLock("key",r.m_uid);}r.disabledMenu(true);Re_zoom.isPop=true;var d=310;var c=r.targetDiv.offsetWidth;var m=document.createElement("div");m.className="m_eform_popup_background";m.style.background="rgba(155,155,155,0.3)";m.addEventListener("touchstart",function(v){if(v.touches.length>1){v.preventDefault();}},false);var g=document.createElement("div");if(r.m_isBottomPopHeight>0){g.style.height=(d)+"px";}else{g.style.height=(d<230?210:d)+"px";}g.className="eform_popup_body";var o=document.createElement("div");o.className="eform_popup_header";var j=document.createElement("div");j.className="eform_popup_header_Label";var s=document.createElement("nobr");j.appendChild(s);var n=document.createElement("button");n.className="eform_popup_close_button";var f=document.createElement("button");f.className="eform_popup_save_button";var u=document.createElement("button");u.className="eform_popup_next_button";o.appendChild(j);o.appendChild(n);o.appendChild(f);o.appendChild(u);g.appendChild(o);m.appendChild(g);r.m_bodyDiv.appendChild(m);r.signPaintDiv=m;var p=document.createElement("div");p.className="eform_popup_frame";p.style.left="0px";p.style.right="0px";g.appendChild(p);var q=document.createElement("div");q.className="eform_popup_frame_Label";var l=document.createElement("nobr");q.appendChild(l);q.innerHTML=this.controlData.title;p.appendChild(q);var h=document.createElement("button");h.className="eform_popup_frameReset_button";p.appendChild(h);var t=document.createElement("div");t.className="eform_popup_frame_body";p.appendChild(t);if(this.controlData.isGuideText&&null!=this.inputElement_GT){var i=document.createElement("textarea");i.readOnly=true;i.value=this.inputElement_GT.value;i.style.color=this.inputElement_GT.style.color;t.appendChild(i);}var a=null;if(this.controlData.isNumber){a=document.createElement("input");a.type="number";a.step="0.01";}else{a=document.createElement("textarea");}a.placeholder=this.inputElement.placeholder;a.maxLength=this.inputElement.maxLength;a.value=this.inputElement.value;t.appendChild(a);a.oninput=this.inputElement.oninput;h.onclick=function(){a.value="";};window.mRe_popupInput_close=n;n.onclick=function(){r.signPaintDiv=null;mRe_reSetPopupStatus();r.m_bodyDiv.removeChild(m);r.disabledMenu(false);if(null!=k){k.sendScreenUnLock(r.m_uid);}};f.onclick=function(){if(b.controlData.isFollowText&&b.controlData.isGuideText){if(b.controlData.guideText==a.value){b.setValue(a.value);}else{b.setValue("");if(b.event.requiredGuideEvent!=null){b.event.requiredGuideEvent(this);}if(null!=b.eform.ctrlEvent.inputRequiredGuideEvent){b.eform.ctrlEvent.inputRequiredGuideEvent(b);}}}else{b.setValue(a.value);}r.signPaintDiv=null;mRe_reSetPopupStatus();r.m_bodyDiv.removeChild(m);r.disabledMenu(false);if(b.eform.multiView.isSocket){b.eform.multiView.socket.sendFocusControl(b,"out");}if(null!=k){k.sendScreenUnLock(r.m_uid);}};u.onclick=function(){if(b.controlData.isFollowText&&b.controlData.isGuideText){if(b.controlData.guideText==a.value){b.setValue(a.value);}else{b.setValue("");if(b.event.requiredGuideEvent!=null){b.event.requiredGuideEvent(this);}if(null!=b.eform.ctrlEvent.inputRequiredGuideEvent){b.eform.ctrlEvent.inputRequiredGuideEvent(b);}}}else{b.setValue(a.value);}r.signPaintDiv=null;mRe_reSetPopupStatus();r.m_bodyDiv.removeChild(m);r.disabledMenu(false);if(b.eform.multiView.isSocket){b.eform.multiView.socket.sendFocusControl(b,"out");}if(b.controlData.isAutoNextFocus){var v=b.eform.nextHybridInputControl(b);if(!v){b.eform.nextEasyInputControl(b);}}if(null!=k){k.sendScreenUnLock(r.m_uid);}};a.onfocus=function(){if(a.type&&a.type=="number"){return;}this.setSelectionRange(0,this.value.length);};};EFormInput.prototype.getCtrlID=function(){return this.ctrlID;};EFormInput.prototype.getType=function(){return this.controlData.type;};EFormInput.prototype.getLabel=function(){return this.controlData.formatData;};EFormInput.prototype.getValue=function(){return this.controlData.value;};EFormInput.prototype.m_default_setValue=function(m,f,k,b){if(this.controlData.isGuideTextType==3||this.controlData.isGuideTextType==4){if(m==""){this.mRe_setGuideDisplayValue(this.controlData.guideText);}else{this.mRe_setGuideDisplayValue("");}}m=m.replace(/\t/g,"    ");if(this.controlData.isNoWrap){m=m.replace(/(\r\n)|(\n)|(\\r\\n)|(\\n)/g," ");if(this.isDOM){this.inputElement.value=m.replace(/(\\r\\n)|(\\n)/g,String.fromCharCode(13));}}if(this.controlData.value!=m){this.controlData.value=m;this.controlData.formatData=m;if(this.isDOM){this.inputElement.value=m.replace(/(\\r\\n)|(\\n)/g,String.fromCharCode(13));var j=m;if(""!=this.controlData.format){this.controlData.formatData=m.formatting(this.controlData.format);j=this.controlData.formatData;var o=this.controlData.format;if(this.controlData.formatUserType==2){var g="@";if(-1!=this.controlData.format.indexOf("9")){g="9";}o=this.controlData.format.replace(/\*|\?/g,g);this.controlData.formatData=this.controlData.value.formatting(o);}else{if(this.controlData.formatUserType==1){var g="@";if(-1!=this.controlData.format.indexOf("9")){g="9";}o=this.controlData.format.replace(/\*|\?/g,g);this.controlData.formatData=this.controlData.value.formatting(o);if(!((this.eform.multiView.isSocket&&this.eform.isMain)||!this.eform.multiView.isSocket)){j=this.controlData.formatData;}}}}if(this.controlData.autoSizeFont){mRe_autoSizeTextDraw(this.inputElement_td,j,true,this.controlData.lineSpace,this.controlData.wordSpace,this.inputElement,this.controlData.fontSize);}else{if(this.eform.m_isObjJSONSVG&&!this.eform.m_isAccessibility){mRe_autoSizeTextDraw(this.inputElement_td,j,false,this.controlData.lineSpace,this.controlData.wordSpace,this.inputElement,this.controlData.fontSize);}else{if(typeof this.inputElement_td.innerText!=="undefined"){j=j.replace(/(\\r\\n)|(\\n)/g,String.fromCharCode(13));j=j.split(" ").join("\u00A0");this.inputElement_td.innerText=j;}else{this.inputElement_td.innerHTML=j.replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/\\n/g,"<br />\n");}}}this.inputElement.scrollTop=0;this.setIsScroll(this.isScroll);var c=this.controlData.isNecessaryCheck=="true"?" eForm_inputNecessary":"";if(""!=ClipStrTrim(j)||(""!=this.controlData.formatData&&-1!=this.controlData.format.indexOf("?"))){this.controlData.is_nc=false;if(this.controlData.disable){this.inputElement_div.className="eF_Rect eForm_inputDisabled "+this.disabledClass;}else{if(this.eform.eForm_isNecessary.check){this.inputElement_div.className="eF_Rect eForm_inputDefault_bg"+c;}}}else{if("true"==this.controlData.isNecessaryCheck){this.controlData.is_nc=true;if(this.controlData.disable){this.inputElement_div.className="eF_Rect eForm_inputDisabled "+this.disabledClass;}else{if(this.eform.eForm_isNecessary.check&&!this.controlData.disable){this.inputElement_div.className="eF_Rect eForm_NecessaryCheck";}else{this.inputElement_div.className="eF_Rect eForm_inputDefault_bg"+c;}}}}}else{var j=m;if(""!=this.controlData.format){this.controlData.formatData=m.formatting(this.controlData.format);j=this.controlData.formatData;var o=this.controlData.format;if(this.controlData.formatUserType==2){var g="@";if(-1!=this.controlData.format.indexOf("9")){g="9";}o=this.controlData.format.replace(/\*|\?/g,g);this.controlData.formatData=this.controlData.value.formatting(o);}else{if(this.controlData.formatUserType==1){var g="@";if(-1!=this.controlData.format.indexOf("9")){g="9";}o=this.controlData.format.replace(/\*|\?/g,g);this.controlData.formatData=this.controlData.value.formatting(o);if(!((this.eform.multiView.isSocket&&this.eform.isMain)||!this.eform.multiView.isSocket)){j=this.controlData.formatData;}}}}if(""!=ClipStrTrim(j)||(""!=this.controlData.formatData&&-1!=this.controlData.format.indexOf("?"))){this.controlData.is_nc=false;}else{if("true"==this.controlData.isNecessaryCheck){this.controlData.is_nc=true;}}}if(this.eform.multiView.isSocket&&k){this.eform.multiView.socket.sendInputValue(this,f);}if(typeof getControlEventRulesCommand!="undefined"&&f){if((this.eform.multiView.isSocket&&this.eform.isMain)||!this.eform.multiView.isSocket){var l={};l.uid=this.eform.m_uid;l.reportName=this.controlData.rName;l.inputID=this.controlData.id;l.type="input";l.event="change";l.disabled=this.controlData.disable;l.visible=this.controlData.visible;var a=this.controlData.value;if(this.controlData.isKeyType==2||this.controlData.isKeyType==3){a=a.replace(/\,/g,"");}l.value=a;l.label=this.controlData.formatData;l.isNecessaryCheck="true"==this.controlData.isNecessaryCheck;l.isNecessaryChecked=!this.controlData.is_nc;l.sectionName=this.controlData.sName?this.controlData.sName:"";getControlEventRulesCommand(l);}}if(null!=this.event.changeEvent&&f){var h=this;window.setTimeout(function(){h.event.changeEvent(h);if(null!=h.eform.ctrlEvent.inputChangeEvent){h.eform.ctrlEvent.inputChangeEvent(h);}},10);}if(this.controlData.repeatSync){if(typeof b=="undefined"){b=true;}if(b){var n=eform.findCloneControl(this);for(var d=0;d<n.length;d++){n[d].m_default_setValue(m,f,false,false);}}}}};function mRe_autoSizeTextDraw(t,p,s,j,d,g,f){if(typeof j=="undefined"){j=0;}if(typeof d=="undefined"){d=0;}if(typeof g=="undefined"){g=null;}if(typeof f=="undefined"){f=null;}t.innerHTML="";var m=document.createElement("canvas");var o=t.offsetWidth;var i=t.offsetHeight;if(null!=g&&(o!=g.offsetWidth||i!=g.offsetHeight)){o=g.offsetWidth;i=g.offsetHeight;}if(o==0&&i==0){if(null!=g){var h=g.style.width;if(null!=h){if(-1!=h.toLowerCase().indexOf("cm")){h=parseFloat(h)*37.8;}else{h=parseFloat(h);}}var c=g.style.height;if(null!=c){if(-1!=c.toLowerCase().indexOf("cm")){c=parseFloat(c)*37.8;}else{c=parseFloat(c);}}o=h;i=c;}}m.width=(o-2)+"";m.height=(i-4)+"";t.appendChild(m);var q={text:"",isReduceFontSize:false,radius:25,pointerSide:"bottom",verticalAlign:"top",horizontalAlign:"left",fontName:"나눔고딕",fontSize:10,fontBold:false,fontColorR:255,fontColorG:255,fontColorB:255,isFolded:false,backgroundColorR:50,backgroundColorG:50,backgroundColorB:50,getFontColorRGB:function(){return"rgb("+this.fontColorR+","+this.fontColorG+","+this.fontColorB+")";},reduceWidth:2};var l=new mCR_TextBuilder();q.text=p.replace(/(\\r\\n)|(\\n)/g,String.fromCharCode(13));q.isReduceFontSize=s;q.verticalAlign=t.vAlign;q.horizontalAlign=t.align;var r=getComputedStyle(t);q.fontName=r.fontFamily;var n=10;if(null!=f){n=f;}else{if(""!=t.style.fontSize){if(-1!=t.style.fontSize.indexOf("pt")){n=parseFloat(t.style.fontSize);}else{n=parseFloat(t.style.fontSize)/1.33333;}}else{n=parseFloat(r.fontSize)/1.33333;}}q.fontSize=n;if(null!=r.fontWeight&&("bold"==r.fontWeight||"700"==r.fontWeight)){q.fontBold=true;}var a=r.color.replace(/[r|R][g|G][b|B]\(/g,"[").replace(/\)/g,"]");var k=jQuery.parseJSON(a);q.fontColorR=k[0];q.fontColorG=k[1];q.fontColorB=k[2];q.lineSpace=j;q.wordSpace=d;var b=l.drawTextFromSpeechBubble(m,q,true);t.innerHTML="";t.appendChild(b);if(q.changeFontSize&&null!=g){g.style.fontSize=q.changeFontSize+"px";g.style.lineHeight=q.changeFontSize+"px";}b.setAttribute("height",i+"");b.style.position="absolute";b.style.left="0px";b.style.top="0px";}EFormInput.prototype.setLocalValue=function(b,a){if(typeof a=="undefined"){a=true;}this.m_default_setValue(b,a,false);};EFormInput.prototype.setValue=function(b,a){if(typeof a=="undefined"){a=true;}this.m_default_setValue(b,a,true);};EFormInput.prototype.setZeroValueClearKeyboard=function(a){this.controlData.zeroValueKBD=a;};EFormInput.prototype.getVisible=function(){return this.controlData.visible;};EFormInput.prototype.setVisible=function(a,b){if(typeof b=="undefined"){b=false;}this.controlData.visible=a;if(this.isDOM){if(a){this.inputElement.style.display="";this.inputElement_div.style.display="";this.inputElement_td.style.display="";}else{this.inputElement.style.display="none";this.inputElement_div.style.display="none";this.inputElement_td.style.display="none";}}if(b){if(this.eform.multiView.isSocket){this.eform.multiView.socket.sendVisibled(this,a);}}};EFormInput.prototype.setUseNumberKeyPad=function(b){if(!is_appControl&&!is_exeControl){return;}this.controlData.isNumber=b;this.controlData.isKeyType=0;if(this.isDOM){var d=this;if(b){if(this.inputElement.tagName.toLocaleLowerCase()=="textarea"){var f=this.inputElement.parentElement;var a=document.createElement("input");if(is_smartphone){a.type="number";a.step="0.01";}a.id=this.inputElement.id;a.title=this.inputElement.title;a.className=this.inputElement.className;a.tabIndex=this.inputElement.tabIndex;a.style.cssText=this.inputElement.style.cssText;a.placeholder=this.inputElement.placeholder;f.insertBefore(a,this.inputElement);f.removeChild(this.inputElement);this.inputElement=a;a.oninput=function(j){var k=this.value;if(!(is_smartphone&&(j.data=="."||j.data=="-"||j.inputType=="deleteContentBackward"))){if(k!="-"||d.controlData.isKeyType==4){var n=parseFloat(k);if(isNaN(n)){this.value="";}else{var h="";if(k.charAt(0)=="-"){h="-";}var m=k.indexOf(".");if(-1==m){k=k.replace(/[^0-9]/g,"");}else{var i=k.substring(0,m);var l=k.substring(m+1);i=i.replace(/[^0-9]/g,"");l=l.replace(/[^0-9]/g,"");if(l==""){k=i+".";}else{k=i+"."+l;}}this.value=h+k;}}else{this.value=k;}var g=this.maxLength;if(null!=g&&g>0){if(this.value.length>g){this.value=this.value.slice(0,g);}}if(!is_smartphone){d.onKeyUp(this);}}};this.inputElement.value=this.controlData.value;if(0<this.controlData.maxLength){this.inputElement.maxLength=this.controlData.maxLength;}this.inputElement.onblur=function(){d.setValue(this.value);d.onBlur();if(d.eform.multiView.isSocket){d.eform.multiView.socket.sendFocusControl(d,"out");}};this.inputElement.onfocus=function(){d.focusControl();d.onFocus();if(d.eform.multiView.isSocket){d.eform.multiView.socket.sendFocusControl(d,"in");}};this.inputElement.onkeyup=function(){if(c.maxLength>0){this.value=this.value.slice(0,c.maxLength);}if(is_smartphone){d.onKeyUp(this);}};}}else{if(this.inputElement.tagName.toLocaleLowerCase()=="input"){var f=this.inputElement.parentElement;var a=document.createElement("textarea");a.id=this.inputElement.id;a.title=this.inputElement.title;a.className=this.inputElement.className;a.tabIndex=this.inputElement.tabIndex;a.style.cssText=this.inputElement.style.cssText;a.placeholder=this.inputElement.placeholder;f.insertBefore(a,this.inputElement);f.removeChild(this.inputElement);this.inputElement=a;a.oninput=function(){var g=this.maxLength;if(null!=g&&g>0){if(this.value.length>g){this.value=this.value.slice(0,g);}}if(!is_smartphone){d.onKeyUp(this);}};this.inputElement.value=this.controlData.value;if(0<this.controlData.maxLength){this.inputElement.maxLength=this.controlData.maxLength;}this.inputElement.onblur=function(){d.setValue(this.value);d.onBlur();if(d.eform.multiView.isSocket){d.eform.multiView.socket.sendFocusControl(d,"out");}};this.inputElement.onfocus=function(){d.focusControl();d.onFocus();if(d.eform.multiView.isSocket){d.eform.multiView.socket.sendFocusControl(d,"in");}};var c=this.controlData;this.inputElement.onkeyup=function(){if(c.maxLength>0){this.value=this.value.slice(0,c.maxLength);}if(is_smartphone){d.onKeyUp(this);}};}}}this.checkKeyEvent();};EFormInput.prototype.setUseNoWrap=function(a){this.controlData.isNoWrap=a;this.checkKeyEvent();};EFormInput.prototype.checkKeyEvent=function(){if(this.isDOM){if(this.controlData.isNoWrap||this.controlData.isNumber){this.inputElement.onkeypress=function(a){if(a.keyCode==13){this.blur();return false;}return true;};}else{this.inputElement.onkeypress=null;}}};EFormInput.prototype.setDisabledClass=function(a){this.disabledClass=a;if(this.isDOM){this.setDisabled(this.controlData.disable,false);}};EFormInput.prototype.getDisabled=function(){return this.controlData.disable;};EFormInput.prototype.setDisabled=function(g,h,f){if(typeof h=="undefined"){h=false;}if(typeof f=="undefined"){f=true;}this.controlData.disable=g;var c=g;if(this.isDOM){var d=this.eform.isEasyInput?0:this.controlData.pageNumber;var a=this.eform.m_eformPageDisabled[d];if(null==a){a=false;}if(g||a||this.eform.m_eformDisabled){c=true;this.closeFocusSetValue();this.inputElement.disabled=true;if(this.controlData.isGuideText){this.inputElement_GT.style.opacity=0;}this.inputElement_div.className="eF_Rect eForm_inputDisabled "+this.disabledClass;this.removeSubCallKeyboardButton();}else{var b=this.controlData.isNecessaryCheck=="true"?" eForm_inputNecessary":"";c=false;this.inputElement.disabled=false;if(this.eform.eForm_isNecessary.check&&this.controlData.isNecessaryCheck=="true"&&this.controlData.is_nc){this.inputElement_div.className="eF_Rect eForm_NecessaryCheck";}else{this.inputElement_div.className="eF_Rect eForm_inputDefault_bg"+b;}}}if(h){if(this.eform.multiView.isSocket){this.eform.multiView.socket.sendDisabled(this,g);}}if(null!=this.eform.ctrlEvent.disabledEvent&&f){this.eform.ctrlEvent.disabledEvent(c,this);}};EFormInput.prototype.closeFocusSetValue=function(){if(this.isInputFocus){try{var a=this.inputElement.value;a=a.replace(/\t/g,"    ");if(this.controlData.value!=a){this.setValue(a);}}catch(b){ReportWebLog("input.closeFocusSetValue 함수에서 오류가 발생하였습니다.");}}};EFormInput.prototype.setGuideBGColor=function(b,a,d,c,f){if(typeof f=="undefined"){f=true;}this.controlData.bgColor="rgba("+b+","+a+","+d+","+c+")";if(this.isDOM){this.inputElement_div.style.backgroundColor=this.controlData.bgColor;}if(this.eform.multiView.isSocket&&f){this.eform.multiView.socket.sendControlColor(this,b,a,d,c);}};EFormInput.prototype.m_setBGColor=function(){if(null!=this.controlData.bgColor){if(this.isDOM){this.inputElement_div.style.backgroundColor=this.controlData.bgColor;}}};EFormInput.prototype.setNecessaryCheck=function(a,b){if(typeof b=="undefined"){b=false;}if(a){this.controlData.isNecessaryCheck="true";if(""!=ClipStrTrim(this.controlData.formatData)){this.controlData.is_nc=false;if(this.isDOM){this.inputElement_div.className="eF_Rect";}}else{this.controlData.is_nc=true;}}else{this.controlData.is_nc=false;this.controlData.isNecessaryCheck="false";if(this.isDOM){this.inputElement_div.className="eF_Rect";}}this.setDisabled(this.controlData.disable,false);this.setVisible(this.controlData.visible,false);if(b){if(this.eform.multiView.isSocket){this.eform.multiView.socket.sendNecessaryCheck(this,a);}}};EFormInput.prototype.getIndexOrderDisabled=function(){return this.controlData.indexOrderDisable;};EFormInput.prototype.setIndexOrderDisabled=function(a){this.controlData.indexOrderDisable=a;};EFormInput.prototype.setMaxLength=function(a){this.controlData.maxLength=a;if(this.isDOM&&0<a){this.inputElement.maxLength=a;}else{if(this.isDOM){this.inputElement.maxLength=524288;}}};EFormInput.prototype.onChangeEvent=function(a){this.event.changeEvent=a;this.event.eventTarget=this;};EFormInput.prototype.onRequiredGuideEvent=function(a){this.event.requiredGuideEvent=a;this.event.eventTarget=this;};EFormInput.prototype.onKeyUpEvent=function(a){this.event.keyUpEvent=a;this.event.eventTarget=this;};EFormInput.prototype.onFocusEvent=function(a){this.event.focusEvent=a;this.event.eventTarget=this;};EFormInput.prototype.onBlurEvent=function(a){this.event.blurEvent=a;this.event.eventTarget=this;};EFormInput.prototype.getTitle=function(){return this.title;};EFormInput.prototype.setTitle=function(a){this.controlData.title=a;this.title=a;if(this.isDOM){this.inputElement.title=a;}};EFormInput.prototype.setAutoNextFocus=function(a){this.controlData.isAutoNextFocus=a;};EFormInput.prototype.mRe_setGuideDisplayValue=function(a){if(null!=this.inputElement_td_GT){if(this.eform.m_isObjJSONSVG&&!this.eform.m_isAccessibility){mRe_autoSizeTextDraw(this.inputElement_td_GT,a,false,this.controlData.lineSpace,this.controlData.wordSpace,this.inputElement,this.controlData.fontSize);}else{if(typeof this.inputElement_td_GT.innerText!=="undefined"){a=a.replace(/(\\r\\n)|(\\n)/g,String.fromCharCode(13));a=a.split(" ").join("\u00A0");this.inputElement_td_GT.innerText=a;}else{this.inputElement_td_GT.innerHTML=a.replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/\n/g,"<br />\n");}}}};EFormInput.prototype.getFormat=function(){return this.controlData.format;};EFormInput.prototype.setFormat=function(g){this.controlData.format=g;var d=this.controlData.value;if(this.isDOM){var a=d;if(""!=this.controlData.format){this.controlData.formatData=d.formatting(this.controlData.format);a=this.controlData.formatData;var f=this.controlData.format;if(this.controlData.formatUserType==2){var c="@";if(-1!=this.controlData.format.indexOf("9")){c="9";}f=this.controlData.format.replace(/\*|\?/g,c);this.controlData.formatData=this.controlData.value.formatting(f);}else{if(this.controlData.formatUserType==1){var c="@";if(-1!=this.controlData.format.indexOf("9")){c="9";}f=this.controlData.format.replace(/\*|\?/g,c);this.controlData.formatData=this.controlData.value.formatting(f);if(!((this.eform.multiView.isSocket&&this.eform.isMain)||!this.eform.multiView.isSocket)){a=this.controlData.formatData;}}}}else{this.controlData.formatData=a;}if(this.controlData.autoSizeFont){mRe_autoSizeTextDraw(this.inputElement_td,a,true,this.controlData.lineSpace,this.controlData.wordSpace,this.inputElement,this.controlData.fontSize);}else{if(this.eform.m_isObjJSONSVG&&!this.eform.m_isAccessibility){mRe_autoSizeTextDraw(this.inputElement_td,a,false,this.controlData.lineSpace,this.controlData.wordSpace,this.inputElement,this.controlData.fontSize);}else{if(typeof this.inputElement_td.innerText!=="undefined"){a=a.replace(/(\\r\\n)|(\\n)/g,String.fromCharCode(13));a=a.split(" ").join("\u00A0");this.inputElement_td.innerText=a;}else{this.inputElement_td.innerHTML=a.replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/\\n/g,"<br />\n");}}}var b=this.controlData.isNecessaryCheck=="true"?" eForm_inputNecessary":"";if(""!=ClipStrTrim(a)||(""!=this.controlData.formatData&&-1!=this.controlData.format.indexOf("?"))){this.controlData.is_nc=false;if(this.controlData.disable){this.inputElement_div.className="eF_Rect eForm_inputDisabled "+this.disabledClass;}else{if(this.eform.eForm_isNecessary.check){this.inputElement_div.className="eF_Rect eForm_inputDefault_bg"+b;}}}else{if("true"==this.controlData.isNecessaryCheck){this.controlData.is_nc=true;if(this.controlData.disable){this.inputElement_div.className="eF_Rect eForm_inputDisabled "+this.disabledClass;}else{if(this.eform.eForm_isNecessary.check){this.inputElement_div.className="eF_Rect eForm_NecessaryCheck";}else{this.inputElement_div.className="eF_Rect eForm_inputDefault_bg"+b;}}}}}else{var a=d;if(""!=this.controlData.format){this.controlData.formatData=d.formatting(this.controlData.format);a=this.controlData.formatData;var f=this.controlData.format;if(this.controlData.formatUserType==2){var c="@";if(-1!=this.controlData.format.indexOf("9")){c="9";}f=this.controlData.format.replace(/\*|\?/g,c);this.controlData.formatData=this.controlData.value.formatting(f);}else{if(this.controlData.formatUserType==1){var c="@";if(-1!=this.controlData.format.indexOf("9")){c="9";}f=this.controlData.format.replace(/\*|\?/g,c);this.controlData.formatData=this.controlData.value.formatting(f);if(!((this.eform.multiView.isSocket&&this.eform.isMain)||!this.eform.multiView.isSocket)){a=this.controlData.formatData;}}}}else{this.controlData.formatData=a;}if(""!=ClipStrTrim(a)||(""!=this.controlData.formatData&&-1!=this.controlData.format.indexOf("?"))){this.controlData.is_nc=false;}else{if("true"==this.controlData.isNecessaryCheck){this.controlData.is_nc=true;}}}};EFormInput.prototype.getAutoSizeFont=function(){return this.controlData.autoSizeFont;};EFormInput.prototype.setAutoSizeFont=function(a){this.controlData.autoSizeFont=a;};EFormInput.prototype.setIsScroll=function(a){this.isScroll=a;if(this.isDOM){if(a){this.inputElement.style.overflowY="auto";}else{this.inputElement.style.overflowY="hidden";}}};EFormInput.prototype.getPageNumber=function(){if(typeof this.controlData.pageNumber=="undefined"){return null;}return this.controlData.pageNumber+1;};EFormInput.prototype.focus=function(){if(this.isDOM){this.eform.mRe_inputFocusRectBlur();var a=this.inputElement;setTimeout(function(){a.focus();},1);}else{if(!this.eform.isEasyInput){this.eform.m_isrulesControlInfo=this.ctrlID;this.eform.sendRulesControlInfo();this.eform.selectPage(this.controlData.pageNumber,"control_focus");}}};EFormInput.prototype.blur=function(){if(this.isDOM){var a=this.inputElement.blur();}};EFormInput.prototype.onFocus=function(){if(this.isDOM){window.mRe_targetFocusInput=this.inputElement;}if(null!=this.event.focusEvent){this.event.focusEvent(this);}if(null!=this.eform.ctrlEvent.inputFocusEvent){this.eform.ctrlEvent.inputFocusEvent(this);}};EFormInput.prototype.onKeyUp=function(a){if(null!=this.event.keyUpEvent){this.event.keyUpEvent(a,this);}if(null!=this.eform.ctrlEvent.inputKeyUpEvent){this.eform.ctrlEvent.inputKeyUpEvent(a,this);}};EFormInput.prototype.blurControl=function(a){if(is_apple){this.inputElement.style.opacity=0;}window.mRe_FocusInputStatus=false;this.isInputFocus=false;this.eform.m_isInputFocus=false;this.eform.m_focusInputDOM=null;var b=false;this.eform.inputImagePointerOut();if(this.controlData.isFollowText&&this.controlData.isGuideText){this.inputElement_GT.style.opacity=0;if(this.controlData.guideText==a.value){this.setValue(a.value);if(""!=this.controlData.formatData){b=true;}}else{this.setValue("");a.value="";if(this.event.requiredGuideEvent!=null){this.event.requiredGuideEvent(this);}if(null!=this.eform.ctrlEvent.inputRequiredGuideEvent){this.eform.ctrlEvent.inputRequiredGuideEvent(this);}}}else{if(this.controlData.isGuideText){this.inputElement_GT.style.opacity=0;}this.setValue(a.value);if(""!=this.controlData.formatData){b=true;}}this.removeSubCallKeyboardButton();if(!is_appControl&&!is_exeControl&&!this.eform.m_isUsePopupInputFrame.input&&b){if(this.controlData.isAutoNextFocus){this.eform.nextHybridInputControl(this);}}};EFormInput.prototype.onBlur=function(){if(null!=this.event.blurEvent){this.event.blurEvent(this);}if(null!=this.eform.ctrlEvent.inputBlurEvent){this.eform.ctrlEvent.inputBlurEvent(this);}};EFormInput.prototype.focusControl=function(){this.eform.mRe_inputFocusRectBlur();window.mRe_FocusInputStatus=true;this.eform.m_isInputFocus=true;this.isInputFocus=true;if(this.isDOM){this.eform.m_focusInputDOM=this.inputElement;}var c=this.inputElement;if(null!=c){if(is_apple){c.style.opacity=1;if(null!=window.m_clipReport_apple_tempBorder){c.style.border=window.m_clipReport_apple_tempBorder;}else{var a=m_Report_getStylesBySelector(".eform_textarea:focus");if(null!=a&&null!=a.border){window.m_clipReport_apple_tempBorder=a.border;c.style.border=window.m_clipReport_apple_tempBorder;}else{window.m_clipReport_apple_tempBorder="2pt solid Orange";c.style.border=window.m_clipReport_apple_tempBorder;}}}}if(this.controlData.isGuideText){this.inputElement_GT.style.opacity=1;}this.eform.inputImagePointerIn(this);if(this.eform.titleSpeechBubble.visible.input){this.eform.inputCreateTitleSpeechBubble(this);}else{this.eform.inputRemoveTitleSpeechBubble();}if(this.eform.m_isHybridQuickControl||null!=this.controlData.inputOrder){this.eform.inputOrderFoucs(this);}else{this.eform.inputOrderBlur();}if(this.isCallKeyboardConnect&&(this.controlData.formatUserType==0)&&(!this.controlData.subOnlyEdit&&this.eform.mRe_MainNecessaryInputEnabledCheckControl(this))){this.createSubCallKeyboardButton();}if(this.eform.m_isHybridQuickControl&&(is_appControl||is_exeControl||this.eform.m_isUsePopupInputFrame.input)){if(!this.is_mousedown){var b=this;window.setTimeout(function(){if(b.eform.m_isUsePopupInputFrame.input){b.callFrameInput();}else{b.callHybridInput();}},window.mRe_exeCallInterval);}if(event.stopPropagation){event.stopPropagation();}else{event.cancelBubble=true;}}this.is_mousedown=false;};EFormInput.prototype.HybridFocusControl=function(){if(is_appControl||is_exeControl){if(this.eform.multiView.isSocket&&!this.controlData.disable){this.eform.multiView.socket.sendHybridInputFocusControl(this);}this.onFocus();}else{if(null!=this.eform.ctrlEvent.inputFocusEvent){this.eform.ctrlEvent.inputFocusEvent(this);}}if(this.eform.m_isHybridQuickControl){this.eform.inputOrderFoucs(this);}};EFormInput.prototype.multiViewFocus=function(){if(null==mRe_FocusControl.objCtrl||mRe_FocusControl.objCtrl!=this){mRe_FocusControl.objCtrl=this;if(this.isDOM){if(this.eform.m_isMultiViewFoucs){this.inputElement.focus();}else{this.eform.mRe_inputFocusRectBlur();var a=this.inputElement_div.parentElement.className;this.inputElement_div.parentElement.className=a+" eform_control_focus";this.eform.inputImagePointerIn(this);if(this.eform.titleSpeechBubble.visible.input){this.eform.inputCreateTitleSpeechBubble(this);}else{this.eform.inputRemoveTitleSpeechBubble();}this.HybridFocusControl();}}}};EFormInput.prototype.multiViewBlur=function(){mRe_FocusControl={objCtrl:null};if(this.isDOM){var a=this.inputElement_div.parentElement.className;a=a.replace("eform_control_focus","").trim();this.inputElement_div.parentElement.className=a;this.eform.inputImagePointerOut();this.inputElement.blur();}};EFormInput.prototype.subCallKeyboard=function(){if(this.eform.multiView.isSocket){this.eform.multiView.socket.sendHybridInputCallKeyboard(this);}};EFormInput.prototype.createSubCallKeyboardButton=function(){if(this.isDOM&&null==this.callKeyboardButton){var a=this;var b=document.createElement("button");var c=this.inputElement;var d=c.parentElement;b.className="eform_keyboard_call_button";b.style.left=c.offsetLeft+"px";b.style.top=(c.offsetTop+c.offsetHeight+5)+"px";b.innerHTML=this.eform.m_SubInputCallButtonText;b.onmousedown=function(f){if(a.eform.multiView.isSocket){a.eform.multiView.socket.sendHybridInputCallKeyboard(a);}a.removeSubCallKeyboardButton();f.preventDefault();};d.appendChild(b);this.callKeyboardButton=b;this.isCallKeyboardConnect=true;}};EFormInput.prototype.removeSubCallKeyboardButton=function(){if(this.isDOM){if(null!=this.callKeyboardButton){try{this.inputElement.parentElement.removeChild(this.callKeyboardButton);}catch(a){mRe_ReportWebLog(a.stack);}this.callKeyboardButton=null;}}};String.prototype.formatting=function(d){var k=this;var c=d;if(""==d||""==k){return this;}else{if("phone1"==d||"phone2"==d){k=k.replace(/[^0-9]/g,"");var b="";var o="";var h="";if(k.length>8&&k.charAt(0)=="0"&&k.charAt(1)=="2"){b="02";o=k.substring(2,k.length-4);h=k.substring(k.length-4);}else{if(k.length>9){var s=3;if(k.length==12){s=4;}b=k.substring(0,s);o=k.substring(s,k.length-4);h=k.substring(k.length-4);}else{return"";}}if("phone1"==d){return b+"-"+o+"-"+h;}else{return"("+b+")"+o+"-"+h;}}}var u="";if(/\((\D+)\)/.test(d)){u=d.substring(d.indexOf("("),d.indexOf(")")+1);d=d.substring(u.length,d.length);}var q="";var t="";if(/\'(\D+)\'/.test(d)){q=d.substring(d.indexOf("'"),d.lastIndexOf("'")+1);d=d.substring(0,d.length-q.length);t=q.substring(1,q.length-1);}if(d.indexOf("9#")){d=d.replace("9#","#");}if("-1"==d.indexOf("#")&&"-1"==d.indexOf("0")){if("-1"!=d.indexOf("9")||"-1"!=d.indexOf("*")||"-1"!=d.indexOf("?")||"-1"!=d.indexOf("@")){return mRe_inputValidateCheck(d,k,u);}else{d=d.toUpperCase();d=d.replace(/S/gi,"s").replace(/\:MM/gi,":mm").replace(/MM\:/gi,"mm:").replace(/\:M/gi,":m").replace(/M\:/gi,"m:");var j=moment(k,d).format(d);if("Invalid date"==j){if(typeof userCustomFormat!="undefined"){return userCustomFormat(this,c);}else{return"";}}return j;}}else{var a="";var n=d.indexOf(".");var f="-1"!=d.indexOf(",")?1:0;f="-1"!=n?(f+2):f;var m=false;switch(f){case 2:case 3:m=true;break;}if(""!=u){u=u.charAt(1);if(u!=k.charAt(0)){u="";}}var l="";if(-1!=n){while("0"==d.charAt((n+1))){l+="0";n++;}}else{if(-1!=k.indexOf(".")){k=k.substring(0,k.indexOf("."));}}var r=0;var w="";k=k.trim();if(k.indexOf("-")==0){w="-";}k=k.replace(/[^.\d]/g,"");if("9#"!=d){for(var v=0;v<k.length;v++){if("0"!=k.charAt(v)){r=v;if(0!=v&&"."==k.charAt(v)){r--;}break;}}}k=k.substring(r,k.length);switch(f){case 0:a=inputMoneyUnitValidateCheckPattern3(k,d,l);break;case 1:if(k=="0"&&-1==d.indexOf("#0")){a="";}else{a=inputMoneyUnitValidateCheckPattern2(k,m,l);}break;case 2:a=inputMoneyUnitValidateCheckPattern3(k,d,l);break;case 3:if(-1==k.indexOf(".")){a=inputMoneyUnitValidateCheckPattern2(k,m,l);if(""!=l){a+="."+l;}}else{var p=k.indexOf(".");a+=inputMoneyUnitValidateCheckPattern2(k.substring(0,p),m,l);a+=".";var g=inputMoneyUnitValidateCheckPattern1(k.substring(p+1,k.length),l);a+=g;}break;}if(""!=u){a=u+a;}if(null!=t&&""!=t){a+=t;}if(a==""){return a;}else{return w+a;}}};window.inputMoneyUnitValidateCheckPattern1=function(a,d){var c="";var f=a.length;f=0==d.length?f:d.length;for(var b=0;b<f;b++){if(""!=a.charAt(b)){c+=a.charAt(b);continue;}else{c+="0";}}return c;};window.inputMoneyUnitValidateCheckPattern2=function(a,b,h){var k="";a=a.replace(/\D/g,"");var f=a.length;var c=f%3;var j=(f/2)-1;var m=0;var g=0;var l=false;for(var d=0;d<f;d++){if(0==d&&a.charCodeAt(d)==48){k=a.charAt(d);}else{if(c==m){if(f>3&&c!=0){k=k+",";l=true;}else{if(f>3){l=true;}}}if(3==g){k=k+",";g=0;}k+=a.charAt(d);m++;if(l){g++;}}}if(""==k&&b&&""!=h){k="0";}return k;};window.inputMoneyUnitValidateCheckPattern3=function(b,j,f){var d="";b=b.replace(/[^\.\d]/g,"");var h=0==f.length?0:f.length;var g=b.length;for(var c=0;c<g;c++){d+=b.charAt(c);}if(""==d&&"0"==j.replace(/[^\.\d]/g,"").charAt(0)){d="0";}if(-1!=b.indexOf(".")){var a=b.substring(b.indexOf("."),g).length;for(var c=a;c<=h;c++){d+="0";}}else{if(0<h){d+=".";for(var c=0;c<h;c++){d+="0";}}}return d;};window.formatStatus=function(a){if(""==a){return 0;}var b;if("-1"==a.indexOf("#")&&"-1"==a.indexOf("0")){return 1;}else{b="-1"!=a.indexOf(",")?3:2;b="-1"!=a.indexOf(".")?(b+2):b;return b;}};window.mRe_inputValidateCheck=function(j,a,c){var k="";var b="";var d=0;var h=0;var f=j.length;if(""!=c){c=c.charAt(1);if(c!=a.charAt(0)){c="";}}reSpecialChar=/\s/g;a=a.replace(reSpecialChar,"");if(-1==j.indexOf("@")){reSpecialChar=/\W/g;a=a.replace(reSpecialChar,"");}for(var g=0;g<f;g++){if(d!=f&&""!=a.charAt(h)){if("9"!=j.charAt(d)&&"y"!=j.charAt(d)&&"m"!=j.charAt(d)&&"d"!=j.charAt(d)&&"h"!=j.charAt(d)&&"n"!=j.charAt(d)&&"s"!=j.charAt(d)&&"A"!=j.charAt(d)&&"a"!=j.charAt(d)&&"C"!=j.charAt(d)&&"L"!=j.charAt(d)&&"*"!=j.charAt(d)&&"@"!=j.charAt(d)&&"?"!=j.charAt(d)){k=k+j.charAt(d);d++;}else{for(;h<a.length;h++){b=validateFormat(d,h,j,a);if(""!=b){k=k+b;h++;if("9"!=j.charAt(d+1)&&"y"!=j.charAt(d+1)&&"m"!=j.charAt(d+1)&&"d"!=j.charAt(d+1)&&"h"!=j.charAt(d+1)&&"n"!=j.charAt(d+1)&&"s"!=j.charAt(d+1)&&"A"!=j.charAt(d+1)&&"a"!=j.charAt(d+1)&&"C"!=j.charAt(d+1)&&"L"!=j.charAt(d+1)&&"*"!=j.charAt(d+1)&&"@"!=j.charAt(d+1)&&"?"!=j.charAt(d+1)){k=k+j.charAt(d+1);d++;}break;}else{if(""!=c){k=c+k;}return k;}}d++;}}}if(""!=c){k=c+k;}return k;};window.validateFormat=function(a,i,f,d){var h=d.charAt(i);var g=h.charCodeAt(0);switch(f.charAt(a)){case"@":return h;case"*":return"*";case"?":return" ";case"9":if(g>=48&&g<=57){return String.fromCharCode(g);}return"";case"y":if(g>=48&&g<=57){return String.fromCharCode(g);}return"";case"m":if("m"==f.charAt(a+1)){if(g>=48&&g<=49){return String.fromCharCode(g);}}else{if("m"==f.charAt(a-1)&&"1"==d.charAt(i-1)){if(g>=48&&g<=50){return String.fromCharCode(g);}}else{if(g>=48&&g<=57){return String.fromCharCode(g);}}}return"";case"d":if("d"==f.charAt(a+1)){var c=null;for(var b=a-1;b>0;b--){if("m"==f.charAt(b)){c=b;break;}}if(null==c){if(g>=48&&g<=51){return String.fromCharCode(g);}}if("m"==f.charAt(c)&&"2"==d.charAt(i-1)&&(("m"==f.charAt(c-1)&&"0"==d.charAt(i-2))||"m"!=f.charAt(c-1))){if(g>=48&&g<=50){return String.fromCharCode(g);}}else{if(g>=48&&g<=51){return String.fromCharCode(g);}}}else{if("d"==f.charAt(a-1)&&"3"!=d.charAt(i-1)){if(g>=48&&g<=57){return String.fromCharCode(g);}}else{if("d"==f.charAt(a-1)&&"3"==d.charAt(i-1)){if(g>=48&&g<=49){return String.fromCharCode(g);}}else{if(g>=48&&g<=57){return String.fromCharCode(g);}}}}return"";case"h":if("h"==f.charAt(a+1)){if(g>=48&&g<=50){return String.fromCharCode(g);}}else{if("h"==f.charAt(a-1)&&"2"==d.charAt(i-1)){if(g>=48&&g<=52){return String.fromCharCode(g);}}else{if(g>=48&&g<=57){return String.fromCharCode(g);}}}return"";case"n":if("n"==f.charAt(a+1)){if(g>=48&&g<=53){return String.fromCharCode(g);}}else{if(g>=48&&g<=57){return String.fromCharCode(g);}}return"";case"s":if("s"==f.charAt(a+1)){if(g>=48&&g<=53){return String.fromCharCode(g);}}else{if(g>=48&&g<=57){return String.fromCharCode(g);}}return"";case"A":if((g>=48&&g<=57)||(g>=65&&g<=90)||(g>=97&&g<=129)){return h;}return"";case"a":if((g==32)||(g>=48&&g<=57)||(g>=65&&g<=90)||(g>=97&&g<=129)){return h;}return"";case"C":if((g>=48&&g<=112)||g>185||(g>=97&&g<=129)){return h;}return"";case"L":if((g>=65&&g<=90)||(g>=97&&g<=129)){return h;}return"";default:return"";}};function m_Report_getStylesBySelector(k){var p=window.document.styleSheets;var q={};for(var g=0,f=p.length;g<f;g++){var d=p[g].rules||p[g].cssRules||[];for(var o=0,n=d.length;o<n;o++){var c=d[o].selectorText||"";var j=d[o].cssText||d[o].style.cssText||"";if(c.trim()===k){var b=j.split(/(?:{|})/)[1].trim().split(";");for(var m=0;m<b.length;m++){var h=b[m].split(":");var a=h[0].trim();if(""!=a){q[a]=h[1];}}}}}return q;}function mRe_NumberFormat(d){var a=false;if(d.charAt(0)=="-"){a=true;}var b="";var c=d.replace(/[^(0-9|\.)]/g,"").split(".");if(c.length>0&&c[0].length>0){b=b+Number(c[0]);}if(c.length>1&&c[1].length>0){if(Number(c[1])!=0){b=b+"."+c[1];}}if(b.length>0&&Number(b)!=0){b=(a?"-":"")+b;}return b;}function EFormCheckbox(){this.eform=null;this.ctrlID=null;this.controlData=null;this.group=null;this.isDOM=false;this.checkElement=null;this.checkElement_img=null;this.checkElement_div=null;this.checkElement_focusDiv=null;this.checkElement_text=null;this.event={checkedEvent:null,unCheckedEvent:null,eventTarget:null};this.title=null;this.bgColor=null;this.disabledClass="";this.checkBorderStyle=null;this.unCheckBorderStyle=null;}EFormCheckbox.prototype.setGroup=function(a){this.group=a;};EFormCheckbox.prototype.init=function(b,a,c){this.eform=c;this.ctrlID=b;this.controlData=a;this.controlData.necessaryMessage=a.necessaryMessage.replace(/\\\//g,"/").replace(/\\\\/g,"\\").replace(/\\\"/g,'"');if(null!=a.inputOrder){this.eform.eFormIndexControlList[a.inputOrder]=this;}if(null==a.indexOrderDisable){a.indexOrderDisable=false;}if(null==a.isToView){a.isToView=true;}if(null==a.isToEasyMode){a.isToEasyMode=true;}if(c.isEasyInput&&a.isToEasyMode){a.isToView=true;}if(!a.isToView){a.is_nc=false;}if(null==a.isAutoNextFocus){a.isAutoNextFocus=true;}if(null==a.useFalseValue){a.useFalseValue=false;}if(null==a.falseValue){a.falseValue="";}else{this.controlData.falseValue=a.falseValue.replace(/\\\//g,"/").replace(/\\\\/g,"\\").replace(/\\\"/g,'"');}if(null==a.repeatSync){a.repeatSync=false;}if(null!=a.title){this.controlData.title=a.title.replace(/\\\//g,"/").replace(/\\\\/g,"\\").replace(/\\\"/g,'"');this.title=this.controlData.title;}else{this.controlData.title="";}if(null!=a.label){this.controlData.label=a.label.replace(/\\\//g,"/").replace(/\\\\/g,"\\").replace(/\\\"/g,'"');this.label=this.controlData.label;}else{this.controlData.label="";}this.controlData.isLabelVisibleSync=false;if(this.eform.m_eformCheckLabelVisible){this.controlData.isLabelVisibleSync=true;}if(null==a.sName){a.sName="";}};EFormCheckbox.prototype.deleteMe=function(){this.eform=null;this.ctrlID=null;this.controlData=null;this.event=null;this.group=null;this.deleteDOM();};EFormCheckbox.prototype.resetDOM=function(){this.isDOM=false;this.checkElement=null;this.checkElement_img=null;this.checkElement_div=null;this.checkElement_focusDiv=null;this.checkElement_text=null;};EFormCheckbox.prototype.deleteDOM=function(){if(this.checkElement){if(this.checkElement.parentElement){this.checkElement.parentElement.removeChild(this.checkElement);}else{delete this.checkElement;}}if(this.checkElement_img){if(this.checkElement_img.parentElement){this.checkElement_img.parentElement.removeChild(this.checkElement_img);}else{delete this.checkElement_img;}}if(this.checkElement_div){if(this.checkElement_div.parentElement){this.checkElement_div.parentElement.removeChild(this.checkElement_div);}else{delete this.checkElement_div;}}if(this.checkElement_focusDiv){if(this.checkElement_focusDiv.parentElement){this.checkElement_focusDiv.parentElement.removeChild(this.checkElement_focusDiv);}else{delete this.checkElement_focusDiv;}}this.resetDOM();};EFormCheckbox.prototype.getRect=function(){if(this.isDOM){var b={left:0,top:0,width:0,height:0};var d=this.checkElement;var c=d.parentElement.offsetLeft;var a=d.parentElement.offsetTop;b.left=c+d.offsetLeft;b.top=a+d.offsetTop;b.width=d.offsetWidth;b.height=d.offsetHeight;return b;}return null;};EFormCheckbox.prototype.getHE=function(){if(this.isDOM){return this.checkElement;}return null;};EFormCheckbox.prototype.eventHandlerInputCheckbox=function(){if(!this.controlData.isToView){return;}if(typeof this.controlData.pageNumber=="undefined"){this.controlData.pageNumber=this.eform.beforePageIndex;}this.isDOM=true;this.checkElement=document.getElementById(this.eform.m_uid+this.ctrlID);this.checkElement_img=document.getElementById(this.eform.m_uid+this.ctrlID+"IMG");this.checkElement_div=document.getElementById(this.eform.m_uid+this.ctrlID+"DIV");this.checkElement_focusDiv=document.getElementById(this.eform.m_uid+this.ctrlID+"FOCUS");this.checkElement_text=this.checkElement_focusDiv.nextSibling;this.checkBorderStyle=this.checkElement_img.getAttribute("checkborderstyle");this.unCheckBorderStyle=this.checkElement_img.getAttribute("uncheckborderstyle");if(null!=this.checkBorderStyle){this.checkBorderStyle=this.checkBorderStyle.replace(/\;/g,"");this.unCheckBorderStyle=this.unCheckBorderStyle.replace(/\;/g,"");}if(this.eform.m_RuleCtrlVisible){if(null!=this.checkElement_div){var b=this.checkElement_div.parentElement;if(null!=b){var f=document.createElement("div");f.style.position="absolute";f.style.left=b.style.left;f.style.top=b.style.top;f.style.width=b.style.width;f.style.height=b.style.height;f.style.color="red";f.style.fontSize="8pt";f.style.fontWeight="bold";var c=this.ctrlID;if(-1!=c.indexOf(".")){c=c.substring(c.indexOf(".")+1);}c=decodeURI(c.replace(/[r]/g,"%"));c=c.substring(0,c.lastIndexOf("_"));f.innerHTML=c+" ("+this.controlData.id+")";var g=b.parentElement;var a=b.nextSibling;if(null!=a){g.insertBefore(f,a);}else{g.appendChild(f);}}}}if(null==this.title){this.title=this.checkElement.title;}else{this.checkElement.title=this.title;}if(null==this.controlData.isNValue&&this.controlData.isNecessaryCheck=="true"){this.controlData.isNValue=true;if("true"==this.controlData.checked){this.controlData.is_nc=false;}}else{if(this.eform.eForm_isNecessary.check&&this.controlData.is_nc){if("true"!=this.controlData.checked){this.checkElement_div.className="eF_Rect eForm_NecessaryCheck";}}}if("true"==this.controlData.checked){this.checkElement.checked=true;if("check"==this.controlData.imageType){this.checkElement_img.src=this.eform.eFormCheckImage;}else{this.checkElement_img.src=this.eform.eFormRadioImage;}if(null!=this.checkBorderStyle){this.checkElement_img.style.border=this.checkBorderStyle;}}else{this.checkElement_img.src="data:image/png;base64,"+mRe_blankImg;if(null!=this.unCheckBorderStyle){this.checkElement_img.style.border=this.unCheckBorderStyle;}}var d=this;this.checkElement.onmousedown=function(h){var i=false;if("which" in h){i=h.which==3;}else{if("button" in h){i=h.button==2;}}if(i){h.preventDefault();return;}this.focus();if(d.eform.mRe_MainNecessaryInputEnabledCheckControl(d)){if(d.eform.m_isUsePopupInputFrame.check){d.callFrameCheckbox();}else{if(!d.eform.m_isObjJSONViewAccessibility){if("true"!=d.controlData.checked){d.check(true);}else{d.unCheck(true);}}}}h.preventDefault();};this.checkElement.onchange=function(h){if(!d.eform.m_isUsePopupInputFrame.check){if(d.eform.m_isObjJSONViewAccessibility){if(this.checked){d.check(true);}else{d.unCheck(true);}}}};this.checkElement.onkeyup=function(h){if(32==h.keyCode||13==h.keyCode){this.focus();if(d.eform.mRe_MainNecessaryInputEnabledCheckControl(d)){if(d.eform.m_isUsePopupInputFrame.check){d.callFrameCheckbox();}else{if("true"!=d.controlData.checked){d.check(true);}else{d.unCheck(true);}}}h.preventDefault();}};if(null!=this.checkElement_focusDiv){this.checkElement.onblur=function(){if(null!=d.checkElement_focusDiv){d.checkElement_focusDiv.className="eF_Rect";d.eform.inputImagePointerOut();if(d.eform.multiView.isSocket){d.eform.multiView.socket.sendFocusControl(d,"out");}}};this.checkElement.onfocus=function(){d.focusControl();if(d.eform.multiView.isSocket){d.eform.multiView.socket.sendFocusControl(d,"in");}};}this.m_setBGColor();this.setDisabled(this.controlData.disable,false);this.setVisible(this.controlData.visible,false);};EFormCheckbox.prototype.getCtrlID=function(){return this.ctrlID;};EFormCheckbox.prototype.getType=function(){return this.controlData.type;};EFormCheckbox.prototype.unCheck=function(a){if(typeof a=="undefined"){a=true;}if(!this.isChecked()){return;}this.m_default_unCheck(a);if(this.eform.multiView.isSocket){this.eform.multiView.socket.sendInputCheckbox(this,"unCheck",a);}};EFormCheckbox.prototype.m_default_unCheck=function(g,f){if(this.isDOM){this.checkElement.checked=false;this.checkElement_img.src="data:image/png;base64,"+mRe_blankImg;if(null!=this.unCheckBorderStyle){this.checkElement_img.style.border=this.unCheckBorderStyle;}}this.controlData.checked="false";if(this.controlData.isNValue){this.controlData.is_nc=true;if(this.isDOM){var b=this.controlData.isNecessaryCheck=="true"?" eForm_inputNecessary":"";if(this.getDisabled()){this.checkElement_div.className="eF_Rect eForm_inputDisabled "+this.disabledClass;}else{if(this.eform.eForm_isNecessary.check){this.checkElement_div.className="eF_Rect eForm_NecessaryCheck";}else{this.checkElement_div.className="eF_Rect eForm_inputDefault_bg"+b;}}}}this.requiredUnCheckInGroup();this.onUnChecked(g);if(this.controlData.repeatSync){if(typeof f=="undefined"){f=true;}if(f){var a=eform.findCloneControl(this);for(var d=0;d<a.length;d++){a[d].m_default_unCheck(g,false);}}}if(typeof getControlEventRulesCommand!="undefined"&&g){if((this.eform.multiView.isSocket&&this.eform.isMain)||!this.eform.multiView.isSocket){var c={};c.uid=this.eform.m_uid;c.reportName=this.controlData.rName;c.inputID=this.controlData.id;c.type="checkbox";c.event="unChecked";c.isChecked=false;c.disabled=this.controlData.disable;c.visible=this.controlData.visible;c.value=this.controlData.value;c.isNecessaryCheck="true"==this.controlData.isNecessaryCheck;c.isNecessaryChecked=!this.controlData.is_nc;c.sectionName=this.controlData.sName?this.controlData.sName:"";getControlEventRulesCommand(c,false);}}};EFormCheckbox.prototype.requiredUnCheckInGroup=function(){var b=false;var g=new Object();for(var f in this.eform.eFormData){var d=this.eform.eFormData[f];if(this.controlData.id==d.id){if(d.checked=="true"){b=true;}g[f]=d;}}for(var a in g){var d=g[a];if(d.requiredCheckInGroup){if(d.isNecessaryCheck=="true"){if(b){d.is_nc=false;if(d.isNValue){var h=this.eform.eFormControlList[a];if(h.isDOM){if(h.getDisabled()){h.checkElement_div.className="eF_Rect eForm_inputDisabled "+h.disabledClass;}else{var c=h.controlData.isNecessaryCheck=="true"?" eForm_inputNecessary":"";h.checkElement_div.className="eF_Rect eForm_inputDefault_bg"+c;}}}}else{d.is_nc=true;if(d.isNValue){if(this.eform.eForm_isNecessary.check){var h=this.eform.eFormControlList[a];if(h.isDOM){if(h.getDisabled()){h.checkElement_div.className="eF_Rect eForm_inputDisabled "+h.disabledClass;}else{h.checkElement_div.className="eF_Rect eForm_NecessaryCheck";}}}}}}}}};EFormCheckbox.prototype.check=function(a){if(typeof a=="undefined"){a=true;}if(this.isChecked()){return;}this.m_default_check(a);if(this.eform.multiView.isSocket){this.eform.multiView.socket.sendInputCheckbox(this,"check",a);}if(this.controlData.isAutoNextFocus&&!this.eform.m_isUsePopupInputFrame.check){this.eform.nextHybridInputControl(this);}};EFormCheckbox.prototype.getPageNumber=function(){if(typeof this.controlData.pageNumber=="undefined"){return null;}return this.controlData.pageNumber+1;};EFormCheckbox.prototype.focus=function(){if(this.isDOM){var a=this.checkElement;setTimeout(function(){a.focus();},1);}else{if(!this.eform.isEasyInput){this.eform.m_isrulesControlInfo=this.ctrlID;this.eform.sendRulesControlInfo();this.eform.selectPage(this.controlData.pageNumber,"control_focus");}}};EFormCheckbox.prototype.m_default_check=function(g,f){if(this.isDOM){this.checkElement.checked=true;if("check"==this.controlData.imageType){this.checkElement_img.src=this.eform.eFormCheckImage;}else{this.checkElement_img.src=this.eform.eFormRadioImage;}if(null!=this.checkBorderStyle){this.checkElement_img.style.border=this.checkBorderStyle;}}this.controlData.checked="true";this.controlData.is_nc=false;if(this.controlData.isNValue){if(this.isDOM){if(this.getDisabled()){this.checkElement_div.className="eF_Rect eForm_inputDisabled "+this.disabledClass;}else{var b=this.controlData.isNecessaryCheck=="true"?" eForm_inputNecessary":"";this.checkElement_div.className="eF_Rect eForm_inputDefault_bg"+b;}}}this.requiredCheckInGroup();this.onChecked(g);if(this.controlData.repeatSync){if(typeof f=="undefined"){f=true;}if(f){var a=eform.findCloneControl(this);for(var d=0;d<a.length;d++){a[d].m_default_check(g,false);}}}if(typeof getControlEventRulesCommand!="undefined"&&g){if((this.eform.multiView.isSocket&&this.eform.isMain)||!this.eform.multiView.isSocket){var c={};c.uid=this.eform.m_uid;c.reportName=this.controlData.rName;c.inputID=this.controlData.id;c.type="checkbox";c.event="checked";c.isChecked=true;c.disabled=this.controlData.disable;c.visible=this.controlData.visible;c.value=this.controlData.value;c.isNecessaryCheck="true"==this.controlData.isNecessaryCheck;c.isNecessaryChecked=!this.controlData.is_nc;c.sectionName=this.controlData.sName?this.controlData.sName:"";getControlEventRulesCommand(c,false);}}};EFormCheckbox.prototype.requiredCheckInGroup=function(){for(var c in this.eform.eFormData){var b=this.eform.eFormData[c];if(this.controlData.id==b.id&&b.requiredCheckInGroup){b.is_nc=false;if(b.isNValue){var d=this.eform.eFormControlList[c];if(d.isDOM){var a=d.controlData.isNecessaryCheck=="true"?" eForm_inputNecessary":"";d.checkElement_div.className="eF_Rect eForm_inputDefault_bg"+a;}}}}};EFormCheckbox.prototype.isChecked=function(){return this.controlData.checked=="true";};EFormCheckbox.prototype.getValue=function(){if(this.controlData.useFalseValue){if(this.isChecked()){return this.controlData.value;}else{return this.controlData.falseValue;}}else{return this.controlData.value;}};EFormCheckbox.prototype.getVisible=function(){return this.controlData.visible;};EFormCheckbox.prototype.setVisible=function(a,b){if(typeof b=="undefined"){b=false;}this.controlData.visible=a;if(this.isDOM){if(a){this.checkElement.style.display="";this.checkElement_img.style.display="";this.checkElement_div.style.display="";this.checkElement_focusDiv.style.display="";if(this.eform.m_eformCheckLabelVisible){this.checkElement_text.style.display="";}}else{this.checkElement.style.display="none";this.checkElement_img.style.display="none";this.checkElement_div.style.display="none";this.checkElement_focusDiv.style.display="none";if(this.eform.m_eformCheckLabelVisible){this.checkElement_text.style.display="none";}}}if(b){if(this.eform.multiView.isSocket){this.eform.multiView.socket.sendVisibled(this,a);}}};EFormCheckbox.prototype.setDisabledClass=function(a){this.disabledClass=a;if(this.isDOM){this.setDisabled(this.controlData.disable,false);}};EFormCheckbox.prototype.getDisabled=function(){var b=this.eform.isEasyInput?0:this.controlData.pageNumber;var a=this.eform.m_eformPageDisabled[b];if(null==a){a=false;}return this.controlData.disable||a||this.eform.m_eformDisabled;};EFormCheckbox.prototype.setDisabled=function(g,h,f){if(typeof h=="undefined"){h=false;}if(typeof f=="undefined"){f=true;}this.controlData.disable=g;var c=g;if(this.isDOM){var d=this.eform.isEasyInput?0:this.controlData.pageNumber;var a=this.eform.m_eformPageDisabled[d];if(null==a){a=false;}if(g||a||this.eform.m_eformDisabled){c=true;this.checkElement.disabled=true;this.checkElement_div.className="eF_Rect eForm_inputDisabled "+this.disabledClass;this.setDisabledElement(true);}else{c=false;this.checkElement.disabled=false;if(this.eform.eForm_isNecessary.check&&this.controlData.isNecessaryCheck=="true"&&this.controlData.is_nc){this.checkElement_div.className="eF_Rect eForm_NecessaryCheck";}else{var b=this.controlData.isNecessaryCheck=="true"?" eForm_inputNecessary":"";this.checkElement_div.className="eF_Rect eForm_inputDefault_bg"+b;}this.setDisabledElement(false);}}if(h){if(this.eform.multiView.isSocket){this.eform.multiView.socket.sendDisabled(this,g);}}if(null!=this.eform.ctrlEvent.disabledEvent&&f){this.eform.ctrlEvent.disabledEvent(c,this);}};EFormCheckbox.prototype.setDisabledElement=function(k){if(null!=this.checkElement_text){var l=this.checkElement_text.children;var d=l.length;for(var f=0;f<d;f++){var c=l[f];if(c.tagName=="svg"){var i=$(c).find("text");var a=i.length;for(var b=0;b<a;b++){var j=i[b];var h=j.className;if(k){var g=h.animVal;g+=" eForm_selectDisabled";h.animVal=g;h.baseVal=g;}else{var g=h.animVal;g=g.replace(/\seForm_selectDisabled/g,"");h.animVal=g;h.baseVal=g;}}}else{var g=c.className;if(k){g+=" eForm_selectDisabled";c.className=g;}else{g=g.replace(/\seForm_selectDisabled/g,"");c.className=g;}}}}if(this.isDOM){if(k){this.checkElement_img.className="eForm_selectBorderDisabled";}else{this.checkElement_img.className="";}}};EFormCheckbox.prototype.setGuideBGColor=function(b,a,d,c,f){if(typeof f=="undefined"){f=true;}this.controlData.bgColor="rgba("+b+","+a+","+d+","+c+")";if(this.isDOM){this.checkElement_div.style.backgroundColor=this.controlData.bgColor;}if(this.eform.multiView.isSocket&&f){this.eform.multiView.socket.sendControlColor(this,b,a,d,c);}};EFormCheckbox.prototype.m_setBGColor=function(){if(null!=this.controlData.bgColor){if(this.isDOM){this.checkElement_div.style.backgroundColor=this.controlData.bgColor;}}};EFormCheckbox.prototype.setNecessaryCheck=function(a,b){if(typeof b=="undefined"){b=false;}if(a){this.controlData.isNValue=true;this.controlData.isNecessaryCheck="true";if("true"==this.controlData.checked){this.controlData.is_nc=false;if(this.isDOM){this.checkElement_div.className="eF_Rect";}}else{this.controlData.is_nc=true;this.requiredUnCheckInGroup();}}else{this.controlData.isNValue=false;this.controlData.is_nc=false;this.controlData.isNecessaryCheck="false";if(this.isDOM){this.checkElement_div.className="eF_Rect";}}this.setDisabled(this.controlData.disable,false);this.setVisible(this.controlData.visible,false);if(b){if(this.eform.multiView.isSocket){this.eform.multiView.socket.sendNecessaryCheck(this,a);}}};EFormCheckbox.prototype.getIndexOrderDisabled=function(){return this.controlData.indexOrderDisable;};EFormCheckbox.prototype.setIndexOrderDisabled=function(a){this.controlData.indexOrderDisable=a;};EFormCheckbox.prototype.onUnCheckedEvent=function(a){this.event.unCheckedEvent=a;this.event.eventTarget=this;};EFormCheckbox.prototype.onCheckedEvent=function(a){this.event.checkedEvent=a;this.event.eventTarget=this;};EFormCheckbox.prototype.getTitle=function(){return this.title;};EFormCheckbox.prototype.setTitle=function(a){this.title=a;if(this.isDOM){this.checkElement.title=a;}};EFormCheckbox.prototype.setAutoNextFocus=function(a){this.controlData.isAutoNextFocus=a;};EFormCheckbox.prototype.onUnChecked=function(b){if(b){var a=this;window.setTimeout(function(){if(null!=a.event.unCheckedEvent){a.event.unCheckedEvent(a);}if(null!=a.eform.ctrlEvent.checkboxUnCheckedEvent){a.eform.ctrlEvent.checkboxUnCheckedEvent(a);}},10);}};EFormCheckbox.prototype.onChecked=function(b){if(b){var a=this;window.setTimeout(function(){if(null!=a.event.checkedEvent){a.event.checkedEvent(a);}if(null!=a.eform.ctrlEvent.checkboxCheckedEvent){a.eform.ctrlEvent.checkboxCheckedEvent(a);}},10);}};EFormCheckbox.prototype.focusControl=function(){this.eform.mRe_inputFocusRectBlur();this.checkElement_focusDiv.className="eF_Rect eform_control_focus";this.eform.inputImagePointerIn(this);if(this.eform.titleSpeechBubble.visible.checkbox){this.eform.inputCreateTitleSpeechBubble(this);}else{this.eform.inputRemoveTitleSpeechBubble();}if(this.eform.m_isHybridQuickControl||null!=this.controlData.inputOrder){this.eform.inputOrderFoucs(this);}else{this.eform.inputOrderBlur();}if(this.eform.m_isUsePopupInputFrame.check){this.callFrameCheckbox();}};EFormCheckbox.prototype.callFrameCheckbox=function(){if(!this.eform.m_isUsePopupInputFrame.check||null!=this.eform.signPaintDiv){return;}var v=this;var u=this.eform;u.inputOrderFoucs(this);var k=null;if(u.multiView.isSocket){k=u.multiView.socket;k.sendScreenLock("key",u.m_uid);}u.disabledMenu(true);Re_zoom.isPop=true;var a=310;var m=document.createElement("div");m.className="m_eform_popup_background";m.style.background="rgba(155,155,155,0.3)";m.addEventListener("touchstart",function(i){if(i.touches.length>1){i.preventDefault();}},false);var c=document.createElement("div");if(u.m_isBottomPopHeight>0){c.style.height=(a)+"px";}else{c.style.height=(a<230?210:a)+"px";}c.className="eform_popup_body";var p=document.createElement("div");p.className="eform_popup_header";var j=document.createElement("div");j.className="eform_popup_header_Label";var w=document.createElement("nobr");j.appendChild(w);var o=document.createElement("button");o.className="eform_popup_close_button";var b=document.createElement("button");b.className="eform_popup_save_button";var z=document.createElement("button");z.className="eform_popup_next_button";p.appendChild(j);p.appendChild(o);p.appendChild(b);p.appendChild(z);c.appendChild(p);m.appendChild(c);u.m_bodyDiv.appendChild(m);u.signPaintDiv=m;var s=document.createElement("div");s.className="eform_popup_frame";s.style.left="0px";s.style.right="0px";c.appendChild(s);var t=document.createElement("div");t.className="eform_popup_frame_Label";var l=document.createElement("nobr");t.appendChild(l);s.appendChild(t);var f=document.createElement("button");f.className="eform_popup_frameReset_button";s.appendChild(f);var y=document.createElement("div");y.className="eform_popup_frame_body";s.appendChild(y);var d=this.group.getControlList();var q=new Array();for(var r=0;r<d.length;r++){var h=d[r];if(this.controlData.rName==h.controlData.rName&&h.controlData.visible&&!h.controlData.disable){q.push(h);}}var n=new Array();var g=100/(Math.ceil(q.length/3));for(var r=0;r<q.length;r++){var h=q[r];if(""!=h.controlData.title){n.push(h.controlData.title);}var x=document.createElement("input");x.type="checkbox";x.style.left=(33*(r%3))+"%";x.style.top=(g*(Math.floor(r/3)))+"%";x.style.height=g+"%";x.style.width="4%";x.id="popupcheck"+r;x.setAttribute("targetName",h.ctrlID);if(h.controlData.checked=="true"){x.checked=true;}y.appendChild(x);t=document.createElement("label");t.style.left=((33*(r%3))+4)+"%";t.style.top=(g*(Math.floor(r/3)))+"%";t.style.height=g+"%";t.style.width="27%";t.setAttribute("for","popupcheck"+r);t.innerHTML=h.controlData.label;y.appendChild(t);}l.innerHTML=n.join("/");f.onclick=function(){var B=y.querySelectorAll("input");for(var A=0;A<B.length;A++){B[A].checked=false;}};window.mRe_popupInput_close=o;o.onclick=function(){u.signPaintDiv=null;mRe_reSetPopupStatus();u.m_bodyDiv.removeChild(m);u.disabledMenu(false);if(null!=k){k.sendScreenUnLock(u.m_uid);}};b.onclick=function(){var B=y.querySelectorAll("input");for(var A=0;A<B.length;A++){if(B[A].checked){u.eFormControlList[B[A].getAttribute("targetName")].check(true);}else{u.eFormControlList[B[A].getAttribute("targetName")].unCheck(true);}}u.signPaintDiv=null;mRe_reSetPopupStatus();u.m_bodyDiv.removeChild(m);u.disabledMenu(false);if(v.eform.multiView.isSocket){v.eform.multiView.socket.sendFocusControl(v,"out");}if(null!=k){k.sendScreenUnLock(u.m_uid);}};z.onclick=function(){var C=y.querySelectorAll("input");for(var B=0;B<C.length;B++){if(C[B].checked){u.eFormControlList[C[B].getAttribute("targetName")].check(true);}else{u.eFormControlList[C[B].getAttribute("targetName")].unCheck(true);}}u.signPaintDiv=null;mRe_reSetPopupStatus();u.m_bodyDiv.removeChild(m);u.disabledMenu(false);if(v.eform.multiView.isSocket){v.eform.multiView.socket.sendFocusControl(v,"out");}if(v.controlData.isAutoNextFocus){var A=v.eform.nextHybridInputControl(v);if(!A){v.eform.nextEasyInputControl(v);}}if(null!=k){k.sendScreenUnLock(u.m_uid);}};};EFormCheckbox.prototype.multiViewFocus=function(){if(null==mRe_FocusControl.objCtrl||mRe_FocusControl.objCtrl!=this){mRe_FocusControl.objCtrl=this;if(this.isDOM){if(this.eform.m_isMultiViewFoucs){this.checkElement.focus();}else{this.eform.mRe_inputFocusRectBlur();this.checkElement_focusDiv.className="eF_Rect eform_control_focus";this.eform.inputImagePointerIn(this);if(this.eform.titleSpeechBubble.visible.checkbox){this.eform.inputCreateTitleSpeechBubble(this);}else{this.eform.inputRemoveTitleSpeechBubble();}if(this.eform.m_isHybridQuickControl){this.eform.inputOrderFoucs(this);}}}}};EFormCheckbox.prototype.multiViewBlur=function(){mRe_FocusControl={objCtrl:null};if(this.isDOM){this.checkElement_focusDiv.className="eF_Rect";this.eform.inputImagePointerOut();}};function EFormRadiobox(){this.eform=null;this.ctrlID=null;this.controlData=null;this.group=null;this.isDOM=false;this.checkElement=null;this.checkElement_img=null;this.checkElement_div=null;this.checkElement_focusDiv=null;this.checkElement_text=null;this.event={selectedEvent:null,unSelectedEvent:null,selectedClickEvent:null,eventTarget:null};this.title=null;this.bgColor=null;this.disabledClass="";this.checkBorderStyle=null;this.unCheckBorderStyle=null;}EFormRadiobox.prototype.setGroup=function(a){this.group=a;};EFormRadiobox.prototype.init=function(b,a,c){this.eform=c;this.ctrlID=b;this.controlData=a;this.controlData.necessaryMessage=a.necessaryMessage.replace(/\\\//g,"/").replace(/\\\\/g,"\\").replace(/\\\"/g,'"');if(null!=a.inputOrder){this.eform.eFormIndexControlList[a.inputOrder]=this;}if(null==a.indexOrderDisable){a.indexOrderDisable=false;}if(null==a.isToView){a.isToView=true;}if(null==a.isToEasyMode){a.isToEasyMode=true;}if(c.isEasyInput&&a.isToEasyMode){a.isToView=true;}if(!a.isToView){a.is_nc=false;}if(null==a.isAutoNextFocus){a.isAutoNextFocus=true;}if(null==a.repeatSync){a.repeatSync=false;}if(null!=a.title){this.controlData.title=a.title.replace(/\\\//g,"/").replace(/\\\\/g,"\\").replace(/\\\"/g,'"');this.title=this.controlData.title;}else{this.controlData.title="";}if(null!=a.label){this.controlData.label=a.label.replace(/\\\//g,"/").replace(/\\\\/g,"\\").replace(/\\\"/g,'"');this.label=this.controlData.label;}else{this.controlData.label="";}this.controlData.isLabelVisibleSync=false;if(this.eform.m_eformCheckLabelVisible){this.controlData.isLabelVisibleSync=true;}if(null==a.sName){a.sName="";}};EFormRadiobox.prototype.deleteMe=function(){this.eform=null;this.ctrlID=null;this.controlData=null;this.event=null;this.group=null;this.deleteDOM();};EFormRadiobox.prototype.resetDOM=function(){this.isDOM=false;this.checkElement=null;this.checkElement_img=null;this.checkElement_div=null;this.checkElement_focusDiv=null;this.checkElement_text=null;};EFormRadiobox.prototype.deleteDOM=function(){if(this.checkElement){if(this.checkElement.parentElement){this.checkElement.parentElement.removeChild(this.checkElement);}else{delete this.checkElement;}}if(this.checkElement_img){if(this.checkElement_img.parentElement){this.checkElement_img.parentElement.removeChild(this.checkElement_img);}else{delete this.checkElement_img;}}if(this.checkElement_div){if(this.checkElement_div.parentElement){this.checkElement_div.parentElement.removeChild(this.checkElement_div);}else{delete this.checkElement_div;}}if(this.checkElement_focusDiv){if(this.checkElement_focusDiv.parentElement){this.checkElement_focusDiv.parentElement.removeChild(this.checkElement_focusDiv);}else{delete this.checkElement_focusDiv;}}this.resetDOM();};EFormRadiobox.prototype.getRect=function(){if(this.isDOM){var b={left:0,top:0,width:0,height:0};var d=this.checkElement;var c=d.parentElement.offsetLeft;var a=d.parentElement.offsetTop;b.left=c+d.offsetLeft;b.top=a+d.offsetTop;b.width=d.offsetWidth;b.height=d.offsetHeight;return b;}return null;};EFormRadiobox.prototype.getHE=function(){if(this.isDOM){return this.checkElement;}return null;};EFormRadiobox.prototype.eventHandlerInputRadiobox=function(){if(!this.controlData.isToView){return;}if(typeof this.controlData.pageNumber=="undefined"){this.controlData.pageNumber=this.eform.beforePageIndex;}this.isDOM=true;this.checkElement=document.getElementById(this.eform.m_uid+this.ctrlID);this.checkElement_img=document.getElementById(this.eform.m_uid+this.ctrlID+"IMG");this.checkElement_div=document.getElementById(this.eform.m_uid+this.ctrlID+"DIV");this.checkElement_focusDiv=document.getElementById(this.eform.m_uid+this.ctrlID+"FOCUS");this.checkElement_text=this.checkElement_focusDiv.nextSibling;this.checkElement_img.src="data:image/png;base64,"+mRe_blankImg;this.checkBorderStyle=this.checkElement_img.getAttribute("checkborderstyle");this.unCheckBorderStyle=this.checkElement_img.getAttribute("uncheckborderstyle");if(null!=this.checkBorderStyle){this.checkBorderStyle=this.checkBorderStyle.replace(/\;/g,"");this.unCheckBorderStyle=this.unCheckBorderStyle.replace(/\;/g,"");}if(this.eform.m_RuleCtrlVisible){if(null!=this.checkElement_div){var b=this.checkElement_div.parentElement;if(null!=b){var f=document.createElement("div");f.style.position="absolute";f.style.left=b.style.left;f.style.top=b.style.top;f.style.width=b.style.width;f.style.height=b.style.height;f.style.color="red";f.style.fontSize="8pt";f.style.fontWeight="bold";var d=this.ctrlID;if(-1!=d.indexOf(".")){d=d.substring(d.indexOf(".")+1);}d=decodeURI(d.replace(/[r]/g,"%"));d=d.substring(0,d.lastIndexOf("_"));f.innerHTML=d+" ("+this.controlData.id+")";var h=b.parentElement;var a=b.nextSibling;if(null!=a){h.insertBefore(f,a);}else{h.appendChild(f);}}}}if(null==this.title){this.title=this.checkElement.title;}else{this.checkElement.title=this.title;}var c=this.eform.eFormRadioChecked[this.controlData.id+this.controlData.rName];this.checkElement.type="radio";this.checkElement.name=this.controlData.id+this.controlData.rName;if(this.eform.eForm_isNecessary.check&&null==c&&"true"==this.controlData.isNecessaryCheck){this.checkElement_div.className="eF_Rect eForm_NecessaryCheck";}var g=this;if(null!=c&&this.ctrlID!=c){this.controlData.checked="false";this.controlData.is_nc=false;this.checkElement.checked=false;}else{if("true"==this.controlData.checked){this.checkElement.checked=true;if("check"==this.controlData.imageType){this.checkElement_img.src=this.eform.eFormCheckImage;}else{this.checkElement_img.src=this.eform.eFormRadioImage;}if(null!=this.checkBorderStyle){this.checkElement_img.style.border=this.checkBorderStyle;}this.eform.eFormRadioChecked[this.controlData.id+this.controlData.rName]=this.ctrlID;this.controlData.is_nc=false;}}this.checkElement.onmousedown=function(i){var j=false;if("which" in i){j=i.which==3;}else{if("button" in i){j=i.button==2;}}if(j){i.preventDefault();return;}this.focus();if(g.eform.mRe_MainNecessaryInputEnabledCheckControl(g)){if(g.eform.m_isUsePopupInputFrame.radio){g.callFrameRadiobox();}else{if(!g.eform.m_isObjJSONViewAccessibility){g.select(true,true);}}}i.preventDefault();};this.checkElement.onchange=function(){if(!g.eform.m_isUsePopupInputFrame.radio){if(g.eform.m_isObjJSONViewAccessibility){if(this.checked){g.select(true,true);}}}};this.checkElement.onkeyup=function(i){if(32==i.keyCode||13==i.keyCode){this.focus();if(g.eform.mRe_MainNecessaryInputEnabledCheckControl(g)){if(g.eform.m_isUsePopupInputFrame.radio){g.callFrameRadiobox();}else{g.select(true,true);}}i.preventDefault();}};if(null!=this.checkElement_focusDiv){this.checkElement.onblur=function(){if(null!=g.checkElement_focusDiv){g.checkElement_focusDiv.className="eF_Rect";g.eform.inputImagePointerOut();if(g.eform.multiView.isSocket){g.eform.multiView.socket.sendFocusControl(g,"out");}}};this.checkElement.onfocus=function(){g.focusControl();if(g.eform.multiView.isSocket){g.eform.multiView.socket.sendFocusControl(g,"in");}};}this.m_setBGColor();this.setDisabled(this.controlData.disable,false);this.setVisible(this.controlData.visible,false);};EFormRadiobox.prototype.isSelected=function(){return this.controlData.checked=="true";};EFormRadiobox.prototype.select=function(b,a){if(typeof b=="undefined"){b=true;}if(typeof a=="undefined"){a=false;}if(this.isSelected()&&this.controlData.isAutoNextFocus){if(a){this.onSelectedClick(b,true);}if(!this.controlData.is_nc){this.eform.nextHybridInputControl(this);}return;}this.m_default_select(b,a);if(this.eform.multiView.isSocket){this.eform.multiView.socket.sendInputRadiobox(this,b);}if(this.controlData.isAutoNextFocus&&!this.eform.m_isUsePopupInputFrame.radio){if(!this.controlData.is_nc){this.eform.nextHybridInputControl(this);}}};EFormRadiobox.prototype.m_default_select=function(h,f,g){if("false"==this.controlData.checked){if(this.isDOM){this.checkElement.checked=true;if("check"==this.controlData.imageType){this.checkElement_img.src=this.eform.eFormCheckImage;}else{this.checkElement_img.src=this.eform.eFormRadioImage;}if(null!=this.checkBorderStyle){this.checkElement_img.style.border=this.checkBorderStyle;}}this.controlData.checked="true";this.controlData.is_nc=false;if(this.isDOM){if(this.getDisabled()){this.checkElement_div.className="eF_Rect eForm_inputDisabled "+this.disabledClass;}else{var b=this.controlData.isNecessaryCheck=="true"?" eForm_inputNecessary":"";this.checkElement_div.className="eF_Rect eForm_inputDefault_bg"+b;}}this.eform.eFormRadioChecked[this.controlData.id+this.controlData.rName]=this.ctrlID;this.onSelected(h);this.findUnCheckRadio(h);}else{this.findUnCheckRadio(h);if(f){this.onSelectedClick(h,true);}}if(this.controlData.repeatSync){if(typeof g=="undefined"){g=true;}if(g){var a=eform.findCloneControl(this);for(var d=0;d<a.length;d++){if(this.controlData.id!=a[d].controlData.id){a[d].m_default_select(h,f,false);}}}}if(typeof getControlEventRulesCommand!="undefined"&&h){if((this.eform.multiView.isSocket&&this.eform.isMain)||!this.eform.multiView.isSocket){var c={};c.uid=this.eform.m_uid;c.reportName=this.controlData.rName;c.inputID=this.controlData.id;c.type="radiobox";c.event="change";c.isSelected=true;c.disabled=this.controlData.disable;c.visible=this.controlData.visible;c.value=this.controlData.value;c.isNecessaryCheck="true"==this.controlData.isNecessaryCheck;c.isNecessaryChecked=!this.controlData.is_nc;c.sectionName=this.controlData.sName?this.controlData.sName:"";getControlEventRulesCommand(c,false);}}};EFormRadiobox.prototype.findUnCheckRadio=function(f){var c=this.group.getControlList();for(var b=0;b<c.length;b++){var d=c[b];if(this!=d&&this.controlData.rName==d.controlData.rName){d.controlData.checked="false";d.controlData.is_nc=false;if(null!=d.checkElement_img&&null!=d.checkElement_div){d.checkElement_img.src="data:image/png;base64,"+mRe_blankImg;if(null!=d.unCheckBorderStyle){d.checkElement_img.style.border=d.unCheckBorderStyle;}if(d.getDisabled()){d.checkElement_div.className="eF_Rect eForm_inputDisabled "+d.disabledClass;}else{var a=d.controlData.isNecessaryCheck=="true"?" eForm_inputNecessary":"";d.checkElement_div.className="eF_Rect eForm_inputDefault_bg"+a;}}d.onUnSelected(f);}}};EFormRadiobox.prototype.getCtrlID=function(){return this.ctrlID;};EFormRadiobox.prototype.getType=function(){return this.controlData.type;};EFormRadiobox.prototype.getValue=function(){return this.controlData.value;};EFormRadiobox.prototype.getVisible=function(){return this.controlData.visible;};EFormRadiobox.prototype.setVisible=function(a,b){if(typeof b=="undefined"){b=false;}this.controlData.visible=a;if(this.isDOM){if(a){this.checkElement.style.display="";this.checkElement_img.style.display="";this.checkElement_div.style.display="";this.checkElement_focusDiv.style.display="";if(this.eform.m_eformCheckLabelVisible){this.checkElement_text.style.display="";}}else{this.checkElement.style.display="none";this.checkElement_img.style.display="none";this.checkElement_div.style.display="none";this.checkElement_focusDiv.style.display="none";if(this.eform.m_eformCheckLabelVisible){this.checkElement_text.style.display="none";}}}if(b){if(this.eform.multiView.isSocket){this.eform.multiView.socket.sendVisibled(this,a);}}};EFormRadiobox.prototype.setDisabledClass=function(a){this.disabledClass=a;if(this.isDOM){this.setDisabled(this.controlData.disable,false);}};EFormRadiobox.prototype.getDisabled=function(){var b=this.eform.isEasyInput?0:this.controlData.pageNumber;var a=this.eform.m_eformPageDisabled[b];if(null==a){a=false;}return this.controlData.disable||a||this.eform.m_eformDisabled;};EFormRadiobox.prototype.setDisabled=function(g,h,f){if(typeof h=="undefined"){h=false;}if(typeof f=="undefined"){f=true;}this.controlData.disable=g;var c=g;if(this.isDOM){var d=this.eform.isEasyInput?0:this.controlData.pageNumber;var a=this.eform.m_eformPageDisabled[d];if(null==a){a=false;}if(g||a||this.eform.m_eformDisabled){c=true;this.checkElement.disabled=true;this.checkElement_div.className="eF_Rect eForm_inputDisabled "+this.disabledClass;this.setDisabledElement(true);}else{c=false;this.checkElement.disabled=false;if(this.eform.eForm_isNecessary.check&&this.controlData.isNecessaryCheck=="true"&&this.controlData.is_nc){this.checkElement_div.className="eF_Rect eForm_NecessaryCheck";}else{var b=this.controlData.isNecessaryCheck=="true"?" eForm_inputNecessary":"";this.checkElement_div.className="eF_Rect eForm_inputDefault_bg"+b;}this.setDisabledElement(false);}}if(h){if(this.eform.multiView.isSocket){this.eform.multiView.socket.sendDisabled(this,g);}}if(null!=this.eform.ctrlEvent.disabledEvent&&f){this.eform.ctrlEvent.disabledEvent(c,this);}};EFormRadiobox.prototype.setDisabledElement=function(k){if(null!=this.checkElement_text){var l=this.checkElement_text.children;var d=l.length;for(var f=0;f<d;f++){var c=l[f];if(c.tagName=="svg"){var i=$(c).find("text");var a=i.length;for(var b=0;b<a;b++){var j=i[b];var h=j.className;if(k){var g=h.animVal;g+=" eForm_selectDisabled";h.animVal=g;h.baseVal=g;}else{var g=h.animVal;g=g.replace(/\seForm_selectDisabled/g,"");h.animVal=g;h.baseVal=g;}}}else{var g=c.className;if(k){g+=" eForm_selectDisabled";c.className=g;}else{g=g.replace(/\seForm_selectDisabled/g,"");c.className=g;}}}}if(this.isDOM){if(k){this.checkElement_img.className="eForm_selectBorderDisabled";}else{this.checkElement_img.className="";}}};EFormRadiobox.prototype.setGuideBGColor=function(b,a,d,c,f){if(typeof f=="undefined"){f=true;}this.controlData.bgColor="rgba("+b+","+a+","+d+","+c+")";if(this.isDOM){this.checkElement_div.style.backgroundColor=this.controlData.bgColor;}if(this.eform.multiView.isSocket&&f){this.eform.multiView.socket.sendControlColor(this,b,a,d,c);}};EFormRadiobox.prototype.m_setBGColor=function(){if(null!=this.controlData.bgColor){if(this.isDOM){this.checkElement_div.style.backgroundColor=this.controlData.bgColor;}}};EFormRadiobox.prototype.setNecessaryCheck=function(a,b){if(typeof b=="undefined"){b=false;}if(a){this.controlData.isNecessaryCheck="true";if(null!=this.eform.eFormRadioChecked[this.controlData.id+this.controlData.rName]){this.controlData.is_nc=false;if(this.isDOM){this.checkElement_div.className="eF_Rect";}}else{this.controlData.is_nc=true;}}else{this.controlData.is_nc=false;this.controlData.isNecessaryCheck="false";if(this.isDOM){this.checkElement_div.className="eF_Rect";}}this.setDisabled(this.controlData.disable,false);this.setVisible(this.controlData.visible,false);if(b){if(this.eform.multiView.isSocket){this.eform.multiView.socket.sendNecessaryCheck(this,a);}}};EFormRadiobox.prototype.getIndexOrderDisabled=function(){return this.controlData.indexOrderDisable;};EFormRadiobox.prototype.setIndexOrderDisabled=function(a){this.controlData.indexOrderDisable=a;};EFormRadiobox.prototype.onUnSelectedEvent=function(a){this.event.unSelectedEvent=a;this.event.eventTarget=this;};EFormRadiobox.prototype.onSelectedEvent=function(a){this.event.selectedEvent=a;this.event.eventTarget=this;};EFormRadiobox.prototype.onSelectedClickEvent=function(a){this.event.selectedClickEvent=a;this.event.eventTarget=this;};EFormRadiobox.prototype.onSelectedClick=function(a,b){if(typeof b=="undefined"){b=false;}if(a){if(null!=this.event.selectedClickEvent){this.event.selectedClickEvent(this);}if(null!=this.eform.ctrlEvent.radioboxSelectedClickEvent){this.eform.ctrlEvent.radioboxSelectedClickEvent(this);}if(b){if(this.eform.multiView.isSocket){this.eform.multiView.socket.sendSelectedClick(this);}}}};EFormRadiobox.prototype.getTitle=function(){return this.title;};EFormRadiobox.prototype.setTitle=function(a){this.title=a;if(this.isDOM){this.checkElement.title=a;}};EFormRadiobox.prototype.getPageNumber=function(){if(typeof this.controlData.pageNumber=="undefined"){return null;}return this.controlData.pageNumber+1;};EFormRadiobox.prototype.focus=function(){if(this.isDOM){var a=this.checkElement;setTimeout(function(){a.focus();},1);}else{if(!this.eform.isEasyInput){this.eform.m_isrulesControlInfo=this.ctrlID;this.eform.sendRulesControlInfo();this.eform.selectPage(this.controlData.pageNumber,"control_focus");}}};EFormRadiobox.prototype.setAutoNextFocus=function(a){this.controlData.isAutoNextFocus=a;};EFormRadiobox.prototype.onUnSelected=function(b){if(b){var a=this;window.setTimeout(function(){if(null!=a.event.unSelectedEvent){a.event.unSelectedEvent(a);}if(null!=a.eform.ctrlEvent.radioboxUnSelectedEvent){a.eform.ctrlEvent.radioboxUnSelectedEvent(a);}},10);}};EFormRadiobox.prototype.onSelected=function(b){if(b){var a=this;window.setTimeout(function(){if(null!=a.event.selectedEvent){a.event.selectedEvent(a);}if(null!=a.eform.ctrlEvent.radioboxSelectedEvent){a.eform.ctrlEvent.radioboxSelectedEvent(a);}},10);}};EFormRadiobox.prototype.focusControl=function(){this.eform.mRe_inputFocusRectBlur();this.checkElement_focusDiv.className="eF_Rect eform_control_focus";this.eform.inputImagePointerIn(this);if(this.eform.titleSpeechBubble.visible.radiobox){this.eform.inputCreateTitleSpeechBubble(this);}else{this.eform.inputRemoveTitleSpeechBubble();}if(this.eform.m_isHybridQuickControl||null!=this.controlData.inputOrder){this.eform.inputOrderFoucs(this);}else{this.eform.inputOrderBlur();}if(this.eform.m_isUsePopupInputFrame.radio){this.callFrameRadiobox();}};EFormRadiobox.prototype.callFrameRadiobox=function(){if(!this.eform.m_isUsePopupInputFrame.radio||null!=this.eform.signPaintDiv){return;}var x=this;var u=this.eform;u.inputOrderFoucs(this);var k=null;if(u.multiView.isSocket){k=u.multiView.socket;k.sendScreenLock("key",u.m_uid);}u.disabledMenu(true);Re_zoom.isPop=true;var a=310;var m=document.createElement("div");m.className="m_eform_popup_background";m.style.background="rgba(155,155,155,0.3)";m.addEventListener("touchstart",function(i){if(i.touches.length>1){i.preventDefault();}},false);var c=document.createElement("div");if(u.m_isBottomPopHeight>0){c.style.height=(a)+"px";}else{c.style.height=(a<230?210:a)+"px";}c.className="eform_popup_body";var p=document.createElement("div");p.className="eform_popup_header";var j=document.createElement("div");j.className="eform_popup_header_Label";var v=document.createElement("nobr");j.appendChild(v);var o=document.createElement("button");o.className="eform_popup_close_button";var b=document.createElement("button");b.className="eform_popup_save_button";var z=document.createElement("button");z.className="eform_popup_next_button";p.appendChild(j);p.appendChild(o);p.appendChild(b);p.appendChild(z);c.appendChild(p);m.appendChild(c);u.m_bodyDiv.appendChild(m);u.signPaintDiv=m;var s=document.createElement("div");s.className="eform_popup_frame";s.style.left="0px";s.style.right="0px";c.appendChild(s);var t=document.createElement("div");t.className="eform_popup_frame_Label";var l=document.createElement("nobr");t.appendChild(l);s.appendChild(t);var f=document.createElement("button");f.className="eform_popup_frameReset_button";s.appendChild(f);var y=document.createElement("div");y.className="eform_popup_frame_body";s.appendChild(y);var d=this.group.getControlList();var q=new Array();for(var r=0;r<d.length;r++){var h=d[r];if(this.controlData.rName==h.controlData.rName&&h.controlData.visible&&!h.controlData.disable){q.push(h);}}var n=new Array();var g=100/(Math.ceil(q.length/3));for(var r=0;r<q.length;r++){var h=q[r];if(""!=h.controlData.title){n.push(h.controlData.title);}var w=document.createElement("input");w.type="radio";w.style.left=(33*(r%3))+"%";w.style.top=(g*(Math.floor(r/3)))+"%";w.style.height=g+"%";w.style.width="4%";w.id="popupcheck"+r;w.name=h.controlData.id;w.setAttribute("targetName",h.ctrlID);if(h.controlData.checked=="true"){w.checked=true;}y.appendChild(w);t=document.createElement("label");t.style.left=((33*(r%3))+4)+"%";t.style.top=(g*(Math.floor(r/3)))+"%";t.style.height=g+"%";t.style.width="27%";t.setAttribute("for","popupcheck"+r);t.innerHTML=h.controlData.label;y.appendChild(t);}l.innerHTML=n.join("/");f.onclick=function(){var B=y.querySelectorAll("input");for(var A=0;A<B.length;A++){B[A].checked=false;}};window.mRe_popupInput_close=o;o.onclick=function(){u.signPaintDiv=null;mRe_reSetPopupStatus();u.m_bodyDiv.removeChild(m);u.disabledMenu(false);if(null!=k){k.sendScreenUnLock(u.m_uid);}};b.onclick=function(){var B=y.querySelectorAll("input");var C=false;for(var A=0;A<B.length;A++){if(B[A].checked){u.eFormControlList[B[A].getAttribute("targetName")].select(true,true);C=true;}}if(!C){x.group.unSelect(true);}u.signPaintDiv=null;mRe_reSetPopupStatus();u.m_bodyDiv.removeChild(m);u.disabledMenu(false);if(x.eform.multiView.isSocket){x.eform.multiView.socket.sendFocusControl(x,"out");}if(null!=k){k.sendScreenUnLock(u.m_uid);}};z.onclick=function(){var C=y.querySelectorAll("input");var D=false;for(var B=0;B<C.length;B++){if(C[B].checked){u.eFormControlList[C[B].getAttribute("targetName")].select(true,true);D=true;}}if(!D){x.group.unSelect(true);}u.signPaintDiv=null;mRe_reSetPopupStatus();u.m_bodyDiv.removeChild(m);u.disabledMenu(false);if(x.eform.multiView.isSocket){x.eform.multiView.socket.sendFocusControl(x,"out");}if(x.controlData.isAutoNextFocus){var A=x.eform.nextHybridInputControl(x);if(!A){x.eform.nextEasyInputControl(x);}}if(null!=k){k.sendScreenUnLock(u.m_uid);}};};EFormRadiobox.prototype.multiViewFocus=function(){if(null==mRe_FocusControl.objCtrl||mRe_FocusControl.objCtrl!=this){mRe_FocusControl.objCtrl=this;if(this.isDOM){if(this.eform.m_isMultiViewFoucs){this.checkElement.focus();}else{this.eform.mRe_inputFocusRectBlur();this.checkElement_focusDiv.className="eF_Rect eform_control_focus";this.eform.inputImagePointerIn(this);if(this.eform.titleSpeechBubble.visible.radiobox){this.eform.inputCreateTitleSpeechBubble(this);}else{this.eform.inputRemoveTitleSpeechBubble();}if(this.eform.m_isHybridQuickControl){this.eform.inputOrderFoucs(this);}}}}};EFormRadiobox.prototype.multiViewBlur=function(){mRe_FocusControl={objCtrl:null};if(this.isDOM){this.checkElement_focusDiv.className="eF_Rect";this.eform.inputImagePointerOut();}};function EFormImage(){this.eform=null;this.ctrlID=null;this.controlData=null;this.group=null;this.isDOM=false;this.imageElement=null;this.imageElement_canas=null;this.imageElement_guideSpan=null;this.imageElement_focusDiv=null;this.imageElemnet_camera=null;this.event={clickEvent:null,changeEvent:null,eventTarget:null};this.title=null;this.isSendClickEvent=true;this.bgColor=null;this.disabledClass="";}EFormImage.prototype.setGroup=function(a){this.group=a;};EFormImage.prototype.init=function(b,a,c){this.eform=c;this.ctrlID=b;this.controlData=a;this.controlData.necessaryMessage=a.necessaryMessage.replace(/\\\//g,"/").replace(/\\\\/g,"\\").replace(/\\\"/g,'"');if(null!=a.inputOrder){this.eform.eFormIndexControlList[a.inputOrder]=this;}if(null==a.indexOrderDisable){a.indexOrderDisable=false;}if(null==a.isToView){a.isToView=true;}if(null==a.isToEasyMode){a.isToEasyMode=true;}if(c.isEasyInput&&a.isToEasyMode){a.isToView=true;}if(!a.isToView){a.is_nc=false;}if(null==a.imageDrawMethod){a.imageDrawMethod=2;}if(null==a.horizontalAlignment){a.horizontalAlignment=1;}if(null==a.verticalAlignment){a.verticalAlignment=1;}if(null==a.imgRate){a.imgRate=100;}if(null==a.transImg){a.transImg=false;}if(null==a.repeatSync){a.repeatSync=false;}if(null==a.isCamera){a.isCamera=false;}if(null==a.sName){a.sName="";}};EFormImage.prototype.deleteMe=function(){this.eform=null;this.ctrlID=null;this.controlData=null;this.event=null;this.group=null;this.deleteDOM();};EFormImage.prototype.resetDOM=function(){this.isDOM=false;this.imageElement=null;this.imageElement_canas=null;this.imageElement_guideSpan=null;this.imageElement_focusDiv=null;};EFormImage.prototype.deleteDOM=function(){if(this.imageElement){if(this.imageElement.parentElement){this.imageElement.parentElement.removeChild(this.imageElement);}else{delete this.imageElement;}}if(this.imageElement_canas){if(this.imageElement_canas.parentElement){this.imageElement_canas.parentElement.removeChild(this.imageElement_canas);}else{delete this.imageElement_canas;}}if(this.imageElement_guideSpan){if(this.imageElement_guideSpan.parentElement){this.imageElement_guideSpan.parentElement.removeChild(this.imageElement_guideSpan);}else{delete this.imageElement_guideSpan;}}if(this.imageElement_focusDiv){if(this.imageElement_focusDiv.parentElement){this.imageElement_focusDiv.parentElement.removeChild(this.imageElement_focusDiv);}else{delete this.imageElement_focusDiv;}}this.resetDOM();};EFormImage.prototype.getRect=function(){if(this.isDOM){var b={left:0,top:0,width:0,height:0};var d=this.imageElement;var c=d.parentElement.offsetLeft;var a=d.parentElement.offsetTop;b.left=c+d.offsetLeft;b.top=a+d.offsetTop;b.width=d.offsetWidth;b.height=d.offsetHeight;return b;}return null;};EFormImage.prototype.getHE=function(){if(this.isDOM){return this.imageElement;}return null;};EFormImage.prototype.eventHandlerImage=function(){if(!this.controlData.isToView){return;}if(typeof this.controlData.pageNumber=="undefined"){this.controlData.pageNumber=this.eform.beforePageIndex;}this.isDOM=true;this.imageElement=document.getElementById(this.eform.m_uid+this.ctrlID);this.imageElement_canas=document.getElementById(this.eform.m_uid+this.ctrlID+"Canvas");this.imageElement_guideSpan=document.getElementById(this.eform.m_uid+this.ctrlID+"Guide");this.imageElement_focusDiv=document.getElementById(this.eform.m_uid+this.ctrlID+"FOCUS");this.imageElemnet_camera=null;if(this.eform.m_RuleCtrlVisible){if(null!=this.imageElement_focusDiv){var b=this.imageElement_focusDiv.parentElement;if(null!=b){var f=document.createElement("div");f.style.position="absolute";f.style.left=b.style.left;f.style.top=b.style.top;f.style.width=b.style.width;f.style.height=b.style.height;f.style.color="red";f.style.fontSize="8pt";f.style.fontWeight="bold";var d=this.ctrlID;if(-1!=d.indexOf(".")){d=d.substring(d.indexOf(".")+1);}d=decodeURI(d.replace(/[r]/g,"%"));d=d.substring(0,d.lastIndexOf("_"));f.innerHTML=d+" ("+this.controlData.id+")";var g=b.parentElement;var a=b.nextSibling;if(null!=a){g.insertBefore(f,a);}else{g.appendChild(f);}}}}if(null==this.title){this.title=this.imageElement.title;}else{this.imageElement.title=this.title;this.imageElement.innerHTML=this.title;}this.controlData.is_ef="yes";if(this.controlData.is_nc){if(this.eform.eForm_isNecessary.check){this.imageElement_guideSpan.className="eF_Rect eForm_NecessaryCheck";}}if(""!=this.controlData.image){if(this.controlData.transImg){drawReportIamgeOrgin(this.imageElement_canas,this.controlData);}else{drawReportImage(this,this.imageElement_canas,this.controlData,false,false,false);}}else{this.imageElement_canas.src="data:image/png;base64,"+mRe_blankImg;}var c=this;if(null!=this.imageElement_focusDiv&&null!=this.imageElement){this.imageElement.onblur=function(){var h=c.imageElement_focusDiv;if(null!=h){h.className="eF_Rect";c.eform.inputImagePointerOut();}if(c.eform.multiView.isSocket){c.eform.multiView.socket.sendFocusControl(c,"out");}};this.imageElement.onfocus=function(){c.focusControl();if(c.eform.multiView.isSocket){c.eform.multiView.socket.sendFocusControl(c,"in");}};}this.imageElement.onmousedown=function(h){var i=false;if("which" in h){i=h.which==3;}else{if("button" in h){i=h.button==2;}}if(i){h.preventDefault();return;}c.EFormImageControl(true);};this.imageElement.onkeyup=function(h){if(32==h.keyCode||13==h.keyCode){c.EFormImageControl(true);}};this.m_setBGColor();this.setDisabled(this.controlData.disable,false);this.setVisible(this.controlData.visible,false);};EFormImage.prototype.getCtrlID=function(){return this.ctrlID;};EFormImage.prototype.getType=function(){return this.controlData.type;};EFormImage.prototype.getVisible=function(){return this.controlData.visible;};EFormImage.prototype.setVisible=function(a,b){if(typeof b=="undefined"){b=false;}this.controlData.visible=a;if(this.isDOM){if(a){this.imageElement.style.display="";this.imageElement_canas.style.display="";this.imageElement_guideSpan.style.display="";this.imageElement_focusDiv.style.display="";}else{this.imageElement.style.display="none";this.imageElement_canas.style.display="none";this.imageElement_guideSpan.style.display="none";this.imageElement_focusDiv.style.display="none";}}if(b){if(this.eform.multiView.isSocket){this.eform.multiView.socket.sendVisibled(this,a);}}};EFormImage.prototype.setDisabledClass=function(a){this.disabledClass=a;if(this.isDOM){this.setDisabled(this.controlData.disable,false);}};EFormImage.prototype.getDisabled=function(){return this.controlData.disable;};EFormImage.prototype.setDisabled=function(g,h,f){if(typeof h=="undefined"){h=false;}if(typeof f=="undefined"){f=true;}this.controlData.disable=g;var c=g;if(this.isDOM){var d=this.eform.isEasyInput?0:this.controlData.pageNumber;var a=this.eform.m_eformPageDisabled[d];if(null==a){a=false;}if(g||a||this.eform.m_eformDisabled){c=true;this.imageElement.disabled=true;this.imageElement_guideSpan.className="eF_Rect eForm_inputDisabled "+this.disabledClass;}else{c=false;this.imageElement.disabled=false;var b=this.controlData.isNecessaryCheck=="true"?" eForm_inputNecessary":"";if(this.controlData.is_nc){if(this.eform.eForm_isNecessary.check&&this.controlData.isNecessaryCheck=="true"){this.imageElement_guideSpan.className="eF_Rect eForm_NecessaryCheck";}else{this.imageElement_guideSpan.className="eF_Rect eForm_inputDefault_bg"+b;}}else{this.imageElement_guideSpan.className="eF_Rect eForm_inputDefault_bg"+b;}}}if(h){if(this.eform.multiView.isSocket){this.eform.multiView.socket.sendDisabled(this,g);}}if(null!=this.eform.ctrlEvent.disabledEvent&&f){this.eform.ctrlEvent.disabledEvent(c,this);}};EFormImage.prototype.setGuideBGColor=function(b,a,d,c,f){if(typeof f=="undefined"){f=true;}this.controlData.bgColor="rgba("+b+","+a+","+d+","+c+")";if(this.isDOM){this.imageElement_guideSpan.style.backgroundColor=this.controlData.bgColor;}if(this.eform.multiView.isSocket&&f){this.eform.multiView.socket.sendControlColor(this,b,a,d,c);}};EFormImage.prototype.m_setBGColor=function(){if(null!=this.controlData.bgColor){if(this.isDOM){this.imageElement_guideSpan.style.backgroundColor=this.controlData.bgColor;}}};EFormImage.prototype.getIndexOrderDisabled=function(){return this.controlData.indexOrderDisable;};EFormImage.prototype.setIndexOrderDisabled=function(a){this.controlData.indexOrderDisable=a;};EFormImage.prototype.setNecessaryCheck=function(a,b){if(typeof b=="undefined"){b=false;}if(a){this.controlData.isNecessaryCheck="true";if(""!=this.controlData.image){this.controlData.is_nc=false;if(this.isDOM){this.imageElement_guideSpan.className="eF_Rect";}}else{this.controlData.is_nc=true;}}else{this.controlData.is_nc=false;this.controlData.isNecessaryCheck="false";if(this.isDOM){this.imageElement_guideSpan.className="eF_Rect";}}this.setDisabled(this.controlData.disable,false);this.setVisible(this.controlData.visible,false);if(b){if(this.eform.multiView.isSocket){this.eform.multiView.socket.sendNecessaryCheck(this,a);}}};EFormImage.prototype.getValue=function(){return this.controlData.image;};EFormImage.prototype.setValue=function(a,b,c){if(typeof c=="undefined"){c=true;}if(typeof b=="undefined"){b=true;}this.m_default_setValue(a,false,b);if(this.eform.multiView.isSocket&&c){this.eform.multiView.socket.sendInputImage(this,a,b);}};EFormImage.prototype.setOriginValue=function(a,b){if(typeof b=="undefined"){b=true;}this.m_default_setOriginValue(a,b);if(this.eform.multiView.isSocket){this.eform.multiView.socket.sendInputImageOrigin(this,a,b);}};EFormImage.prototype.m_default_setOriginValue=function(d,g,f){this.controlData.is_nc=false;if(this.isDOM){this.controlData.image=d;this.controlData.transImg=true;drawReportIamgeOrgin(this.imageElement_canas,this.controlData);this.imageElement_guideSpan.className="eF_Rect";if(g){this.onChange(g);}}else{this.controlData.image=d;}if(this.controlData.repeatSync){if(typeof f=="undefined"){f=true;}if(f){var a=eform.findCloneControl(this);for(var c=0;c<a.length;c++){a[c].m_default_setOriginValue(d,g,false);}}}if(typeof getControlEventRulesCommand!="undefined"&&g){if((this.eform.multiView.isSocket&&this.eform.isMain)||!this.eform.multiView.isSocket){var b={};b.uid=this.eform.m_uid;b.reportName=this.controlData.rName;b.inputID=this.controlData.id;b.type="image";b.event="change";b.disabled=this.controlData.disable;b.visible=this.controlData.visible;b.image=this.controlData.image;b.value="";b.isNecessaryCheck="true"==this.controlData.isNecessaryCheck;b.isNecessaryChecked=!this.controlData.is_nc;b.sectionName=this.controlData.sName?this.controlData.sName:"";getControlEventRulesCommand(b);}}};EFormImage.prototype.m_default_setValue=function(g,f,j,h){if(""==g&&this.controlData.isNecessaryCheck=="true"){this.controlData.is_nc=true;}else{this.controlData.is_nc=false;}if(this.controlData.repeatSync){if(typeof h=="undefined"){h=true;}}else{h=false;}if(this.isDOM){this.controlData.image=g;drawReportImage(this,this.imageElement_canas,this.controlData,f,j,h);var b=this.controlData.isNecessaryCheck=="true"?" eForm_inputNecessary":"";if(this.getDisabled()){this.imageElement_guideSpan.className="eF_Rect eForm_inputDisabled "+this.disabledClass;}else{if(this.controlData.is_nc){if(this.eform.eForm_isNecessary.check&&this.controlData.isNecessaryCheck=="true"){this.imageElement_guideSpan.className="eF_Rect eForm_NecessaryCheck";}else{this.imageElement_guideSpan.className="eF_Rect eForm_inputDefault_bg"+b;}}else{this.imageElement_guideSpan.className="eF_Rect eForm_inputDefault_bg"+b;}}}else{this.controlData.image=g;}if(this.controlData.repeatSync){if(h){var a=eform.findCloneControl(this);for(var d=0;d<a.length;d++){a[d].m_default_setValue(g,f,j,false);}}}if(typeof getControlEventRulesCommand!="undefined"&&j){if((this.eform.multiView.isSocket&&this.eform.isMain)||!this.eform.multiView.isSocket){var c={};c.uid=this.eform.m_uid;c.reportName=this.controlData.rName;c.inputID=this.controlData.id;c.type="image";c.event="change";c.disabled=this.controlData.disable;c.visible=this.controlData.visible;c.image=this.controlData.image;c.isNecessaryCheck="true"==this.controlData.isNecessaryCheck;c.isNecessaryChecked=!this.controlData.is_nc;c.sectionName=this.controlData.sName?this.controlData.sName:"";getControlEventRulesCommand(c);}}};EFormImage.prototype.repeatSyncImage=function(){var a=this.eform.findCloneControl(this);for(var b=0;b<a.length;b++){a[b].controlData.transImg=true;a[b].controlData.image=this.controlData.image;}};EFormImage.prototype.setSendCameraImgValue=function(a){if(this.eform.multiView.isSocket){this.eform.multiView.socket.sendInputImage(this,this.controlData.image,a);}};EFormImage.prototype.setCameraImgValue=function(f,j,h,g){this.controlData.is_nc=false;if(g){if(-1!=f.indexOf("base64,")){var b=f.indexOf("base64,")+7;f=f.substring(b);}this.setValue(f);}else{if(this.isDOM){if(-1==f.indexOf("base64,")){f="data:image/png;base64,"+f;}drawReportImageSetData(this,this.imageElement_canas,this.controlData,f,j);this.imageElement_guideSpan.className="eF_Rect";}if(this.controlData.repeatSync){if(typeof h=="undefined"){h=true;}if(h){var b=f.indexOf("base64,")+7;var a=f.substring(b);var c=eform.findCloneControl(this);for(var d=0;d<c.length;d++){c[d].m_default_setValue(a,false,j,false);}}}}};EFormImage.prototype.callInappSignPad=function(){if(this.eform.multiView.isSocket){if(!this.eform.multiView.socket.isMain){this.eform.mRe_runStamp(null,"서명<br>입력중");return;}}var b;try{b=window.top;}catch(c){console.error("최상위 window 객체에 접근할 수 없습니다:",c);b=window;}var g=this;b.set_report_inapp_SignPad_data=function(j,i){if(j=="0"){if(i!=""){g.setOriginValue(i,true);}else{ReportWebLog("SignPad data >>> blank space");}}else{if(j=="1"){ClipAlertUI("경고","서명이 취소되었습니다.");ReportWebLog("SignPad cancel >>>"+i);}else{if(j=="2"){ClipAlertUI("경고","서명패드 장치를 찾을 수 없습니다.");ReportWebLog("SignPad not Found>>>"+i);}else{ClipAlertUI("경고","서명 패드 사용 중 문제가 발생하였습니다. 관리자에게 문의하세요.");ReportWebLog("SignPad error >>>"+i);}}}g.eform.mRe_setStamp(null);};this.eform.mRe_runStamp(null,"서명<br>입력중");if(is_exeMirroring){var h=this.imageElement.offsetWidth;var a=this.imageElement.offsetHeight;var f={methodName:"ShowSignPad",data:{width:h,height:a}};var d=this;window.setTimeout(function(){window.external.ClipMainWebBrowserCtrl_Invoke(JSON.stringify(f));},window.mRe_exeCallInterval);}};EFormImage.prototype.callInappCamera=function(g,c){if(typeof g==="undefined"){g=true;}if(typeof c==="undefined"){c=false;}var d=this;var a;try{a=window.top;}catch(b){console.error("최상위 window 객체에 접근할 수 없습니다:",b);a=window;}a.set_report_inapp_data=function(h){d.setOriginValue(h,true);};if(typeof ClipHybrid!="undefined"){ClipHybrid.getCameraPicture("",this.imageElement.offsetWidth,this.imageElement.offsetHeight);}else{ReportWebLog("Not Found InappCamera !!");if(this.imageElemnet_camera!=null){this.imageElemnet_camera.click();}else{var f=document.createElement("input");f.tabIndex=-1;f.style.cssText="display:none";f.type="file";f.setAttribute("accept","image/*");if(!g){f.setAttribute("capture","camera");}this.imageElement.parentElement.appendChild(f);f.onchange=function(){var h=new FileReader();var i=this.files[0];h.addEventListener("load",function(){d.setCameraImgValue(h.result,true,true,c);},false);if(i){h.readAsDataURL(i);}};this.imageElemnet_camera=f;f.click();}}};EFormImage.prototype.callInappSealStamp=function(){var d=this;var a;try{a=window.top;}catch(b){console.error("최상위 window 객체에 접근할 수 없습니다:",b);a=window;}a.set_report_inapp_data=function(f){d.setOriginValue(f,true);};if(typeof ClipHybrid!="undefined"){var c=new Object();c.width=this.imageElement.offsetWidth;c.height=this.imageElement.offsetHeight;ClipHybrid.callNativeControl("sealStamp",JSON.stringify(c));}};EFormImage.prototype.callInappIDCard=function(){var d=this;var a;try{a=window.top;}catch(b){console.error("최상위 window 객체에 접근할 수 없습니다:",b);a=window;}a.set_report_inapp_data=function(g){d.setOriginValue(g,true);};if(typeof ClipHybrid!="undefined"){var c=new Object();c.width=this.imageElement.offsetWidth;c.height=this.imageElement.offsetHeight;ClipHybrid.callNativeControl("IDCard",JSON.stringify(c));}else{if(is_exeMirroring){}else{ReportWebLog("WebCamera !!");if(this.imageElemnet_camera!=null){this.imageElemnet_camera.click();}else{var f=document.createElement("input");f.tabIndex=-1;f.style.cssText="display:none";f.type="file";f.setAttribute("accept","image/*");this.imageElement.parentElement.appendChild(f);f.onchange=function(){var g=new FileReader();var h=this.files[0];g.addEventListener("load",function(){d.setCameraImgValue(g.result,true,true,false);},false);if(h){g.readAsDataURL(h);}};this.imageElemnet_camera=f;f.click();}}}};EFormImage.prototype.onClickEvent=function(a){this.event.clickEvent=a;this.event.eventTarget=this;};EFormImage.prototype.onChangeEvent=function(a){this.event.changeEvent=a;this.event.eventTarget=this;};EFormImage.prototype.onChange=function(a){if(null!=this.event.changeEvent){this.event.changeEvent(this);}};EFormImage.prototype.getTitle=function(){return this.title;};EFormImage.prototype.setTitle=function(a){this.title=a;if(this.isDOM){this.imageElement.title=a;this.imageElement.innerHTML=a;}};EFormImage.prototype.EFormImageControl=function(a){if(this.eform.m_isButtonLock==false){if(this.controlData.isCamera&&!is_exeMirroringSub){this.callInappCamera(false);}this.onClick(a);if(this.eform.multiView.isSocket&&this.isSendClickEvent){this.eform.multiView.socket.sendInputButton(this,"click",a);}}};EFormImage.prototype.click=function(a){if(typeof a=="undefined"){a=true;}this.imageElement.focus();this.EFormImageControl(a);};EFormImage.prototype.setImageMode=function(d,a,b,c){this.controlData.imageDrawMethod=d;this.controlData.horizontalAlignment=a;this.controlData.verticalAlignment=b;this.controlData.imgRate=c;};EFormImage.prototype.setMirroringClickEvent=function(a){this.isSendClickEvent=a;};EFormImage.prototype.onClick=function(b){var a=true;if(b){if(null!=this.event.clickEvent){a=this.event.clickEvent(this);}if(null!=this.eform.ctrlEvent.imageClickEvent){a=this.eform.ctrlEvent.imageClickEvent(this);}}return a;};EFormImage.prototype.focusControl=function(){this.eform.mRe_inputFocusRectBlur();this.imageElement_focusDiv.className="eF_Rect eform_control_focus";this.eform.inputImagePointerIn(this);if(this.eform.titleSpeechBubble.visible.image){this.eform.inputCreateTitleSpeechBubble(this);}else{this.eform.inputRemoveTitleSpeechBubble();}if(null!=this.controlData.inputOrder){this.eform.inputOrderFoucs(this);}else{this.eform.inputOrderBlur();}};EFormImage.prototype.getPageNumber=function(){if(typeof this.controlData.pageNumber=="undefined"){return null;}return this.controlData.pageNumber+1;};EFormImage.prototype.focus=function(){if(this.isDOM){var a=this.imageElement;setTimeout(function(){a.focus();},1);}else{if(!this.eform.isEasyInput){this.eform.m_isrulesControlInfo=this.ctrlID;this.eform.sendRulesControlInfo();this.eform.selectPage(this.controlData.pageNumber,"control_focus");}}};EFormImage.prototype.multiViewFocus=function(){if(null==mRe_FocusControl.objCtrl||mRe_FocusControl.objCtrl!=this){mRe_FocusControl.objCtrl=this;if(this.isDOM){if(this.eform.m_isMultiViewFoucs){this.imageElement.focus();}else{this.eform.mRe_inputFocusRectBlur();this.imageElement_focusDiv.className="eF_Rect eform_control_focus";this.eform.inputImagePointerIn(this);if(this.eform.titleSpeechBubble.visible.image){this.eform.inputCreateTitleSpeechBubble(this);}else{this.eform.inputRemoveTitleSpeechBubble();}if(this.eform.m_isHybridQuickControl){this.eform.inputOrderFoucs(this);}}}}};EFormImage.prototype.multiViewBlur=function(){mRe_FocusControl={objCtrl:null};if(this.isDOM){this.imageElement_focusDiv.className="eF_Rect";this.eform.inputImagePointerOut();}};function drawReportImage(l,c,m,j,i,d){var h="jpeg";if(j){h="png";}if(""==m.image){c.src="data:image/"+h+";base64,"+mRe_blankImg;}else{m.transImg=true;var f=document.createElement("canvas");var g=c.width;var k=c.height;if(g==0&&k==0){var n=c.parentElement.style.width;var b=c.parentElement.style.height;if(null!=n){if(n.indexOf("px")!=-1){g=parseFloat(n);k=parseFloat(b);}else{if(n.indexOf("cm")!=-1){g=(parseFloat(n)*100)*0.378;k=(parseFloat(b)*100)*0.378;}}}}f.width=g;f.height=k;var a=m.image;var o=new Image();o.onload=function(){switch(m.imageDrawMethod){case 1:imageControlDrawOriginalSize(o,f,c,m,h,g,k);break;case 2:imageControlDrawStretch(o,f,c,m,h,g,k);break;case 3:imageControlDrawTile(o,f,c,m,h,g,k);break;case 4:imageControlDrawZoom(o,f,c,m,h,g,k);break;case 5:var q=o.width;var p=o.height;q=q*(m.imgRate/100);p=p*(m.imgRate/100);if(g>=q&&k>=p){imageControlDrawOriginalSize(o,f,c,m,h,g,k);}else{imageControlDrawZoom(o,f,c,m,h,g,k);}break;}if(d){l.repeatSyncImage();}if(i){l.onChange(i);}o.onload=null;};o.src="data:image/"+h+";base64,"+m.image;}}function drawReportImageSetData(j,d,k,c,h){var g=document.createElement("canvas");var i=d.clientWidth;var a=d.clientHeight;var f="jpeg";if(-1!=c.substring(0,20).indexOf("png")){f="png";}var b=g.getContext("2d");b.clearRect(0,0,i,a);b.Re_image=d;d.onload=function(){var n=document.createElement("canvas");n.width=d.width*2;n.height=d.height*2;var m=n.getContext("2d");m.drawImage(this,0,0,d.width*2,d.height*2);resample_single(n,i,a,g);var l=g.toDataURL("image/"+f,1);l=l.substring(l.indexOf("base64,")+7,l.length);k.image=l;b.Re_image=null;n=null;j.setSendCameraImgValue(h);if(h){j.onChange(h);}d.onload=null;};d.src=c;}function drawReportIamgeOrgin(b,a){b.src="data:image/png;base64,"+a.image;}function resample_single(l,a,d,q){var Q=l.width;var G=l.height;a=Math.round(a);d=Math.round(d);var D=Q/a;var J=G/d;var f=Math.ceil(D/2);var x=Math.ceil(J/2);var A=l.getContext("2d");var m=A.getImageData(0,0,Q,G);var v=A.createImageData(a,d);var P=m.data;var L=v.data;for(var N=0;N<d;N++){for(var O=0;O<a;O++){var t=(O+N*a)*4;var K=0;var M=0;var F=0;var n=0;var s=0;var y=0;var z=0;var b=(N+0.5)*J;var r=Math.floor(N*J);var k=Math.ceil((N+1)*J);for(var p=r;p<k;p++){var g=Math.abs(b-(p+0.5))/x;var c=(O+0.5)*D;var H=g*g;var o=Math.floor(O*D);var E=Math.ceil((O+1)*D);for(var C=o;C<E;C++){var h=Math.abs(c-(C+0.5))/f;var I=Math.sqrt(H+h*h);if(I>=1){continue;}K=2*I*I*I-3*I*I+1;var u=4*(C+p*Q);z+=K*P[u+3];F+=K;if(P[u+3]<255){K=K*P[u+3]/250;}n+=K*P[u];s+=K*P[u+1];y+=K*P[u+2];M+=K;}}L[t]=n/M;L[t+1]=s/M;L[t+2]=y/M;L[t+3]=z/F;}}A.clearRect(0,0,Q,G);q.width=a;q.height=d;var B=q.getContext("2d");B.putImageData(v,0,0);}function imageControlDrawOriginalSize(o,c,b,m,d,a,l){var f=a;var h=l;var k=c.getContext("2d");k.clearRect(0,0,f,h);var p=0;var g=0;var j=o.width;var i=o.height;j=j*(m.imgRate/100);i=i*(m.imgRate/100);if(m.horizontalAlignment==1){if(f>j){p=(f-j)/2;}}else{if(m.horizontalAlignment==2){if(f>j){p=f-j;}}}if(m.verticalAlignment==1){if(h>i){g=(h-i)/2;}}else{if(m.verticalAlignment==2){if(h>i){g=(h-i);}}}k.drawImage(o,p,g,j,i);var n=c.toDataURL();b.src=n;n=n.substring(n.indexOf("base64,")+7,n.length);m.image=n;}function imageControlDrawStretch(m,c,b,k,d,a,j){var f=a;var h=j;var i=c.getContext("2d");i.clearRect(0,0,f,h);var n=0;var g=0;i.drawImage(m,n,g,f,h);var l=c.toDataURL();b.src=l;l=l.substring(l.indexOf("base64,")+7,l.length);k.image=l;}function imageControlDrawZoom(f,l,d,r,b,i,j){var a=i*2;var n=j*2;l.width=a;l.height=n;var m=l.getContext("2d");m.clearRect(0,0,a,n);var c=0;var h=0;var k=f.width;var q=f.height;var p=k/q;var g=a/n;if(p>g){var s=q/k;q=a*s;k=a;if(r.verticalAlignment==1){if(n>q){h=(n-q)/2;}}else{if(r.verticalAlignment==2){if(n>q){h=(n-q);}}}}else{var s=k/q;k=n*s;q=n;if(r.horizontalAlignment==1){if(a>k){c=(a-k)/2;}}else{if(r.horizontalAlignment==2){if(a>k){c=a-k;}}}}if(m.imageSmoothingQuality){m.imageSmoothingQuality="high";}m.drawImage(f,c,h,k,q);var o=l.toDataURL();d.src=o;o=o.substring(o.indexOf("base64,")+7,o.length);r.image=o;}function imageControlDrawTile(q,c,b,o,d,a,n){var f=a;var h=n;var m=c.getContext("2d");m.clearRect(0,0,f,h);var r=0;var g=0;var k=q.width;var j=q.height;k=k*(o.imgRate/100);j=j*(o.imgRate/100);for(var l=r;l<f;l+=k){for(var i=g;i<h;i+=j){m.drawImage(q,l,i,k,j);}}var p=c.toDataURL();b.src=p;p=p.substring(p.indexOf("base64,")+7,p.length);o.image=p;}window.set_exe_mouse_event=function(b,a,d){if(is_exeMirroringSub&&null!=window.mRe_signaturePad){var c={which:1,clientX:Number(a),clientY:Number(d)};if(b=="down"){window.mRe_signaturePad._handleMouseDown(c);}else{if(b=="move"){window.mRe_signaturePad._handleMouseMove(c);}else{if(b=="up"){window.mRe_signaturePad._handleMouseUp(c);}}}}};var mRe_sign=null;var mRe_calendar=null;var mRe_selectbox=null;var mRe_splitMap=null;var mRe_mirraringData=null;if(window.addEventListener){window.addEventListener("resize",function(){if(is_smartphone){if(null!=mRe_pallet){var b=mRe_pallet;b.removePalletDoodle();b.palletDoodle();b=null;}}if(null!=mRe_calendar){var c=mRe_calendar;c.reSize();c=null;}if(null!=mRe_selectbox){var a=mRe_selectbox;a.reSize();a=null;}if(null!=window.mRe_multiSign_close){window.mRe_multiSign_close.click();mRe_reSetPopupStatus();}},false);}function EFormSign(){this.eform=null;this.ctrlID=null;this.controlData=null;this.group=null;this.isDOM=false;this.signElement=null;this.signElement_canas=null;this.signElement_guideSpan=null;this.signElement_guideInput=null;this.signElement_focusDiv=null;this.signElement_multiFocusDiv=null;this.event={clickEvent:null,okButtonEvent:null,cencelButtonEvent:null,nextButtonEvent:null,eventTarget:null};this.title=null;this.isSyncSignView=false;this.is_mousedown=false;this.m_signTempInfo={width:0,height:0,path:null};this.bgColor=null;this.disabledClass="";this.suffixSpeechText="";}EFormSign.prototype.setGroup=function(a){this.group=a;};EFormSign.prototype.init=function(b,a,c){this.eform=c;this.ctrlID=b;this.controlData=a;this.controlData.necessaryMessage=a.necessaryMessage.replace(/\\\//g,"/").replace(/\\\\/g,"\\").replace(/\\\"/g,'"');if(""!=a.guideMessage){this.controlData.guideMessage=a.guideMessage.replace(/\\\//g,"/").replace(/\\\\/g,"\\").replace(/\\\"/g,'"');}if(""!=a.title){this.controlData.title=a.title.replace(/\\\//g,"/").replace(/\\\\/g,"\\").replace(/\\\"/g,'"');}if(null!=a.detailTitle&&""!=a.detailTitle){this.controlData.detailTitle=a.detailTitle.replace(/\\\//g,"/").replace(/\\\\/g,"\\").replace(/\\\"/g,'"');}else{this.controlData.detailTitle="";}if(null!=a.inputOrder){this.eform.eFormIndexControlList[a.inputOrder]=this;}if(null==a.indexOrderDisable){a.indexOrderDisable=false;}if(null==a.fontBold){a.fontBold=false;}if(null==a.fontItalic){a.fontItalic=false;}if(null==a.fontUnderline){a.fontUnderline=false;}if(null==a.signStrokeWidth){a.signStrokeWidth=0;}if(null==a.showDisplayTextByValue){a.showDisplayTextByValue=false;}if(this.eform.multiView.isSocket){this.isSyncSignView=true;}if(null==a.repeatSync){a.repeatSync=false;}if(null==a.useText){a.useText=true;}if(null!=this.eform.mustSignPenWidth){a.penWidth=this.eform.mustSignPenWidth;}if(null!=this.eform.mustSignStrokeWidth){a.signStrokeWidth=this.eform.mustSignStrokeWidth;}if(null!=window.objClipSignSuffixSpeechText){this.suffixSpeechText=window.objClipSignSuffixSpeechText;}if(null==a.sName){a.sName="";}};EFormSign.prototype.deleteMe=function(){this.eform=null;this.ctrlID=null;this.controlData=null;this.event=null;this.group=null;this.deleteDOM();};EFormSign.prototype.resetDOM=function(){this.isDOM=false;this.signElement=null;this.signElement_canas=null;this.signElement_guideSpan=null;this.signElement_focusDiv=null;this.signElement_guideInput=null;};EFormSign.prototype.deleteDOM=function(){if(this.signElement){if(this.signElement.parentElement){this.signElement.parentElement.removeChild(this.signElement);}else{delete this.signElement;}}if(this.signElement_canas){if(this.signElement_canas.parentElement){this.signElement_canas.parentElement.removeChild(this.signElement_canas);}else{delete this.signElement_canas;}}if(this.signElement_guideSpan){if(this.signElement_guideSpan.parentElement){this.signElement_guideSpan.parentElement.removeChild(this.signElement_guideSpan);}else{delete this.signElement_guideSpan;}}if(this.signElement_guideInput){if(this.signElement_guideInput.parentElement){this.signElement_guideInput.parentElement.removeChild(this.signElement_guideInput);}else{delete this.signElement_guideInput;}}if(this.signElement_focusDiv){if(this.signElement_focusDiv.parentElement){this.signElement_focusDiv.parentElement.removeChild(this.signElement_focusDiv);}else{delete this.signElement_focusDiv;}}this.resetDOM();};EFormSign.prototype.getRect=function(){if(this.isDOM){var b={left:0,top:0,width:0,height:0};var d=this.signElement;var c=d.parentElement.offsetLeft;var a=d.parentElement.offsetTop;b.left=c+d.offsetLeft;b.top=a+d.offsetTop;b.width=d.offsetWidth;b.height=d.offsetHeight;return b;}return null;};EFormSign.prototype.getHE=function(){if(this.isDOM){return this.signElement;}return null;};EFormSign.prototype.eventHandlerSign=function(){if(typeof this.controlData.pageNumber=="undefined"){this.controlData.pageNumber=this.eform.beforePageIndex;}this.isDOM=true;this.signElement=document.getElementById(this.eform.m_uid+this.ctrlID);this.signElement_canas=document.getElementById(this.eform.m_uid+this.ctrlID+"Canvas");this.signElement_guideSpan=document.getElementById(this.eform.m_uid+this.ctrlID+"Guide");this.signElement_guideInput=document.getElementById(this.eform.m_uid+this.ctrlID+"GuideInput");this.signElement_focusDiv=document.getElementById(this.eform.m_uid+this.ctrlID+"FOCUS");if(this.eform.m_RuleCtrlVisible){if(null!=this.signElement_focusDiv){var f=this.signElement_focusDiv.parentElement;if(null!=f){var l=document.createElement("div");l.style.position="absolute";l.style.left=f.style.left;l.style.top=f.style.top;l.style.width=f.style.width;l.style.height=f.style.height;l.style.color="red";l.style.fontSize="8pt";l.style.fontWeight="bold";var d=this.ctrlID;if(-1!=d.indexOf(".")){d=d.substring(d.indexOf(".")+1);}d=decodeURI(d.replace(/[r]/g,"%"));d=d.substring(0,d.lastIndexOf("_"));l.innerHTML=d+" ("+this.controlData.id+")";var k=f.parentElement;var h=f.nextSibling;if(null!=h){k.insertBefore(l,h);}else{k.appendChild(l);}}}}if(null==this.title){this.title=this.signElement.title;}else{this.signElement.title=this.title;this.signElement.innerHTML=this.title;}this.controlData.is_ef="yes";if(this.controlData.is_nc){if(this.eform.eForm_isNecessary.check){this.signElement_guideSpan.className="eF_Rect eForm_NecessaryCheck";}}if(null!=this.signElement_canas){this.signElement_canas.width=this.controlData.width;this.signElement_canas.height=this.controlData.height;}if(!this.m_default_setPath(this.controlData.pathString,true,false)){if(""!=this.controlData.image){drawReportSign(this.signElement_canas,this.controlData);}}var m=this;if(null!=this.signElement_focusDiv&&null!=this.signElement){this.signElement.onblur=function(){var o=m.signElement_focusDiv;if(null!=o){o.className="eF_Rect";m.eform.inputImagePointerOut();}if(m.eform.multiView.isSocket){m.eform.multiView.socket.sendFocusControl(m,"out");}};this.signElement.onfocus=function(){m.focusControl();if(m.eform.multiView.isSocket){m.eform.multiView.socket.sendFocusControl(m,"in");}};}var g=this.eform.multiView;var b;var a;var n=false;this.signElement.ontouchstart=function(o){if(this.disabled){return;}b=o.touches[0].clientX;a=o.touches[0].clientY;n=true;};this.signElement.ontouchmove=function(p){if(this.disabled){return;}const o=p.touches[0].clientX;const q=p.touches[0].clientY;if(Math.abs(o-b)>10||Math.abs(q-a)>10){n=false;}};this.signElement.ontouchend=function(o){if(this.disabled){return;}if(n){n=false;o.stopPropagation();if(o.cancelable){o.preventDefault();this.onmousedown(o);}}};this.signElement.onmousedown=function(o){var p=false;if("which" in o){p=o.which==3;}else{if("button" in o){p=o.button==2;}}if(p){o.preventDefault();return;}if(m.onClick()!=false){if(g.isSocket&&g.socket.isMain){m.eform.mRe_subCheckFromMessage();m.eform.multiView.socket.sendSyncSignHybridView(m);}else{m.is_mousedown=true;if(m.controlData.isDirectSign){m.focusControl();m.eFormDirectSignControl();}else{m.eFormSignControl();}}}else{m.is_mousedown=true;}};this.signElement.onkeyup=function(o){if(32==o.keyCode){if(m.onClick()!=false){if(g.isSocket&&g.socket.isMain){m.eform.multiView.socket.sendSyncSignHybridView(m);}else{if(m.controlData.isDirectSign){m.focusControl();m.eFormDirectSignControl();}else{m.eFormSignControl();}}}else{m.is_mousedown=true;}}};this.signElement_guideInput.style.fontFamily="'"+this.controlData.fontName+"'";this.signElement_guideInput.style.fontSize=this.controlData.fontSize;this.signElement_guideInput.style.color=this.controlData.fontColor;if(this.controlData.fontBold){this.signElement_guideInput.style.fontWeight="bold";}if(this.controlData.fontItalic){this.signElement_guideInput.style.fontStyle="italic";}if(this.controlData.fontUnderline){this.signElement_guideInput.style.textDecoration="underline";}if("INPUT"==this.signElement_guideInput.tagName){this.signElement_guideInput.value=this.controlData.guideMessage;}else{var c=this.signElement_guideInput.lastChild.lastChild.lastChild;if(this.controlData.fontUnderline){c.style.textDecoration="underline";}var j=this.controlData.guideMessage;if(this.eform.m_isObjJSONSVG&&!this.eform.m_isAccessibility&&!is_ie){if(c.tagName=="SVG"){c=c.parentElement;}j=j.replace(/(\\r\\n)|(\\n)/g,"\n");c.style.fontSize=this.controlData.fontSize;mRe_autoSizeTextDraw(c,j,true,0,0,this.signElement);}else{j=j.replace(/\u3000/g,"clipu3000");j=j.replace(/\s/g,"\u00A0");j=j.replace(/clipu3000/g,String.fromCharCode(12288));if(null!=c.lastChild){c=c.lastChild;}if(typeof c.innerText!=="undefined"){c.innerText=j.replace(/(\\r\\n)|(\\n)/g,String.fromCharCode(13));}else{c.innerHTML=j.replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/\n/g,"<br />\n");}}}if(null!=this.controlData.padding){var i=this.controlData.padding;this.signElement_guideSpan.style.marginLeft=i.left*0.378+"px";this.signElement_guideSpan.style.marginTop=i.top*0.378+"px";this.signElement_guideSpan.style.marginRight=i.right*0.378+"px";this.signElement_guideSpan.style.marginBottom=i.bottom*0.378+"px";this.signElement_focusDiv.style.marginLeft=i.left*0.378+"px";this.signElement_focusDiv.style.marginTop=i.top*0.378+"px";this.signElement_focusDiv.style.marginRight=i.right*0.378+"px";this.signElement_focusDiv.style.marginBottom=i.bottom*0.378+"px";this.signRect={};if(this.signElement.style.left.indexOf("cm")!=-1){this.signRect.left=(parseFloat(this.signElement.style.left)*100)*0.378;this.signRect.top=(parseFloat(this.signElement.style.top)*100)*0.378;this.signRect.width=(parseFloat(this.signElement.style.width)*100)*0.378;this.signRect.height=(parseFloat(this.signElement.style.height)*100)*0.378;}else{this.signRect.left=parseFloat(this.signElement.style.left);this.signRect.top=parseFloat(this.signElement.style.top);this.signRect.width=parseFloat(this.signElement.style.width);this.signRect.height=parseFloat(this.signElement.style.height);}this.signElement.style.left=(this.signRect.left+(i.left*0.378))+"px";this.signElement.style.top=(this.signRect.top+(i.top*0.378))+"px";this.signElement.style.width=(this.signRect.width-((i.left+i.right)*0.378))+"px";this.signElement.style.height=(this.signRect.height-((i.top+i.bottom)*0.378))+"px";}this.m_setBGColor();this._showGuideTextVisible();this.setDisabled(this.controlData.disable,false);this.setVisible(this.controlData.visible,false);};EFormSign.prototype._showGuideTextVisible=function(){if(this.isDOM){if(this.controlData.showDisplayTextInDialog){if(this.controlData.showDisplayTextByValue&&this.controlData.image!=""){this.signElement_guideInput.style.visibility="hidden";}else{this.signElement_guideInput.style.visibility="visible";}}else{this.signElement_guideInput.style.visibility="hidden";}}};EFormSign.prototype.eFormHybridSignView=function(){if(this.controlData.isDirectSign){this.focusControl();this.eFormDirectSignControl();}else{this.eFormSignControl();}};EFormSign.prototype.eFormDirectSignControl=function(){this.eform.hiddenStaticPageMoveButton();var h=this;var w=this.eform;var l=null;if(this.eform.multiView.isSocket){l=w.multiView.socket;if(w.m_signMirroringVisible){l.sendScreenLock("singlesign",w.m_uid,[h.ctrlID]);var y=null;if(null!=window.mRe_signaturePad){y=window.mRe_signaturePad.toData();}else{y=this.controlData.pathString;}if(null!=y&&""!=y){window.setTimeout(function(){l.sendScreenSingleSignPath(y,w.m_uid,h.ctrlID);},100);}}else{l.sendScreenLock("sign",w.m_uid);}}if(null!=this.eform.signPaintDiv){return;}if(is_apple){this.eform.paintDiv.style.webkitOverflowScrolling="auto";}var d=this.signElement.parentElement;var p=is_edge?this.signElement.offsetLeft/w.eFormDoodleOption.zoomIn:this.signElement.offsetLeft;var s=is_edge?this.signElement.offsetTop/w.eFormDoodleOption.zoomIn:this.signElement.offsetTop;var z=this.signElement.offsetWidth;var x=this.signElement.offsetHeight;var a=document.createElement("div");if(is_exeMirroring||is_firefox){a.style.cssText="position:absolute;left:0px;top:0px;right:0px;opacity: 0;background-color:#FFF;z-index:199";a.style.height=w.menuDiv.offsetHeight+"px";}else{a.style.cssText="position:absolute;left:0px;top:0px;right:0px;bottom:0px;opacity: 0;background-color:#FFF;z-index:199";}w.signPaintDiv=a;var j=document.createElement("div");j.style.cssText="position:absolute;left:0px;top:0px;right:0px;bottom:0px;z-index:200";var b=document.createElement("div");b.style.position="absolute";b.style.left=p+"px";b.style.top=s+"px";b.style.width=z+"px";b.style.height=x+"px";b.style.zIndex="200";var C=document.createElement("div");C.style.position="absolute";C.style.left=(p+3)+"px";C.style.top=(s+x+3)+"px";C.style.width=z+"px";var E=document.createElement("button");E.id=w.m_uid+"okUBT";E.className="eform_sign_button_in eform_sign_save";E.innerHTML=w.m_languageMap.save;var k=document.createElement("button");k.className="eform_sign_button_in eform_sign_reset";k.innerHTML=w.m_languageMap.reset;var q=document.createElement("button");q.className="eform_sign_button_in eform_sign_cancel";q.innerHTML=w.m_languageMap.cancel;C.appendChild(E);C.appendChild(k);C.appendChild(q);j.appendChild(b);j.appendChild(C);w.targetDiv.appendChild(a);d.appendChild(j);if(!is_smartphone){E.focus();E.onkeydown=function(F){if(F.keyCode==9){q.click();}};}var g=this.controlData;g.po={is_down:false,move_count:0,reset:false};var f=this.signElement_canas;var A=new SignaturePad(f,{});A.clear();A.off();this.signElement_guideInput.style.visibility="visible";var u=document.createElement("canvas");b.appendChild(u);var r=b.offsetWidth;var n=b.offsetHeight;var o=window.Re_zoom;var B=1;u.width=this.signElement_canas.width;u.height=this.signElement_canas.height;u.style.width="100%";u.style.height="100%";var m=b.offsetWidth/Number(f.width);A.minWidth=g.penWidth;A.maxWidth=(g.penWidth+g.signStrokeWidth);var v=g.pathString;var i=new SignaturePad(u,{minWidth:(g.penWidth),maxWidth:((g.penWidth+g.signStrokeWidth)),penColor:g.penColor},this,null,this.eform.m_isSignWriteAlongByOnlyPen);i.throttle=3;i.minDistance=0;if(null!=v&&""!=v){v=mRe_copyObj(v);mRe_RatePath(v,(B),"*",0,0);i.fromData(v);}if(is_exeMirroringSub||(w.multiView.isSocket&&!w.multiView.isMain)){window.mRe_signaturePad=i;}window.mRe_multiSign_reset={};window.mRe_multiSign_reset[h.ctrlID]=k;k.onclick=k.ontouchstart=function(F){i.clear();g.po={is_down:false,move_count:0,reset:true};if(!is_smartphone){E.focus();}if(F.stopPropagation){F.stopPropagation();}else{F.cancelBubble=true;}if(h.eform.multiView.isSocket){if(w.m_signMirroringVisible){l.sendScreenSingleSignPathClear(w.m_uid,h.ctrlID);}}F.preventDefault();};var t=this.signElement_guideSpan;window.mRe_multiSign_close=q;q.onclick=q.ontouchstart=function(F){w.createStaticPageMoveButton();mRe_reSetPopupStatus();var G=g.isNecessaryCheck=="true"?" eForm_inputNecessary":"";if(g.disable){t.className="eF_Rect eForm_inputDisabled "+h.disabledClass;}else{if(g.is_nc){if(w.eForm_isNecessary.check&&g.isNecessaryCheck=="true"){t.className="eF_Rect eForm_NecessaryCheck";}else{t.className="eF_Rect eForm_inputDefault_bg"+G;}}else{t.className="eF_Rect eForm_inputDefault_bg"+G;}}if(null!=g.pathString){A.fromData(g.pathString);}w.targetDiv.removeChild(a);d.removeChild(j);w.signPaintDiv=null;if(is_apple){w.paintDiv.style.webkitOverflowScrolling="touch";}if(g.showDisplayTextInDialog){h.signElement_guideInput.style.visibility="visible";}else{h.signElement_guideInput.style.visibility="hidden";}if(null!=l){l.sendScreenUnLock(w.m_uid);}h.signElement.focus();h.onCencelButton();if(F.stopPropagation){F.stopPropagation();}else{F.cancelBubble=true;}F.preventDefault();};b.onmousedown=b.onclick=function(F){if(F.stopPropagation){F.stopPropagation();}else{F.cancelBubble=true;}};window.mRe_multiSign_ok=E;E.onclick=E.ontouchstart=function(F){if(F.target!=this){return;}w.createStaticPageMoveButton();mRe_reSetPopupStatus();i.off();var H=i.toData();g.po.move_count=mRe_PathCount(H);if(g.po.move_count>w.m_signMoveCount){g.is_nc=false;}else{if(g.isNecessaryCheck=="true"){g.is_nc=true;}}if(g.po.move_count==0){g.image="";g.pathString=null;}else{v=mRe_copyObj(H);mRe_RatePath(v,(B),"/",0,0);g.pathString=v;A.fromData(v);g.image=A.toDataURL().split("base64,")[1];w.mRe_validationCanvas(g.image,g.width,g.height);}var G=g.isNecessaryCheck=="true"?" eForm_inputNecessary":"";if(g.disable){t.className="eF_Rect eForm_inputDisabled "+h.disabledClass;}else{if(g.is_nc){if(w.eForm_isNecessary.check&&g.isNecessaryCheck=="true"){t.className="eF_Rect eForm_NecessaryCheck";}else{t.className="eF_Rect eForm_inputDefault_bg"+G;}}else{t.className="eF_Rect eForm_inputDefault_bg"+G;}}w.targetDiv.removeChild(a);d.removeChild(j);w.signPaintDiv=null;if(is_apple){w.paintDiv.style.webkitOverflowScrolling="touch";}h._showGuideTextVisible();h.setSendValue(g.image);if(h.eform.multiView.isSocket){h.eform.multiView.socket.sendMultiSignPath(h,g.pathString);}h.subSectionSyncValue();if(null!=l){l.sendScreenUnLock(w.m_uid);}h.signElement.focus();h.onOkButton();if(F.stopPropagation){F.stopPropagation();}else{F.cancelBubble=true;}if(!g.is_nc){h.eform.nextHybridInputControl(h);}F.preventDefault();};if(!this.eform.isSignUndoRedoHidden){var c=document.createElement("button");c.className="eform_sign_frame_undo_in";C.appendChild(c);c.onclick=c.ontouchstart=function(F){i.undo();if(h.eform.multiView.isSocket){if(w.m_signMirroringVisible){l.sendSignUndoRedo(w.m_uid,h.ctrlID,0);}}F.preventDefault();};var D=document.createElement("button");D.className="eform_sign_frame_redo_in";C.appendChild(D);D.onclick=D.ontouchstart=function(){i.redo();if(h.eform.multiView.isSocket){if(w.m_signMirroringVisible){l.sendSignUndoRedo(w.m_uid,h.ctrlID,1);}}event.preventDefault();};}if(this.eform.isUseSignPopupBGEvent){a.onclick=j.onclick=E.onclick;}};EFormSign.prototype.eFormSignControl=function(){if(this.eform.m_isBottomPopSign){this.eFormBottomSignControl();return;}this.eform.hiddenStaticPageMoveButton();if(this.eform.m_isSignWriteAlong&&this.controlData.guideMessage.length>0){this.eFormSignControlWriteAlong();return;}var B=this;var af=this.eform;if(this.eform.m_isButtonLock==false){if(null!=this.eform.signPaintDiv){var c=null;if(this.eform.multiView.isSocket){c=af.multiView.socket;if(af.m_signMirroringVisible){c.sendScreenLock("singlesign",af.m_uid,[B.ctrlID]);var p=null;if(null!=window.mRe_signaturePad){p=window.mRe_signaturePad.toData();}else{p=this.controlData.pathString;}if(null!=p&&""!=p){window.setTimeout(function(){c.sendScreenSingleSignPath(p,af.m_uid,B.ctrlID);},100);}}else{c.sendScreenLock("sign",af.m_uid);}}return;}if(null==mRe_sign){mRe_sign=new Object();mRe_sign={path:null,move_count:0};}mRe_sign.report=af;mRe_sign.eform=this;af.disabledMenu(true);var X;var H=0;var Y=0;if(this.controlData.width<500&&this.controlData.height<500){if(this.controlData.width<this.controlData.height){var l=500/this.controlData.height;Y=500;H=this.controlData.width*l;}if(this.controlData.height<=this.controlData.width){var l=500/this.controlData.width;H=500;Y=this.controlData.height*l;}}else{H=this.controlData.width;Y=this.controlData.height;}var T=(af.paintDiv.offsetWidth-(H+50));var V=(af.paintDiv.offsetHeight-(Y+110));if(T<V){X=af.paintDiv.offsetWidth/(H+150);}else{X=af.paintDiv.offsetHeight/(Y+210);}var aj=this.signElement.offsetWidth;var t=this.signElement.offsetHeight;var a=H*X;var d=Y*X;var ah=(af.paintDiv.offsetWidth-(a+50))/2;while(ah<20){X=X*0.9;a=H*X;d=Y*X;ah=(af.paintDiv.offsetWidth-(a+50))/2;}var i=Y*7<H;var E=Y*3;E=(af.paintDiv.offsetHeight-220)<E?(af.paintDiv.offsetHeight-220):E;if(this.eform.isUseSignSlide&&i){if(d>E){E=d;}else{d=E;}}var w=(af.paintDiv.offsetHeight-(d+110))/2;if(w<0){w=0;}X=(a+50)/400;var R=a/aj;var Z=document.createElement("div");if(is_smartphone){Z.className="m_eform_sign_background";}else{Z.className="eform_sign_background";}var s=Z.cloneNode(true);s.style.cssText="opacity: 0;background-color:#FFF;";var ag=document.createElement("div");if(af.m_signOption.staticPos){ag.style.cssText="position:absolute;left:"+af.m_signOption.staticLeft+";top:"+af.m_signOption.staticTop+";width:"+(a+50)+"px;height:"+(d+110)+"px;";}else{ag.style.cssText="position:absolute;left:"+(ah+af.m_signOption.offsetLeft)+"px;top:"+(w+af.m_signOption.offsetTop)+"px;width:"+(a+50)+"px;height:"+(d+110)+"px;";}if(null!=this.signElement_focusDiv){this.signElement_focusDiv.className="eF_Rect";}ag.className="eform_sign_div";var v=document.createElement("div");v.className="eform_sign_title";v.innerHTML=this.controlData.title;var G=document.createElement("div");G.className="eform_sign_menu";var ab=document.createElement("button");mRe_sign.okButton=ab;ab.className="eform_sign_button eform_sign_save";ab.style.zoom=X<1?X:1;ab.innerHTML=af.m_languageMap.save;var aa=document.createElement("button");mRe_sign.resetButton=aa;aa.className="eform_sign_button eform_sign_reset";aa.style.zoom=X<1?X:1;aa.innerHTML=af.m_languageMap.reset;var C=document.createElement("button");mRe_sign.cencelButton=C;C.className="eform_sign_button eform_sign_cancel";C.style.zoom=X<1?X:1;C.innerHTML=af.m_languageMap.cancel;var U=document.createElement("span");U.innerHTML="&nbsp;&nbsp;";G.appendChild(ab);G.appendChild(U.cloneNode(true));G.appendChild(aa);G.appendChild(U.cloneNode(true));G.appendChild(C);Z.addEventListener("touchstart",function(ak){if(ak.touches.length>1){ak.preventDefault();}},false);Re_zoom.isPop=true;var m=document.createElement("div");m.className="eform_sign_paint";m.style.overflow="hidden";if(this.eform.isUseSignSlide&&i){R=E/t;}var P=this.signElement_guideInput.cloneNode(true);mRe_sign.guideInput=P;P.className="eform_sign_paint_guide";var A="border:0px none !important;left:0px;top:0px;width:"+aj+"px;height:"+t+"px;";if(is_firefox){A+="transform: scale("+R+");transform-origin: left top 0;";}else{A+="zoom:"+R+";";}P.style.cssText=A;var z=null;if("TABLE"==P.firstChild.tagName){z=P.firstChild;}if(null==this.controlData.showDisplayTextInDialog||this.controlData.showDisplayTextInDialog){if("INPUT"==P.tagName){P.value=this.controlData.guideMessage;}else{if(!this.eform.m_isObjJSONSVG||this.eform.m_isAccessibility){var J=P.lastChild.lastChild.lastChild.lastChild;if(null==J){J=P.lastChild.lastChild.lastChild;}if(this.controlData.fontUnderline){J.style.textDecoration="underline";}var W=this.controlData.guideMessage;W=W.replace(/\u3000/g,"clipu3000");W=W.replace(/\s/g,"\u00A0");W=W.replace(/clipu3000/g,String.fromCharCode(12288));if(typeof J.innerText!=="undefined"){J.innerText=W.replace(/(\\r\\n)|(\\n)/g,String.fromCharCode(13));}else{J.innerHTML=W.replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/\n/g,"<br />\n");}}}}P.style.fontFamily="'"+this.controlData.fontName+"'";P.style.fontSize=this.controlData.fontSize;P.style.color=this.controlData.fontColor;if(this.controlData.fontBold){P.style.fontWeight="bold";}if(this.controlData.fontItalic){P.style.fontStyle="italic";}if(this.controlData.fontUnderline){P.style.textDecoration="underline";}m.appendChild(P);var b=document.createElement("div");b.className="eform_sign_paint";b.style.overflow="hidden";b.style.backgroundColor="transparent";ag.appendChild(v);ag.appendChild(G);ag.appendChild(m);ag.appendChild(b);Z.appendChild(ag);af.m_bodyDiv.appendChild(s);af.m_bodyDiv.appendChild(Z);window.setTimeout(function(){ab.focus();},100);ab.onkeydown=function(ak){if(ak.keyCode==9){C.click();}};af.signPaintDiv=Z;var ad=this.controlData;ad.po={is_down:false,move_count:0,reset:false};var k=this.signElement_canas;var h=new SignaturePad(k,{minWidth:ad.penWidth,maxWidth:(ad.penWidth+ad.signStrokeWidth)});h.clear();h.off();this._showGuideTextVisible();var x=document.createElement("canvas");b.appendChild(x);x.width=(this.eform.isUseSignSlide&&i)?(aj*R):b.offsetWidth;x.height=b.offsetHeight;var ae=(this.eform.isUseSignSlide&&i)?((aj*R)/Number(k.width)):(b.offsetWidth/Number(k.width));var K=null;if(null!=mRe_sign.path){K=mRe_sign.path;ad.po.move_count=mRe_sign.move_count;mRe_sign.path=null;}else{K=ad.pathString;}var N=new SignaturePad(x,{minWidth:ad.penWidth,maxWidth:(ad.penWidth+ad.signStrokeWidth),penColor:ad.penColor},this,null,this.eform.m_isSignWriteAlongByOnlyPen);N.throttle=3;N.minDistance=0;if(null!=K&&""!=K){K=mRe_copyObj(K);mRe_RatePath(K,ae,"*",0,0);N.fromData(K);}var c=null;if(this.eform.multiView.isSocket){c=af.multiView.socket;if(af.m_signMirroringVisible){c.sendScreenLock("singlesign",af.m_uid,[B.ctrlID]);var p=N.toData();if(null!=p&&""!=p){window.setTimeout(function(){c.sendScreenSingleSignPath(p,af.m_uid,B.ctrlID);},100);}}else{c.sendScreenLock("sign",af.m_uid);}}mRe_sign.jSign=N;mRe_sign.canvasRate=ae;window.mRe_multiSign_reset={};window.mRe_multiSign_reset[B.ctrlID]=aa;if(is_exeMirroringSub||(af.multiView.isSocket&&!af.multiView.isMain)){window.mRe_signaturePad=N;try{if(is_exeMirroringSub){this.eform.callAsyncSpeechSpeakAsync(this.ctrlID,this.controlData.title,this.suffixSpeechText);}}catch(M){mRe_ReportWebLog(M.stack);}}aa.onclick=aa.ontouchstart=function(ak){N.clear();ad.po={is_down:false,move_count:0,reset:true};mRe_sign.move_count=0;ab.focus();if(B.eform.multiView.isSocket){if(af.m_signMirroringVisible){c.sendScreenSingleSignPathClear(af.m_uid,B.ctrlID);}}ak.preventDefault();};var I=this.signElement_guideSpan;window.mRe_multiSign_close=C;C.onclick=C.ontouchstart=function(al){af.createStaticPageMoveButton();mRe_reSetPopupStatus();var ak=ad.isNecessaryCheck=="true"?" eForm_inputNecessary":"";if(ad.disable){I.className="eF_Rect eForm_inputDisabled "+B.disabledClass;}else{if(ad.is_nc){if(af.eForm_isNecessary.check&&ad.isNecessaryCheck=="true"){I.className="eF_Rect eForm_NecessaryCheck";}else{I.className="eF_Rect eForm_inputDefault_bg"+ak;}}else{I.className="eF_Rect eForm_inputDefault_bg"+ak;}}if(null!=ad.pathString){h.fromData(ad.pathString);}else{if(""!=ad.image){drawReportSign(k,ad);}}mRe_sign=null;af.m_bodyDiv.removeChild(s);af.m_bodyDiv.removeChild(Z);af.disabledMenu(false);af.signPaintDiv=null;Re_zoom.isPop=false;if(ad.showDisplayTextInDialog){B.signElement_guideInput.style.visibility="visible";}else{B.signElement_guideInput.style.visibility="hidden";}if(null!=c){c.sendScreenUnLock(af.m_uid);}B.signElement.focus();B.onCencelButton();al.preventDefault();};window.mRe_multiSign_ok=ab;ab.onclick=ab.ontouchstart=function(al){if(al.target!=this){return;}af.createStaticPageMoveButton();mRe_reSetPopupStatus();mRe_sign.move_count=0;N.off();var am=N.toData();ad.po.move_count=mRe_PathCount(am);if(ad.po.move_count>af.m_signMoveCount){ad.is_nc=false;}else{if(ad.isNecessaryCheck=="true"){ad.is_nc=true;}}af.disabledMenu(false);af.signPaintDiv=null;if(ad.po.move_count==0){ad.image="";ad.pathString=null;}else{K=mRe_copyObj(am);mRe_RatePath(K,ae,"/",0,0);ad.pathString=K;h.fromData(K);ad.image=h.toDataURL().split("base64,")[1];af.mRe_validationCanvas(ad.image,ad.width,ad.height);}var ak=ad.isNecessaryCheck=="true"?" eForm_inputNecessary":"";if(ad.disable){I.className="eF_Rect eForm_inputDisabled "+B.disabledClass;}else{if(ad.is_nc){if(af.eForm_isNecessary.check&&ad.isNecessaryCheck=="true"){I.className="eF_Rect eForm_NecessaryCheck";}else{I.className="eF_Rect eForm_inputDefault_bg"+ak;}}else{I.className="eF_Rect eForm_inputDefault_bg"+ak;}}mRe_sign=null;af.m_bodyDiv.removeChild(s);af.m_bodyDiv.removeChild(Z);Re_zoom.isPop=false;B._showGuideTextVisible();B.setSendValue(ad.image);if(B.eform.multiView.isSocket){B.eform.multiView.socket.sendMultiSignPath(B,ad.pathString);}B.subSectionSyncValue();if(null!=c){c.sendScreenUnLock(af.m_uid);}B.signElement.focus();B.onOkButton();if(!ad.is_nc){B.eform.nextHybridInputControl(B);}al.preventDefault();};if(this.eform.isUseSignPopupBGEvent){Z.onclick=ab.onclick;}if(!this.eform.isSignUndoRedoHidden){var g=document.createElement("button");g.className="eform_sign_frame_undo";G.appendChild(g);g.onclick=g.ontouchstart=function(ak){N.undo();if(B.eform.multiView.isSocket){if(af.m_signMirroringVisible){c.sendSignUndoRedo(af.m_uid,B.ctrlID,0);}}ak.preventDefault();};var O=document.createElement("button");O.className="eform_sign_frame_redo";G.appendChild(O);O.onclick=O.ontouchstart=function(ak){N.redo();if(B.eform.multiView.isSocket){if(af.m_signMirroringVisible){c.sendSignUndoRedo(af.m_uid,B.ctrlID,1);}}ak.preventDefault();};if(!i){g.style.left="30px";O.style.right="30px";}}if(this.eform.isUseSignSlide&&(x.width>b.offsetWidth)){var u=b.offsetWidth*0.8;var y=0;var f=document.createElement("button");f.className="eform_sign_frame_slide_left";f.style.display="none";var n=document.createElement("button");n.className="eform_sign_frame_slide_right";f.onclick=f.ontouchstart=function(ak){n.style.display="";y-=u;if(y<=10){f.style.display="none";y=0;if(is_ie){$(b).animate({scrollLeft:0},700);$(m).animate({scrollLeft:0},700);}else{b.scrollLeft=0;m.scrollLeft=0;}}else{if(is_ie){$(b).animate({scrollLeft:y},700);$(m).animate({scrollLeft:y},700);}else{b.scrollLeft=y;m.scrollLeft=y;}}ak.preventDefault();};n.onclick=n.ontouchstart=function(ak){f.style.display="";y+=u;if(y<x.width){if(is_ie){$(b).animate({scrollLeft:y},700);$(m).animate({scrollLeft:y},700);}else{b.scrollLeft=y;m.scrollLeft=y;}if((y+u)>x.width){n.style.display="none";}}else{y-=u;}ak.preventDefault();};G.appendChild(f);G.appendChild(n);}if(this.eform.isUseSignSlide&&this.eform.isUseSignSlideByViewText){var L=this.eform.paintDiv.offsetHeight;var D=ag.offsetHeight;var r=(L-D);r=r>70?70:r-25;ag.style.top=(ag.offsetTop-(r/2)-10)+"px";ag.style.height=(D+r)+"px";b.style.top=(r+25)+"px";m.style.top=(r+25)+"px";var o=document.createElement("div");o.style.cssText="position:absolute;text-align: center;font-size: 40px;font-weight: bold;left:15px;top:25px;right:15px;height:"+(r-10)+"px";ag.insertBefore(o,b);var j=document.createElement("div");j.innerText=this.controlData.guideMessage;o.appendChild(j);var ac=j.offsetHeight;var Q=40;while(ac>=(r-10)){Q-=0.5;o.style.fontSize=Q+"px";ac=j.offsetHeight;if(Q<=20){break;}}}else{var D=ag.offsetHeight;var w=(af.paintDiv.offsetHeight-D)/2;if(w<0){w=0;}ag.style.top=w+"px";}if(null!=z&&(!this.eform.m_isObjJSONSVG||this.eform.m_isAccessibility)){var ai=parseInt(P.style.fontSize);var Q=ai;var F=z.offsetWidth;var q=z.offsetHeight;var S=null;while(Q>0&&(P.offsetWidth<z.offsetWidth||P.offsetHeight<z.offsetHeight)){Q-=0.5;z.style.fontSize=Q+"pt";if(F!=z.offsetWidth||q!=z.offsetHeight){S=Q;}}if(Q<=0){window.console.log("sign popup resize fail !!");if(null!=S){z.style.fontSize=S+"pt";}else{z.style.fontSize=ai+"pt";}}}}};EFormSign.prototype.eFormFocusClassReset=function(){var a=this.eform;if(this.isDOM){if(null!=this.signElement_multiFocusDiv){var b=this.signElement_multiFocusDiv.parentElement;b.removeChild(this.signElement_multiFocusDiv);this.signElement_multiFocusDiv=null;}}a.paintDiv.style.bottom=null;};EFormSign.prototype.eFormFocusClassCreate=function(l){var m=this.eform;if(this.isDOM){if(m.m_isBottomPopScroll){m.paintDiv.style.bottom=l+"px";var c=this.getHE();var a=m.eFormDoodleOption.zoomIn;var f=is_edge?c.offsetTop/a:c.offsetTop;var g=is_edge?c.offsetLeft/a:c.offsetLeft;f=f+c.parentElement.offsetTop;g=g+c.parentElement.offsetLeft;var b=(m.paintDiv.offsetWidth-c.offsetWidth)/2;var k=(m.paintDiv.offsetHeight-c.offsetHeight)/2;var h=(g-(b/a))*a;var d=(f-100)*a;m.paintDiv.scrollLeft=h;m.paintDiv.scrollTop=d;}var j=this.signElement_focusDiv.parentElement;var i=document.createElement("div");i.className="eF_Rect eForm_multiSign_focus";j.appendChild(i);this.signElement_multiFocusDiv=i;}};EFormSign.prototype.eFormBottomSignControl=function(){if(this.eform.m_isButtonLock==false){if(null!=this.eform.signPaintDiv){return;}if(this.isDOM){this.signElement.blur();}window.is_clipSignPlugin=true;var v=this;var I=this.eform;I.disabledMenu(true);Re_zoom.isPop=true;var R=this.signElement.offsetWidth;var k=this.signElement.offsetHeight;var o=0;if(I.m_isBottomPopHeight>0){if(k>R){o=I.m_isBottomPopHeight;}else{o=I.m_isBottomPopLandscapeHeight;}}else{if(k>R){o=I.targetDiv.offsetHeight/1.5;}else{o=I.targetDiv.offsetHeight/2;}}this.eFormFocusClassCreate(o);var l=I.targetDiv.offsetWidth;var K=document.createElement("div");if(is_smartphone){K.className="m_eform_sign_background";}else{K.className="eform_sign_background";}K.style.background="rgba(155,155,155,0.3)";K.addEventListener("touchstart",function(T){if(T.touches.length>1){T.preventDefault();}},false);var M=document.createElement("div");if(I.m_isBottomPopHeight>0){M.style.height=(o)+"px";}else{M.style.height=(o<230?210:o)+"px";}M.className="eform_multiSign_body";var w=document.createElement("div");w.className="eform_multiSign_header";var b=document.createElement("div");b.className="eform_multiSign_header_Label";var y=document.createElement("nobr");b.appendChild(y);var S=document.createElement("button");S.className="eform_multiSign_close_button";var N=document.createElement("button");N.className="eform_multiSign_save_button";var z=document.createElement("button");z.className="eform_multiSign_next_button";w.appendChild(b);w.appendChild(S);w.appendChild(N);w.appendChild(z);M.appendChild(w);K.appendChild(M);I.m_bodyDiv.appendChild(K);this.eform.signPaintDiv=K;var u=this.controlData.title;var a=document.createElement("div");a.className="eform_multiSign_frame";a.style.left="0px";a.style.width=l+"px";M.appendChild(a);var G=document.createElement("div");G.className="eform_multiSign_frame_Label";var P=document.createElement("nobr");G.appendChild(P);P.innerHTML=this.controlData.detailTitle;a.appendChild(G);var B=document.createElement("button");B.className="eform_multiSign_frameReset_button";a.appendChild(B);var O=document.createElement("div");O.className="eform_multiSign_frame_body";a.appendChild(O);var H=O.offsetWidth;var n=O.offsetHeight;var J=((H-20)/R);var d=((n-20)/k);var E=0;var s=0;var f=0;if(J<d){E=J;s=10;f=((n-(E*k))/2);}else{E=d;f=10;s=((H-(E*R))/2);}var m=document.createElement("div");m.style.cssText="position:absolute;left:"+s+"px; top:"+f+"px;right:0px;bottom:0px;";var C=this.signElement_guideInput.cloneNode(true);C.className="eform_sign_paint_guide";var t="border:0px none !important;width:"+R+"px;height:"+k+"px;";if(is_firefox){t+="transform: scale("+E+");transform-origin: left top 0;";}else{t+="zoom:"+E+";";}C.style.cssText=t;C.style.fontFamily="'"+this.controlData.fontName+"'";C.style.fontSize=this.controlData.fontSize;C.style.color=this.controlData.fontColor;if(this.controlData.fontBold){C.style.fontWeight="bold";}if(this.controlData.fontItalic){C.style.fontStyle="italic";}if(this.controlData.fontUnderline){C.style.textDecoration="underline";}m.appendChild(C);O.appendChild(m);var r=null;if("TABLE"==C.firstChild.tagName){r=C.firstChild;}var j=document.createElement("div");j.className="eform_multiSign_frame_body";j.style.backgroundColor="transparent";a.appendChild(j);var g=document.createElement("div");g.className="eform_Sign_Bottom_frame";g.style.cssText="position:absolute;left:"+s+"px; top:"+f+"px;";g.style.width=(E*R)+"px";g.style.height=(E*k)+"px";j.appendChild(g);var p=document.createElement("canvas");g.appendChild(p);p.width=(E*R);p.height=(E*k);var L=this.controlData;var A=new SignaturePad(p,{},v);A.minWidth=this.controlData.penWidth;A.maxWidth=this.controlData.penWidth+this.controlData.signStrokeWidth;A.penColor=this.controlData.penColor;A.throttle=3;A.minDistance=0;if(null!=this.controlData.pathString&&""!=this.controlData.pathString){var q=mRe_copyObj(this.controlData.pathString);mRe_RatePath(q,(E*R)/Number(this.signElement_canas.width),"*",0,0);A.fromData(q);}var c=null;if(this.eform.multiView.isSocket){c=I.multiView.socket;if(I.m_signMirroringVisible){c.sendScreenLock("singlesign",I.m_uid,[v.ctrlID]);var h=A.toData();if(null!=h&&""!=h){window.setTimeout(function(){c.sendScreenSingleSignPath(h,I.m_uid,v.ctrlID);},100);}}else{c.sendScreenLock("sign",I.m_uid);}}window.mRe_multiSign_reset={};window.mRe_multiSign_reset[v.ctrlID]=B;B.onclick=B.ontouchstart=function(T){A.clear();if(v.eform.multiView.isSocket){if(I.m_signMirroringVisible){c.sendScreenSingleSignPathClear(I.m_uid,v.ctrlID);}}T.preventDefault();};y.innerHTML=u;window.mRe_multiSign_close=S;S.onclick=S.ontouchstart=function(T){v.eFormFocusClassReset();v.eform.signPaintDiv=null;mRe_reSetPopupStatus();I.m_bodyDiv.removeChild(K);I.disabledMenu(false);v.is_mousedown=true;v.signElement.focus();if(null!=c){c.sendHybridSignViewEvent(v,"cencel");}v.onCencelButton();if(null!=c){c.sendScreenUnLock(v.eform.m_uid);}T.preventDefault();};window.mRe_multiSign_ok=N;N.onclick=N.ontouchstart=function(T){v.eFormFocusClassReset();v.eform.signPaintDiv=null;mRe_reSetPopupStatus();v.setBottomSignData(A,E);I.m_bodyDiv.removeChild(K);I.disabledMenu(false);v.is_mousedown=true;v.signElement.focus();v.onOkButton();if(null!=c){c.sendScreenUnLock(v.eform.m_uid);}T.preventDefault();};z.onclick=z.ontouchstart=function(V){v.eFormFocusClassReset();v.eform.signPaintDiv=null;mRe_reSetPopupStatus();v.setBottomSignData(A,E);I.m_bodyDiv.removeChild(K);I.disabledMenu(false);var T=v.onNextButton();if(T){var U=I.nextHybridInputControl(v);if(!U){I.nextEasyInputControl(v);}}if(null!=c){c.sendScreenUnLock(I.m_uid);}V.preventDefault();};if(null!=r&&(!this.eform.m_isObjJSONSVG||this.eform.m_isAccessibility)){var Q=parseInt(C.style.fontSize);var D=Q;var x=r.offsetWidth;var i=r.offsetHeight;var F=null;while(D>0&&(C.offsetWidth<r.offsetWidth||C.offsetHeight<r.offsetHeight)){D-=0.5;r.style.fontSize=D+"pt";if(x!=r.offsetWidth||i!=r.offsetHeight){F=D;}}if(D<=0){window.console.log("sign popup resize fail !!");if(null!=F){r.style.fontSize=F+"pt";}else{r.style.fontSize=Q+"pt";}}}}};EFormSign.prototype.setBottomSignData=function(j,c){var m=this.eform;var l=null;if(this.eform.multiView.isSocket){l=m.multiView.socket;}j.off();var k=j.toData();var b=mRe_PathCount(k);if(null!=this.controlData.po){this.controlData.po.move_count=b;}else{this.controlData.po={move_count:b};}var f=this.controlData;if(b>this.eform.m_signMoveCount){f.is_nc=false;}else{if(f.isNecessaryCheck=="true"){f.is_nc=true;}}this.eform.signPaintDiv=null;var d=this.signElement_canas;var h=new SignaturePad(d,{minWidth:f.penWidth,maxWidth:(f.penWidth+f.signStrokeWidth)});h.clear();h.off();if(f.po.move_count==0){f.image="";f.pathString=null;}else{var a=mRe_copyObj(k);mRe_RatePath(a,Number(j._canvas.width)/Number(h._canvas.width),"/",0,0);f.pathString=a;h.fromData(a);f.image=h.toDataURL().split("base64,")[1];m.mRe_validationCanvas(f.image,f.width,f.height);}this._showGuideTextVisible();var i=this.signElement_guideSpan;var g=f.isNecessaryCheck=="true"?" eForm_inputNecessary":"";if(f.disable){i.className="eF_Rect eForm_inputDisabled "+this.disabledClass;}else{if(f.is_nc){if(this.eform.eForm_isNecessary.check&&f.isNecessaryCheck=="true"){i.className="eF_Rect eForm_NecessaryCheck";}else{i.className="eF_Rect eForm_inputDefault_bg"+g;}}else{i.className="eF_Rect eForm_inputDefault_bg"+g;}}if(null!=l){this.setSendValue(f.image);l.sendMultiSignPath(this,f.pathString);}this.subSectionSyncValue();};EFormSign.prototype.onNextButtonEvent=function(a){this.event.nextButtonEvent=a;this.event.eventTarget=this;};EFormSign.prototype.onNextButton=function(){var a=true;if(null!=this.event.nextButtonEvent){a=this.event.nextButtonEvent(this);}if(null!=this.eform.ctrlEvent.signNextButtonEvent){a=this.eform.ctrlEvent.signNextButtonEvent(this);}return a;};EFormSign.prototype.getCtrlID=function(){return this.ctrlID;};EFormSign.prototype.getType=function(){return this.controlData.type;};EFormSign.prototype.getValue=function(){return this.controlData.image;};EFormSign.prototype.setValue=function(c,d){this.m_default_setValue(c);this.setSendValue(c);if(this.controlData.repeatSync){if(typeof d=="undefined"){d=true;}if(d){var a=eform.findCloneControl(this);for(var b=0;b<a.length;b++){a[b].m_default_setValue(c,false);}}}};EFormSign.prototype.setSendValue=function(a){if(this.eform.multiView.isSocket){this.eform.multiView.socket.sendInputSign(this,a);}};EFormSign.prototype.isSyncSignView=function(){return this.isSyncSignView;};EFormSign.prototype.setSyncSignView=function(a){if(this.eform.multiView.isSocket){this.isSyncSignView=a;}};EFormSign.prototype.m_default_setValue=function(c){this.controlData.image=c;if(""==c&&this.controlData.isNecessaryCheck=="true"){this.controlData.is_nc=true;}else{this.controlData.is_nc=false;}if(this.isDOM){drawReportReSizeSign(this.signElement_canas,this.controlData);var a=this.controlData.isNecessaryCheck=="true"?" eForm_inputNecessary":"";if(this.controlData.disable){this.signElement_guideSpan.className="eF_Rect eForm_inputDisabled "+this.disabledClass;}else{if(this.controlData.is_nc){if(this.eform.eForm_isNecessary.check&&this.controlData.isNecessaryCheck=="true"){this.signElement_guideSpan.className="eF_Rect eForm_NecessaryCheck";}else{this.signElement_guideSpan.className="eF_Rect eForm_inputDefault_bg"+a;}}else{this.signElement_guideSpan.className="eF_Rect eForm_inputDefault_bg"+a;}}this._showGuideTextVisible();}else{var b=document.createElement("canvas");b.width=this.controlData.width;b.height=this.controlData.height;drawReportReSizeSign(b,this.controlData);}};EFormSign.prototype.setNecessaryCheck=function(a,b){if(typeof b=="undefined"){b=false;}if(a){this.controlData.isNecessaryCheck="true";if(""!=this.controlData.image){this.controlData.is_nc=false;if(this.isDOM){this.signElement_guideSpan.className="eF_Rect";this._showGuideTextVisible();}}else{this.controlData.is_nc=true;if(this.isDOM){this._showGuideTextVisible();}}}else{this.controlData.is_nc=false;this.controlData.isNecessaryCheck="false";if(this.isDOM){this.signElement_guideSpan.className="eF_Rect";}}this.setDisabled(this.controlData.disable,false);this.setVisible(this.controlData.visible,false);if(b){if(this.eform.multiView.isSocket){this.eform.multiView.socket.sendNecessaryCheck(this,a);}}};EFormSign.prototype.setSuffixSpeechText=function(a){this.suffixSpeechText=a;};EFormSign.prototype.getVisible=function(){return this.controlData.visible;};EFormSign.prototype.setVisible=function(a,b){if(typeof b=="undefined"){b=false;}this.controlData.visible=a;if(this.isDOM){if(a){this.signElement.style.display="";this.signElement_canas.style.display="";this.signElement_guideSpan.style.display="";this.signElement_focusDiv.style.display="";this.signElement_guideInput.style.display="";}else{this.signElement.style.display="none";this.signElement_canas.style.display="none";this.signElement_guideSpan.style.display="none";this.signElement_focusDiv.style.display="none";this.signElement_guideInput.style.display="none";}}if(b){if(this.eform.multiView.isSocket){this.eform.multiView.socket.sendVisibled(this,a);}}};EFormSign.prototype.setDisabledClass=function(a){this.disabledClass=a;if(this.isDOM){this.setDisabled(this.controlData.disable,false);}};EFormSign.prototype.getDisabled=function(){return this.controlData.disable;};EFormSign.prototype.setDisabled=function(g,h,f){if(typeof h=="undefined"){h=false;}if(typeof f=="undefined"){f=true;}this.controlData.disable=g;var c=g;if(this.isDOM){var d=this.eform.isEasyInput?0:this.controlData.pageNumber;var a=this.eform.m_eformPageDisabled[d];if(null==a){a=false;}if(g||a||this.eform.m_eformDisabled){c=true;this.signElement.disabled=true;this.signElement_guideSpan.className="eF_Rect eForm_inputDisabled "+this.disabledClass;}else{c=false;this.signElement.disabled=false;var b=this.controlData.isNecessaryCheck=="true"?" eForm_inputNecessary":"";if(this.controlData.is_nc){if(this.eform.eForm_isNecessary.check&&this.controlData.isNecessaryCheck=="true"){this.signElement_guideSpan.className="eF_Rect eForm_NecessaryCheck";}else{this.signElement_guideSpan.className="eF_Rect eForm_inputDefault_bg"+b;}}else{this.signElement_guideSpan.className="eF_Rect eForm_inputDefault_bg"+b;}}}if(h){if(this.eform.multiView.isSocket){this.eform.multiView.socket.sendDisabled(this,g);}}if(null!=this.eform.ctrlEvent.disabledEvent&&f){this.eform.ctrlEvent.disabledEvent(c,this);}};EFormSign.prototype.setGuideBGColor=function(b,a,d,c,f){if(typeof f=="undefined"){f=true;}this.controlData.bgColor="rgba("+b+","+a+","+d+","+c+")";if(this.isDOM){this.signElement_guideSpan.style.backgroundColor=this.controlData.bgColor;}if(this.eform.multiView.isSocket&&f){this.eform.multiView.socket.sendControlColor(this,b,a,d,c);}};EFormSign.prototype.m_setBGColor=function(){if(null!=this.controlData.bgColor){if(this.isDOM){this.signElement_guideSpan.style.backgroundColor=this.controlData.bgColor;}}};EFormSign.prototype.setGuideTextVisible=function(a){this.controlData.showDisplayTextInDialog=a;if(this.isDOM){this._showGuideTextVisible();}};EFormSign.prototype.setGuideText=function(b,c){if(typeof c=="undefined"){c=false;}if(!this.controlData.useText){return;}this.controlData.guideMessage=b.replace(/\\\//g,"/").replace(/\\\\/g,"\\").replace(/\\\"/g,'"');if(this.isDOM){if("INPUT"==this.signElement_guideInput.tagName){this.signElement_guideInput.value=this.controlData.guideMessage;}else{var d=this.signElement_guideInput.lastChild.lastChild.lastChild;var a=this.controlData.guideMessage;if(this.eform.m_isObjJSONSVG&&!this.eform.m_isAccessibility&&!is_ie){if(d.tagName=="SVG"){d=d.parentElement;}a=a.replace(/(\\r\\n)|(\\n)/g,"\n");d.style.fontSize=this.controlData.fontSize;mRe_autoSizeTextDraw(d,a,true,0,0,this.signElement);}else{a=a.replace(/\u3000/g,"clipu3000");a=a.replace(/\s/g,"\u00A0");a=a.replace(/clipu3000/g,String.fromCharCode(12288));if(null!=d.lastChild&&"TD"!=d.tagName){d=d.lastChild;}if(typeof d.innerText!=="undefined"){d.innerText=a.replace(/(\\r\\n)|(\\n)/g,String.fromCharCode(13));}else{d.innerHTML=a.replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/\n/g,"<br />\n");}}}this._showGuideTextVisible();}if(c){if(this.eform.multiView.isSocket){this.eform.multiView.socket.sendGuideText(this,b);}}};EFormSign.prototype.getDetailTitle=function(){return this.controlData.detailTitle;};EFormSign.prototype.setDetailTitle=function(a){this.controlData.detailTitle=a;};EFormSign.prototype.getIndexOrderDisabled=function(){return this.controlData.indexOrderDisable;};EFormSign.prototype.setIndexOrderDisabled=function(a){this.controlData.indexOrderDisable=a;};EFormSign.prototype.onClickEvent=function(a){this.event.clickEvent=a;this.event.eventTarget=this;};EFormSign.prototype.onOkButtonEvent=function(a){this.event.okButtonEvent=a;this.event.eventTarget=this;};EFormSign.prototype.onCencelButtonEvent=function(a){this.event.cencelButtonEvent=a;this.event.eventTarget=this;};EFormSign.prototype.click=function(){if(this.isDOM&&!this.controlData.disable&&this.controlData.visible){this.signElement.focus();if(this.onClick()!=false){var a=this.eform.multiView;if(a.isSocket&&a.socket.isMain){this.eform.mRe_subCheckFromMessage();this.eform.multiView.socket.sendSyncSignHybridView(this);}else{if(this.controlData.isDirectSign){this.focusControl();this.eFormDirectSignControl();}else{this.eFormSignControl();}}}}};EFormSign.prototype.getName=function(){var a=this.ctrlID;if(-1!=a.indexOf(".")){a=a.substring(a.indexOf(".")+1);}a=decodeURI(a.replace(/[r]/g,"%"));a=a.substring(0,a.lastIndexOf("_"));return a;};EFormSign.prototype.getTitle=function(){return this.title;};EFormSign.prototype.setTitle=function(a){this.title=a;if(this.isDOM){this.signElement.title=a;this.signElement.innerHTML=a;}};EFormSign.prototype.setMainTitle=function(a){if(null!=this.controlData){this.controlData.title=a;}};EFormSign.prototype.getMainTitle=function(){if(null!=this.controlData){return this.controlData.title;}return null;};EFormSign.prototype.onClick=function(){var a=true;if(null!=this.event.clickEvent){a=this.event.clickEvent(this);}if(null!=this.eform.ctrlEvent.signClickEvent){a=this.eform.ctrlEvent.signClickEvent(this);}if(this.eform.multiView.isSocket){this.eform.multiView.socket.sendSignClickEvent(this);}return a;};EFormSign.prototype.receiveClick=function(){if(null!=this.eform.ctrlEvent.signClickEvent){this.eform.ctrlEvent.signClickEvent(this);}};EFormSign.prototype.onOkButton=function(){if(null!=this.event.okButtonEvent){this.event.okButtonEvent(this);}if(null!=this.eform.ctrlEvent.signOkButtonEvent){this.eform.ctrlEvent.signOkButtonEvent(this);}};EFormSign.prototype.onCencelButton=function(){if(null!=this.event.cencelButtonEvent){this.event.cencelButtonEvent(true);}if(null!=this.eform.ctrlEvent.signCencelButtonEvent){this.eform.ctrlEvent.signCencelButtonEvent(this);}};EFormSign.prototype.getPageNumber=function(){if(typeof this.controlData.pageNumber=="undefined"){return null;}return this.controlData.pageNumber+1;};EFormSign.prototype.focus=function(){if(this.isDOM){var a=this.signElement;setTimeout(function(){a.focus();},1);}else{if(!this.eform.isEasyInput){this.eform.m_isrulesControlInfo=this.ctrlID;this.eform.sendRulesControlInfo();this.eform.selectPage(this.controlData.pageNumber,"control_focus");}}};EFormSign.prototype.getSignCheck=function(){if(this.controlData.po){if(this.controlData.po.move_count>0){return true;}}return false;};EFormSign.prototype.getSignPathCount=function(){if(this.controlData.po){return this.controlData.po.move_count;}return 0;};EFormSign.prototype.focusControl=function(){if(null!=this.signElement_focusDiv){this.eform.mRe_inputFocusRectBlur();this.signElement_focusDiv.className="eF_Rect eform_control_focus";this.eform.inputImagePointerIn(this);if(this.eform.titleSpeechBubble.visible.sign){this.eform.inputCreateTitleSpeechBubble(this);}else{this.eform.inputRemoveTitleSpeechBubble();}if(this.eform.m_isHybridQuickControl||null!=this.controlData.inputOrder){this.eform.inputOrderFoucs(this);}else{this.eform.inputOrderBlur();}if(!this.is_mousedown&&this.eform.m_isBottomPopSign&&!this.controlData.isDirectSign){this.eFormBottomSignControl();if(event.stopPropagation){event.stopPropagation();}else{event.cancelBubble=true;}}this.is_mousedown=false;}};EFormSign.prototype.getPath=function(){var a=this.controlData.pathString;if(typeof a==="object"){a=mRe_copyObj(a);return a;}else{return a;}};EFormSign.prototype.setOriginalPath=function(c,b,d,a){if(typeof b=="undefined"){b=true;}if(typeof d=="undefined"){d=true;}if(typeof a=="undefined"){a=false;}this.setPath(c,b,d,a,false);};EFormSign.prototype.setPath=function(c,b,g,a,f){this.m_signTempInfo={width:0,height:0,path:null};var d=this.m_setPath(c,b,g,a,f);return d;};EFormSign.prototype.m_setPath=function(c,b,g,a,f){if(typeof f=="undefined"){f=true;}if(typeof b=="undefined"){b=true;}if(typeof g=="undefined"){g=true;}if(typeof a=="undefined"){a=false;}var d=this.m_default_setPath(c,b,f);if(this.eform.multiView.isSocket&&g){this.eform.multiView.socket.sendSignPath(this,c,(d&&a));}return d;};EFormSign.prototype.m_default_setPath=function(A,j,l){this.controlData.pathString=A;if(null==A||this.eform.isSubWebApp||is_appControl){return false;}var v=true;if(typeof A=="string"&&A.indexOf("|")!=-1){var y=[];var x=A.split("|");var a=null;var z=[];var s=this.controlData.penColor;for(var g=0;g<x.length;g++){var m=x[g];if(is_exeMirroring){var k=m.split(";");var i=k[0];var t=i.split(",");if(t.length==2){if(null==a||(a[0]!=t[0]||a[0]!=t[0])){z=[];y.push(z);var f={};f.x=Number(t[0]);f.y=Number(t[1]);f.color=s;z.push(f);}var p=k[1];var a=p.split(",");var d={};d.x=Number(a[0]);d.y=Number(a[1]);d.color=s;z.push(d);}}else{j=false;break;}}A=y;v=false;l=true;}if(typeof A!=="string"&&j){var h=mRe_PathCount(A);if(null!=this.controlData.po){this.controlData.po.move_count=h;}else{this.controlData.po={move_count:h};}var c=this.controlData;if(h>this.eform.m_signMoveCount){c.is_nc=false;}else{if(c.isNecessaryCheck=="true"){c.is_nc=true;}}if(c.po.move_count==0){c.image="";c.pathString=null;}var b=null;if(this.isDOM){b=this.signElement_canas;var o=this.signElement_guideSpan;var r=c.isNecessaryCheck=="true"?" eForm_inputNecessary":"";if(c.disable){o.className="eF_Rect eForm_inputDisabled "+this.disabledClass;}else{if(c.is_nc){if(this.eform.eForm_isNecessary.check&&c.isNecessaryCheck=="true"){o.className="eF_Rect eForm_NecessaryCheck";}else{o.className="eF_Rect eForm_inputDefault_bg"+r;}}else{o.className="eF_Rect eForm_inputDefault_bg"+r;}}}else{b=document.createElement("CANVAS");b.width=c.width;b.height=c.height;}var u=new SignaturePad(b,{minWidth:c.penWidth,maxWidth:(c.penWidth+c.signStrokeWidth)});u.clear();u.off();if(c.po.move_count!=0){u.throttle=3;u.minDistance=0;if(!v){u.isSetPathPaint=true;}var q=mRe_copyObj(A);if(l&&(!this.controlData.isDirectSign||!v)){var n=mRe_RectPoint(q);mRe_RatePath(q,1,"/",-(n.x1-10),-(n.y1-10));var w=mRe_calcRect((n.x2-n.x1+20),(n.y2-n.y1+20),c.width,c.height);mRe_RatePath(q,w.canvasRate,"/",w.offsetX,w.offsetY);if(v){c.pathString=q;}}u.fromData(q);c.image=u.toDataURL().split("base64,")[1];this.eform.mRe_validationCanvas(c.image,c.width,c.height);u.isSetPathPaint=false;}this._showGuideTextVisible();return true;}return false;};EFormSign.prototype.multiViewFocus=function(){if(null==mRe_FocusControl.objCtrl||mRe_FocusControl.objCtrl!=this){mRe_FocusControl.objCtrl=this;if(this.isDOM){if(this.eform.m_isMultiViewFoucs){this.signElement.focus();}else{this.eform.mRe_inputFocusRectBlur();this.signElement_focusDiv.className="eF_Rect eform_control_focus";this.eform.inputImagePointerIn(this);if(this.eform.titleSpeechBubble.visible.sign){this.eform.inputCreateTitleSpeechBubble(this);}else{this.eform.inputRemoveTitleSpeechBubble();}if(this.eform.m_isHybridQuickControl){this.eform.inputOrderFoucs(this);}}}}};EFormSign.prototype.multiViewBlur=function(){mRe_FocusControl={objCtrl:null};if(this.isDOM){this.signElement_focusDiv.className="eF_Rect";this.eform.inputImagePointerOut();}};EFormSign.prototype.multiViewSignLock=function(a){if(this.isDOM){if(a=="lock"){this.signElement_focusDiv.innerHTML="<font style='font-size:10pt;color:gray;'>사용자 입력중..</font>";if(!this.controlData.disable){this.signElement.disabled=true;}}else{this.signElement_focusDiv.innerHTML="";if(!this.controlData.disable){this.signElement.disabled=false;}}}};EFormSign.prototype.eFormSyncView=function(){this.focusControl();};EFormSign.prototype.eFormSyncSignOkButton=function(){var h=this.eform;var d=this.controlData;var i=this.signElement_guideSpan;var c=this.signElement_canas;var g=mRe_sign.jSign;var a=document.getElementById("Re_signView");var j=document.getElementById("Re_signViewOp");mRe_sign.move_count=0;if(d.po.move_count>h.m_signMoveCount){d.is_nc=false;}else{if(d.po.move_count!=0&&d.isNecessaryCheck=="true"){d.is_nc=true;}}h.disabledMenu(false);h.signPaintDiv=null;if(((d.po.move_count==0&&d.po.reset)||d.po.move_count==0&&""==d.image)&&d.isNecessaryCheck=="true"){d.image="";d.is_nc=true;}else{var b=g.jSignature("getData").split("base64,")[1];d.image=b;drawReportSign(c,d);}var f=d.isNecessaryCheck=="true"?" eForm_inputNecessary":"";if(d.disable){i.className="eF_Rect eForm_inputDisabled "+this.disabledClass;}else{if(d.is_nc){if(h.eForm_isNecessary.check&&d.isNecessaryCheck=="true"){i.className="eF_Rect eForm_NecessaryCheck";}else{i.className="eF_Rect eForm_inputDefault_bg"+f;}}else{i.className="eF_Rect eForm_inputDefault_bg"+f;}}mRe_sign=null;h.targetDiv.removeChild(j);h.targetDiv.removeChild(a);Re_zoom.isPop=false;this._showGuideTextVisible();this.signElement.focus();this.onOkButton();};EFormSign.prototype.eFormSyncSignResetButton=function(){var a=this.controlData;var b=document.getElementById("Re_signView_ok");a.po={is_down:false,move_count:0,reset:true};mRe_sign.move_count=0;mRe_sign.jSign.jSignature("reset");b.focus();};EFormSign.prototype.eFormSyncSignCencelButton=function(){var d=this.eform;var c=this.controlData;var b=this.signElement_guideSpan;var g=this.signElement_canas;var a=document.getElementById("Re_signView");var h=document.getElementById("Re_signViewOp");var f=c.isNecessaryCheck=="true"?" eForm_inputNecessary":"";if(c.disable){b.className="eF_Rect eForm_inputDisabled "+this.disabledClass;}else{if(c.is_nc){if(d.eForm_isNecessary.check&&c.isNecessaryCheck=="true"){b.className="eF_Rect eForm_NecessaryCheck";}else{b.className="eF_Rect eForm_inputDefault_bg"+f;}}else{b.className="eF_Rect eForm_inputDefault_bg"+f;}}drawReportSign(g,c);mRe_sign=null;d.targetDiv.removeChild(h);d.targetDiv.removeChild(a);d.disabledMenu(false);d.signPaintDiv=null;Re_zoom.isPop=false;this._showGuideTextVisible();this.signElement.focus();this.onCencelButton();};EFormSign.prototype.subSectionSyncValue=function(b){if(typeof b=="undefined"){b=true;}var a=this.subSectionSyncValueImage();this.subSectionSyncValuePath(a,b);};EFormSign.prototype.subSectionSyncValueImage=function(){var b=null;if(this.controlData.repeatSync){var a=0;if(null!=this.controlData.po&&""!=this.controlData.image){a=this.controlData.po.move_count;}b=eform.findCloneControl(this);for(var d=0;d<b.length;d++){var c=b[d];if(null!=c.controlData.po){c.controlData.po.move_count=a;}else{c.controlData.po={move_count:a};}c.m_default_setValue(this.controlData.image);}}return b;};EFormSign.prototype.subSectionSyncValuePath=function(l,j){if(typeof j=="undefined"){j=true;}if(j){if(typeof getControlEventRulesCommand!="undefined"){if((this.eform.multiView.isSocket&&this.eform.isMain)||!this.eform.multiView.isSocket){var b=this.ctrlID;if(-1!=b.indexOf(".")){b=b.substring(b.indexOf(".")+1);}b=decodeURI(b.replace(/[r]/g,"%"));b=b.substring(0,b.lastIndexOf("_"));var k={};k.uid=this.eform.m_uid;k.reportName=this.controlData.rName;k.inputID=this.controlData.id;k.type="sign";k.event="change";k.disabled=this.controlData.disable;k.visible=this.controlData.visible;k.image=this.controlData.image;k.value="";k.path=this.controlData.pathString;if(null!=k.path){if((typeof k.path=="string")&&k.path!="null"){if(k.path.length>0){k.value="true";}}else{if(k.path.length>0){k.value="true";}}}k.title=b;k.isNecessaryCheck="true"==this.controlData.isNecessaryCheck;k.isNecessaryChecked=!this.controlData.is_nc;k.sectionName=this.controlData.sName?this.controlData.sName:"";getControlEventRulesCommand(k);}}}if(this.controlData.repeatSync){if(typeof l=="undefined"){l=eform.findCloneControl(this);}for(var f=0;f<l.length;f++){var g=l[f];var a=this.controlData.pathString;if(typeof a==="string"){g.controlData.pathString=a;}else{var c=g.controlData;c.pathString=a;c.po.move_count=mRe_PathCount(a);if(c.po.move_count>this.eform.m_signMoveCount){c.is_nc=false;}else{if(c.po.move_count!=0&&c.isNecessaryCheck=="true"){c.is_nc=true;}}if(g.isDOM){var h=g.signElement_guideSpan;if(null!=h){var d=c.isNecessaryCheck=="true"?" eForm_inputNecessary":"";if(c.disable){h.className="eF_Rect eForm_inputDisabled "+g.disabledClass;}else{if(c.is_nc){if(this.eform.eForm_isNecessary.check&&c.isNecessaryCheck=="true"){h.className="eF_Rect eForm_NecessaryCheck";}else{h.className="eF_Rect eForm_inputDefault_bg"+d;}}else{h.className="eF_Rect eForm_inputDefault_bg"+d;}}}}}}}};EFormSign.prototype.setStampStatus=function(a){};EFormSign.prototype._setUndoDataSignObj=function(a){if(this._undoData){this._undoData.push(a);this._redoData=[];}};EFormSign.prototype._WriteAlongUndo=function(){if(this._undoData){if(this._undoData.length>0){var c=this._undoData.pop();this._redoData.push(c);return c;}}if(this.localSavePath.signPad){var b=this.localSavePath.signPad.length;for(var a=b-1;a>=0;a--){var d=this.localSavePath.signPad[a];if(!d.isEmpty()){this._redoData.push(d);return d;}}}return null;};EFormSign.prototype._WriteAlongRedo=function(){if(this._redoData){if(this._redoData.length>0){var c=this._redoData.pop();this._undoData.push(c);return c;}}if(this.localSavePath.signPad){var b=this.localSavePath.signPad.length;for(var a=b-1;a>=0;a--){var d=this.localSavePath.signPad[a];if(!d.isEmpty()){this._undoData.push(d);return d;}}}return null;};EFormSign.prototype.eFormSignControlWriteAlong=function(){var t=this;var P=this.eform;if(this.eform.m_isButtonLock==false){if(null!=this.eform.signPaintDiv){var b=null;if(this.eform.multiView.isSocket){b=P.multiView.socket;if(P.m_signMirroringVisible){b.sendScreenLock("singlesign",P.m_uid,[t.ctrlID]);var l=null;if(null!=window.mRe_signaturePad){l=window.mRe_signaturePad.toData();}else{l=this.controlData.pathString;}if(null!=l&&""!=l){window.setTimeout(function(){b.sendScreenSingleSignPath(l,P.m_uid,t.ctrlID);},100);}}else{b.sendScreenLock("sign",P.m_uid);}}return;}if(null==mRe_sign){mRe_sign=new Object();mRe_sign={path:null,move_count:0};}this._undoData=[];this._redoData=[];mRe_sign.report=P;mRe_sign.eform=this;P.disabledMenu(true);window.is_clipSignPlugin=true;var K=document.createElement("div");K.className="eform_sign_background";K.style.top="0px";var m=K.cloneNode(true);m.style.cssText="opacity: 0;background-color:#FFF;";P.m_bodyDiv.appendChild(m);P.m_bodyDiv.appendChild(K);var Q=document.createElement("div");if(null!=this.signElement_focusDiv){this.signElement_focusDiv.className="eF_Rect";}Q.className="eform_sign_div eform_sign_paint_along_div";var p=document.createElement("div");p.className="eform_sign_title";p.innerHTML=this.controlData.title;p.title=this.controlData.title;p.tabIndex=0;p.setAttribute("role","text");p.setAttribute("aria-label",this.controlData.title);var w=document.createElement("div");w.className="eform_sign_menu";var M=document.createElement("button");mRe_sign.okButton=M;M.className="eform_sign_button eform_sign_save";M.innerHTML=P.m_languageMap.save;var L=document.createElement("button");mRe_sign.resetButton=L;L.className="eform_sign_button eform_sign_reset";L.innerHTML=P.m_languageMap.reset;var u=document.createElement("button");mRe_sign.cencelButton=u;u.className="eform_sign_button eform_sign_cancel";u.innerHTML=P.m_languageMap.cancel;var F=document.createElement("span");F.innerHTML="&nbsp;&nbsp;";w.appendChild(M);w.appendChild(F.cloneNode(true));w.appendChild(L);w.appendChild(F.cloneNode(true));w.appendChild(u);Re_zoom.isPop=true;var j=document.createElement("div");j.className="eform_sign_paint_along";j.style.overflow="hidden";var a=document.createElement("div");a.className="eform_sign_paint_along";a.style.overflow="hidden";a.style.backgroundColor="transparent";Q.appendChild(p);Q.appendChild(j);Q.appendChild(a);Q.appendChild(w);K.appendChild(Q);P.signPaintDiv=K;var N=this.controlData;N.po={is_down:false,move_count:0,reset:false};var k=this.signElement_canas;var f=new SignaturePad(k,{minWidth:N.penWidth,maxWidth:(N.penWidth+N.signStrokeWidth)});f.clear();f.off();if(this.controlData.showDisplayTextInDialog){this.signElement_guideInput.style.visibility="visible";}else{this.signElement_guideInput.style.visibility="hidden";}var S={fontName:this.controlData.fontName,fontSize:this.eform.m_isSignWriteAlongByFontSize,horizontalAlign:"left",verticalAlign:"top",isReduceFontSize:true,text:this.controlData.guideMessage,fontBold:this.controlData.fontBold,width:j.offsetWidth,height:j.offsetHeight-10,lineSpace:10};var c=SignTextBuilder(S);var n=new Array();var R;var H=null;var A=c.textLineList;if(A){var I=0;var G=0;var D=null;for(var O=0;O<A.length;O++){if(A[O].ty!=I){if(O==0){R=A[O].ty;}D={margin:0,y:0,defaultY:R,text:"",bold:c.bold,size:c.size,color:this.controlData.fontColor,fontName:this.controlData.fontName};n.push(D);if(O-1>-1){var h=A[O-1].character;var g=/[^가-힣a-zA-Z]/g;var s=h.match(g);var v=c.size;if(s){v=v/3;}G+=(A[O-1].tx+(v/1.06));D.margin=G;}I=A[O].ty;D.y=A[O].ty-(c.size);}D.text+=A[O].character;if(O==A.length-1){H=(A[O].tx+(c.size/1.06))+25;}}}var E=a.offsetWidth;var J=a.offsetHeight/n.length;if(c.size+15<J){J=c.size+15;var q=J*n.length;var o=(a.offsetHeight-q)/2;Q.style.marginTop=o+"px";Q.style.marginBottom=o+"px";}if(n.length==1){a.style.textAlign="center";}if(this.localSavePath){if(this.localSavePath.width!=E||this.localSavePath.height!=J){this.localSavePath.tempSave=this.localSavePath.save;this.localSavePath.save=null;}}else{this.localSavePath={width:E,height:J,save:null};}this.localSavePath.signPad=[];var r=null;for(var O=0;O<n.length;O++){r=document.createElement("canvas");a.appendChild(r);r.width=E;r.height=J-2;if(O==n.length-1){if(null!=H){H=H>E?E:H;r.width=H;}}else{r.className="eform_sign_paint_along_bottom_border";}var B=new SignaturePad(r,{minWidth:N.penWidth,maxWidth:(N.penWidth+N.signStrokeWidth),penColor:N.penColor},this,n[O],this.eform.m_isSignWriteAlongByOnlyPen);B.throttle=3;B.minDistance=0;if(this.localSavePath.save){B.fromData(this.localSavePath.save[O]);}this.localSavePath.signPad.push(B);a.appendChild(r);}var z=null;var b=null;if(this.eform.multiView.isSocket){b=P.multiView.socket;if(P.m_signMirroringVisible){b.sendScreenLock("singlesign",P.m_uid,[t.ctrlID]);if(this.localSavePath.save){var x=this.localSavePath.save.length;var T=[];for(var O=0;O<x;O++){var z=mRe_copyObj(this.localSavePath.save[O]);mRe_RatePath(z,1,"",0,n[O].y);T=T.concat(z);}if(T.length>0){window.setTimeout(function(){b.sendScreenSingleSignPath(T,P.m_uid,t.ctrlID);},100);}}}else{b.sendScreenLock("sign",P.m_uid);}}window.mRe_multiSign_reset={};window.mRe_multiSign_reset[t.ctrlID]=L;L.onclick=L.onpointerdown=function(i){for(O=0;O<t.localSavePath.signPad.length;O++){t.localSavePath.signPad[O].clear();}N.po={is_down:false,move_count:0,reset:true};mRe_sign.move_count=0;M.focus();if(t.eform.multiView.isSocket){if(P.m_signMirroringVisible){b.sendScreenSingleSignPathClear(P.m_uid,t.ctrlID);}}i.preventDefault();};var y=this.signElement_guideSpan;window.mRe_multiSign_close=u;u.onclick=u.onpointerdown=function(U){mRe_reSetPopupStatus();if(t.localSavePath.tempSave){t.localSavePath.save=t.localSavePath.tempSave;}var i=N.isNecessaryCheck=="true"?" eForm_inputNecessary":"";if(N.disable){y.className="eF_Rect eForm_inputDisabled";}else{if(N.is_nc){if(P.eForm_isNecessary.check&&N.isNecessaryCheck=="true"){y.className="eF_Rect eForm_NecessaryCheck";}else{y.className="eF_Rect eForm_inputDefault_bg"+i;}}else{y.className="eF_Rect eForm_inputDefault_bg"+i;}}if(null!=N.pathString){f.fromData(N.pathString);}else{if(""!=N.image){drawReportSign(k,N);}}mRe_sign=null;P.m_bodyDiv.removeChild(m);P.m_bodyDiv.removeChild(K);P.disabledMenu(false);P.signPaintDiv=null;Re_zoom.isPop=false;if(N.showDisplayTextInDialog){t.signElement_guideInput.style.visibility="visible";}else{t.signElement_guideInput.style.visibility="hidden";}if(null!=b){b.sendScreenUnLock(P.m_uid);}t.signElement.focus();t.onCencelButton();U.preventDefault();};window.mRe_multiSign_ok=M;M.onclick=M.onpointerdown=function(X){mRe_reSetPopupStatus();mRe_sign.move_count=0;t.localSavePath.save=[];t.localSavePath.width=E;t.localSavePath.height=J;t.localSavePath.tempSave=null;var Z=[];for(O=0;O<t.localSavePath.signPad.length;O++){var Y=t.localSavePath.signPad[O];Y.off();var W=mRe_copyObj(Y.toData());t.localSavePath.save.push(W);W=mRe_copyObj(W);mRe_RatePath(W,1,"",n[O].margin,0);Z=Z.concat(W);}N.po.move_count=mRe_PathCount(Z);if(N.po.move_count>P.m_signMoveCount){N.is_nc=false;}else{if(N.po.move_count!=0&&N.isNecessaryCheck=="true"){N.is_nc=true;}}P.disabledMenu(false);P.signPaintDiv=null;if(((N.po.move_count==0&&N.po.reset)||N.po.move_count==0&&""==N.image)&&N.isNecessaryCheck=="true"){N.image="";N.is_nc=true;N.pathString=null;}else{t.m_signTempInfo.path=Z;t.m_signTempInfo.width=E;t.m_signTempInfo.height=J;z=mRe_copyObj(Z);var U=mRe_RectPoint(z);mRe_RatePath(z,1,"/",-(U.x1),-(U.y1));var i=mRe_calcRect((U.x2-U.x1+15),(U.y2-U.y1),(N.width*0.98),(N.height*0.98));mRe_RatePath(z,i.canvasRate,"/",i.offsetX+15,i.offsetY);N.pathString=z;f.fromData(z);N.image=f.toDataURL().split("base64,")[1];}var V=N.isNecessaryCheck=="true"?" eForm_inputNecessary":"";if(N.disable){y.className="eF_Rect eForm_inputDisabled";}else{if(N.is_nc){if(P.eForm_isNecessary.check&&N.isNecessaryCheck=="true"){y.className="eF_Rect eForm_NecessaryCheck";}else{y.className="eF_Rect eForm_inputDefault_bg"+V;}}else{y.className="eF_Rect eForm_inputDefault_bg"+V;}}mRe_sign=null;P.m_bodyDiv.removeChild(m);P.m_bodyDiv.removeChild(K);Re_zoom.isPop=false;if(N.showDisplayTextInDialog){t.signElement_guideInput.style.visibility="visible";}else{t.signElement_guideInput.style.visibility="hidden";}t.setSendValue(N.image);if(t.eform.multiView.isSocket){t.eform.multiView.socket.sendMultiSignPath(t,N.pathString);}t.subSectionSyncValue();if(null!=b){b.sendScreenUnLock(P.m_uid);}t.signElement.focus();t.onOkButton();if(!N.is_nc){t.eform.nextHybridInputControl(t);}X.preventDefault();};if(!this.eform.isSignUndoRedoHidden){var d=document.createElement("button");d.className="eform_sign_frame_undo";w.appendChild(d);d.onclick=d.onpointerdown=function(U){var i=t._WriteAlongUndo();if(i){i.undo();}if(t.eform.multiView.isSocket){if(P.m_signMirroringVisible){b.sendSignUndoRedo(P.m_uid,t.ctrlID,0);}}U.preventDefault();};var C=document.createElement("button");C.className="eform_sign_frame_redo";w.appendChild(C);C.onclick=C.onpointerdown=function(U){var i=t._WriteAlongRedo();if(i){i.redo();}if(t.eform.multiView.isSocket){if(P.m_signMirroringVisible){b.sendSignUndoRedo(P.m_uid,t.ctrlID,1);}}U.preventDefault();};}}};function SignTextBuilder(O){this.textItem=O;var D=this.textItem;var q=D.fontName?D.fontName:"NanumGothic";var p=D.fontSize?D.fontSize:10;var N=D.horizontalAlign?D.horizontalAlign:"left";var a=D.verticalAlign?D.verticalAlign:"top";var w=D.isReduceFontSize?true:false;var v=D.text?D.text:"";var s=D.fontBold?true:false;var u=D.color?D.color:0;var k=1.2*1.32814;if(D.lineSpace){k=D.lineSpace*1.32814;}var P=0;if(D.wordSpace){P=D.wordSpace*1.32814;}var F=[];var g=0;var n=0;var L=[];var y="";var l=new Array();var r=0;var G=v.length;var I=D.width;var d=D.height;var x=p*1.32814;var Q=0;var c=x;var B=false;var H=0;var f=0;var E=0;var C=0;var m=document.createElement("canvas");m.width=I;m.height=d;var o=m.getContext("2d");o.scale(1,1);o.font=p+"pt "+q;for(var J=0;J<p;J++){if(B){break;}else{if(!w){B=true;}for(var K=0;K<G;K++){var b=0;var M=false;if(v[K]!="\n"){b=o.measureText(v[K]).width+P;g=g+b;}else{M=true;}if(g>I||M){if(Q+(x)*2+k<(d-x*0.15)){Q=Q+x+k;f=f+x+k;F.push(g-b);H++;}else{if(w){H=0;g=0;n=0;y="";l=new Array();L=[];F=[];x=(x-1.32814);Q=0;r=0;c=0+x;o.font=(x/1.32814)+"pt "+q;break;}else{F.push(g-b);H++;f=f+x+k;break;}}L.push(y);y="";g=0;g=g+b;r++;}if(!M){y=y+v[K];l.push({character:v[K],tx:0+g-b,ty:c+Q,verticalPosition:H});}if(K==G-1){B=true;f=Q+x;F.push(g);}}}}for(var A=0;A<F.length;A++){var t=F[A];if(N=="center"){E=(I-t)/2;}else{if(N=="right"){E=(I-t);}else{E=0;}}F[A]=E;}if(a=="middle"){C=(d-f)/2;}else{if(a=="bottom"){C=(d-f);}else{C=0;}}for(var A=0;A<l.length;A++){var h=l[A];h.tx+=F[h.verticalPosition];h.ty+=C;}var z={webText:true,bold:s,fontName:q,size:x,color:u,textLineList:l};return z;}function EFormSignGroup(){this.eform=null;this.ctrlID=null;this.controlData=null;this.group=null;this.isDOM=false;this.signElement=null;this.signElement_canas=null;this.signElement_guideSpan=null;this.signElement_guideInput=null;this.signElement_focusDiv=null;this.signElement_multiFocusDiv=null;this.event={clickEvent:null,okButtonEvent:null,cencelButtonEvent:null,nextButtonEvent:null,eventTarget:null};this.title=null;this.isSyncSignView=false;this.is_mousedown=false;this.signRect=null;this.m_signTempInfo={width:0,height:0,path:null};this.bgColor=null;this.disabledClass="";}EFormSignGroup.prototype.setGroup=function(a){this.group=a;};EFormSignGroup.prototype.init=function(b,a,c){this.eform=c;this.ctrlID=b;this.controlData=a;this.controlData.necessaryMessage=a.necessaryMessage.replace(/\\\//g,"/").replace(/\\\\/g,"\\").replace(/\\\"/g,'"');if(""!=a.guideMessage){this.controlData.guideMessage=a.guideMessage.replace(/\\\//g,"/").replace(/\\\\/g,"\\").replace(/\\\"/g,'"');}if(""!=a.title){this.controlData.title=a.title.replace(/\\\//g,"/").replace(/\\\\/g,"\\").replace(/\\\"/g,'"');}if(""!=a.detailTitle){this.controlData.detailTitle=a.detailTitle.replace(/\\\//g,"/").replace(/\\\\/g,"\\").replace(/\\\"/g,'"');}if(null!=a.inputOrder){this.eform.eFormIndexControlList[a.inputOrder]=this;}if(null==a.indexOrderDisable){a.indexOrderDisable=false;}if(null==a.pathString){a.pathString="";}if(null==a.fontBold){a.fontBold=false;}if(null==a.fontItalic){a.fontItalic=false;}if(null==a.fontUnderline){a.fontUnderline=false;}if(null==a.useStamp){a.useStamp=false;}if(null==a.signStrokeWidth){a.signStrokeWidth=0;}if(null==a.showDisplayTextByValue){a.showDisplayTextByValue=false;}if(this.eform.multiView.isSocket){this.isSyncSignView=true;}if(null==a.repeatSync){a.repeatSync=false;}if(null!=this.eform.mustSignPenWidth){a.penWidth=this.eform.mustSignPenWidth;}if(null==a.noSign){a.noSign=false;}if(null==a.noiCount){a.noiCount=0;}if(null==a.useText){a.useText=true;}if(this.eform.m_isStampDefaultTypeIgnore||null==a.stampDefaultType){a.stampDefaultType=this.eform.m_stampDefaultType;}if(null!=this.eform.mustSignStrokeWidth){a.signStrokeWidth=this.eform.mustSignStrokeWidth;}if(null==a.isStampImage){a.isStampImage=false;}if(a.isStampImage){this.stampImage=a.image;}if(null==this.controlData.isApp){this.controlData.isApp=is_appControl;}if(a.useStamp){if(null!=a.margin&&null==a.padding){a.padding=a.margin;}}if(null==a.sName){a.sName="";}if(null==a.minNumberOfDrawing){a.minNumberOfDrawing=0;}if(null==a.minNumberMessage){a.minNumberMessage="";}else{a.minNumberMessage=a.minNumberMessage.replace(/\\\//g,"/").replace(/\\\\/g,"\\").replace(/\\\"/g,'"');}};EFormSignGroup.prototype.deleteMe=function(){this.eform=null;this.ctrlID=null;this.controlData=null;this.event=null;this.group=null;this.deleteDOM();};EFormSignGroup.prototype.resetDOM=function(){this.isDOM=false;this.signElement=null;this.signElement_canas=null;this.signElement_guideSpan=null;this.signElement_focusDiv=null;this.signElement_guideInput=null;};EFormSignGroup.prototype.deleteDOM=function(){if(this.signElement){if(this.signElement.parentElement){this.signElement.parentElement.removeChild(this.signElement);}else{delete this.signElement;}}if(this.signElement_canas){if(this.signElement_canas.parentElement){this.signElement_canas.parentElement.removeChild(this.signElement_canas);}else{delete this.signElement_canas;}}if(this.signElement_guideSpan){if(this.signElement_guideSpan.parentElement){this.signElement_guideSpan.parentElement.removeChild(this.signElement_guideSpan);}else{delete this.signElement_guideSpan;}}if(this.signElement_guideInput){if(this.signElement_guideInput.parentElement){this.signElement_guideInput.parentElement.removeChild(this.signElement_guideInput);}else{delete this.signElement_guideInput;}}if(this.signElement_focusDiv){if(this.signElement_focusDiv.parentElement){this.signElement_focusDiv.parentElement.removeChild(this.signElement_focusDiv);}else{delete this.signElement_focusDiv;}}this.resetDOM();};EFormSignGroup.prototype.getRect=function(){if(this.isDOM){var b={left:0,top:0,width:0,height:0};var d=this.signElement;var c=d.parentElement.offsetLeft;var a=d.parentElement.offsetTop;b.left=c+d.offsetLeft;b.top=a+d.offsetTop;b.width=d.offsetWidth;b.height=d.offsetHeight;return b;}return null;};EFormSignGroup.prototype.getHE=function(){if(this.isDOM){return this.signElement;}return null;};EFormSignGroup.prototype.eventHandlerSignGroup=function(){if(typeof this.controlData.pageNumber=="undefined"){this.controlData.pageNumber=this.eform.beforePageIndex;}this.isDOM=true;this.signElement=document.getElementById(this.eform.m_uid+this.ctrlID);this.signElement_canas=document.getElementById(this.eform.m_uid+this.ctrlID+"Canvas");this.signElement_guideSpan=document.getElementById(this.eform.m_uid+this.ctrlID+"Guide");this.signElement_guideInput=document.getElementById(this.eform.m_uid+this.ctrlID+"GuideInput");this.signElement_focusDiv=document.getElementById(this.eform.m_uid+this.ctrlID+"FOCUS");if(this.eform.m_RuleCtrlVisible){if(null!=this.signElement_focusDiv){var f=this.signElement_focusDiv.parentElement;if(null!=f){var k=document.createElement("div");k.style.position="absolute";k.style.left=f.style.left;k.style.top=f.style.top;k.style.width=f.style.width;k.style.height=f.style.height;k.style.color="red";k.style.fontSize="8pt";k.style.fontWeight="bold";var d=this.ctrlID;if(-1!=d.indexOf(".")){d=d.substring(d.indexOf(".")+1);}d=decodeURI(d.replace(/[r]/g,"%"));d=d.substring(0,d.lastIndexOf("_"));k.innerHTML=d+" ("+this.controlData.id+")";var j=f.parentElement;var g=f.nextSibling;if(null!=g){j.insertBefore(k,g);}else{j.appendChild(k);}}}}if(null==this.title){this.title=this.signElement.title;}else{this.signElement.title=this.title;this.signElement.innerHTML=this.title;}this.controlData.is_ef="yes";if(this.controlData.is_nc){if(this.eform.eForm_isNecessary.check){this.signElement_guideSpan.className="eF_Rect eForm_NecessaryCheck";}}if(this.controlData.showDisplayTextInDialog){this.signElement_guideInput.style.visibility="visible";}else{this.signElement_guideInput.style.visibility="hidden";}if(null!=this.signElement_canas){this.signElement_canas.width=this.controlData.width;this.signElement_canas.height=this.controlData.height;}if(!this.m_default_setPath(this.controlData.pathString,true,false)){if(""!=this.controlData.image){drawReportSign(this.signElement_canas,this.controlData);}}var l=this;if(null!=this.signElement_focusDiv&&null!=this.signElement){this.signElement.onblur=function(){var n=l.signElement_focusDiv;if(null!=n){n.className="eF_Rect";l.eform.inputImagePointerOut();}if(l.eform.multiView.isSocket){l.eform.multiView.socket.sendFocusControl(l,"out");}};this.signElement.onfocus=function(){l.focusControl();if(l.eform.multiView.isSocket){l.eform.multiView.socket.sendFocusControl(l,"in");}};}var b;var a;var m=false;this.signElement.ontouchstart=function(n){if(this.disabled){return;}b=n.touches[0].clientX;a=n.touches[0].clientY;m=true;};this.signElement.ontouchmove=function(o){if(this.disabled){return;}const n=o.touches[0].clientX;const p=o.touches[0].clientY;if(Math.abs(n-b)>10||Math.abs(p-a)>10){m=false;}};this.signElement.ontouchend=function(n){if(this.disabled){return;}if(m){m=false;n.stopPropagation();if(n.cancelable){n.preventDefault();this.onmousedown(n);}}};this.signElement.onmousedown=function(n){var o=false;if("which" in n){o=n.which==3;}else{if("button" in n){o=n.button==2;}}if(o){n.preventDefault();return;}if(l.onClick()!=false){l.eFormControlRegistered("mouse");}else{l.is_mousedown=true;}};this.signElement.onkeyup=function(n){if(32==n.keyCode){if(l.onClick()!=false){l.eFormControlRegistered("key");}else{l.is_mousedown=true;}}};this.signElement_guideInput.style.fontFamily="'"+this.controlData.fontName+"'";this.signElement_guideInput.style.fontSize=this.controlData.fontSize;this.signElement_guideInput.style.color=this.controlData.fontColor;if(this.controlData.fontBold){this.signElement_guideInput.style.fontWeight="bold";}if(this.controlData.fontItalic){this.signElement_guideInput.style.fontStyle="italic";}if(this.controlData.fontUnderline){this.signElement_guideInput.style.textDecoration="underline";}if("INPUT"==this.signElement_guideInput.tagName){this.signElement_guideInput.value=this.controlData.guideMessage;}else{var c=this.signElement_guideInput.lastChild.lastChild.lastChild;if(this.controlData.fontUnderline){c.style.textDecoration="underline";}var i=this.controlData.guideMessage;if(this.eform.m_isObjJSONSVG&&!this.eform.m_isAccessibility&&!is_ie){if(c.tagName=="SVG"){c=c.parentElement;}i=i.replace(/(\\r\\n)|(\\n)/g,"\n");c.style.fontSize=this.controlData.fontSize;mRe_autoSizeTextDraw(c,i,false,0,0,this.signElement);}else{i=i.replace(/\u3000/g,"clipu3000");i=i.replace(/\s/g,"\u00A0");i=i.replace(/clipu3000/g,String.fromCharCode(12288));if(null!=c.lastChild){c=c.lastChild;}if(typeof c.innerText!=="undefined"){c.innerText=i.replace(/(\\r\\n)|(\\n)/g,String.fromCharCode(13));}else{c.innerHTML=i.replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/\n/g,"<br />\n");}}}if(null!=this.controlData.padding){var h=this.controlData.padding;this.signElement_guideSpan.style.marginLeft=h.left*0.378+"px";this.signElement_guideSpan.style.marginTop=h.top*0.378+"px";this.signElement_guideSpan.style.marginRight=h.right*0.378+"px";this.signElement_guideSpan.style.marginBottom=h.bottom*0.378+"px";this.signElement_focusDiv.style.marginLeft=h.left*0.378+"px";this.signElement_focusDiv.style.marginTop=h.top*0.378+"px";this.signElement_focusDiv.style.marginRight=h.right*0.378+"px";this.signElement_focusDiv.style.marginBottom=h.bottom*0.378+"px";this.signRect={};if(this.signElement.style.left.indexOf("cm")!=-1){this.signRect.left=(parseFloat(this.signElement.style.left)*100)*0.378;this.signRect.top=(parseFloat(this.signElement.style.top)*100)*0.378;this.signRect.width=(parseFloat(this.signElement.style.width)*100)*0.378;this.signRect.height=(parseFloat(this.signElement.style.height)*100)*0.378;}else{this.signRect.left=parseFloat(this.signElement.style.left);this.signRect.top=parseFloat(this.signElement.style.top);this.signRect.width=parseFloat(this.signElement.style.width);this.signRect.height=parseFloat(this.signElement.style.height);}this.signElement.style.left=(this.signRect.left+(h.left*0.378))+"px";this.signElement.style.top=(this.signRect.top+(h.top*0.378))+"px";this.signElement.style.width=(this.signRect.width-((h.left+h.right)*0.378))+"px";this.signElement.style.height=(this.signRect.height-((h.top+h.bottom)*0.378))+"px";}this.m_setBGColor();this._showGuideTextVisible();this.setDisabled(this.controlData.disable,false);this.setVisible(this.controlData.visible,false);};EFormSignGroup.prototype._showGuideTextVisible=function(){if(this.isDOM){if(this.controlData.showDisplayTextInDialog){if(this.controlData.showDisplayTextByValue&&this.controlData.image!=""){this.signElement_guideInput.style.visibility="hidden";}else{this.signElement_guideInput.style.visibility="visible";}}else{this.signElement_guideInput.style.visibility="hidden";}}};EFormSignGroup.prototype.eFormControlRegistered=function(b){var c=this.eform.multiView;if(c.isSocket&&null!=c.socket&&c.socket.isMain){this.eform.mRe_subCheckFromMessage();this.eform.multiView.socket.sendSyncSignHybridView(this);}else{if(is_appControl||is_exeControl){if("mouse"==b){this.is_mousedown=true;}var a=this;window.setTimeout(function(){a.eFormHybridSignView();},window.mRe_exeCallInterval);}else{if(this.eform.m_isOldMultiSign){if(this.controlData.isDirectSign){this.focusControl();this.eFormDirectSignControl();}else{if(this.isSyncSignView){this.eFormSyncSignControl();}else{this.eFormSignControl();}}}else{if("mouse"==b){this.is_mousedown=true;}this.eFormMultiSignControl();}}}};EFormSignGroup.prototype.eFormHybridSignView=function(){if(!is_appControl&&!is_exeControl){if(this.eform.m_isOldMultiSign){this.eFormSyncSignControl();}else{this.eFormMultiSignControl();}}else{this.eform.inputOrderFoucs(this);var d=this;var r=this.eform;var q=null;if(this.eform.multiView.isSocket){q=r.multiView.socket;if(is_exeMirroring){q.sendScreenLock("exeSign",r.m_uid);}else{if(!r.m_signMirroringVisible){q.sendScreenLock("sign",r.m_uid);}}}var n;try{n=window.top;}catch(m){console.error("최상위 window 객체에 접근할 수 없습니다:",m);n=window;}var f=null;n.set_report_sign_data=n.set_report_sign_date=function(u,t){if(null!=f){clearTimeout(f);f=null;}if(u=="ok"){d.setHybridSignData(t);if(null!=q){q.sendHybridSignViewEvent(d,"ok");}d.onOkButton();d.blurControl();}else{if(u=="next"){d.setHybridSignData(t);if(null!=q){q.sendHybridSignViewEvent(d,"ok");}d.onOkButton();d.blurControl();var i=d.onNextButton();if(i){var s=r.nextHybridInputControl(d);if(!s){r.nextEasyInputControl(d);}}}else{if(u=="cencel"||u=="cancel"){if(null!=q){q.sendHybridSignViewEvent(d,"cencel");}d.onCencelButton();d.blurControl();}}}if(null!=q){q.sendScreenUnLock(r.m_uid);}};n.set_report_stamp_option=function(s,i){if(s=="call"){if(null!=q){q.sendStampCall(r.m_uid);}}else{if(s=="cancel"){if(null!=q){q.sendStampSubCancel(r.m_uid);}}else{if(s=="exe_call"){if(null!=q){q.sendExeStampCall(r.m_uid,i);}}}}};n.set_app_preview_sign=function(s,i){if(null!=q){if(null!=f){clearTimeout(f);f=null;}f=setTimeout(function(){q.sendAppPreViewSign(r.m_uid,s,i);},500);}};var a=false;var k=this.multiSignInfo();var c=new Array();var p=k.length;for(var l=0;l<p;l++){var o=k[l];var j={};j.id=o.id;j.useStamp=o.useStamp;j.stampDefaultType=o.stampDefaultType;j.title=o.title;c.push(j);if(typeof o.path!="string"){o.path="";}else{if(o.path.length==0){continue;}else{if(o.path==" "){o.path="";}else{if(o.path.charAt(0)=="["){o.path="";}}}}}if(this.eform.multiView.isSocket){q=r.multiView.socket;if(is_exeMirroring){window.setTimeout(function(){q.sendScreenLockStampButton(r.m_uid,c,0);},100);}else{if(is_appControl&&r.m_signMirroringVisible){var h=new Array();for(var g=0;g<p;g++){h.push(k[g].id);}q.sendScreenLock("appsign",r.m_uid,h);}}}if(is_appControl){ClipHybrid.callNativeControl("sign",JSON.stringify(k));}else{var b={methodName:"ShowSignatureBoard",data:k};window.external.ClipSubWebBrowserCtrl_Invoke(JSON.stringify(b));}}};EFormSignGroup.prototype.setStampStatus=function(b){this.controlData.isStampImage=b;this.controlData.stampDefaultType=b?0:1;if(this.controlData.isStampImage){this.stampImage=this.controlData.image;}else{this.stampImage=null;}var a=null;if(this.eform.multiView.isSocket){a=this.eform.multiView.socket;}if(null!=a){a.sendInputUseStamp(this,b);}};EFormSignGroup.prototype.setHybridSignData=function(h){var b=this.eform;var d=null;if(this.eform.multiView.isSocket){d=b.multiView.socket;}var g=JSON.parse(h);for(var f=0;f<g.length;f++){var i=g[f];if(typeof i.pressureCalcValue==="number"){b.m_exeSignScriptRate=i.pressureCalcValue;if(null!=d){d.sendSignScriptRate(b.m_uid,b.m_exeSignScriptRate);}}var c=b.eFormControlList[i.id];if(null!=c){c.controlData.noiCount=i.noiCount;if(""==i.base64){if(null!=c.controlData.po){c.controlData.po.move_count=0;}else{c.controlData.po={move_count:0};}}else{if(null!=c.controlData.po){c.controlData.po.move_count=1;}else{c.controlData.po={move_count:1};}}if(i.isStampImage){c.controlData.isStampImage=true;if(c.controlData.stampDefaultType!=3){c.controlData.stampDefaultType=0;}c.stampImage=i.base64;if(""!=c.stampImage){i.path=" ";}}else{c.controlData.isStampImage=false;c.controlData.stampDefaultType=1;c.stampImage="";}var a=c.setPath(i.path,true,false);if(!a){c.setValue(i.base64);if(null!=d){if(null!=b.multiView&&null!=b.multiView.socket&&b.multiView.socket.wsPath!="localhost"){d.sendInputSignPath(c,i.path);}else{d.sendInputSignPathAll(c,i.path);}d.sendInputUseStamp(c,i.isStampImage);}}else{if(null!=d){if(null!=b.multiView&&null!=b.multiView.socket&&b.multiView.socket.wsPath!="localhost"){d.sendInputSignApplyPath(c,i.path);}else{d.sendInputSignApplyPathAll(c,i.path);}d.sendInputUseStamp(c,i.isStampImage);}}c.subSectionSyncValuePath();}else{mRe_ReportWebLog("not Found Control!! stackFlow function : setHybridSignData control id:"+i.id);}}};EFormSignGroup.prototype.getCtrlID=function(){return this.ctrlID;};EFormSignGroup.prototype.getType=function(){return this.controlData.type;};EFormSignGroup.prototype.getValue=function(){return this.controlData.image;};EFormSignGroup.prototype.setValue=function(c,d){this.m_default_setValue(c);this.setSendValue(c);if(this.controlData.repeatSync){if(typeof d=="undefined"){d=true;}if(d){var a=eform.findCloneControl(this);for(var b=0;b<a.length;b++){a[b].m_default_setValue(c,false);}}}};EFormSignGroup.prototype.getPath=function(){var a=this.controlData.pathString;if(typeof a==="object"){a=mRe_copyObj(a);return a;}else{return a;}};EFormSignGroup.prototype.setOriginalPath=function(c,b,d,a){if(typeof b=="undefined"){b=true;}if(typeof d=="undefined"){d=true;}if(typeof a=="undefined"){a=false;}this.setPath(c,b,d,a,false);};EFormSignGroup.prototype.setPath=function(c,b,g,a,f){this.m_signTempInfo={width:0,height:0,path:null};var d=this.m_setPath(c,b,g,a,f);return d;};EFormSignGroup.prototype.m_setPath=function(c,b,g,a,f){if(typeof f=="undefined"){f=true;}if(typeof b=="undefined"){b=true;}if(typeof g=="undefined"){g=true;}if(typeof a=="undefined"){a=false;}var d=this.m_default_setPath(c,b,f);if(this.eform.multiView.isSocket&&g){this.eform.multiView.socket.sendSignPath(this,c,(d&&a));}return d;};EFormSignGroup.prototype.m_default_setPath=function(F,k,m){this.controlData.pathString=F;if(null==F||this.eform.isSubWebApp||is_appControl){return false;}var A=true;if(typeof F=="string"&&F.indexOf("|")!=-1){var D=[];var C=F.split("|");var a=null;var E=[];var v=this.controlData.penColor;for(var g=0;g<C.length;g++){var n=C[g];if(!is_appControl){var l=n.split(";");var o=0;if(l.length>2){o=Number(l[2])/this.eform.m_exeSignScriptRate;}var i=l[0];var w=i.split(",");if(w.length==2){if(null==a||(a[0]!=w[0]||a[0]!=w[0])){E=[];D.push(E);var f={};f.x=Number(w[0]);f.y=Number(w[1]);f.color=v;f.w=o;E.push(f);}var s=l[1];var a=s.split(",");var d={};d.x=Number(a[0]);d.y=Number(a[1]);d.color=v;d.w=o;E.push(d);}}else{k=false;break;}}F=D;A=false;m=true;}if(typeof F!=="string"&&k){var h=mRe_PathCount(F);if(null!=this.controlData.po){this.controlData.po.move_count=h;}else{this.controlData.po={move_count:h};}var c=this.controlData;if(h>this.eform.m_signMoveCount){c.is_nc=false;}else{if(c.isNecessaryCheck=="true"){c.is_nc=true;}}if(c.po.move_count==0){c.image="";c.pathString=null;}var b=null;if(this.isDOM){b=this.signElement_canas;var r=this.signElement_guideSpan;var u=c.isNecessaryCheck=="true"?" eForm_inputNecessary":"";if(c.disable){r.className="eF_Rect eForm_inputDisabled "+this.disabledClass;}else{if(c.is_nc){if(this.eform.eForm_isNecessary.check&&c.isNecessaryCheck=="true"){r.className="eF_Rect eForm_NecessaryCheck";}else{r.className="eF_Rect eForm_inputDefault_bg"+u;}}else{r.className="eF_Rect eForm_inputDefault_bg"+u;}}}else{b=document.createElement("CANVAS");b.width=c.width;b.height=c.height;}var z=new SignaturePad(b,{minWidth:c.penWidth,maxWidth:(c.penWidth+c.signStrokeWidth)});z.clear();z.off();if(c.po.move_count!=0){z.throttle=3;z.minDistance=0;if(!A){z.isSetPathPaint=true;}var t=mRe_copyObj(F);if(m){var q=mRe_RectPoint(t);mRe_RatePath(t,1,"/",-(q.x1-10),-(q.y1-10));var j=c.width;var p=c.height;var y=0;var x=0;if(this.eform.m_eformSignMarginSync){j-=(this.controlData.margin.left+this.controlData.margin.right);p-=(this.controlData.margin.top+this.controlData.margin.bottom);y=this.controlData.margin.left;x=this.controlData.margin.top;}var B=mRe_calcRect((q.x2-q.x1+20),(q.y2-q.y1+20),j,p);mRe_RatePath(t,B.canvasRate,"/",B.offsetX+y,B.offsetY+x);if(A){c.pathString=t;}else{}}if(is_exeMirroring&&(typeof B!="undefined")){z.fromDataToExe(t,B.canvasRate,this.controlData.penColor);}else{z.fromData(t);}c.image=z.toDataURL().split("base64,")[1];this.eform.mRe_validationCanvas(c.image,c.width,c.height);z.isSetPathPaint=false;}this._showGuideTextVisible();return true;}return false;};EFormSignGroup.prototype.setSendValue=function(a){if(this.eform.multiView.isSocket){this.eform.multiView.socket.sendInputSign(this,a);}};EFormSignGroup.prototype.isSyncSignView=function(){return this.isSyncSignView;};EFormSignGroup.prototype.setSyncSignView=function(a){if(this.eform.multiView.isSocket){this.isSyncSignView=a;}};EFormSignGroup.prototype.m_default_setValue=function(c){this.controlData.image=c;if(this.controlData.isStampImage){this.stampImage=c;}if(""==c&&this.controlData.isNecessaryCheck=="true"){this.controlData.is_nc=true;}else{this.controlData.is_nc=false;}if(this.isDOM){drawReportReSizeSign(this.signElement_canas,this.controlData);var a=this.controlData.isNecessaryCheck=="true"?" eForm_inputNecessary":"";if(this.controlData.disable){this.signElement_guideSpan.className="eF_Rect eForm_inputDisabled "+this.disabledClass;}else{if(this.controlData.is_nc){if(this.eform.eForm_isNecessary.check&&this.controlData.isNecessaryCheck=="true"){this.signElement_guideSpan.className="eF_Rect eForm_NecessaryCheck";}else{this.signElement_guideSpan.className="eF_Rect eForm_inputDefault_bg"+a;}}else{this.signElement_guideSpan.className="eF_Rect eForm_inputDefault_bg"+a;}}this._showGuideTextVisible();}else{var b=document.createElement("canvas");b.width=this.controlData.width;b.height=this.controlData.height;drawReportReSizeSign(b,this.controlData);}};EFormSignGroup.prototype.setNecessaryCheck=function(a,b){if(typeof b=="undefined"){b=false;}if(a){this.controlData.isNecessaryCheck="true";if(""!=this.controlData.image){this.controlData.is_nc=false;}else{this.controlData.is_nc=true;}if(this.isDOM){this._showGuideTextVisible();}}else{this.controlData.is_nc=false;this.controlData.isNecessaryCheck="false";if(this.isDOM){this.signElement_guideSpan.className="eF_Rect";}}this.setDisabled(this.controlData.disable,false);this.setVisible(this.controlData.visible,false);if(b){if(this.eform.multiView.isSocket){this.eform.multiView.socket.sendNecessaryCheck(this,a);}}};EFormSignGroup.prototype.getVisible=function(){return this.controlData.visible;};EFormSignGroup.prototype.setVisible=function(a,b){if(typeof b=="undefined"){b=false;}this.controlData.visible=a;if(this.isDOM){if(a){this.signElement.style.display="";this.signElement_canas.style.display="";this.signElement_guideSpan.style.display="";this.signElement_focusDiv.style.display="";this.signElement_guideInput.style.display="";}else{this.signElement.style.display="none";this.signElement_canas.style.display="none";this.signElement_guideSpan.style.display="none";this.signElement_focusDiv.style.display="none";this.signElement_guideInput.style.display="none";}}if(b){if(this.eform.multiView.isSocket){this.eform.multiView.socket.sendVisibled(this,a);}}};EFormSignGroup.prototype.setDisabledClass=function(a){this.disabledClass=a;if(this.isDOM){this.setDisabled(this.controlData.disable,false);}};EFormSignGroup.prototype.getDisabled=function(){return this.controlData.disable;};EFormSignGroup.prototype.setDisabled=function(g,h,f){if(typeof h=="undefined"){h=false;}if(typeof f=="undefined"){f=true;}this.controlData.disable=g;var c=g;if(this.isDOM){var d=this.eform.isEasyInput?0:this.controlData.pageNumber;var a=this.eform.m_eformPageDisabled[d];if(null==a){a=false;}if(g||a||this.eform.m_eformDisabled){c=true;this.signElement.disabled=true;this.signElement_guideSpan.className="eF_Rect eForm_inputDisabled "+this.disabledClass;}else{c=false;this.signElement.disabled=false;var b=this.controlData.isNecessaryCheck=="true"?" eForm_inputNecessary":"";if(this.controlData.is_nc){if(this.eform.eForm_isNecessary.check&&this.controlData.isNecessaryCheck=="true"){this.signElement_guideSpan.className="eF_Rect eForm_NecessaryCheck";}else{this.signElement_guideSpan.className="eF_Rect eForm_inputDefault_bg"+b;}}else{this.signElement_guideSpan.className="eF_Rect eForm_inputDefault_bg"+b;}}}if(h){if(this.eform.multiView.isSocket){this.eform.multiView.socket.sendDisabled(this,g);}}if(null!=this.eform.ctrlEvent.disabledEvent&&f){this.eform.ctrlEvent.disabledEvent(c,this);}};EFormSignGroup.prototype.setGuideBGColor=function(b,a,d,c,f){if(typeof f=="undefined"){f=true;}this.controlData.bgColor="rgba("+b+","+a+","+d+","+c+")";if(this.isDOM){this.signElement_guideSpan.style.backgroundColor=this.controlData.bgColor;}if(this.eform.multiView.isSocket&&f){this.eform.multiView.socket.sendControlColor(this,b,a,d,c);}};EFormSignGroup.prototype.m_setBGColor=function(){if(null!=this.controlData.bgColor){if(this.isDOM){this.signElement_guideSpan.style.backgroundColor=this.controlData.bgColor;}}};EFormSignGroup.prototype.setGuideTextVisible=function(a){this.controlData.showDisplayTextInDialog=a;this._showGuideTextVisible();};EFormSignGroup.prototype.setGuideText=function(b,c){if(typeof c=="undefined"){c=false;}if(!this.controlData.useText){return;}this.controlData.guideMessage=b.replace(/\\\//g,"/").replace(/\\\\/g,"\\").replace(/\\\"/g,'"');if(this.isDOM){if("INPUT"==this.signElement_guideInput.tagName){this.signElement_guideInput.value=this.controlData.guideMessage;}else{var d=this.signElement_guideInput.lastChild.lastChild.lastChild;var a=this.controlData.guideMessage;if(this.eform.m_isObjJSONSVG&&!this.eform.m_isAccessibility&&!is_ie){if(d.tagName=="SVG"){d=d.parentElement;}a=a.replace(/(\\r\\n)|(\\n)/g,"\n");d.style.fontSize=this.controlData.fontSize;mRe_autoSizeTextDraw(d,a,false);}else{a=a.replace(/\u3000/g,"clipu3000");a=a.replace(/\s/g,"\u00A0");a=a.replace(/clipu3000/g,String.fromCharCode(12288));if(null!=d.lastChild&&"TD"!=d.tagName){d=d.lastChild;}if(typeof d.innerText!=="undefined"){d.innerText=a.replace(/(\\r\\n)|(\\n)/g,String.fromCharCode(13));}else{d.innerHTML=a.replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/\n/g,"<br />\n");}}}this._showGuideTextVisible();}if(c){if(this.eform.multiView.isSocket){this.eform.multiView.socket.sendGuideText(this,b);}}};EFormSignGroup.prototype.getIndexOrderDisabled=function(){return this.controlData.indexOrderDisable;};EFormSignGroup.prototype.setIndexOrderDisabled=function(a){this.controlData.indexOrderDisable=a;};EFormSignGroup.prototype.onClickEvent=function(a){this.event.clickEvent=a;this.event.eventTarget=this;};EFormSignGroup.prototype.onOkButtonEvent=function(a){this.event.okButtonEvent=a;this.event.eventTarget=this;};EFormSignGroup.prototype.onNextButtonEvent=function(a){this.event.nextButtonEvent=a;this.event.eventTarget=this;};EFormSignGroup.prototype.onCencelButtonEvent=function(a){this.event.cencelButtonEvent=a;this.event.eventTarget=this;};EFormSignGroup.prototype.click=function(){if(this.isDOM&&!this.controlData.disable&&this.controlData.visible){this.signElement.focus();if(this.onClick()!=false){this.eFormControlRegistered("key");}}};EFormSignGroup.prototype.getName=function(){var a=this.ctrlID;if(-1!=a.indexOf(".")){a=a.substring(a.indexOf(".")+1);}a=decodeURI(a.replace(/[r]/g,"%"));a=a.substring(0,a.lastIndexOf("_"));return a;};EFormSignGroup.prototype.getTitle=function(){return this.title;};EFormSignGroup.prototype.setTitle=function(a){this.title=a;if(this.isDOM){this.signElement.title=a;this.signElement.innerHTML=a;}};EFormSignGroup.prototype.setMainTitle=function(a){if(null!=this.controlData){this.controlData.title=a;}};EFormSignGroup.prototype.getMainTitle=function(){if(null!=this.controlData){return this.controlData.title;}return null;};EFormSignGroup.prototype.getDetailTitle=function(){return this.controlData.detailTitle;};EFormSignGroup.prototype.setDetailTitle=function(a){this.controlData.detailTitle=a;};EFormSignGroup.prototype.onClick=function(){var a=true;if(null!=this.event.clickEvent){a=this.event.clickEvent(this);}if(null!=this.eform.ctrlEvent.signClickEvent){a=this.eform.ctrlEvent.signClickEvent(this);}if(this.eform.multiView.isSocket){this.eform.multiView.socket.sendSignClickEvent(this);}return a;};EFormSignGroup.prototype.receiveClick=function(){if(null!=this.eform.ctrlEvent.signClickEvent){this.eform.ctrlEvent.signClickEvent(this);}};EFormSignGroup.prototype.onOkButton=function(){if(null!=this.event.okButtonEvent){this.event.okButtonEvent(this);}if(null!=this.eform.ctrlEvent.signOkButtonEvent){this.eform.ctrlEvent.signOkButtonEvent(this);}};EFormSignGroup.prototype.onCencelButton=function(){if(null!=this.event.cencelButtonEvent){this.event.cencelButtonEvent(this);}if(null!=this.eform.ctrlEvent.signCencelButtonEvent){this.eform.ctrlEvent.signCencelButtonEvent(this);}};EFormSignGroup.prototype.onNextButton=function(){var a=true;if(null!=this.event.nextButtonEvent){a=this.event.nextButtonEvent(this);}if(null!=this.eform.ctrlEvent.signNextButtonEvent){a=this.eform.ctrlEvent.signNextButtonEvent(this);}return a;};EFormSignGroup.prototype.getPageNumber=function(){if(typeof this.controlData.pageNumber=="undefined"){return null;}return this.controlData.pageNumber+1;};EFormSignGroup.prototype.focus=function(){if(this.isDOM){var a=this.signElement;setTimeout(function(){a.focus();},1);}else{if(!this.eform.isEasyInput){this.eform.m_isrulesControlInfo=this.ctrlID;this.eform.sendRulesControlInfo();this.eform.selectPage(this.controlData.pageNumber,"control_focus");}}};EFormSignGroup.prototype.getSignCheck=function(){if(this.controlData.po){if(this.controlData.po.move_count>0){return true;}}return false;};EFormSignGroup.prototype.getSignPathCount=function(){if(this.controlData.po){return this.controlData.po.move_count;}return 0;};EFormSignGroup.prototype.blurControl=function(){var a=this.signElement_focusDiv;if(null!=a){a.className="eF_Rect";this.eform.inputImagePointerOut();}if(this.eform.multiView.isSocket){this.eform.multiView.socket.sendFocusControl(this,"out");}};EFormSignGroup.prototype.focusControl=function(){if(null!=this.signElement_focusDiv){this.eform.mRe_inputFocusRectBlur();this.signElement_focusDiv.className="eF_Rect eform_control_focus";this.eform.inputImagePointerIn(this);if(this.eform.titleSpeechBubble.visible.signGroup){this.eform.inputCreateTitleSpeechBubble(this);}else{this.eform.inputRemoveTitleSpeechBubble();}if(this.eform.m_isHybridQuickControl||null!=this.controlData.inputOrder){this.eform.inputOrderFoucs(this);}else{this.eform.inputOrderBlur();}if(this.eform.m_isHybridQuickControl&&(is_appControl||is_exeControl)){if(null!=this.controlData.inputOrder){if(!this.is_mousedown){var a=this;window.setTimeout(function(){a.eFormHybridSignView();},window.mRe_exeCallInterval);}if(event.stopPropagation){event.stopPropagation();}else{event.cancelBubble=true;}}}else{if(!this.eform.m_isOldMultiSign&&!this.is_mousedown&&!this.eform.multiView.isSocket){if(!is_appControl&&!is_exeControl){this.eFormMultiSignControl();}if(event.stopPropagation){event.stopPropagation();}else{event.cancelBubble=true;}}}this.is_mousedown=false;}};EFormSignGroup.prototype.multiViewFocus=function(){if(null==mRe_FocusControl.objCtrl||mRe_FocusControl.objCtrl!=this){mRe_FocusControl.objCtrl=this;if(this.isDOM){if(this.eform.m_isMultiViewFoucs){this.signElement.focus();}else{this.eform.mRe_inputFocusRectBlur();this.signElement_focusDiv.className="eF_Rect eform_control_focus";this.eform.inputImagePointerIn(this);if(this.eform.titleSpeechBubble.visible.signGroup){this.eform.inputCreateTitleSpeechBubble(this);}else{this.eform.inputRemoveTitleSpeechBubble();}if(this.eform.m_isHybridQuickControl){this.eform.inputOrderFoucs(this);}}}}};EFormSignGroup.prototype.multiViewBlur=function(){mRe_FocusControl={objCtrl:null};if(this.isDOM){this.signElement_focusDiv.className="eF_Rect";this.eform.inputImagePointerOut();}};EFormSignGroup.prototype.multiViewSignLock=function(a){if(this.isDOM){if(a=="lock"){this.signElement_focusDiv.innerHTML="<font style='font-size:10pt;color:gray;'>사용자 입력중..</font>";if(!this.controlData.disable){this.signElement.disabled=true;}}else{this.signElement_focusDiv.innerHTML="";if(!this.controlData.disable){this.signElement.disabled=false;}}}};function drawReportSign(c,a){var d=c.getContext("2d");d.clearRect(0,0,c.width,c.height);var b=new Image();d.Re_image=b;b.onload=function(){d.drawImage(this,0,0,c.width,c.height);d.Re_image=null;};b.src="data:image/png;base64,"+a.image;}function resetReportSign(a){var b=a.getContext("2d");b.clearRect(0,0,a.width,a.height);if(null!=b.Re_image){b.Re_image.onload=null;b.Re_image=null;}}function drawReportReSizeSign(d,b){var f=d.getContext("2d");f.clearRect(0,0,d.width,d.height);var c=new Image();f.Re_image=c;var g=d.width;var i=d.height;var h=g/d.offsetWidth;var a=i/d.offsetHeight;c.onload=function(){var l=this.width*h;var j=this.height*a;var n={x:0,y:0,width:0,height:0};if((l==g&&j==i)||((l/g)==(j/i))){n.width=d.width;n.height=d.height;}else{if(l<g&&j<i){n.width=l;n.height=j;n.x=(d.width-n.width)/2;n.y=(d.height-n.height)/2;}else{if((l/g)>(j/i)){n.width=d.width;var m=l/g;n.height=(j/m);n.y=(d.height-n.height)/2;}else{n.height=d.height;var k=j/i;n.width=(l/k);n.x=(d.width-n.width)/2;}}}f.clearRect(0,0,d.width,d.height);f.drawImage(this,n.x,n.y,n.width,n.height);b.image=d.toDataURL().substring(22);f.Re_image=null;};c.src="data:image/png;base64,"+b.image;}EFormSignGroup.prototype.multiSignInfo=function(){var d=new Array();var l=this.group.getControlList();var b=l.length;for(var f=0;f<b;f++){var i=l[f];var h=i.controlData;if(i.isDOM){if(i.signElement.offsetWidth==0){continue;}}if((h.pageNumber==this.eform.beforePageIndex||this.eform.isEasyInput)&&"signGroup"==i.getType()&&h.visible&&!h.disable){var a=new Object();if(this.ctrlID==i.ctrlID){a.isFocus=true;}else{a.isFocus=false;}a.id=i.ctrlID;a.key=h.id;a.rName=h.rName;a.title=h.title;a.detailTitle=h.detailTitle;a.guideMsg=h.guideMessage;a.width=h.width;a.height=h.height;a.path=h.pathString;a.penWidth=h.penWidth;a.signStrokeWidth=h.signStrokeWidth;a.penColor=h.penColor;a.minNumberOfDrawing=h.minNumberOfDrawing;a.minNumberMessage=h.minNumberMessage==""?"입력한 획수가 부족합니다.":h.minNumberMessage;a.isMainStampScanner=false;a.isSignRatioCorrection=(b==2?this.eform.isSignRatioCorrection:false);if(i.eform.m_isObjectStamp){a.useStamp=h.useStamp;if(a.useStamp){a.isMainStampScanner=this.eform.isMainStampScanner;if(null!=h.image&&h.image.length>0){if(typeof h.pathString==="string"&&" "==h.pathString){i.isStampCheck=true;i.stampImage=h.image;}}}a.isStampCheck=i.isStampCheck;a.stampImage=i.stampImage;}else{a.useStamp=false;}a.noSign=h.noSign;a.noiCount=h.noiCount;a.stampDefaultType=h.stampDefaultType;a.isNecessaryCheck=(h.isNecessaryCheck=="true");a.image=h.image;a.fontBold=h.fontBold;a.fontItalic=h.fontItalic;a.fontUnderline=h.fontUnderline;if(null!=h.margin){var c=h.margin;a.signMargin={left:c.left,top:c.top,width:(h.width-c.left-c.right),height:(h.height-c.top-c.bottom)};}else{a.signMargin={left:0,top:0,width:h.width,height:h.height};}a.h_align="center";a.v_align="middle";a.s_width=i.m_signTempInfo.width;a.s_height=i.m_signTempInfo.height;a.s_tempPath=i.m_signTempInfo.path;a.isMirroring=!this.eform.getIsMain();if(i.isDOM){var k=i.signElement_guideInput;if("TABLE"==k.firstChild.tagName){try{var j=k.lastChild;while("TD"!=j.tagName){j=j.lastChild;}a.h_align=j.align;a.v_align=j.vAlign;}catch(g){ReportWebLog(g.stack);}}}d.push(a);}}return d;};EFormSignGroup.prototype.eFormFocusClassReset=function(f){var a=this.eform;for(var c=0;c<f.length;c++){var d=f[c];var b=a.eFormControlList[d.id];if(null!=b){if(b.isDOM){if(null!=b.signElement_multiFocusDiv){var g=b.signElement_multiFocusDiv.parentElement;g.removeChild(b.signElement_multiFocusDiv);b.signElement_multiFocusDiv=null;}}}}a.paintDiv.style.bottom=null;};EFormSignGroup.prototype.eFormFocusClassCreate=function(k,p){var q=this.eform;if(this.isDOM){if(q.m_isBottomPopScroll){q.paintDiv.style.bottom=p+"px";var c=this.getHE();var a=q.eFormDoodleOption.zoomIn;var f=is_edge?c.offsetTop/a:c.offsetTop;var g=is_edge?c.offsetLeft/a:c.offsetLeft;f=f+c.parentElement.offsetTop;g=g+c.parentElement.offsetLeft;var b=(q.paintDiv.offsetWidth-c.offsetWidth)/2;var n=(q.paintDiv.offsetHeight-c.offsetHeight)/2;var h=(g-(b/a))*a;var d=(f-100)*a;q.paintDiv.scrollLeft=h;q.paintDiv.scrollTop=d;}}for(var l=0;l<k.length;l++){var i=k[l];var o=q.eFormControlList[i.id];if(null!=o){if(o.isDOM){var m=o.signElement_focusDiv.parentElement;var j=document.createElement("div");j.className="eF_Rect eForm_multiSign_focus";m.appendChild(j);o.signElement_multiFocusDiv=j;}}}};EFormSignGroup.prototype.sendScreenMultiSignPath=function(a,d,c,b){if(null!=d&&""!=d){window.setTimeout(function(){a.sendScreenSingleSignPath(d,c,b);},100);}};EFormSignGroup.prototype.eFormMultiSignControl=function(){if(this.eform.m_isButtonLock==false){if(null!=this.eform.signPaintDiv){return;}if(this.isDOM){this.signElement.blur();}window.is_clipSignPlugin=true;var u=this;var G=this.eform;G.disabledMenu(true);Re_zoom.isPop=true;var n=G.m_bodyDiv.offsetWidth;var p=G.targetDiv.offsetHeight;var F=p>n;if(this.eform.m_multiSignViewType==1){F=false;}else{if(this.eform.m_multiSignViewType==2){F=true;}}if(G.m_isBottomPopHeight>0){if(p>n){p=G.m_isBottomPopHeight;}else{p=G.m_isBottomPopLandscapeHeight;}}else{p=F?(G.targetDiv.offsetHeight*0.7):(G.targetDiv.offsetHeight/2);}var K=document.createElement("div");if(is_smartphone){K.className="m_eform_sign_background";}else{K.className="eform_sign_background";}K.style.background="rgba(155,155,155,0.3)";K.addEventListener("touchstart",function(i){if(i.touches.length>1){i.preventDefault();}i.stopPropagation();},false);var Q=document.createElement("div");if(G.m_isBottomPopHeight>0){Q.style.height=(p)+"px";}else{Q.style.height=(p<230?210:p)+"px";}Q.className="eform_multiSign_body";var v=document.createElement("div");v.className="eform_multiSign_header";var c=document.createElement("div");c.className="eform_multiSign_header_Label";var y=document.createElement("nobr");c.appendChild(y);var V=document.createElement("button");V.className="eform_multiSign_close_button";var S=document.createElement("button");S.className="eform_multiSign_save_button";var z=document.createElement("button");z.className="eform_multiSign_next_button";v.appendChild(c);v.appendChild(V);v.appendChild(S);v.appendChild(z);Q.appendChild(v);K.appendChild(Q);G.m_bodyDiv.appendChild(K);this.eform.signPaintDiv=K;var h=this.multiSignInfo();var L=h.length;this.eFormFocusClassCreate(h,p);var O=n/L;var R=[];if(L==2&&this.eform.isSignRatioCorrection){R[0]=n*(h[0].width/(h[0].width+h[1].width));R[1]=n*(h[1].width/(h[0].width+h[1].width));}else{for(var P=0;P<L;P++){R.push(O);}}var J=(p-60)/L;var t="";if(G.m_isBottomPopTitle){t=this.controlData.title;}var N=null;if(this.eform.isUseSignGroupSlide){N=document.createElement("div");N.className="eform_multiSign_frame_Layout_slide";N.style.width=(n*L)+"px";Q.appendChild(N);}var f=null;if(this.eform.multiView.isSocket){f=G.multiView.socket;if(G.m_signMirroringVisible){var k=new Array();for(var P=0;P<L;P++){k.push(h[P].id);}f.sendScreenLock("singlesign",G.m_uid,k);window.mRe_multiSign_reset={};}else{f.sendScreenLock("sign",G.m_uid);}}var j=0;var a=0;for(var P=0;P<L;P++){if(!G.m_isBottomPopTitle){if(h[P].title!=""){if(""!=t&&0!=P){t+=" / "+h[P].title;}else{t+=h[P].title;}}}if(h[P].id==this.ctrlID){j=P;}var b=document.createElement("div");if(this.eform.isUseSignGroupSlide){b.className="eform_multiSign_frame_slide";b.style.left=(P*n)+"px";b.style.width=n+"px";}else{if(F){b.className="eform_multiSign_frameY";b.style.top=((P*J)+v.offsetHeight)+"px";b.style.height=J+"px";}else{b.className="eform_multiSign_frame";b.style.left=(a)+"px";b.style.width=R[P]+"px";a+=R[P];}}if(this.eform.isUseSignGroupSlide){N.appendChild(b);}else{Q.appendChild(b);}var E=document.createElement("div");E.className="eform_multiSign_frame_Label";var U=document.createElement("nobr");E.appendChild(U);U.innerHTML=h[P].detailTitle;b.appendChild(E);var B=document.createElement("button");B.setAttribute("signNum",P);B.className="eform_multiSign_frameReset_button";b.appendChild(B);if(this.eform.isUseSignGroupSlide){E.style.left="150px";}var d=null;var m=false;if(typeof getControlEventRulesCommand!="undefined"){m=true;if(this.eform.multiView.isSocket){if(!this.eform.multiView.socket.isMain){m=false;}}}if(h[P].useStamp){E.style.right="260px";var d=document.createElement("button");d.id=G.m_uid+"webStamp"+h[P].id;d.setAttribute("signNum",P);d.className="eform_multiSign_frameStamp_button";d.innerText=window.objClipStampName;if(!m){d.style.display="none";}b.appendChild(d);}var s=document.createElement("table");s.style.cssText="table-layout:fixed;position:absolute;left:0px;top:0px;width:100%;height:100%;";s.border="0";s.cellspacing="0";s.cellpadding="0";var w=document.createElement("tr");s.appendChild(w);var D=document.createElement("td");D.className="eform_multiSign_frame_Guide";D.align=h[P].h_align;D.vAlign=h[P].v_align;var I=h[P].guideMsg;I=I.replace(/\u3000/g,"clipu3000");I=I.replace(/\s/g,"\u00A0");I=I.replace(/clipu3000/g,String.fromCharCode(12288));D.innerHTML=I.replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/\n|\\r\\n/g,"<br />");w.appendChild(D);var T=document.createElement("div");T.className="eform_multiSign_frame_body";T.appendChild(s);b.appendChild(T);var l=document.createElement("div");l.className="eform_multiSign_frame_body";l.style.backgroundColor="transparent";b.appendChild(l);l.addEventListener("touchstart",function(i){i.preventDefault();},false);var q=document.createElement("canvas");l.appendChild(q);q.width=l.offsetWidth;q.height=l.offsetHeight;var M=this.controlData;var A=new SignaturePad(q,{},G.eFormControlList[h[P].id]);A.minWidth=h[P].penWidth;A.maxWidth=h[P].penWidth+h[P].signStrokeWidth;A.penColor=h[P].penColor;A.throttle=3;A.minDistance=1;if(h[P].isStampCheck){A.fromDataURL("data:image/png;base64,"+h[P].stampImage,{ratio:1});A.off();}else{if(null!==h[P].path&&(typeof h[P].path!=="string")){if(h[P].s_width==T.offsetWidth&&h[P].s_height==T.offsetHeight){A.fromData(h[P].s_tempPath);}else{var r=mRe_copyObj(h[P].path);var C=mRe_RectPoint(r);mRe_RatePath(r,1,"/",-(C.x1-5),-(C.y1-5));var x=mRe_calcRect((C.x2-C.x1+10),(C.y2-C.y1+10),T.offsetWidth,T.offsetHeight);mRe_RatePath(r,x.canvasRate,"/",x.offsetX,x.offsetY);A.fromData(r);}}}h[P].jSign=A;h[P].s_width=T.offsetWidth;h[P].s_height=T.offsetHeight;if(null!=f&&G.m_signMirroringVisible){this.sendScreenMultiSignPath(f,h[P].jSign.toData(),G.m_uid,h[P].id);}if(null!=window.mRe_multiSign_reset){window.mRe_multiSign_reset[h[P].id]=B;}B.ctrlID=h[P].id;B.onclick=B.ontouchstart=function(i){var W=h[this.getAttribute("signNum")];W.jSign.clear();W.jSign.on();W.isStampCheck=false;W.stampImage="";if(null!=f&&G.m_signMirroringVisible){f.sendScreenSingleSignPathClear(G.m_uid,this.ctrlID);}i.preventDefault();};if(null!=d){d.onclick=d.ontouchstart=function(i){if(typeof window.getControlStampEventCommand!=="undefined"){getControlStampEventCommand(h[this.getAttribute("signNum")],G.m_uid);}G.mRe_runStamp(h[this.getAttribute("signNum")],"인감<br>스캔중");i.preventDefault();};}}if(this.eform.isUseSignGroupSlide){N.style.left=(j*(-n))+"px";var o=document.createElement("button");o.className="eform_multiSign_frame_slide_left";var g=document.createElement("div");g.className="eform_multiSign_frame_slide_label";g.innerText=(j+1)+"/"+L;var H=document.createElement("button");H.className="eform_multiSign_frame_slide_right";Q.appendChild(o);Q.appendChild(g);Q.appendChild(H);o.onclick=o.ontouchstart=function(i){if(j>0){j--;g.innerText=(j+1)+"/"+L;N.style.left=(j*(-n))+"px";}i.preventDefault();};H.onclick=H.ontouchstart=function(i){if((j+1)<L){j++;g.innerText=(j+1)+"/"+L;N.style.left=(j*(-n))+"px";}i.preventDefault();};}else{y.innerHTML=t;}window.mRe_multiSign_close=V;V.onclick=V.ontouchstart=function(X){u.eFormFocusClassReset(h);u.eform.signPaintDiv=null;mRe_reSetPopupStatus();for(var W=0;W<L;W++){h[W].jSign=null;}G.m_bodyDiv.removeChild(K);G.disabledMenu(false);u.is_mousedown=true;u.signElement.focus();if(null!=f){f.sendHybridSignViewEvent(u,"cencel");}u.onCencelButton();if(null!=f){f.sendScreenUnLock(G.m_uid);}X.preventDefault();};window.mRe_multiSign_ok=S;S.onclick=S.ontouchstart=function(X){u.eFormFocusClassReset(h);u.eform.signPaintDiv=null;mRe_reSetPopupStatus();u.setMultiSignData(h);for(var W=0;W<L;W++){h[W].jSign=null;}G.m_bodyDiv.removeChild(K);G.disabledMenu(false);u.is_mousedown=true;u.signElement.focus();if(null!=f){f.sendHybridSignViewEvent(u,"ok");}u.onOkButton();if(null!=f){f.sendScreenUnLock(G.m_uid);}X.preventDefault();};z.onclick=z.ontouchstart=function(Z){u.eFormFocusClassReset(h);u.eform.signPaintDiv=null;mRe_reSetPopupStatus();u.setMultiSignData(h);for(var Y=0;Y<L;Y++){h[Y].jSign=null;}G.m_bodyDiv.removeChild(K);G.disabledMenu(false);if(null!=f){f.sendHybridSignViewEvent(u,"ok");}var W=u.onNextButton();if(W){var X=G.nextHybridInputControl(u);if(!X){G.nextEasyInputControl(u);}}if(null!=f){f.sendScreenUnLock(G.m_uid);}Z.preventDefault();};}};EFormSignGroup.prototype.setMultiSignData=function(j){var s=this.eform;var h=null;if(this.eform.multiView.isSocket){h=s.multiView.socket;}for(var f=0;f<j.length;f++){var c=j[f];var k=s.eFormControlList[c.id];if(null!=k){var d=c.jSign;d.off();var q=null;var g=null;if(c.isStampCheck){k.isStampCheck=c.isStampCheck;k.stampImage=c.stampImage;if(null==c.stampImage||""==c.stampImage){g=0;}else{g=1000;}}else{k.isStampCheck=false;k.stampImage=null;q=d.toData();g=mRe_PathCount(q);}if(null!=k.controlData.po){k.controlData.po.move_count=g;}else{k.controlData.po={move_count:g};}var b=k.controlData;if(g>this.eform.m_signMoveCount){b.is_nc=false;}else{if(b.po.move_count!=0&&b.isNecessaryCheck=="true"){b.is_nc=true;}}this.eform.signPaintDiv=null;var a=k.signElement_canas;var t=new SignaturePad(a,{minWidth:b.penWidth,maxWidth:(b.penWidth+b.signStrokeWidth)});t.clear();t.off();if(c.isStampCheck){t.fromDataURL("data:image/png;base64,"+c.stampImage,{ratio:1});t.setStampControl(k);}else{if(((b.po.move_count==0)||b.po.move_count==0&&""==b.image)&&b.isNecessaryCheck=="true"){b.image="";b.is_nc=true;b.pathString=null;}else{k.m_signTempInfo.path=q;k.m_signTempInfo.width=c.s_width;k.m_signTempInfo.height=c.s_height;tempPath=mRe_copyObj(q);var n=mRe_RectPoint(tempPath);mRe_RatePath(tempPath,1,"/",-(n.x1-40),-(n.y1-40));var i=b.width;var l=b.height;var r=0;var p=0;if(this.eform.m_eformSignMarginSync){i-=(this.controlData.margin.left+this.controlData.margin.right);l-=(this.controlData.margin.top+this.controlData.margin.bottom);r=this.controlData.margin.left;p=this.controlData.margin.top;}var u=mRe_calcRect((n.x2-n.x1+80),(n.y2-n.y1+80),i,l);mRe_RatePath(tempPath,u.canvasRate,"/",u.offsetX+r,u.offsetY+p);b.pathString=tempPath;t.isSetPathPaint=true;t.fromData(tempPath);if(g==0){b.image="";}else{b.image=t.toDataURL().split("base64,")[1];this.eform.mRe_validationCanvas(b.image,b.width,b.height);}t.isSetPathPaint=false;}}var m=k.signElement_guideSpan;k._showGuideTextVisible();var o=b.isNecessaryCheck=="true"?" eForm_inputNecessary":"";if(b.disable){m.className="eF_Rect eForm_inputDisabled "+k.disabledClass;}else{if(b.is_nc){if(this.eform.eForm_isNecessary.check&&b.isNecessaryCheck=="true"){m.className="eF_Rect eForm_NecessaryCheck";}else{m.className="eF_Rect eForm_inputDefault_bg"+o;}}else{m.className="eF_Rect eForm_inputDefault_bg"+o;}}if(!c.isStampCheck){if(null!=h){k.setSendValue(b.image);h.sendMultiSignPath(k,b.pathString);}k.subSectionSyncValue();}else{if(g>0){k.controlData.pathString=" ";if(null!=h){h.sendMultiSignPath(k,b.pathString);}}k.callStampRulesCommand();}}else{mRe_ReportWebLog("not Found Control!! stackFlow function : setMultiSignData control id:"+c.id);}}};EFormSignGroup.prototype.eFormDirectSignControl=function(){var g=this;var u=this.eform;var c=this.signElement.parentElement;var n=is_edge?this.signElement.offsetLeft/u.eFormDoodleOption.zoomIn:this.signElement.offsetLeft;var q=is_edge?this.signElement.offsetTop/u.eFormDoodleOption.zoomIn:this.signElement.offsetTop;var w=this.signElement.offsetWidth;var v=this.signElement.offsetHeight;var a=document.createElement("div");if(is_exeMirroring){a.style.cssText="position:absolute;left:0px;top:0px;right:0px;opacity: 0;background-color:#FFF;z-index:199";a.style.height=u.menuDiv.offsetHeight+"px";}else{a.style.cssText="position:absolute;left:0px;top:0px;right:0px;bottom:0px;opacity: 0;background-color:#FFF;z-index:199";}var i=document.createElement("div");i.style.cssText="position:absolute;left:0px;top:0px;right:0px;bottom:0px;z-index:200";var b=document.createElement("div");b.style.position="absolute";b.style.left=n+"px";b.style.top=q+"px";b.style.width=w+"px";b.style.height=v+"px";b.style.zIndex="200";var z=document.createElement("div");z.style.position="absolute";z.style.left=(n+3)+"px";z.style.top=(q+v+3)+"px";z.style.width=w+"px";var A=document.createElement("button");A.id=u.m_uid+"okUBT";A.className="eform_sign_button_in eform_sign_save";A.innerHTML=u.m_languageMap.save;var j=document.createElement("button");j.className="eform_sign_button_in eform_sign_reset";j.innerHTML=u.m_languageMap.reset;var o=document.createElement("button");o.className="eform_sign_button_in eform_sign_cancel";o.innerHTML=u.m_languageMap.cancel;z.appendChild(A);z.appendChild(j);z.appendChild(o);i.appendChild(b);i.appendChild(z);c.appendChild(a);c.appendChild(i);if(!is_smartphone){A.focus();A.onkeydown=function(B){if(B.keyCode==9){o.click();}};}var f=this.controlData;f.po={is_down:false,move_count:0,reset:false};var d=this.signElement_canas;var x=new SignaturePad(d,{});x.clear();x.off();this.signElement_guideInput.style.visibility="visible";var s=document.createElement("canvas");b.appendChild(s);var p=b.offsetWidth;var l=b.offsetHeight;var m=window.Re_zoom;var y=1;if(null!=m&&(is_ie||is_firefox||is_edge)){y=m.rate;p*=y;l*=y;}s.width=p;s.height=l;s.style.width="100%";s.style.height="100%";var k=b.offsetWidth/Number(d.width);x.minWidth=f.penWidth/k;x.maxWidth=(f.penWidth+f.signStrokeWidth)/k;var t=f.pathString;var h=new SignaturePad(s,{minWidth:(f.penWidth*y),maxWidth:((f.penWidth+f.signStrokeWidth)*y),penColor:f.penColor});if(null!=t&&(typeof t!=="string")){t=mRe_copyObj(t);mRe_RatePath(t,(k*y),"*",0,0);h.fromData(t);}j.onclick=function(B){h.clear();f.po={is_down:false,move_count:0,reset:true};if(!is_smartphone){A.focus();}if(B.stopPropagation){B.stopPropagation();}else{B.cancelBubble=true;}};var r=this.signElement_guideSpan;o.onclick=function(B){var C=f.isNecessaryCheck=="true"?" eForm_inputNecessary":"";if(f.disable){r.className="eF_Rect eForm_inputDisabled "+g.disabledClass;}else{if(f.is_nc){if(u.eForm_isNecessary.check&&f.isNecessaryCheck=="true"){r.className="eF_Rect eForm_NecessaryCheck";}else{r.className="eF_Rect eForm_inputDefault_bg"+C;}}else{r.className="eF_Rect eForm_inputDefault_bg"+C;}}if(null!=f.pathString){x.fromData(f.pathString);}c.removeChild(a);c.removeChild(i);g._showGuideTextVisible();if(g.eform.multiView.isSocket){g.eform.multiView.socket.sendInputSignUnLock(g);}g.signElement.focus();g.onCencelButton();if(B.stopPropagation){B.stopPropagation();}else{B.cancelBubble=true;}};b.onmousedown=b.onclick=function(B){if(B.stopPropagation){B.stopPropagation();}else{B.cancelBubble=true;}};if(is_smartphone){i.onclick=function(B){A.click();};}A.onclick=function(B){h.off();var D=h.toData();f.po.move_count=mRe_PathCount(D);if(f.po.move_count>u.m_signMoveCount){f.is_nc=false;}else{if(f.po.move_count!=0&&f.isNecessaryCheck=="true"){f.is_nc=true;}}if(((f.po.move_count==0&&f.po.reset)||f.po.move_count==0&&""==f.image)&&f.isNecessaryCheck=="true"){f.image="";f.is_nc=true;f.pathString=null;}else{t=mRe_copyObj(D);mRe_RatePath(t,(k*y),"/",0,0);f.pathString=t;x.fromData(t);f.image=x.toDataURL().split("base64,")[1];u.mRe_validationCanvas(f.image,f.width,f.height);}var C=f.isNecessaryCheck=="true"?" eForm_inputNecessary":"";if(f.disable){r.className="eF_Rect eForm_inputDisabled "+g.disabledClass;}else{if(f.is_nc){if(u.eForm_isNecessary.check&&f.isNecessaryCheck=="true"){r.className="eF_Rect eForm_NecessaryCheck";}else{r.className="eF_Rect eForm_inputDefault_bg"+C;}}else{r.className="eF_Rect eForm_inputDefault_bg"+C;}}c.removeChild(a);c.removeChild(i);g._showGuideTextVisible();g.setSendValue(f.image);if(g.eform.multiView.isSocket){g.eform.multiView.socket.sendMultiSignPath(g,f.pathString);g.eform.multiView.socket.sendInputSignUnLock(g);}g.subSectionSyncValue();g.signElement.focus();g.onOkButton();if(B.stopPropagation){B.stopPropagation();}else{B.cancelBubble=true;}if(!f.is_nc){g.eform.nextHybridInputControl(g);}};if(this.eform.multiView.isSocket){this.eform.multiView.socket.sendInputSignLock(this);}};EFormSignGroup.prototype.eFormSignControl=function(){var q=this;if(this.eform.m_isButtonLock==false){if(null!=this.eform.signPaintDiv){return;}if(null==mRe_sign){mRe_sign=new Object();mRe_sign={path:null,move_count:0};}var M=this.eform;mRe_sign.report=M;mRe_sign.eform=this;M.disabledMenu(true);var G;if(this.controlData.width<500&&this.controlData.height<500){if(this.controlData.width<this.controlData.height){var f=500/this.controlData.height;this.controlData.height=500;this.controlData.width=this.controlData.width*f;}if(this.controlData.height<this.controlData.width){var f=500/this.controlData.width;this.controlData.width=500;this.controlData.height=this.controlData.height*f;}}var C=(M.paintDiv.offsetWidth-(this.controlData.width+50));var E=(M.paintDiv.offsetHeight-(this.controlData.height+110));if(C<E){G=M.paintDiv.offsetWidth/(this.controlData.width+150);}else{G=M.paintDiv.offsetHeight/(this.controlData.height+210);}var Q=this.signElement.offsetWidth;var k=this.signElement.offsetHeight;var a=this.controlData.width*G;var c=this.controlData.height*G;var O=(M.paintDiv.offsetWidth-(a+50))/2;while(O<20){G=G*0.9;a=this.controlData.width*G;c=this.controlData.height*G;O=(M.paintDiv.offsetWidth-(a+50))/2;}var m=(M.paintDiv.offsetHeight-(c+110))/2;if(m<0){m=0;}G=(a+50)/400;var A=a/Q;var H=document.createElement("div");if(is_smartphone){H.className="m_eform_sign_background";}else{H.className="eform_sign_background";}var j=H.cloneNode(true);j.style.cssText="opacity: 0;background-color:#FFF;";var N=document.createElement("div");if(M.m_signOption.staticPos){N.style.cssText="position:absolute;left:"+M.m_signOption.staticLeft+";top:"+M.m_signOption.staticTop+";width:"+(a+50)+"px;height:"+(c+110)+"px;";}else{N.style.cssText="position:absolute;left:"+(O+M.m_signOption.offsetLeft)+"px;top:"+(m+M.m_signOption.offsetTop)+"px;width:"+(a+50)+"px;height:"+(c+110)+"px;";}if(null!=this.signElement_focusDiv){this.signElement_focusDiv.className="eF_Rect";}N.className="eform_sign_div";var l=document.createElement("div");l.className="eform_sign_title";l.innerHTML=this.controlData.title;var t=document.createElement("div");t.className="eform_sign_menu";var J=document.createElement("button");mRe_sign.okButton=J;J.className="eform_sign_button eform_sign_save";J.style.zoom=G<1?G:1;J.innerHTML=M.m_languageMap.save;var I=document.createElement("button");mRe_sign.resetButton=I;I.className="eform_sign_button eform_sign_reset";I.style.zoom=G<1?G:1;I.innerHTML=M.m_languageMap.reset;var r=document.createElement("button");mRe_sign.cencelButton=r;r.className="eform_sign_button eform_sign_cancel";r.style.zoom=G<1?G:1;r.innerHTML=M.m_languageMap.cancel;var D=document.createElement("span");D.innerHTML="&nbsp;&nbsp;";t.appendChild(J);t.appendChild(D.cloneNode(true));t.appendChild(I);t.appendChild(D.cloneNode(true));t.appendChild(r);Re_zoom.isPop=true;var g=document.createElement("div");g.className="eform_sign_paint";g.style.overflow="hidden";var y=this.signElement_guideInput.cloneNode(true);mRe_sign.guideInput=y;y.className="eform_sign_paint_guide";var p="border:0px none !important;left:0px;top:0px;width:"+Q+"px;height:"+k+"px;";if(is_firefox){p+="transform: scale("+A+");transform-origin: left top 0;";}else{p+="zoom:"+A+";";}y.style.cssText=p;var o=null;if("TABLE"==y.firstChild.tagName){o=y.firstChild;}if(null==this.controlData.showDisplayTextInDialog||this.controlData.showDisplayTextInDialog){if("INPUT"==y.tagName){y.value=this.controlData.guideMessage;}else{var v=y.lastChild.lastChild.lastChild.lastChild;if(null==v){v=y.lastChild.lastChild.lastChild;}if(this.controlData.fontUnderline){v.style.textDecoration="underline";}var F=this.controlData.guideMessage;F=F.replace(/\u3000/g,"clipu3000");F=F.replace(/\s/g,"\u00A0");F=F.replace(/clipu3000/g,String.fromCharCode(12288));if(typeof v.innerText!=="undefined"){v.innerText=F.replace(/(\\r\\n)|(\\n)/g,String.fromCharCode(13));}else{v.innerHTML=F.replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/\n/g,"<br />\n");}}}y.style.fontFamily="'"+this.controlData.fontName+"'";y.style.fontSize=this.controlData.fontSize;y.style.color=this.controlData.fontColor;if(this.controlData.fontBold){y.style.fontWeight="bold";}if(this.controlData.fontItalic){y.style.fontStyle="italic";}if(this.controlData.fontUnderline){y.style.textDecoration="underline";}g.appendChild(y);var b=document.createElement("div");b.className="eform_sign_paint";b.style.overflow="hidden";b.style.backgroundColor="transparent";N.appendChild(l);N.appendChild(t);N.appendChild(g);N.appendChild(b);H.appendChild(N);M.m_bodyDiv.appendChild(j);M.m_bodyDiv.appendChild(H);J.focus();J.onkeydown=function(R){if(R.keyCode==9){r.click();}};M.signPaintDiv=H;var K=this.controlData;K.po={is_down:false,move_count:0,reset:false};var h=this.signElement_canas;var d=new SignaturePad(h,{minWidth:K.penWidth,maxWidth:(K.penWidth+K.signStrokeWidth)});d.clear();d.off();this._showGuideTextVisible();var n=document.createElement("canvas");b.appendChild(n);n.width=b.offsetWidth;n.height=b.offsetHeight;var L=b.offsetWidth/Number(h.width);var w=null;if(null!=mRe_sign.path){w=mRe_sign.path;K.po.move_count=mRe_sign.move_count;mRe_sign.path=null;}else{w=K.pathString;}var x=new SignaturePad(n,{minWidth:K.penWidth,maxWidth:(K.penWidth+K.signStrokeWidth),penColor:K.penColor});if(null!=w){w=mRe_copyObj(w);mRe_RatePath(w,L,"*",0,0);x.fromData(w);}mRe_sign.jSign=x;mRe_sign.canvasRate=L;I.onclick=function(){x.clear();K.po={is_down:false,move_count:0,reset:true};mRe_sign.move_count=0;J.focus();};var u=this.signElement_guideSpan;r.onclick=function(){var R=K.isNecessaryCheck=="true"?" eForm_inputNecessary":"";if(K.disable){u.className="eF_Rect eForm_inputDisabled "+this.disabledClass;}else{if(K.is_nc){if(M.eForm_isNecessary.check&&K.isNecessaryCheck=="true"){u.className="eF_Rect eForm_NecessaryCheck";}else{u.className="eF_Rect eForm_inputDefault_bg"+R;}}else{u.className="eF_Rect eForm_inputDefault_bg"+R;}}if(null!=K.pathString){d.fromData(K.pathString);}mRe_sign=null;M.m_bodyDiv.removeChild(j);M.m_bodyDiv.removeChild(H);M.disabledMenu(false);M.signPaintDiv=null;Re_zoom.isPop=false;q._showGuideTextVisible();if(q.eform.multiView.isSocket){q.eform.multiView.socket.sendInputSignUnLock(q);}q.signElement.focus();q.onCencelButton();};J.onclick=function(){mRe_sign.move_count=0;x.off();var S=x.toData();K.po.move_count=mRe_PathCount(S);if(K.po.move_count>M.m_signMoveCount){K.is_nc=false;}else{if(K.po.move_count!=0&&K.isNecessaryCheck=="true"){K.is_nc=true;}}M.disabledMenu(false);M.signPaintDiv=null;if(((K.po.move_count==0&&K.po.reset)||K.po.move_count==0&&""==K.image)&&K.isNecessaryCheck=="true"){K.image="";K.is_nc=true;K.pathString=null;}else{w=mRe_copyObj(S);mRe_RatePath(w,L,"/",0,0);K.pathString=w;d.fromData(w);K.image=d.toDataURL().split("base64,")[1];M.mRe_validationCanvas(K.image,K.width,K.height);}var R=K.isNecessaryCheck=="true"?" eForm_inputNecessary":"";if(K.disable){u.className="eF_Rect eForm_inputDisabled "+q.disabledClass;}else{if(K.is_nc){if(M.eForm_isNecessary.check&&K.isNecessaryCheck=="true"){u.className="eF_Rect eForm_NecessaryCheck";}else{u.className="eF_Rect eForm_inputDefault_bg"+R;}}else{u.className="eF_Rect eForm_inputDefault_bg"+R;}}mRe_sign=null;M.m_bodyDiv.removeChild(j);M.m_bodyDiv.removeChild(H);Re_zoom.isPop=false;q._showGuideTextVisible();q.setSendValue(K.image);if(q.eform.multiView.isSocket){q.eform.multiView.socket.sendInputSignUnLock(q);}q.subSectionSyncValue();q.signElement.focus();q.onOkButton();if(!K.is_nc){q.eform.nextHybridInputControl(q);}};if(this.eform.multiView.isSocket){this.eform.multiView.socket.sendInputSignLock(this);}if(null!=o){var P=parseInt(y.style.fontSize);var z=P;var s=o.offsetWidth;var i=o.offsetHeight;var B=null;while(z>0&&(y.offsetWidth<o.offsetWidth||y.offsetHeight<o.offsetHeight)){z-=0.5;o.style.fontSize=z+"pt";if(s!=o.offsetWidth||i!=o.offsetHeight){B=z;}}if(z<=0){window.console.log("sign popup resize fail !!");if(null!=B){o.style.fontSize=B+"pt";}else{o.style.fontSize=P+"pt";}}}}};EFormSignGroup.prototype.eFormSyncView=function(){this.focusControl();};EFormSignGroup.prototype.eFormSyncSignControl=function(){var q=this;if(this.eform.m_isButtonLock==false){if(null!=this.eform.signPaintDiv){return;}if(null==mRe_sign){mRe_sign=new Object();mRe_sign={path:null,move_count:0};}var M=this.eform;mRe_sign.report=M;mRe_sign.eform=this;M.disabledMenu(true);var G;if(this.controlData.width<500&&this.controlData.height<500){if(this.controlData.width<this.controlData.height){var f=500/this.controlData.height;this.controlData.height=500;this.controlData.width=this.controlData.width*f;}if(this.controlData.height<this.controlData.width){var f=500/this.controlData.width;this.controlData.width=500;this.controlData.height=this.controlData.height*f;}}var C=(M.paintDiv.offsetWidth-(this.controlData.width+50));var E=(M.paintDiv.offsetHeight-(this.controlData.height+110));if(C<E){G=M.paintDiv.offsetWidth/(this.controlData.width+150);}else{G=M.paintDiv.offsetHeight/(this.controlData.height+210);}var Q=this.signElement.offsetWidth;var k=this.signElement.offsetHeight;var a=this.controlData.width*G;var c=this.controlData.height*G;var O=(M.paintDiv.offsetWidth-(a+50))/2;while(O<20){G=G*0.9;a=this.controlData.width*G;c=this.controlData.height*G;O=(M.paintDiv.offsetWidth-(a+50))/2;}var m=(M.paintDiv.offsetHeight-(c+110))/2;if(m<0){m=0;}G=(a+50)/400;var A=a/Q;var H=document.createElement("div");if(is_smartphone){H.className="m_eform_sign_background";}else{H.className="eform_sign_background";}var j=H.cloneNode(true);j.style.cssText="opacity: 0;background-color:#FFF;";var N=document.createElement("div");if(M.m_signOption.staticPos){N.style.cssText="position:absolute;left:"+M.m_signOption.staticLeft+";top:"+M.m_signOption.staticTop+";width:"+(a+50)+"px;height:"+(c+110)+"px;";}else{N.style.cssText="position:absolute;left:"+(O+M.m_signOption.offsetLeft)+"px;top:"+(m+M.m_signOption.offsetTop)+"px;width:"+(a+50)+"px;height:"+(c+110)+"px;";}if(null!=this.signElement_focusDiv){this.signElement_focusDiv.className="eF_Rect";}N.className="eform_sign_div";var l=document.createElement("div");l.className="eform_sign_title";l.innerHTML=this.controlData.title;var t=document.createElement("div");t.className="eform_sign_menu";var J=document.createElement("button");mRe_sign.okButton=J;J.className="eform_sign_button eform_sign_save";J.style.zoom=G<1?G:1;J.innerHTML=M.m_languageMap.save;var I=document.createElement("button");mRe_sign.resetButton=I;I.className="eform_sign_button eform_sign_reset";I.style.zoom=G<1?G:1;I.innerHTML=M.m_languageMap.reset;var r=document.createElement("button");mRe_sign.cencelButton=r;r.className="eform_sign_button eform_sign_cancel";r.style.zoom=G<1?G:1;r.innerHTML=M.m_languageMap.cancel;var D=document.createElement("span");D.innerHTML="&nbsp;&nbsp;";t.appendChild(J);t.appendChild(D.cloneNode(true));t.appendChild(I);t.appendChild(D.cloneNode(true));t.appendChild(r);Re_zoom.isPop=true;var g=document.createElement("div");g.className="eform_sign_paint";g.style.overflow="hidden";var y=this.signElement_guideInput.cloneNode(true);mRe_sign.guideInput=y;y.className="eform_sign_paint_guide";var p="border:0px none !important;left:0px;top:0px;width:"+Q+"px;height:"+k+"px;";if(is_firefox){p+="transform: scale("+A+");transform-origin: left top 0;";}else{p+="zoom:"+A+";";}y.style.cssText=p;var o=null;if("TABLE"==y.firstChild.tagName){o=y.firstChild;}if(null==this.controlData.showDisplayTextInDialog||this.controlData.showDisplayTextInDialog){if("INPUT"==y.tagName){y.value=this.controlData.guideMessage;}else{var v=y.lastChild.lastChild.lastChild.lastChild;if(null==v){v=y.lastChild.lastChild.lastChild;}if(this.controlData.fontUnderline){v.style.textDecoration="underline";}var F=this.controlData.guideMessage;F=F.replace(/\u3000/g,"clipu3000");F=F.replace(/\s/g,"\u00A0");F=F.replace(/clipu3000/g,String.fromCharCode(12288));if(typeof v.innerText!=="undefined"){v.innerText=F.replace(/(\\r\\n)|(\\n)/g,String.fromCharCode(13));}else{v.innerHTML=F.replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/\n/g,"<br />\n");}}}y.style.fontFamily="'"+this.controlData.fontName+"'";y.style.fontSize=this.controlData.fontSize;y.style.color=this.controlData.fontColor;if(this.controlData.fontBold){y.style.fontWeight="bold";}if(this.controlData.fontItalic){y.style.fontStyle="italic";}if(this.controlData.fontUnderline){y.style.textDecoration="underline";}g.appendChild(y);var b=document.createElement("div");b.className="eform_sign_paint";b.style.overflow="hidden";b.style.backgroundColor="transparent";N.appendChild(l);N.appendChild(t);N.appendChild(g);N.appendChild(b);H.appendChild(N);M.m_bodyDiv.appendChild(j);M.m_bodyDiv.appendChild(H);J.focus();J.onkeydown=function(R){if(R.keyCode==9){r.click();}};M.signPaintDiv=H;var K=this.controlData;K.po={is_down:false,move_count:0,reset:false};var h=this.signElement_canas;var d=new SignaturePad(h,{minWidth:K.penWidth,maxWidth:(K.penWidth+K.signStrokeWidth)});d.clear();d.off();this._showGuideTextVisible();var n=document.createElement("canvas");b.appendChild(n);n.width=b.offsetWidth;n.height=b.offsetHeight;var L=b.offsetWidth/Number(h.width);var w=null;if(null!=mRe_sign.path){w=mRe_sign.path;K.po.move_count=mRe_sign.move_count;mRe_sign.path=null;}else{w=K.pathString;}var x=new SignaturePad(n,{minWidth:K.penWidth,maxWidth:(K.penWidth+K.signStrokeWidth),penColor:K.penColor});if(null!=w&&(typeof w!=="string")){w=mRe_copyObj(w);mRe_RatePath(w,L,"*",0,0);x.fromData(w);}mRe_sign.jSign=x;mRe_sign.canvasRate=L;I.onclick=function(){x.clear();K.po={is_down:false,move_count:0,reset:true};mRe_sign.move_count=0;J.focus();};var u=this.signElement_guideSpan;r.onclick=function(){var R=K.isNecessaryCheck=="true"?" eForm_inputNecessary":"";if(K.disable){u.className="eF_Rect eForm_inputDisabled "+this.disabledClass;}else{if(K.is_nc){if(M.eForm_isNecessary.check&&K.isNecessaryCheck=="true"){u.className="eF_Rect eForm_NecessaryCheck";}else{u.className="eF_Rect eForm_inputDefault_bg"+R;}}else{u.className="eF_Rect eForm_inputDefault_bg"+R;}}if(null!=K.pathString){d.fromData(K.pathString);}mRe_sign=null;M.m_bodyDiv.removeChild(j);M.m_bodyDiv.removeChild(H);M.disabledMenu(false);M.signPaintDiv=null;Re_zoom.isPop=false;q._showGuideTextVisible();if(q.eform.multiView.isSocket){q.eform.multiView.socket.sendInputSignUnLock(q);}q.signElement.focus();q.onCencelButton();};J.onclick=function(){mRe_sign.move_count=0;x.off();var S=x.toData();K.po.move_count=mRe_PathCount(S);if(K.po.move_count>M.m_signMoveCount){K.is_nc=false;}else{if(K.po.move_count!=0&&K.isNecessaryCheck=="true"){K.is_nc=true;}}M.disabledMenu(false);M.signPaintDiv=null;if(((K.po.move_count==0&&K.po.reset)||K.po.move_count==0&&""==K.image)&&K.isNecessaryCheck=="true"){K.image="";K.is_nc=true;K.pathString=null;}else{w=mRe_copyObj(S);mRe_RatePath(w,L,"/",0,0);K.pathString=w;d.fromData(w);K.image=d.toDataURL().split("base64,")[1];M.mRe_validationCanvas(K.image,K.width,K.height);}var R=K.isNecessaryCheck=="true"?" eForm_inputNecessary":"";if(K.disable){u.className="eF_Rect eForm_inputDisabled "+q.disabledClass;}else{if(K.is_nc){if(M.eForm_isNecessary.check&&K.isNecessaryCheck=="true"){u.className="eF_Rect eForm_NecessaryCheck";}else{u.className="eF_Rect eForm_inputDefault_bg"+R;}}else{u.className="eF_Rect eForm_inputDefault_bg"+R;}}mRe_sign=null;M.m_bodyDiv.removeChild(j);M.m_bodyDiv.removeChild(H);Re_zoom.isPop=false;q._showGuideTextVisible();q.setSendValue(K.image);if(q.eform.multiView.isSocket){q.eform.multiView.socket.sendMultiSignPath(q,K.pathString);q.eform.multiView.socket.sendInputSignUnLock(q);}q.subSectionSyncValue();q.signElement.focus();q.onOkButton();if(!K.is_nc){q.eform.nextHybridInputControl(q);}};if(this.eform.multiView.isSocket){this.eform.multiView.socket.sendInputSignLock(this);}if(null!=o){var P=parseInt(y.style.fontSize);var z=P;var s=o.offsetWidth;var i=o.offsetHeight;var B=null;while(z>0&&(y.offsetWidth<o.offsetWidth||y.offsetHeight<o.offsetHeight)){z-=0.5;o.style.fontSize=z+"pt";if(s!=o.offsetWidth||i!=o.offsetHeight){B=z;}}if(z<=0){window.console.log("sign popup resize fail !!");if(null!=B){o.style.fontSize=B+"pt";}else{o.style.fontSize=P+"pt";}}}}};EFormSignGroup.prototype.eFormSyncSignOkButton=function(){var h=this.eform;var d=this.controlData;var i=this.signElement_guideSpan;var c=this.signElement_canas;var g=mRe_sign.jSign;var a=document.getElementById("Re_signView");var j=document.getElementById("Re_signViewOp");mRe_sign.move_count=0;if(d.po.move_count>h.m_signMoveCount){d.is_nc=false;}else{if(d.po.move_count!=0&&d.isNecessaryCheck=="true"){d.is_nc=true;}}h.disabledMenu(false);h.signPaintDiv=null;if(((d.po.move_count==0&&d.po.reset)||d.po.move_count==0&&""==d.image)&&d.isNecessaryCheck=="true"){d.image="";d.is_nc=true;}else{var b=g.jSignature("getData").split("base64,")[1];d.image=b;drawReportSign(c,d);}var f=d.isNecessaryCheck=="true"?" eForm_inputNecessary":"";if(d.disable){i.className="eF_Rect eForm_inputDisabled "+this.disabledClass;}else{if(d.is_nc){if(h.eForm_isNecessary.check&&d.isNecessaryCheck=="true"){i.className="eF_Rect eForm_NecessaryCheck";}else{i.className="eF_Rect eForm_inputDefault_bg"+f;}}else{i.className="eF_Rect eForm_inputDefault_bg"+f;}}mRe_sign=null;h.targetDiv.removeChild(j);h.targetDiv.removeChild(a);Re_zoom.isPop=false;this._showGuideTextVisible();this.signElement.focus();this.onOkButton();};EFormSignGroup.prototype.eFormSyncSignResetButton=function(){var a=this.controlData;var b=document.getElementById("Re_signView_ok");a.po={is_down:false,move_count:0,reset:true};mRe_sign.move_count=0;mRe_sign.jSign.jSignature("reset");b.focus();};EFormSignGroup.prototype.eFormSyncSignCencelButton=function(){var d=this.eform;var c=this.controlData;var b=this.signElement_guideSpan;var g=this.signElement_canas;var a=document.getElementById("Re_signView");var h=document.getElementById("Re_signViewOp");var f=c.isNecessaryCheck=="true"?" eForm_inputNecessary":"";if(c.disable){b.className="eF_Rect eForm_inputDisabled "+this.disabledClass;}else{if(c.is_nc){if(d.eForm_isNecessary.check&&c.isNecessaryCheck=="true"){b.className="eF_Rect eForm_NecessaryCheck";}else{b.className="eF_Rect eForm_inputDefault_bg"+f;}}else{b.className="eF_Rect eForm_inputDefault_bg"+f;}}drawReportSign(g,c);mRe_sign=null;d.targetDiv.removeChild(h);d.targetDiv.removeChild(a);d.disabledMenu(false);d.signPaintDiv=null;Re_zoom.isPop=false;this._showGuideTextVisible();this.signElement.focus();this.onCencelButton();};EFormSignGroup.prototype.subSectionSyncValue=function(b){if(typeof b=="undefined"){b=true;}var a=this.subSectionSyncValueImage();this.subSectionSyncValuePath(a,b);};EFormSignGroup.prototype.subSectionSyncValueImage=function(){var b=null;if(this.controlData.repeatSync){var a=0;if(null!=this.controlData.po&&""!=this.controlData.image){a=this.controlData.po.move_count;}b=this.eform.findCloneControl(this);for(var d=0;d<b.length;d++){var c=b[d];if(null!=c.controlData.po){c.controlData.po.move_count=a;}else{c.controlData.po={move_count:a};}c.isStampCheck=this.isStampCheck;c.stampImage=this.stampImage;c.m_default_setValue(this.controlData.image);}}return b;};EFormSignGroup.prototype.callStampRulesCommand=function(){var a=this;window.setTimeout(function(){a.multisignRulesCommand(true);},10);};EFormSignGroup.prototype.multisignRulesCommand=function(c){if(c){if(typeof getControlEventRulesCommand!="undefined"){if((this.eform.multiView.isSocket&&this.eform.isMain)||!this.eform.multiView.isSocket){var a=this.ctrlID;if(-1!=a.indexOf(".")){a=a.substring(a.indexOf(".")+1);}a=decodeURI(a.replace(/[r]/g,"%"));a=a.substring(0,a.lastIndexOf("_"));var b={};b.uid=this.eform.m_uid;b.reportName=this.controlData.rName;b.inputID=this.controlData.id;b.type="sign";b.event="change";b.disabled=this.controlData.disable;b.visible=this.controlData.visible;b.image=this.controlData.image;b.value="";b.path=this.controlData.pathString;if(null!=b.path){if((typeof b.path=="string")&&b.path!="null"){if(b.path.length>0){b.value="true";}}else{if(b.path.length>0){b.value="true";}}}b.title=a;b.isNecessaryCheck="true"==this.controlData.isNecessaryCheck;b.isNecessaryChecked=!this.controlData.is_nc;b.sectionName=this.controlData.sName?this.controlData.sName:"";getControlEventRulesCommand(b);}}}};EFormSignGroup.prototype.subSectionSyncValuePath=function(c,j){if(typeof j=="undefined"){j=true;}this.multisignRulesCommand(j);if(this.controlData.repeatSync){if(typeof c=="undefined"){c=this.eform.findCloneControl(this);}for(var g=0;g<c.length;g++){var f=c[g];var h=this.controlData.pathString;if(typeof h==="string"){f.controlData.pathString=h;}else{var b=f.controlData;b.pathString=h;b.po.move_count=mRe_PathCount(h);if(b.po.move_count>this.eform.m_signMoveCount){b.is_nc=false;}else{if(b.po.move_count!=0&&b.isNecessaryCheck=="true"){b.is_nc=true;}}if(f.isDOM){var a=f.signElement_guideSpan;if(null!=a){var d=b.isNecessaryCheck=="true"?" eForm_inputNecessary":"";if(b.disable){a.className="eF_Rect eForm_inputDisabled "+f.disabledClass;}else{if(b.is_nc){if(this.eform.eForm_isNecessary.check&&b.isNecessaryCheck=="true"){a.className="eF_Rect eForm_NecessaryCheck";}else{a.className="eF_Rect eForm_inputDefault_bg"+d;}}else{a.className="eF_Rect eForm_inputDefault_bg"+d;}}}}}}}};function mRe_copyObj(b){if(b===null||typeof(b)!=="object"){return b;}var c=b.constructor();for(var a in b){if(b.hasOwnProperty(a)){c[a]=mRe_copyObj(b[a]);}}return c;}function mRe_DeduplicationPath(f){if(null!=f){var d=f.length;for(var c=0;c<d;c++){if(null!=f[c]){var b=f[c].length-1;for(var a=b;a>=0;a--){if(a-1>=0){if(f[c][a-1].x==f[c][a].x&&f[c][a-1].y==f[c][a].y){f[c].splice(a,1);}}}}}}}function mRe_RatePath(a,l,b,g,d){if(null!=a){var k=a.length;for(var f=0;f<k;f++){if(null!=a[f]){var h=a[f].length;for(var c=0;c<h;c++){if("*"==b){a[f][c].x=(a[f][c].x*l)+g;a[f][c].y=(a[f][c].y*l)+d;}else{a[f][c].x=(a[f][c].x/l)+g;a[f][c].y=(a[f][c].y/l)+d;}}}}}}function mRe_PathCount(d){var b=0;if(null!=d){var c=d.length;for(var a=0;a<c;a++){if(null!=d[a]){b+=d[a].length;}}}return b;}function mRe_calcRect(c,h,g,b){var a={canvasRate:1,offsetX:0,offsetY:0};var f=c/g;var d=h/b;if(f>d){a.canvasRate=f;a.offsetY=(b-(h/f))/2;}else{a.canvasRate=d;a.offsetX=(g-(c/d))/2;}return a;}function mRe_RectPoint(g){var a={x1:-1,y1:-1,x2:-1,y2:-1};if(null!=g){var f=g.length;for(var d=0;d<f;d++){if(null!=g[d]){var c=g[d].length;for(var b=0;b<c;b++){if(a.x1==-1||a.x1>g[d][b].x){a.x1=g[d][b].x;}if(a.x2<g[d][b].x){a.x2=g[d][b].x;}if(a.y1==-1||a.y1>g[d][b].y){a.y1=g[d][b].y;}if(a.y2<g[d][b].y){a.y2=g[d][b].y;}}}}}return a;}function mRe_pathOffset(h,f,d){var g=h.length;for(var c=0;c<g;c++){if(null!=h[c]){var b=h[c].length;for(var a=0;a<b;a++){h[c][a].x=h[c][a].x+f;h[c][a].y=h[c][a].y+d;}}}return h;}function CombinePath(f,c,g){var a=mRe_RectPoint(f);var c=mRe_pathOffset(c,a.x2+g,0);var d=c.length;for(var b=0;b<d;b++){f.push(c[b]);}return f;}function EFormCalendar(){this.eform=null;this.ctrlID=null;this.controlData=null;this.group=null;this.isDOM=false;this.calendarElement=null;this.calendarElement_div=null;this.calendarElement_td=null;this.calendarElement_focusDiv=null;this.calendarElement_td_guide=null;this.calendarElement_table_guide=null;this.event={clickEvent:null,dayClickEvent:null,removeButtonEvent:null,backgroundClickEvent:null,eventTarget:null};this.title=null;this.viewOption={calendarBGDom:null,calendarFrameDom:null,calendarDelValBottonDom:null,textYearMonthDom:null,dayDomList:[[],[],[],[],[],[]],dayList:["SUN","MON","TUE","WED","THU","FRI","SAT"],newYear:0,newMonth:0,newDay:0};this.callKeyboardButton=null;this.callKeyboardButton2=null;this.bgColor=null;this.disabledClass="";this.customAppName="";}EFormCalendar.prototype.setGroup=function(a){this.group=a;};EFormCalendar.prototype.init=function(b,a,c){this.eform=c;this.ctrlID=b;this.controlData=a;this.controlData.necessaryMessage=a.necessaryMessage.replace(/\\\//g,"/").replace(/\\\\/g,"\\").replace(/\\\"/g,'"');this.controlData.yearValue=a.yearValue.replace(/\\\//g,"/").replace(/\\\\/g,"\\").replace(/\\\"/g,'"');this.controlData.monthValue=a.monthValue.replace(/\\\//g,"/").replace(/\\\\/g,"\\").replace(/\\\"/g,'"');this.controlData.dayValue=a.dayValue.replace(/\\\//g,"/").replace(/\\\\/g,"\\").replace(/\\\"/g,'"');if(null!=a.inputOrder){this.eform.eFormIndexControlList[a.inputOrder]=this;}if(null==a.indexOrderDisable){a.indexOrderDisable=false;}if(null==a.isToView){a.isToView=true;}if(null==a.isToEasyMode){a.isToEasyMode=true;}if(c.isEasyInput&&a.isToEasyMode){a.isToView=true;}if(!a.isToView){a.is_nc=false;}if(null==a.isAutoNextFocus){a.isAutoNextFocus=true;}if(null==a.repeatSync){a.repeatSync=false;}if(null==a.spaceCount){a.spaceCount=0;}if(null==a.isGuideText){a.isGuideText=false;}if(a.isGuideText){this.controlData.guideText=a.guideText.replace(/\\\//g,"/").replace(/\\\\/g,"\\").replace(/\\\"/g,'"');}else{this.controlData.guideText="";this.controlData.guideTextColor="rgba(0,0,0,0)";}if(null!=a.title){this.controlData.title=a.title.replace(/\\\//g,"/").replace(/\\\\/g,"\\").replace(/\\\"/g,'"');this.title=this.controlData.title;}else{this.controlData.title="";}if(null==a.sName){a.sName="";}};EFormCalendar.prototype.deleteMe=function(){this.eform=null;this.ctrlID=null;this.controlData=null;this.event=null;this.group=null;this.viewOption=null;this.deleteDOM();};EFormCalendar.prototype.resetDOM=function(){this.isDOM=false;this.calendarElement=null;this.calendarElement_div=null;this.calendarElement_td=null;this.calendarElement_focusDiv=null;this.calendarElement_td_guide=null;this.calendarElement_table_guide=null;};EFormCalendar.prototype.deleteDOM=function(){if(this.calendarElement){if(this.calendarElement.parentElement){this.calendarElement.parentElement.removeChild(this.calendarElement);}else{delete this.calendarElement;}}if(this.calendarElement_div){if(this.calendarElement_div.parentElement){this.calendarElement_div.parentElement.removeChild(this.calendarElement_div);}else{delete this.calendarElement_div;}}if(this.calendarElement_td){if(this.calendarElement_td.parentElement){this.calendarElement_td.parentElement.removeChild(this.calendarElement_td);}else{delete this.calendarElement_td;}}if(this.calendarElement_focusDiv){if(this.calendarElement_focusDiv.parentElement){this.calendarElement_focusDiv.parentElement.removeChild(this.calendarElement_focusDiv);}else{delete this.calendarElement_focusDiv;}}if(this.calendarElement_table_guide){if(this.calendarElement_table_guide.parentElement){this.calendarElement_table_guide.parentElement.removeChild(this.calendarElement_table_guide);}else{delete this.calendarElement_table_guide;}}if(this.calendarElement_td_guide){if(this.calendarElement_td_guide.parentElement){this.calendarElement_td_guide.parentElement.removeChild(this.calendarElement_td_guide);}else{delete this.calendarElement_td_guide;}}this.resetDOM();};EFormCalendar.prototype.getRect=function(){if(this.isDOM){var b={left:0,top:0,width:0,height:0};var d=this.calendarElement;var c=d.parentElement.offsetLeft;var a=d.parentElement.offsetTop;b.left=c+d.offsetLeft;b.top=a+d.offsetTop;b.width=d.offsetWidth;b.height=d.offsetHeight;return b;}return null;};EFormCalendar.prototype.getHE=function(){if(this.isDOM){return this.calendarElement;}return null;};EFormCalendar.prototype.eventHandlerCalendar=function(){if(!this.controlData.isToView){return;}if(typeof this.controlData.pageNumber=="undefined"){this.controlData.pageNumber=this.eform.beforePageIndex;}this.isDOM=true;this.calendarElement=document.getElementById(this.eform.m_uid+this.ctrlID);this.calendarElement_div=document.getElementById(this.eform.m_uid+this.ctrlID+"SPAN");this.calendarElement_td=document.getElementById(this.eform.m_uid+this.ctrlID+"TD");this.calendarElement_focusDiv=document.getElementById(this.eform.m_uid+this.ctrlID+"FOCUS");this.calendarElement_td_guide=document.getElementById(this.eform.m_uid+this.ctrlID+"TD_guide");this.calendarElement_table_guide=document.getElementById(this.eform.m_uid+this.ctrlID+"Table_guide");if(this.eform.m_RuleCtrlVisible){if(null!=this.calendarElement_div){var b=this.calendarElement_div.parentElement;if(null!=b){var j=document.createElement("div");j.style.position="absolute";j.style.left=b.style.left;j.style.top=b.style.top;j.style.width=b.style.width;j.style.height=b.style.height;j.style.color="red";j.style.fontSize="8pt";j.style.fontWeight="bold";var a=this.ctrlID;if(-1!=a.indexOf(".")){a=a.substring(a.indexOf(".")+1);}a=decodeURI(a.replace(/[r]/g,"%"));a=a.substring(0,a.lastIndexOf("_"));j.innerHTML=a+" ("+this.controlData.id+")";var i=b.parentElement;var h=b.nextSibling;if(null!=h){i.insertBefore(j,h);}else{i.appendChild(j);}}}}if(null==this.title){this.title=this.calendarElement.title;}else{this.calendarElement.title=this.title;this.calendarElement.innerHTML=this.title;}var m=this.getValue();if(this.controlData.isGuideText){if(null!=this.calendarElement_div&&null==this.calendarElement_td_guide&&null==this.calendarElement_table_guide){try{var g=this.calendarElement_div.nextSibling;var n=g.firstChild.cloneNode(true);n.id=this.eform.m_uid+this.ctrlID+"Table_guide";g.appendChild(n);var p=n.querySelector("td");p.id+="_guide";this.calendarElement_td_guide=p;this.calendarElement_table_guide=n;p.style.color=this.controlData.guideTextColor;var o=this.controlData.guideText;var d=p.firstChild;if(typeof p.innerText!=="undefined"){o=o.replace(/(\\r\\n)|(\\n)/g,String.fromCharCode(13));o=o.split(" ").join("\u00A0");d.innerText=o;}else{d.innerHTML=o.replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/\n/g,"<br />\n");}}catch(l){this.controlData.isGuideText=false;ReportWebLog(this.controlData.id+" 가이드 생성에 문제가 발생하였습니다.");}}}if(""!=m){this.controlData.is_nc=false;if(this.controlData.isGuideText){this.calendarElement_td_guide.style.display="none";}}else{var f="";if(this.controlData.isNecessaryCheck=="true"){this.controlData.is_nc=true;f=" eForm_inputNecessary";}if(this.controlData.disable){this.calendarElement_div.className="eF_Rect eForm_inputDisabled "+this.disabledClass;}else{if(this.eform.eForm_isNecessary.check&&this.controlData.is_nc){this.calendarElement_div.className="eF_Rect eForm_NecessaryCheck";}else{this.calendarElement_div.className="eF_Rect eForm_inputDefault_bg"+f;}}if(this.controlData.isGuideText){this.calendarElement_td_guide.style.display="";}}var c=this;if(null!=this.calendarElement_focusDiv&&null!=this.calendarElement){this.calendarElement.onblur=function(){var q=c.calendarElement_focusDiv;if(null!=q){q.className="eF_Rect";c.eform.inputImagePointerOut();}if(c.eform.multiView.isSocket){c.eform.multiView.socket.sendFocusControl(c,"out");}c.removeSubCallKeyboardButton();};this.calendarElement.onfocus=function(){c.focusControl();if(c.eform.multiView.isSocket){c.eform.multiView.socket.sendFocusControl(c,"in");}};}var k=this.calendarElement_td.firstChild;if(null==k){k=this.calendarElement_td;}if(typeof this.calendarElement_td.innerText!=="undefined"){m=m.replace(/(\\r\\n)|(\\n)/g,String.fromCharCode(13));m=m.split(" ").join("\u00A0");k.innerText=m;}else{k.innerHTML=m.replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/\n/g,"<br />\n");}this.calendarElement.onmousedown=function(q){var r=false;if("which" in q){r=q.which==3;}else{if("button" in q){r=q.button==2;}}if(r){q.preventDefault();return;}if(c.onClick()!=false){c.eformSelectCalendarControl();}q.preventDefault();};this.calendarElement.onkeyup=function(q){if(32==q.keyCode||13==q.keyCode){if(c.onClick()!=false){c.eformSelectCalendarControl();}}};this.m_setBGColor();this.setDisabled(this.controlData.disable,false);this.setVisible(this.controlData.visible,false);};EFormCalendar.prototype.click=function(a){if(typeof a=="undefined"){a=true;}if(!this.controlData.disable&&this.controlData.visible){this.calendarElement.focus();}if(a){if(this.onClick()!=false){this.eformSelectCalendarControl();}}else{this.eformSelectCalendarControl();}};EFormCalendar.prototype.eformSelectCalendarControl=function(){if(this.eform.titleSpeechBubble.visible.calendar){this.eform.inputCreateTitleSpeechBubble(this);}else{this.eform.inputRemoveTitleSpeechBubble();}if(this.eform.mRe_MainNecessaryInputEnabledCheckControl(this)){if(this.eform.m_isUsePopupInputFrame.calendar){if(this.eform.multiView.isSocket&&!this.eform.multiView.socket.isMain){this.callFrameCalendar();return;}else{if(!this.eform.multiView.isSocket){this.callFrameCalendar();return;}}}if(this.eform.multiView.isSocket&&this.eform.multiView.socket.isMain&&(this.eform.isSubAppType||this.eform.m_exeOption.isCalendarAct)){if(is_exeMirroring&&!this.eform.m_exeOption.isCalendarAct){this.eformCalendarControl();}else{this.createSubCallKeyboardButton();}}else{if(is_appControl||this.eform.m_exeOption.isCalendarAct){this.callHybridCalendar();}else{this.eformCalendarControl();}}}else{this.calendarElement.focus();}};EFormCalendar.prototype.eformCalendarControl=function(){if(this.eform.m_isButtonLock==false&&this.viewOption.calendarBGDom==null){if(null==mRe_calendar){mRe_calendar=this;}var s=this.eform;s.disabledMenu(true);this.viewOption.calendarBGDom=document.createElement("div");this.viewOption.calendarBGDom.addEventListener("contextmenu",function(i){i.preventDefault();},false);this.viewOption.calendarBGDom.className=is_smartphone?"m_eform_calendar_div":"eform_calendar_div";this.viewOption.calendarFrameDom=document.createElement("div");this.viewOption.calendarDelValBottonDom=document.createElement("button");this.viewOption.calendarBGDom.appendChild(this.viewOption.calendarFrameDom);this.viewOption.calendarBGDom.appendChild(this.viewOption.calendarDelValBottonDom);s.m_bodyDiv.appendChild(this.viewOption.calendarBGDom);this.reSize();var o=this;this.viewOption.calendarBGDom.onclick=function(){mRe_calendar.removeCalendarView();if(null!=o.event.backgroundClickEvent){o.event.backgroundClickEvent(mRe_calendar);}};this.viewOption.calendarFrameDom.onclick=function(i){if(i.stopPropagation){i.stopPropagation();}else{i.cancelBubble=true;}};this.viewOption.calendarDelValBottonDom.title=s.m_languageMap.del;this.viewOption.calendarDelValBottonDom.innerHTML=s.m_languageMap.del;this.viewOption.calendarDelValBottonDom.onclick=function(){mRe_calendar.removeCalendarValue();if(event.stopPropagation){event.stopPropagation();}else{event.cancelBubble=true;}};var k=this.viewOption.calendarFrameDom;var v=document.createElement("div");v.className="eform_calendar_header_div";var q=document.createElement("div");q.className="eform_calendar_body_div";var u=document.createElement("table");u.className="eform_calendar_year_header";var B=document.createElement("tr");var l=document.createElement("td");l.vAlign="middle";l.style.cssText="width:15%;height:60%";var z=document.createElement("button");z.title="이전 년도";z.className="eform_calendar_prev_year";l.appendChild(z);z.onmousedown=function(i){mRe_calendar.moveYear(-1);i.preventDefault();};z.onkeyup=function(i){if(32==i.keyCode||13==i.keyCode){mRe_calendar.moveYear(-1);}};var d=document.createElement("td");d.vAlign="middle";d.style.cssText="width:11%;height:60%";var m=document.createElement("button");m.title="이전 달";m.className="eform_calendar_prev_month";d.appendChild(m);m.onmousedown=function(i){mRe_calendar.moveMonth(-1);i.preventDefault();};m.onkeyup=function(i){if(32==i.keyCode||13==i.keyCode){mRe_calendar.moveMonth(-1);}};var C=document.createElement("td");C.vAlign="middle";C.style.cssText="width:48%;height:60%";this.viewOption.textYearMonthDom=C;var f=document.createElement("td");f.vAlign="middle";f.style.cssText="width:11%;height:60%";var g=document.createElement("button");g.title="다음 달";g.className="eform_calendar_next_month";f.appendChild(g);g.onmousedown=function(i){mRe_calendar.moveMonth(1);i.preventDefault();};g.onkeyup=function(i){if(32==i.keyCode||13==i.keyCode){mRe_calendar.moveMonth(1);}};var a=document.createElement("td");a.vAlign="middle";a.style.cssText="width:15%;height:60%";var y=document.createElement("button");y.title="다음 년도";y.className="eform_calendar_next_year";a.appendChild(y);y.onmousedown=function(i){mRe_calendar.moveYear(1);i.preventDefault();};y.onkeyup=function(i){if(32==i.keyCode||13==i.keyCode){mRe_calendar.moveYear(1);}};B.appendChild(l);B.appendChild(d);B.appendChild(C);B.appendChild(f);B.appendChild(a);u.appendChild(B);v.appendChild(u);var b=document.createElement("table");b.className="eform_calendar_month_header";var A=document.createElement("tr");for(var t=0;t<7;t++){var c=document.createElement("td");c.style.cssText="width:14.3%;height:40%;cursor:default;";c.innerHTML=this.viewOption.dayList[t];A.appendChild(c);}b.appendChild(A);v.appendChild(b);var x=document.createElement("table");x.className="eform_calendar_body";for(var t=0;t<6;t++){A=document.createElement("tr");for(var r=0;r<7;r++){var c=document.createElement("td");c.style.cssText="width:14.3%;height:16.666%;cursor:default;";if(r==0){c.className="eform_calendar_day eform_calendar_sunDay";}else{if(r==6){c.className="eform_calendar_day eform_calendar_saturday";}else{c.className="eform_calendar_day";}}A.appendChild(c);this.viewOption.dayDomList[t][r]=c;}x.appendChild(A);}q.appendChild(x);k.appendChild(v);k.appendChild(q);var n=Number(this.controlData.yearValue);var p=Number(this.controlData.monthValue);var h=Number(this.controlData.dayValue);var w=new Date();if(0==n){n=w.getFullYear();}if(0==p){p=w.getMonth()+1;}if(0==h){h=w.getDate();}if(!mRe_isValidDate(n,p,h)){n=w.getFullYear();p=w.getMonth()+1;w=w.getDate();}this.viewOption.newYear=n;this.viewOption.newMonth=p;this.viewOption.newDay=h;this.insertDay();}};EFormCalendar.prototype.reSize=function(){if(null!=this.viewOption.calendarBGDom){var a=this.eform;var b=a.paintDiv.offsetWidth;var g=a.paintDiv.offsetHeight-30;var f=0;var c=0;var h=0;var d=is_smartphone?500:420;if(b>g){h=g-40;if(h>d){h=d;c=(g-h)/2;}else{c=20;}f=(b-h)/2;}else{h=b-40;if(h>d){h=d;f=(b-h)/2;}else{f=20;}c=(g-h)/2;}this.viewOption.calendarFrameDom.style.cssText="position:absolute;left:"+f+"px;top:"+c+"px;width:"+h+"px;height:"+h+"px;background-color: white;border: 1px solid gray;";this.viewOption.calendarDelValBottonDom.className="eform_calendar_remove_button";this.viewOption.calendarDelValBottonDom.style.cssText="position:absolute;right:"+(f)+"px;top:"+(c+h+10)+"px;width:75px;height:30px;";}};EFormCalendar.prototype.insertDay=function(){var g=this;var n,c,b;n=this.viewOption.newYear;c=this.viewOption.newMonth;b=this.viewOption.newDay;if(is_exeControl){this.viewOption.textYearMonthDom.innerHTML=n+"."+c;}else{if(this.viewOption.textYearMonthDom.children.length==0){var r=document.createElement("select");r.className="eform_calendar_year_list";for(var m=1920;m<2119;m++){var l=document.createElement("option");l.value=m;l.innerHTML=m;if(m==n){l.selected=true;}r.appendChild(l);}r.onchange=function(){g.viewOption.newYear=parseInt(r.value);g.insertDay();};this.viewOption.textYearMonthDom.appendChild(r);var d=document.createElement("span");d.innerHTML="."+c;this.viewOption.textYearMonthDom.appendChild(d);}else{var r=this.viewOption.textYearMonthDom.firstChild;r.value=n;var d=this.viewOption.textYearMonthDom.lastChild;d.innerHTML="."+c;}}this.viewOption.textYearMonthDom.style.color="white";var f=new Date(n,c-1,1);var h=f.getDay();var p=this.viewOption.dayDomList;var q=mRe_getDaysInMonth(n,c);var a=0;var o=1;for(var m=0;m<6;m++){for(var k=0;k<7;k++){p[m][k].style.backgroundColor="";p[m][k].style.color="";if(a<h||o>q){p[m][k].innerHTML="";p[m][k].title="";p[m][k].tabIndex=-1;p[m][k].onmousedown=null;p[m][k].onkeyup=null;}else{p[m][k].innerHTML=o;p[m][k].title=o+"일";p[m][k].tabIndex=0;if(b==o){p[m][k].focus();}p[m][k].onmousedown=function(i){g.setCalendarValue(this.textContent);i.preventDefault();};p[m][k].onkeyup=function(i){if(32==i.keyCode||13==i.keyCode){g.setCalendarValue(this.textContent);}};o=o+1;}a=a+1;}}};EFormCalendar.prototype.callFrameCalendar=function(){if(!this.eform.m_isUsePopupInputFrame.calendar||null!=this.eform.signPaintDiv){return;}var B=this;var A=this.eform;A.inputOrderFoucs(this);var l=null;if(A.multiView.isSocket){l=A.multiView.socket;l.sendScreenLock("calendar",A.m_uid);}A.disabledMenu(true);Re_zoom.isPop=true;var c=310;var o=document.createElement("div");o.className="m_eform_popup_background";o.style.background="rgba(155,155,155,0.3)";o.addEventListener("touchstart",function(i){if(i.touches.length>1){i.preventDefault();}},false);var g=document.createElement("div");if(A.m_isBottomPopHeight>0){g.style.height=(c)+"px";}else{g.style.height=(c<230?210:c)+"px";}g.className="eform_popup_body";var t=document.createElement("div");t.className="eform_popup_header";var j=document.createElement("div");j.className="eform_popup_header_Label";var D=document.createElement("nobr");j.appendChild(D);var r=document.createElement("button");r.className="eform_popup_close_button";var f=document.createElement("button");f.className="eform_popup_save_button";var G=document.createElement("button");G.className="eform_popup_next_button";t.appendChild(j);t.appendChild(r);t.appendChild(f);t.appendChild(G);g.appendChild(t);o.appendChild(g);A.m_bodyDiv.appendChild(o);A.signPaintDiv=o;var y=document.createElement("div");y.className="eform_popup_frame";y.style.left="0px";y.style.right="0px";g.appendChild(y);var z=document.createElement("div");z.className="eform_popup_frame_Label";var m=document.createElement("nobr");z.appendChild(m);z.innerHTML=this.controlData.title;y.appendChild(z);var h=document.createElement("button");h.className="eform_popup_frameReset_button";y.appendChild(h);var F=document.createElement("div");F.className="eform_popup_frame_body";y.appendChild(F);var C=document.createElement("select");C.className="eform_popup_frame_body_select";C.style.cssText="left:0px;width:33%;";C.required=true;F.appendChild(C);var d=document.createElement("select");d.className="eform_popup_frame_body_select";d.style.cssText="left:33%;width:33%;";d.required=true;F.appendChild(d);var q=document.createElement("select");q.className="eform_popup_frame_body_select";q.style.cssText="left:66%;right:0px;";q.required=true;F.appendChild(q);var p=Number(this.controlData.yearValue);var s=Number(this.controlData.monthValue);var k=Number(this.controlData.dayValue);if(p==0&&s==0&&k==0){p=new Date().getFullYear();s=new Date().getMonth()+1;k=new Date().getDate();}var v=document.createElement("option");v.value="";v.innerHTML="년도";v.disabled=true;v.selected=true;C.appendChild(v);for(var w=1920;w<2119;w++){var b=document.createElement("option");b.value=w;b.innerHTML=w;if(w==p){b.selected=true;}C.appendChild(b);}var x=document.createElement("option");x.value="";x.innerHTML="월";x.disabled=true;x.selected=true;d.appendChild(x);for(var w=1;w<13;w++){var E=document.createElement("option");E.value=w;E.innerHTML=w;if(w==s){E.selected=true;}d.appendChild(E);}var a=document.createElement("option");a.value="";a.innerHTML="일";a.disabled=true;a.selected=true;q.appendChild(a);var n=mRe_getDaysInMonth(p,s);for(var w=1;w<(n+1);w++){var u=document.createElement("option");u.value=w;u.innerHTML=w;if(w==k){u.selected=true;}q.appendChild(u);}C.onchange=d.onchange=function(){var H=Number(C.value);var K=Number(d.value);var N=Number(q.value);var L=mRe_getDaysInMonth(H,K);q.innerHTML="";var J=document.createElement("option");J.value="";J.innerHTML="일";J.disabled=true;J.selected=true;q.appendChild(J);for(var I=1;I<(L+1);I++){var M=document.createElement("option");M.value=I;M.innerHTML=I;if(I==N){M.selected=true;}q.appendChild(M);}};h.onclick=function(){C.value="";d.value="";q.value="";};window.mRe_popupInput_close=r;r.onclick=function(){A.signPaintDiv=null;mRe_reSetPopupStatus();A.m_bodyDiv.removeChild(o);A.disabledMenu(false);if(null!=l){l.sendScreenUnLock(A.m_uid);}};f.onclick=function(){B.setValue(C.value,d.value,q.value);A.signPaintDiv=null;mRe_reSetPopupStatus();A.m_bodyDiv.removeChild(o);A.disabledMenu(false);if(B.eform.multiView.isSocket){B.eform.multiView.socket.sendFocusControl(B,"out");}if(null!=l){l.sendScreenUnLock(A.m_uid);}};G.onclick=function(){B.setValue(C.value,d.value,q.value);A.signPaintDiv=null;mRe_reSetPopupStatus();A.m_bodyDiv.removeChild(o);A.disabledMenu(false);if(B.eform.multiView.isSocket){B.eform.multiView.socket.sendFocusControl(B,"out");}if(B.controlData.isAutoNextFocus){var i=B.eform.nextHybridInputControl(B);if(!i){B.eform.nextEasyInputControl(B);}}if(null!=l){l.sendScreenUnLock(A.m_uid);}};};EFormCalendar.prototype.setCalendarValue=function(b){var a=true;if(null!=this.event.dayClickEvent){a=this.event.dayClickEvent(this.viewOption.newYear,this.viewOption.newMonth,b,this);}if(null!=this.eform.ctrlEvent.calendarDayClickEvent&&a){a=this.eform.ctrlEvent.calendarDayClickEvent(year,month,b,this);}if(a){this.setValue(this.viewOption.newYear,this.viewOption.newMonth,b);this.removeCalendarView();if(this.controlData.isAutoNextFocus){if(!this.eform.nextHybridInputControl(this)){this.calendarElement.focus();}else{if(this.eform.multiView.isSocket){this.eform.multiView.socket.sendFocusControl(this,"out");}}}else{this.calendarElement.focus();}}};EFormCalendar.prototype.removeCalendarView=function(){this.eform.disabledMenu(false);this.eform.m_bodyDiv.removeChild(this.viewOption.calendarBGDom);mRe_calendar=null;this.viewOption={calendarBGDom:null,calendarFrameDom:null,calendarDelValBottonDom:null,textYearMonthDom:null,dayDomList:[[],[],[],[],[],[]],dayList:["SUN","MON","TUE","WED","THU","FRI","SAT"],newYear:0,newMonth:0,newDay:0};};EFormCalendar.prototype.removeCalendarValue=function(){this.setValue("","","");this.removeCalendarView();this.calendarElement.focus();if(null!=this.event.removeButtonEvent){this.event.removeButtonEvent(this);}};EFormCalendar.prototype.getCtrlID=function(){return this.ctrlID;};EFormCalendar.prototype.getType=function(){return this.controlData.type;};EFormCalendar.prototype.getDate=function(){var a=Number(this.controlData.yearValue);var b=Number(this.controlData.monthValue);var c=Number(this.controlData.dayValue);return a+(b<10?"0"+b:""+b)+(c<10?"0"+c:""+c);};EFormCalendar.prototype.getValue=function(){var f=Number(this.controlData.yearValue);var c=Number(this.controlData.monthValue);var a=Number(this.controlData.dayValue);var j="";if(this.controlData.spaceCount>0){for(var h=0;h<this.controlData.spaceCount;h++){j+=" ";}}var g=new Array();if(f==0&&c==0&&a==0){return"";}var b=""+f;b+=c<10?"0"+c:""+c;b+=a<10?"0"+a:""+a;var d=mRe_getFormattedDate(this.controlData.formatType,this.controlData.displayType,j);if(""!=d){var i=moment(b).format(d);if("Invalid date"==i){return"";}return i;}return"";};EFormCalendar.prototype.moveYear=function(a){this.viewOption.newYear+=a;this.insertDay();};EFormCalendar.prototype.moveMonth=function(a){this.viewOption.newMonth+=a;if(0==this.viewOption.newMonth){this.viewOption.newYear--;this.viewOption.newMonth=12;}else{if(13==this.viewOption.newMonth){this.viewOption.newYear++;this.viewOption.newMonth=1;}}this.insertDay();};EFormCalendar.prototype.setValue=function(d,a,c,b){this.m_default_setValue(d,a,c,b);if(this.eform.multiView.isSocket){this.eform.multiView.socket.sendInputCalendar(this,d,a,c);}};EFormCalendar.prototype.m_default_setValue=function(d,l,b,h,a){if(typeof h=="undefined"){h=true;}if(this.controlData.yearValue!=d||this.controlData.monthValue!=l||this.controlData.dayValue!=b){var m=Number(d);var k=Number(l);var f=Number(b);if(!(m==0&&k==0&&f==0)){if(m==0){m=new Date().getFullYear();}if(k==0){k=1;}if(f==0){f=1;}}this.controlData.yearValue=m+"";this.controlData.monthValue=k+"";this.controlData.dayValue=f+"";var o=this.getValue();if(this.isDOM){var j=this.calendarElement_td.firstChild;if(null==j){j=this.calendarElement_td;}if(typeof this.calendarElement_td.innerText!=="undefined"){o=o.replace(/(\\r\\n)|(\\n)/g,String.fromCharCode(13));o=o.split(" ").join("\u00A0");j.innerText=o;}else{j.innerHTML=o.replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/\n/g,"<br />\n");}var c=this.controlData.isNecessaryCheck=="true"?" eForm_inputNecessary":"";if(""!=o){this.controlData.is_nc=false;if(this.controlData.disable){this.calendarElement_div.className="eF_Rect eForm_inputDisabled "+this.disabledClass;}else{if(this.eform.eForm_isNecessary.check){this.calendarElement_div.className="eF_Rect eForm_inputDefault_bg"+c;}}if(this.controlData.isGuideText){this.calendarElement_td_guide.style.display="none";}}else{if("true"==this.controlData.isNecessaryCheck){this.controlData.is_nc=true;if(this.controlData.disable){this.calendarElement_div.className="eF_Rect eForm_inputDisabled "+this.disabledClass;}else{if(this.eform.eForm_isNecessary.check&&!this.controlData.disable){this.calendarElement_div.className="eF_Rect eForm_NecessaryCheck";}else{this.calendarElement_div.className="eF_Rect eForm_inputDefault_bg"+c;}}}if(this.controlData.isGuideText){this.calendarElement_td_guide.style.display="";}}}else{if(""!=o){this.controlData.is_nc=false;}else{if("true"==this.controlData.isNecessaryCheck){this.controlData.is_nc=true;}}}if(this.controlData.repeatSync){if(typeof a=="undefined"){a=true;}if(a){var p=eform.findCloneControl(this);for(var g=0;g<p.length;g++){p[g].m_default_setValue(m,l,b,h,false);}}}if(typeof getControlEventRulesCommand!="undefined"&&h){if((this.eform.multiView.isSocket&&this.eform.isMain)||!this.eform.multiView.isSocket){var n={};n.uid=this.eform.m_uid;n.reportName=this.controlData.rName;n.inputID=this.controlData.id;n.type="calendar";n.event="change";n.disabled=this.controlData.disable;n.visible=this.controlData.visible;n.yearValue=this.controlData.yearValue;n.monthValue=this.controlData.monthValue;n.dayValue=this.controlData.dayValue;n.value="";n.isNecessaryCheck="true"==this.controlData.isNecessaryCheck;n.isNecessaryChecked=!this.controlData.is_nc;n.sectionName=this.controlData.sName?this.controlData.sName:"";getControlEventRulesCommand(n,false);}}}};EFormCalendar.prototype.getVisible=function(){return this.controlData.visible;};EFormCalendar.prototype.setVisible=function(a,b){if(typeof b=="undefined"){b=false;}this.controlData.visible=a;if(this.isDOM){if(a){this.calendarElement.style.display="";this.calendarElement_div.style.display="";this.calendarElement_td.style.display="";this.calendarElement_focusDiv.style.display="";if(null!=this.calendarElement_table_guide){this.calendarElement_table_guide.style.display="";}}else{this.calendarElement.style.display="none";this.calendarElement_div.style.display="none";this.calendarElement_td.style.display="none";this.calendarElement_focusDiv.style.display="none";if(null!=this.calendarElement_table_guide){this.calendarElement_table_guide.style.display="none";}}}if(b){if(this.eform.multiView.isSocket){this.eform.multiView.socket.sendVisibled(this,a);}}};EFormCalendar.prototype.setDisabledClass=function(a){this.disabledClass=a;if(this.isDOM){this.setDisabled(this.controlData.disable,false);}};EFormCalendar.prototype.getDisabled=function(){return this.controlData.disable;};EFormCalendar.prototype.setDisabled=function(g,h,f){if(typeof h=="undefined"){h=false;}if(typeof f=="undefined"){f=true;}this.controlData.disable=g;var c=g;if(this.isDOM){var d=this.eform.isEasyInput?0:this.controlData.pageNumber;var a=this.eform.m_eformPageDisabled[d];if(null==a){a=false;}if(g||a||this.eform.m_eformDisabled){c=true;this.calendarElement.disabled=true;this.calendarElement_div.className="eF_Rect eForm_inputDisabled "+this.disabledClass;this.calendarElement.style.cursor="auto";}else{c=false;this.calendarElement.disabled=false;this.calendarElement.style.cursor="pointer";var b=this.controlData.isNecessaryCheck=="true"?" eForm_inputNecessary":"";if(this.controlData.disable){this.calendarElement_div.className="eF_Rect eForm_inputDisabled "+this.disabledClass;}else{if(this.eform.eForm_isNecessary.check&&this.controlData.isNecessaryCheck=="true"&&this.controlData.is_nc){this.calendarElement_div.className="eF_Rect eForm_NecessaryCheck";}else{this.calendarElement_div.className="eF_Rect eForm_inputDefault_bg"+b;}}}}if(h){if(this.eform.multiView.isSocket){this.eform.multiView.socket.sendDisabled(this,g);}}if(null!=this.eform.ctrlEvent.disabledEvent&&f){this.eform.ctrlEvent.disabledEvent(c,this);}};EFormCalendar.prototype.setGuideBGColor=function(b,a,d,c,f){if(typeof f=="undefined"){f=true;}this.controlData.bgColor="rgba("+b+","+a+","+d+","+c+")";if(this.isDOM){this.calendarElement_div.style.backgroundColor=this.controlData.bgColor;}if(this.eform.multiView.isSocket&&f){this.eform.multiView.socket.sendControlColor(this,b,a,d,c);}};EFormCalendar.prototype.m_setBGColor=function(){if(null!=this.controlData.bgColor){if(this.isDOM){this.calendarElement_div.style.backgroundColor=this.controlData.bgColor;}}};EFormCalendar.prototype.setNecessaryCheck=function(a,b){if(typeof b=="undefined"){b=false;}if(a){this.controlData.isNecessaryCheck="true";if(""!=this.getValue()){this.controlData.is_nc=false;if(this.isDOM){this.calendarElement_div.className="eF_Rect";}}else{this.controlData.is_nc=true;}}else{this.controlData.is_nc=false;this.controlData.isNecessaryCheck="false";if(this.isDOM){this.calendarElement_div.className="eF_Rect";}}this.setDisabled(this.controlData.disable,false);this.setVisible(this.controlData.visible,false);if(b){if(this.eform.multiView.isSocket){this.eform.multiView.socket.sendNecessaryCheck(this,a);}}};EFormCalendar.prototype.getIndexOrderDisabled=function(){return this.controlData.indexOrderDisable;};EFormCalendar.prototype.setIndexOrderDisabled=function(a){this.controlData.indexOrderDisable=a;};EFormCalendar.prototype.setAutoNextFocus=function(a){this.controlData.isAutoNextFocus=a;};EFormCalendar.prototype.getTitle=function(){return this.title;};EFormCalendar.prototype.setTitle=function(a){this.title=a;if(this.isDOM){this.calendarElement.title=a;}};EFormCalendar.prototype.callInappCalendar=function(){var d=new Date();var b=Number(this.controlData.yearValue);if(b==0){b=d.getFullYear();}var f=Number(this.controlData.monthValue);var g=Number(this.controlData.dayValue);if(!mRe_isValidDate(b,f,g)){b=d.getFullYear();f=d.getMonth()+1;g=d.getDate();}var h=this;var a;try{a=window.top;}catch(c){console.error("최상위 window 객체에 접근할 수 없습니다:",c);a=window;}a.set_report_inapp_date=function(j,k,i){h.setValue(j,k,i);};if(typeof ClipHybrid!="undefined"){ClipHybrid.getCalendarDate(b,f,g);}else{ReportWebLog("Not Found InappCalendar !!");}};EFormCalendar.prototype.onDayClickEvent=function(a){this.event.dayClickEvent=a;this.event.eventTarget=this;};EFormCalendar.prototype.onClickEvent=function(a){this.event.clickEvent=a;this.event.eventTarget=this;};EFormCalendar.prototype.onClick=function(){var a=true;if(null!=this.event.clickEvent){a=this.event.clickEvent(this);}if(null!=this.eform.ctrlEvent.calendarClickEvent){a=this.eform.ctrlEvent.calendarClickEvent(this);}return a;};EFormCalendar.prototype.onBackgroundClickEvent=function(a){this.event.backgroundClickEvent=a;this.event.eventTarget=this;};EFormCalendar.prototype.onRemoveButtonEvent=function(a){this.event.removeButtonEvent=a;this.event.eventTarget=this;};EFormCalendar.prototype.getPageNumber=function(){if(typeof this.controlData.pageNumber=="undefined"){return null;}return this.controlData.pageNumber+1;};EFormCalendar.prototype.focus=function(){if(this.isDOM){var a=this.calendarElement;setTimeout(function(){a.focus();},1);}else{if(!this.eform.isEasyInput){this.eform.m_isrulesControlInfo=this.ctrlID;this.eform.sendRulesControlInfo();this.eform.selectPage(this.controlData.pageNumber,"control_focus");}}};EFormCalendar.prototype.setCustomApp=function(a){this.customAppName=a;};EFormCalendar.prototype.focusControl=function(){this.eform.mRe_inputFocusRectBlur();this.calendarElement_focusDiv.className="eF_Rect eform_control_focus";this.eform.inputImagePointerIn(this);if(this.eform.titleSpeechBubble.visible.calendar){this.eform.inputCreateTitleSpeechBubble(this);}else{this.eform.inputRemoveTitleSpeechBubble();}if(this.eform.m_isHybridQuickControl||null!=this.controlData.inputOrder){this.eform.inputOrderFoucs(this);}else{this.eform.inputOrderBlur();}if(this.eform.multiView.isSocket&&this.eform.multiView.socket.isMain&&this.eform.isSubAppType&&!is_exeMirroring&&!this.eform.m_exeOption.isCalendarAct){this.createSubCallKeyboardButton();}else{if(this.eform.m_isHybridQuickControl){if(null!=this.controlData.inputOrder&&this.controlData.is_nc){if(this.eform.m_isUsePopupInputFrame.calendar){this.callFrameCalendar();}else{if(is_appControl||this.eform.m_exeOption.isCalendarAct){this.callHybridCalendar();}else{this.eformCalendarControl();}}if(event.stopPropagation){event.stopPropagation();}else{event.cancelBubble=true;}}}}};EFormCalendar.prototype.multiViewFocus=function(){if(null==mRe_FocusControl.objCtrl||mRe_FocusControl.objCtrl!=this){mRe_FocusControl.objCtrl=this;if(this.isDOM){if(this.eform.m_isMultiViewFoucs){this.calendarElement.focus();}else{this.eform.mRe_inputFocusRectBlur();this.calendarElement_focusDiv.className="eF_Rect eform_control_focus";this.eform.inputImagePointerIn(this);if(this.eform.titleSpeechBubble.visible.calendar){this.eform.inputCreateTitleSpeechBubble(this);}else{this.eform.inputRemoveTitleSpeechBubble();}if(this.eform.m_isHybridQuickControl){this.eform.inputOrderFoucs(this);}}}}};EFormCalendar.prototype.multiViewBlur=function(){mRe_FocusControl={objCtrl:null,element:null,className:null};if(this.isDOM){this.calendarElement_focusDiv.className="eF_Rect";this.eform.inputImagePointerOut();this.removeSubCallKeyboardButton();}};EFormCalendar.prototype.subCallCalendar=function(){if(this.eform.multiView.isSocket){this.eform.multiView.socket.sendHybridInputCallCalendar(this);}};EFormCalendar.prototype.createSubCallKeyboardButton=function(){if(this.isDOM&&null==this.callKeyboardButton){var a=this;var b=document.createElement("button");var d=this.calendarElement;var f=d.parentElement;b.className="eform_keyboard_call_button";b.style.left=d.offsetLeft+"px";b.style.top=(d.offsetTop+d.offsetHeight+5)+"px";b.innerHTML=this.eform.m_SubInputCallButtonText;b.onmousedown=function(g){if(a.eform.multiView.isSocket){a.eform.multiView.socket.sendHybridInputCallCalendar(a);}a.removeSubCallKeyboardButton();g.preventDefault();};f.appendChild(b);var c=document.createElement("button");c.className="eform_keyboard_call_button";c.style.left=b.offsetLeft+b.offsetWidth+5+"px";c.style.top=(d.offsetTop+d.offsetHeight+5)+"px";c.innerHTML="직접입력";c.onmousedown=function(g){if(is_appControl||a.eform.m_exeOption.isCalendarAct){a.callHybridCalendar();}else{a.eformCalendarControl();}a.removeSubCallKeyboardButton();g.preventDefault();};f.appendChild(c);this.callKeyboardButton=b;this.callKeyboardButton2=c;}};EFormCalendar.prototype.removeSubCallKeyboardButton=function(){if(this.isDOM){if(null!=this.callKeyboardButton){try{this.calendarElement.parentElement.removeChild(this.callKeyboardButton);this.calendarElement.parentElement.removeChild(this.callKeyboardButton2);}catch(a){mRe_ReportWebLog(a.stack);}this.callKeyboardButton=null;}}};function mRe_isLeaf(b){var a=false;if(b%4==0){a=true;if(b%100==0){a=false;}if(b%400==0){a=true;}}return a;}function mRe_isValidDate(c,f,a){var b=[31,28,31,30,31,30,31,31,30,31,30,31];if(a==0){return false;}var d=false;if(mRe_isLeaf(c)){if(f==2){if(a<=b[f-1]+1){d=true;}}else{if(a<=b[f-1]){d=true;}}}else{if(a<=b[f-1]){d=true;}}return d;}EFormCalendar.prototype.callHybridCalendar=function(){this.eform.inputOrderFoucs(this);var d=this;var c=null;if(this.eform.multiView.isSocket){c=d.eform.multiView.socket;c.sendScreenLock("calendar",d.eform.m_uid);}var b;try{b=window.top;}catch(f){console.error("최상위 window 객체에 접근할 수 없습니다:",f);b=window;}b.set_report_calendar_data=function(m,l,n,j){if("next"==m){var i=true;if(null!=d.event.dayClickEvent){i=d.event.dayClickEvent(l,n,j,d);}if(null!=d.eform.ctrlEvent.calendarDayClickEvent&&i){i=d.eform.ctrlEvent.calendarDayClickEvent(l,n,j,d);}if(i){d.setValue(l,n,j);if(d.eform.multiView.isSocket){d.eform.multiView.socket.sendFocusControl(d,"out");}if(d.controlData.isAutoNextFocus){var k=d.eform.nextHybridInputControl(d);if(!k){d.eform.nextEasyInputControl(d);}}}else{d.calendarElement.blur();}}else{if("cencel"==m){d.calendarElement.blur();}else{if("ok"==m){var i=true;if(null!=d.event.dayClickEvent){i=d.event.dayClickEvent(l,n,j,d);}if(null!=d.eform.ctrlEvent.calendarDayClickEvent&&i){i=d.eform.ctrlEvent.calendarDayClickEvent(l,n,j,d);}if(i){d.setValue(l,n,j);if(d.eform.multiView.isSocket){d.eform.multiView.socket.sendFocusControl(d,"out");}d.calendarElement.blur();}else{d.calendarElement.blur();}}}}if(null!=c){c.sendScreenUnLock(d.eform.m_uid);}};var h=new Object();h.id=this.calendarElement.id;h.title=this.getTitle();h.isMirroring=!this.eform.getIsMain();h.guideMsg="";h.year=this.controlData.yearValue+"";h.month=this.controlData.monthValue+"";h.day=this.controlData.dayValue+"";h.customAppName=this.customAppName;h.displayType=mRe_calendar_displayPatterns[this.controlData.displayType].join("-");if(is_appControl){if(this.eform.multiView.isSocket){var a=this.eform;c=this.eform.multiView.socket;window.setTimeout(function(){c.sendScreenLockStampButton(a.m_uid,null,3);},100);}ClipHybrid.callNativeControl("calendar",JSON.stringify(h));}else{var g={methodName:"ShowCalendar",data:null};g.data=h;window.external.ClipSubWebBrowserCtrl_Invoke(JSON.stringify(g));}if(this.eform.multiView.isSocket){this.eform.multiView.socket.sendFocusControl(this,"in");}};function mRe_getDaysInMonth(b,c){if(c==0){return 0;}var a=[31,28,31,30,31,30,31,31,30,31,30,31];if(mRe_isLeaf(b)){a[1]=29;}return a[c-1];}window.mRe_calendar_formatPatterns={0:{split:"-",order:["YYYY","MM","DD"]},1:{split:"/",order:["YYYY","MM","DD"]},2:{split:".",order:["YYYY","MM","DD"]},3:{split:"",order:["YYYY년","MM월","DD일"]},4:{split:"-",order:["DD","MM","YYYY"]},5:{split:"/",order:["DD","MM","YYYY"]},6:{split:".",order:["DD","MM","YYYY"]},7:{split:"-",order:["DD","MMM","YYYY"]},8:{split:"/",order:["DD","MMM","YYYY"]},9:{split:".",order:["DD","MMM","YYYY"]},10:{split:"-",order:["MM","DD","YYYY"]},11:{split:"/",order:["MM","DD","YYYY"]},12:{split:".",order:["MM","DD","YYYY"]},13:{split:"-",order:["MMM","DD","YYYY"]},14:{split:"/",order:["MMM","DD","YYYY"]},15:{split:".",order:["MMM","DD","YYYY"]},16:{split:"-",order:["MMMM","DD","YYYY"]},17:{split:"/",order:["MMMM","DD","YYYY"]},18:{split:".",order:["MMMM","DD","YYYY"]},19:{split:"-",order:["DD","MMMM","YYYY"]},20:{split:"/",order:["DD","MMMM","YYYY"]},21:{split:".",order:["DD","MMMM","YYYY"]},22:{split:"",order:["DD","MM","YYYY"]},23:{split:"",order:["DD","MMM","YYYY"]},24:{split:"",order:["DD","MMMM","YYYY"]},25:{split:"",order:["MM","DD","YYYY"]},26:{split:"",order:["MMM","DD","YYYY"]},27:{split:"",order:["MMMM","DD","YYYY"]}};window.mRe_calendar_displayPatterns={0:["YEAR","MONTH","DAY"],1:["YEAR","MONTH"],2:["MONTH","DAY"],3:["YEAR"],4:["MONTH"],5:["DAY"]};function mRe_getFormattedDate(b,a,f){var d=mRe_calendar_formatPatterns[b]||{};var c=mRe_calendar_displayPatterns[a]||[];var g=d.order.slice();g=g.filter(function(h){if(h.indexOf("YY")!==-1&&c.indexOf("YEAR")!==-1){return true;}if(h.indexOf("MM")!==-1&&c.indexOf("MONTH")!==-1){return true;}if(h.indexOf("DD")!==-1&&c.indexOf("DAY")!==-1){return true;}return false;});return g.join((d.split||"")+f);}function EFormSelectbox(){this.eform=null;this.ctrlID=null;this.controlData=null;this.group=null;this.isDOM=false;this.selectboxElement=null;this.selectboxElement_div=null;this.selectboxElement_td=null;this.selectboxElement_focusDiv=null;this.event={changeEvent:null,eventTarget:null};this.title=null;this.viewOption={selectboxBGDom:null,selectboxFrameDom:null};this.selectOpStyle="";this.selectOpClass="";this.bgColor=null;this.isVisibleArrow=true;this.disabledClass="";}EFormSelectbox.prototype.setGroup=function(a){this.group=a;};EFormSelectbox.prototype.init=function(b,a,d){this.eform=d;this.ctrlID=b;this.controlData=a;this.controlData.necessaryMessage=a.necessaryMessage.replace(/\\\//g,"/").replace(/\\\\/g,"\\").replace(/\\\"/g,'"');this.controlData.value=a.value.replace(/\\\//g,"/").replace(/\\\\/g,"\\").replace(/\\\"/g,'"');this.controlData.label="";for(var c=0;c<this.controlData.options.length;c++){var f=this.controlData.options[c];f.L=f.L.replace(/\\\//g,"/").replace(/\\\\/g,"\\").replace(/\\\"/g,'"');f.V=f.V.replace(/\\\//g,"/").replace(/\\\\/g,"\\").replace(/\\\"/g,'"');if(this.controlData.value==f.V){this.controlData.label=f.L;}}if(null!=a.inputOrder){this.eform.eFormIndexControlList[a.inputOrder]=this;}if(null==a.indexOrderDisable){a.indexOrderDisable=false;}if(null==a.isToView){a.isToView=true;}if(null==a.isToEasyMode){a.isToEasyMode=true;}if(d.isEasyInput&&a.isToEasyMode){a.isToView=true;}if(!a.isToView){a.is_nc=false;}if(null==a.isAutoNextFocus){a.isAutoNextFocus=true;}if(null==a.repeatSync){a.repeatSync=false;}if(null!=a.guideText){a.guideText=a.guideText.replace(/\\\//g,"/").replace(/\\\\/g,"\\").replace(/\\\"/g,'"').replace(/\\t/g,"    ");a.guideText=unescape(a.guideText.replace(/\\u/g,"%u"));}else{a.guideText="";}if(null==a.guideTextColor){a.guideTextColor="gray";}if(null!=a.title){this.controlData.title=a.title.replace(/\\\//g,"/").replace(/\\\\/g,"\\").replace(/\\\"/g,'"');this.title=this.controlData.title;}else{this.controlData.title="";}if(null==a.sName){a.sName="";}mRe_selectbox=null;};EFormSelectbox.prototype.deleteMe=function(){this.eform=null;this.ctrlID=null;this.controlData=null;this.event=null;this.group=null;this.deleteDOM();};EFormSelectbox.prototype.resetDOM=function(){this.isDOM=false;this.selectboxElement=null;this.selectboxElement_div=null;this.selectboxElement_td=null;this.selectboxElement_focusDiv=null;};EFormSelectbox.prototype.deleteDOM=function(){if(this.selectboxElement){if(this.selectboxElement.parentElement){this.selectboxElement.parentElement.removeChild(this.selectboxElement);}else{delete this.selectboxElement;}}if(this.selectboxElement_div){if(this.selectboxElement_div.parentElement){this.selectboxElement_div.parentElement.removeChild(this.selectboxElement_div);}else{delete this.selectboxElement_div;}}if(this.selectboxElement_td){if(this.selectboxElement_td.parentElement){this.selectboxElement_td.parentElement.removeChild(this.selectboxElement_td);}else{delete this.selectboxElement_td;}}if(this.selectboxElement_focusDiv){if(this.selectboxElement_focusDiv.parentElement){this.selectboxElement_focusDiv.parentElement.removeChild(this.selectboxElement_focusDiv);}else{delete this.selectboxElement_focusDiv;}}this.resetDOM();};EFormSelectbox.prototype.getRect=function(){if(this.isDOM){var b={left:0,top:0,width:0,height:0};var d=this.selectboxElement;var c=d.parentElement.offsetLeft;var a=d.parentElement.offsetTop;b.left=c+d.offsetLeft;b.top=a+d.offsetTop;b.width=d.offsetWidth;b.height=d.offsetHeight;return b;}return null;};EFormSelectbox.prototype.getHE=function(){if(this.isDOM){return this.selectboxElement;}return null;};EFormSelectbox.prototype.eventHandlerSelectBox=function(){if(!this.controlData.isToView){return;}if(typeof this.controlData.pageNumber=="undefined"){this.controlData.pageNumber=this.eform.beforePageIndex;}this.isDOM=true;this.selectboxElement=document.getElementById(this.eform.m_uid+this.ctrlID);this.selectboxElement_div=document.getElementById(this.eform.m_uid+this.ctrlID+"SPAN");this.selectboxElement_td=document.getElementById(this.eform.m_uid+this.ctrlID+"TD");this.selectboxElement_focusDiv=document.getElementById(this.eform.m_uid+this.ctrlID+"FOCUS");if(this.eform.m_RuleCtrlVisible){if(null!=this.selectboxElement_div){var f=this.selectboxElement_div.parentElement;if(null!=f){var k=document.createElement("div");k.style.position="absolute";k.style.left=f.style.left;k.style.top=f.style.top;k.style.width=f.style.width;k.style.height=f.style.height;k.style.color="red";k.style.fontSize="8pt";k.style.fontWeight="bold";var d=this.ctrlID;if(-1!=d.indexOf(".")){d=d.substring(d.indexOf(".")+1);}d=decodeURI(d.replace(/[r]/g,"%"));d=d.substring(0,d.lastIndexOf("_"));k.innerHTML=d+" ("+this.controlData.id+")";var j=f.parentElement;var h=f.nextSibling;if(null!=h){j.insertBefore(k,h);}else{j.appendChild(k);}}}}if(null==this.title){this.title=this.selectboxElement.title;}else{this.selectboxElement.title=this.title;}if(is_appControl||this.eform.m_exeOption.isSelectBoxAct){this.eform.m_isPopupSelect=true;}if(this.eform.m_isPopupSelect){var a=this.selectboxElement.parentElement;var m=document.createElement("button");m.id=this.selectboxElement.id;m.title=this.title;m.className=this.selectboxElement.className;m.tabIndex=this.selectboxElement.tabIndex;m.style.cssText=this.selectboxElement.style.cssText;a.insertBefore(m,this.selectboxElement);a.removeChild(this.selectboxElement);this.selectboxElement=m;}else{this.selectboxElement.innerHTML="";for(var n=0;n<this.controlData.options.length;n++){var o=this.controlData.options[n];var g=document.createElement("option");g.style.cssText=this.selectOpStyle;g.className="eForm_selectbox_option "+this.selectOpClass;g.value=o.V;g.innerHTML=o.L;this.selectboxElement.appendChild(g);}this.selectboxElement.value=this.controlData.value;}var i=this.controlData.label;if(""!=i){this.controlData.is_nc=false;}else{if(this.controlData.isNecessaryCheck=="true"){this.controlData.is_nc=true;}if(this.eform.eForm_isNecessary.check&&this.controlData.is_nc){this.selectboxElement_div.className="eF_Rect eForm_NecessaryCheck";}}var c=this;if(null!=this.selectboxElement_focusDiv&&null!=this.selectboxElement){this.selectboxElement.onblur=function(){var p=c.selectboxElement_focusDiv;if(null!=p){p.className="eF_Rect";c.eform.inputImagePointerOut();}if(c.eform.multiView.isSocket){c.eform.multiView.socket.sendFocusControl(c,"out");}};this.selectboxElement.onfocus=function(){c.focusControl();if(c.eform.multiView.isSocket){c.eform.multiView.socket.sendFocusControl(c,"in");}};}var l=this.selectboxElement_td.firstChild;if(null==l){l=this.selectboxElement_td;}if(""==i&&""!=this.controlData.guideText){i=this.controlData.guideText;l.style.color=this.controlData.guideTextColor;}else{l.style.color="";}if(typeof this.selectboxElement_td.innerText!=="undefined"){l.innerText=i;}else{l.innerHTML=i.replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/\n/g,"<br />\n");}if(this.eform.m_isPopupSelect){this.selectboxElement.onmousedown=function(p){var q=false;if("which" in p){q=p.which==3;}else{if("button" in p){q=p.button==2;}}if(q){p.preventDefault();return;}if(c.eform.mRe_MainNecessaryInputEnabledCheckControl(c)){if(c.eform.m_isUsePopupInputFrame.select){c.callFrameSelectbox();}else{if(is_appControl||c.eform.m_exeOption.isSelectBoxAct){c.callHybridSelectbox();}else{c.eformSelectPopupControl();}}}else{p.preventDefault();return;}};this.selectboxElement.onkeyup=function(p){if(32==p.keyCode||13==p.keyCode){if(c.eform.mRe_MainNecessaryInputEnabledCheckControl(c)){if(c.eform.m_isUsePopupInputFrame.select){c.callFrameSelectbox();}else{if(is_appControl||c.eform.m_exeOption.isSelectBoxAct){c.callHybridSelectbox();}else{c.eformSelectPopupControl();}}}}};}else{this.selectboxElement.onmousedown=function(p){var q=false;if("which" in p){q=p.which==3;}else{if("button" in p){q=p.button==2;}}if(q){p.preventDefault();return;}if(!c.eform.mRe_MainNecessaryInputEnabledCheckControl(c)){this.focus();p.preventDefault();return;}};this.selectboxElement.onchange=function(p){c.EFormSelectboxControl(this);};}if(!this.isVisibleArrow){if(null!=this.selectboxElement_td){var b=this.selectboxElement_td.nextSibling;b.innerHTML="";}}this.m_setBGColor();this.setDisabled(this.controlData.disable,false);this.setVisible(this.controlData.visible,false);};EFormSelectbox.prototype.callFrameSelectbox=function(){if(!this.eform.m_isUsePopupInputFrame.select||null!=this.eform.signPaintDiv){return;}var f=this;var s=this.eform;s.inputOrderFoucs(this);var j=null;if(s.multiView.isSocket){j=s.multiView.socket;j.sendScreenLock("key",s.m_uid);}s.disabledMenu(true);Re_zoom.isPop=true;var a=310;var l=document.createElement("div");l.className="m_eform_popup_background";l.style.background="rgba(155,155,155,0.3)";l.addEventListener("touchstart",function(x){if(x.touches.length>1){x.preventDefault();}},false);var c=document.createElement("div");if(s.m_isBottomPopHeight>0){c.style.height=(a)+"px";}else{c.style.height=(a<230?210:a)+"px";}c.className="eform_popup_body";var o=document.createElement("div");o.className="eform_popup_header";var i=document.createElement("div");i.className="eform_popup_header_Label";var t=document.createElement("nobr");i.appendChild(t);var m=document.createElement("button");m.className="eform_popup_close_button";var b=document.createElement("button");b.className="eform_popup_save_button";var w=document.createElement("button");w.className="eform_popup_next_button";o.appendChild(i);o.appendChild(m);o.appendChild(b);o.appendChild(w);c.appendChild(o);l.appendChild(c);s.m_bodyDiv.appendChild(l);s.signPaintDiv=l;var q=document.createElement("div");q.className="eform_popup_frame";q.style.left="0px";q.style.right="0px";c.appendChild(q);var r=document.createElement("div");r.className="eform_popup_frame_Label";var k=document.createElement("nobr");r.appendChild(k);r.innerHTML=this.controlData.title;q.appendChild(r);var g=document.createElement("button");g.className="eform_popup_frameReset_button";q.appendChild(g);var v=document.createElement("div");v.className="eform_popup_frame_body";q.appendChild(v);var u=document.createElement("select");var p=document.createElement("option");p.value="";p.innerHTML=(typeof window.objClipPopupSelectPlaceHolder!="undefined")?window.objClipPopupSelectPlaceHolder:"선택이 필요합니다.";p.disabled=true;p.selected=true;u.appendChild(p);for(var d=0;d<this.controlData.options.length;d++){var n=this.controlData.options[d];var h=document.createElement("option");h.style.cssText=this.selectOpStyle;h.className="eForm_selectbox_option "+this.selectOpClass;h.value=n.V;h.innerHTML=n.L;u.appendChild(h);}u.className="eform_popup_frame_body_select";u.style.cssText="left:0px; right:0px; appearance:none;";u.required=true;v.appendChild(u);u.value=this.controlData.value;g.onclick=function(){u.value="";};window.mRe_popupInput_close=m;m.onclick=function(){s.signPaintDiv=null;mRe_reSetPopupStatus();s.m_bodyDiv.removeChild(l);s.disabledMenu(false);if(null!=j){j.sendScreenUnLock(s.m_uid);}};b.onclick=function(){f.setValue(u.value);s.signPaintDiv=null;mRe_reSetPopupStatus();s.m_bodyDiv.removeChild(l);s.disabledMenu(false);if(f.eform.multiView.isSocket){f.eform.multiView.socket.sendFocusControl(f,"out");}if(null!=j){j.sendScreenUnLock(s.m_uid);}};w.onclick=function(){f.setValue(u.value);s.signPaintDiv=null;mRe_reSetPopupStatus();s.m_bodyDiv.removeChild(l);s.disabledMenu(false);if(f.eform.multiView.isSocket){f.eform.multiView.socket.sendFocusControl(f,"out");}if(f.controlData.isAutoNextFocus){var x=f.eform.nextHybridInputControl(f);if(!x){f.eform.nextEasyInputControl(f);}}if(null!=j){j.sendScreenUnLock(s.m_uid);}};};EFormSelectbox.prototype.EFormSelectboxControl=function(a){if(this.eform.m_isButtonLock==false){this.setValue(a.value);this.onChange();if(this.controlData.isAutoNextFocus){this.eform.nextHybridInputControl(this);}}};EFormSelectbox.prototype.selectLabelOption=function(a){if(this.eform.m_isButtonLock==false){var b=a.getAttribute("value");if(this.controlData.value!=b){this.setValue(b);this.onChange();this.removeSelectboxView();if(this.controlData.isAutoNextFocus){this.eform.nextHybridInputControl(this);}return;}}this.removeSelectboxView();};EFormSelectbox.prototype.eformSelectPopupControl=function(){if(this.eform.m_isButtonLock==false){if(null==mRe_selectbox){mRe_selectbox=this;}var d=this.eform;d.disabledMenu(true);this.viewOption.selectboxBGDom=document.createElement("div");this.viewOption.selectboxBGDom.addEventListener("contextmenu",function(l){l.preventDefault();},false);this.viewOption.selectboxBGDom.className=is_smartphone?"m_eform_calendar_div":"eform_calendar_div";this.viewOption.selectboxFrameDom=document.createElement("div");this.viewOption.selectboxFrameDom.tabIndex=0;this.viewOption.selectboxBGDom.appendChild(this.viewOption.selectboxFrameDom);d.m_bodyDiv.appendChild(this.viewOption.selectboxBGDom);this.reSize();this.viewOption.selectboxBGDom.onclick=function(){mRe_selectbox.removeSelectboxView();};this.viewOption.selectboxFrameDom.onclick=function(l){if(l.stopPropagation){l.stopPropagation();}else{l.cancelBubble=true;}};var a=document.createElement("div");a.className="eform_selectbox_menu_top";var k=document.createElement("div");k.className="eform_selectbox_menu_top_text";k.title=this.title;k.innerHTML=this.title;k.tabIndex=0;var j=document.createElement("div");j.className="eform_selectbox_menu_top_close";j.title="닫기";j.tabIndex=0;j.onmousedown=function(l){mRe_selectbox.removeSelectboxView();l.preventDefault();};j.onkeyup=function(l){if(32==l.keyCode||13==l.keyCode){mRe_selectbox.removeSelectboxView();}};a.appendChild(k);a.appendChild(j);var c=document.createElement("div");c.className="eform_selectbox_menu_body";for(var g=0;g<this.controlData.options.length;g++){var i=this.controlData.options[g];var b=document.createElement("div");b.tabIndex=0;b.title=i.L;b.setAttribute("label",i.L);b.setAttribute("value",i.V);b.innerHTML=i.L;b.className="eform_selectbox_menu_list";if(i.V==this.controlData.value){var f=document.createElement("div");f.className="eform_selectbox_menu_selectedList";b.appendChild(f);}c.appendChild(b);b.onmousedown=function(l){mRe_selectbox.selectLabelOption(this);l.preventDefault();};b.onkeyup=function(l){if(32==l.keyCode||13==l.keyCode){mRe_selectbox.selectLabelOption(this);}};}var h=document.createElement("div");h.className="eform_selectbox_menu_bottom";this.viewOption.selectboxFrameDom.appendChild(a);this.viewOption.selectboxFrameDom.appendChild(c);this.viewOption.selectboxFrameDom.appendChild(h);window.setTimeout(function(){mRe_selectbox.viewOption.selectboxFrameDom.focus();},10);}};EFormSelectbox.prototype.removeSelectboxView=function(){this.eform.disabledMenu(false);this.eform.m_bodyDiv.removeChild(this.viewOption.selectboxBGDom);mRe_selectbox=null;this.viewOption={selectboxBGDom:null,selectboxFrameDom:null};this.selectboxElement.focus();};EFormSelectbox.prototype.reSize=function(){if(null!=this.viewOption.selectboxBGDom){var a=this.eform;var b=a.paintDiv.offsetWidth;var g=a.paintDiv.offsetHeight;var f=0;var c=0;var h=0;var d=is_smartphone?500:420;if(b>g){h=g-40;if(h>d){h=d;c=(g-h)/2;}else{c=20;}f=(b-h)/2;}else{h=b-40;if(h>d){h=d;f=(b-h)/2;}else{f=20;}c=(g-h)/2;}var i=h*0.8;f+=(h-i)/2;this.viewOption.selectboxFrameDom.style.cssText="position:absolute;left:"+f+"px;top:"+c+"px;width:"+i+"px;height:"+h+"px;";}};EFormSelectbox.prototype.getCtrlID=function(){return this.ctrlID;};EFormSelectbox.prototype.getType=function(){return this.controlData.type;};EFormSelectbox.prototype.getValue=function(){return this.controlData.value;};EFormSelectbox.prototype.setValue=function(a){this.m_default_setValue(a);if(this.eform.multiView.isSocket){this.eform.multiView.socket.sendInputSelectbox(this,"value",a);}};EFormSelectbox.prototype.getGuideText=function(){return this.controlData.guideText;};EFormSelectbox.prototype.setGuideText=function(c){if(this.controlData.guideText!=c){this.controlData.guideText=c;if(this.isDOM){var b=this.selectboxElement_td.firstChild;if(null==b){b=this.selectboxElement_td;}var a=this.controlData.label;if(""==a&&""!=c){a=c;b.style.color=this.controlData.guideTextColor;if(typeof this.selectboxElement_td.innerText!=="undefined"){b.innerText=a;}else{b.innerHTML=a.replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/\n/g,"<br />\n");}}else{b.style.color="";}}}};EFormSelectbox.prototype.setGuideTextColor=function(b,a,c){this.controlData.guideTextColor="rgb("+b+","+a+","+c+")";if(this.isDOM){var d=this.selectboxElement_td.firstChild;if(null==d){d=this.selectboxElement_td;}if(""==this.controlData.label&&""!=this.controlData.guideText){d.style.color=this.controlData.guideTextColor;}}};EFormSelectbox.prototype.m_default_setValue=function(d,c){if(this.controlData.value!=d){this.controlData.value=d;this.changeSelect(d);if(this.controlData.repeatSync){if(typeof c=="undefined"){c=true;}if(c){var a=eform.findCloneControl(this);for(var b=0;b<a.length;b++){a[b].m_default_setValue(d,false);}}}}};EFormSelectbox.prototype.changeSelect=function(f){var c="";if(this.isDOM){if(this.eform.m_isPopupSelect){for(var b=0;b<this.controlData.options.length;b++){var h=this.controlData.options[b];if(h.V==f){c=h.L;}}}else{this.selectboxElement.value=f;if(this.selectboxElement.selectedIndex!=-1){c=this.selectboxElement[this.selectboxElement.selectedIndex].innerText;}}this.controlData.label=c;var g=this.selectboxElement_td.firstChild;if(null==g){g=this.selectboxElement_td;}var d=c;if(""==d&&""!=this.controlData.guideText){d=this.controlData.guideText;g.style.color=this.controlData.guideTextColor;}else{g.style.color="";}if(typeof this.selectboxElement_td.innerText!=="undefined"){g.innerText=d;}else{g.innerHTML=d.replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/\n/g,"<br />\n");}var a=this.controlData.isNecessaryCheck=="true"?" eForm_inputNecessary":"";if(""!=c){this.controlData.is_nc=false;if(this.getDisabled()){this.selectboxElement_div.className="eF_Rect eForm_inputDisabled "+this.disabledClass;}else{if(this.eform.eForm_isNecessary.check){this.selectboxElement_div.className="eF_Rect eForm_inputDefault_bg"+a;}}}else{if("true"==this.controlData.isNecessaryCheck){this.controlData.is_nc=true;if(this.getDisabled()){this.selectboxElement_div.className="eF_Rect eForm_inputDisabled "+this.disabledClass;}else{if(this.eform.eForm_isNecessary.check&&!this.controlData.disable){this.selectboxElement_div.className="eF_Rect eForm_NecessaryCheck";}else{this.selectboxElement_div.className="eF_Rect eForm_inputDefault_bg"+a;}}}}}else{for(var b=0;b<this.controlData.options.length;b++){var h=this.controlData.options[b];if(h.V==f){c=h.L;}}this.controlData.label=c;if(""!=c){this.controlData.is_nc=false;}else{if("true"==this.controlData.isNecessaryCheck){this.controlData.is_nc=true;}}}};EFormSelectbox.prototype.getVisible=function(){return this.controlData.visible;};EFormSelectbox.prototype.setVisible=function(a,b){if(typeof b=="undefined"){b=false;}this.controlData.visible=a;if(this.isDOM){if(a){this.selectboxElement.style.display="";this.selectboxElement_div.style.display="";this.selectboxElement_td.style.display="";if(null!=this.selectboxElement_td.nextSibling){this.selectboxElement_td.nextSibling.style.display="";}this.selectboxElement_focusDiv.style.display="";}else{this.selectboxElement.style.display="none";this.selectboxElement_div.style.display="none";this.selectboxElement_td.style.display="none";if(null!=this.selectboxElement_td.nextSibling){this.selectboxElement_td.nextSibling.style.display="none";}this.selectboxElement_focusDiv.style.display="none";}}if(b){if(this.eform.multiView.isSocket){this.eform.multiView.socket.sendVisibled(this,a);}}};EFormSelectbox.prototype.setVisibleArrow=function(a){this.isVisibleArrow=a;if(null!=this.selectboxElement_td){var b=this.selectboxElement_td.nextSibling;if(a){b.innerHTML="▼";}else{b.innerHTML="";}}};EFormSelectbox.prototype.setDisabledClass=function(a){this.disabledClass=a;if(this.isDOM){this.setDisabled(this.controlData.disable,false);}};EFormSelectbox.prototype.getDisabled=function(){return this.controlData.disable;};EFormSelectbox.prototype.setDisabled=function(g,h,f){if(typeof h=="undefined"){h=false;}if(typeof f=="undefined"){f=true;}this.controlData.disable=g;var c=g;if(this.isDOM){var d=this.eform.isEasyInput?0:this.controlData.pageNumber;var a=this.eform.m_eformPageDisabled[d];if(null==a){a=false;}if(g||a||this.eform.m_eformDisabled){c=true;this.selectboxElement.disabled=true;this.selectboxElement_div.className="eF_Rect eForm_inputDisabled "+this.disabledClass;this.selectboxElement.style.cursor="auto";}else{c=false;this.selectboxElement.disabled=false;this.selectboxElement.style.cursor="pointer";if(this.eform.eForm_isNecessary.check&&this.controlData.isNecessaryCheck=="true"&&this.controlData.is_nc){this.selectboxElement_div.className="eF_Rect eForm_NecessaryCheck";}else{var b=this.controlData.isNecessaryCheck=="true"?" eForm_inputNecessary":"";this.selectboxElement_div.className="eF_Rect eForm_inputDefault_bg"+b;}}}if(h){if(this.eform.multiView.isSocket){this.eform.multiView.socket.sendDisabled(this,g);}}if(null!=this.eform.ctrlEvent.disabledEvent&&f){this.eform.ctrlEvent.disabledEvent(c,this);}};EFormSelectbox.prototype.setGuideBGColor=function(b,a,d,c,f){if(typeof f=="undefined"){f=true;}this.controlData.bgColor="rgba("+b+","+a+","+d+","+c+")";if(this.isDOM){this.selectboxElement_div.style.backgroundColor=this.controlData.bgColor;}if(this.eform.multiView.isSocket&&f){this.eform.multiView.socket.sendControlColor(this,b,a,d,c);}};EFormSelectbox.prototype.m_setBGColor=function(){if(null!=this.controlData.bgColor){if(this.isDOM){this.selectboxElement_div.style.backgroundColor=this.controlData.bgColor;}}};EFormSelectbox.prototype.setNecessaryCheck=function(a,b){if(typeof b=="undefined"){b=false;}if(a){this.controlData.isNecessaryCheck="true";if(""!=this.controlData.label){this.controlData.is_nc=false;if(this.isDOM){this.selectboxElement_div.className="eF_Rect";}}else{this.controlData.is_nc=true;}}else{this.controlData.is_nc=false;this.controlData.isNecessaryCheck="false";if(this.isDOM){this.selectboxElement_div.className="eF_Rect";}}this.setDisabled(this.controlData.disable,false);this.setVisible(this.controlData.visible,false);if(b){if(this.eform.multiView.isSocket){this.eform.multiView.socket.sendNecessaryCheck(this,a);}}};EFormSelectbox.prototype.getIndexOrderDisabled=function(){return this.controlData.indexOrderDisable;};EFormSelectbox.prototype.setIndexOrderDisabled=function(a){this.controlData.indexOrderDisable=a;};EFormSelectbox.prototype.getTitle=function(){return this.title;};EFormSelectbox.prototype.setTitle=function(a){this.title=a;if(this.isDOM){this.selectboxElement.title=a;}};EFormSelectbox.prototype.setOptionStyle=function(c){if(this.isDOM){var a=this.selectboxElement.childNodes;for(var b=0;b<a.length;b++){a[b].style.cssText=c;}}this.selectOpStyle=c;};EFormSelectbox.prototype.setOptionClassName=function(b){if(this.isDOM){var a=this.selectboxElement.childNodes;for(var c=0;c<a.length;c++){a[c].className="eForm_selectbox_option "+b;}}this.selectOpClass=b;};EFormSelectbox.prototype.setAutoNextFocus=function(a){this.controlData.isAutoNextFocus=a;};EFormSelectbox.prototype.onChangeEvent=function(a){this.event.changeEvent=a;this.event.eventTarget=this;};EFormSelectbox.prototype.onChange=function(){this.m_default_onChange();if(this.eform.multiView.isSocket){this.eform.multiView.socket.sendInputSelectbox(this,"change","");}};EFormSelectbox.prototype.m_default_onChange=function(){if(typeof getControlEventRulesCommand!="undefined"){if((this.eform.multiView.isSocket&&this.eform.isMain)||!this.eform.multiView.isSocket){var a={};a.uid=this.eform.m_uid;a.reportName=this.controlData.rName;a.inputID=this.controlData.id;a.type="selectbox";a.event="change";a.disabled=this.controlData.disable;a.visible=this.controlData.visible;a.value=this.controlData.value;a.label=this.controlData.label;a.isNecessaryCheck="true"==this.controlData.isNecessaryCheck;a.isNecessaryChecked=!this.controlData.is_nc;a.sectionName=this.controlData.sName?this.controlData.sName:"";getControlEventRulesCommand(a,false);}}if(null!=this.event.changeEvent){this.event.changeEvent(this);}if(null!=this.eform.ctrlEvent.selectboxChangeEvent){this.eform.ctrlEvent.selectboxChangeEvent(this);}};EFormSelectbox.prototype.setOptions=function(b){try{var d=JSON.parse(b);this.controlData.options=d;if(!this.eform.m_isPopupSelect){if(this.isDOM){this.selectboxElement.innerHTML="";for(var c=0;c<this.controlData.options.length;c++){var g=this.controlData.options[c];var a=document.createElement("option");a.style.cssText=this.selectOpStyle;a.className="eForm_selectbox_option "+this.selectOpClass;a.value=g.V;a.innerHTML=g.L;this.selectboxElement.appendChild(a);}}}this.changeSelect(this.controlData.value);}catch(f){ReportWebLog("selectbox의 setOptions 함수에 오류가 발생하였습니다."+f);}};EFormSelectbox.prototype.getPageNumber=function(){if(typeof this.controlData.pageNumber=="undefined"){return null;}return this.controlData.pageNumber+1;};EFormSelectbox.prototype.focus=function(){if(this.isDOM){var a=this.selectboxElement;setTimeout(function(){a.focus();},1);}else{if(!this.eform.isEasyInput){this.eform.m_isrulesControlInfo=this.ctrlID;this.eform.sendRulesControlInfo();this.eform.selectPage(this.controlData.pageNumber,"control_focus");}}};EFormSelectbox.prototype.focusControl=function(){this.eform.mRe_inputFocusRectBlur();this.selectboxElement_focusDiv.className="eF_Rect eform_control_focus";this.eform.inputImagePointerIn(this);if(this.eform.titleSpeechBubble.visible.selectbox){this.eform.inputCreateTitleSpeechBubble(this);}else{this.eform.inputRemoveTitleSpeechBubble();}if(this.eform.m_isHybridQuickControl||null!=this.controlData.inputOrder){this.eform.inputOrderFoucs(this);}else{this.eform.inputOrderBlur();}if(this.eform.m_isUsePopupInputFrame.select){this.callFrameSelectbox();}};EFormSelectbox.prototype.multiViewFocus=function(){if(null==mRe_FocusControl.objCtrl||mRe_FocusControl.objCtrl!=this){mRe_FocusControl.objCtrl=this;if(this.isDOM){if(this.eform.m_isMultiViewFoucs){this.selectboxElement.focus();}else{this.eform.mRe_inputFocusRectBlur();this.selectboxElement_focusDiv.className="eF_Rect eform_control_focus";this.eform.inputImagePointerIn(this);if(this.eform.titleSpeechBubble.visible.selectbox){this.eform.inputCreateTitleSpeechBubble(this);}else{this.eform.inputRemoveTitleSpeechBubble();}if(this.eform.m_isHybridQuickControl){this.eform.inputOrderFoucs(this);}}}}};EFormSelectbox.prototype.multiViewBlur=function(){mRe_FocusControl={objCtrl:null};if(this.isDOM){this.selectboxElement_focusDiv.className="eF_Rect";this.eform.inputImagePointerOut();}};EFormSelectbox.prototype.callHybridSelectbox=function(){this.eform.inputOrderFoucs(this);var d=this;var c=null;if(this.eform.multiView.isSocket){c=d.eform.multiView.socket;c.sendScreenLock("selectbox",d.eform.m_uid);}var b;try{b=window.top;}catch(f){console.error("최상위 window 객체에 접근할 수 없습니다:",f);b=window;}b.set_report_selectbox_data=function(k,j){if("next"==k){if(d.controlData.value!=j){d.setValue(j);d.onChange();}if(d.eform.multiView.isSocket){d.eform.multiView.socket.sendFocusControl(d,"out");}if(d.controlData.isAutoNextFocus){var i=d.eform.nextHybridInputControl(d);if(!i){d.eform.nextEasyInputControl(d);}}}else{if("cencel"==k){d.selectboxElement.blur();}else{if("ok"==k){if(d.controlData.value!=j){d.setValue(j);d.onChange();}if(d.eform.multiView.isSocket){d.eform.multiView.socket.sendFocusControl(d,"out");}d.selectboxElement.blur();}}}if(null!=c){c.sendScreenUnLock(d.eform.m_uid);}};var h=new Object();h.id=this.selectboxElement.id;h.title=this.getTitle();h.guideMsg="";h.isMirroring=!this.eform.getIsMain();h.selectedValue=this.controlData.value;h.options=this.controlData.options;if(is_appControl){if(this.eform.multiView.isSocket){var a=this.eform;c=this.eform.multiView.socket;window.setTimeout(function(){c.sendScreenLockStampButton(a.m_uid,null,4);},100);}ClipHybrid.callNativeControl("selectbox",JSON.stringify(h));}else{var g={methodName:"ShowSelectbox",data:null};g.data=h;window.external.ClipSubWebBrowserCtrl_Invoke(JSON.stringify(g));}if(this.eform.multiView.isSocket){this.eform.multiView.socket.sendFocusControl(this,"in");}};function EFormButton(){this.eform=null;this.ctrlID=null;this.controlData=null;this.group=null;this.isDOM=false;this.buttonElement=null;this.buttonElement_div=null;this.buttonElement_td=null;this.buttonElement_focusDiv=null;this.event={clickEvent:null,eventTarget:null};this.title=null;this.isSendClickEvent=true;this.bgColor=null;this.disabledClass="";}EFormButton.prototype.setGroup=function(a){this.group=a;};EFormButton.prototype.init=function(b,a,c){this.eform=c;this.ctrlID=b;this.controlData=a;this.controlData.necessaryMessage=a.necessaryMessage.replace(/\\\//g,"/").replace(/\\\\/g,"\\").replace(/\\\"/g,'"');this.controlData.value=a.value.replace(/\\\//g,"/").replace(/\\\\/g,"\\").replace(/\\\"/g,'"');this.controlData.label=a.label.replace(/\\\//g,"/").replace(/\\\\/g,"\\").replace(/\\\"/g,'"');if(null!=a.inputOrder){this.eform.eFormIndexControlList[a.inputOrder]=this;}if(null==a.indexOrderDisable){a.indexOrderDisable=false;}if(null==a.isToView){a.isToView=true;}if(null==a.isToEasyMode){a.isToEasyMode=true;}if(c.isEasyInput&&a.isToEasyMode){a.isToView=true;}if(!a.isToView){a.is_nc=false;}if(null==a.isAutoNextFocus){a.isAutoNextFocus=true;}if(null==a.repeatSync){a.repeatSync=false;}if(null==a.sName){a.sName="";}};EFormButton.prototype.deleteMe=function(){this.eform=null;this.ctrlID=null;this.controlData=null;this.event=null;this.group=null;this.deleteDOM();};EFormButton.prototype.resetDOM=function(){this.isDOM=false;this.buttonElement=null;this.buttonElement_div=null;this.buttonElement_td=null;this.buttonElement_focusDiv=null;};EFormButton.prototype.deleteDOM=function(){if(this.buttonElement){if(this.buttonElement.parentElement){this.buttonElement.parentElement.removeChild(this.buttonElement);}else{delete this.buttonElement;}}if(this.buttonElement_div){if(this.buttonElement_div.parentElement){this.buttonElement_div.parentElement.removeChild(this.buttonElement_div);}else{delete this.buttonElement_div;}}if(this.buttonElement_td){if(this.buttonElement_td.parentElement){this.buttonElement_td.parentElement.removeChild(this.buttonElement_td);}else{delete this.buttonElement_td;}}if(this.buttonElement_focusDiv){if(this.buttonElement_focusDiv.parentElement){this.buttonElement_focusDiv.parentElement.removeChild(this.buttonElement_focusDiv);}else{delete this.buttonElement_focusDiv;}}this.resetDOM();};EFormButton.prototype.getRect=function(){if(this.isDOM){var b={left:0,top:0,width:0,height:0};var d=this.buttonElement;var c=d.parentElement.offsetLeft;var a=d.parentElement.offsetTop;b.left=c+d.offsetLeft;b.top=a+d.offsetTop;b.width=d.offsetWidth;b.height=d.offsetHeight;return b;}return null;};EFormButton.prototype.getHE=function(){if(this.isDOM){return this.buttonElement;}return null;};EFormButton.prototype.eventHandlerButton=function(){if(!this.controlData.isToView){return;}if(typeof this.controlData.pageNumber=="undefined"){this.controlData.pageNumber=this.eform.beforePageIndex;}this.isDOM=true;this.buttonElement=document.getElementById(this.eform.m_uid+this.ctrlID);this.buttonElement_div=document.getElementById(this.eform.m_uid+this.ctrlID+"SPAN");this.buttonElement_td=document.getElementById(this.eform.m_uid+this.ctrlID+"TD");this.buttonElement_focusDiv=document.getElementById(this.eform.m_uid+this.ctrlID+"FOCUS");if(this.eform.m_RuleCtrlVisible){if(null!=this.buttonElement_div){var b=this.buttonElement_div.parentElement;if(null!=b){var g=document.createElement("div");g.style.position="absolute";g.style.left=b.style.left;g.style.top=b.style.top;g.style.width=b.style.width;g.style.height=b.style.height;g.style.color="red";g.style.fontSize="8pt";g.style.fontWeight="bold";var d=this.ctrlID;if(-1!=d.indexOf(".")){d=d.substring(d.indexOf(".")+1);}d=decodeURI(d.replace(/[r]/g,"%"));d=d.substring(0,d.lastIndexOf("_"));g.innerHTML=d+" ("+this.controlData.id+")";var i=b.parentElement;var a=b.nextSibling;if(null!=a){i.insertBefore(g,a);}else{i.appendChild(g);}}}}if(null==this.title){this.title=this.buttonElement.title;}else{this.buttonElement.title=this.title;}var h=this.controlData.label;if(""!=ClipStrTrim(this.controlData.value)){this.controlData.is_nc=false;}else{var c="";if(this.controlData.isNecessaryCheck=="true"){this.controlData.is_nc=true;c=" eForm_inputNecessary";}if(this.controlData.disable){this.buttonElement_div.className="eF_Rect eForm_inputDisabled "+this.disabledClass;}else{if(this.eform.eForm_isNecessary.check&&this.controlData.is_nc){this.buttonElement_div.className="eF_Rect eForm_NecessaryCheck";}else{this.buttonElement_div.className="eF_Rect eForm_inputDefault_bg"+c;}}}var f=this;if(null!=this.buttonElement_focusDiv&&null!=this.buttonElement){this.buttonElement.onblur=function(){var j=f.buttonElement_focusDiv;if(null!=j){j.className="eF_Rect";f.eform.inputImagePointerOut();}if(f.eform.multiView.isSocket){f.eform.multiView.socket.sendFocusControl(f,"out");}if(f.controlData.isAutoNextFocus){f.eform.nextHybridInputControl(f);}};this.buttonElement.onfocus=function(){f.focusControl();if(f.eform.multiView.isSocket){f.eform.multiView.socket.sendFocusControl(f,"in");}};}if(typeof this.buttonElement_td.innerText!=="undefined"){this.buttonElement_td.innerText=h.replace(/(\\r\\n)|(\\n)/g,String.fromCharCode(13));}else{this.buttonElement_td.innerHTML=h.replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/\n/g,"<br />\n");}this.buttonElement.onmousedown=function(j){var k=false;if("which" in j){k=j.which==3;}else{if("button" in j){k=j.button==2;}}if(k){j.preventDefault();return;}f.EFormButtonControl(true);};this.buttonElement.onkeyup=function(j){if(32==j.keyCode||13==j.keyCode){f.EFormButtonControl(true);}};this.m_setBGColor();this.setDisabled(this.controlData.disable,false);this.setVisible(this.controlData.visible,false);};EFormButton.prototype.EFormButtonControl=function(a){if(this.eform.m_isButtonLock==false){this.onClick(a);if(this.eform.multiView.isSocket&&this.isSendClickEvent){this.eform.multiView.socket.sendInputButton(this,"click",a);}}};EFormButton.prototype.getCtrlID=function(){return this.ctrlID;};EFormButton.prototype.getType=function(){return this.controlData.type;};EFormButton.prototype.getValue=function(){return this.controlData.value;};EFormButton.prototype.setValue=function(a){this.m_default_setValue(a);if(this.eform.multiView.isSocket){this.eform.multiView.socket.sendInputButton(this,"value");}};EFormButton.prototype.setAutoNextFocus=function(a){this.controlData.isAutoNextFocus=a;};EFormButton.prototype.m_default_setValue=function(f,d){if(this.controlData.value!=f){this.controlData.value=f;if(this.isDOM){var b=this.controlData.isNecessaryCheck=="true"?" eForm_inputNecessary":"";if(""!=ClipStrTrim(f)){this.controlData.is_nc=false;if(this.controlData.disable){this.buttonElement_div.className="eF_Rect eForm_inputDisabled "+this.disabledClass;}else{if(this.eform.eForm_isNecessary.check){this.buttonElement_div.className="eF_Rect eForm_inputDefault_bg"+b;}}}else{if("true"==this.controlData.isNecessaryCheck){this.controlData.is_nc=true;if(this.controlData.disable){this.buttonElement_div.className="eF_Rect eForm_inputDisabled "+this.disabledClass;}else{if(this.eform.eForm_isNecessary.check){this.buttonElement_div.className="eF_Rect eForm_NecessaryCheck";}else{this.buttonElement_div.className="eF_Rect eForm_inputDefault_bg"+b;}}}}}else{if(""!=ClipStrTrim(f)){this.controlData.is_nc=false;}else{if("true"==this.controlData.isNecessaryCheck){this.controlData.is_nc=true;}}}if(this.controlData.repeatSync){if(typeof d=="undefined"){d=true;}if(d){var a=eform.findCloneControl(this);for(var c=0;c<a.length;c++){a[c].m_default_setValue(f,false);}}}}};EFormButton.prototype.getLabel=function(){return this.controlData.label;};EFormButton.prototype.setLabel=function(a){this.m_default_setLabel(a);if(this.eform.multiView.isSocket){this.eform.multiView.socket.sendInputButton(this,"label");}};EFormButton.prototype.m_default_setLabel=function(d,c){if(this.controlData.label!=d){if(this.isDOM){if(typeof this.buttonElement_td.innerText!=="undefined"){this.buttonElement_td.innerText=d.replace(/(\\r\\n)|(\\n)/g,String.fromCharCode(13));}else{this.buttonElement_td.innerHTML=d.replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/\n/g,"<br />\n");}}this.controlData.label=d;if(this.controlData.repeatSync){if(typeof c=="undefined"){c=true;}if(c){var a=eform.findCloneControl(this);for(var b=0;b<a.length;b++){a[b].m_default_setLabel(d,false);}}}}};EFormButton.prototype.getVisible=function(){return this.controlData.visible;};EFormButton.prototype.setVisible=function(a,b){if(typeof b=="undefined"){b=false;}this.controlData.visible=a;if(this.isDOM){if(a){this.buttonElement.style.display="";this.buttonElement_div.style.display="";this.buttonElement_td.style.display="";this.buttonElement_focusDiv.style.display="";}else{this.buttonElement.style.display="none";this.buttonElement_div.style.display="none";this.buttonElement_td.style.display="none";this.buttonElement_focusDiv.style.display="none";}}if(b){if(this.eform.multiView.isSocket){this.eform.multiView.socket.sendVisibled(this,a);}}};EFormButton.prototype.setDisabledClass=function(a){this.disabledClass=a;if(this.isDOM){this.setDisabled(this.controlData.disable,false);}};EFormButton.prototype.getDisabled=function(){return this.controlData.disable;};EFormButton.prototype.setDisabled=function(g,h,f){if(typeof h=="undefined"){h=false;}if(typeof f=="undefined"){f=true;}this.controlData.disable=g;var c=g;if(this.isDOM){var d=this.eform.isEasyInput?0:this.controlData.pageNumber;var a=this.eform.m_eformPageDisabled[d];if(null==a){a=false;}if(g||a||this.eform.m_eformDisabled){c=true;this.buttonElement.disabled=true;this.buttonElement_div.className="eF_Rect eForm_inputDisabled "+this.disabledClass;this.buttonElement.style.cursor="auto";}else{var b=this.controlData.isNecessaryCheck=="true"?" eForm_inputNecessary":"";c=false;this.buttonElement.disabled=false;this.buttonElement.style.cursor="pointer";if(this.eform.eForm_isNecessary.check&&this.controlData.isNecessaryCheck=="true"&&this.controlData.is_nc){this.buttonElement_div.className="eF_Rect eForm_NecessaryCheck";}else{this.buttonElement_div.className="eF_Rect eForm_inputDefault_bg"+b;}}}if(h){if(this.eform.multiView.isSocket){this.eform.multiView.socket.sendDisabled(this,g);}}if(null!=this.eform.ctrlEvent.disabledEvent&&f){this.eform.ctrlEvent.disabledEvent(c,this);}};EFormButton.prototype.setGuideBGColor=function(b,a,d,c,f){if(typeof f=="undefined"){f=true;}this.controlData.bgColor="rgba("+b+","+a+","+d+","+c+")";if(this.isDOM){this.buttonElement_div.style.backgroundColor=this.controlData.bgColor;}if(this.eform.multiView.isSocket&&f){this.eform.multiView.socket.sendControlColor(this,b,a,d,c);}};EFormButton.prototype.m_setBGColor=function(){if(null!=this.controlData.bgColor){if(this.isDOM){this.buttonElement_div.style.backgroundColor=this.controlData.bgColor;}}};EFormButton.prototype.setNecessaryCheck=function(a,b){if(typeof b=="undefined"){b=false;}if(a){this.controlData.isNecessaryCheck="true";if(""!=this.controlData.value){this.controlData.is_nc=false;if(this.isDOM){this.buttonElement_div.className="eF_Rect";}}else{this.controlData.is_nc=true;}}else{this.controlData.is_nc=false;this.controlData.isNecessaryCheck="false";if(this.isDOM){this.buttonElement_div.className="eF_Rect";}}this.setDisabled(this.controlData.disable,false);this.setVisible(this.controlData.visible,false);if(b){if(this.eform.multiView.isSocket){this.eform.multiView.socket.sendNecessaryCheck(this,a);}}};EFormButton.prototype.getIndexOrderDisabled=function(){return this.controlData.indexOrderDisable;};EFormButton.prototype.setIndexOrderDisabled=function(a){this.controlData.indexOrderDisable=a;};EFormButton.prototype.getTitle=function(){return this.title;};EFormButton.prototype.setTitle=function(a){this.title=a;if(this.isDOM){this.buttonElement.title=a;}};EFormButton.prototype.onClickEvent=function(a){this.event.clickEvent=a;this.event.eventTarget=this;};EFormButton.prototype.onClick=function(b){if(null!=this.event.clickEvent&&b){this.event.clickEvent(this);}if(null!=this.eform.ctrlEvent.buttonClickEvent&&b){this.eform.ctrlEvent.buttonClickEvent(this);}if(null!=this.controlData.usePopupSubsection&&this.controlData.usePopupSubsection){this.eform.mRe_popupSubsection(this.controlData.popupSubsectionName);}if(typeof getControlEventRulesCommand!="undefined"&&b){if((this.eform.multiView.isSocket&&this.eform.isMain)||!this.eform.multiView.isSocket){var a={};a.uid=this.eform.m_uid;a.reportName=this.controlData.rName;a.inputID=this.controlData.id;a.type="button";a.event="click";a.disabled=this.controlData.disable;a.visible=this.controlData.visible;a.value=this.controlData.value;a.label=this.controlData.label;a.isNecessaryCheck="true"==this.controlData.isNecessaryCheck;a.isNecessaryChecked=!this.controlData.is_nc;a.sectionName=this.controlData.sName?this.controlData.sName:"";getControlEventRulesCommand(a,false);}}};EFormButton.prototype.click=function(a){if(typeof a=="undefined"){a=true;}this.buttonElement.focus();this.EFormButtonControl(a);};EFormButton.prototype.setMirroringClickEvent=function(a){this.isSendClickEvent=a;};EFormButton.prototype.getPageNumber=function(){if(typeof this.controlData.pageNumber=="undefined"){return null;}return this.controlData.pageNumber+1;};EFormButton.prototype.focus=function(){if(this.isDOM){var a=this.buttonElement;setTimeout(function(){a.focus();},1);}else{if(!this.eform.isEasyInput){this.eform.m_isrulesControlInfo=this.ctrlID;this.eform.sendRulesControlInfo();this.eform.selectPage(this.controlData.pageNumber,"control_focus");}}};EFormButton.prototype.focusControl=function(){this.eform.mRe_inputFocusRectBlur();this.buttonElement_focusDiv.className="eF_Rect eform_control_focus";this.eform.inputImagePointerIn(this);if(this.eform.titleSpeechBubble.visible.button){this.eform.inputCreateTitleSpeechBubble(this);}else{this.eform.inputRemoveTitleSpeechBubble();}if(this.eform.m_isHybridQuickControl||null!=this.controlData.inputOrder){this.eform.inputOrderFoucs(this);}else{this.eform.inputOrderBlur();}};EFormButton.prototype.multiViewFocus=function(){if(null==mRe_FocusControl.objCtrl||mRe_FocusControl.objCtrl!=this){mRe_FocusControl.objCtrl=this;if(this.isDOM){if(this.eform.m_isMultiViewFoucs){this.buttonElement.focus();}else{this.eform.mRe_inputFocusRectBlur();this.buttonElement_focusDiv.className="eF_Rect eform_control_focus";this.eform.inputImagePointerIn(this);if(this.eform.titleSpeechBubble.visible.button){this.eform.inputCreateTitleSpeechBubble(this);}else{this.eform.inputRemoveTitleSpeechBubble();}if(this.eform.m_isHybridQuickControl){this.eform.inputOrderFoucs(this);}}}}};EFormButton.prototype.multiViewBlur=function(){mRe_FocusControl={objCtrl:null};if(this.isDOM){this.buttonElement_focusDiv.className="eF_Rect";this.eform.inputImagePointerOut();}};function EFormVideo(){this.eform=null;this.ctrlID=null;this.controlData=null;this.group=null;this.isDOM=false;this.videoElement=null;this.videoElement_div=null;this.videoElement_focusDiv=null;this.event={playEvent:null,pauseEvent:null,errorEvent:null,eventTarget:null};this.title=null;this.bgColor=null;this.disabledClass="";}EFormVideo.prototype.setGroup=function(a){this.group=a;};EFormVideo.prototype.init=function(b,a,c){this.eform=c;this.ctrlID=b;this.controlData=a;this.controlData.necessaryMessage=a.necessaryMessage.replace(/\\\//g,"/").replace(/\\\\/g,"\\").replace(/\\\"/g,'"');this.controlData.value=a.value.replace(/\\\//g,"/").replace(/\\\\/g,"\\").replace(/\\\"/g,'"');if(null!=a.inputOrder){this.eform.eFormIndexControlList[a.inputOrder]=this;}if(null==a.indexOrderDisable){a.indexOrderDisable=false;}if(null==a.isToView){a.isToView=true;}if(null==a.isToEasyMode){a.isToEasyMode=true;}if(c.isEasyInput&&a.isToEasyMode){a.isToView=true;}if(!a.isToView){a.is_nc=false;}if(null==a.isAutoNextFocus){a.isAutoNextFocus=true;}if(null==a.repeatSync){a.repeatSync=false;}if(null==a.sName){a.sName="";}};EFormVideo.prototype.deleteMe=function(){this.eform=null;this.ctrlID=null;this.controlData=null;this.event=null;this.group=null;this.deleteDOM();};EFormVideo.prototype.resetDOM=function(){this.isDOM=false;this.videoElement=null;this.videoElement_div=null;this.videoElement_focusDiv=null;};EFormVideo.prototype.deleteDOM=function(){if(this.videoElement){if(this.videoElement.parentElement){this.videoElement.parentElement.removeChild(this.videoElement);}else{delete this.videoElement;}}if(this.videoElement_div){if(this.videoElement_div.parentElement){this.videoElement_div.parentElement.removeChild(this.videoElement_div);}else{delete this.videoElement_div;}}if(this.videoElement_focusDiv){if(this.videoElement_focusDiv.parentElement){this.videoElement_focusDiv.parentElement.removeChild(this.videoElement_focusDiv);}else{delete this.videoElement_focusDiv;}}this.resetDOM();};EFormVideo.prototype.getRect=function(){if(this.isDOM){var b={left:0,top:0,width:0,height:0};var d=this.videoElement;var c=d.parentElement.offsetLeft;var a=d.parentElement.offsetTop;b.left=c+d.offsetLeft;b.top=a+d.offsetTop;b.width=d.offsetWidth;b.height=d.offsetHeight;return b;}return null;};EFormVideo.prototype.getHE=function(){if(this.isDOM){return this.videoElement;}return null;};EFormVideo.prototype.eventHandlerVideo=function(){if(!this.controlData.isToView){return;}if(typeof this.controlData.pageNumber=="undefined"){this.controlData.pageNumber=this.eform.beforePageIndex;}this.isDOM=true;this.videoElement=document.getElementById(this.eform.m_uid+this.ctrlID);this.videoElement_div=document.getElementById(this.eform.m_uid+this.ctrlID+"SPAN");this.videoElement_focusDiv=document.getElementById(this.eform.m_uid+this.ctrlID+"FOCUS");if(this.eform.m_RuleCtrlVisible){if(null!=this.videoElement_div){var b=this.videoElement_div.parentElement;if(null!=b){var d=document.createElement("div");d.style.position="absolute";d.style.left=b.style.left;d.style.top=b.style.top;d.style.width=b.style.width;d.style.height=b.style.height;d.style.color="red";d.style.fontSize="8pt";d.style.fontWeight="bold";var c=this.ctrlID;if(-1!=c.indexOf(".")){c=c.substring(c.indexOf(".")+1);}c=decodeURI(c.replace(/[r]/g,"%"));c=c.substring(0,c.lastIndexOf("_"));d.innerHTML=c+" ("+this.controlData.id+")";var g=b.parentElement;var a=b.nextSibling;if(null!=a){g.insertBefore(d,a);}else{g.appendChild(d);}}}}if(null==this.title){this.title=this.videoElement.title;}else{this.videoElement.title=this.title;}this.controlData.is_nc=false;if(""!=ClipStrTrim(this.controlData.value)){this.videoElement.src=this.controlData.value;this.videoElement.load();}var f=this;this.videoElement.onmousedown=function(h){var i=false;if("which" in h){i=h.which==3;}else{if("button" in h){i=h.button==2;}}if(i){h.stopPropagation();h.preventDefault();return;}};this.videoElement.onplay=function(){f.onPlay();};this.videoElement.onpause=function(){f.onPause();};this.videoElement.onerror=function(){f.onError(this.error);};this.videoElement.addEventListener("timeupdate",function(){if(this.paused){f.sendCurrentTime();}});if(null!=this.videoElement_focusDiv&&null!=this.videoElement){this.videoElement.onblur=function(){var h=f.videoElement_focusDiv;if(null!=h){h.className="eF_Rect";f.eform.inputImagePointerOut();}if(f.eform.multiView.isSocket){f.eform.multiView.socket.sendFocusControl(f,"out");}if(f.controlData.isAutoNextFocus){f.eform.nextHybridInputControl(EFormButton);}};this.videoElement.onfocus=function(){f.focusControl();if(f.eform.multiView.isSocket){f.eform.multiView.socket.sendFocusControl(f,"in");}};}this.m_setBGColor();this.setDisabled(this.controlData.disable,false);this.setVisible(this.controlData.visible,false);};EFormVideo.prototype.getCtrlID=function(){return this.ctrlID;};EFormVideo.prototype.getType=function(){return this.controlData.type;};EFormVideo.prototype.getValue=function(){return this.controlData.value;};EFormVideo.prototype.setValue=function(a){this.m_default_setValue(a);if(this.eform.multiView.isSocket){this.eform.multiView.socket.sendInputButton(this,"value");}};EFormVideo.prototype.setAutoNextFocus=function(a){this.controlData.isAutoNextFocus=a;};EFormVideo.prototype.m_default_setValue=function(d,c){if(this.controlData.value!=d){this.controlData.value=d;if(this.isDOM){this.videoElement.src=this.controlData.value;this.videoElement.load();}if(this.controlData.repeatSync){if(typeof c=="undefined"){c=true;}if(c){var a=eform.findCloneControl(this);for(var b=0;b<a.length;b++){a[b].m_default_setValue(d,false);}}}}};EFormVideo.prototype.getVisible=function(){return this.controlData.visible;};EFormVideo.prototype.setVisible=function(a,b){if(typeof b=="undefined"){b=false;}this.controlData.visible=a;if(this.isDOM){if(a){this.videoElement.style.display="";this.videoElement_div.style.display="";this.videoElement_focusDiv.style.display="";}else{this.videoElement.style.display="none";this.videoElement_div.style.display="none";this.videoElement_focusDiv.style.display="none";}}if(b){if(this.eform.multiView.isSocket){this.eform.multiView.socket.sendVisibled(this,a);}}};EFormVideo.prototype.setDisabledClass=function(a){this.disabledClass=a;if(this.isDOM){this.setDisabled(this.controlData.disable,false);}};EFormVideo.prototype.getDisabled=function(){return this.controlData.disable;};EFormVideo.prototype.setDisabled=function(g,h,f){if(typeof h=="undefined"){h=false;}if(typeof f=="undefined"){f=true;}this.controlData.disable=g;var c=g;if(this.isDOM){var d=this.eform.isEasyInput?0:this.controlData.pageNumber;var a=this.eform.m_eformPageDisabled[d];if(null==a){a=false;}if(g||a||this.eform.m_eformDisabled){c=true;this.videoElement.disabled=true;this.videoElement_div.className="eF_Rect eForm_inputDisabled "+this.disabledClass;this.videoElement.style.cursor="auto";}else{c=false;this.videoElement.disabled=false;this.videoElement.style.cursor="pointer";if(this.eform.eForm_isNecessary.check&&this.controlData.isNecessaryCheck=="true"&&this.controlData.is_nc){this.videoElement_div.className="eF_Rect eForm_NecessaryCheck";}else{var b=this.controlData.isNecessaryCheck=="true"?" eForm_inputNecessary":"";this.videoElement_div.className="eF_Rect eForm_inputDefault_bg"+b;}}}if(h){if(this.eform.multiView.isSocket){this.eform.multiView.socket.sendDisabled(this,g);}}if(null!=this.eform.ctrlEvent.disabledEvent&&f){this.eform.ctrlEvent.disabledEvent(c,this);}};EFormVideo.prototype.setGuideBGColor=function(b,a,d,c,f){if(typeof f=="undefined"){f=true;}this.controlData.bgColor="rgba("+b+","+a+","+d+","+c+")";if(this.isDOM){this.videoElement_div.style.backgroundColor=this.controlData.bgColor;}if(this.eform.multiView.isSocket&&f){this.eform.multiView.socket.sendControlColor(this,b,a,d,c);}};EFormVideo.prototype.m_setBGColor=function(){if(null!=this.controlData.bgColor){if(this.isDOM){this.videoElement_div.style.backgroundColor=this.controlData.bgColor;}}};EFormVideo.prototype.getIndexOrderDisabled=function(){return this.controlData.indexOrderDisable;};EFormVideo.prototype.setIndexOrderDisabled=function(a){this.controlData.indexOrderDisable=a;};EFormVideo.prototype.getTitle=function(){return this.title;};EFormVideo.prototype.setTitle=function(a){this.title=a;if(this.isDOM){this.videoElement.title=a;}};EFormVideo.prototype.onPlayEvent=function(a){this.event.playEvent=a;this.event.eventTarget=this;};EFormVideo.prototype.onPlay=function(){if(this.eform.multiView.isSocket){this.eform.multiView.socket.sendInputVideo(this,"play");}if(null!=this.event.playEvent){this.event.playEvent(this);}};EFormVideo.prototype.play=function(){if(this.isDOM){if(this.videoElement.paused){this.videoElement.focus();this.videoElement.play();}}};EFormVideo.prototype.onPauseEvent=function(a){this.event.pauseEvent=a;this.event.eventTarget=this;};EFormVideo.prototype.onPause=function(){if(this.eform.multiView.isSocket){this.eform.multiView.socket.sendInputVideo(this,"pause");}if(null!=this.event.pauseEvent){this.event.pauseEvent(this);}};EFormVideo.prototype.pause=function(){if(this.isDOM){if(!this.videoElement.paused){this.videoElement.pause();}}};EFormVideo.prototype.sendCurrentTime=function(){if(this.isDOM){if(this.currentTime!=this.videoElement.currentTime){this.currentTime=this.videoElement.currentTime;if(this.eform.multiView.isSocket&&this.eform.multiView.socket.isMain){this.eform.multiView.socket.sendInputVideo(this,"time",this.currentTime);}}}};EFormVideo.prototype.setCurrentTime=function(a){if(this.isDOM){this.videoElement.currentTime=a;}};EFormVideo.prototype.onErrorEvent=function(a){this.event.errorEvent=a;this.event.eventTarget=this;};EFormVideo.prototype.onError=function(a){if(null!=this.event.errorEvent){this.event.errorEvent(this,a);}};EFormVideo.prototype.getPageNumber=function(){if(typeof this.controlData.pageNumber=="undefined"){return null;}return this.controlData.pageNumber+1;};EFormVideo.prototype.focus=function(){if(this.isDOM){var a=this.videoElement;setTimeout(function(){a.focus();},1);}else{if(!this.eform.isEasyInput){this.eform.m_isrulesControlInfo=this.ctrlID;this.eform.sendRulesControlInfo();this.eform.selectPage(this.controlData.pageNumber,"control_focus");}}};EFormVideo.prototype.focusControl=function(){this.eform.mRe_inputFocusRectBlur();this.videoElement_focusDiv.className="eF_Rect eform_control_focus";this.eform.inputImagePointerIn(this);this.eform.inputCreateTitleSpeechBubble(this);if(this.eform.m_isHybridQuickControl||null!=this.controlData.inputOrder){this.eform.inputOrderFoucs(this);}else{this.eform.inputOrderBlur();}};EFormVideo.prototype.multiViewFocus=function(){if(null==mRe_FocusControl.objCtrl||mRe_FocusControl.objCtrl!=this){mRe_FocusControl.objCtrl=this;if(this.isDOM){if(this.eform.m_isMultiViewFoucs){this.videoElement.focus();}else{this.eform.mRe_inputFocusRectBlur();this.videoElement_focusDiv.className="eF_Rect eform_control_focus";this.eform.inputImagePointerIn(this);this.eform.inputCreateTitleSpeechBubble(this);if(this.eform.m_isHybridQuickControl){this.eform.inputOrderFoucs(this);}}}}};EFormVideo.prototype.multiViewBlur=function(){mRe_FocusControl={objCtrl:null};if(this.isDOM){this.videoElement_focusDiv.className="eF_Rect";this.eform.inputImagePointerOut();}};Report.prototype.changePalletColor=function(b){var d=b.firstChild.style.backgroundColor;var c=this.eFormDoodleOption.tempPens;if(null!=c.penList){for(var f=0;f<c.penList.length;f++){var a=c.penList[f];a.firstChild.style.backgroundColor=d;if(null!=a.style.border&&""!=a.style.border){a.style.border="2px solid "+d;}}}if(null!=c.opList){for(var f=0;f<c.opList.length;f++){var a=c.opList[f];a.firstChild.style.backgroundColor=d;if(null!=a.style.border&&""!=a.style.border){a.style.border="2px solid "+d;}}}if(null!=c.colorList){for(var f=0;f<c.colorList.length;f++){c.colorList[f].style.border="";}}b.style.border="2px solid "+d;c.color=d;};Report.prototype.changePalletWidth=function(a){var c=this.eFormDoodleOption.tempPens;var b=c.color;if(null!=c.penList){for(var d=0;d<c.penList.length;d++){c.penList[d].style.border="";}a.style.border="2px solid "+b;}c.width=a.firstChild.offsetWidth;};Report.prototype.changePalletOP=function(a){var c=this.eFormDoodleOption.tempPens;var b=c.color;if(null!=c.opList){for(var d=0;d<c.opList.length;d++){c.opList[d].style.border="";}a.style.border="2px solid "+b;}c.op=Number(a.firstChild.style.opacity);};Report.prototype.createPalletPenWidthLayout=function(l,h){var c=this;var a=document.createElement("div");a.style.cssText="position:relative;width:250px;height:50px";var g=document.createElement("div");g.style.cssText="position:relative;width:250px;height:30px";for(var j=0;j<5;j++){var d=getPalletPenWidth(j);var f=document.createElement("span");f.className="eform_pallet_outE";f.style.left=(j*50)+"px";var k=document.createElement("span");k.className="eform_pallet_inE";if(h.width==d){k.style.border="2px solid "+h.color;}var i=document.createElement("span");i.style.cssText="position:absolute;left:"+((40-d)/2)+"px;top:"+((40-d)/2)+"px;width:"+d+"px;height:"+d+"px;border-radius:100%;";i.style.backgroundColor=h.color;h.penList[j]=k;k.onclick=function(){c.changePalletWidth(this);};k.appendChild(i);f.appendChild(k);var b=document.createElement("span");b.className="eform_pallet_outText";b.style.left=(j*50)+"px";b.innerHTML=d>10?(""+d):("0"+d);a.appendChild(f);g.appendChild(b);}l.appendChild(a);l.appendChild(g);};Report.prototype.createPalletOPLayout=function(h,d){var b=this;var k=document.createElement("div");k.style.cssText="position:relative;width:250px;height:50px";var g=document.createElement("div");g.style.cssText="position:relative;width:250px;height:30px";for(var i=0;i<5;i++){var j=getPalletOpacity(i);var c=document.createElement("span");c.className="eform_pallet_outE";c.style.left=(i*50)+"px";var l=document.createElement("span");l.className="eform_pallet_inE";if(d.op==j){l.style.border="2px solid "+d.color;}var f=document.createElement("span");f.style.cssText="position:absolute;left:12px;top:12px;width:16px;height:16px;border-radius:100%;";f.style.backgroundColor=d.color;f.style.opacity=j;d.opList[i]=l;l.onclick=function(){b.changePalletOP(this);};l.appendChild(f);c.appendChild(l);var a=document.createElement("span");a.className="eform_pallet_outText";a.style.left=(i*50)+"px";a.innerHTML=(j*100)+"%";k.appendChild(c);g.appendChild(a);}h.appendChild(k);h.appendChild(g);};Report.prototype.createPalletColorLayout=function(h,i,m){var f=this;var n=document.createElement("div");var d=document.createElement("div");if(m=="height"){n.style.cssText="position:relative;width:250px;height:50px";d.style.cssText="position:relative;width:250px;height:50px";}else{n.style.cssText="position:absolute;width:250px;height:50px";d.style.cssText="position:absolute;left:250px;width:250px;height:50px";}var o=document.createElement("div");for(var k=0;k<5;k++){var c=getPalletColor(k);var g=document.createElement("span");g.className="eform_pallet_outE";g.style.top="0px";g.style.left=(k*50)+"px";var q=document.createElement("span");q.className="eform_pallet_inE";o.style.backgroundColor=c;if(i.color==o.style.backgroundColor){q.style.border="2px solid "+i.color;}var j=document.createElement("span");j.className="eform_pallet_Circle";j.style.backgroundColor=c;i.colorList[k]=q;q.onclick=function(){f.changePalletColor(this);};q.appendChild(j);g.appendChild(q);var l=k+5;c=getPalletColor(l);var b=document.createElement("span");b.className="eform_pallet_outE";b.style.top="0px";b.style.left=(k*50)+"px";var p=document.createElement("span");p.className="eform_pallet_inE";o.style.backgroundColor=c;if(i.color==o.style.backgroundColor){p.style.border="2px solid "+i.color;}var a=document.createElement("span");a.className="eform_pallet_Circle";a.style.backgroundColor=c;i.colorList[l]=p;p.onclick=function(){f.changePalletColor(this);};p.appendChild(a);b.appendChild(p);n.appendChild(g);d.appendChild(b);}h.appendChild(n);h.appendChild(d);};Report.prototype.palletDoodleWidth=function(b){var c=this;var g=this.eFormDoodleOption.tempPens;g.penList=[];g.opList=[];g.colorList=[];var j=document.createElement("div");j.className="eform_pallet_width";var d=document.createElement("div");d.className="eform_pallet_line";d.style.cssText="width:480px;top:53px";j.appendChild(d);d=document.createElement("div");d.className="eform_pallet_line";d.style.cssText="left:249px;top:65px;height:60px;width:0px;";j.appendChild(d);var l=document.createElement("div");l.style.cssText="position:absolute;left:0px;top:50px;width:250px;height:80px";this.createPalletPenWidthLayout(l,g);j.appendChild(l);var f=document.createElement("div");f.style.cssText="position:absolute;top:0px;width:500px;height:50px";this.createPalletColorLayout(f,g,"width");j.appendChild(f);var h=document.createElement("div");h.style.cssText="position:absolute;left:250px;top:50px;width:250px;height:80px";this.createPalletOPLayout(h,g);j.appendChild(h);var k=document.createElement("div");k.style.cssText="position:absolute;top:130px;width:500px;height:60px";var i=document.createElement("button");i.className="eform_pallet_button eform_pallet_button_ok";i.style.left="170px";i.innerHTML=this.m_languageMap.ok;i.onclick=function(){var m=c.eFormDoodleOption;m.pens.width=m.tempPens.width;m.pens.color=m.tempPens.color;m.pens.op=m.tempPens.op;m.tempPens.penList=[];m.tempPens.opList=[];m.tempPens.colorList=[];c.removePalletDoodle();c.penDoodle();if(null!=m.okButtonEvent){m.okButtonEvent();}};var a=document.createElement("button");a.className="eform_pallet_button eform_pallet_button_cancel";a.style.left="180px";a.innerHTML=this.m_languageMap.cancel;a.onclick=function(){c.removePalletDoodle();var m=c.eFormDoodleOption;if(null!=m.cancelButtonEvent){m.cancelButtonEvent();}};k.appendChild(i);k.appendChild(a);j.appendChild(k);b.appendChild(j);};Report.prototype.palletDoodleHeight=function(b){var c=this;var d=this.eFormDoodleOption;var h=d.tempPens;h.penList=[];h.opList=[];h.colorList=[];h.width=d.pens.width;h.color=d.pens.color;h.op=d.pens.op;var k=document.createElement("div");k.className="eform_pallet";var f=document.createElement("div");f.className="eform_pallet_line";f.style.top="80px";k.appendChild(f);f=f.cloneNode(true);f.style.top="180px";k.appendChild(f);f=f.cloneNode(true);f.style.top="260px";k.appendChild(f);var m=document.createElement("div");m.style.cssText="position:relative;width:250px;height:80px";this.createPalletPenWidthLayout(m,h);k.appendChild(m);var g=document.createElement("div");g.style.cssText="position:relative;width:250px;height:100px";this.createPalletColorLayout(g,h,"height");k.appendChild(g);var i=document.createElement("div");i.style.cssText="position:relative;width:250px;height:80px";this.createPalletOPLayout(i,h);k.appendChild(i);var l=document.createElement("div");l.style.cssText="position:relative;width:250px;height:60px";var j=document.createElement("button");j.className="eform_pallet_button eform_pallet_button_ok";j.innerHTML=this.m_languageMap.ok;j.onclick=function(){var n=c.eFormDoodleOption;n.pens.width=n.tempPens.width;n.pens.color=n.tempPens.color;n.pens.op=n.tempPens.op;n.tempPens.penList=[];n.tempPens.opList=[];n.tempPens.colorList=[];c.removePalletDoodle();c.penDoodle();if(null!=n.okButtonEvent){n.okButtonEvent();}};var a=document.createElement("button");a.className="eform_pallet_button eform_pallet_button_cancel";a.innerHTML=this.m_languageMap.cancel;a.onclick=function(){c.removePalletDoodle();var n=c.eFormDoodleOption;if(null!=n.cancelButtonEvent){n.cancelButtonEvent();}};l.appendChild(j);l.appendChild(a);k.appendChild(l);b.appendChild(k);};Report.prototype.mRe_DoodleSavePopup=function(i){this.m_doodleSaveOp={layOutElm:null,selectElm:null,keyList:null,closeButton:null};var d=this;var h=document.createElement("div");h.style.cssText="position:absolute;left:0px;right:0px;top:0px;bottom:0px;background-color:rgba(0,0,0,0);z-index:500;";this.targetDiv.appendChild(h);this.m_doodleSaveOp.layOutElm=h;var j=document.createElement("div");j.className="eform_doodle_save_div";h.appendChild(j);var g=document.createElement("select");g.className="eform_doodle_save_selectbox";j.appendChild(g);this.m_doodleSaveOp.selectElm=g;var l=document.createElement("button");l.className="report_view_button eform_doodle_save_loadButton";l.title=this.m_languageMap.load;l.innerHTML=this.m_languageMap.load;l.disabled=true;j.appendChild(l);l.onclick=function(){d.mRe_DoodleSavePopupLoadButton();};var k=document.createElement("button");k.className="report_view_button eform_doodle_save_deleteButton";k.title=this.m_languageMap.del;k.innerHTML=this.m_languageMap.del;k.disabled=true;j.appendChild(k);k.onclick=function(){d.mRe_DoodleSavePopupDeleteButton();};var b=document.createElement("input");b.className="eform_doodle_save_inputbox";j.appendChild(b);var f=document.createElement("button");f.className="report_view_button eform_doodle_save_saveButton";f.title=this.m_languageMap.save;f.innerHTML=this.m_languageMap.save;f.disabled=true;j.appendChild(f);f.onclick=function(){d.mRe_DoodleSavePopupSaveButton(b);};var a=document.createElement("button");a.className="report_view_button eform_doodle_save_closeButton";a.title=this.m_languageMap.close;a.innerHTML=this.m_languageMap.close;a.disabled=true;j.appendChild(a);a.onclick=function(){d.mRe_DoodleSavePopupClose();i.focus();};this.m_doodleSaveOp.closeButton=a;g.focus();var c=openIndexedDB();c.onsuccess=function(){var n=getStoreIndexedDB(c,"DoodlePenListStore");var m=n.store.get("keyList");m.onsuccess=function(){var q=d.m_doodleSaveOp.keyList=m.result.data;for(var o=0;o<q.length;o++){var p=document.createElement("option");p.value=q[o];p.innerHTML=q[o];d.m_doodleSaveOp.selectElm.appendChild(p);}l.disabled=false;k.disabled=false;f.disabled=false;a.disabled=false;};m.onerror=function(){a.disabled=false;};n.tx.oncomplete=function(){n.result.close();};};c.onerror=function(){a.disabled=false;};};Report.prototype.mRe_DoodleSavePopupClose=function(){this.targetDiv.removeChild(this.m_doodleSaveOp.layOutElm);this.m_doodleSaveOp=null;};Report.prototype.mRe_DoodleSavePopupSaveButton=function(d){var f=this;var b=d.value;if(""==b.trim()){d.focus();return;}var h=this.m_doodleSaveOp.keyList;var g=false;for(var c=0;c<h.length;c++){if(b==h[c]){g=true;var a=confirm("같은 이름의 저장이 있습니다. 기존에 데이터가 삭제됩니다");if(!a){d.focus();return;}break;}}this.EF_DoodlePageSave();var j=openIndexedDB();j.onsuccess=function(){var i=getStoreIndexedDB(j,"DoodlePenStore");i.store.put({id:b,data:f.eFormDoodleOption.pagePathSave});if(!g){h.push(b);var k=getStoreIndexedDB(j,"DoodlePenListStore");k.store.put({id:"keyList",data:h});k.tx.oncomplete=function(){k.result.close();};}i.tx.oncomplete=function(){i.result.close();};};this.m_doodleSaveOp.closeButton.click();};Report.prototype.mRe_DoodleSavePopupDeleteButton=function(){var d=this.m_doodleSaveOp.selectElm.value;var a=this.m_doodleSaveOp.selectElm.selectedIndex;var f=eform.m_doodleSaveOp.keyList;f.splice(a,1);this.m_doodleSaveOp.selectElm.innerHTML="";for(var b=0;b<f.length;b++){var c=document.createElement("option");c.value=f[b];c.innerHTML=f[b];eform.m_doodleSaveOp.selectElm.appendChild(c);}var g=openIndexedDB();g.onsuccess=function(){var h=getStoreIndexedDB(g,"DoodlePenStore");h.store["delete"](d);h.tx.oncomplete=function(){h.result.close();};var i=getStoreIndexedDB(g,"DoodlePenListStore");i.store.put({id:"keyList",data:f});i.tx.oncomplete=function(){i.result.close();};};};Report.prototype.mRe_DoodleSavePopupLoadButton=function(){var b=this;var a=this.m_doodleSaveOp.selectElm.value;var c=openIndexedDB();c.onsuccess=function(){var f=getStoreIndexedDB(c,"DoodlePenStore");var d=f.store.get(a);d.onsuccess=function(){b.eraserAllDoodle();b.eFormDoodleOption.pagePathSave=d.result.data;b.EF_setLoadPath();};f.tx.oncomplete=function(){f.result.close();};};this.m_doodleSaveOp.closeButton.click();};Report.prototype.EF_setLoadPath=function(){var b=document.getElementById(this.m_uid+"doodle");var c=b.firstChild;var a=this;var h=this.eFormDoodleOption.pagePathSave[this.beforePageIndex];if(null!=h){var f=h.length;for(var d=0;d<f;d++){var g=document.createElementNS("http://www.w3.org/2000/svg","path");g.setAttribute("id",h[d].id);g.setAttributeNS(null,"style","-webkit-tap-highlight-color: rgba(0, 0, 0, 0);");g.setAttributeNS(null,"stroke-width",h[d].stroke_width);g.setAttributeNS(null,"fill","none");g.setAttributeNS(null,"stroke",h[d].stroke);g.setAttributeNS(null,"stroke-opacity",h[d].stroke_opacity);g.setAttributeNS(null,"d",h[d].d);g.onclick=function(){if(a.eFormDoodleOption.is_eraser){if(a.multiView.isSocket){a.multiView.socket.sendDoodlePathRemove(this);}c.removeChild(this);}};g.onmousemove=g.ontouchmove=function(){if(a.eFormDoodleOption.is_eraser&&a.eFormDoodleOption.is_eraser_down){if(a.multiView.isSocket){a.multiView.socket.sendDoodlePathRemove(this);}c.removeChild(this);}};c.appendChild(g);}}};function openIndexedDB(){var a=is_indexedDB.open("ClipDatabase",1);a.onupgradeneeded=function(){a.result.createObjectStore("DoodlePenStore",{keyPath:"id"});var b=a.result.createObjectStore("DoodlePenListStore",{keyPath:"id"});b.put({id:"keyList",data:[]});};return a;}function getStoreIndexedDB(c,b){var a={};a.result=c.result;a.tx=a.result.transaction(b,"readwrite");a.store=a.tx.objectStore(b);return a;}Report.prototype.m_callSearchWord=function(){if(null==this.m_SearchWordLayout){var d=this;var k=document.createElement("div");k.id="eform_searchword_full_frame";k.className="eform_searchword_full_frame_div";this.targetDiv.appendChild(k);var l=document.createElement("div");l.className="eform_searchword_div";l.style.top=this.menuDiv.offsetHeight+"px";k.appendChild(l);var f=document.createElement("div");f.className="eform_searchword_frame_div";f.style.top=(this.menuDiv.offsetHeight+l.offsetHeight)+"px";k.appendChild(f);var a=document.createElement("input");a.title=this.m_languageMap.searchContent;a.className="eform_searchword_input";a.onkeypress=function(){var o=event.keyCode;if(o==13){d.m_searchWordFind(this.value);}};l.appendChild(a);var g=document.createElement("button");g.className="eform_searchword_search_button";g.title=this.m_languageMap.search;g.onclick=function(){d.m_searchWordFind(a.value);};l.appendChild(g);var i=document.createElement("label");i.innerText="0 / 0";i.className="eform_searchword_label";i.title=this.m_languageMap.orderOfListAndListBySearched;l.appendChild(i);var n=document.createElement("button");n.className="eform_searchword_up_button";n.title=this.m_languageMap.moveUpOfList;n.onclick=function(){d.changePrevWord();};l.appendChild(n);var j=document.createElement("button");j.className="eform_searchword_down_button";j.title=this.m_languageMap.moveDownOfList;j.onclick=function(){d.changeNextWord();};l.appendChild(j);var b=document.createElement("button");b.className="eform_searchword_toggle_button";b.onclick=function(){d.toggleSearchWord();};b.title=this.m_languageMap.toggleListSize;l.appendChild(b);var h=document.createElement("button");h.className="eform_searchword_close_button";h.title=this.m_languageMap.close;h.onclick=function(){d.m_removeSearchWord();};l.appendChild(h);var m=this.paintDiv.lastChild.firstChild.nextSibling.nextSibling.nextSibling;var c=document.createElement("div");c.style.cssText="position:absolute;left:0px;right:0px;top:0px;bottom:0px;border:0px none";m.appendChild(c);this.m_SearchWordLayout={layout:k,input:a,label:i,listLayout:f,rectDiv:c,slectedNum:-1,totalCount:0,strWord:"",arrSearchWordInfo:new Array(),arrSearchWordDiv:new Array()};k.onclick=function(o){d.m_removeSearchWord();o.stopPropagation();};f.onclick=l.onclick=function(o){o.stopPropagation();};a.focus();}};Report.prototype.changePrevWord=function(){if(this.m_SearchWordLayout.totalCount>0){if(this.m_SearchWordLayout.slectedNum-1>=0){this.searchWordSelect(this.m_SearchWordLayout.slectedNum-1);return;}}alert("첫번째 검색 문자입니다.");};Report.prototype.changeNextWord=function(){if(this.m_SearchWordLayout.totalCount>0){if(this.m_SearchWordLayout.slectedNum+1<this.m_SearchWordLayout.totalCount){this.searchWordSelect(this.m_SearchWordLayout.slectedNum+1);return;}}alert("마지막 검색 문자입니다.");};Report.prototype.toggleSearchWord=function(){if(this.m_SearchWordLayout.listLayout.style.display=="block"){this.m_SearchWordLayout.listLayout.style.display="none";}else{this.m_SearchWordLayout.listLayout.style.display="block";}};Report.prototype.m_removeSearchWord=function(){if(null!=this.m_SearchWordLayout){this.targetDiv.removeChild(this.m_SearchWordLayout.layout);this.m_SearchWordLayout.rectDiv.parentElement.removeChild(this.m_SearchWordLayout.rectDiv);this.m_SearchWordLayout=null;}};Report.prototype.m_searchWordFind=function(c){if(this.m_SearchWordLayout.strWord==c){return;}this.m_SearchWordLayout.strWord=c;if(null==this.m_SearchWordDocument){var a=new documentReader();this.m_SearchWordDocument=a.documentReaderFromJSON(this.m_saveJsonDoc,this.servletPath,this.m_uid);for(var b=0;b<this.m_saveJsonDocPageList.length;b++){this.m_SearchWordDocument.addPage(a.readDocumentPage(this.m_saveJsonDocPageList[b]));}}this.removeBeforeSeatchWord();this.searchWord(c,this.m_SearchWordDocument);this.searchWordCreateView();this.searchWordCreateRectView();};Report.prototype.searchWordCreateRectView=function(){this.m_SearchWordLayout.rectDiv.innerHTML="";var k=null;var j=this.m_SearchWordLayout.arrSearchWordInfo;var b=j.length;for(var h=0;h<b;h++){var f=j[h];if((this.beforePageIndex+1)==f.pageNum){var d=document.createElement("div");d.style.left=(f.left/100)+"cm";d.style.top=(f.top/100)+"cm";d.style.width=((f.right-f.left)/100)+"cm";d.style.height=((f.bottom-f.top)/100)+"cm";d.style.zIndex=""+f.number;if(this.m_SearchWordLayout.slectedNum==h){d.className="search_word_inner_div selected_search_word_inner_div";k=d;}else{d.className="search_word_inner_div";}this.m_SearchWordLayout.rectDiv.appendChild(d);}}if(null!=k){var a=this.eFormDoodleOption.zoomIn;var c=is_edge?k.offsetTop/a:k.offsetTop;var g=is_edge?k.offsetLeft/a:k.offsetLeft;if(null!=this.paintDiv){if((this.paintDiv.scrollHeight+5)>this.paintDiv.offsetHeight){this.paintDiv.scrollTop=(c-30)*a;}if((this.paintDiv.scrollWidth+5)>this.paintDiv.offsetWidth){this.paintDiv.scrollLeft=(g-10)*a;}}}};Report.prototype.searchWordCreateView=function(){var b=this.m_SearchWordLayout.arrSearchWordInfo.length;if(b>0){this.m_SearchWordLayout.listLayout.style.display="block";this.m_SearchWordLayout.label.innerText="0 / "+b;this.m_SearchWordLayout.totalCount=b;for(var a=0;a<b;a++){this.createSearchWordViewDiv(a);}}else{alert("조건에 맞는 글자가 없습니다.");}};Report.prototype.searchWordSelect=function(a){this.m_SearchWordLayout.slectedNum=a;var d=this.m_SearchWordLayout.arrSearchWordInfo[a];this.m_SearchWordLayout.label.innerText=(a+1)+" / "+this.m_SearchWordLayout.totalCount;for(var b=0;b<this.m_SearchWordLayout.arrSearchWordDiv.length;b++){if(b==a){this.m_SearchWordLayout.arrSearchWordDiv[b].className="eform_search_word_div selected_search_word_div";}else{this.m_SearchWordLayout.arrSearchWordDiv[b].className="eform_search_word_div";}}if(d.pageNum==(this.beforePageIndex+1)){this.searchWordCreateRectView();}else{this.pageMove(d.pageNum,"search_word");var c=this.paintDiv.lastChild.firstChild.nextSibling.nextSibling.nextSibling;var f=document.createElement("div");f.style.cssText="position:absolute;left:0px;right:0px;top:0px;bottom:0px;border:0px none";c.appendChild(f);this.m_SearchWordLayout.rectDiv=f;this.searchWordCreateRectView();}};Report.prototype.createSearchWordViewDiv=function(i){var d=this;var g=this.m_SearchWordLayout.arrSearchWordInfo[i];var l=g.pageNum;var h=g.number;var k=null;var b="eform_search_word_div";var a="eform_search_word_span";k=g.text;var c=document.createElement("div");c.style.position="relative";c.style.left="0px";c.style.right="0px";c.style.height="50px";c.style.textAlign="left";c.className=b;c.SW_index=i;c.onclick=function(){d.searchWordSelect(c.SW_index);};this.m_SearchWordLayout.listLayout.appendChild(c);this.m_SearchWordLayout.arrSearchWordDiv.push(c);var j=document.createElement("SPAN");j.style.position="absolute";j.className=a;j.innerHTML=k;c.appendChild(j);var f=document.createElement("SPAN");f.style.position="absolute";f.style.right="4px";f.style.top="25%";f.innerHTML=g.pageNum+"page";c.appendChild(f);};Report.prototype.removeBeforeSeatchWord=function(){this.m_SearchWordLayout.label.innerText="0 / 0";this.m_SearchWordLayout.arrSearchWordInfo=new Array();this.m_SearchWordLayout.arrSearchWordDiv=new Array();this.m_SearchWordLayout.listLayout.innerHTML="";this.m_SearchWordLayout.rectDiv.innerHTML="";};Report.prototype.searchWord=function(B,C){var x=0;var d=B.length;var N=C.documentPageList;var D=N.length;for(var m=0;m<D;m++){var f=N[m].subSectionList.length;for(var b=0;b<f;b++){var o=N[m].subSectionList[b].controlPageList.length;for(var y=0;y<o;y++){var M=N[m].subSectionList[b].controlPageList.length;if(M>0){var w=N[m].subSectionList[b].controlPageList[y];if(w.type==0||w.type==40||w.type==41||w.type==42||w.type==43||w.type==44||w.type==45||w.type==46||w.type==47){var n="";if(w.type>0){var J=this.eFormData[w.primaryName];if(null!=J){if(!J.visible&&w.type!=41&&w.type!=42){continue;}if(w.type==40){n=J.formatData;}else{if(w.type==41||w.type==42){n=w.textInfo.originalTextInfo.text;}else{if(w.type==43||w.type==44){n=J.guideMessage;}else{if(w.type==45){var z=this.eFormControlList[w.primaryName];n=z.getValue();}else{n=J.label;}}}}}}else{n=w.textInfo.originalTextInfo.text;}var g=n.length;var u=parseInt(g/d);var O=0;for(var L=0;L<u;L++){var E=n.toLowerCase().indexOf(B.toLowerCase(),O);if(E!=-1){var K=0;var A=0;if(E-16<0){K=0;}else{K=E-16;var q=n.indexOf(" ",E-16);if(q<E){K=q+1;}}if(E+d+10>g){A=g;}else{A=E+d+11;}var l={text:n.substring(K,E)+"<span style='color:Tomato;'>"+n.substring(E,E+d)+"</span>"+n.substring(E+d,A),pageNum:m+1,top:w.rect.top+w.subSection.area.top,left:w.rect.left+w.subSection.area.left,right:w.subSection.area.left+w.rect.right,bottom:w.subSection.area.top+w.rect.bottom,type:"label",number:x++,outterlineStyleKey:w.outterlineStyleKey,pageStyleKey:N[m].pageStyleKey};this.m_SearchWordLayout.arrSearchWordInfo.push(l);if(g-E-d>d){O=E+d;}else{break;}}else{break;}}}else{if(w.type==3){var s=w.table.length;for(var k=0;k<s;k++){var p=w.table[k];var F=p.cellList.length;for(var G=0;G<F;G++){if(p.cellList[G].detailTextInfo!=null){var n=p.cellList[G].detailTextInfo.originalTextInfo.text;var g=n.length;var u=parseInt(g/d);var O=0;for(var L=0;L<u;L++){var E=n.toLowerCase().indexOf(B.toLowerCase(),O);if(E!=-1){var i=0;var h=0;var a=0;var c=0;var P=p.cellList[G].colSpan;var t=p.cellList[G].rowSpan;for(var r=0;r<k;r++){i=i+w.rowColArranger.rowHeightList[r];}for(var r=0;r<t;r++){c=c+w.rowColArranger.rowHeightList[k+r];}for(var H=0;H<G;H++){h=h+w.rowColArranger.columnWidthList[H];}for(var H=0;H<P;H++){a=a+w.rowColArranger.columnWidthList[G+H];}var K=0;var A=0;if(E-16<0){K=0;}else{K=E-16;var q=n.indexOf(" ",E-16);if(q<E){K=q+1;}}if(E+d+10>g){A=g;}else{A=E+d+11;}var l={text:n.substring(K,E)+"<span style='color:Tomato;'>"+n.substring(E,E+d)+"</span>"+n.substring(E+d,A),pageNum:m+1,top:w.rect.top+w.subSection.area.top+i,left:w.rect.left+w.subSection.area.left+h,right:w.subSection.area.left+w.rect.left+h+a,bottom:w.subSection.area.top+w.rect.top+i+c,type:"table",number:x++,outterlineStyleKey:w.outterlineStyleKey,pageStyleKey:N[m].pageStyleKey};this.m_SearchWordLayout.arrSearchWordInfo.push(l);if(g-E-d>d){O=E+d;}else{break;}}else{break;}}}}}}else{if(w.type==10){var I=0;var v=0;var s=w.matrixHeader.rowList.length;for(var j=0;j<s;j++){v=v+w.matrixHeader.rowHeightList[j];}for(var k=0;k<s;k++){var p=w.matrixHeader.rowList[k];var F=p.cellList.length;if(k==0){for(var j=0;j<F;j++){I=I+w.matrixHeader.columnWidthList[j];}}for(var G=0;G<F;G++){if(p.cellList[G].detailTextInfo!=null){var n=p.cellList[G].detailTextInfo.originalTextInfo.text;var g=n.length;var u=parseInt(g/d);var O=0;for(var L=0;L<u;L++){var E=n.toLowerCase().indexOf(B.toLowerCase(),O);if(E!=-1){var i=0;var h=0;var a=0;var c=0;var P=p.cellList[G].colSpan;var t=p.cellList[G].rowSpan;for(var r=0;r<k;r++){i=i+w.matrixHeader.rowHeightList[r];}for(var r=0;r<t;r++){c=c+w.matrixHeader.rowHeightList[k+r];}for(var H=0;H<G;H++){h=h+w.matrixHeader.columnWidthList[H];}for(var H=0;H<P;H++){a=a+w.matrixHeader.columnWidthList[G+H];}var K=0;var A=0;if(E-16<0){K=0;}else{K=E-16;var q=n.indexOf(" ",E-16);if(q<E){K=q+1;}}if(E+d+10>g){A=g;}else{A=E+d+11;}var l={text:n.substring(K,E)+"<span style='color:Tomato;'>"+n.substring(E,E+d)+"</span>"+n.substring(E+d,A),pageNum:m+1,top:w.rect.top+w.subSection.area.top+i,left:w.rect.left+w.subSection.area.left+h,right:w.subSection.area.left+w.rect.left+h+a,bottom:w.subSection.area.top+w.rect.top+i+c,type:"crossTab",number:x++,outterlineStyleKey:w.outterlineStyleKey,pageStyleKey:N[m].pageStyleKey};this.m_SearchWordLayout.arrSearchWordInfo.push(l);if(g-E-d>d){O=E+d;}else{break;}}else{break;}}}}}s=w.matrixColumn.rowList.length;for(var k=0;k<s;k++){var p=w.matrixColumn.rowList[k];var F=p.cellList.length;for(var G=0;G<F;G++){if(p.cellList[G].detailTextInfo!=null){var n=p.cellList[G].detailTextInfo.originalTextInfo.text;var g=n.length;var u=parseInt(g/d);var O=0;for(var L=0;L<u;L++){var E=n.toLowerCase().indexOf(B.toLowerCase(),O);if(E!=-1){var i=0;var h=0;var a=0;var c=0;var P=p.cellList[G].colSpan;var t=p.cellList[G].rowSpan;for(var r=0;r<k;r++){i=i+w.matrixColumn.rowHeightList[r];}for(var r=0;r<t;r++){c=c+w.matrixColumn.rowHeightList[k+r];}for(var H=0;H<G;H++){h=h+w.matrixColumn.columnWidthList[H];}for(var H=0;H<P;H++){a=a+w.matrixColumn.columnWidthList[G+H];}var K=0;var A=0;if(E-16<0){K=0;}else{K=E-16;var q=n.indexOf(" ",E-16);if(q<E){K=q+1;}}if(E+d+10>g){A=g;}else{A=E+d+11;}var l={text:n.substring(K,E)+"<span style='color:Tomato;'>"+n.substring(E,E+d)+"</span>"+n.substring(E+d,A),pageNum:m+1,top:w.rect.top+w.subSection.area.top+i,left:I+w.rect.left+w.subSection.area.left+h,right:I+w.subSection.area.left+w.rect.left+h+a,bottom:w.subSection.area.top+w.rect.top+i+c,type:"crossTab",number:x++,outterlineStyleKey:w.outterlineStyleKey,pageStyleKey:N[m].pageStyleKey};this.m_SearchWordLayout.arrSearchWordInfo.push(l);if(g-E-d>d){O=E+d;}else{break;}}else{break;}}}}}s=w.matrixRow.rowList.length;for(var k=0;k<s;k++){var p=w.matrixRow.rowList[k];var F=p.cellList.length;for(var G=0;G<F;G++){if(p.cellList[G].detailTextInfo!=null){var n=p.cellList[G].detailTextInfo.originalTextInfo.text;var g=n.length;var u=parseInt(g/d);var O=0;for(var L=0;L<u;L++){var E=n.toLowerCase().indexOf(B.toLowerCase(),O);if(E!=-1){var i=0;var h=0;var a=0;var c=0;var P=p.cellList[G].colSpan;var t=p.cellList[G].rowSpan;for(var r=0;r<k;r++){i=i+w.matrixRow.rowHeightList[r];}for(var r=0;r<t;r++){c=c+w.matrixRow.rowHeightList[k+r];}for(var H=0;H<G;H++){h=h+w.matrixRow.columnWidthList[H];}for(var H=0;H<P;H++){a=a+w.matrixRow.columnWidthList[G+H];}var K=0;var A=0;if(E-16<0){K=0;}else{K=E-16;var q=n.indexOf(" ",E-16);if(q<E){K=q+1;}}if(E+d+10>g){A=g;}else{A=E+d+11;}var l={text:n.substring(K,E)+"<span style='color:Tomato;'>"+n.substring(E,E+d)+"</span>"+n.substring(E+d,A),pageNum:m+1,top:v+w.rect.top+w.subSection.area.top+i,left:w.rect.left+w.subSection.area.left+h,right:w.subSection.area.left+w.rect.left+h+a,bottom:v+w.subSection.area.top+w.rect.top+i+c,type:"crossTab",number:x++,outterlineStyleKey:w.outterlineStyleKey,pageStyleKey:N[m].pageStyleKey};this.m_SearchWordLayout.arrSearchWordInfo.push(l);if(g-E-d>d){O=E+d;}else{break;}}else{break;}}}}}s=w.matrixSummarized.rowList.length;for(var k=0;k<s;k++){var p=w.matrixSummarized.rowList[k];var F=p.cellList.length;for(var G=0;G<F;G++){if(p.cellList[G].detailTextInfo!=null){var n=p.cellList[G].detailTextInfo.originalTextInfo.text;var g=n.length;var u=parseInt(g/d);var O=0;for(var L=0;L<u;L++){var E=n.toLowerCase().indexOf(B.toLowerCase(),O);if(E!=-1){var i=0;var h=0;var a=0;var c=0;var P=p.cellList[G].colSpan;var t=p.cellList[G].rowSpan;for(var r=0;r<k;r++){i=i+w.matrixSummarized.rowHeightList[r];}for(var r=0;r<t;r++){c=c+w.matrixSummarized.rowHeightList[k+r];}for(var H=0;H<G;H++){h=h+w.matrixSummarized.columnWidthList[H];}for(var H=0;H<P;H++){a=a+w.matrixSummarized.columnWidthList[G+H];}var K=0;var A=0;if(E-16<0){K=0;}else{K=E-16;var q=n.indexOf(" ",E-16);if(q<E){K=q+1;}}if(E+d+10>g){A=g;}else{A=E+d+11;}var l={text:n.substring(K,E)+"<span style='color:Tomato;'>"+n.substring(E,E+d)+"</span>"+n.substring(E+d,A),pageNum:m+1,top:v+w.rect.top+w.subSection.area.top+i,left:I+w.rect.left+w.subSection.area.left+h,right:I+w.subSection.area.left+w.rect.left+h+a,bottom:v+w.subSection.area.top+w.rect.top+i+c,type:"crossTab",number:x++,outterlineStyleKey:w.outterlineStyleKey,pageStyleKey:N[m].pageStyleKey};this.m_SearchWordLayout.arrSearchWordInfo.push(l);if(g-E-d>d){O=E+d;}else{break;}}else{break;}}}}}}}}}}}}};Report.prototype.EFormTOCView=function(l){if(this.m_isEndReport){if(null!=this.m_he_Toc){return;}var t=l||false;this.m_isSideMenu=t;var r=this;var h=document.createElement("div");h.style.cssText="position:absolute;left:0px;right:0px;top:0px;bottom:0px;border:0px solid;overflow:hidden;background-color:rgba(0,0,0,0);z-index:700;";this.targetDiv.appendChild(h);this.m_he_Toc=h;var u=document.createElement("div");u.className="eform_toc_menu_top";var o=document.createElement("div");o.className="eform_toc_menu_top_text";o.innerHTML="페이지 바로가기";var w=document.createElement("div");w.className="eform_toc_menu_top_close";w.onclick=function(){r.EFormCloseTOCView();};u.appendChild(o);u.appendChild(w);var a=document.createElement("div");a.className="eform_toc_menu_body";var s=this.getEFormTOCData();if(null!=s){var f=s.length;for(var g=0;g<f;g++){var k=s[g];var j="eform_toc_list_depth";var i="";var m="";var b=null;switch(k.depth){case 0:i="eform_toc_list_depth_text eform_toc_list_depth1_text "+k.className;if(this.tocOption.nec[0]){if(k.necessaryControl){j="eform_toc_nec_list_depth";}m+="left:20px;";}else{m+="left:5px;";}if(this.tocOption.viewPN[0].visible){b=document.createElement("div");b.innerText=this.tocOption.viewPN[0].startCh+k.page+this.tocOption.viewPN[0].endCh;m+="right:30px;";}else{m+="right:5px;";}break;case 1:i="eform_toc_list_depth_text eform_toc_list_depth2_text "+k.className;if(this.tocOption.nec[1]){if(k.necessaryControl){j="eform_toc_nec_list_depth";}m+="left:25px;";}else{m+="left:15px;";}if(this.tocOption.viewPN[1].visible){b=document.createElement("div");b.innerText=this.tocOption.viewPN[1].startCh+k.page+this.tocOption.viewPN[1].endCh;m+="right:30px;";}else{m+="right:5px;";}break;case 2:i="eform_toc_list_depth_text eform_toc_list_depth3_text "+k.className;if(this.tocOption.nec[2]){if(k.necessaryControl){j="eform_toc_nec_list_depth";}m+="left:35px;";}else{m+="left:30px;";}if(this.tocOption.viewPN[2].visible){b=document.createElement("div");b.innerText=this.tocOption.viewPN[2].startCh+k.page+this.tocOption.viewPN[2].endCh;m+="right:30px;";}else{m+="right:5px;";}break;default:break;}var q=document.createElement("div");q.className=j;var n=document.createElement("div");n.className=i;n.style.cssText=m;n.innerText=decodeURIComponent(k.title);n.setAttribute("pageNumber",k.page);n.onclick=function(){var x=this.getAttribute("pageNumber");r.pageMove(Number(x),"toc");};q.appendChild(n);if(null!=b){b.className="eform_toc_list_depth_pageNumber";q.appendChild(b);}a.appendChild(q);}}var d=document.createElement("div");d.className="eform_toc_menu_bottom";h.appendChild(u);h.appendChild(a);h.appendChild(d);if(t){var p=a.offsetLeft;var v=a.offsetWidth;if(0==p&&0==v){var c=m_Report_getStylesBySelector(".eform_toc_menu_body");if(c.left){p=parseInt(c.left);}else{p=10;}if(c.width){v=parseInt(c.width);}else{v=250;}}h.style.width=(p*2)+v+"px";this.m_bodyDiv.style.left=(p*2)+v+"px";this.changeRatioCombo(this.getZoomCombo().value,true);}else{h.style.right="0px";}}else{this.debugMeg("report log :: 리포트폼이 완료되지 않은 상태이거나 목차의 보이기옵션이 false상태에서 EFormTOCView 함수가 호출되었습니다.");}};Report.prototype.EFormCloseTOCView=function(){if(null!=this.m_he_Toc){this.targetDiv.removeChild(this.m_he_Toc);if(this.m_isSideMenu){this.m_bodyDiv.style.left="0px";this.changeRatioCombo(this.getZoomCombo().value,true);}this.m_he_Toc=null;}};Report.prototype.setTOCVisible=function(a){this.m_isTOCVisible=a;};Report.prototype.setTOCNecessaryOption=function(b,a){if(null!=this.tocOption){this.tocOption.nec[(Number(b)-1)]=a;}};Report.prototype.setTOCPageNumberOption=function(b,a,d,c){if(null!=this.tocOption){option=this.tocOption.viewPN[(Number(b)-1)];if(null!=option){option.visible=a;option.startCh=d;option.endCh=c;}}};Report.prototype.EFormTOCTitlePutClass=function(d,b){if(this.m_isEndReport){if(this.eFormTOCList.length>0){var a=null;if(null!=this.m_he_Toc){try{a=this.m_he_Toc.childNodes[1];}catch(h){a=null;}}var f=this.eFormTOCList.length;for(var c=0;c<f;c++){var i=this.eFormTOCList[c];if(i.title==d){i.className=b;if(null!=a){var g=a.childNodes[c].firstChild;switch(i.depth){case 0:g.className="eform_toc_list_depth_text eform_toc_list_depth1_text "+b;break;case 1:g.className="eform_toc_list_depth_text eform_toc_list_depth2_text "+b;break;case 2:g.className="eform_toc_list_depth_text eform_toc_list_depth3_text "+b;break;}}}}}}else{this.debugMeg("report log :: 리포트폼이 완료되지 않은 상태에서 EFormTOCTitlePutClass 함수가 호출되었습니다.");}};Report.prototype.getEFormTOCData=function(){if(this.m_isEndReport){if(this.eFormTOCList.length>0){var d=new Array();for(var b in this.eFormData){var a=this.eFormData[b];if(a.visible&&!a.disable&&"true"==a.isNecessaryCheck){var g=this.isEasyInput?0:a.pageNumber;d[g]=true;}}var f=this.eFormTOCList.length;for(var c=0;c<f;c++){var h=this.eFormTOCList[c];if(null==h.className){h.className="";}h.necessaryControl=false;if(null!=d[(h.page-1)]){h.necessaryControl=true;}}d=null;}return this.eFormTOCList;}this.debugMeg("report log :: 리포트폼이 완료되지 않은 상태에서 getEFormTOCData 함수가 호출되었습니다.");return null;};Report.prototype.closeEFormThumbnailView=function(){if(null!=this.m_he_Thumbnail){this.m_he_Thumbnail.style.display="none";if(this.m_isSideMenu){this.m_bodyDiv.style.left="0px";this.changeRatioCombo(this.getZoomCombo().value,true);}}};Report.prototype.EFormThumbnailView=function(f,a){var m=f||false;var p=a||false;this.m_isSideMenu=m;if(this.m_isEndReport){if(this.m_isThumbnail&&!this.isEasyInput){if(null!=this.m_he_Thumbnail){if(this.m_he_Thumbnail.style.display=="none"){this.m_he_Thumbnail.style.display="";if(m){var j=this.m_he_Thumbnail.offsetWidth;if(j==0){j=Number(this.m_he_Thumbnail.getAttribute("wo"));}this.m_bodyDiv.style.left=j+"px";this.changeRatioCombo(this.getZoomCombo().value,true);}if(this.m_thumbnail_count<this.m_pageCount){this.EF_thumbnail_page();}else{this.EF_thumbnail_focus();}}return;}this.m_thumbnail_count=0;var k=this;var t=document.createElement("div");t.style.cssText="position:absolute;left:0px;top:0px;bottom:0px;border:0px solid;overflow:hidden;background-color:rgba(0,0,0,0);z-index:700;";if(p){t.tabIndex="0";t.isFocus=false;t.className="eform_thumbnail_default";t.onmouseup=function(u){this.focus();};t.onfocus=function(u){if(!k.m_disabledMenu&&k.menuDiv.firstChild.style.display!="none"){this.className="eform_thumbnail_focus";this.isFocus=true;}};t.onblur=function(u){this.className="eform_thumbnail_default";this.isFocus=false;};t.onkeyup=function(u){if(this.isFocus&&this.style.display!="none"&&!k.isScreenBlock()&&!k.m_disabledMenu&&k.menuDiv.firstChild.style.display!="none"){if(u.key=="Up"||u.key=="ArrowUp"){k.previousPage("thumbnail");k.EF_thumbnail_focus(true);}else{if(u.key=="Down"||u.key=="ArrowDown"){k.nextPage("thumbnail");k.EF_thumbnail_focus(true);}}}};}this.targetDiv.appendChild(t);this.m_he_Thumbnail=t;var n=document.createElement("div");n.className="eform_thumbnail_menu_top";var g=document.createElement("div");g.className="eform_thumbnail_menu_top_text";g.innerHTML="페이지 바로가기";var r=document.createElement("div");r.className="eform_thumbnail_menu_top_close";r.onclick=function(){k.closeEFormThumbnailView();};n.appendChild(g);n.appendChild(r);var b=document.createElement("div");b.id=this.m_uid+"thumbnailBody";b.className="eform_thumbnail_menu_body";var d=document.createElement("div");d.className="eform_thumbnail_menu_bottom";t.appendChild(n);t.appendChild(b);t.appendChild(d);if(m){var i=b.offsetLeft;var q=b.offsetWidth;if(0==i&&0==q){var c=m_Report_getStylesBySelector(".eform_thumbnail_menu_body");if(c.left){i=parseInt(c.left);}else{i=10;}if(c.width){q=parseInt(c.width);}else{q=250;}}t.style.width=((i*2)+q)+"px";t.setAttribute("wo",((i*2)+q));this.m_bodyDiv.style.left=((i*2)+q)+"px";this.changeRatioCombo(this.getZoomCombo().value,true);}else{t.style.right="0px";}var h=new Array();if(this.is_eForm){for(var l in this.eFormData){var s=this.eFormData[l];if(s.visible&&!s.disable&&"true"==s.isNecessaryCheck){var o=this.isEasyInput?0:s.pageNumber;h[o]=true;}}}this.EF_thumbnail_page(h);}else{this.debugMeg("report log :: 이 서식에는 Thumbnail 존재하지 않거나 간편입력모드 입니다.");}}else{this.debugMeg("report log :: 리포트폼이 완료되지 않은 상태에서 EFormThumbnailView 함수가 호출되었습니다.");}};Report.prototype.EFormThumbnailNecessaryCheckUpdate=function(){var d=document.getElementById(this.m_uid+"thumbnailBody");if(null!=d){var k=new Array();if(this.is_eForm){for(var h in this.eFormData){var j=this.eFormData[h];if(j.visible&&!j.disable&&"true"==j.isNecessaryCheck&&j.is_nc){var g=this.isEasyInput?0:j.pageNumber;k[g]=true;}}}var b=d.children.length;for(var f=0;f<b;f++){var c=d.children[f];var a="";if(null!=k[f]){a="eform_thumbnail_menu_body_necessary_div";}else{a="eform_thumbnail_menu_body_div";}if(f==this.beforePageIndex){a+=" eform_thumbnail_menu_body_focus_div";}c.className=a;}}};Report.prototype.EF_thumbnail_page=function(b){if(this.m_thumbnail_count<this.m_pageCount){var a=this;var c={uid:this.m_uid,pageNum:this.m_thumbnail_count};var g=this.servletPath;var d=-1!=g.indexOf("?")?"GET":"POST";var f="ClipID=R32&ClipData="+JSON.stringify(c);if(this.m_postParam!=null){f+=this.m_postParam.getParam();}f=mRe_onBeforeSend(f);$.ajax({type:d,url:g,data:f,success:function(h){h=mRe_onAfterSend(h);if(null!=h){a.EF_thumbnail_MakePage(h,b);}},error:function(h){a.debugMeg("report log :: 썸네일 관련 이미지 통신 오류 발생 >>>"+h);}});}else{this.EF_thumbnail_focus();}};Report.prototype.EF_thumbnail_MakePage=function(k,j){var c=document.getElementById(this.m_uid+"thumbnailBody");try{var d=jQuery.parseJSON(k);if(null!=d){if(d.resValue.event==200){var h=d.resValue.pageNum;var b=document.createElement("div");if(null!=j[h]){b.className="eform_thumbnail_menu_body_necessary_div";}else{b.className="eform_thumbnail_menu_body_div";}b.style.top=(10+(h*5))+"px";var a=this;b.onclick=function(){a.pageMove(h+1,"thumbnail");};var i=document.createElement("div");i.className="eform_thumbnail_menu_body_img";i.style.backgroundImage="url('data:image/jpg;base64, "+d.resValue.viewData+"')";var g=document.createElement("div");g.innerHTML=""+(h+1);b.appendChild(i);b.appendChild(g);c.appendChild(b);this.m_thumbnail_count++;this.EF_thumbnail_page(j);}else{this.debugMeg("report log :: 이폼 서버 오류가 발생하였습니다. 서버 로그를 확인하세요 >>> 코드:"+d.resValue.event);}}}catch(f){this.debugMeg("report log :: 이폼 서버 응답 오류 >>> 서버 응답 데이터 없거나  데이터가 잘못되었습니다.");this.debugMeg("report log :: 이폼 서버 응답 >>> "+k);}};Report.prototype.EF_thumbnail_focus=function(f){if(typeof f==="undefined"){f=false;}if(!this.m_isThumbnail){return;}var c=document.getElementById(this.m_uid+"thumbnailBody");try{if(null!=this.m_thumbnailFocusBody){var b=this.m_thumbnailFocusBody.className.replace(" eform_thumbnail_menu_body_focus_div","");this.m_thumbnailFocusBody.className=b;}if(null!=c){var a=c.children[this.beforePageIndex];if(null!=a){a.className+=" eform_thumbnail_menu_body_focus_div";this.m_thumbnailFocusBody=a;if(f){c.scrollTop=a.offsetTop;}}}}catch(d){this.debugMeg("report log :: 이폼 썹네일 포커스 오류 >>> "+d);}};Report.prototype.m_isHiddenMenu=false;Report.prototype.m_exeCurrentScale=1;Report.prototype.m_exeBeforeScale=1;Report.prototype.m_exeSubCloseEvent=null;Report.prototype.setExeSubCloseEventHandler=function(a){this.m_exeSubCloseEvent=a;};window.mRe_exeCallInterval=200;Report.prototype.setExeCallInterval=function(a){window.mRe_exeCallInterval=a;};Report.prototype.callAsyncSpeechSpeakAsync=function(d,c,a){var b={methodName:"asyncSpeechSpeakAsync",data:{id:d,title:c,suffixSpeechText:a}};window.external.ClipSubWebBrowserCtrl_Invoke(JSON.stringify(b));};Report.prototype.callExeClearTextVirtualKeyboardCtrlForm=function(){var a={methodName:"ClearTextVirtualKeyboard"};if(null!=this.multiView&&null!=this.multiView.socket&&this.multiView.socket.wsPath!="localhost"){this.multiView.socket.sendExeSubCallEvent(this.m_uid,a);}else{window.external.ClipMainWebBrowserCtrl_Invoke(JSON.stringify(a));}};Report.prototype.callExeClearTextVirtualKeyboardCtrlFormSub=function(a){window.external.ClipSubWebBrowserCtrl_Invoke(JSON.stringify(a));};Report.prototype.callExeCancelVirtualKeyboardCtrlForm=function(){var a={methodName:"CancelVirtualKeyboard"};if(null!=multiView&&null!=this.multiView.socket&&this.multiView.socket.wsPath!="localhost"){this.multiView.socket.sendExeSubCallEvent(this.m_uid,a);}else{window.external.ClipMainWebBrowserCtrl_Invoke(JSON.stringify(a));}};Report.prototype.callExeSaveVirtualKeyboardCtrlForm=function(){var a={methodName:"SaveVirtualKeyboard"};if(null!=this.multiView&&null!=this.multiView.socket&&this.multiView.socket.wsPath!="localhost"){this.multiView.socket.sendExeSubCallEvent(this.m_uid,a);}else{window.external.ClipMainWebBrowserCtrl_Invoke(JSON.stringify(a));}};Report.prototype.callExeSaveVirtualKeyboardCtrlFormSub=function(a){window.external.ClipSubWebBrowserCtrl_Invoke(JSON.stringify(a));};Report.prototype.callExeStampSubSetter=function(b,a){try{ReportWebLog("중계서버를 통한 인감이미지 메인에서 수신완료");ReportWebLog("CtrlId="+b);ReportWebLog("Base64="+a);var c={methodName:"RemoteSetStampImageSignatureBoard",data:{id:b,base64Image:a}};window.external.ClipSubWebBrowserCtrl_Invoke(JSON.stringify(c));}catch(d){ReportWebLog(d.stack);}};Report.prototype.callExeShowStampDlg=function(b,c){var d={methodName:"ShowStampDlg",id:b,title:"",subCall:!c};var a=this.eFormControlList[b];if(null!=a){if(null!=a.controlData.title){d.title=a.controlData.title;}}window.external.ClipMainWebBrowserCtrl_Invoke(JSON.stringify(d));};Report.prototype.callExeShowStampDlgSub=function(a){window.external.ClipSubWebBrowserCtrl_Invoke(JSON.stringify(a));};Report.prototype.callExeSaveSignatureCtrlForm=function(){var a={methodName:"SaveSignatureCtrlForm"};if(null!=this.multiView&&null!=this.multiView.socket&&this.multiView.socket.wsPath!="localhost"){this.multiView.socket.sendExeSubCallEvent(this.m_uid,a);}else{window.external.ClipMainWebBrowserCtrl_Invoke(JSON.stringify(a));}};Report.prototype.callExeSaveSignatureCtrlFormSub=function(a){window.external.ClipSubWebBrowserCtrl_Invoke(JSON.stringify(a));};Report.prototype.callExeInitSignatureCtrlForm=function(a){var b={methodName:"InitSignatureCtrlForm",id:a};if(null!=this.multiView&&null!=this.multiView.socket&&this.multiView.socket.wsPath!="localhost"){this.multiView.socket.sendExeSubCallEvent(this.m_uid,b);}else{window.external.ClipMainWebBrowserCtrl_Invoke(JSON.stringify(b));}};Report.prototype.callExeInitSignatureCtrlFormSub=function(a){window.external.ClipSubWebBrowserCtrl_Invoke(JSON.stringify(a));};Report.prototype.callExeSaveSignatureCtrlFormSub=function(a){window.external.ClipSubWebBrowserCtrl_Invoke(JSON.stringify(a));};Report.prototype.callExeChangeSignatureCtrlForm=function(a){var b={methodName:"ChangeSignatureCtrlForm",id:a};if(null!=this.multiView&&null!=this.multiView.socket&&this.multiView.socket.wsPath!="localhost"){this.multiView.socket.sendExeSubCallEvent(this.m_uid,b);}else{window.external.ClipMainWebBrowserCtrl_Invoke(JSON.stringify(b));}};Report.prototype.callExeChangeSignatureCtrlFormSub=function(a){window.external.ClipSubWebBrowserCtrl_Invoke(JSON.stringify(a));};Report.prototype.setExeInputDecimalPointLength=function(a){this.m_exeOption.decimalPointLength=a;};Report.prototype.setExeSelectBoxActivation=function(a){this.m_exeOption.isSelectBoxAct=a;};Report.prototype.setExeCalendarActivation=function(a){this.m_exeOption.isCalendarAct=a;};Report.prototype.setExeMirroringInternalEvent=function(a){this.m_exeOption.isMirroringInternalEvent=a;};Report.prototype.setExeMirroringMobile=function(a){this.m_exeOption.isMobile=a;};Report.prototype.setExeMirroringTab=function(a){this.m_exeOption.isTab=a;};Report.prototype.setExeSubVirtualKeyboardKeyPressedSetInputText=function(a){this.m_exeOption.isVirtualKeyboardKeyPressedSetInputText=a;};Report.prototype.createZoomScreenLock=function(){if(null==this.m_ReZSLock){this.m_ReZSLock=document.createElement("div");this.m_ReZSLock.id="re_paintZoomDiv"+this.m_uid;this.m_ReZSLock.className="eform_zoom_lock";var a=document.createElement("div");a.style.display="none";document.addEventListener("mousemove",function(b){a.style.display="";var c=b.offsetX;var d=b.offsetY;if(c<30&&d<30){return;}a.style.left=c-25+"px";a.style.top=d-25+"px";});document.addEventListener("mouseleave",function(){a.style.display="none";});this.m_ReZSLock.appendChild(a);this.targetDiv.appendChild(this.m_ReZSLock);}};Report.prototype.removeZoomScreenLock=function(){if(null!=this.m_ReZSLock){this.targetDiv.removeChild(this.m_ReZSLock);this.m_ReZSLock=null;}};Report.prototype.getZoomCombo=function(){return this.zoomCombo;};Report.prototype.getCurrentScale=function(){return this.eFormDoodleOption.zoomIn;};Report.prototype.getViewSizeInfo=function(){var a=this.paintDiv.firstChild.firstChild;var b={SvgWidth:a.getAttribute("width"),SvgHeight:a.getAttribute("height"),PageWidth:this.pageWidth,PageHeight:this.pageHeight,PaintDivClientWidth:this.paintDiv.clientWidth,PaintDivClientHeight:this.paintDiv.clientHeight};return JSON.stringify(b);};Report.prototype.IsMenuHidden=function(){return this.m_isHiddenMenu;};Report.prototype.setMenuHidden=function(){this.m_isHiddenMenu=true;this.setStyle("menu","display:none;");this.setStyle("main","top:0px;");};Report.prototype.setExeSaveButtonDisabled=function(a){if(this.save_button.style.opacity!==undefined){if(a){this.save_button.style.opacity=0.4;}else{this.save_button.style.opacity=1;}}};Report.prototype.exeImmediatelyZoom=function(h){try{var j=document.getElementById(this.m_uid+"ImagePointer");if(null!=j){var l=JSON.parse(h);var a=l.currentZoom/100;this.m_exeCurrentScale=a;var d=j.offsetTop;var f=j.offsetLeft;if(this.m_ReBeforeZoom==null){this.m_ReBeforeZoom=a;}this.eFormZoom(a,1);if(is_ie){this.paintDiv.firstChild.style.visibility="visible";}this.paintDiv.style.overflowX="auto";this.paintDiv.style.overflowY="auto";d=d+j.parentElement.offsetTop;f=f+j.parentElement.offsetLeft;var b=(this.paintDiv.offsetWidth-j.offsetWidth)/2;var k=(this.paintDiv.offsetHeight-j.offsetHeight)/2;var g=(f-(b/a))*a;var c=(d-100)*a;this.paintDiv.scrollLeft=g;this.paintDiv.scrollTop=c;this.m_exeBeforeScale=this.m_exeCurrentScale;}else{this.exeEFormZoom(h);}}catch(i){exeMirroringReportWebLog(i.stack);}};Report.prototype.exeEFormZoom=function(t){if(this.isEasyInput&&this.isEasyInputHidden){return;}var j=this.paintDiv.firstChild.firstChild;if(j!=null){try{var p=JSON.parse(t);var m=p.point;var f=p.currentZoom/100;this.m_exeCurrentScale=f;if(this.m_buttonEvent.startZoomInSelect!=null){var s=this.m_buttonEvent.startZoomInSelect();if(s!=true){return;}}if(is_ie){this.paintDiv.firstChild.style.visibility="visible";}this.paintDiv.style.overflowX="auto";this.paintDiv.style.overflowY="auto";var c=this.paintDiv.clientWidth*f;var b=this.paintDiv.clientHeight*f;var r=c/Number(this.pageWidth);var d=b/Number(this.pageHeight);var k=r>d?d:r;this.eFormDoodleOption.zoomIn=Re_zoom.rate=Number(k);if("svg"==j.tagName){this.m_objCavasRate=k;j.setAttribute("width",Number(this.pageWidth)*Number(k));j.setAttribute("height",Number(this.pageHeight)*Number(k));if(null!=j.lastChild){j.lastChild.setAttribute("transform","scale("+k+") translate(0,0)");}}else{if(this.m_objCavasRate!=k){var h=j.parentElement;h.removeChild(j);this.m_objCavasRate=k;if(k<1){var i=this.reDrawCanvasPage(1,h);if(is_smartphone){i.style.zoom=(k*0.5);}else{i.style.zoom=k;}}else{var i=this.reDrawCanvasPage(k,h);}}else{if(is_smartphone){j.style.zoom="0.5";}else{j.style.zoom=k;}}}var l=this.paintDiv.firstChild.nextSibling;if(null!=l){l.style.zoom=k;}var o=this.paintDiv.scrollLeft;var a=this.paintDiv.scrollTop;var g=(o+m.x)*(this.m_exeCurrentScale/this.m_exeBeforeScale)-m.x;var n=(a+m.y)*(this.m_exeCurrentScale/this.m_exeBeforeScale)-m.y;this.paintDiv.scrollLeft=g;this.paintDiv.scrollTop=n;this.m_exeBeforeScale=this.m_exeCurrentScale;if(is_ie){this.paintDiv.firstChild.style.visibility="visible";}if(this.is_eForm){this.zoomChangeEForm();}}catch(q){exeMirroringReportWebLog(q.stack);}}};Report.prototype.exeEFormEndZoom=function(){this.exeEFormChangeDefaultSize();this.m_exeCurrentScale=1;this.m_exeBeforeScale=1;};Report.prototype.exeEFormChangeDefaultSize=function(){if(null!=this.m_ReBeforeZoom){this.zoomIn(this.getZoomCombo());this.m_ReBeforeZoom=null;return;}this.zoomIn(this.getZoomCombo());};Report.prototype.exeEFormScroll=function(c){c=JSON.parse(c);var d=c.direction;var a=c.scrollValue;var b=c.naturalScroll;switch(d){case 1:if(b){this.paintDiv.scrollLeft-=a;}else{this.paintDiv.scrollLeft+=a;}break;case 2:if(b){this.paintDiv.scrollLeft+=a;}else{this.paintDiv.scrollLeft-=a;}break;case 3:if(b){this.paintDiv.scrollTop-=a;}else{this.paintDiv.scrollTop+=a;}break;case 4:if(b){this.paintDiv.scrollTop+=a;}else{this.paintDiv.scrollTop-=a;}break;case 5:if(b){this.paintDiv.scrollLeft-=a;this.paintDiv.scrollTop-=a;}else{this.paintDiv.scrollLeft+=a;this.paintDiv.scrollTop+=a;}break;case 6:if(b){this.paintDiv.scrollLeft+=a;this.paintDiv.scrollTop-=a;}else{this.paintDiv.scrollLeft-=a;this.paintDiv.scrollTop+=a;}break;case 7:if(b){this.paintDiv.scrollLeft-=a;this.paintDiv.scrollTop+=a;}else{this.paintDiv.scrollLeft+=a;this.paintDiv.scrollTop-=a;}break;case 8:if(b){this.paintDiv.scrollLeft+=a;this.paintDiv.scrollTop+=a;}else{this.paintDiv.scrollLeft-=a;this.paintDiv.scrollTop-=a;}break;}};Report.prototype.ZoomPointDrawingCircle=function(b){var a=document.getElementById(this.m_uid+"doodle");if(null!=a){var c=new Path2D();}};window.mRe_ShowSubWndTitle="안내사항";window.mRe_ShowSubWndMessage="터치모니터의 화면이 활성화되지 않았습니다.";window.mRe_isShowSubWnd=false;window.mRe_timeout=null;window.mRe_callbackEvent=null;Report.prototype.mRe_receiveAliveSub=function(){if(window.mRe_timeout!=null){window.clearTimeout(window.mRe_timeout);window.mRe_timeout=null;if(null!=window.mRe_callbackEvent){window.mRe_callbackEvent(true);window.mRe_callbackEvent=null;}}};Report.prototype.mRe_subCheckFromMessage=function(){var b=this.multiView;var a=false;if(null!=b&&null!=b.socket){if(b.socket.wsPath=="localhost"){if(is_exeMirroringMain&&!window.mRe_isShowSubWnd){a=true;}if(a){window.mRe_timeout=window.setTimeout(function(){ClipAlertUI(window.mRe_ShowSubWndTitle,window.mRe_ShowSubWndMessage);window.mRe_timeout=null;},700);b.socket.sendExeSubAlive(this.m_uid);return;}}else{if(b.socket.isMain){if(!(b.socket.stateWs==300||b.socket.stateWs==400)){a=true;}}}}if(a){ClipAlertUI(window.mRe_ShowSubWndTitle,window.mRe_ShowSubWndMessage);}};Report.prototype.callAliveSubStatus=function(b){var c=this.multiView;var a=false;if(null!=c&&null!=c.socket){if(c.socket.wsPath=="localhost"){if(is_exeMirroringMain&&!window.mRe_isShowSubWnd){a=true;}if(a){window.mRe_callbackEvent=b;window.mRe_timeout=window.setTimeout(function(){b(false);window.mRe_timeout=null;},700);c.socket.sendExeSubAlive(this.m_uid);return;}}else{if(c.socket.isMain){if(!(c.socket.stateWs==300||c.socket.stateWs==400)){a=true;}}}}if(a){b(false);}else{b(true);}};Report.prototype.callMainStampScanner=function(b){if(this.isMainStampScanner){var g=this;var h=this.multiView;if(null!=h&&null!=h.socket){h.socket.sendSubAppScreenLock(this.m_uid,b);}var a;try{a=window.top;}catch(c){console.error("최상위 window 객체에 접근할 수 없습니다:",c);a=window;}a.set_eform_main_stamp_data=function(j){g.receiveMainStampScanner(JSON.parse(j));};var d={};d.uid=this.m_uid;d.ctrlID=b;if(is_exeMirroringMain){var f={methodName:"MainStampScanner",data:{uid:this.m_uid,id:b,}};window.external.ClipMainWebBrowserCtrl_Invoke(JSON.stringify(f));}else{var i=document.createElement("input");i.accept="image/*";i.type="file";i.onchange=function(m){var l=m.target.files[0];var k=new FileReader();var j=this;k.onload=function(o){var n=o.target.result.indexOf("base64,");d.status=0;d.base64=o.target.result.substring((n+7));set_eform_main_stamp_data(JSON.stringify(d));};k.onerror=function(){d.status=2;d.base64="";set_eform_main_stamp_data(JSON.stringify(d));};k.readAsDataURL(l);};i.oncancel=function(){d.status=1;d.base64="";set_eform_main_stamp_data(JSON.stringify(d));};i.click();}}};Report.prototype.receiveMainStampScanner=function(b){if(b.status==0){var a=this.eFormControlList[b.ctrlID];var c=null;var f=null;if(null!=a){c=a.controlData.width;f=a.controlData.height;}this.receiveStampImg(b.ctrlID,b.base64,c,f);}var d=this.multiView;if(null!=d&&null!=d.socket){d.socket.sendMainStampScannerData(b);}if(null!=this.mainStampScannerEvent){this.mainStampScannerEvent(b.status);}};var exeMirroringEForm=null;var exeMirroringTabPlugin=null;function MainWebBrowserCtrl_SetTabPlugin(a){exeMirroringTabPlugin=a;}function SubWebBrowserCtrl_SetTabPlugin(a){exeMirroringTabPlugin=a;}function MainWebBrowserCtrl_SetTabObject(a){exeMirroringReportWebLog("Start Main SetTabObject");if(exeMirroringTabPlugin.isAppendSelect){exeMirroringEForm=a;exeMirroringReportWebLog("추가된 eform 객체를 설정합니다.");}else{if(exeMirroringEForm==null){exeMirroringEForm=a;exeMirroringReportWebLog("최초의 eform 객체를 설정합니다.");}}exeMirroringReportWebLog("End Main SetTabObject");}function MainWebBrowserCtrl_TabErrorLogEvent(a){exeMirroringReportWebLog("MainWebBrowserCtrl_TabErrorLogEvent="+JSON.stringify(a));window.external.MainWebBrowserCtrl_TabErrorLogEvent(JSON.stringify(a));}function MainWebBrowserCtrl_SetTabSelectedEvent(a){exeMirroringReportWebLog("Start MainWebBrowserCtrl_SetTabSelectedEvent");var b={};try{if(a.report!=null){eform=a.report;}exeMirroringEForm=a.report;b.result=exeMirroringEForm.m_reportKey;b.uid=exeMirroringEForm.getReportKey();b.totalPage=exeMirroringEForm.getTotalPageCount();b.selectPage=exeMirroringEForm.getSelectPageNumber();b.parentTabName=a.name;b.tabName=a.name;window.external.MainWebBrowserCtrl_SetTabSelectedEvent(JSON.stringify(b));exeMirroringReportWebLog("End MainWebBrowserCtrl_SetTabSelectedEvent");}catch(c){exeMirroringReportWebLog(c.stack);exeMirroringReportWebLog(JSON.stringify(b));return;}}function MainWebBrowserCtrl_SetTabBeforeRemoveEvent(a){exeMirroringReportWebLog("Start MainWebBrowserCtrl_SetTabBeforeRemoveEvent");try{var d=a.report;var b={};b.result=d.m_reportKey;b.uid=d.getReportKey();b.parentTabName=a.name;b.tabName=a.name;window.external.MainWebBrowserCtrl_SetTabBeforeRemoveEvent(JSON.stringify(b));exeMirroringReportWebLog("End MainWebBrowserCtrl_SetTabBeforeRemoveEvent");}catch(c){exeMirroringReportWebLog(c.stack);return;}}function MainWebBrowserCtrl_AllClearTabEvent(a){exeMirroringReportWebLog("Start MainWebBrowserCtrl_AllClearTabEvent");try{if(!a){a={};}window.external.MainWebBrowserCtrl_AllClearTabEvent(JSON.stringify(a));exeMirroringReportWebLog("End MainWebBrowserCtrl_AllClearTabEvent");}catch(b){exeMirroringReportWebLog(b.stack);}}function SubWebBrowserCtrl_SetTabObject(a){exeMirroringReportWebLog("Start Sub SetTabObject");if(exeMirroringTabPlugin.isAppendSelect){exeMirroringEForm=a;exeMirroringReportWebLog("추가된 eform 객체를 설정합니다.");}else{if(exeMirroringEForm==null){exeMirroringEForm=a;exeMirroringReportWebLog("최초의 eform 객체를 설정합니다.");}}exeMirroringReportWebLog("End Sub SetTabObject");}function SubWebBrowserCtrl_SetTabSelectedEvent(a){exeMirroringReportWebLog("Start SubWebBrowserCtrl_SetTabSelectedEvent");try{exeMirroringEForm=a.report;var b={uid:exeMirroringEForm.getReportKey(),totalPage:exeMirroringEForm.getTotalPageCount(),selectPage:exeMirroringEForm.getSelectPageNumber(),};if(exeMirroringEForm.eFormDoodleOption.is_Ds){b.isSubOpenDoodle=true;if(exeMirroringEForm.eFormDoodleOption.is_eraser){b.doodleMode="eraser";}else{b.doodleMode="pen";}}else{b.isOpenDoodle=false;b.doodleMode="pen";}exeMirroringReportWebLog("End SubWebBrowserCtrl_SetTabSelectedEvent");}catch(c){exeMirroringReportWebLog(c.stack);return;}}function SubWebBrowserCtrl_SetTabBeforeRemoveEvent(a){exeMirroringReportWebLog("Start SubWebBrowserCtrl_SetTabBeforeRemoveEvent");try{var d=a.report;var b={uid:d.getReportKey(),};exeMirroringReportWebLog("End SubWebBrowserCtrl_SetTabBeforeRemoveEvent");}catch(c){exeMirroringReportWebLog(c.stack);return;}}function SubWebBrowserCtrl_SetTabEFormObject(d){exeMirroringReportWebLog("메인에서 선택된 탭으로 탭 변경을 시작합니다.");var c=null;for(var b=0;b<exeMirroringTabPlugin.tabList.length;b++){var a=exeMirroringTabPlugin.tabList[b];if(a.name==d){c=a.report;break;}}if(c!=null){exeMirroringEForm=c;exeMirroringReportWebLog("메인에서 선택된 탭으로 탭을 변경합니다.="+d);}else{exeMirroringReportWebLog("메인에서 선택된 탭으로 탭을 변경하지 못하였습니다.");}}function MainWebBrowserCtrl_InitializeEvent(a){if(exeMirroringTabPlugin!=null){if(exeMirroringEForm.isAppendSelect){exeMirroringEForm=a;exeMirroringReportWebLog("MainWebBrowserCtrl_InitializeEvent 탭을 변경합니다.");}}else{exeMirroringEForm=a;exeMirroringReportWebLog("MainWebBrowserCtrl_InitializeEvent 탭을 변경합니다.");}window.MainWebBrowserCtrl_PrevDoodlePage=function(){if(exeMirroringEForm.eFormDoodleOption.is_Ds){exeMirroringEForm.previousDoodlePage("exe_page_move");}};window.MainWebBrowserCtrl_NextDoodlePage=function(){if(exeMirroringEForm.eFormDoodleOption.is_Ds){exeMirroringEForm.nextDoodlePage("exe_page_move");}};window.MainWebBrowserCtrl_PreviousPage=function(){if(!exeMirroringEForm.isViewDisabled()&&!exeMirroringEForm.eFormDoodleOption.is_Ds&&!exeMirroringEForm.m_isMemoEnabled){exeMirroringEForm.previousPage("exe_page_move");return true;}return false;};window.MainWebBrowserCtrl_NextPage=function(){if(!exeMirroringEForm.isViewDisabled()&&!exeMirroringEForm.eFormDoodleOption.is_Ds&&!exeMirroringEForm.m_isMemoEnabled){exeMirroringEForm.nextPage("exe_page_move");return true;}return false;};window.MainWebBrowserCtrl_PageMove=function(b){exeMirroringEForm.pageMove(b,"exe_page_move");};window.MainWebBrowserCtrl_SubWndEvent=function(b){try{exeMirroringReportWebLog("MainWebBrowserCtrl_SubWndEvent 설정 시작");b=JSON.parse(b);window.mRe_isShowSubWnd=b.isShowSubWnd;exeMirroringReportWebLog("EXE 뷰어에서 고객화면 시작/종료 이벤트를 전달 받았습니다. 상태="+b.isShowSubWnd);exeMirroringReportWebLog("MainWebBrowserCtrl_SubWndEvent 설정 완료");}catch(c){exeMirroringReportWebLog(c.stack);}};window.MainWebBrowserCtrl_SetMirroring=function(b){exeMirroringReportWebLog("미러링 설정을 합니다. Status="+((b==true)?"true":"false"));exeMirroringEForm.multiView.isSocket=b;exeMirroringReportWebLog("미러링 설정을 마칩니다.");};window.MainWebBrowserCtrl_GetViewSizeInfo=function(){return exeMirroringEForm.getViewSizeInfo();};window.MainWebBrowserCtrl_CreateMainBlockScreen=function(b){exeMirroringEForm.createMainBlockScreen(b);};window.MainWebBrowserCtrl_RemoveMainBlockScreen=function(){exeMirroringEForm.removeMainBlockScreen();};window.MainWebBrowserCtrl_CloseSubEForm=function(){exeMirroringEForm.removeAllBlockScreen();if(exeMirroringEForm.m_exeSubCloseEvent!=null){exeMirroringEForm.m_exeSubCloseEvent();}};window.MainWebBrowserCtrl_RemoveSignBlockScreen=function(){exeMirroringEForm.removeAllBlockScreen();};window.MainWebBrowserCtrl_DirectCloseSubReport=function(){exeMirroringEForm.closeSubReport();};window.MainWebBrowserCtrl_ReceiveInitializeData=function(b){if(exeMirroringTabPlugin==null){exeMirroringReportWebLog("MainWebBrowserCtrl_ReceiveInitializeData");b=JSON.parse(b);if(b.eFormDoodlePenOption){exeMirroringReportWebLog("메인 팔레트 옵션 설정 시작.");exeMirroringEForm.setEFormDoodlePenColor(b.eFormDoodlePenOption.penWidth,b.eFormDoodlePenOption.penColor,b.eFormDoodlePenOption.penOpacity);exeMirroringReportWebLog("메인 팔레트 옵션 설정 완료.");}}};window.MainWebBrowserCtrl_GetSelectPageNumber=function(){return exeMirroringEForm.getSelectPageNumber();};window.MainWebBrowserCtrl_GetTotalPageCount=function(){return exeMirroringEForm.getTotalPageCount();};window.MainWebBrowserCtrl_GetFormPageInfo=function(){var b={selectPageNumber:exeMirroringEForm.getSelectPageNumber(),totalPageCount:exeMirroringEForm.getTotalPageCount()};return JSON.stringify(b);};window.MainWebBrowserCtrl_CallSubReport=function(){exeMirroringReportWebLog("서브 이폼 호출을 시작합니다.");if(exeMirroringEForm!=null){exeMirroringReportWebLog("Uid="+exeMirroringEForm.getReportKey());}exeMirroringEForm.callSubReport();exeMirroringReportWebLog("서브 이폼 호출을 완료하였습니다.");};window.MainWebBrowserCtrl_MenuEnable=function(){exeMirroringEForm.disabledMenu(false);};window.MainWebBrowserCtrl_SetEFormDoodlePalletOption=function(c){if(exeMirroringTabPlugin==null){var b=JSON.parse(c);exeMirroringEForm.setEFormDoodlePenColor(b.penWidth,b.penColor,b.penOpacity);}};window.MainWebBrowserCtrl_SaveButtonDisabled=function(b){exeMirroringEForm.setExeSaveButtonDisabled(b);};window.MainWebBrowserCtrl_ZoomPointDrawingCircle=function(b){exeMirroringEForm.ZoomPointDrawingCircle(b);};window.MainWebBrowserCtrl_TabDisabledButton=function(b){if(exeMirroringTabPlugin!=null){exeMirroringTabPlugin.setDisabledButton(b);}};window.MainWebBrowserCtrl_CreateZoomScreenLock=function(){exeMirroringReportWebLog("Start MainWebBrowserCtrl_CreateZoomScreenLock");exeMirroringEForm.createZoomScreenLock();exeMirroringReportWebLog("End MainWebBrowserCtrl_CreateZoomScreenLock");};window.MainWebBrowserCtrl_RemoveZoomScreenLock=function(){exeMirroringReportWebLog("Start MainWebBrowserCtrl_RemoveZoomScreenLock");exeMirroringEForm.removeZoomScreenLock();exeMirroringReportWebLog("End MainWebBrowserCtrl_RemoveZoomScreenLock");};window.MainWebBrowserCtrl_CloseWebSocket=function(){exeMirroringEForm.multiView.socket.abort();};}function SubWebBrowserCtrl_InitializeEvent(a){if(exeMirroringTabPlugin!=null){if(exeMirroringEForm!=null&&exeMirroringEForm.isAppendSelect){exeMirroringEForm=a;}}else{exeMirroringEForm=a;}window.SubWebBrowserCtrl_GetViewSizeInfo=function(){return exeMirroringEForm.getViewSizeInfo();};window.SubWebBrowserCtrl_CreateScreenLock=function(){exeMirroringEForm.mRe_createBlockScreen();};window.SubWebBrowserCtrl_RemoveScreenLock=function(){exeMirroringEForm.mRe_removeBlockScreen();};window.SubWebBrowserCtrl_CloseWebSocket=function(){exeMirroringEForm.multiView.socket.abort();};window.SubWebBrowserCtrl_ReceiveInitializeData=function(b){if(exeMirroringTabPlugin==null){exeMirroringReportWebLog("SubWebBrowserCtrl_ReceiveInitializeData");b=JSON.parse(b);if(b.eFormDoodlePenOption){exeMirroringReportWebLog("서브 팔레트 옵션 설정 시작.");exeMirroringEForm.setEFormDoodlePenColor(b.eFormDoodlePenOption.penWidth,b.eFormDoodlePenOption.penColor,b.eFormDoodlePenOption.penOpacity);exeMirroringReportWebLog("서브 팔레트 옵션 설정 완료.");}}};window.SubWebBrowserCtrl_IsMenuHidden=function(){return exeMirroringEForm.IsMenuHidden();};window.SubWebBrowserCtrl_SetEFormDoodlePalletOption=function(c){if(exeMirroringTabPlugin==null){var b=JSON.parse(c);exeMirroringEForm.setEFormDoodlePenColor(b.penWidth,b.penColor,b.penOpacity);}};window.SubWebBrowserCtrl_ZoomResize=function(b){exeMirroringEForm.exeEFormZoom(b);};window.SubWebBrowserCtrl_EndZoom=function(){exeMirroringEForm.exeEFormEndZoom();};window.SubWebBrowserCtrl_ImmediatelyZoom=function(b){return exeMirroringEForm.exeImmediatelyZoom(b);};window.SubWebBrowserCtrl_Scroll=function(b){exeMirroringEForm.exeEFormScroll(b);};window.SubWebBrowserCtrl_ChangeDefaultSize=function(){exeMirroringEForm.exeEFormChangeDefaultSize();};window.SubWebBrowserCtrl_GetCurrentScale=function(){return exeMirroringEForm.getCurrentScale();};window.SubWebBrowserCtrl_IsOpenEFormDoodle=function(){var b={result:exeMirroringEForm.eFormDoodleOption.is_Ds};return JSON.stringify(b);};window.SubWebBrowserCtrl_IsEFormDoodleEraser=function(){var b={result:exeMirroringEForm.eFormDoodleOption.is_eraser};return JSON.stringify(b);};window.SubWebBrowserCtrl_EFormDoodle=function(){exeMirroringReportWebLog("Start EFormDoodle 서식Uid="+exeMirroringEForm.getReportKey());exeMirroringEForm.EFormDoodle();exeMirroringReportWebLog("End EFormDoodle");};window.SubWebBrowserCtrl_CloseDoodle=function(){exeMirroringEForm.closeDoodle();};window.SubWebBrowserCtrl_PenDoodle=function(){exeMirroringEForm.penDoodle();};window.SubWebBrowserCtrl_PalletDoodle=function(){exeMirroringEForm.palletDoodle();};window.SubWebBrowserCtrl_EraserDoodle=function(){exeMirroringEForm.eraserDoodle();};window.SubWebBrowserCtrl_EraserAllDoodle=function(){exeMirroringEForm.eraserAllDoodle();};window.SubWebBrowserCtrl_PrevDoodlePage=function(){exeMirroringEForm.previousDoodlePage("exe_page_move");};window.SubWebBrowserCtrl_NextDoodlePage=function(){exeMirroringEForm.nextDoodlePage("exe_page_move");};window.SubWebBrowserCtrl_PageMove=function(b){exeMirroringEForm.pageMove(b,"exe_page_move");};window.SubWebBrowserCtrl_TabDisabledButton=function(b){if(exeMirroringTabPlugin!=null){exeMirroringTabPlugin.setDisabledButton(b);}};}function exeMirroringReportWebLog(a){ReportWebLog("exeMirroring log :: "+a);}(function(b,a){typeof exports==="object"&&typeof module!=="undefined"?module.exports=a():typeof define==="function"&&define.amd?define(a):b.moment=a();}(this,(function(){var cs;function e9(){return cs.apply(null,arguments);}function a1(fD){cs=fD;}function aa(fD){return(fD instanceof Array||Object.prototype.toString.call(fD)==="[object Array]");}function x(fD){return(fD!=null&&Object.prototype.toString.call(fD)==="[object Object]");}function dI(fE,fD){return Object.prototype.hasOwnProperty.call(fE,fD);}function cz(fE){if(Object.getOwnPropertyNames){return Object.getOwnPropertyNames(fE).length===0;}else{var fD;for(fD in fE){if(dI(fE,fD)){return false;}}return true;}}function J(fD){return fD===void 0;}function s(fD){return(typeof fD==="number"||Object.prototype.toString.call(fD)==="[object Number]");}function e2(fD){return(fD instanceof Date||Object.prototype.toString.call(fD)==="[object Date]");}function bz(fD,fG){var fF=[],fE;for(fE=0;fE<fD.length;++fE){fF.push(fG(fD[fE],fE));}return fF;}function fu(fE,fD){for(var fF in fD){if(dI(fD,fF)){fE[fF]=fD[fF];}}if(dI(fD,"toString")){fE.toString=fD.toString;}if(dI(fD,"valueOf")){fE.valueOf=fD.valueOf;}return fE;}function cO(fF,fG,fD,fE){return ak(fF,fG,fD,fE,true).utc();}function cK(){return{empty:false,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:false,invalidEra:null,invalidMonth:null,invalidFormat:false,userInvalidated:false,iso:false,parsedDateParts:[],era:null,meridiem:null,rfc2822:false,weekdayMismatch:false};}function bn(fD){if(fD._pf==null){fD._pf=cK();}return fD._pf;}var dN;if(Array.prototype.some){dN=Array.prototype.some;}else{dN=function(fE){var fG=Object(this),fD=fG.length>>>0,fF;for(fF=0;fF<fD;fF++){if(fF in fG&&fE.call(this,fG[fF],fF,fG)){return true;}}return false;};}function ax(fE){if(fE._isValid==null){var fF=bn(fE),fG=dN.call(fF.parsedDateParts,function(fH){return fH!=null;}),fD=!isNaN(fE._d.getTime())&&fF.overflow<0&&!fF.empty&&!fF.invalidEra&&!fF.invalidMonth&&!fF.invalidWeekday&&!fF.weekdayMismatch&&!fF.nullInput&&!fF.invalidFormat&&!fF.userInvalidated&&(!fF.meridiem||(fF.meridiem&&fG));if(fE._strict){fD=fD&&fF.charsLeftOver===0&&fF.unusedTokens.length===0&&fF.bigHour===undefined;}if(Object.isFrozen==null||!Object.isFrozen(fE)){fE._isValid=fD;}else{return fD;}}return fE._isValid;}function R(fE){var fD=cO(NaN);if(fE!=null){fu(bn(fD),fE);}else{bn(fD).userInvalidated=true;}return fD;}var df=(e9.momentProperties=[]),dB=false;function r(fH,fG){var fD,fF,fE;if(!J(fG._isAMomentObject)){fH._isAMomentObject=fG._isAMomentObject;}if(!J(fG._i)){fH._i=fG._i;}if(!J(fG._f)){fH._f=fG._f;}if(!J(fG._l)){fH._l=fG._l;}if(!J(fG._strict)){fH._strict=fG._strict;}if(!J(fG._tzm)){fH._tzm=fG._tzm;}if(!J(fG._isUTC)){fH._isUTC=fG._isUTC;}if(!J(fG._offset)){fH._offset=fG._offset;}if(!J(fG._pf)){fH._pf=bn(fG);}if(!J(fG._locale)){fH._locale=fG._locale;}if(df.length>0){for(fD=0;fD<df.length;fD++){fF=df[fD];fE=fG[fF];if(!J(fE)){fH[fF]=fE;}}}return fH;}function eW(fD){r(this,fD);this._d=new Date(fD._d!=null?fD._d.getTime():NaN);if(!this.isValid()){this._d=new Date(NaN);}if(dB===false){dB=true;e9.updateOffset(this);dB=false;}}function ct(fD){return(fD instanceof eW||(fD!=null&&fD._isAMomentObject!=null));}function dA(fD){if(e9.suppressDeprecationWarnings===false&&typeof console!=="undefined"&&console.warn){console.warn("Deprecation warning: "+fD);}}function eJ(fE,fD){var fF=true;return fu(function(){if(e9.deprecationHandler!=null){e9.deprecationHandler(null,fE);}if(fF){var fH=[],fG,fJ,fI;for(fJ=0;fJ<arguments.length;fJ++){fG="";if(typeof arguments[fJ]==="object"){fG+="\n["+fJ+"] ";for(fI in arguments[0]){if(dI(arguments[0],fI)){fG+=fI+": "+arguments[0][fI]+", ";}}fG=fG.slice(0,-2);}else{fG=arguments[fJ];}fH.push(fG);}dA(fE+"\nArguments: "+Array.prototype.slice.call(fH).join("")+"\n"+new Error().stack);fF=false;}return fD.apply(this,arguments);},fD);}var ai={};function fm(fD,fE){if(e9.deprecationHandler!=null){e9.deprecationHandler(fD,fE);}if(!ai[fD]){dA(fE);ai[fD]=true;}}e9.suppressDeprecationWarnings=false;e9.deprecationHandler=null;function bi(fD){return((typeof Function!=="undefined"&&fD instanceof Function)||Object.prototype.toString.call(fD)==="[object Function]");}function dL(fD){var fF,fE;for(fE in fD){if(dI(fD,fE)){fF=fD[fE];if(bi(fF)){this[fE]=fF;}else{this["_"+fE]=fF;}}}this._config=fD;this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source);}function eA(fF,fD){var fE=fu({},fF),fG;for(fG in fD){if(dI(fD,fG)){if(x(fF[fG])&&x(fD[fG])){fE[fG]={};fu(fE[fG],fF[fG]);fu(fE[fG],fD[fG]);}else{if(fD[fG]!=null){fE[fG]=fD[fG];}else{delete fE[fG];}}}}for(fG in fF){if(dI(fF,fG)&&!dI(fD,fG)&&x(fF[fG])){fE[fG]=fu({},fE[fG]);}}return fE;}function cV(fD){if(fD!=null){this.set(fD);}}var cb;if(Object.keys){cb=Object.keys;}else{cb=function(fF){var fE,fD=[];for(fE in fF){if(dI(fF,fE)){fD.push(fE);}}return fD;};}var cB={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function f(fF,fG,fE){var fD=this._calendar[fF]||this._calendar.sameElse;return bi(fD)?fD.call(fG,fE):fD;}function cG(fI,fH,fE){var fG=""+Math.abs(fI),fF=fH-fG.length,fD=fI>=0;return((fD?(fE?"+":""):"-")+Math.pow(10,Math.max(0,fF)).toString().substr(1)+fG);}var b4=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,b3=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,b2={},bl={};function cQ(fE,fF,fD,fH){var fG=fH;if(typeof fH==="string"){fG=function(){return this[fH]();};}if(fE){bl[fE]=fG;}if(fF){bl[fF[0]]=function(){return cG(fG.apply(this,arguments),fF[1],fF[2]);};}if(fD){bl[fD]=function(){return this.localeData().ordinal(fG.apply(this,arguments),fE);};}}function aF(fD){if(fD.match(/\[[\s\S]/)){return fD.replace(/^\[|\]$/g,"");}return fD.replace(/\\/g,"");}function bL(fF){var fG=fF.match(b4),fD,fE;for(fD=0,fE=fG.length;fD<fE;fD++){if(bl[fG[fD]]){fG[fD]=bl[fG[fD]];}else{fG[fD]=aF(fG[fD]);}}return function(fJ){var fH="",fI;for(fI=0;fI<fE;fI++){fH+=bi(fG[fI])?fG[fI].call(fJ,fF):fG[fI];}return fH;};}function an(fD,fE){if(!fD.isValid()){return fD.localeData().invalidDate();}fE=bT(fE,fD.localeData());b2[fE]=b2[fE]||bL(fE);return b2[fE](fD);}function bT(fG,fD){var fE=5;function fF(fH){return fD.longDateFormat(fH)||fH;}b3.lastIndex=0;while(fE>=0&&b3.test(fG)){fG=fG.replace(b3,fF);b3.lastIndex=0;fE-=1;}return fG;}var em={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function c5(fD){var fE=this._longDateFormat[fD],fF=this._longDateFormat[fD.toUpperCase()];if(fE||!fF){return fE;}this._longDateFormat[fD]=fF.match(b4).map(function(fG){if(fG==="MMMM"||fG==="MM"||fG==="DD"||fG==="dddd"){return fG.slice(1);}return fG;}).join("");return this._longDateFormat[fD];}var av="Invalid date";function eU(){return this._invalidDate;}var cn="%d",fA=/\d{1,2}/;function e7(fD){return this._ordinal.replace("%d",fD);}var e6={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function Y(fG,fF,fE,fH){var fD=this._relativeTime[fE];return bi(fD)?fD(fG,fF,fE,fH):fD.replace(/%d/i,fG);}function eo(fF,fD){var fE=this._relativeTime[fF>0?"future":"past"];return bi(fE)?fE(fD):fE.replace(/%s/i,fD);}var c6={};function cw(fF,fD){var fE=fF.toLowerCase();c6[fE]=c6[fE+"s"]=c6[fD]=fF;}function db(fD){return typeof fD==="string"?c6[fD]||c6[fD.toLowerCase()]:undefined;}function ea(fF){var fE={},fD,fG;for(fG in fF){if(dI(fF,fG)){fD=db(fG);if(fD){fE[fD]=fF[fG];}}}return fE;}var bF={};function el(fE,fD){bF[fE]=fD;}function bD(fD){var fE=[],fF;for(fF in fD){if(dI(fD,fF)){fE.push({unit:fF,priority:bF[fF]});}}fE.sort(function(fH,fG){return fH.priority-fG.priority;});return fE;}function ep(fD){return(fD%4===0&&fD%100!==0)||fD%400===0;}function dF(fD){if(fD<0){return Math.ceil(fD)||0;}else{return Math.floor(fD);}}function dc(fD){var fF=+fD,fE=0;if(fF!==0&&isFinite(fF)){fE=dF(fF);}return fE;}function eF(fD,fE){return function(fF){if(fF!=null){aW(this,fD,fF);e9.updateOffset(this,fE);return this;}else{return d0(this,fD);}};}function d0(fE,fD){return fE.isValid()?fE._d["get"+(fE._isUTC?"UTC":"")+fD]():NaN;}function aW(fE,fD,fF){if(fE.isValid()&&!isNaN(fF)){if(fD==="FullYear"&&ep(fE.year())&&fE.month()===1&&fE.date()===29){fF=dc(fF);fE._d["set"+(fE._isUTC?"UTC":"")+fD](fF,fE.month(),bU(fF,fE.month()));}else{fE._d["set"+(fE._isUTC?"UTC":"")+fD](fF);}}}function aI(fD){fD=db(fD);if(bi(this[fD])){return this[fD]();}return this;}function aC(fD,fG){if(typeof fD==="object"){fD=ea(fD);var fF=bD(fD),fE;for(fE=0;fE<fF.length;fE++){this[fF[fE].unit](fD[fF[fE].unit]);}}else{fD=db(fD);if(bi(this[fD])){return this[fD](fG);}}return this;}var aU=/\d/,aT=/\d\d/,aS=/\d{3}/,aR=/\d{4}/,aQ=/[+-]?\d{6}/,aA=/\d\d?/,cC=/\d\d\d\d?/,eH=/\d\d\d\d\d\d?/,az=/\d{1,3}/,ay=/\d{1,4}/,aw=/[+-]?\d{1,6}/,t=/\d+/,D=/[+-]?\d+/,bV=/Z|[+-]\d\d:?\d\d/gi,cX=/Z|[+-]\d\d(?::?\d\d)?/gi,fn=/[+-]?\d+(\.\d{1,3})?/,bk=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,be;be={};function bp(fD,fE,fF){be[fD]=bi(fE)?fE:function(fH,fG){return fH&&fF?fF:fE;};}function bS(fE,fD){if(!dI(be,fE)){return new RegExp(dG(fE));}return be[fE](fD._strict,fD._locale);}function dG(fD){return cy(fD.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(fE,fI,fH,fG,fF){return fI||fH||fG||fF;}));}function cy(fD){return fD.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&");}var i={};function b8(fE,fG){var fD,fF=fG;if(typeof fE==="string"){fE=[fE];}if(s(fG)){fF=function(fH,fI){fI[fG]=dc(fH);};}for(fD=0;fD<fE.length;fD++){i[fE[fD]]=fF;}}function ad(fD,fE){b8(fD,function(fF,fI,fG,fH){fG._w=fG._w||{};fE(fF,fG._w,fG,fH);});}function w(fF,fD,fE){if(fD!=null&&dI(i,fF)){i[fF](fD,fE._a,fE,fF);}}var fo=0,k=1,e0=2,fd=3,d7=4,ar=5,bX=6,cA=7,j=8;function eE(fE,fD){return((fE%fD)+fD)%fD;}var dd;if(Array.prototype.indexOf){dd=Array.prototype.indexOf;}else{dd=function(fE){var fD;for(fD=0;fD<this.length;++fD){if(this[fD]===fE){return fD;}}return -1;};}function bU(fE,fF){if(isNaN(fE)||isNaN(fF)){return NaN;}var fD=eE(fF,12);fE+=(fF-fD)/12;return fD===1?ep(fE)?29:28:31-((fD%7)%2);}cQ("M",["MM",2],"Mo",function(){return this.month()+1;});cQ("MMM",0,0,function(fD){return this.localeData().monthsShort(this,fD);});cQ("MMMM",0,0,function(fD){return this.localeData().months(this,fD);});cw("month","M");el("month",8);bp("M",aA);bp("MM",aA,aT);bp("MMM",function(fE,fD){return fD.monthsShortRegex(fE);});bp("MMMM",function(fE,fD){return fD.monthsRegex(fE);});b8(["M","MM"],function(fD,fE){fE[k]=dc(fD)-1;});b8(["MMM","MMMM"],function(fD,fH,fE,fF){var fG=fE._locale.monthsParse(fD,fF,fE._strict);if(fG!=null){fH[k]=fG;}else{bn(fE).invalidMonth=fD;}});var T="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),er="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),ck=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,dD=bk,e4=bk;function bc(fD,fE){if(!fD){return aa(this._months)?this._months:this._months.standalone;}return aa(this._months)?this._months[fD.month()]:this._months[(this._months.isFormat||ck).test(fE)?"format":"standalone"][fD.month()];}function bm(fD,fE){if(!fD){return aa(this._monthsShort)?this._monthsShort:this._monthsShort.standalone;}return aa(this._monthsShort)?this._monthsShort[fD.month()]:this._monthsShort[ck.test(fE)?"format":"standalone"][fD.month()];}function bQ(fE,fJ,fD){var fG,fH,fI,fF=fE.toLocaleLowerCase();if(!this._monthsParse){this._monthsParse=[];this._longMonthsParse=[];this._shortMonthsParse=[];for(fG=0;fG<12;++fG){fI=cO([2000,fG]);this._shortMonthsParse[fG]=this.monthsShort(fI,"").toLocaleLowerCase();this._longMonthsParse[fG]=this.months(fI,"").toLocaleLowerCase();}}if(fD){if(fJ==="MMM"){fH=dd.call(this._shortMonthsParse,fF);return fH!==-1?fH:null;}else{fH=dd.call(this._longMonthsParse,fF);return fH!==-1?fH:null;}}else{if(fJ==="MMM"){fH=dd.call(this._shortMonthsParse,fF);if(fH!==-1){return fH;}fH=dd.call(this._longMonthsParse,fF);return fH!==-1?fH:null;}else{fH=dd.call(this._longMonthsParse,fF);if(fH!==-1){return fH;}fH=dd.call(this._shortMonthsParse,fF);return fH!==-1?fH:null;}}}function dy(fE,fI,fD){var fF,fH,fG;if(this._monthsParseExact){return bQ.call(this,fE,fI,fD);}if(!this._monthsParse){this._monthsParse=[];this._longMonthsParse=[];this._shortMonthsParse=[];}for(fF=0;fF<12;fF++){fH=cO([2000,fF]);if(fD&&!this._longMonthsParse[fF]){this._longMonthsParse[fF]=new RegExp("^"+this.months(fH,"").replace(".","")+"$","i");this._shortMonthsParse[fF]=new RegExp("^"+this.monthsShort(fH,"").replace(".","")+"$","i");}if(!fD&&!this._monthsParse[fF]){fG="^"+this.months(fH,"")+"|^"+this.monthsShort(fH,"");this._monthsParse[fF]=new RegExp(fG.replace(".",""),"i");}if(fD&&fI==="MMMM"&&this._longMonthsParse[fF].test(fE)){return fF;}else{if(fD&&fI==="MMM"&&this._shortMonthsParse[fF].test(fE)){return fF;}else{if(!fD&&this._monthsParse[fF].test(fE)){return fF;}}}}}function a5(fD,fE){var fF;if(!fD.isValid()){return fD;}if(typeof fE==="string"){if(/^\d+$/.test(fE)){fE=dc(fE);}else{fE=fD.localeData().monthsParse(fE);if(!s(fE)){return fD;}}}fF=Math.min(fD.date(),bU(fD.year(),fE));fD._d["set"+(fD._isUTC?"UTC":"")+"Month"](fE,fF);return fD;}function fc(fD){if(fD!=null){a5(this,fD);e9.updateOffset(this,true);return this;}else{return d0(this,"Month");}}function b0(){return bU(this.year(),this.month());}function dH(fD){if(this._monthsParseExact){if(!dI(this,"_monthsRegex")){dJ.call(this);}if(fD){return this._monthsShortStrictRegex;}else{return this._monthsShortRegex;}}else{if(!dI(this,"_monthsShortRegex")){this._monthsShortRegex=dD;}return this._monthsShortStrictRegex&&fD?this._monthsShortStrictRegex:this._monthsShortRegex;}}function dl(fD){if(this._monthsParseExact){if(!dI(this,"_monthsRegex")){dJ.call(this);}if(fD){return this._monthsStrictRegex;}else{return this._monthsRegex;}}else{if(!dI(this,"_monthsRegex")){this._monthsRegex=e4;}return this._monthsStrictRegex&&fD?this._monthsStrictRegex:this._monthsRegex;}}function dJ(){function fI(fK,fJ){return fJ.length-fK.length;}var fH=[],fD=[],fG=[],fE,fF;for(fE=0;fE<12;fE++){fF=cO([2000,fE]);fH.push(this.monthsShort(fF,""));fD.push(this.months(fF,""));fG.push(this.months(fF,""));fG.push(this.monthsShort(fF,""));}fH.sort(fI);fD.sort(fI);fG.sort(fI);for(fE=0;fE<12;fE++){fH[fE]=cy(fH[fE]);fD[fE]=cy(fD[fE]);}for(fE=0;fE<24;fE++){fG[fE]=cy(fG[fE]);}this._monthsRegex=new RegExp("^("+fG.join("|")+")","i");this._monthsShortRegex=this._monthsRegex;this._monthsStrictRegex=new RegExp("^("+fD.join("|")+")","i");this._monthsShortStrictRegex=new RegExp("^("+fH.join("|")+")","i");}cQ("Y",0,0,function(){var fD=this.year();return fD<=9999?cG(fD,4):"+"+fD;});cQ(0,["YY",2],0,function(){return this.year()%100;});cQ(0,["YYYY",4],0,"year");cQ(0,["YYYYY",5],0,"year");cQ(0,["YYYYYY",6,true],0,"year");cw("year","y");el("year",1);bp("Y",D);bp("YY",aA,aT);bp("YYYY",ay,aR);bp("YYYYY",aw,aQ);bp("YYYYYY",aw,aQ);b8(["YYYYY","YYYYYY"],fo);b8("YYYY",function(fD,fE){fE[fo]=fD.length===2?e9.parseTwoDigitYear(fD):dc(fD);});b8("YY",function(fD,fE){fE[fo]=e9.parseTwoDigitYear(fD);});b8("Y",function(fD,fE){fE[fo]=parseInt(fD,10);});function d5(fD){return ep(fD)?366:365;}e9.parseTwoDigitYear=function(fD){return dc(fD)+(dc(fD)>68?1900:2000);};var cZ=eF("FullYear",true);function di(){return ep(this.year());}function eB(fK,fD,fI,fH,fJ,fG,fF){var fE;if(fK<100&&fK>=0){fE=new Date(fK+400,fD,fI,fH,fJ,fG,fF);if(isFinite(fE.getFullYear())){fE.setFullYear(fK);}}else{fE=new Date(fK,fD,fI,fH,fJ,fG,fF);}return fE;}function dU(fF){var fE,fD;if(fF<100&&fF>=0){fD=Array.prototype.slice.call(arguments);fD[0]=fF+400;fE=new Date(Date.UTC.apply(null,fD));if(isFinite(fE.getUTCFullYear())){fE.setUTCFullYear(fF);}}else{fE=new Date(Date.UTC.apply(null,arguments));}return fE;}function bu(fE,fH,fG){var fD=7+fH-fG,fF=(7+dU(fE,0,fD).getUTCDay()-fH)%7;return -fF+fD-1;}function bO(fG,fE,fF,fM,fK){var fL=(7+fF-fM)%7,fD=bu(fG,fM,fK),fI=1+7*(fE-1)+fL+fD,fJ,fH;if(fI<=0){fJ=fG-1;fH=d5(fJ)+fI;}else{if(fI>d5(fG)){fJ=fG+1;fH=fI-d5(fG);}else{fJ=fG;fH=fI;}}return{year:fJ,dayOfYear:fH};}function eY(fH,fJ,fI){var fF=bu(fH.year(),fJ,fI),fG=Math.floor((fH.dayOfYear()-fF-1)/7)+1,fD,fE;if(fG<1){fE=fH.year()-1;fD=fG+G(fE,fJ,fI);}else{if(fG>G(fH.year(),fJ,fI)){fD=fG-G(fH.year(),fJ,fI);fE=fH.year()+1;}else{fE=fH.year();fD=fG;}}return{week:fD,year:fE};}function G(fE,fH,fF){var fD=bu(fE,fH,fF),fG=bu(fE+1,fH,fF);return(d5(fE)-fD+fG)/7;}cQ("w",["ww",2],"wo","week");cQ("W",["WW",2],"Wo","isoWeek");cw("week","w");cw("isoWeek","W");el("week",5);el("isoWeek",5);bp("w",aA);bp("ww",aA,aT);bp("W",aA);bp("WW",aA,aT);ad(["w","ww","W","WW"],function(fD,fG,fE,fF){fG[fF.substr(0,1)]=dc(fD);});function bB(fD){return eY(fD,this._week.dow,this._week.doy).week;}var cj={dow:0,doy:6};function ap(){return this._week.dow;}function dw(){return this._week.doy;}function N(fD){var fE=this.localeData().week(this);return fD==null?fE:this.add((fD-fE)*7,"d");}function z(fD){var fE=eY(this,1,4).week;return fD==null?fE:this.add((fD-fE)*7,"d");}cQ("d",0,"do","day");cQ("dd",0,0,function(fD){return this.localeData().weekdaysMin(this,fD);});cQ("ddd",0,0,function(fD){return this.localeData().weekdaysShort(this,fD);});cQ("dddd",0,0,function(fD){return this.localeData().weekdays(this,fD);});cQ("e",0,0,"weekday");cQ("E",0,0,"isoWeekday");cw("day","d");cw("weekday","e");cw("isoWeekday","E");el("day",11);el("weekday",11);el("isoWeekday",11);bp("d",aA);bp("e",aA);bp("E",aA);bp("dd",function(fE,fD){return fD.weekdaysMinRegex(fE);});bp("ddd",function(fE,fD){return fD.weekdaysShortRegex(fE);});bp("dddd",function(fE,fD){return fD.weekdaysRegex(fE);});ad(["dd","ddd","dddd"],function(fD,fG,fE,fF){var fH=fE._locale.weekdaysParse(fD,fF,fE._strict);if(fH!=null){fG.d=fH;}else{bn(fE).invalidWeekday=fD;}});ad(["d","e","E"],function(fD,fG,fE,fF){fG[fF]=dc(fD);});function bt(fE,fD){if(typeof fE!=="string"){return fE;}if(!isNaN(fE)){return parseInt(fE,10);}fE=fD.weekdaysParse(fE);if(typeof fE==="number"){return fE;}return null;}function bR(fE,fD){if(typeof fE==="string"){return fD.weekdaysParse(fE)%7||7;}return isNaN(fE)?null:fE;}function cq(fD,fE){return fD.slice(fE,7).concat(fD.slice(0,fE));}var X="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),m="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),bG="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),aj=bk,y=bk,ej=bk;function aG(fD,fF){var fE=aa(this._weekdays)?this._weekdays:this._weekdays[fD&&fD!==true&&this._weekdays.isFormat.test(fF)?"format":"standalone"];return fD===true?cq(fE,this._week.dow):fD?fE[fD.day()]:fE;}function Q(fD){return fD===true?cq(this._weekdaysShort,this._week.dow):fD?this._weekdaysShort[fD.day()]:this._weekdaysShort;}function fa(fD){return fD===true?cq(this._weekdaysMin,this._week.dow):fD?this._weekdaysMin[fD.day()]:this._weekdaysMin;}function ec(fI,fJ,fD){var fF,fG,fH,fE=fI.toLocaleLowerCase();if(!this._weekdaysParse){this._weekdaysParse=[];this._shortWeekdaysParse=[];this._minWeekdaysParse=[];for(fF=0;fF<7;++fF){fH=cO([2000,1]).day(fF);this._minWeekdaysParse[fF]=this.weekdaysMin(fH,"").toLocaleLowerCase();this._shortWeekdaysParse[fF]=this.weekdaysShort(fH,"").toLocaleLowerCase();this._weekdaysParse[fF]=this.weekdays(fH,"").toLocaleLowerCase();}}if(fD){if(fJ==="dddd"){fG=dd.call(this._weekdaysParse,fE);return fG!==-1?fG:null;}else{if(fJ==="ddd"){fG=dd.call(this._shortWeekdaysParse,fE);return fG!==-1?fG:null;}else{fG=dd.call(this._minWeekdaysParse,fE);return fG!==-1?fG:null;}}}else{if(fJ==="dddd"){fG=dd.call(this._weekdaysParse,fE);if(fG!==-1){return fG;}fG=dd.call(this._shortWeekdaysParse,fE);if(fG!==-1){return fG;}fG=dd.call(this._minWeekdaysParse,fE);return fG!==-1?fG:null;}else{if(fJ==="ddd"){fG=dd.call(this._shortWeekdaysParse,fE);if(fG!==-1){return fG;}fG=dd.call(this._weekdaysParse,fE);if(fG!==-1){return fG;}fG=dd.call(this._minWeekdaysParse,fE);return fG!==-1?fG:null;}else{fG=dd.call(this._minWeekdaysParse,fE);if(fG!==-1){return fG;}fG=dd.call(this._weekdaysParse,fE);if(fG!==-1){return fG;}fG=dd.call(this._shortWeekdaysParse,fE);return fG!==-1?fG:null;}}}}function bZ(fH,fI,fD){var fE,fG,fF;if(this._weekdaysParseExact){return ec.call(this,fH,fI,fD);}if(!this._weekdaysParse){this._weekdaysParse=[];this._minWeekdaysParse=[];this._shortWeekdaysParse=[];this._fullWeekdaysParse=[];}for(fE=0;fE<7;fE++){fG=cO([2000,1]).day(fE);if(fD&&!this._fullWeekdaysParse[fE]){this._fullWeekdaysParse[fE]=new RegExp("^"+this.weekdays(fG,"").replace(".","\\.?")+"$","i");this._shortWeekdaysParse[fE]=new RegExp("^"+this.weekdaysShort(fG,"").replace(".","\\.?")+"$","i");this._minWeekdaysParse[fE]=new RegExp("^"+this.weekdaysMin(fG,"").replace(".","\\.?")+"$","i");}if(!this._weekdaysParse[fE]){fF="^"+this.weekdays(fG,"")+"|^"+this.weekdaysShort(fG,"")+"|^"+this.weekdaysMin(fG,"");this._weekdaysParse[fE]=new RegExp(fF.replace(".",""),"i");}if(fD&&fI==="dddd"&&this._fullWeekdaysParse[fE].test(fH)){return fE;}else{if(fD&&fI==="ddd"&&this._shortWeekdaysParse[fE].test(fH)){return fE;}else{if(fD&&fI==="dd"&&this._minWeekdaysParse[fE].test(fH)){return fE;}else{if(!fD&&this._weekdaysParse[fE].test(fH)){return fE;}}}}}}function eP(fE){if(!this.isValid()){return fE!=null?this:NaN;}var fD=this._isUTC?this._d.getUTCDay():this._d.getDay();if(fE!=null){fE=bt(fE,this.localeData());return this.add(fE-fD,"d");}else{return fD;}}function al(fD){if(!this.isValid()){return fD!=null?this:NaN;}var fE=(this.day()+7-this.localeData()._week.dow)%7;return fD==null?fE:this.add(fD-fE,"d");}function cM(fD){if(!this.isValid()){return fD!=null?this:NaN;}if(fD!=null){var fE=bR(fD,this.localeData());return this.day(this.day()%7?fE:fE-7);}else{return this.day()||7;}}function fq(fD){if(this._weekdaysParseExact){if(!dI(this,"_weekdaysRegex")){B.call(this);}if(fD){return this._weekdaysStrictRegex;}else{return this._weekdaysRegex;}}else{if(!dI(this,"_weekdaysRegex")){this._weekdaysRegex=aj;}return this._weekdaysStrictRegex&&fD?this._weekdaysStrictRegex:this._weekdaysRegex;}}function aP(fD){if(this._weekdaysParseExact){if(!dI(this,"_weekdaysRegex")){B.call(this);}if(fD){return this._weekdaysShortStrictRegex;}else{return this._weekdaysShortRegex;}}else{if(!dI(this,"_weekdaysShortRegex")){this._weekdaysShortRegex=y;}return this._weekdaysShortStrictRegex&&fD?this._weekdaysShortStrictRegex:this._weekdaysShortRegex;}}function F(fD){if(this._weekdaysParseExact){if(!dI(this,"_weekdaysRegex")){B.call(this);}if(fD){return this._weekdaysMinStrictRegex;}else{return this._weekdaysMinRegex;}}else{if(!dI(this,"_weekdaysMinRegex")){this._weekdaysMinRegex=ej;}return this._weekdaysMinStrictRegex&&fD?this._weekdaysMinStrictRegex:this._weekdaysMinRegex;}}function B(){function fG(fO,fN){return fN.length-fO.length;}var fI=[],fJ=[],fM=[],fD=[],fH,fF,fE,fK,fL;for(fH=0;fH<7;fH++){fF=cO([2000,1]).day(fH);fE=cy(this.weekdaysMin(fF,""));fK=cy(this.weekdaysShort(fF,""));fL=cy(this.weekdays(fF,""));fI.push(fE);fJ.push(fK);fM.push(fL);fD.push(fE);fD.push(fK);fD.push(fL);}fI.sort(fG);fJ.sort(fG);fM.sort(fG);fD.sort(fG);this._weekdaysRegex=new RegExp("^("+fD.join("|")+")","i");this._weekdaysShortRegex=this._weekdaysRegex;this._weekdaysMinRegex=this._weekdaysRegex;this._weekdaysStrictRegex=new RegExp("^("+fM.join("|")+")","i");this._weekdaysShortStrictRegex=new RegExp("^("+fJ.join("|")+")","i");this._weekdaysMinStrictRegex=new RegExp("^("+fI.join("|")+")","i");}function dY(){return this.hours()%12||12;}function S(){return this.hours()||24;}cQ("H",["HH",2],0,"hour");cQ("h",["hh",2],0,dY);cQ("k",["kk",2],0,S);cQ("hmm",0,0,function(){return""+dY.apply(this)+cG(this.minutes(),2);});cQ("hmmss",0,0,function(){return(""+dY.apply(this)+cG(this.minutes(),2)+cG(this.seconds(),2));});cQ("Hmm",0,0,function(){return""+this.hours()+cG(this.minutes(),2);});cQ("Hmmss",0,0,function(){return(""+this.hours()+cG(this.minutes(),2)+cG(this.seconds(),2));});function eS(fD,fE){cQ(fD,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),fE);});}eS("a",true);eS("A",false);cw("hour","h");el("hour",13);function W(fE,fD){return fD._meridiemParse;}bp("a",W);bp("A",W);bp("H",aA);bp("h",aA);bp("k",aA);bp("HH",aA,aT);bp("hh",aA,aT);bp("kk",aA,aT);bp("hmm",cC);bp("hmmss",eH);bp("Hmm",cC);bp("Hmmss",eH);b8(["H","HH"],fd);b8(["k","kk"],function(fE,fG,fF){var fD=dc(fE);fG[fd]=fD===24?0:fD;});b8(["a","A"],function(fD,fF,fE){fE._isPm=fE._locale.isPM(fD);fE._meridiem=fD;});b8(["h","hh"],function(fD,fF,fE){fF[fd]=dc(fD);bn(fE).bigHour=true;});b8("hmm",function(fD,fG,fE){var fF=fD.length-2;fG[fd]=dc(fD.substr(0,fF));fG[d7]=dc(fD.substr(fF));bn(fE).bigHour=true;});b8("hmmss",function(fD,fH,fE){var fG=fD.length-4,fF=fD.length-2;fH[fd]=dc(fD.substr(0,fG));fH[d7]=dc(fD.substr(fG,2));fH[ar]=dc(fD.substr(fF));bn(fE).bigHour=true;});b8("Hmm",function(fD,fG,fE){var fF=fD.length-2;fG[fd]=dc(fD.substr(0,fF));fG[d7]=dc(fD.substr(fF));});b8("Hmmss",function(fD,fH,fE){var fG=fD.length-4,fF=fD.length-2;fH[fd]=dc(fD.substr(0,fG));fH[d7]=dc(fD.substr(fG,2));fH[ar]=dc(fD.substr(fF));});function cv(fD){return(fD+"").toLowerCase().charAt(0)==="p";}var cm=/[ap]\.?m?\.?/i,cH=eF("Hours",true);function a3(fD,fE,fF){if(fD>11){return fF?"pm":"PM";}else{return fF?"am":"AM";}}var ci={calendar:cB,longDateFormat:em,invalidDate:av,ordinal:cn,dayOfMonthOrdinalParse:fA,relativeTime:e6,months:T,monthsShort:er,week:cj,weekdays:X,weekdaysMin:bG,weekdaysShort:m,meridiemParse:cm};var bM={},n={},dk;function ca(fF,fE){var fG,fD=Math.min(fF.length,fE.length);for(fG=0;fG<fD;fG+=1){if(fF[fG]!==fE[fG]){return fG;}}return fD;}function dM(fD){return fD?fD.toLowerCase().replace("_","-"):fD;}function dj(fI){var fG=0,fE,fH,fD,fF;while(fG<fI.length){fF=dM(fI[fG]).split("-");fE=fF.length;fH=dM(fI[fG+1]);fH=fH?fH.split("-"):null;while(fE>0){fD=aK(fF.slice(0,fE).join("-"));if(fD){return fD;}if(fH&&fH.length>=fE&&ca(fF,fH)>=fE-1){break;}fE--;}fG++;}return dk;}function aK(fD){var fG=null,fE;if(bM[fD]===undefined&&typeof module!=="undefined"&&module&&module.exports){try{fG=dk._abbr;fE=require;fE("./locale/"+fD);C(fG);}catch(fF){bM[fD]=null;}}return bM[fD];}function C(fE,fD){var fF;if(fE){if(J(fD)){fF=U(fE);}else{fF=cT(fE,fD);}if(fF){dk=fF;}else{if(typeof console!=="undefined"&&console.warn){console.warn("Locale "+fE+" not found. Did you forget to load it?");}}}return dk._abbr;}function cT(fF,fE){if(fE!==null){var fD,fG=ci;fE.abbr=fF;if(bM[fF]!=null){fm("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info.");fG=bM[fF]._config;}else{if(fE.parentLocale!=null){if(bM[fE.parentLocale]!=null){fG=bM[fE.parentLocale]._config;}else{fD=aK(fE.parentLocale);if(fD!=null){fG=fD._config;}else{if(!n[fE.parentLocale]){n[fE.parentLocale]=[];}n[fE.parentLocale].push({name:fF,config:fE});return null;}}}}bM[fF]=new cV(eA(fG,fE));if(n[fF]){n[fF].forEach(function(fH){cT(fH.name,fH.config);});}C(fF);return bM[fF];}else{delete bM[fF];return null;}}function eQ(fF,fE){if(fE!=null){var fD,fH,fG=ci;if(bM[fF]!=null&&bM[fF].parentLocale!=null){bM[fF].set(eA(bM[fF]._config,fE));}else{fH=aK(fF);if(fH!=null){fG=fH._config;}fE=eA(fG,fE);if(fH==null){fE.abbr=fF;}fD=new cV(fE);fD.parentLocale=bM[fF];bM[fF]=fD;}C(fF);}else{if(bM[fF]!=null){if(bM[fF].parentLocale!=null){bM[fF]=bM[fF].parentLocale;if(fF===C()){C(fF);}}else{if(bM[fF]!=null){delete bM[fF];}}}}return bM[fF];}function U(fE){var fD;if(fE&&fE._locale&&fE._locale._abbr){fE=fE._locale._abbr;}if(!fE){return dk;}if(!aa(fE)){fD=aK(fE);if(fD){return fD;}fE=[fE];}return dj(fE);}function cl(){return cb(bM);}function c9(fD){var fF,fE=fD._a;if(fE&&bn(fD).overflow===-2){fF=fE[k]<0||fE[k]>11?k:fE[e0]<1||fE[e0]>bU(fE[fo],fE[k])?e0:fE[fd]<0||fE[fd]>24||(fE[fd]===24&&(fE[d7]!==0||fE[ar]!==0||fE[bX]!==0))?fd:fE[d7]<0||fE[d7]>59?d7:fE[ar]<0||fE[ar]>59?ar:fE[bX]<0||fE[bX]>999?bX:-1;if(bn(fD)._overflowDayOfYear&&(fF<fo||fF>e0)){fF=e0;}if(bn(fD)._overflowWeeks&&fF===-1){fF=cA;}if(bn(fD)._overflowWeekday&&fF===-1){fF=j;}bn(fD).overflow=fF;}return fD;}var l=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,a2=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,cY=/Z|[+-]\d\d(?::?\d\d)?/,de=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,false],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,false],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,false],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,false],["YYYY",/\d{4}/,false],],cJ=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/],],b9=/^\/?Date\((-?\d+)/i,dE=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,bH={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function E(fE){var fI,fG,fK=fE._i,fJ=l.exec(fK)||a2.exec(fK),fL,fD,fH,fF;if(fJ){bn(fE).iso=true;for(fI=0,fG=de.length;fI<fG;fI++){if(de[fI][1].exec(fJ[1])){fD=de[fI][0];fL=de[fI][2]!==false;break;}}if(fD==null){fE._isValid=false;return;}if(fJ[3]){for(fI=0,fG=cJ.length;fI<fG;fI++){if(cJ[fI][1].exec(fJ[3])){fH=(fJ[2]||" ")+cJ[fI][0];break;}}if(fH==null){fE._isValid=false;return;}}if(!fL&&fH!=null){fE._isValid=false;return;}if(fJ[4]){if(cY.exec(fJ[4])){fF="Z";}else{fE._isValid=false;return;}}fE._f=fD+(fH||"")+(fF||"");cc(fE);}else{fE._isValid=false;}}function eZ(fH,fG,fI,fE,fJ,fF){var fD=[cF(fH),er.indexOf(fG),parseInt(fI,10),parseInt(fE,10),parseInt(fJ,10),];if(fF){fD.push(parseInt(fF,10));}return fD;}function cF(fD){var fE=parseInt(fD,10);if(fE<=49){return 2000+fE;}else{if(fE<=999){return 1900+fE;}}return fE;}function aV(fD){return fD.replace(/\([^)]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"");}function aE(fD,fH,fF){if(fD){var fG=m.indexOf(fD),fE=new Date(fH[0],fH[1],fH[2]).getDay();if(fG!==fE){bn(fF).weekdayMismatch=true;fF._isValid=false;return false;}}return true;}function fx(fI,fE,fG){if(fI){return bH[fI];}else{if(fE){return 0;}else{var fH=parseInt(fG,10),fD=fH%100,fF=(fH-fD)/100;return fF*60+fD;}}}function b6(fE){var fD=dE.exec(aV(fE._i)),fF;if(fD){fF=eZ(fD[4],fD[3],fD[2],fD[5],fD[6],fD[7]);if(!aE(fD[1],fF,fE)){return;}fE._a=fF;fE._tzm=fx(fD[8],fD[9],fD[10]);fE._d=dU.apply(null,fE._a);fE._d.setUTCMinutes(fE._d.getUTCMinutes()-fE._tzm);bn(fE).rfc2822=true;}else{fE._isValid=false;}}function bo(fE){var fD=b9.exec(fE._i);if(fD!==null){fE._d=new Date(+fD[1]);return;}E(fE);if(fE._isValid===false){delete fE._isValid;}else{return;}b6(fE);if(fE._isValid===false){delete fE._isValid;}else{return;}if(fE._strict){fE._isValid=false;}else{e9.createFromInputFallback(fE);}}e9.createFromInputFallback=eJ("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(fD){fD._d=new Date(fD._i+(fD._useUTC?" UTC":""));});function eC(fE,fD,fF){if(fE!=null){return fE;}if(fD!=null){return fD;}return fF;}function bd(fE){var fD=new Date(e9.now());if(fE._useUTC){return[fD.getUTCFullYear(),fD.getUTCMonth(),fD.getUTCDate(),];}return[fD.getFullYear(),fD.getMonth(),fD.getDate()];}function g(fH){var fI,fG,fF=[],fE,fJ,fD;if(fH._d){return;}fE=bd(fH);if(fH._w&&fH._a[e0]==null&&fH._a[k]==null){dp(fH);}if(fH._dayOfYear!=null){fD=eC(fH._a[fo],fE[fo]);if(fH._dayOfYear>d5(fD)||fH._dayOfYear===0){bn(fH)._overflowDayOfYear=true;}fG=dU(fD,0,fH._dayOfYear);fH._a[k]=fG.getUTCMonth();fH._a[e0]=fG.getUTCDate();}for(fI=0;fI<3&&fH._a[fI]==null;++fI){fH._a[fI]=fF[fI]=fE[fI];}for(;fI<7;fI++){fH._a[fI]=fF[fI]=fH._a[fI]==null?(fI===2?1:0):fH._a[fI];}if(fH._a[fd]===24&&fH._a[d7]===0&&fH._a[ar]===0&&fH._a[bX]===0){fH._nextDay=true;fH._a[fd]=0;}fH._d=(fH._useUTC?dU:eB).apply(null,fF);fJ=fH._useUTC?fH._d.getUTCDay():fH._d.getDay();if(fH._tzm!=null){fH._d.setUTCMinutes(fH._d.getUTCMinutes()-fH._tzm);}if(fH._nextDay){fH._a[fd]=24;}if(fH._w&&typeof fH._w.d!=="undefined"&&fH._w.d!==fJ){bn(fH).weekdayMismatch=true;}}function dp(fG){var fJ,fD,fE,fH,fM,fK,fL,fI,fF;fJ=fG._w;if(fJ.GG!=null||fJ.W!=null||fJ.E!=null){fM=1;fK=4;fD=eC(fJ.GG,fG._a[fo],eY(d1(),1,4).year);fE=eC(fJ.W,1);fH=eC(fJ.E,1);if(fH<1||fH>7){fI=true;}}else{fM=fG._locale._week.dow;fK=fG._locale._week.doy;fF=eY(d1(),fM,fK);fD=eC(fJ.gg,fG._a[fo],fF.year);fE=eC(fJ.w,fF.week);if(fJ.d!=null){fH=fJ.d;if(fH<0||fH>6){fI=true;}}else{if(fJ.e!=null){fH=fJ.e+fM;if(fJ.e<0||fJ.e>6){fI=true;}}else{fH=fM;}}}if(fE<1||fE>G(fD,fM,fK)){bn(fG)._overflowWeeks=true;}else{if(fI!=null){bn(fG)._overflowWeekday=true;}else{fL=bO(fD,fE,fH,fM,fK);fG._a[fo]=fL.year;fG._dayOfYear=fL.dayOfYear;}}}e9.ISO_8601=function(){};e9.RFC_2822=function(){};function cc(fG){if(fG._f===e9.ISO_8601){E(fG);return;}if(fG._f===e9.RFC_2822){b6(fG);return;}fG._a=[];bn(fG).empty=true;var fJ=""+fG._i,fI,fF,fM,fH,fL,fD=fJ.length,fK=0,fE;fM=bT(fG._f,fG._locale).match(b4)||[];for(fI=0;fI<fM.length;fI++){fH=fM[fI];fF=(fJ.match(bS(fH,fG))||[])[0];if(fF){fL=fJ.substr(0,fJ.indexOf(fF));if(fL.length>0){bn(fG).unusedInput.push(fL);}fJ=fJ.slice(fJ.indexOf(fF)+fF.length);fK+=fF.length;}if(bl[fH]){if(fF){bn(fG).empty=false;}else{bn(fG).unusedTokens.push(fH);}w(fH,fF,fG);}else{if(fG._strict&&!fF){bn(fG).unusedTokens.push(fH);}}}bn(fG).charsLeftOver=fD-fK;if(fJ.length>0){bn(fG).unusedInput.push(fJ);}if(fG._a[fd]<=12&&bn(fG).bigHour===true&&fG._a[fd]>0){bn(fG).bigHour=undefined;}bn(fG).parsedDateParts=fG._a.slice(0);bn(fG).meridiem=fG._meridiem;fG._a[fd]=eK(fG._locale,fG._a[fd],fG._meridiem);fE=bn(fG).era;if(fE!==null){fG._a[fo]=fG._locale.erasConvertYear(fE,fG._a[fo]);}g(fG);c9(fG);}function eK(fD,fF,fG){var fE;if(fG==null){return fF;}if(fD.meridiemHour!=null){return fD.meridiemHour(fF,fG);}else{if(fD.isPM!=null){fE=fD.isPM(fG);if(fE&&fF<12){fF+=12;}if(!fE&&fF===12){fF=0;}return fF;}else{return fF;}}}function d3(fE){var fI,fG,fH,fF,fJ,fK,fD=false;if(fE._f.length===0){bn(fE).invalidFormat=true;fE._d=new Date(NaN);return;}for(fF=0;fF<fE._f.length;fF++){fJ=0;fK=false;fI=r({},fE);if(fE._useUTC!=null){fI._useUTC=fE._useUTC;}fI._f=fE._f[fF];cc(fI);if(ax(fI)){fK=true;}fJ+=bn(fI).charsLeftOver;fJ+=bn(fI).unusedTokens.length*10;bn(fI).score=fJ;if(!fD){if(fH==null||fJ<fH||fK){fH=fJ;fG=fI;if(fK){fD=true;}}}else{if(fJ<fH){fH=fJ;fG=fI;}}}fu(fE,fG||fI);}function bf(fD){if(fD._d){return;}var fE=ea(fD._i),fF=fE.day===undefined?fE.date:fE.day;fD._a=bz([fE.year,fE.month,fF,fE.hour,fE.minute,fE.second,fE.millisecond],function(fG){return fG&&parseInt(fG,10);});g(fD);}function au(fD){var fE=new eW(c9(bE(fD)));if(fE._nextDay){fE.add(1,"d");fE._nextDay=undefined;}return fE;}function bE(fE){var fD=fE._i,fF=fE._f;fE._locale=fE._locale||U(fE._l);if(fD===null||(fF===undefined&&fD==="")){return R({nullInput:true});}if(typeof fD==="string"){fE._i=fD=fE._locale.preparse(fD);}if(ct(fD)){return new eW(c9(fD));}else{if(e2(fD)){fE._d=fD;}else{if(aa(fF)){d3(fE);}else{if(fF){cc(fE);}else{cN(fE);}}}}if(!ax(fE)){fE._d=null;}return fE;}function cN(fE){var fD=fE._i;if(J(fD)){fE._d=new Date(e9.now());}else{if(e2(fD)){fE._d=new Date(fD.valueOf());}else{if(typeof fD==="string"){bo(fE);}else{if(aa(fD)){fE._a=bz(fD.slice(0),function(fF){return parseInt(fF,10);});g(fE);}else{if(x(fD)){bf(fE);}else{if(s(fD)){fE._d=new Date(fD);}else{e9.createFromInputFallback(fE);}}}}}}}function ak(fG,fH,fD,fF,fE){var fI={};if(fH===true||fH===false){fF=fH;fH=undefined;}if(fD===true||fD===false){fF=fD;fD=undefined;}if((x(fG)&&cz(fG))||(aa(fG)&&fG.length===0)){fG=undefined;}fI._isAMomentObject=true;fI._useUTC=fI._isUTC=fE;fI._l=fD;fI._i=fG;fI._f=fH;fI._strict=fF;return au(fI);}function d1(fF,fG,fD,fE){return ak(fF,fG,fD,fE,false);}var c4=eJ("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var fD=d1.apply(null,arguments);if(this.isValid()&&fD.isValid()){return fD<this?this:fD;}else{return R();}}),eT=eJ("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var fD=d1.apply(null,arguments);if(this.isValid()&&fD.isValid()){return fD>this?this:fD;}else{return R();}});function fv(fF,fG){var fE,fD;if(fG.length===1&&aa(fG[0])){fG=fG[0];}if(!fG.length){return d1();}fE=fG[0];for(fD=1;fD<fG.length;++fD){if(!fG[fD].isValid()||fG[fD][fF](fE)){fE=fG[fD];}}return fE;}function p(){var fD=[].slice.call(arguments,0);return fv("isBefore",fD);}function bx(){var fD=[].slice.call(arguments,0);return fv("isAfter",fD);}var cR=function(){return Date.now?Date.now():+new Date();};var ft=["year","quarter","month","week","day","hour","minute","second","millisecond",];function aB(fE){var fG,fD=false,fF;for(fG in fE){if(dI(fE,fG)&&!(dd.call(ft,fG)!==-1&&(fE[fG]==null||!isNaN(fE[fG])))){return false;}}for(fF=0;fF<ft.length;++fF){if(fE[ft[fF]]){if(fD){return false;}if(parseFloat(fE[ft[fF]])!==dc(fE[ft[fF]])){fD=true;}}}return true;}function u(){return this._isValid;}function a6(){return dC(NaN);}function ed(fI){var fK=ea(fI),fJ=fK.year||0,fE=fK.quarter||0,fF=fK.month||0,fD=fK.week||fK.isoWeek||0,fN=fK.day||0,fL=fK.hour||0,fH=fK.minute||0,fM=fK.second||0,fG=fK.millisecond||0;this._isValid=aB(fK);this._milliseconds=+fG+fM*1000+fH*60000+fL*1000*60*60;this._days=+fN+fD*7;this._months=+fF+fE*3+fJ*12;this._data={};this._locale=U();this._bubble();}function am(fD){return fD instanceof ed;}function eN(fD){if(fD<0){return Math.round(-1*fD)*-1;}else{return Math.round(fD);}}function cf(fI,fH,fE){var fD=Math.min(fI.length,fH.length),fF=Math.abs(fI.length-fH.length),fJ=0,fG;for(fG=0;fG<fD;fG++){if((fE&&fI[fG]!==fH[fG])||(!fE&&dc(fI[fG])!==dc(fH[fG]))){fJ++;}}return fJ+fF;}function bK(fD,fE){cQ(fD,0,0,function(){var fG=this.utcOffset(),fF="+";if(fG<0){fG=-fG;fF="-";}return(fF+cG(~~(fG/60),2)+fE+cG(~~fG%60,2));});}bK("Z",":");bK("ZZ","");bp("Z",cX);bp("ZZ",cX);b8(["Z","ZZ"],function(fD,fF,fE){fE._useUTC=true;fE._tzm=o(cX,fD);});var e8=/([\+\-]|\d\d)/gi;function o(fI,fE){var fG=(fE||"").match(fI),fD,fH,fF;if(fG===null){return null;}fD=fG[fG.length-1]||[];fH=(fD+"").match(e8)||["-",0,0];fF=+(fH[1]*60)+dc(fH[2]);return fF===0?0:fH[0]==="+"?fF:-fF;}function aL(fD,fE){var fF,fG;if(fE._isUTC){fF=fE.clone();fG=(ct(fD)||e2(fD)?fD.valueOf():d1(fD).valueOf())-fF.valueOf();fF._d.setTime(fF._d.valueOf()+fG);e9.updateOffset(fF,false);return fF;}else{return d1(fD).local();}}function aY(fD){return -Math.round(fD._d.getTimezoneOffset());}e9.updateOffset=function(){};function dV(fD,fG,fH){var fF=this._offset||0,fE;if(!this.isValid()){return fD!=null?this:NaN;}if(fD!=null){if(typeof fD==="string"){fD=o(cX,fD);if(fD===null){return this;}}else{if(Math.abs(fD)<16&&!fH){fD=fD*60;}}if(!this._isUTC&&fG){fE=aY(this);}this._offset=fD;this._isUTC=true;if(fE!=null){this.add(fE,"m");}if(fF!==fD){if(!fG||this._changeInProgress){ba(this,dC(fD-fF,"m"),1,false);}else{if(!this._changeInProgress){this._changeInProgress=true;e9.updateOffset(this,true);this._changeInProgress=null;}}}return this;}else{return this._isUTC?fF:aY(this);}}function dP(fD,fE){if(fD!=null){if(typeof fD!=="string"){fD=-fD;}this.utcOffset(fD,fE);return this;}else{return -this.utcOffset();}}function bb(fD){return this.utcOffset(0,fD);}function dS(fD){if(this._isUTC){this.utcOffset(0,fD);this._isUTC=false;if(fD){this.subtract(aY(this),"m");}}return this;}function cp(){if(this._tzm!=null){this.utcOffset(this._tzm,false,true);}else{if(typeof this._i==="string"){var fD=o(bV,this._i);if(fD!=null){this.utcOffset(fD);}else{this.utcOffset(0,true);}}}return this;}function aJ(fD){if(!this.isValid()){return false;}fD=fD?d1(fD).utcOffset():0;return(this.utcOffset()-fD)%60===0;}function aX(){return(this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset());}function c(){if(!J(this._isDSTShifted)){return this._isDSTShifted;}var fE={},fD;r(fE,this);fE=bE(fE);if(fE._a){fD=fE._isUTC?cO(fE._a):d1(fE._a);this._isDSTShifted=this.isValid()&&cf(fE._a,fD.toArray())>0;}else{this._isDSTShifted=false;}return this._isDSTShifted;}function dW(){return this.isValid()?!this._isUTC:false;}function b5(){return this.isValid()?this._isUTC:false;}function d2(){return this.isValid()?this._isUTC&&this._offset===0:false;}var ag=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,cP=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function dC(fF,fI){var fJ=fF,fH=null,fE,fG,fD;if(am(fF)){fJ={ms:fF._milliseconds,d:fF._days,M:fF._months};}else{if(s(fF)||!isNaN(+fF)){fJ={};if(fI){fJ[fI]=+fF;}else{fJ.milliseconds=+fF;}}else{if((fH=ag.exec(fF))){fE=fH[1]==="-"?-1:1;fJ={y:0,d:dc(fH[e0])*fE,h:dc(fH[fd])*fE,m:dc(fH[d7])*fE,s:dc(fH[ar])*fE,ms:dc(eN(fH[bX]*1000))*fE};}else{if((fH=cP.exec(fF))){fE=fH[1]==="-"?-1:1;fJ={y:fp(fH[2],fE),M:fp(fH[3],fE),w:fp(fH[4],fE),d:fp(fH[5],fE),h:fp(fH[6],fE),m:fp(fH[7],fE),s:fp(fH[8],fE)};}else{if(fJ==null){fJ={};}else{if(typeof fJ==="object"&&("from" in fJ||"to" in fJ)){fD=b1(d1(fJ.from),d1(fJ.to));fJ={};fJ.ms=fD.milliseconds;fJ.M=fD.months;}}}}}}fG=new ed(fJ);if(am(fF)&&dI(fF,"_locale")){fG._locale=fF._locale;}if(am(fF)&&dI(fF,"_isValid")){fG._isValid=fF._isValid;}return fG;}dC.fn=ed.prototype;dC.invalid=a6;function fp(fF,fD){var fE=fF&&parseFloat(fF.replace(",","."));return(isNaN(fE)?0:fE)*fD;}function dZ(fF,fD){var fE={};fE.months=fD.month()-fF.month()+(fD.year()-fF.year())*12;if(fF.clone().add(fE.months,"M").isAfter(fD)){--fE.months;}fE.milliseconds=+fD-+fF.clone().add(fE.months,"M");return fE;}function b1(fF,fD){var fE;if(!(fF.isValid()&&fD.isValid())){return{milliseconds:0,months:0};}fD=aL(fD,fF);if(fF.isBefore(fD)){fE=dZ(fF,fD);}else{fE=dZ(fD,fF);fE.milliseconds=-fE.milliseconds;fE.months=-fE.months;}return fE;}function bg(fE,fD){return function(fI,fH){var fG,fF;if(fH!==null&&!isNaN(+fH)){fm(fD,"moment()."+fD+"(period, number) is deprecated. Please use moment()."+fD+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info.");fF=fI;fI=fH;fH=fF;}fG=dC(fI,fH);ba(this,fG,fE);return this;};}function ba(fF,fI,fH,fG){var fE=fI._milliseconds,fJ=eN(fI._days),fD=eN(fI._months);if(!fF.isValid()){return;}fG=fG==null?true:fG;if(fD){a5(fF,d0(fF,"Month")+fD*fH);}if(fJ){aW(fF,"Date",d0(fF,"Date")+fJ*fH);}if(fE){fF._d.setTime(fF._d.valueOf()+fE*fH);}if(fG){e9.updateOffset(fF,fJ||fD);}}var a9=bg(1,"add"),aH=bg(-1,"subtract");function H(fD){return typeof fD==="string"||fD instanceof String;}function bI(fD){return(ct(fD)||e2(fD)||H(fD)||s(fD)||af(fD)||V(fD)||fD===null||fD===undefined);}function V(fD){var fG=x(fD)&&!cz(fD),fI=false,fF=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms",],fE,fH;for(fE=0;fE<fF.length;fE+=1){fH=fF[fE];fI=fI||dI(fD,fH);}return fG&&fI;}function af(fD){var fF=aa(fD),fE=false;if(fF){fE=fD.filter(function(fG){return !s(fG)&&H(fD);}).length===0;}return fF&&fE;}function I(fD){var fG=x(fD)&&!cz(fD),fI=false,fF=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse",],fE,fH;for(fE=0;fE<fF.length;fE+=1){fH=fF[fE];fI=fI||dI(fD,fH);}return fG&&fI;}function aD(fF,fD){var fE=fF.diff(fD,"days",true);return fE<-6?"sameElse":fE<-1?"lastWeek":fE<0?"lastDay":fE<1?"sameDay":fE<2?"nextDay":fE<7?"nextWeek":"sameElse";}function cx(fI,fD){if(arguments.length===1){if(!arguments[0]){fI=undefined;fD=undefined;}else{if(bI(arguments[0])){fI=arguments[0];fD=undefined;}else{if(I(arguments[0])){fD=arguments[0];fI=undefined;}}}}var fG=fI||d1(),fF=aL(fG,this).startOf("day"),fH=e9.calendarFormat(this,fF)||"sameElse",fE=fD&&(bi(fD[fH])?fD[fH].call(this,fG):fD[fH]);return this.format(fE||this.localeData().calendar(fH,this,d1(fG)));}function dR(){return new eW(this);}function cW(fE,fD){var fF=ct(fE)?fE:d1(fE);if(!(this.isValid()&&fF.isValid())){return false;}fD=db(fD)||"millisecond";if(fD==="millisecond"){return this.valueOf()>fF.valueOf();}else{return fF.valueOf()<this.clone().startOf(fD).valueOf();}}function fk(fE,fD){var fF=ct(fE)?fE:d1(fE);if(!(this.isValid()&&fF.isValid())){return false;}fD=db(fD)||"millisecond";if(fD==="millisecond"){return this.valueOf()<fF.valueOf();}else{return this.clone().endOf(fD).valueOf()<fF.valueOf();}}function eV(fI,fH,fD,fG){var fF=ct(fI)?fI:d1(fI),fE=ct(fH)?fH:d1(fH);if(!(this.isValid()&&fF.isValid()&&fE.isValid())){return false;}fG=fG||"()";return((fG[0]==="("?this.isAfter(fF,fD):!this.isBefore(fF,fD))&&(fG[1]===")"?this.isBefore(fE,fD):!this.isAfter(fE,fD)));}function c0(fE,fD){var fG=ct(fE)?fE:d1(fE),fF;if(!(this.isValid()&&fG.isValid())){return false;}fD=db(fD)||"millisecond";if(fD==="millisecond"){return this.valueOf()===fG.valueOf();}else{fF=fG.valueOf();return(this.clone().startOf(fD).valueOf()<=fF&&fF<=this.clone().endOf(fD).valueOf());}}function ff(fE,fD){return this.isSame(fE,fD)||this.isAfter(fE,fD);}function fi(fE,fD){return this.isSame(fE,fD)||this.isBefore(fE,fD);}function O(fG,fF,fD){var fI,fH,fE;if(!this.isValid()){return NaN;}fI=aL(fG,this);if(!fI.isValid()){return NaN;}fH=(fI.utcOffset()-this.utcOffset())*60000;fF=db(fF);switch(fF){case"year":fE=eR(this,fI)/12;break;case"month":fE=eR(this,fI);break;case"quarter":fE=eR(this,fI)/3;break;case"second":fE=(this-fI)/1000;break;case"minute":fE=(this-fI)/60000;break;case"hour":fE=(this-fI)/3600000;break;case"day":fE=(this-fI-fH)/86400000;break;case"week":fE=(this-fI-fH)/604800000;break;default:fE=this-fI;}return fD?fE:dF(fE);}function eR(fE,fD){if(fE.date()<fD.date()){return -eR(fD,fE);}var fI=(fD.year()-fE.year())*12+(fD.month()-fE.month()),fF=fE.clone().add(fI,"months"),fG,fH;if(fD-fF<0){fG=fE.clone().add(fI-1,"months");fH=(fD-fF)/(fF-fG);}else{fG=fE.clone().add(fI+1,"months");fH=(fD-fF)/(fG-fF);}return -(fI+fH)||0;}e9.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";e9.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function es(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ");}function dr(fF){if(!this.isValid()){return null;}var fE=fF!==true,fD=fE?this.clone().utc():this;if(fD.year()<0||fD.year()>9999){return an(fD,fE?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ");}if(bi(Date.prototype.toISOString)){if(fE){return this.toDate().toISOString();}else{return new Date(this.valueOf()+this.utcOffset()*60*1000).toISOString().replace("Z",an(fD,"Z"));}}return an(fD,fE?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ");}function a0(){if(!this.isValid()){return"moment.invalid(/* "+this._i+" */)";}var fF="moment",fD="",fG,fE,fI,fH;if(!this.isLocal()){fF=this.utcOffset()===0?"moment.utc":"moment.parseZone";fD="Z";}fG="["+fF+'("]';fE=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY";fI="-MM-DD[T]HH:mm:ss.SSS";fH=fD+'[")]';return this.format(fG+fE+fI+fH);}function du(fE){if(!fE){fE=this.isUtc()?e9.defaultFormatUtc:e9.defaultFormat;}var fD=an(this,fE);return this.localeData().postformat(fD);}function eh(fE,fD){if(this.isValid()&&((ct(fE)&&fE.isValid())||d1(fE).isValid())){return dC({to:this,from:fE}).locale(this.locale()).humanize(!fD);}else{return this.localeData().invalidDate();}}function eb(fD){return this.from(d1(),fD);}function aq(fE,fD){if(this.isValid()&&((ct(fE)&&fE.isValid())||d1(fE).isValid())){return dC({from:this,to:fE}).locale(this.locale()).humanize(!fD);}else{return this.localeData().invalidDate();}}function aZ(fD){return this.to(d1(),fD);}function fC(fE){var fD;if(fE===undefined){return this._locale._abbr;}else{fD=U(fE);if(fD!=null){this._locale=fD;}return this;}}var A=eJ("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(fD){if(fD===undefined){return this.localeData();}else{return this.locale(fD);}});function ei(){return this._locale;}var da=1000,ah=60*da,fB=60*ah,ao=(365*400+97)*24*fB;function bh(fD,fE){return((fD%fE)+fE)%fE;}function a(fF,fD,fE){if(fF<100&&fF>=0){return new Date(fF+400,fD,fE)-ao;}else{return new Date(fF,fD,fE).valueOf();}}function ez(fF,fD,fE){if(fF<100&&fF>=0){return Date.UTC(fF+400,fD,fE)-ao;}else{return Date.UTC(fF,fD,fE);}}function co(fD){var fE,fF;fD=db(fD);if(fD===undefined||fD==="millisecond"||!this.isValid()){return this;}fF=this._isUTC?ez:a;switch(fD){case"year":fE=fF(this.year(),0,1);break;case"quarter":fE=fF(this.year(),this.month()-(this.month()%3),1);break;case"month":fE=fF(this.year(),this.month(),1);break;case"week":fE=fF(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":fE=fF(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":fE=fF(this.year(),this.month(),this.date());break;case"hour":fE=this._d.valueOf();fE-=bh(fE+(this._isUTC?0:this.utcOffset()*ah),fB);break;case"minute":fE=this._d.valueOf();fE-=bh(fE,ah);break;case"second":fE=this._d.valueOf();fE-=bh(fE,da);break;}this._d.setTime(fE);e9.updateOffset(this,true);return this;}function e3(fD){var fE,fF;fD=db(fD);if(fD===undefined||fD==="millisecond"||!this.isValid()){return this;}fF=this._isUTC?ez:a;switch(fD){case"year":fE=fF(this.year()+1,0,1)-1;break;case"quarter":fE=fF(this.year(),this.month()-(this.month()%3)+3,1)-1;break;case"month":fE=fF(this.year(),this.month()+1,1)-1;break;case"week":fE=fF(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":fE=fF(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":fE=fF(this.year(),this.month(),this.date()+1)-1;break;case"hour":fE=this._d.valueOf();fE+=fB-bh(fE+(this._isUTC?0:this.utcOffset()*ah),fB)-1;break;case"minute":fE=this._d.valueOf();fE+=ah-bh(fE,ah)-1;break;case"second":fE=this._d.valueOf();fE+=da-bh(fE,da)-1;break;}this._d.setTime(fE);e9.updateOffset(this,true);return this;}function ek(){return this._d.valueOf()-(this._offset||0)*60000;}function bN(){return Math.floor(this.valueOf()/1000);}function dn(){return new Date(this.valueOf());}function d9(){var fD=this;return[fD.year(),fD.month(),fD.date(),fD.hour(),fD.minute(),fD.second(),fD.millisecond(),];}function eg(){var fD=this;return{years:fD.year(),months:fD.month(),date:fD.date(),hours:fD.hours(),minutes:fD.minutes(),seconds:fD.seconds(),milliseconds:fD.milliseconds()};}function dv(){return this.isValid()?this.toISOString():null;}function q(){return ax(this);}function d4(){return fu({},bn(this));}function cS(){return bn(this).overflow;}function fl(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict};}cQ("N",0,0,"eraAbbr");cQ("NN",0,0,"eraAbbr");cQ("NNN",0,0,"eraAbbr");cQ("NNNN",0,0,"eraName");cQ("NNNNN",0,0,"eraNarrow");cQ("y",["y",1],"yo","eraYear");cQ("y",["yy",2],0,"eraYear");cQ("y",["yyy",3],0,"eraYear");cQ("y",["yyyy",4],0,"eraYear");bp("N",ew);bp("NN",ew);bp("NNN",ew);bp("NNNN",dQ);bp("NNNNN",eO);b8(["N","NN","NNN","NNNN","NNNNN"],function(fE,fH,fF,fG){var fD=fF._locale.erasParse(fE,fG,fF._strict);if(fD){bn(fF).era=fD;}else{bn(fF).invalidEra=fE;}});bp("y",t);bp("yy",t);bp("yyy",t);bp("yyyy",t);bp("yo",a7);b8(["y","yy","yyy","yyyy"],fo);b8(["yo"],function(fD,fH,fF,fG){var fE;if(fF._locale._eraYearOrdinalRegex){fE=fD.match(fF._locale._eraYearOrdinalRegex);}if(fF._locale.eraYearOrdinalParse){fH[fo]=fF._locale.eraYearOrdinalParse(fD,fE);}else{fH[fo]=parseInt(fD,10);}});function bA(fD,fI){var fH,fF,fG,fE=this._eras||U("en")._eras;for(fH=0,fF=fE.length;fH<fF;++fH){switch(typeof fE[fH].since){case"string":fG=e9(fE[fH].since).startOf("day");fE[fH].since=fG.valueOf();break;}switch(typeof fE[fH].until){case"undefined":fE[fH].until=+Infinity;break;case"string":fG=e9(fE[fH].until).startOf("day").valueOf();fE[fH].until=fG.valueOf();break;}}return fE;}function ch(fJ,fK,fI){var fF,fE,fH=this.eras(),fD,fL,fG;fJ=fJ.toUpperCase();for(fF=0,fE=fH.length;fF<fE;++fF){fD=fH[fF].name.toUpperCase();fL=fH[fF].abbr.toUpperCase();fG=fH[fF].narrow.toUpperCase();if(fI){switch(fK){case"N":case"NN":case"NNN":if(fL===fJ){return fH[fF];}break;case"NNNN":if(fD===fJ){return fH[fF];}break;case"NNNNN":if(fG===fJ){return fH[fF];}break;}}else{if([fD,fL,fG].indexOf(fJ)>=0){return fH[fF];}}}}function eq(fD,fF){var fE=fD.since<=fD.until?+1:-1;if(fF===undefined){return e9(fD.since).year();}else{return e9(fD.since).year()+(fF-fD.offset)*fE;}}function dO(){var fF,fE,fG,fD=this.localeData().eras();for(fF=0,fE=fD.length;fF<fE;++fF){fG=this.clone().startOf("day").valueOf();if(fD[fF].since<=fG&&fG<=fD[fF].until){return fD[fF].name;}if(fD[fF].until<=fG&&fG<=fD[fF].since){return fD[fF].name;}}return"";}function cI(){var fF,fE,fG,fD=this.localeData().eras();for(fF=0,fE=fD.length;fF<fE;++fF){fG=this.clone().startOf("day").valueOf();if(fD[fF].since<=fG&&fG<=fD[fF].until){return fD[fF].narrow;}if(fD[fF].until<=fG&&fG<=fD[fF].since){return fD[fF].narrow;}}return"";}function ev(){var fF,fE,fG,fD=this.localeData().eras();for(fF=0,fE=fD.length;fF<fE;++fF){fG=this.clone().startOf("day").valueOf();if(fD[fF].since<=fG&&fG<=fD[fF].until){return fD[fF].abbr;}if(fD[fF].until<=fG&&fG<=fD[fF].since){return fD[fF].abbr;}}return"";}function eX(){var fG,fE,fF,fH,fD=this.localeData().eras();for(fG=0,fE=fD.length;fG<fE;++fG){fF=fD[fG].since<=fD[fG].until?+1:-1;fH=this.clone().startOf("day").valueOf();if((fD[fG].since<=fH&&fH<=fD[fG].until)||(fD[fG].until<=fH&&fH<=fD[fG].since)){return((this.year()-e9(fD[fG].since).year())*fF+fD[fG].offset);}}return this.year();}function fz(fD){if(!dI(this,"_erasNameRegex")){aO.call(this);}return fD?this._erasNameRegex:this._erasRegex;}function dK(fD){if(!dI(this,"_erasAbbrRegex")){aO.call(this);}return fD?this._erasAbbrRegex:this._erasRegex;}function ac(fD){if(!dI(this,"_erasNarrowRegex")){aO.call(this);}return fD?this._erasNarrowRegex:this._erasRegex;}function ew(fE,fD){return fD.erasAbbrRegex(fE);}function dQ(fE,fD){return fD.erasNameRegex(fE);}function eO(fE,fD){return fD.erasNarrowRegex(fE);}function a7(fE,fD){return fD._eraYearOrdinalRegex||t;}function aO(){var fH=[],fI=[],fF=[],fJ=[],fG,fE,fD=this.eras();for(fG=0,fE=fD.length;fG<fE;++fG){fI.push(cy(fD[fG].name));fH.push(cy(fD[fG].abbr));fF.push(cy(fD[fG].narrow));fJ.push(cy(fD[fG].name));fJ.push(cy(fD[fG].abbr));fJ.push(cy(fD[fG].narrow));}this._erasRegex=new RegExp("^("+fJ.join("|")+")","i");this._erasNameRegex=new RegExp("^("+fI.join("|")+")","i");this._erasAbbrRegex=new RegExp("^("+fH.join("|")+")","i");this._erasNarrowRegex=new RegExp("^("+fF.join("|")+")","i");}cQ(0,["gg",2],0,function(){return this.weekYear()%100;});cQ(0,["GG",2],0,function(){return this.isoWeekYear()%100;});function ab(fE,fD){cQ(0,[fE,fE.length],0,fD);}ab("gggg","weekYear");ab("ggggg","weekYear");ab("GGGG","isoWeekYear");ab("GGGGG","isoWeekYear");cw("weekYear","gg");cw("isoWeekYear","GG");el("weekYear",1);el("isoWeekYear",1);bp("G",D);bp("g",D);bp("GG",aA,aT);bp("gg",aA,aT);bp("GGGG",ay,aR);bp("gggg",ay,aR);bp("GGGGG",aw,aQ);bp("ggggg",aw,aQ);ad(["gggg","ggggg","GGGG","GGGGG"],function(fD,fG,fE,fF){fG[fF.substr(0,2)]=dc(fD);});ad(["gg","GG"],function(fD,fG,fE,fF){fG[fF]=e9.parseTwoDigitYear(fD);});function bC(fD){return cL.call(this,fD,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy);}function en(fD){return cL.call(this,fD,this.isoWeek(),this.isoWeekday(),1,4);}function dx(){return G(this.year(),1,4);}function eI(){return G(this.isoWeekYear(),1,4);}function M(){var fD=this.localeData()._week;return G(this.year(),fD.dow,fD.doy);}function cd(){var fD=this.localeData()._week;return G(this.weekYear(),fD.dow,fD.doy);}function cL(fD,fE,fG,fI,fH){var fF;if(fD==null){return eY(this,fI,fH).year;}else{fF=G(fD,fI,fH);if(fE>fF){fE=fF;}return bj.call(this,fD,fE,fG,fI,fH);}}function bj(fF,fE,fH,fJ,fI){var fG=bO(fF,fE,fH,fJ,fI),fD=dU(fG.year,0,fG.dayOfYear);this.year(fD.getUTCFullYear());this.month(fD.getUTCMonth());this.date(fD.getUTCDate());return this;}cQ("Q",0,"Qo","quarter");cw("quarter","Q");el("quarter",7);bp("Q",aU);b8("Q",function(fD,fE){fE[k]=(dc(fD)-1)*3;});function cg(fD){return fD==null?Math.ceil((this.month()+1)/3):this.month((fD-1)*3+(this.month()%3));}cQ("D",["DD",2],"Do","date");cw("date","D");el("date",9);bp("D",aA);bp("DD",aA,aT);bp("Do",function(fE,fD){return fE?fD._dayOfMonthOrdinalParse||fD._ordinalParse:fD._dayOfMonthOrdinalParseLenient;});b8(["D","DD"],e0);b8("Do",function(fD,fE){fE[e0]=dc(fD.match(aA)[0]);});var cE=eF("Date",true);cQ("DDD",["DDDD",3],"DDDo","dayOfYear");cw("dayOfYear","DDD");el("dayOfYear",4);bp("DDD",az);bp("DDDD",aS);b8(["DDD","DDDD"],function(fD,fF,fE){fE._dayOfYear=dc(fD);});function br(fD){var fE=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/86400000)+1;return fD==null?fE:this.add(fD-fE,"d");}cQ("m",["mm",2],0,"minute");cw("minute","m");el("minute",14);bp("m",aA);bp("mm",aA,aT);b8(["m","mm"],d7);var fj=eF("Minutes",false);cQ("s",["ss",2],0,"second");cw("second","s");el("second",15);bp("s",aA);bp("ss",aA,aT);b8(["s","ss"],ar);var bJ=eF("Seconds",false);cQ("S",0,0,function(){return ~~(this.millisecond()/100);});cQ(0,["SS",2],0,function(){return ~~(this.millisecond()/10);});cQ(0,["SSS",3],0,"millisecond");cQ(0,["SSSS",4],0,function(){return this.millisecond()*10;});cQ(0,["SSSSS",5],0,function(){return this.millisecond()*100;});cQ(0,["SSSSSS",6],0,function(){return this.millisecond()*1000;});cQ(0,["SSSSSSS",7],0,function(){return this.millisecond()*10000;});cQ(0,["SSSSSSSS",8],0,function(){return this.millisecond()*100000;});cQ(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1000000;});cw("millisecond","ms");el("millisecond",16);bp("S",az,aU);bp("SS",az,aT);bp("SSS",az,aS);var bw,ce;for(bw="SSSS";bw.length<=9;bw+="S"){bp(bw,t);}function ds(fD,fE){fE[bX]=dc(("0."+fD)*1000);}for(bw="S";bw.length<=9;bw+="S"){b8(bw,ds);}ce=eF("Milliseconds",false);cQ("z",0,0,"zoneAbbr");cQ("zz",0,0,"zoneName");function fg(){return this._isUTC?"UTC":"";}function eL(){return this._isUTC?"Coordinated Universal Time":"";}var cu=eW.prototype;cu.add=a9;cu.calendar=cx;cu.clone=dR;cu.diff=O;cu.endOf=e3;cu.format=du;cu.from=eh;cu.fromNow=eb;cu.to=aq;cu.toNow=aZ;cu.get=aI;cu.invalidAt=cS;cu.isAfter=cW;cu.isBefore=fk;cu.isBetween=eV;cu.isSame=c0;cu.isSameOrAfter=ff;cu.isSameOrBefore=fi;cu.isValid=q;cu.lang=A;cu.locale=fC;cu.localeData=ei;cu.max=eT;cu.min=c4;cu.parsingFlags=d4;cu.set=aC;cu.startOf=co;cu.subtract=aH;cu.toArray=d9;cu.toObject=eg;cu.toDate=dn;cu.toISOString=dr;cu.inspect=a0;if(typeof Symbol!=="undefined"&&Symbol["for"]!=null){cu[Symbol["for"]("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">";};}cu.toJSON=dv;cu.toString=es;cu.unix=bN;cu.valueOf=ek;cu.creationData=fl;cu.eraName=dO;cu.eraNarrow=cI;cu.eraAbbr=ev;cu.eraYear=eX;cu.year=cZ;cu.isLeapYear=di;cu.weekYear=bC;cu.isoWeekYear=en;cu.quarter=cu.quarters=cg;cu.month=fc;cu.daysInMonth=b0;cu.week=cu.weeks=N;cu.isoWeek=cu.isoWeeks=z;cu.weeksInYear=M;cu.weeksInWeekYear=cd;cu.isoWeeksInYear=dx;cu.isoWeeksInISOWeekYear=eI;cu.date=cE;cu.day=cu.days=eP;cu.weekday=al;cu.isoWeekday=cM;cu.dayOfYear=br;cu.hour=cu.hours=cH;cu.minute=cu.minutes=fj;cu.second=cu.seconds=bJ;cu.millisecond=cu.milliseconds=ce;cu.utcOffset=dV;cu.utc=bb;cu.local=dS;cu.parseZone=cp;cu.hasAlignedHourOffset=aJ;cu.isDST=aX;cu.isLocal=dW;cu.isUtcOffset=b5;cu.isUtc=d2;cu.isUTC=d2;cu.zoneAbbr=fg;cu.zoneName=eL;cu.dates=eJ("dates accessor is deprecated. Use date instead.",cE);cu.months=eJ("months accessor is deprecated. Use month instead",fc);cu.years=eJ("years accessor is deprecated. Use year instead",cZ);cu.zone=eJ("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",dP);cu.isDSTShifted=eJ("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",c);function dz(fD){return d1(fD*1000);}function c8(){return d1.apply(null,arguments).parseZone();}function dX(fD){return fD;}var eu=cV.prototype;eu.calendar=f;eu.longDateFormat=c5;eu.invalidDate=eU;eu.ordinal=e7;eu.preparse=dX;eu.postformat=dX;eu.relativeTime=Y;eu.pastFuture=eo;eu.set=dL;eu.eras=bA;eu.erasParse=ch;eu.erasConvertYear=eq;eu.erasAbbrRegex=dK;eu.erasNameRegex=fz;eu.erasNarrowRegex=ac;eu.months=bc;eu.monthsShort=bm;eu.monthsParse=dy;eu.monthsRegex=dl;eu.monthsShortRegex=dH;eu.week=bB;eu.firstDayOfYear=dw;eu.firstDayOfWeek=ap;eu.weekdays=aG;eu.weekdaysMin=fa;eu.weekdaysShort=Q;eu.weekdaysParse=bZ;eu.weekdaysRegex=fq;eu.weekdaysShortRegex=aP;eu.weekdaysMinRegex=F;eu.isPM=cv;eu.meridiem=a3;function L(fH,fE,fG,fI){var fD=U(),fF=cO().set(fI,fE);return fD[fG](fF,fH);}function a8(fH,fE,fG){if(s(fH)){fE=fH;fH=undefined;}fH=fH||"";if(fE!=null){return L(fH,fE,fG,"month");}var fF,fD=[];for(fF=0;fF<12;fF++){fD[fF]=L(fH,fF,fG,"month");}return fD;}function fs(fI,fK,fG,fJ){if(typeof fI==="boolean"){if(s(fK)){fG=fK;fK=undefined;}fK=fK||"";}else{fK=fI;fG=fK;fI=false;if(s(fK)){fG=fK;fK=undefined;}fK=fK||"";}var fD=U(),fE=fI?fD._week.dow:0,fH,fF=[];if(fG!=null){return L(fK,(fG+fE)%7,fJ,"day");}for(fH=0;fH<7;fH++){fF[fH]=L(fK,(fH+fE)%7,fJ,"day");}return fF;}function dg(fE,fD){return a8(fE,fD,"months");}function cU(fE,fD){return a8(fE,fD,"monthsShort");}function dt(fE,fF,fD){return fs(fE,fF,fD,"weekdays");}function c7(fE,fF,fD){return fs(fE,fF,fD,"weekdaysShort");}function ae(fE,fF,fD){return fs(fE,fF,fD,"weekdaysMin");}C("en",{eras:[{since:"0001-01-01",until:+Infinity,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-Infinity,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"},],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(fF){var fD=fF%10,fE=dc((fF%100)/10)===1?"th":fD===1?"st":fD===2?"nd":fD===3?"rd":"th";return fF+fE;}});e9.lang=eJ("moment.lang is deprecated. Use moment.locale instead.",C);e9.langData=eJ("moment.langData is deprecated. Use moment.localeData instead.",U);var e5=Math.abs;function by(){var fD=this._data;this._milliseconds=e5(this._milliseconds);this._days=e5(this._days);this._months=e5(this._months);fD.milliseconds=e5(fD.milliseconds);fD.seconds=e5(fD.seconds);fD.minutes=e5(fD.minutes);fD.hours=e5(fD.hours);fD.months=e5(fD.months);fD.years=e5(fD.years);return this;}function aN(fH,fE,fF,fG){var fD=dC(fE,fF);fH._milliseconds+=fG*fD._milliseconds;fH._days+=fG*fD._days;fH._months+=fG*fD._months;return fH._bubble();}function bP(fD,fE){return aN(this,fD,fE,1);}function ee(fD,fE){return aN(this,fD,fE,-1);}function fb(fD){if(fD<0){return Math.floor(fD);}else{return Math.ceil(fD);}}function dh(){var fF=this._milliseconds,fL=this._days,fD=this._months,fH=this._data,fK,fG,fJ,fI,fE;if(!((fF>=0&&fL>=0&&fD>=0)||(fF<=0&&fL<=0&&fD<=0))){fF+=fb(fw(fD)+fL)*86400000;fL=0;fD=0;}fH.milliseconds=fF%1000;fK=dF(fF/1000);fH.seconds=fK%60;fG=dF(fK/60);fH.minutes=fG%60;fJ=dF(fG/60);fH.hours=fJ%24;fL+=dF(fJ/24);fE=dF(h(fL));fD+=fE;fL-=fb(fw(fE));fI=dF(fD/12);fD%=12;fH.days=fL;fH.months=fD;fH.years=fI;return this;}function h(fD){return(fD*4800)/146097;}function fw(fD){return(fD*146097)/4800;}function fe(fE){if(!this.isValid()){return NaN;}var fG,fD,fF=this._milliseconds;fE=db(fE);if(fE==="month"||fE==="quarter"||fE==="year"){fG=this._days+fF/86400000;fD=this._months+h(fG);switch(fE){case"month":return fD;case"quarter":return fD/3;case"year":return fD/12;}}else{fG=this._days+Math.round(fw(this._months));switch(fE){case"week":return fG/7+fF/604800000;case"day":return fG+fF/86400000;case"hour":return fG*24+fF/3600000;case"minute":return fG*1440+fF/60000;case"second":return fG*86400+fF/1000;case"millisecond":return Math.floor(fG*86400000)+fF;default:throw new Error("Unknown unit "+fE);}}}function dq(){if(!this.isValid()){return NaN;}return(this._milliseconds+this._days*86400000+(this._months%12)*2592000000+dc(this._months/12)*31536000000);}function ey(fD){return function(){return this.as(fD);};}var fy=ey("ms"),P=ey("s"),dT=ey("m"),v=ey("h"),eD=ey("d"),ef=ey("w"),ex=ey("M"),eM=ey("Q"),bv=ey("y");function fr(){return dC(this);}function K(fD){fD=db(fD);return this.isValid()?this[fD+"s"]():NaN;}function cr(fD){return function(){return this.isValid()?this._data[fD]:NaN;};}var d=cr("milliseconds"),bs=cr("seconds"),aM=cr("minutes"),Z=cr("hours"),bq=cr("days"),fh=cr("months"),bY=cr("years");function eG(){return dF(this.days()/7);}var dm=Math.round,d6={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function at(fE,fG,fF,fH,fD){return fD.relativeTime(fG||1,!!fF,fE,fH);}function d8(fI,fF,fP,fM){var fG=dC(fI).abs(),fN=dm(fG.as("s")),fH=dm(fG.as("m")),fL=dm(fG.as("h")),fO=dm(fG.as("d")),fE=dm(fG.as("M")),fD=dm(fG.as("w")),fJ=dm(fG.as("y")),fK=(fN<=fP.ss&&["s",fN])||(fN<fP.s&&["ss",fN])||(fH<=1&&["m"])||(fH<fP.m&&["mm",fH])||(fL<=1&&["h"])||(fL<fP.h&&["hh",fL])||(fO<=1&&["d"])||(fO<fP.d&&["dd",fO]);if(fP.w!=null){fK=fK||(fD<=1&&["w"])||(fD<fP.w&&["ww",fD]);}fK=fK||(fE<=1&&["M"])||(fE<fP.M&&["MM",fE])||(fJ<=1&&["y"])||["yy",fJ];fK[2]=fF;fK[3]=+fI>0;fK[4]=fM;return at.apply(null,fK);}function e1(fD){if(fD===undefined){return dm;}if(typeof fD==="function"){dm=fD;return true;}return false;}function cD(fD,fE){if(d6[fD]===undefined){return false;}if(fE===undefined){return d6[fD];}d6[fD]=fE;if(fD==="s"){d6.ss=fE-1;}return true;}function b(fF,fH){if(!this.isValid()){return this.localeData().invalidDate();}var fI=false,fG=d6,fD,fE;if(typeof fF==="object"){fH=fF;fF=false;}if(typeof fF==="boolean"){fI=fF;}if(typeof fH==="object"){fG=Object.assign({},d6,fH);if(fH.s!=null&&fH.ss==null){fG.ss=fH.s-1;}}fD=this.localeData();fE=d8(this,!fI,fG,fD);if(fI){fE=fD.pastFuture(+this,fE);}return fD.postformat(fE);}var a4=Math.abs;function b7(fD){return(fD>0)-(fD<0)||+fD;}function bW(){if(!this.isValid()){return this.localeData().invalidDate();}var fM=a4(this._milliseconds)/1000,fN=a4(this._days),fE=a4(this._months),fH,fL,fJ,fO,fK=this.asSeconds(),fD,fF,fG,fI;if(!fK){return"P0D";}fH=dF(fM/60);fL=dF(fH/60);fM%=60;fH%=60;fJ=dF(fE/12);fE%=12;fO=fM?fM.toFixed(3).replace(/\.?0+$/,""):"";fD=fK<0?"-":"";fF=b7(this._months)!==b7(fK)?"-":"";fG=b7(this._days)!==b7(fK)?"-":"";fI=b7(this._milliseconds)!==b7(fK)?"-":"";return(fD+"P"+(fJ?fF+fJ+"Y":"")+(fE?fF+fE+"M":"")+(fN?fG+fN+"D":"")+(fL||fH||fM?"T":"")+(fL?fI+fL+"H":"")+(fH?fI+fH+"M":"")+(fM?fI+fO+"S":""));}var et=ed.prototype;et.isValid=u;et.abs=by;et.add=bP;et.subtract=ee;et.as=fe;et.asMilliseconds=fy;et.asSeconds=P;et.asMinutes=dT;et.asHours=v;et.asDays=eD;et.asWeeks=ef;et.asMonths=ex;et.asQuarters=eM;et.asYears=bv;et.valueOf=dq;et._bubble=dh;et.clone=fr;et.get=K;et.milliseconds=d;et.seconds=bs;et.minutes=aM;et.hours=Z;et.days=bq;et.weeks=eG;et.months=fh;et.years=bY;et.humanize=b;et.toISOString=bW;et.toString=bW;et.toJSON=bW;et.locale=fC;et.localeData=ei;et.toIsoString=eJ("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",bW);et.lang=A;cQ("X",0,0,"unix");cQ("x",0,0,"valueOf");bp("x",D);bp("X",fn);b8("X",function(fD,fF,fE){fE._d=new Date(parseFloat(fD)*1000);});b8("x",function(fD,fF,fE){fE._d=new Date(dc(fD));});e9.version="2.29.1";a1(d1);e9.fn=cu;e9.min=p;e9.max=bx;e9.now=cR;e9.utc=cO;e9.unix=dz;e9.months=dg;e9.isDate=e2;e9.locale=C;e9.invalid=R;e9.duration=dC;e9.isMoment=ct;e9.weekdays=dt;e9.parseZone=c8;e9.localeData=U;e9.isDuration=am;e9.monthsShort=cU;e9.weekdaysMin=ae;e9.defineLocale=cT;e9.updateLocale=eQ;e9.locales=cl;e9.weekdaysShort=c7;e9.normalizeUnits=db;e9.relativeTimeRounding=e1;e9.relativeTimeThreshold=cD;e9.calendarFormat=aD;e9.prototype=cu;e9.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};return e9;})));